typedef unsigned char   undefined;

typedef unsigned char    bool;
typedef unsigned char    byte;
typedef unsigned int    dword;
typedef long long    longlong;
typedef unsigned long    qword;
typedef unsigned char    uchar;
typedef unsigned int    uint;
typedef unsigned long    ulong;
typedef unsigned long long    ulonglong;
typedef unsigned char    undefined1;
typedef unsigned short    undefined2;
typedef unsigned int    undefined4;
typedef unsigned long    undefined8;
typedef unsigned short    ushort;
typedef unsigned short    word;
typedef struct IOAccelClientSharedMachine IOAccelClientSharedMachine, *PIOAccelClientSharedMachine;

struct IOAccelClientSharedMachine { // PlaceHolder Class Structure
};

typedef struct IOAccelOrphanedMemoryPool IOAccelOrphanedMemoryPool, *PIOAccelOrphanedMemoryPool;

struct IOAccelOrphanedMemoryPool { // PlaceHolder Class Structure
};

typedef struct IOAccelOrphanedVidMemoryPool IOAccelOrphanedVidMemoryPool, *PIOAccelOrphanedVidMemoryPool;

struct IOAccelOrphanedVidMemoryPool { // PlaceHolder Class Structure
};

typedef enum enum_4118 {
    KD_CALLBACK_KDEBUG_ENABLED=0,
    KD_CALLBACK_KDEBUG_DISABLED=1,
    KD_CALLBACK_SYNC_FLUSH=2,
    KD_CALLBACK_TYPEFILTER_CHANGED=3
} enum_4118;

typedef enum enum_4118 kd_callback_type;

typedef void (*kd_callback_fn)(void *, kd_callback_type, void *);

typedef struct kd_callback kd_callback, *Pkd_callback;

struct kd_callback {
    kd_callback_fn func;
    void *context;
    char iop_name[8];
};

typedef struct kd_callback kd_callback_t;

typedef uint __darwin_natural_t;

typedef __darwin_natural_t __darwin_mach_port_name_t;

typedef void *__darwin_va_list;

typedef ulong __darwin_size_t;

typedef __darwin_mach_port_name_t __darwin_mach_port_t;

typedef ulonglong uint64_t;

typedef ulong uintptr_t;

typedef __darwin_size_t size_t;

typedef int kern_return_t;

typedef __darwin_natural_t natural_t;

typedef natural_t mach_msg_type_number_t;

typedef uint uint32_t;

typedef uint boolean_t;

typedef __darwin_mach_port_t mach_port_t;

typedef int vm_region_flavor_t;

typedef int *vm_region_info_t;

typedef __darwin_va_list va_list;

typedef struct IOAccelKernelCommand IOAccelKernelCommand, *PIOAccelKernelCommand;

struct IOAccelKernelCommand { // PlaceHolder Structure
};

typedef struct OSMetaClassBase OSMetaClassBase, *POSMetaClassBase;

struct OSMetaClassBase { // PlaceHolder Structure
};

typedef struct IOAccelMemoryData IOAccelMemoryData, *PIOAccelMemoryData;

struct IOAccelMemoryData { // PlaceHolder Structure
};

typedef undefined eIOAccelGLBufferType;

typedef struct IOAccelSurfaceInformation IOAccelSurfaceInformation, *PIOAccelSurfaceInformation;

struct IOAccelSurfaceInformation { // PlaceHolder Structure
};

typedef struct OSCollection OSCollection, *POSCollection;

struct OSCollection { // PlaceHolder Structure
};

typedef struct IOAccelBufferMemoryDescriptorPool2 IOAccelBufferMemoryDescriptorPool2, *PIOAccelBufferMemoryDescriptorPool2;

struct IOAccelBufferMemoryDescriptorPool2 { // PlaceHolder Structure
};

typedef undefined eIOAccelResType;

typedef struct GLKMemoryElement GLKMemoryElement, *PGLKMemoryElement;

struct GLKMemoryElement { // PlaceHolder Structure
};

typedef struct IOAccelLegacySurface IOAccelLegacySurface, *PIOAccelLegacySurface;

struct IOAccelLegacySurface { // PlaceHolder Structure
};

typedef struct IOAccelCommandDescriptor IOAccelCommandDescriptor, *PIOAccelCommandDescriptor;

struct IOAccelCommandDescriptor { // PlaceHolder Structure
};

typedef struct IOAccelContextSubmitDataBuffersIn IOAccelContextSubmitDataBuffersIn, *PIOAccelContextSubmitDataBuffersIn;

struct IOAccelContextSubmitDataBuffersIn { // PlaceHolder Structure
};

typedef struct IOAccelDisplayMachine IOAccelDisplayMachine, *PIOAccelDisplayMachine;

struct IOAccelDisplayMachine { // PlaceHolder Structure
};

typedef struct IOMapper IOMapper, *PIOMapper;

struct IOMapper { // PlaceHolder Structure
};

typedef struct IOAccelSurfaceMTLList IOAccelSurfaceMTLList, *PIOAccelSurfaceMTLList;

struct IOAccelSurfaceMTLList { // PlaceHolder Structure
};

typedef struct IOExternalMethodDispatch IOExternalMethodDispatch, *PIOExternalMethodDispatch;

struct IOExternalMethodDispatch { // PlaceHolder Structure
};

typedef struct IOAccelGPURestartReport2 IOAccelGPURestartReport2, *PIOAccelGPURestartReport2;

struct IOAccelGPURestartReport2 { // PlaceHolder Structure
};

typedef undefined eSurfaceVolatileState;

typedef struct IOReporter IOReporter, *PIOReporter;

struct IOReporter { // PlaceHolder Structure
};

typedef struct IOAccelTaskList IOAccelTaskList, *PIOAccelTaskList;

struct IOAccelTaskList { // PlaceHolder Structure
};

typedef struct IOAccelGLDrawableUserClient IOAccelGLDrawableUserClient, *PIOAccelGLDrawableUserClient;

struct IOAccelGLDrawableUserClient { // PlaceHolder Structure
};

typedef struct IOAccelNamespace IOAccelNamespace, *PIOAccelNamespace;

struct IOAccelNamespace { // PlaceHolder Structure
};

typedef struct IOAccelContextEventFence IOAccelContextEventFence, *PIOAccelContextEventFence;

struct IOAccelContextEventFence { // PlaceHolder Structure
};

typedef struct IOAccelDisplayPipeGammaTableData IOAccelDisplayPipeGammaTableData, *PIOAccelDisplayPipeGammaTableData;

struct IOAccelDisplayPipeGammaTableData { // PlaceHolder Structure
};

typedef struct IOAccelSurface IOAccelSurface, *PIOAccelSurface;

struct IOAccelSurface { // PlaceHolder Structure
};

typedef struct IOAccelResourcePrivate IOAccelResourcePrivate, *PIOAccelResourcePrivate;

struct IOAccelResourcePrivate { // PlaceHolder Structure
};

typedef struct IOAccelCommandQueueSegment IOAccelCommandQueueSegment, *PIOAccelCommandQueueSegment;

struct IOAccelCommandQueueSegment { // PlaceHolder Structure
};

typedef struct IOAccelVideoContext2 IOAccelVideoContext2, *PIOAccelVideoContext2;

struct IOAccelVideoContext2 { // PlaceHolder Structure
};

typedef struct OSMetaClass OSMetaClass, *POSMetaClass;

struct OSMetaClass { // PlaceHolder Structure
};

typedef struct IOAccelGLContextGetConfigStatus IOAccelGLContextGetConfigStatus, *PIOAccelGLContextGetConfigStatus;

struct IOAccelGLContextGetConfigStatus { // PlaceHolder Structure
};

typedef struct IOAccelDrawable2 IOAccelDrawable2, *PIOAccelDrawable2;

struct IOAccelDrawable2 { // PlaceHolder Structure
};

typedef struct IOAccelGLDrawableUserClientList IOAccelGLDrawableUserClientList, *PIOAccelGLDrawableUserClientList;

struct IOAccelGLDrawableUserClientList { // PlaceHolder Structure
};

typedef struct IOAccelNewResourceArgs IOAccelNewResourceArgs, *PIOAccelNewResourceArgs;

struct IOAccelNewResourceArgs { // PlaceHolder Structure
};

typedef struct IOAccelCommandQueue IOAccelCommandQueue, *PIOAccelCommandQueue;

struct IOAccelCommandQueue { // PlaceHolder Structure
};

typedef struct IOAccelCommandBufferPoolList IOAccelCommandBufferPoolList, *PIOAccelCommandBufferPoolList;

struct IOAccelCommandBufferPoolList { // PlaceHolder Structure
};

typedef struct IOAccel2DBlitCommand IOAccel2DBlitCommand, *PIOAccel2DBlitCommand;

struct IOAccel2DBlitCommand { // PlaceHolder Structure
};

typedef struct IOSurfaceDeviceCache IOSurfaceDeviceCache, *PIOSurfaceDeviceCache;

struct IOSurfaceDeviceCache { // PlaceHolder Structure
};

typedef struct IOAccelDeviceConfigData IOAccelDeviceConfigData, *PIOAccelDeviceConfigData;

struct IOAccelDeviceConfigData { // PlaceHolder Structure
};

typedef struct proc proc, *Pproc;

struct proc { // PlaceHolder Structure
};

typedef struct IOAccelContextGetDataBufferIn IOAccelContextGetDataBufferIn, *PIOAccelContextGetDataBufferIn;

struct IOAccelContextGetDataBufferIn { // PlaceHolder Structure
};

typedef struct IOAccelFenceMachine IOAccelFenceMachine, *PIOAccelFenceMachine;

struct IOAccelFenceMachine { // PlaceHolder Structure
};

typedef struct IOAccelDeviceSurfaceData IOAccelDeviceSurfaceData, *PIOAccelDeviceSurfaceData;

struct IOAccelDeviceSurfaceData { // PlaceHolder Structure
};

typedef struct IOAccelGLContextSetSurfaceData IOAccelGLContextSetSurfaceData, *PIOAccelGLContextSetSurfaceData;

struct IOAccelGLContextSetSurfaceData { // PlaceHolder Structure
};

typedef struct vendevtBarrierRec vendevtBarrierRec, *PvendevtBarrierRec;

struct vendevtBarrierRec { // PlaceHolder Structure
};

typedef struct IOMemoryDescriptor IOMemoryDescriptor, *PIOMemoryDescriptor;

struct IOMemoryDescriptor { // PlaceHolder Structure
};

typedef undefined eIOAccelGLDrawableClientBufferType;

typedef struct IOSurfaceSharedEvent IOSurfaceSharedEvent, *PIOSurfaceSharedEvent;

struct IOSurfaceSharedEvent { // PlaceHolder Structure
};

typedef struct IOAccelSegmentResourceListHeader IOAccelSegmentResourceListHeader, *PIOAccelSegmentResourceListHeader;

struct IOAccelSegmentResourceListHeader { // PlaceHolder Structure
};

typedef struct IOBufferMemoryDescriptor IOBufferMemoryDescriptor, *PIOBufferMemoryDescriptor;

struct IOBufferMemoryDescriptor { // PlaceHolder Structure
};

typedef struct mach_timespec mach_timespec, *Pmach_timespec;

struct mach_timespec { // PlaceHolder Structure
};

typedef struct IOAccelVidMemory IOAccelVidMemory, *PIOAccelVidMemory;

struct IOAccelVidMemory { // PlaceHolder Structure
};

typedef struct IOAccelDisplayPipeTransactionArgs IOAccelDisplayPipeTransactionArgs, *PIOAccelDisplayPipeTransactionArgs;

struct IOAccelDisplayPipeTransactionArgs { // PlaceHolder Structure
};

typedef struct IOAccelAllocationInfo IOAccelAllocationInfo, *PIOAccelAllocationInfo;

struct IOAccelAllocationInfo { // PlaceHolder Structure
};

typedef undefined eIOAccelResourcePurgeable;

typedef struct IOPMPowerState IOPMPowerState, *PIOPMPowerState;

struct IOPMPowerState { // PlaceHolder Structure
};

typedef struct IOAccelMemoryInfoAllocTotals IOAccelMemoryInfoAllocTotals, *PIOAccelMemoryInfoAllocTotals;

struct IOAccelMemoryInfoAllocTotals { // PlaceHolder Structure
};

typedef struct IOAccelDeviceList IOAccelDeviceList, *PIOAccelDeviceList;

struct IOAccelDeviceList { // PlaceHolder Structure
};

typedef undefined eDoSwap;

typedef struct IOAccelDisplayPipeTransaction2 IOAccelDisplayPipeTransaction2, *PIOAccelDisplayPipeTransaction2;

struct IOAccelDisplayPipeTransaction2 { // PlaceHolder Structure
};

typedef struct IODMACommand IODMACommand, *PIODMACommand;

struct IODMACommand { // PlaceHolder Structure
};

typedef struct IOAccelEvent IOAccelEvent, *PIOAccelEvent;

struct IOAccelEvent { // PlaceHolder Structure
};

typedef struct IOReportChannelList IOReportChannelList, *PIOReportChannelList;

struct IOReportChannelList { // PlaceHolder Structure
};

typedef struct IOAccelShared2 IOAccelShared2, *PIOAccelShared2;

struct IOAccelShared2 { // PlaceHolder Structure
};

typedef struct IOAccelSharedUserClientList IOAccelSharedUserClientList, *PIOAccelSharedUserClientList;

struct IOAccelSharedUserClientList { // PlaceHolder Structure
};

typedef struct IOAccelEventMachineFast2 IOAccelEventMachineFast2, *PIOAccelEventMachineFast2;

struct IOAccelEventMachineFast2 { // PlaceHolder Structure
};

typedef struct ipc_port ipc_port, *Pipc_port;

struct ipc_port { // PlaceHolder Structure
};

typedef struct IOTimerEventSource IOTimerEventSource, *PIOTimerEventSource;

struct IOTimerEventSource { // PlaceHolder Structure
};

typedef struct IOAccelClientInfo IOAccelClientInfo, *PIOAccelClientInfo;

struct IOAccelClientInfo { // PlaceHolder Structure
};

typedef struct IOAccelCommandQueueList IOAccelCommandQueueList, *PIOAccelCommandQueueList;

struct IOAccelCommandQueueList { // PlaceHolder Structure
};

typedef struct IOAccelExternalEvent IOAccelExternalEvent, *PIOAccelExternalEvent;

struct IOAccelExternalEvent { // PlaceHolder Structure
};

typedef struct IOAccelContextList IOAccelContextList, *PIOAccelContextList;

struct IOAccelContextList { // PlaceHolder Structure
};

typedef struct IOAccelBounds IOAccelBounds, *PIOAccelBounds;

struct IOAccelBounds { // PlaceHolder Structure
};

typedef struct OSString OSString, *POSString;

struct OSString { // PlaceHolder Structure
};

typedef struct IOAccelSharedPageoffResourceArgs IOAccelSharedPageoffResourceArgs, *PIOAccelSharedPageoffResourceArgs;

struct IOAccelSharedPageoffResourceArgs { // PlaceHolder Structure
};

typedef struct IOAccelGLContext2 IOAccelGLContext2, *PIOAccelGLContext2;

struct IOAccelGLContext2 { // PlaceHolder Structure
};

typedef struct IOAccelDisplayPipeVRRTimeStampInfo IOAccelDisplayPipeVRRTimeStampInfo, *PIOAccelDisplayPipeVRRTimeStampInfo;

struct IOAccelDisplayPipeVRRTimeStampInfo { // PlaceHolder Structure
};

typedef struct IOAccelTask IOAccelTask, *PIOAccelTask;

struct IOAccelTask { // PlaceHolder Structure
};

typedef struct IOAccelSurfaceMTL IOAccelSurfaceMTL, *PIOAccelSurfaceMTL;

struct IOAccelSurfaceMTL { // PlaceHolder Structure
};

typedef struct IOAccelEventMachine2 IOAccelEventMachine2, *PIOAccelEventMachine2;

struct IOAccelEventMachine2 { // PlaceHolder Structure
};

typedef struct IOAccelSurfaceScaling IOAccelSurfaceScaling, *PIOAccelSurfaceScaling;

struct IOAccelSurfaceScaling { // PlaceHolder Structure
};

typedef struct IOAccelDisplayPipeGammaTableArgs IOAccelDisplayPipeGammaTableArgs, *PIOAccelDisplayPipeGammaTableArgs;

struct IOAccelDisplayPipeGammaTableArgs { // PlaceHolder Structure
};

typedef struct semaphore semaphore, *Psemaphore;

struct semaphore { // PlaceHolder Structure
};

typedef struct IOAccelGLContextReadBufferData IOAccelGLContextReadBufferData, *PIOAccelGLContextReadBufferData;

struct IOAccelGLContextReadBufferData { // PlaceHolder Structure
};

typedef struct IOSurface IOSurface, *PIOSurface;

struct IOSurface { // PlaceHolder Structure
};

typedef struct IOAccelSysMemoryList IOAccelSysMemoryList, *PIOAccelSysMemoryList;

struct IOAccelSysMemoryList { // PlaceHolder Structure
};

typedef undefined eIOAccelCommandQueueQosLevel;

typedef struct IOPCIDevice IOPCIDevice, *PIOPCIDevice;

struct IOPCIDevice { // PlaceHolder Structure
};

typedef struct IOAccelDisplayPipeTransactionWaitArgs IOAccelDisplayPipeTransactionWaitArgs, *PIOAccelDisplayPipeTransactionWaitArgs;

struct IOAccelDisplayPipeTransactionWaitArgs { // PlaceHolder Structure
};

typedef struct IOAccelMemoryMap IOAccelMemoryMap, *PIOAccelMemoryMap;

struct IOAccelMemoryMap { // PlaceHolder Structure
};

typedef struct IOUserClient IOUserClient, *PIOUserClient;

struct IOUserClient { // PlaceHolder Structure
};

typedef struct IOAccelDeviceEventMachineData IOAccelDeviceEventMachineData, *PIOAccelDeviceEventMachineData;

struct IOAccelDeviceEventMachineData { // PlaceHolder Structure
};

typedef struct IOExternalMethodArguments IOExternalMethodArguments, *PIOExternalMethodArguments;

struct IOExternalMethodArguments { // PlaceHolder Structure
};

typedef struct OSSet OSSet, *POSSet;

struct OSSet { // PlaceHolder Structure
};

typedef struct IOAccelSegmentResourceList IOAccelSegmentResourceList, *PIOAccelSegmentResourceList;

struct IOAccelSegmentResourceList { // PlaceHolder Structure
};

typedef struct IOFramebuffer IOFramebuffer, *PIOFramebuffer;

struct IOFramebuffer { // PlaceHolder Structure
};

typedef struct eIOAccelResourcePurgeable.conflict eIOAccelResourcePurgeable.conflict, *PeIOAccelResourcePurgeable.conflict;

struct eIOAccelResourcePurgeable.conflict { // PlaceHolder Structure
};

typedef struct EventFencesListHead EventFencesListHead, *PEventFencesListHead;

struct EventFencesListHead { // PlaceHolder Structure
};

typedef struct IOAccelGLDrawableClientGetConfigStatus IOAccelGLDrawableClientGetConfigStatus, *PIOAccelGLDrawableClientGetConfigStatus;

struct IOAccelGLDrawableClientGetConfigStatus { // PlaceHolder Structure
};

typedef undefined eIOAccelSurfaceShapeBits;

typedef struct IOPowerConnection IOPowerConnection, *PIOPowerConnection;

struct IOPowerConnection { // PlaceHolder Structure
};

typedef struct IOAccelDisplayPipePreCSCLinearizationVID IOAccelDisplayPipePreCSCLinearizationVID, *PIOAccelDisplayPipePreCSCLinearizationVID;

struct IOAccelDisplayPipePreCSCLinearizationVID { // PlaceHolder Structure
};

typedef struct IOAccelDisplayPipeUserClient2 IOAccelDisplayPipeUserClient2, *PIOAccelDisplayPipeUserClient2;

struct IOAccelDisplayPipeUserClient2 { // PlaceHolder Structure
};

typedef struct OSSymbol OSSymbol, *POSSymbol;

struct OSSymbol { // PlaceHolder Structure
};

typedef struct IOAccelMemory IOAccelMemory, *PIOAccelMemory;

struct IOAccelMemory { // PlaceHolder Structure
};

typedef struct IOService IOService, *PIOService;

struct IOService { // PlaceHolder Structure
};

typedef undefined IOAccelStereoMode;

typedef struct IOAccelDisplayPipePreCSCLinearizationArgs IOAccelDisplayPipePreCSCLinearizationArgs, *PIOAccelDisplayPipePreCSCLinearizationArgs;

struct IOAccelDisplayPipePreCSCLinearizationArgs { // PlaceHolder Structure
};

typedef struct IOAccelCreateMTLEventResult IOAccelCreateMTLEventResult, *PIOAccelCreateMTLEventResult;

struct IOAccelCreateMTLEventResult { // PlaceHolder Structure
};

typedef struct IOAccelSharedGetInfoReturnData IOAccelSharedGetInfoReturnData, *PIOAccelSharedGetInfoReturnData;

struct IOAccelSharedGetInfoReturnData { // PlaceHolder Structure
};

typedef struct IOAccelDeviceTraceFilterData IOAccelDeviceTraceFilterData, *PIOAccelDeviceTraceFilterData;

struct IOAccelDeviceTraceFilterData { // PlaceHolder Structure
};

typedef struct IOAccel2DContext2 IOAccel2DContext2, *PIOAccel2DContext2;

struct IOAccel2DContext2 { // PlaceHolder Structure
};

typedef struct IOAccelSharedUserClient2 IOAccelSharedUserClient2, *PIOAccelSharedUserClient2;

struct IOAccelSharedUserClient2 { // PlaceHolder Structure
};

typedef struct IOAccelContextGetDataBufferOut IOAccelContextGetDataBufferOut, *PIOAccelContextGetDataBufferOut;

struct IOAccelContextGetDataBufferOut { // PlaceHolder Structure
};

typedef struct IOAccelTraceStreamConnection IOAccelTraceStreamConnection, *PIOAccelTraceStreamConnection;

struct IOAccelTraceStreamConnection { // PlaceHolder Structure
};

typedef struct IOAccelClientSharedRW IOAccelClientSharedRW, *PIOAccelClientSharedRW;

struct IOAccelClientSharedRW { // PlaceHolder Structure
};

typedef struct IOAccelCLContext2 IOAccelCLContext2, *PIOAccelCLContext2;

struct IOAccelCLContext2 { // PlaceHolder Structure
};

typedef struct IOAccelDeviceAPIProperty IOAccelDeviceAPIProperty, *PIOAccelDeviceAPIProperty;

struct IOAccelDeviceAPIProperty { // PlaceHolder Structure
};

typedef struct IOAccelSurfaceReadData IOAccelSurfaceReadData, *PIOAccelSurfaceReadData;

struct IOAccelSurfaceReadData { // PlaceHolder Structure
};

typedef struct vendevtCommandRec vendevtCommandRec, *PvendevtCommandRec;

struct vendevtCommandRec { // PlaceHolder Structure
};

typedef struct IOAccelRemoteMemory IOAccelRemoteMemory, *PIOAccelRemoteMemory;

struct IOAccelRemoteMemory { // PlaceHolder Structure
};

typedef struct IOAccelDisplayPipeNotifyRequest IOAccelDisplayPipeNotifyRequest, *PIOAccelDisplayPipeNotifyRequest;

struct IOAccelDisplayPipeNotifyRequest { // PlaceHolder Structure
};

typedef struct IOAccelContext2 IOAccelContext2, *PIOAccelContext2;

struct IOAccelContext2 { // PlaceHolder Structure
};

typedef struct IOAccelBlockFencePort2 IOAccelBlockFencePort2, *PIOAccelBlockFencePort2;

struct IOAccelBlockFencePort2 { // PlaceHolder Structure
};

typedef struct IOAccelDisplayPipePostCSCGammaVID IOAccelDisplayPipePostCSCGammaVID, *PIOAccelDisplayPipePostCSCGammaVID;

struct IOAccelDisplayPipePostCSCGammaVID { // PlaceHolder Structure
};

typedef struct task task, *Ptask;

struct task { // PlaceHolder Structure
};

typedef struct IOAccelVidMemoryList IOAccelVidMemoryList, *PIOAccelVidMemoryList;

struct IOAccelVidMemoryList { // PlaceHolder Structure
};

typedef struct IOAccelSharedSetupDirtyRingReturnData IOAccelSharedSetupDirtyRingReturnData, *PIOAccelSharedSetupDirtyRingReturnData;

struct IOAccelSharedSetupDirtyRingReturnData { // PlaceHolder Structure
};

typedef struct IOAccelSidebandBufferHeader IOAccelSidebandBufferHeader, *PIOAccelSidebandBufferHeader;

struct IOAccelSidebandBufferHeader { // PlaceHolder Structure
};

typedef struct IOAccelKernelMappedMemory IOAccelKernelMappedMemory, *PIOAccelKernelMappedMemory;

struct IOAccelKernelMappedMemory { // PlaceHolder Structure
};

typedef struct IOAccelRangeAllocator IOAccelRangeAllocator, *PIOAccelRangeAllocator;

struct IOAccelRangeAllocator { // PlaceHolder Structure
};

typedef struct IORangeAllocator IORangeAllocator, *PIORangeAllocator;

struct IORangeAllocator { // PlaceHolder Structure
};

typedef struct IOMallocTypeMixin<IOAccelResidentMemorySet> IOMallocTypeMixin<IOAccelResidentMemorySet>, *PIOMallocTypeMixin<IOAccelResidentMemorySet>;

struct IOMallocTypeMixin<IOAccelResidentMemorySet> { // PlaceHolder Structure
};

typedef undefined IOAccelDisplayPipeRotationArgs;

typedef struct IOAccelDeviceRegion IOAccelDeviceRegion, *PIOAccelDeviceRegion;

struct IOAccelDeviceRegion { // PlaceHolder Structure
};

typedef struct OSSerialize OSSerialize, *POSSerialize;

struct OSSerialize { // PlaceHolder Structure
};

typedef struct IOAccelResourceList IOAccelResourceList, *PIOAccelResourceList;

struct IOAccelResourceList { // PlaceHolder Structure
};

typedef struct IOAccelMemoryInfoUserClient IOAccelMemoryInfoUserClient, *PIOAccelMemoryInfoUserClient;

struct IOAccelMemoryInfoUserClient { // PlaceHolder Structure
};

typedef struct IOGraphicsAccelerator2 IOGraphicsAccelerator2, *PIOGraphicsAccelerator2;

struct IOGraphicsAccelerator2 { // PlaceHolder Structure
};

typedef struct IOAccelDeviceShmem IOAccelDeviceShmem, *PIOAccelDeviceShmem;

struct IOAccelDeviceShmem { // PlaceHolder Structure
};

typedef struct DisplayTransactionListHead DisplayTransactionListHead, *PDisplayTransactionListHead;

struct DisplayTransactionListHead { // PlaceHolder Structure
};

typedef struct IOAccelSubmitter2 IOAccelSubmitter2, *PIOAccelSubmitter2;

struct IOAccelSubmitter2 { // PlaceHolder Structure
};

typedef struct IOInterruptEventSource IOInterruptEventSource, *PIOInterruptEventSource;

struct IOInterruptEventSource { // PlaceHolder Structure
};

typedef struct IOAccelDeviceGlobalObjectIDData IOAccelDeviceGlobalObjectIDData, *PIOAccelDeviceGlobalObjectIDData;

struct IOAccelDeviceGlobalObjectIDData { // PlaceHolder Structure
};

typedef struct IORegistryPlane IORegistryPlane, *PIORegistryPlane;

struct IORegistryPlane { // PlaceHolder Structure
};

typedef struct IOAccelResidentMemorySet IOAccelResidentMemorySet, *PIOAccelResidentMemorySet;

struct IOAccelResidentMemorySet { // PlaceHolder Structure
};

typedef struct OSObject OSObject, *POSObject;

struct OSObject { // PlaceHolder Structure
};

typedef struct IOAccelExternalEventFence IOAccelExternalEventFence, *PIOAccelExternalEventFence;

struct IOAccelExternalEventFence { // PlaceHolder Structure
};

typedef struct IOAccelCommandBufferPool2 IOAccelCommandBufferPool2, *PIOAccelCommandBufferPool2;

struct IOAccelCommandBufferPool2 { // PlaceHolder Structure
};

typedef struct IOAccelDisplayPipeGammaTable2 IOAccelDisplayPipeGammaTable2, *PIOAccelDisplayPipeGammaTable2;

struct IOAccelDisplayPipeGammaTable2 { // PlaceHolder Structure
};

typedef undefined eLockType;

typedef struct IOAccelDisplayPipe IOAccelDisplayPipe, *PIOAccelDisplayPipe;

struct IOAccelDisplayPipe { // PlaceHolder Structure
};

typedef struct IOAccelNewResourceReturnData IOAccelNewResourceReturnData, *PIOAccelNewResourceReturnData;

struct IOAccelNewResourceReturnData { // PlaceHolder Structure
};

typedef struct IOAccelSharedNamespace2 IOAccelSharedNamespace2, *PIOAccelSharedNamespace2;

struct IOAccelSharedNamespace2 { // PlaceHolder Structure
};

typedef struct IOAccelTraceStream2 IOAccelTraceStream2, *PIOAccelTraceStream2;

struct IOAccelTraceStream2 { // PlaceHolder Structure
};

typedef struct IOAccelSharedEventFence IOAccelSharedEventFence, *PIOAccelSharedEventFence;

struct IOAccelSharedEventFence { // PlaceHolder Structure
};

typedef struct IOAccelAllocatedSize IOAccelAllocatedSize, *PIOAccelAllocatedSize;

struct IOAccelAllocatedSize { // PlaceHolder Structure
};

typedef struct IOAccelMemoryAllocator2 IOAccelMemoryAllocator2, *PIOAccelMemoryAllocator2;

struct IOAccelMemoryAllocator2 { // PlaceHolder Structure
};

typedef undefined IOAccelDisplayPipeColorMatrix;

typedef struct IOAccelResource2 IOAccelResource2, *PIOAccelResource2;

struct IOAccelResource2 { // PlaceHolder Structure
};

typedef struct IOAccelDeviceShmemData IOAccelDeviceShmemData, *PIOAccelDeviceShmemData;

struct IOAccelDeviceShmemData { // PlaceHolder Structure
};

typedef struct IOAccelDeviceGIDGroupData IOAccelDeviceGIDGroupData, *PIOAccelDeviceGIDGroupData;

struct IOAccelDeviceGIDGroupData { // PlaceHolder Structure
};

typedef struct IOAccelSharedList IOAccelSharedList, *PIOAccelSharedList;

struct IOAccelSharedList { // PlaceHolder Structure
};

typedef struct IOAccelChannelList IOAccelChannelList, *PIOAccelChannelList;

struct IOAccelChannelList { // PlaceHolder Structure
};

typedef struct IOAccelLegacyDisplayPipe IOAccelLegacyDisplayPipe, *PIOAccelLegacyDisplayPipe;

struct IOAccelLegacyDisplayPipe { // PlaceHolder Structure
};

typedef struct IOAccelerator IOAccelerator, *PIOAccelerator;

struct IOAccelerator { // PlaceHolder Structure
};

typedef struct IOAccelSysMemory IOAccelSysMemory, *PIOAccelSysMemory;

struct IOAccelSysMemory { // PlaceHolder Structure
};

typedef struct IOAccelDisplayPipeRequestNotifyGatedArgs IOAccelDisplayPipeRequestNotifyGatedArgs, *PIOAccelDisplayPipeRequestNotifyGatedArgs;

struct IOAccelDisplayPipeRequestNotifyGatedArgs { // PlaceHolder Structure
};

typedef struct IOAccelChannel2 IOAccelChannel2, *PIOAccelChannel2;

struct IOAccelChannel2 { // PlaceHolder Structure
};

typedef struct IOAccelEventQueue IOAccelEventQueue, *PIOAccelEventQueue;

struct IOAccelEventQueue { // PlaceHolder Structure
};

typedef struct OSArray OSArray, *POSArray;

struct OSArray { // PlaceHolder Structure
};

typedef struct IOAccelResourceSetResourceOwnerIdentityData IOAccelResourceSetResourceOwnerIdentityData, *PIOAccelResourceSetResourceOwnerIdentityData;

struct IOAccelResourceSetResourceOwnerIdentityData { // PlaceHolder Structure
};

typedef struct IOAccelDisplayPipePostCSCGammaTableArgs IOAccelDisplayPipePostCSCGammaTableArgs, *PIOAccelDisplayPipePostCSCGammaTableArgs;

struct IOAccelDisplayPipePostCSCGammaTableArgs { // PlaceHolder Structure
};

typedef struct IOAccelDeviceInfoReturnData IOAccelDeviceInfoReturnData, *PIOAccelDeviceInfoReturnData;

struct IOAccelDeviceInfoReturnData { // PlaceHolder Structure
};

typedef struct IOAccelGLDrawableClientSetSurfaceData IOAccelGLDrawableClientSetSurfaceData, *PIOAccelGLDrawableClientSetSurfaceData;

struct IOAccelGLDrawableClientSetSurfaceData { // PlaceHolder Structure
};

typedef struct IOAccelClientSharedRO IOAccelClientSharedRO, *PIOAccelClientSharedRO;

struct IOAccelClientSharedRO { // PlaceHolder Structure
};

typedef struct IOAccelCommandStreamInfo IOAccelCommandStreamInfo, *PIOAccelCommandStreamInfo;

struct IOAccelCommandStreamInfo { // PlaceHolder Structure
};

typedef struct IOAccelDisplayPipeScaler IOAccelDisplayPipeScaler, *PIOAccelDisplayPipeScaler;

struct IOAccelDisplayPipeScaler { // PlaceHolder Structure
};

typedef struct IOAccelContextSubmitDataBuffersOut IOAccelContextSubmitDataBuffersOut, *PIOAccelContextSubmitDataBuffersOut;

struct IOAccelContextSubmitDataBuffersOut { // PlaceHolder Structure
};

typedef undefined IOAccelAffineTransform;

typedef undefined eRestartRequest;

typedef struct IOAccelRangeElement IOAccelRangeElement, *PIOAccelRangeElement;

struct IOAccelRangeElement { // PlaceHolder Structure
};

typedef struct IOAccelBlockFence IOAccelBlockFence, *PIOAccelBlockFence;

struct IOAccelBlockFence { // PlaceHolder Structure
};

typedef struct IOAccelLegacyDisplayMachine IOAccelLegacyDisplayMachine, *PIOAccelLegacyDisplayMachine;

struct IOAccelLegacyDisplayMachine { // PlaceHolder Structure
};

typedef struct IOAccelMTLEvent2 IOAccelMTLEvent2, *PIOAccelMTLEvent2;

struct IOAccelMTLEvent2 { // PlaceHolder Structure
};

typedef struct IOAccelContextConfig IOAccelContextConfig, *PIOAccelContextConfig;

struct IOAccelContextConfig { // PlaceHolder Structure
};

typedef struct IORegistryEntry IORegistryEntry, *PIORegistryEntry;

struct IORegistryEntry { // PlaceHolder Structure
};

typedef struct _IOLock _IOLock, *P_IOLock;

struct _IOLock { // PlaceHolder Structure
};

typedef struct eIOAccelSurfaceStateBits eIOAccelSurfaceStateBits, *PeIOAccelSurfaceStateBits;

struct eIOAccelSurfaceStateBits { // PlaceHolder Structure
};

typedef struct IOAccelGetResourceInfoReturnData IOAccelGetResourceInfoReturnData, *PIOAccelGetResourceInfoReturnData;

struct IOAccelGetResourceInfoReturnData { // PlaceHolder Structure
};

typedef struct OSDictionary OSDictionary, *POSDictionary;

struct OSDictionary { // PlaceHolder Structure
};

typedef undefined IORPC;

typedef struct IOAccelEventFence IOAccelEventFence, *PIOAccelEventFence;

struct IOAccelEventFence { // PlaceHolder Structure
};

typedef struct IOAccelDevice2 IOAccelDevice2, *PIOAccelDevice2;

struct IOAccelDevice2 { // PlaceHolder Structure
};

typedef struct IOAccelMemoryMapList IOAccelMemoryMapList, *PIOAccelMemoryMapList;

struct IOAccelMemoryMapList { // PlaceHolder Structure
};

typedef struct IOAccelSurfaceList IOAccelSurfaceList, *PIOAccelSurfaceList;

struct IOAccelSurfaceList { // PlaceHolder Structure
};

typedef struct IOAccelCommandQueueSubmitArgs IOAccelCommandQueueSubmitArgs, *PIOAccelCommandQueueSubmitArgs;

struct IOAccelCommandQueueSubmitArgs { // PlaceHolder Structure
};

typedef undefined eIOAccelContextModeBits;

typedef struct IOAccelCollectionEra IOAccelCollectionEra, *PIOAccelCollectionEra;

struct IOAccelCollectionEra { // PlaceHolder Structure
};

typedef struct IOAccelStatistics2 IOAccelStatistics2, *PIOAccelStatistics2;

struct IOAccelStatistics2 { // PlaceHolder Structure
};

typedef struct IOAccelFIFOChannel2 IOAccelFIFOChannel2, *PIOAccelFIFOChannel2;

struct IOAccelFIFOChannel2 { // PlaceHolder Structure
};

typedef undefined IOAccelDisplayPipeColorMatrixArgs;

typedef struct IOAccelDisplayPipeRequestNotifyArgs IOAccelDisplayPipeRequestNotifyArgs, *PIOAccelDisplayPipeRequestNotifyArgs;

struct IOAccelDisplayPipeRequestNotifyArgs { // PlaceHolder Structure
};

typedef struct IOSurfaceMTLSharedEventFence IOSurfaceMTLSharedEventFence, *PIOSurfaceMTLSharedEventFence;

struct IOSurfaceMTLSharedEventFence { // PlaceHolder Structure
};

typedef undefined IOAccelDisplayRect;

typedef undefined eIOAccelCommandQueuePriority;

typedef struct MetaClass MetaClass, *PMetaClass;

struct MetaClass { // PlaceHolder Structure
};

typedef struct Iterator Iterator, *PIterator;

struct Iterator { // PlaceHolder Structure
};

typedef struct LRUIterator LRUIterator, *PLRUIterator;

struct LRUIterator { // PlaceHolder Structure
};

typedef struct ReverseIterator ReverseIterator, *PReverseIterator;

struct ReverseIterator { // PlaceHolder Structure
};

typedef undefined MappingOptions;

typedef undefined Segment64;

typedef struct OrderedReverseIterator OrderedReverseIterator, *POrderedReverseIterator;

struct OrderedReverseIterator { // PlaceHolder Structure
};

typedef struct CS_CodeDirectory CS_CodeDirectory, *PCS_CodeDirectory;

struct CS_CodeDirectory {
    dword magic; // magic number (CSMAGIC_CODEDIRECTORY)
    dword length; // total length of CodeDirectory blob
    dword version; // compatibility version
    dword flags; // setup and mode flags
    dword hashOffset; // offset of hash slot element at index zero
    dword identOffset; // offset of identifier string
    dword nSpecialSlots; // number of special hash slots
    dword nCodeSlots; // number of ordinary (code) hash slots
    dword codeLimit; // limit to main image signature range
    byte hashSize; // size of each hash in bytes
    byte hashType; // type of hash (cdHashType* constants)
    byte platform; // platform identifier; zero if not platform binary
    byte pageSize; // log2(page size in bytes); 0 => infinite
    dword spare2; // unused (must be zero)
    dword scatterOffset; // offset of optional scatter vector
};

typedef struct uuid_command uuid_command, *Puuid_command;

struct uuid_command {
    dword cmd;
    dword cmdsize;
    byte uuid[16];
};

typedef struct CS_BlobIndex CS_BlobIndex, *PCS_BlobIndex;

struct CS_BlobIndex {
    dword type; // type of entry
    dword offset; // offset of entry
};

typedef struct section section, *Psection;

struct section {
    char sectname[16];
    char segname[16];
    qword addr;
    qword size;
    dword offset;
    dword align;
    dword reloff;
    dword nrelocs;
    dword flags;
    dword reserved1;
    dword reserved2;
    dword reserved3;
};

typedef struct nlist nlist, *Pnlist;

struct nlist {
    dword n_strx;
    byte n_type;
    byte n_sect;
    word n_desc;
    qword n_value;
};

typedef struct segment_command segment_command, *Psegment_command;

struct segment_command {
    dword cmd;
    dword cmdsize;
    char segname[16];
    qword vmaddr;
    qword vmsize;
    qword fileoff;
    qword filesize;
    dword maxprot;
    dword initprot;
    dword nsects;
    dword flags;
};

typedef struct source_version_command source_version_command, *Psource_version_command;

struct source_version_command {
    dword cmd;
    dword cmdsize;
    qword version;
};

typedef struct mach_header mach_header, *Pmach_header;

struct mach_header {
    dword magic;
    dword cputype;
    dword cpusubtype;
    dword filetype;
    dword ncmds;
    dword sizeofcmds;
    dword flags;
    dword reserved;
};

typedef struct dysymtab_command dysymtab_command, *Pdysymtab_command;

struct dysymtab_command {
    dword cmd;
    dword cmdsize;
    dword ilocalsym;
    dword nlocalsym;
    dword iextdefsym;
    dword nextdefsym;
    dword iundefsym;
    dword nundefsym;
    dword tocoff;
    dword ntoc;
    dword modtaboff;
    dword nmodtab;
    dword extrefsymoff;
    dword nextrefsyms;
    dword indirectsymoff;
    dword nindirectsyms;
    dword extreloff;
    dword nextrel;
    dword locreloff;
    dword nlocrel;
};

typedef struct CS_SuperBlob CS_SuperBlob, *PCS_SuperBlob;

struct CS_SuperBlob {
    dword magic; // magic number
    dword length; // total length of SuperBlob
    dword count; // number of index entries following
    struct CS_BlobIndex index[3]; // (count) entries
};

typedef struct symtab_command symtab_command, *Psymtab_command;

struct symtab_command {
    dword cmd;
    dword cmdsize;
    dword symoff;
    dword nsyms;
    dword stroff;
    dword strsize;
};

typedef struct linkedit_data_command linkedit_data_command, *Plinkedit_data_command;

struct linkedit_data_command {
    dword cmd;
    dword cmdsize;
    dword dataoff;
    dword datasize;
};

typedef struct CS_GenericBlob CS_GenericBlob, *PCS_GenericBlob;

struct CS_GenericBlob {
    dword magic; // magic number
    dword length; // total length of blob
};

typedef uint64_t mach_vm_address_t;

typedef uintptr_t vm_offset_t;

typedef vm_offset_t vm_address_t;

typedef uint64_t mach_vm_size_t;

typedef mach_port_t vm_map_t;

typedef uintptr_t vm_size_t;



pointer PTR_~MetaClass_0006bd68;
undefined1 gMetaClass;
pointer PTR_~IOAccelLegacyDisplayMachine_0006b400;
pointer gMetaClass;
pointer IOAccelLegacyDisplayMachine_ktv;
undefined *PTR___os_log_default_0006b0b8;
undefined DAT_aaaaaaaaaaaaaaaa;
undefined4 ___ktrace_kernel_enabled;
undefined *PTR__gIODTPlane_0006b0c0;
undefined *PTR_metaClass_0006b078;
undefined *PTR_metaClass_0006b030;
undefined1 kalloc_type_view_24;
undefined1 kalloc_type_view_37;
undefined1 kalloc_type_view_107;
undefined1 kalloc_type_view_111;
undefined UNK_0006ad6c;
undefined *PTR_gMetaClass_0006b068;
pointer PTR_~MetaClass_0006c058;
pointer PTR_~IOAccelMemory_0006be60;
pointer IOAccelMemory_ktv;
undefined1 kalloc_type_view_36;
undefined *PTR_vtable_0006b0a0;
undefined8 fUniqueMemoryIdentifierSource;
undefined1 kalloc_type_view_139;
undefined1 kalloc_type_view_183;
undefined1 kalloc_type_view_188;
undefined *PTR__page_size_0006b108;
pointer PTR_~MetaClass_0006cce8;
pointer PTR_~IOAccel2DContext2_0006c150;
pointer IOAccel2DContext2_ktv;
undefined DAT_000010d0;
undefined DAT_00001168;
undefined DAT_0000118c;
undefined DAT_000011c0;
pointer kalloc_type_view_449;
undefined1 kalloc_type_view_385;
pointer s2DContextMethods;
pointer sContextMethods;
pointer sSubmitDataBuffersForegroundOnlyOverride;
pointer PTR_~MetaClass_0006cfa0;
pointer PTR_~IOAccelNamespace_0006ce70;
pointer IOAccelNamespace_ktv;
undefined1 kalloc_type_view_71;
undefined1 kalloc_type_view_83;
undefined1 kalloc_type_view_96;
undefined1 kalloc_type_view_105;
pointer PTR_~MetaClass_0006d250;
pointer PTR_~IOAccelChannel2_0006d098;
pointer IOAccelChannel2_ktv;
undefined8 ___globalObjectIDCounter;
pointer PTR_~MetaClass_0006d570;
pointer PTR_~IOAccelFIFOChannel2_0006d348;
pointer IOAccelFIFOChannel2_ktv;
undefined *PTR____stack_chk_guard_0006b0b0;
undefined *PTR_metaClass_0006b080;
long DAT_00081ea0;
pointer _ZN15IOAccelChannel210gMetaClassF;
pointer PTR_~MetaClass_0006d798;
pointer PTR_~IOAccelExternalEvent_0006d668;
pointer IOAccelExternalEvent_ktv;
undefined8 gMetaClass;
pointer PTR_~MetaClass_0006e418;
pointer PTR_~IOAccelCLContext2_0006d890;
undefined DAT_000010e8;
pointer IOAccelCLContext2_ktv;
pointer PTR_~MetaClass_0006e678;
pointer PTR_~IOAccelCommandBufferPool2_0006e510;
pointer IOAccelCommandBufferPool2_ktv;
undefined *PTR__kernel_task_0006b100;
pointer PTR_~MetaClass_0006f2c8;
pointer PTR_~IOAccelContext2_0006e770;
undefined DAT_000010a8;
pointer IOAccelContext2_ktv;
pointer kalloc_type_view_228;
undefined1 kalloc_type_view_259;
pointer enableBlockFencesDispatch;
undefined DAT_00009fcc;
undefined1 kalloc_type_view_1244;
undefined1 kalloc_type_view_1276;
undefined1 kalloc_type_view_1294;
undefined DAT_000011bc;
undefined DAT_000011be;
segment_command segment_command_00000020;
undefined *PTR_gMetaClass_0006b018;
pointer PTR_~MetaClass_00070010;
pointer PTR_~IOAccelGLDrawableUserClient_0006f620;
pointer IOAccelGLDrawableUserClient_ktv;
undefined *PTR_vtable_0006b088;
undefined *PTR_metaClass_0006b048;
pointer PTR_~MetaClass_00070ad0;
pointer PTR_~IOAccelDevice2_00070110;
pointer IOAccelDevice2_ktv;
undefined4 DAT_00001190;
undefined8 DAT_000011b0;
undefined DAT_000011b8;
undefined DAT_000011ba;
pointer sDeviceMethods;
undefined *PTR_gMetaClass_0006b070;
pointer PTR_~MetaClass_000716a8;
pointer PTR_~IOAccelDisplayMachine_00070db0;
pointer IOAccelDisplayMachine_ktv;
undefined *PTR_vtable_0006b0a8;
undefined DAT_0006add0;
undefined DAT_0006adf0;
undefined DAT_0006ae10;
pointer PTR_~MetaClass_00072168;
pointer PTR_~IOAccelSurfaceMTL_000717a0;
pointer IOAccelSurfaceMTL_ktv;
undefined DAT_0006ae2d;
pointer sSurfaceMethods;
pointer sSignalEventDispatch;
pointer newResourceDispatch;
undefined *PTR__kIOSurfacePixelFormat_0006b0e0;
undefined *PTR__kIOSurfaceBytesPerElement_0006b0d0;
undefined *PTR__kIOSurfaceWidth_0006b0e8;
undefined *PTR__kIOSurfaceHeight_0006b0d8;
pointer PTR_~MetaClass_00072760;
pointer PTR_~IOSurfaceMTLSharedEventFence_00072628;
pointer IOSurfaceMTLSharedEventFence_ktv;
pointer PTR_~MetaClass_000729b8;
pointer PTR_~IOAccelDrawable2_00072858;
pointer IOAccelDrawable2_ktv;
undefined DAT_00001020;
pointer PTR_~MetaClass_00072d68;
pointer PTR_~IOAccelEventMachine2_00072ab0;
pointer IOAccelEventMachine2_ktv;
undefined hardwareErrorEvent;
undefined gpu_progress_check_timer;
undefined resetHardwareProgressTimer;
undefined gpu_progress_check;
undefined *PTR___NSConcreteStackBlock_0006b000;
undefined1 kalloc_type_view_210;
undefined1 kalloc_type_view_232;
pointer PTR_~MetaClass_00073908;
pointer PTR_~IOAccelLegacySurface_00072e80;
pointer IOAccelLegacySurface_ktv;
undefined DAT_00001368;
undefined DAT_00001050;
undefined DAT_00001058;
undefined DAT_0000105c;
pointer PTR_~MetaClass_000743f8;
pointer PTR_~IOAccelSubmitter2_00073a00;
pointer IOAccelSubmitter2_ktv;
undefined8 ___lastSubmissionTimeSymbol;
undefined8 ___accumulatedGPUTimeSymbol;
pointer PTR_~MetaClass_000750b0;
pointer PTR_~IOAccelGLContext2_000744f0;
pointer IOAccelGLContext2_ktv;
pointer methodDispatchDescs;
undefined DAT_000010f0;
undefined8 sGLContextMethodsDispatch;
undefined DAT_000010aa;
undefined DAT_000010ac;
undefined DAT_000010ae;
undefined DAT_000010b0;
undefined DAT_000010b2;
undefined DAT_000011c8;
undefined DAT_00001128;
pointer PTR_~MetaClass_00075aa8;
pointer PTR_~IOAccelGPURestartReport2_00075240;
pointer IOAccelGPURestartReport2_ktv;
undefined1 kalloc_type_view_1122;
undefined1 kalloc_type_view_1158;
pointer PTR_~MetaClass_00075cd8;
pointer PTR_~IOAccelBlockFencePort2_00075ba0;
pointer IOAccelBlockFencePort2_ktv;
pointer PTR_~MetaClass_00075f10;
pointer PTR_~IOAccelEventFence_00075dd0;
pointer IOAccelEventFence_ktv;
pointer PTR_~MetaClass_00076158;
pointer PTR_~IOAccelBlockFence_00076008;
pointer IOAccelBlockFence_ktv;
pointer PTR_~MetaClass_00076390;
pointer PTR_~IOAccelSharedEventFence_00076250;
pointer IOAccelSharedEventFence_ktv;
pointer PTR_~MetaClass_000765c8;
pointer PTR_~IOAccelExternalEventFence_00076488;
pointer IOAccelExternalEventFence_ktv;
pointer PTR_~MetaClass_00076800;
pointer PTR_~IOAccelContextEventFence_000766c0;
pointer IOAccelContextEventFence_ktv;
pointer PTR_~MetaClass_00076a28;
pointer PTR_~IOAccelFenceMachine_000768f8;
pointer IOAccelFenceMachine_ktv;
undefined fence_timeout;
undefined eventfence_notifier;
pointer PTR_~MetaClass_00076ca0;
pointer PTR_~IOAccelMemoryAllocator2_00076b40;
pointer IOAccelMemoryAllocator2_ktv;
pointer kalloc_type_view_66;
pointer kalloc_type_view_90;
pointer kalloc_type_view_199;
pointer kalloc_type_view_213;
pointer PTR_~MetaClass_00076ee0;
pointer PTR_~IOAccelKernelMappedMemory_00076d98;
pointer IOAccelKernelMappedMemory_ktv;
pointer PTR_~MetaClass_00077130;
pointer PTR_~IOAccelDeviceShmem_00076fd8;
pointer IOAccelDeviceShmem_ktv;
pointer PTR_~MetaClass_00077360;
pointer PTR_~IOAccelTraceStreamConnection_00077228;
pointer IOAccelTraceStreamConnection_ktv;
long *DAT_000828e0;
undefined8 gTraceStreamLock;
undefined1 gTraceStreamInit;
undefined8 gTraceStreamList;
undefined kTraceDebugCallback;
IOAccelTraceStreamConnection *DAT_000828e0;
pointer PTR_~MetaClass_000775d8;
pointer PTR_~IOAccelTraceStream2_00077458;
pointer IOAccelTraceStream2_ktv;
undefined8 ___ktrace_end_of_last_flush;
pointer PTR_~MetaClass_00077960;
pointer PTR_~IOAccelResource2_000776d0;
pointer IOAccelResource2_ktv;
pointer kalloc_type_view_377;
pointer kalloc_type_view_1909;
byte DAT_00082622;
pointer PTR_~MetaClass_00077c80;
pointer PTR_~IOAccelRemoteMemory_00077a58;
pointer IOAccelRemoteMemory_ktv;
undefined1 kalloc_type_view_88;
undefined1 kalloc_type_view_109;
undefined1 kalloc_type_view_118;
pointer PTR_~MetaClass_00077eb0;
pointer PTR_~IOAccelSharedNamespace2_00077d80;
pointer IOAccelSharedNamespace2_ktv;
pointer PTR_~MetaClass_00078128;
pointer PTR_~IOAccelShared2_00077fa8;
pointer IOAccelShared2_ktv;
pointer kalloc_type_view_524;
pointer kalloc_type_view_548;
undefined1 kalloc_type_view_528;
pointer kalloc_type_view_596;
pointer kalloc_type_view_814;
pointer kalloc_type_view_882;
undefined1 kalloc_type_view_869;
undefined *PTR_metaClass_0006b040;
pointer PTR_~MetaClass_00078bd8;
pointer PTR_~IOAccelSharedUserClient2_00078220;
pointer IOAccelSharedUserClient2_ktv;
pointer PTR_s_set_resources_purgeable_00079238;
pointer methods;
pointer sSharedMethods;
pointer PTR_~MetaClass_00079458;
pointer PTR_~IOAccelStatistics2_000792c0;
pointer IOAccelStatistics2_ktv;
undefined serialize_internal_stats_reset;
undefined serialize_internal_stats_noreset;
undefined serialize_surface_list;
undefined serialize_agc_info;
undefined serialize_performance_stats_reset;
undefined serialize_performance_stats_noreset;
undefined UNK_00079528;
pointer PTR_~MetaClass_00079c50;
pointer PTR_~IOAccelEventMachineFast2_00079940;
pointer IOAccelEventMachineFast2_ktv;
pointer PTR_~MetaClass_0007a750;
pointer PTR_~IOAccelLegacyDisplayPipe_00079d48;
pointer IOAccelLegacyDisplayPipe_ktv;
pointer PTR_~MetaClass_0007a9c8;
pointer PTR_~IOAccelSegmentResourceList_0007a848;
pointer IOAccelSegmentResourceList_ktv;
undefined1 kalloc_type_view_49;
undefined1 kalloc_type_view_145;
pointer PTR_~MetaClass_0007b510;
pointer PTR_~IOAccelSurface_0007aac0;
pointer IOAccelSurface_ktv;
undefined DAT_000010dc;
undefined DAT_000010d1;
undefined DAT_000010d8;
undefined DAT_000012c8;
Alignment UNK_00038b73;
undefined DAT_0006ae74;
undefined DAT_0006ae9c;
undefined DAT_0006aea8;
pointer PTR_~MetaClass_0007bb78;
pointer PTR_~IOAccelTask_0007b9c8;
pointer IOAccelTask_ktv;
pointer PTR_~MetaClass_0007c7f8;
pointer PTR_~IOAccelVideoContext2_0007bc70;
pointer IOAccelVideoContext2_ktv;
undefined *PTR_gMetaClass_0006b028;
pointer PTR_~MetaClass_0007d3f8;
pointer PTR_~IOGraphicsAccelerator2_0007c8f0;
pointer PTR_init_000814e0;
pointer PTR_init_00081520;
pointer IOGraphicsAccelerator2_ktv;
undefined *PTR_vtable_0006b090;
undefined *PTR_metaClass_0006b038;
undefined *PTR_metaClass_0006b050;
undefined *PTR_metaClass_0006b060;
undefined *PTR__gIOServicePlane_0006b0c8;
undefined *PTR_metaClass_0006b008;
section section_00000068;
segment_command segment_command_000001a8;
undefined DAT_000012c0;
undefined operator.new;
undefined garbage_collector;
undefined reusable_orphaned_memory_pool_collector;
undefined nonreusable_orphaned_memory_pool_collector;
undefined fence_collector;
undefined memory_pool_interrupt;
undefined garbage_collector_timer;
undefined gart_collector;
undefined gart_collector_timer;
undefined reusable_orphaned_memory_pool_timer;
undefined nonreusable_orphaned_memory_pool_timer;
undefined finalize_interrupt;
undefined memory_pool_timer;
undefined send_agc_status_message;
undefined display_post_transaction_interrupt;
undefined8 __global_comm_page_memory_descriptor;
mach_header MACH_HEADER;
undefined DAT_00082628;
undefined ___ktrace_enable_callback_registered;
undefined DAT_00082630;
undefined1 ___ktrace_enable_filter;
undefined DAT_00082638;
undefined operator.delete;
section section_000000b8;
section section_00000330;
undefined DAT_00000670;
section section_00000108;
section section_00000158;
pointer PTR_init_0007d500;
section section_000001f0;
section section_000002e0;
undefined DAT_000006a8;
undefined deviceCacheControl;
undefined DAT_00001138;
undefined *PTR_metaClass_0006b058;
segment_command segment_command_00000420;
undefined4 ___ktrace_display_enabled;
byte DAT_00082624;
undefined *PTR__kdebug_enable_0006b0f8;
undefined1 DAT_00082621;
undefined4 ___ktrace_vendor_legacy_enabled;
undefined1 flushedSinceEnable;
byte DAT_00082630;
undefined *PTR_metaClass_0006b020;
undefined *PTR_OutputHost64_0006b010;
pointer PTR_~MetaClass_0007d690;
pointer PTR_~IOAccelRangeAllocator_0007d530;
pointer IOAccelRangeAllocator_ktv;
pointer kalloc_type_view_87;
pointer kalloc_type_view_196;
pointer kalloc_type_view_209;
pointer PTR_~MetaClass_0007e2c0;
pointer PTR_~IOAccelCommandQueue_0007d820;
pointer IOAccelCommandQueue_ktv;
pointer sCommandQueueMethods;
undefined1 kalloc_type_view_950;
undefined1 kalloc_type_view_972;
undefined1 kalloc_type_view_986;
undefined1 kalloc_type_view_1097;
undefined8 submission_id_counter;
undefined8 segment_id_counter;
undefined8 gpu_submission_id_counter;
pointer PTR_~MetaClass_0007e4f0;
pointer PTR_~IOAccelAllocationInfo_0007e3b8;
pointer IOAccelAllocationInfo_ktv;
pointer kalloc_type_view_74;
pointer kalloc_type_view_532;
pointer PTR_~MetaClass_0007ef90;
pointer PTR_~IOAccelDisplayPipe_0007e5e8;
pointer IOAccelDisplayPipe_ktv;
undefined display_change_handler;
pointer kalloc_type_view_67;
pointer kalloc_type_view_71;
pointer kalloc_type_view_171;
pointer kalloc_type_view_176;
undefined transaction_queue_idle_gated;
undefined get_finished_transactions_gated;
undefined release_live_transaction_gated;
undefined teardown_workloop_gated;
undefined signalVBLInterrupt;
pointer kalloc_type_view_2849;
undefined wait_for_queue_slot_gated;
undefined transaction_queue_gated;
undefined transaction_wait_gated;
undefined event_interrupt_gated;
undefined vbl_interrupt_gated;
undefined transaction_timeout_timer_fired;
undefined report_vrr_timestamp_gated;
undefined transaction_interrupt_gated;
undefined request_notify_gated;
undefined remove_notify_gated;
undefined4 _reltable._ZN18IOAccelDisplayPipe6triageEPPcPy;
pointer PTR_~MetaClass_0007f1f8;
pointer PTR_~IOAccelDisplayPipeTransaction2_0007f088;
pointer IOAccelDisplayPipeTransaction2_ktv;
pointer kalloc_type_view_2914;
pointer PTR_~MetaClass_0007f420;
pointer PTR_~IOAccelDisplayPipeGammaTable2_0007f2f0;
pointer IOAccelDisplayPipeGammaTable2_ktv;
pointer PTR_~MetaClass_0007f648;
pointer PTR_~IOAccelDisplayPipePreCSCLinearizationVID_0007f518;
pointer IOAccelDisplayPipePreCSCLinearizationVID_ktv;
pointer PTR_~MetaClass_0007f870;
pointer PTR_~IOAccelDisplayPipePostCSCGammaVID_0007f740;
pointer IOAccelDisplayPipePostCSCGammaVID_ktv;
pointer PTR_~MetaClass_00080438;
pointer PTR_~IOAccelDisplayPipeUserClient2_0007fac0;
pointer IOAccelDisplayPipeUserClient2_ktv;
pointer PTR_~MetaClass_00080ea8;
pointer PTR_~IOAccelMemoryInfoUserClient_00080530;
pointer IOAccelMemoryInfoUserClient_ktv;
undefined *PTR__kOSBooleanTrue_0006b0f0;
pointer PTR_~MetaClass_000811c8;
pointer PTR_~IOAccelMemoryMap_00080fe8;
pointer IOAccelMemoryMap_ktv;
undefined1 kalloc_type_view_212;
undefined1 kalloc_type_view_497;
undefined1 kalloc_type_view_500;
pointer PTR_~MetaClass_000813f8;
pointer PTR_~IOAccelMTLEvent2_000812c0;
pointer IOAccelMTLEvent2_ktv;
undefined1 kalloc_type_view_56;
pointer kalloc_type_view_97;
undefined1 kalloc_type_view_101;
pointer kalloc_type_view_290;
pointer kalloc_type_view_202;
pointer PTR_~MetaClass_00081798;
pointer PTR_~IOAccelSysMemory_00081570;
pointer IOAccelSysMemory_ktv;
undefined1 kalloc_type_view_97;
undefined1 kalloc_type_view_389;
undefined1 kalloc_type_view_408;
undefined1 kalloc_type_view_432;
pointer PTR_~MetaClass_00081ad0;
pointer PTR_~IOAccelVidMemory_00081890;
pointer IOAccelVidMemory_ktv;
pointer PTR_~MetaClass_00081cf8;
pointer PTR_~IOAccelBufferMemoryDescriptorPool2_00081bc8;
pointer IOAccelBufferMemoryDescriptorPool2_ktv;
undefined4 DAT_0006af84;
undefined1 kalloc_type_view_115;
undefined4 sWiredPoolInfo;
undefined4 DAT_0006af88;
undefined4 sPurgeablePoolInfo;
undefined4 DAT_0006afc4;
undefined1 kalloc_type_view_133;
undefined4 DAT_0006afc8;
undefined *PTR_vtable_0006b098;
undefined1 kalloc_type_view_167;
undefined1 kalloc_type_view_168;
undefined1 kalloc_type_view_169;
undefined1 kalloc_type_view_485;
undefined8 __realmain;
string s_com.apple.iokit.IOAcceleratorFam_00081de0;
string s_1.0.0d1_00081e20;
undefined4 DAT_00081ddc;
undefined8 __antimain;

// IOAccelLegacyDisplayMachine::MetaClass::MetaClass()

void __thiscall IOAccelLegacyDisplayMachine::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelLegacyDisplayMachine",
             (OSMetaClass *)&IOAccelDisplayMachine::gMetaClass,0x1f8);
  *(undefined ***)this = &PTR__MetaClass_0006bd68;
  return;
}



// IOAccelLegacyDisplayMachine::MetaClass::~MetaClass()

void __thiscall IOAccelLegacyDisplayMachine::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelLegacyDisplayMachine::IOAccelLegacyDisplayMachine(OSMetaClass const*)

void __thiscall
IOAccelLegacyDisplayMachine::IOAccelLegacyDisplayMachine
          (IOAccelLegacyDisplayMachine *this,OSMetaClass *param_1)

{
  IOAccelDisplayMachine::IOAccelDisplayMachine((IOAccelDisplayMachine *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelLegacyDisplayMachine_0006b400;
  return;
}



// IOAccelLegacyDisplayMachine::~IOAccelLegacyDisplayMachine()

void __thiscall
IOAccelLegacyDisplayMachine::~IOAccelLegacyDisplayMachine(IOAccelLegacyDisplayMachine *this)

{
  IOAccelDisplayMachine::~IOAccelDisplayMachine((IOAccelDisplayMachine *)this);
  return;
}



// IOAccelLegacyDisplayMachine::~IOAccelLegacyDisplayMachine()

void __thiscall IOAccelLegacyDisplayMachine::~IOAccelLegacyDisplayMachine(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelLegacyDisplayMachine::~IOAccelLegacyDisplayMachine()

void __thiscall IOAccelLegacyDisplayMachine::~IOAccelLegacyDisplayMachine(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelLegacyDisplayMachine::getMetaClass() const

undefined ** IOAccelLegacyDisplayMachine::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelLegacyDisplayMachine::MetaClass::MetaClass()

void __thiscall IOAccelLegacyDisplayMachine::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelLegacyDisplayMachine",
             (OSMetaClass *)&IOAccelDisplayMachine::gMetaClass,0x1f8);
  *(undefined ***)this = &PTR__MetaClass_0006bd68;
  return;
}



// IOAccelLegacyDisplayMachine::MetaClass::alloc() const

undefined8 IOAccelLegacyDisplayMachine::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelLegacyDisplayMachine::operator new(unsigned long)

void * __thiscall IOAccelLegacyDisplayMachine::operator_new(IOAccelLegacyDisplayMachine *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelLegacyDisplayMachine_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelLegacyDisplayMachine::operator delete(void*, unsigned long)

void __cdecl IOAccelLegacyDisplayMachine::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelLegacyDisplayMachine_ktv,param_1,param_2);
  return;
}



// IOAccelLegacyDisplayMachine::needsSecondaryFramebufferResources()

undefined8 IOAccelLegacyDisplayMachine::needsSecondaryFramebufferResources(void)

{
  return 0;
}



// IOAccelLegacyDisplayMachine::getScanoutWidth(unsigned int) const

void __thiscall
IOAccelLegacyDisplayMachine::getScanoutWidth(IOAccelLegacyDisplayMachine *this,uint param_1)

{
  IOAccelLegacyDisplayPipe::getScanoutWidth
            (*(IOAccelLegacyDisplayPipe **)(this + (ulong)param_1 * 8 + 0x178));
  return;
}



// IOAccelLegacyDisplayMachine::getScanoutHeight(unsigned int) const

void __thiscall
IOAccelLegacyDisplayMachine::getScanoutHeight(IOAccelLegacyDisplayMachine *this,uint param_1)

{
  IOAccelLegacyDisplayPipe::getScanoutHeight
            (*(IOAccelLegacyDisplayPipe **)(this + (ulong)param_1 * 8 + 0x178));
  return;
}



// IOAccelLegacyDisplayMachine::getFramebufferPixelBytes(unsigned int) const

void __thiscall
IOAccelLegacyDisplayMachine::getFramebufferPixelBytes
          (IOAccelLegacyDisplayMachine *this,uint param_1)

{
  IOAccelLegacyDisplayPipe::getBytesPerPixel
            (*(IOAccelLegacyDisplayPipe **)(this + (ulong)param_1 * 8 + 0x178));
  return;
}



// IOAccelLegacyDisplayMachine::getFramebufferStereoMode(unsigned int) const

undefined8 IOAccelLegacyDisplayMachine::getFramebufferStereoMode(void)

{
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelLegacyDisplayMachine::getDisplayResource(unsigned int, unsigned int) const

void __cdecl IOAccelLegacyDisplayMachine::getDisplayResource(long param_1,ulong param_2)

{
  IOAccelLegacyDisplayPipe::getDisplayResource
            (*(long *)(param_1 + 0x178 + (param_2 & 0xffffffff) * 8));
  return;
}



// IOAccelLegacyDisplayMachine::getFullScreenSurface(unsigned int) const

void __thiscall
IOAccelLegacyDisplayMachine::getFullScreenSurface(IOAccelLegacyDisplayMachine *this,uint param_1)

{
  IOAccelLegacyDisplayPipe::getFullScreenSurface
            (*(IOAccelLegacyDisplayPipe **)(this + (ulong)param_1 * 8 + 0x178));
  return;
}



// IOAccelLegacyDisplayMachine::getWindowServerFullScreenAssemblySurface(unsigned int) const

void __thiscall
IOAccelLegacyDisplayMachine::getWindowServerFullScreenAssemblySurface
          (IOAccelLegacyDisplayMachine *this,uint param_1)

{
  IOAccelLegacyDisplayPipe::getWindowServerFullScreenAssemblySurface
            (*(IOAccelLegacyDisplayPipe **)(this + (ulong)param_1 * 8 + 0x178));
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelLegacyDisplayMachine::getScanoutResource(unsigned int, unsigned int) const

void __cdecl IOAccelLegacyDisplayMachine::getScanoutResource(long param_1,ulong param_2)

{
  IOAccelLegacyDisplayPipe::getScanoutResource
            (*(long *)(param_1 + 0x178 + (param_2 & 0xffffffff) * 8));
  return;
}



// IOAccelLegacyDisplayMachine::getScanoutSurface(unsigned int) const

void __thiscall
IOAccelLegacyDisplayMachine::getScanoutSurface(IOAccelLegacyDisplayMachine *this,uint param_1)

{
  IOAccelLegacyDisplayPipe::getScanoutSurface
            (*(IOAccelLegacyDisplayPipe **)(this + (ulong)param_1 * 8 + 0x178));
  return;
}



// IOAccelLegacyDisplayMachine::getLegacyDisplayPipe(unsigned int) const

undefined8 __thiscall
IOAccelLegacyDisplayMachine::getLegacyDisplayPipe(IOAccelLegacyDisplayMachine *this,uint param_1)

{
  return *(undefined8 *)(this + (ulong)param_1 * 8 + 0x178);
}



// IOAccelLegacyDisplayMachine::is_framebuffer_safe_for_exclusive(unsigned int) const

void __thiscall
IOAccelLegacyDisplayMachine::is_framebuffer_safe_for_exclusive
          (IOAccelLegacyDisplayMachine *this,uint param_1)

{
  IOAccelLegacyDisplayPipe::is_safe_for_exclusive
            (*(IOAccelLegacyDisplayPipe **)(this + (ulong)param_1 * 8 + 0x178));
  return;
}



// IOAccelLegacyDisplayMachine::isCurrentFramebufferModeAcceleratorBacked(unsigned int)

void __thiscall
IOAccelLegacyDisplayMachine::isCurrentFramebufferModeAcceleratorBacked
          (IOAccelLegacyDisplayMachine *this,uint param_1)

{
  IOAccelLegacyDisplayPipe::is_current_mode_accelerator_backed
            (*(IOAccelLegacyDisplayPipe **)(this + (ulong)param_1 * 8 + 0x178));
  return;
}



// IOAccelLegacyDisplayMachine::found_framebuffer(IOFramebuffer*)

ulong __thiscall
IOAccelLegacyDisplayMachine::found_framebuffer(IOAccelLegacyDisplayMachine *this,long param_2)

{
  ulong uVar1;
  long lVar2;
  ulong unaff_R14;
  
  uVar1 = IOAccelDisplayMachine::found_framebuffer((IOAccelDisplayMachine *)this,param_2);
  if (((char)uVar1 != '\0') && (*(int *)(this + 0x108) != 0)) {
    uVar1 = 0;
    do {
      lVar2 = OSMetaClassBase::safeMetaCast
                        (*(OSMetaClassBase **)(this + uVar1 * 8 + 0x88),
                         (OSMetaClass *)&IOAccelLegacyDisplayPipe::gMetaClass);
      *(long *)(this + uVar1 * 8 + 0x178) = lVar2;
      if (lVar2 != *(long *)(this + uVar1 * 8 + 0x88)) {
        found_framebuffer();
        return unaff_R14;
      }
      uVar1 = uVar1 + 1;
    } while (uVar1 < *(uint *)(this + 0x108));
  }
  return unaff_R14;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelLegacyDisplayMachine::display_mode_will_change(unsigned int)

ulong __cdecl IOAccelLegacyDisplayMachine::display_mode_will_change(long *param_1)

{
  int iVar1;
  bool bVar2;
  uint uVar3;
  OSMetaClassBase *pOVar4;
  IOAccelLegacySurface *this;
  IOGraphicsAccelerator2 *pIVar5;
  ulong uVar6;
  undefined1 *local_28;
  
  pIVar5 = (IOGraphicsAccelerator2 *)param_1[0x25];
  _OSIncrementAtomic(pIVar5 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar5 + 0x88));
  _OSDecrementAtomic(pIVar5 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar5);
  (**(code **)(*(long *)pIVar5 + 0x850))(pIVar5,"",0);
  iVar1 = *(int *)((long)param_1 + 0x10c);
  *(int *)((long)param_1 + 0x10c) = iVar1 + 1;
  pIVar5 = (IOGraphicsAccelerator2 *)param_1[0x25];
  if (iVar1 == 0) {
    (**(code **)(**(long **)(pIVar5 + 0x380) + 0x158))();
    if ((int)param_1[0x21] != 0) {
      uVar6 = 0;
      do {
        IOAccelLegacyDisplayPipe::save_scanout_surface
                  ((IOAccelLegacyDisplayPipe *)param_1[uVar6 + 0x2f]);
        IOAccelLegacyDisplayPipe::save_fullscreen_surface
                  ((IOAccelLegacyDisplayPipe *)param_1[uVar6 + 0x2f]);
        uVar6 = uVar6 + 1;
      } while (uVar6 < *(uint *)(param_1 + 0x21));
      if (*(uint *)(param_1 + 0x21) != 0) {
        uVar6 = 0;
        do {
          (**(code **)(*(long *)param_1[uVar6 + 0x11] + 0x868))();
          uVar6 = uVar6 + 1;
        } while (uVar6 < *(uint *)(param_1 + 0x21));
        if (*(uint *)(param_1 + 0x21) != 0) {
          uVar6 = 0;
          do {
            bVar2 = IOAccelLegacyDisplayPipe::isAcceleratorBacked
                              ((IOAccelLegacyDisplayPipe *)param_1[uVar6 + 0x2f]);
            if (bVar2) {
              IOAccelLegacyDisplayPipe::destroy_scanout_resource
                        ((IOAccelLegacyDisplayPipe *)param_1[uVar6 + 0x2f],
                         *(IOAccelResource2 **)
                          ((IOAccelLegacyDisplayPipe *)param_1[uVar6 + 0x2f] + 0x358));
            }
            bVar2 = IOAccelDisplayPipe::isActive((IOAccelDisplayPipe *)param_1[uVar6 + 0x11]);
            if (bVar2) {
              IOAccelDisplayPipe::destroy_framebuffer_resource
                        ((IOAccelDisplayPipe *)param_1[uVar6 + 0x11],
                         *(IOAccelResource2 **)((IOAccelDisplayPipe *)param_1[uVar6 + 0x11] + 0xe0))
              ;
            }
            uVar6 = uVar6 + 1;
          } while (uVar6 < *(uint *)(param_1 + 0x21));
        }
      }
    }
    local_28 = &DAT_aaaaaaaaaaaaaaaa;
    IOAccelSurfaceList::Iterator::Iterator
              ((Iterator *)&local_28,(undefined8 *)(param_1[0x25] + 0xaa8));
    pOVar4 = (OSMetaClassBase *)IOAccelSurfaceList::Iterator::getNextSurface((Iterator *)&local_28);
    this = (IOAccelLegacySurface *)
           OSMetaClassBase::safeMetaCast(pOVar4,(OSMetaClass *)&IOAccelLegacySurface::gMetaClass);
    if (this != (IOAccelLegacySurface *)0x0) {
      do {
        IOAccelLegacySurface::pick_present_type(this);
        pOVar4 = (OSMetaClassBase *)
                 IOAccelSurfaceList::Iterator::getNextSurface((Iterator *)&local_28);
        this = (IOAccelLegacySurface *)
               OSMetaClassBase::safeMetaCast
                         (pOVar4,(OSMetaClass *)&IOAccelLegacySurface::gMetaClass);
      } while (this != (IOAccelLegacySurface *)0x0);
    }
    pIVar5 = (IOGraphicsAccelerator2 *)param_1[0x25];
    uVar3 = *(uint *)(pIVar5 + 0xc90);
    if ((~uVar3 & 0x1200000) == 0) {
      IOGraphicsAccelerator2::unload_dirty_resources(pIVar5);
      pIVar5 = (IOGraphicsAccelerator2 *)param_1[0x25];
      uVar3 = *(uint *)(pIVar5 + 0xc90);
    }
    if ((uVar3 >> 0x17 & 1) != 0) {
      (**(code **)(*(long *)pIVar5 + 0x958))();
      (**(code **)(*(long *)param_1[0x25] + 0x948))();
      pIVar5 = (IOGraphicsAccelerator2 *)param_1[0x25];
    }
    (**(code **)(**(long **)(pIVar5 + 0x380) + 0x158))();
    uVar3 = (**(code **)(*param_1 + 0x868))(param_1);
    uVar6 = (ulong)uVar3;
    if ((char)uVar3 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: vendor driver returned false\n",
                        "virtual bool IOAccelLegacyDisplayMachine::display_mode_will_change(uint32_t)"
                       );
    }
    IOGraphicsAccelerator2::disableAccelerator((IOGraphicsAccelerator2 *)param_1[0x25]);
    pIVar5 = (IOGraphicsAccelerator2 *)param_1[0x25];
    (**(code **)(*(long *)pIVar5 + 0x858))(pIVar5,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar5);
    _IOLockUnlock(*(undefined8 *)(pIVar5 + 0x88));
  }
  else {
    (**(code **)(*(long *)pIVar5 + 0x858))(pIVar5,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar5);
    _IOLockUnlock(*(undefined8 *)(pIVar5 + 0x88));
    uVar6 = CONCAT71((int7)((ulong)pIVar5 >> 8),1);
  }
  return uVar6 & 0xffffffff;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelLegacyDisplayMachine::display_mode_did_change(unsigned int)

undefined8 __cdecl IOAccelLegacyDisplayMachine::display_mode_did_change(long *param_1)

{
  long *plVar1;
  int *piVar2;
  int iVar3;
  IOGraphicsAccelerator2 *pIVar4;
  uint uVar5;
  char cVar6;
  IOAccelSurface *this;
  undefined8 uVar7;
  uint uVar8;
  undefined8 extraout_RDX;
  char *pcVar9;
  ulong uVar10;
  undefined1 *local_30;
  
  plVar1 = param_1 + 0x25;
  pIVar4 = (IOGraphicsAccelerator2 *)param_1[0x25];
  _OSIncrementAtomic(pIVar4 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar4 + 0x88));
  _OSDecrementAtomic(pIVar4 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar4);
  pcVar9 = "";
  (**(code **)(*(long *)pIVar4 + 0x850))(pIVar4,"",0);
  piVar2 = (int *)((long)param_1 + 0x10c);
  *piVar2 = *piVar2 + -1;
  if (*piVar2 == 0) {
    cVar6 = (**(code **)(*param_1 + 0x870))(param_1);
    if (cVar6 == '\0') {
      display_mode_did_change(plVar1);
      return 0;
    }
    if (*(long *)((IOGraphicsAccelerator2 *)*plVar1 + 0x180) != 0) {
      IOGraphicsAccelerator2::enableAccelerator
                ((IOGraphicsAccelerator2 *)*plVar1,pcVar9,extraout_RDX);
      _IOLockWakeup_darwin14(*(undefined8 *)(*plVar1 + 0x88),*plVar1,0);
    }
    if ((int)param_1[0x21] != 0) {
      uVar10 = 0;
      do {
        (**(code **)(*(long *)param_1[uVar10 + 0x11] + 0x870))();
        uVar10 = uVar10 + 1;
      } while (uVar10 < *(uint *)(param_1 + 0x21));
    }
    local_30 = &DAT_aaaaaaaaaaaaaaaa;
    IOAccelSurfaceList::Iterator::Iterator((Iterator *)&local_30,(undefined8 *)(*plVar1 + 0xaa8));
    this = (IOAccelSurface *)IOAccelSurfaceList::Iterator::getNextSurface((Iterator *)&local_30);
    if (this != (IOAccelSurface *)0x0) {
      do {
        IOAccelSurface::reset_access(this);
        IOAccelLegacySurface::pick_present_type((IOAccelLegacySurface *)this);
        this = (IOAccelSurface *)IOAccelSurfaceList::Iterator::getNextSurface((Iterator *)&local_30)
        ;
      } while (this != (IOAccelSurface *)0x0);
    }
    if (((byte)((IOGraphicsAccelerator2 *)*plVar1)[0xc92] & 0x20) != 0) {
      if ((ulong)*(uint *)(param_1 + 0x21) != 0) {
        uVar10 = 0;
LAB_000019c7:
        iVar3 = *(int *)(*(long *)(param_1[uVar10 + 0x11] + 0xe0) + 200 +
                        (ulong)(*(long *)(*(long *)(param_1[uVar10 + 0x11] + 0xe0) + 0x88) == 0) * 8
                        );
        if (iVar3 == 0) goto code_r0x000019ef;
        uVar5 = 0x2000000;
        do {
          uVar8 = uVar5;
          uVar5 = uVar8 * 2;
        } while (uVar8 < (uint)(iVar3 * 6));
        uVar5 = 0x10000000;
        if (uVar8 < 0x10000000) {
          uVar5 = uVar8;
        }
        IOGraphicsAccelerator2::update_gc_low_water_mark
                  ((IOGraphicsAccelerator2 *)*plVar1,(ulong)uVar5);
        if ((int)param_1[0x21] != (int)uVar10) goto LAB_00001a31;
      }
LAB_00001a24:
      IOGraphicsAccelerator2::update_gc_low_water_mark((IOGraphicsAccelerator2 *)*plVar1,0x2000000);
    }
  }
LAB_00001a31:
  pIVar4 = (IOGraphicsAccelerator2 *)*plVar1;
  (**(code **)(*(long *)pIVar4 + 0x858))(pIVar4,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar4);
  uVar7 = _IOLockUnlock(*(undefined8 *)(pIVar4 + 0x88));
  return CONCAT71((int7)((ulong)uVar7 >> 8),1);
code_r0x000019ef:
  uVar10 = uVar10 + 1;
  if (*(uint *)(param_1 + 0x21) == uVar10) goto LAB_00001a24;
  goto LAB_000019c7;
}



// IOAccelLegacyDisplayMachine::find_primary_display_pipe(IOAccelLegacyDisplayPipe*)

long * __thiscall
IOAccelLegacyDisplayMachine::find_primary_display_pipe
          (IOAccelLegacyDisplayMachine *this,long *param_1)

{
  byte bVar1;
  char cVar2;
  ulong uVar3;
  
  if (*(int *)(this + 0x108) != 0) {
    uVar3 = 0;
    do {
      bVar1 = IOAccelLegacyDisplayPipe::isMirrored
                        (*(IOAccelLegacyDisplayPipe **)(this + uVar3 * 8 + 0x178));
      if (((bVar1 != 0) &&
          (bVar1 = IOAccelLegacyDisplayPipe::isMirrorPrimary
                             (*(IOAccelLegacyDisplayPipe **)(this + uVar3 * 8 + 0x178)), bVar1 != 0)
          ) && (cVar2 = (**(code **)(*param_1 + 0x9b0))
                                  (param_1,*(undefined8 *)(this + uVar3 * 8 + 0x178)), cVar2 != '\0'
               )) {
        return *(long **)(this + uVar3 * 8 + 0x178);
      }
      uVar3 = uVar3 + 1;
    } while (uVar3 < *(uint *)(this + 0x108));
  }
  return param_1;
}



// IOAccelLegacyDisplayMachine::framebuffer_will_power_off(unsigned int)

undefined8 __thiscall
IOAccelLegacyDisplayMachine::framebuffer_will_power_off
          (IOAccelLegacyDisplayMachine *this,ulong param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  IOAccelLegacyDisplayPipe *this_00;
  byte bVar2;
  char cVar3;
  long *plVar4;
  undefined8 uVar5;
  ulong uVar6;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  this_00 = *(IOAccelLegacyDisplayPipe **)(this + (param_1 & 0xffffffff) * 8 + 0x178);
  bVar2 = IOAccelLegacyDisplayPipe::isMirrored(this_00);
  if (bVar2 == 0) {
    (**(code **)(*(long *)this_00 + 0x978))(this_00);
  }
  else {
    plVar4 = find_primary_display_pipe(this,(long *)this_00);
    (**(code **)(*plVar4 + 0x978))(plVar4);
    if (*(int *)(this + 0x108) != 0) {
      uVar6 = 0;
      do {
        if ((*(long **)(this + uVar6 * 8 + 0x88) != plVar4) &&
           (cVar3 = (**(code **)(**(long **)(this + uVar6 * 8 + 0x178) + 0x9b0))
                              (*(long **)(this + uVar6 * 8 + 0x178),plVar4), cVar3 != '\0')) {
          (**(code **)(**(long **)(this + uVar6 * 8 + 0x178) + 0x978))();
        }
        uVar6 = uVar6 + 1;
      } while (uVar6 < *(uint *)(this + 0x108));
    }
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  uVar5 = _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return CONCAT71((int7)((ulong)uVar5 >> 8),1);
}



// IOAccelLegacyDisplayMachine::framebuffer_did_power_on(unsigned int)

undefined8 __thiscall
IOAccelLegacyDisplayMachine::framebuffer_did_power_on
          (IOAccelLegacyDisplayMachine *this,ulong param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  IOAccelLegacyDisplayPipe *this_00;
  long *plVar2;
  byte bVar3;
  char cVar4;
  long *plVar5;
  undefined8 uVar6;
  ulong uVar7;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  this_00 = *(IOAccelLegacyDisplayPipe **)(this + (param_1 & 0xffffffff) * 8 + 0x178);
  bVar3 = IOAccelLegacyDisplayPipe::isMirrored(this_00);
  if (bVar3 == 0) {
    (**(code **)(*(long *)this_00 + 0x980))(this_00);
  }
  else {
    plVar5 = find_primary_display_pipe(this,(long *)this_00);
    (**(code **)(*plVar5 + 0x980))(plVar5);
    if (*(int *)(this + 0x108) != 0) {
      uVar7 = 0;
      do {
        plVar2 = *(long **)(this + uVar7 * 8 + 0x178);
        if ((plVar2 != plVar5) &&
           (cVar4 = (**(code **)(*plVar2 + 0x9b0))(plVar2,plVar5), cVar4 != '\0')) {
          (**(code **)(**(long **)(this + uVar7 * 8 + 0x178) + 0x980))();
        }
        uVar7 = uVar7 + 1;
      } while (uVar7 < *(uint *)(this + 0x108));
    }
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  uVar6 = _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return CONCAT71((int7)((ulong)uVar6 >> 8),1);
}



// IOAccelLegacyDisplayMachine::setup_scanout(IOAccelLegacySurface*)

void __thiscall
IOAccelLegacyDisplayMachine::setup_scanout(IOAccelLegacyDisplayMachine *this,long param_1)

{
  IOAccelLegacyDisplayPipe::setup_scanout
            (*(IOAccelLegacyDisplayPipe **)(this + (ulong)*(uint *)(param_1 + 0x1398) * 8 + 0x178),
             param_1);
  return;
}



// IOAccelLegacyDisplayMachine::reset_scanout(unsigned int)

void __thiscall
IOAccelLegacyDisplayMachine::reset_scanout(IOAccelLegacyDisplayMachine *this,uint param_1)

{
  IOAccelLegacyDisplayPipe::reset_scanout
            (*(IOAccelLegacyDisplayPipe **)(this + (ulong)param_1 * 8 + 0x178));
  return;
}



// IOAccelLegacyDisplayMachine::setup_fullscreen(IOAccelLegacySurface*)

void __thiscall
IOAccelLegacyDisplayMachine::setup_fullscreen(IOAccelLegacyDisplayMachine *this,long param_1)

{
  char cVar1;
  ulong uVar2;
  ulong uVar3;
  
  if (*(char *)(param_1 + 0x138c) != '\0') {
    IOAccelLegacyDisplayPipe::setup_scanout
              (*(IOAccelLegacyDisplayPipe **)(this + (ulong)*(uint *)(param_1 + 0x1398) * 8 + 0x178)
               ,param_1);
    return;
  }
  uVar3 = (ulong)*(uint *)(param_1 + 0x1390);
  IOAccelLegacyDisplayPipe::setup_fullscreen
            (*(IOAccelLegacyDisplayPipe **)(this + uVar3 * 8 + 0x178),param_1);
  if (*(int *)(this + 0x108) != 0) {
    uVar2 = 0;
    do {
      if (uVar3 != uVar2) {
        cVar1 = (**(code **)(*(long *)this + 0x928))(this,uVar2 & 0xffffffff,uVar3);
        if (cVar1 != '\0') {
          IOAccelLegacyDisplayPipe::setup_fullscreen
                    (*(IOAccelLegacyDisplayPipe **)(this + uVar2 * 8 + 0x178),param_1);
        }
      }
      uVar2 = uVar2 + 1;
    } while (uVar2 < *(uint *)(this + 0x108));
  }
  return;
}



// IOAccelLegacyDisplayMachine::reset_fullscreen(unsigned int, bool)

void __thiscall
IOAccelLegacyDisplayMachine::reset_fullscreen
          (IOAccelLegacyDisplayMachine *this,uint param_1,char param_2)

{
  char cVar1;
  ulong uVar2;
  ulong uVar3;
  
  uVar2 = (ulong)param_1;
  IOAccelLegacyDisplayPipe::reset_fullscreen
            (*(IOAccelLegacyDisplayPipe **)(this + uVar2 * 8 + 0x178),param_2);
  if (*(int *)(this + 0x108) != 0) {
    uVar3 = 0;
    do {
      if (uVar2 != uVar3) {
        cVar1 = (**(code **)(*(long *)this + 0x928))(this,uVar3 & 0xffffffff,uVar2);
        if (cVar1 != '\0') {
          IOAccelLegacyDisplayPipe::reset_fullscreen
                    (*(IOAccelLegacyDisplayPipe **)(this + uVar3 * 8 + 0x178),'\0');
        }
      }
      uVar3 = uVar3 + 1;
    } while (uVar3 < *(uint *)(this + 0x108));
  }
  return;
}



// IOAccelLegacyDisplayMachine::submit_scanout_flip(IOAccelEvent*, unsigned int, unsigned int)

void __thiscall
IOAccelLegacyDisplayMachine::submit_scanout_flip
          (IOAccelLegacyDisplayMachine *this,undefined8 param_1,uint param_2,uint param_3)

{
  uintptr_t uVar1;
  
  if (___ktrace_kernel_enabled != 0) {
    uVar1 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85200011,uVar1,(ulong)param_2,(ulong)param_3,0,0);
  }
  IOAccelLegacyDisplayPipe::submit_scanout_flip
            (*(IOAccelLegacyDisplayPipe **)(this + (ulong)param_2 * 8 + 0x178),param_1,param_3);
  if (___ktrace_kernel_enabled == 0) {
    return;
  }
  uVar1 = IORegistryEntry::getRegistryEntryID();
  _kernel_debug(0x85200012,uVar1,(ulong)param_2,(ulong)param_3,0,0);
  return;
}



// IOAccelLegacyDisplayMachine::submit_flip(IOAccelEvent*, unsigned int, unsigned int)

ulong __thiscall
IOAccelLegacyDisplayMachine::submit_flip
          (IOAccelLegacyDisplayMachine *this,undefined8 param_1,uint param_2,uint param_3)

{
  char cVar1;
  uintptr_t uVar2;
  ulong uVar3;
  undefined8 uVar4;
  ulong arg3;
  ulong arg2;
  
  if (___ktrace_kernel_enabled != 0) {
    uVar2 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85200001,uVar2,(ulong)param_2,(ulong)param_3,0,0);
  }
  arg2 = (ulong)param_2;
  uVar3 = IOAccelLegacyDisplayPipe::submit_flip
                    (*(IOAccelLegacyDisplayPipe **)(this + arg2 * 8 + 0x178),param_1,
                     (IOAccelDisplayPipe *)*(IOAccelLegacyDisplayPipe **)(this + arg2 * 8 + 0x178),
                     param_3);
  uVar3 = uVar3 & 0xffffffff;
  if (*(int *)(this + 0x108) != 0) {
    arg3 = 0;
    do {
      if ((arg2 != arg3) &&
         (cVar1 = (**(code **)(*(long *)this + 0x928))(this,arg3 & 0xffffffff,param_2),
         cVar1 != '\0')) {
        if (___ktrace_kernel_enabled != 0) {
          uVar2 = IORegistryEntry::getRegistryEntryID();
          _kernel_debug(0x85200008,uVar2,arg2,arg3,0,0);
        }
        uVar4 = IOAccelLegacyDisplayPipe::submit_flip
                          (*(IOAccelLegacyDisplayPipe **)(this + arg3 * 8 + 0x178),param_1,
                           *(IOAccelDisplayPipe **)(this + arg2 * 8 + 0x178),param_3);
        uVar3 = (ulong)((uint)uVar3 | (uint)uVar4);
      }
      arg3 = arg3 + 1;
    } while (arg3 < *(uint *)(this + 0x108));
  }
  if (___ktrace_kernel_enabled != 0) {
    uVar2 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85200002,uVar2,arg2,(ulong)param_3,0,0);
  }
  return uVar3;
}



// IOAccelLegacyDisplayMachine::surface_will_stop(IOAccelLegacySurface*)

void __thiscall
IOAccelLegacyDisplayMachine::surface_will_stop(IOAccelLegacyDisplayMachine *this,long param_1)

{
  ulong uVar1;
  
  if (*(int *)(this + 0x108) != 0) {
    uVar1 = 0;
    do {
      IOAccelLegacyDisplayPipe::surface_will_stop
                (*(IOAccelLegacyDisplayPipe **)(this + uVar1 * 8 + 0x178),param_1);
      uVar1 = uVar1 + 1;
    } while (uVar1 < *(uint *)(this + 0x108));
  }
  return;
}



// IOAccelLegacyDisplayMachine::isFramebufferHardwareMirrorOfFramebuffer(unsigned int, unsigned int)

undefined8 IOAccelLegacyDisplayMachine::isFramebufferHardwareMirrorOfFramebuffer(void)

{
  return 0;
}



// IOAccelLegacyDisplayMachine::initScanoutResource(unsigned int, unsigned int, IOFramebuffer*,
// IOAccelResource2*)

undefined8 IOAccelLegacyDisplayMachine::initScanoutResource(void)

{
  return 0;
}



// IOAccelLegacyDisplayMachine::destroyScanoutResource(unsigned int, unsigned int, IOFramebuffer*,
// IOAccelResource2*)

void IOAccelLegacyDisplayMachine::destroyScanoutResource(void)

{
  return;
}



// IOAccelLegacyDisplayMachine::setupScanout(unsigned int, IOAccelResource2*, IOAccelResource2*)

void IOAccelLegacyDisplayMachine::setupScanout(void)

{
  return;
}



// IOAccelLegacyDisplayMachine::resetScanout(IOAccelEvent*, unsigned int, IOAccelResource2*,
// IOAccelResource2*)

void IOAccelLegacyDisplayMachine::resetScanout(void)

{
  return;
}



// IOAccelLegacyDisplayMachine::submitScanoutFlipBuffer(IOAccelEvent*, unsigned int, unsigned int,
// IOAccelResource2*, IOAccelResource2*)

void IOAccelLegacyDisplayMachine::submitScanoutFlipBuffer(void)

{
  return;
}



// IOAccelLegacyDisplayMachine::enableFlipInterrupt(unsigned int)

void IOAccelLegacyDisplayMachine::enableFlipInterrupt(void)

{
  return;
}



// IOAccelLegacyDisplayMachine::disableFlipInterrupt(unsigned int)

void IOAccelLegacyDisplayMachine::disableFlipInterrupt(void)

{
  return;
}



// IOAccelLegacyDisplayMachine::setStereo(unsigned int, IOAccelStereoMode)

undefined8 IOAccelLegacyDisplayMachine::setStereo(void)

{
  return 0xe00002c7;
}



// IOAccelLegacyDisplayMachine::setupFullScreen(unsigned int, IOAccelResource2*, IOAccelResource2*)

void IOAccelLegacyDisplayMachine::setupFullScreen(void)

{
  return;
}



// IOAccelLegacyDisplayMachine::resetFullScreen(IOAccelEvent*, unsigned int, IOAccelResource2*,
// IOAccelResource2*)

void IOAccelLegacyDisplayMachine::resetFullScreen(void)

{
  return;
}



// IOAccelLegacyDisplayMachine::submitFlipBuffer(IOAccelEvent*, unsigned int, unsigned int,
// IOAccelResource2*, IOAccelResource2*)

void IOAccelLegacyDisplayMachine::submitFlipBuffer(void)

{
  return;
}



// IOAccelLegacyDisplayMachine::audit_freed_resource(IOAccelResource2*)

void __thiscall
IOAccelLegacyDisplayMachine::audit_freed_resource(IOAccelLegacyDisplayMachine *this,long param_1)

{
  ulong uVar1;
  
  if (*(int *)(this + 0x108) != 0) {
    uVar1 = 0;
    do {
      IOAccelLegacyDisplayPipe::audit_freed_resource
                (*(IOAccelLegacyDisplayPipe **)(this + uVar1 * 8 + 0x178),param_1);
      uVar1 = uVar1 + 1;
    } while (uVar1 < *(uint *)(this + 0x108));
  }
  return;
}



// IOAccelLegacyDisplayMachine::start(IOPCIDevice*)

bool __thiscall IOAccelLegacyDisplayMachine::start(IOAccelLegacyDisplayMachine *this,long *param_1)

{
  int iVar1;
  OSMetaClass *pOVar2;
  OSMetaClass *pOVar3;
  long *plVar4;
  long *plVar5;
  OSMetaClassBase *pOVar6;
  long *plVar7;
  long lVar8;
  
  plVar4 = (long *)(**(code **)(*param_1 + 800))(param_1,*(undefined8 *)PTR__gIODTPlane_0006b0c0);
  plVar5 = (long *)OSSymbol::withCString("IOFramebuffer");
  iVar1 = *(int *)(this + 0x170);
  if (iVar1 == 0) {
    if ((plVar4 != (long *)0x0) && (plVar5 != (long *)0x0)) {
      pOVar6 = (OSMetaClassBase *)(**(code **)(*plVar4 + 0x128))(plVar4);
      pOVar2 = *(OSMetaClass **)PTR_metaClass_0006b078;
      plVar7 = (long *)OSMetaClassBase::safeMetaCast(pOVar6,pOVar2);
      if (plVar7 != (long *)0x0) {
        pOVar3 = *(OSMetaClass **)PTR_metaClass_0006b030;
        do {
          pOVar6 = (OSMetaClassBase *)(**(code **)(*plVar7 + 0x420))(plVar7,plVar5);
          plVar7 = (long *)OSMetaClassBase::safeMetaCast(pOVar6,pOVar3);
          if (plVar7 != (long *)0x0) {
            (**(code **)(*(long *)this + 0x8d8))(this,plVar7);
            (**(code **)(*plVar7 + 0x28))(plVar7);
          }
          pOVar6 = (OSMetaClassBase *)(**(code **)(*plVar4 + 0x128))(plVar4);
          plVar7 = (long *)OSMetaClassBase::safeMetaCast(pOVar6,pOVar2);
        } while (plVar7 != (long *)0x0);
      }
      (**(code **)(*plVar4 + 0x28))(plVar4);
    }
    plVar4 = (long *)(**(code **)(*param_1 + 0x6a8))(param_1);
    if (plVar4 != (long *)0x0) {
      pOVar6 = (OSMetaClassBase *)(**(code **)(*plVar4 + 0x128))(plVar4);
      if (pOVar6 != (OSMetaClassBase *)0x0) {
        pOVar2 = *(OSMetaClass **)PTR_metaClass_0006b030;
        do {
          lVar8 = OSMetaClassBase::safeMetaCast(pOVar6,pOVar2);
          if (lVar8 == 0) {
            plVar7 = (long *)(**(code **)(*(long *)pOVar6 + 0x6a8))(pOVar6);
            lVar8 = *plVar7;
            while (pOVar6 = (OSMetaClassBase *)(**(code **)(lVar8 + 0x128))(plVar7),
                  pOVar6 != (OSMetaClassBase *)0x0) {
              lVar8 = OSMetaClassBase::safeMetaCast(pOVar6,pOVar2);
              if (lVar8 != 0) {
                (**(code **)(*(long *)this + 0x8d8))(this,lVar8);
              }
              lVar8 = *plVar7;
            }
            (**(code **)(*plVar7 + 0x28))(plVar7);
          }
          else {
            (**(code **)(*(long *)this + 0x8d8))(this,lVar8);
          }
          pOVar6 = (OSMetaClassBase *)(**(code **)(*plVar4 + 0x128))(plVar4);
        } while (pOVar6 != (OSMetaClassBase *)0x0);
      }
      (**(code **)(*plVar4 + 0x28))(plVar4);
    }
    if (plVar5 != (long *)0x0) {
      (**(code **)(*plVar5 + 0x28))();
    }
  }
  return iVar1 == 0;
}



// IOAccelLegacyDisplayMachine::stop()

void __thiscall IOAccelLegacyDisplayMachine::stop(IOAccelLegacyDisplayMachine *this)

{
  uint uVar1;
  ulong uVar2;
  
  uVar1 = *(uint *)(this + 0x108);
  if ((ulong)uVar1 != 0) {
    uVar2 = 0;
    do {
      *(undefined8 *)(this + uVar2 * 8 + 0x178) = 0;
      uVar2 = uVar2 + 1;
    } while (uVar1 != uVar2);
  }
  IOAccelDisplayMachine::stop((IOAccelDisplayMachine *)this);
  return;
}



// IOAccelLegacyDisplayMachine::MetaClass::~MetaClass()

void __thiscall IOAccelLegacyDisplayMachine::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



void __GLOBAL__sub_I_IOAccelLegacyDisplayMachine_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelLegacyDisplayMachine::gMetaClass,"IOAccelLegacyDisplayMachine",
             (OSMetaClass *)&IOAccelDisplayMachine::gMetaClass,0x1f8);
  IOAccelLegacyDisplayMachine::gMetaClass = (undefined *)&PTR__MetaClass_0006bd68;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelLegacyDisplayMachine::gMetaClass);
  return;
}



// IOAccelResidentMemorySet::init(IOGraphicsAccelerator2*)

bool __thiscall IOAccelResidentMemorySet::init(IOAccelResidentMemorySet *this,undefined8 param_1)

{
  long lVar1;
  
  *(undefined8 *)this = param_1;
  *(undefined4 *)(this + 0x10) = 0x400;
  lVar1 = _IOMallocTypeVarImpl(&init(IOGraphicsAccelerator2*)::kalloc_type_view_24,0x4000);
  *(long *)(this + 8) = lVar1;
  *(undefined8 *)(this + 0x60) = 0;
  *(undefined8 *)(this + 0x68) = 0;
  return lVar1 != 0;
}



// IOAccelResidentMemorySet::free()

void __thiscall IOAccelResidentMemorySet::free(IOAccelResidentMemorySet *this)

{
  long lVar1;
  
  lVar1 = *(long *)(this + 8);
  if (lVar1 != 0) {
    *(undefined8 *)(this + 8) = 0;
    _IOFreeTypeVarImpl(&free()::kalloc_type_view_37,lVar1,(ulong)*(uint *)(this + 0x10) << 4);
    *(undefined8 *)(this + 8) = 0;
  }
  lVar1 = *(long *)(this + 0x68);
  if (lVar1 != 0) {
    *(undefined8 *)(this + 0x68) = 0;
    _IOFreeData(lVar1,(ulong)*(uint *)(this + 0x60) << 2);
    *(undefined8 *)(this + 0x68) = 0;
  }
  return;
}



// IOAccelResidentMemorySet::getCount() const

undefined4 __thiscall IOAccelResidentMemorySet::getCount(IOAccelResidentMemorySet *this)

{
  return *(undefined4 *)(this + 0x14);
}



// IOAccelResidentMemorySet::addMemory(IOAccelMemory*)

void __thiscall
IOAccelResidentMemorySet::addMemory(IOAccelResidentMemorySet *this,IOAccelMemory *param_1)

{
  uint uVar1;
  int iVar2;
  
  *(undefined4 *)(param_1 + 0xa0) = 1;
  uVar1 = *(uint *)(this + 0x14);
  if (uVar1 == *(uint *)(this + 0x10)) {
    realloc(this);
    uVar1 = *(uint *)(this + 0x14);
  }
  *(IOAccelMemory **)(*(long *)(this + 8) + (ulong)uVar1 * 0x10) = param_1;
  iVar2 = IOAccelMemory::getLRUSeed(param_1);
  uVar1 = *(uint *)(this + 0x14);
  *(int *)(*(long *)(this + 8) + 8 + (ulong)uVar1 * 0x10) = iVar2;
  *(uint *)(param_1 + 0xa4) = uVar1;
  *(uint *)(this + 0x14) = uVar1 + 1;
  return;
}



// IOAccelResidentMemorySet::realloc()

void __thiscall IOAccelResidentMemorySet::realloc(IOAccelResidentMemorySet *this)

{
  int iVar1;
  undefined8 uVar2;
  void *pvVar3;
  
  iVar1 = *(int *)(this + 0x10);
  pvVar3 = (void *)_IOMallocTypeVarImpl
                             (&realloc()::kalloc_type_view_107,(ulong)(uint)(iVar1 * 2) << 4);
  if (pvVar3 == (void *)0x0) {
    realloc();
  }
  else {
    _memmove(pvVar3,*(void **)(this + 8),(ulong)*(uint *)(this + 0x10) << 4);
    uVar2 = *(undefined8 *)(this + 8);
    *(undefined8 *)(this + 8) = 0;
    _IOFreeTypeVarImpl(&realloc()::kalloc_type_view_111,uVar2,(ulong)*(uint *)(this + 0x10) << 4);
    *(int *)(this + 0x10) = iVar1 * 2;
    *(void **)(this + 8) = pvVar3;
  }
  return;
}



// IOAccelResidentMemorySet::removeMemory(IOAccelMemory*)

void __thiscall IOAccelResidentMemorySet::removeMemory(IOAccelResidentMemorySet *this,long param_1)

{
  long lVar1;
  IOAccelMemory *this_00;
  uint uVar2;
  uint uVar3;
  
  uVar2 = *(uint *)(param_1 + 0xa4);
  lVar1 = *(long *)(this + 8);
  *(undefined8 *)(lVar1 + (ulong)uVar2 * 0x10) = 0;
  *(undefined4 *)(param_1 + 0xa0) = 0;
  uVar3 = *(int *)(this + 0x14) - 1;
  *(uint *)(this + 0x14) = uVar3;
  if (uVar3 != uVar2) {
    this_00 = *(IOAccelMemory **)(lVar1 + (ulong)uVar3 * 0x10);
    *(IOAccelMemory **)((ulong)uVar2 * 0x10 + lVar1) = this_00;
    *(undefined8 *)(lVar1 + (ulong)uVar3 * 0x10) = 0;
    *(uint *)(this_00 + 0xa4) = uVar2;
    uVar2 = IOAccelMemory::getLRUSeed(this_00);
    if (uVar2 <= *(uint *)(this + 0x18)) {
      *(uint *)(this + 0x18) = uVar2 - 1;
    }
  }
  return;
}



// IOAccelResidentMemorySet::sort()

void __thiscall IOAccelResidentMemorySet::sort(IOAccelResidentMemorySet *this)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined8 uVar3;
  bool bVar4;
  int iVar5;
  ulong uVar6;
  long *plVar7;
  long lVar8;
  long lVar9;
  long lVar10;
  long lVar11;
  long lVar12;
  long lVar13;
  undefined8 *puVar14;
  long lVar15;
  int iVar16;
  ulong uVar17;
  
  if (*(int *)(this + 0x14) == 0) {
    uVar6 = 0;
  }
  else {
    lVar10 = *(long *)(this + 8);
    lVar15 = 0;
    uVar17 = 0;
    do {
      iVar5 = IOAccelMemory::getLRUSeed(*(IOAccelMemory **)(lVar10 + lVar15));
      lVar10 = *(long *)(this + 8);
      *(int *)(lVar10 + 8 + lVar15) = iVar5;
      uVar17 = uVar17 + 1;
      uVar6 = (ulong)*(uint *)(this + 0x14);
      lVar15 = lVar15 + 0x10;
    } while (uVar17 < uVar6);
  }
  uVar17 = 0xb;
  do {
    lVar10 = (long)*(int *)(&UNK_0006ad6c + uVar17 * 4);
    if (lVar10 < (long)uVar6) {
      lVar11 = 0;
      lVar15 = lVar10;
      do {
        lVar12 = *(long *)(this + 8);
        lVar8 = lVar15 * 0x10;
        iVar5 = *(int *)(lVar12 + 8 + lVar8);
        lVar13 = (lVar15 - lVar10) * 0x10;
        iVar16 = *(int *)(lVar12 + 8 + lVar13);
        if (0 < iVar16 - iVar5) {
          uVar3 = *(undefined8 *)(lVar12 + lVar8);
          uVar1 = *(undefined4 *)(lVar12 + 0xc + lVar8);
          puVar14 = (undefined8 *)(lVar13 + lVar12);
          lVar8 = lVar11;
          lVar13 = lVar15;
          do {
            lVar9 = lVar8;
            uVar2 = *(undefined4 *)((long)puVar14 + 0xc);
            lVar12 = lVar12 + lVar10 * 0x10;
            *(undefined8 *)(lVar9 + lVar12) = *puVar14;
            *(int *)(lVar9 + 8 + lVar12) = iVar16;
            *(undefined4 *)(lVar9 + 0xc + lVar12) = uVar2;
            lVar13 = lVar13 - lVar10;
            lVar12 = *(long *)(this + 8);
            if (lVar13 < lVar10) break;
            lVar8 = lVar12 + lVar10 * -0x10;
            iVar16 = *(int *)(lVar9 + 8 + lVar8);
            puVar14 = (undefined8 *)(lVar8 + lVar9);
            lVar8 = lVar9 + lVar10 * -0x10;
          } while (0 < iVar16 - iVar5);
          *(undefined8 *)(lVar12 + lVar9) = uVar3;
          *(int *)(lVar12 + 8 + lVar9) = iVar5;
          *(undefined4 *)(lVar12 + 0xc + lVar9) = uVar1;
          uVar6 = (ulong)*(uint *)(this + 0x14);
        }
        lVar15 = lVar15 + 1;
        lVar11 = lVar11 + 0x10;
      } while (lVar15 < (long)uVar6);
    }
    bVar4 = uVar17 < 2;
    uVar17 = uVar17 - 1;
    if (bVar4) {
      if ((int)uVar6 != 0) {
        plVar7 = *(long **)(this + 8);
        uVar17 = 0;
        do {
          *(int *)(*plVar7 + 0xa4) = (int)uVar17;
          uVar17 = uVar17 + 1;
          plVar7 = plVar7 + 2;
        } while (uVar6 != uVar17);
        *(undefined4 *)(this + 0x18) =
             *(undefined4 *)(*(long *)(this + 8) + 8 + (ulong)((int)uVar6 - 1) * 0x10);
      }
      *(int *)(this + 0x1c) = *(int *)(this + 0x1c) + 1;
      return;
    }
  } while( true );
}



// IOAccelResidentMemorySet::setCollectionEras(IOAccelCollectionEra*)

ulong __thiscall
IOAccelResidentMemorySet::setCollectionEras(IOAccelResidentMemorySet *this,int *param_1)

{
  int iVar1;
  undefined8 uVar2;
  void *pvVar3;
  long lVar4;
  undefined8 unaff_RBX;
  ulong uVar5;
  ulong uVar6;
  
  lVar4 = 0;
  do {
    uVar2 = *(undefined8 *)((long)param_1 + lVar4);
    *(undefined8 *)(this + lVar4 + 0x38) = *(undefined8 *)((long)param_1 + lVar4 + 8);
    *(undefined8 *)(this + lVar4 + 0x30) = uVar2;
    lVar4 = lVar4 + 0x10;
  } while (lVar4 != 0x30);
  iVar1 = *param_1;
  *(uint *)(this + 0x60) = iVar1 + 1U;
  uVar5 = CONCAT71((int7)((ulong)unaff_RBX >> 8),1);
  if (*(long *)(this + 0x68) == 0) {
    uVar6 = (ulong)(iVar1 + 1U) << 2;
    pvVar3 = (void *)_IOMallocData(uVar6);
    *(void **)(this + 0x68) = pvVar3;
    if (pvVar3 == (void *)0x0) {
      uVar5 = 0;
    }
    else {
      if (uVar6 < (ulong)*(uint *)(this + 0x60) << 2) {
        setCollectionEras();
        return 0;
      }
      _memset(pvVar3,0xff,(ulong)*(uint *)(this + 0x60) << 2);
    }
  }
  return uVar5 & 0xffffffff;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResidentMemorySet::updateCollectionLRUs(unsigned int)

void __cdecl IOAccelResidentMemorySet::updateCollectionLRUs(long *param_1)

{
  uint uVar1;
  ulong uVar2;
  
  uVar1 = *(int *)((long)param_1 + 100) + 1;
  uVar2 = 0;
  if (uVar1 != *(uint *)(param_1 + 0xc)) {
    uVar2 = (ulong)uVar1;
  }
  *(int *)((long)param_1 + 100) = (int)uVar2;
  *(undefined4 *)(param_1[0xd] + uVar2 * 4) = *(undefined4 *)(*param_1 + 0xa0);
  return;
}



// IOAccelResidentMemorySet::collect()

ulong __thiscall IOAccelResidentMemorySet::collect(IOAccelResidentMemorySet *this)

{
  int *piVar1;
  long lVar2;
  ulong uVar3;
  ulong uVar4;
  IOAccelMemory *this_00;
  undefined8 uVar5;
  long lVar6;
  int iVar7;
  undefined8 extraout_RDX;
  bool bVar8;
  uint uVar9;
  ulong uVar10;
  ulong uVar11;
  
  sort(this);
  lVar2 = *(long *)(this + 0x68);
  lVar6 = 0xc;
  do {
    iVar7 = *(int *)(this + 100) - *(int *)(this + lVar6 * 4);
    if (iVar7 < 0) {
      iVar7 = iVar7 + *(int *)(this + 0x60);
    }
    *(undefined4 *)(this + lVar6 + 0x14) = *(undefined4 *)(lVar2 + (long)iVar7 * 4);
    lVar6 = lVar6 + 4;
  } while (lVar6 != 0x18);
  uVar11 = 0;
  if (*(int *)(this + 0x14) != 0) {
    uVar3 = *(ulong *)(*(long *)this + 0x340);
    uVar4 = *(ulong *)(*(long *)this + 0x350);
    uVar10 = 0;
    bVar8 = false;
    do {
      lVar2 = *(long *)this;
      if (*(int *)(lVar2 + 0x90) != 0) {
        *(undefined4 *)(lVar2 + 0xdc) = 1;
        break;
      }
      if (*(ulong *)(lVar2 + 0x350) <= *(ulong *)(this + uVar10 * 0x10 + 0x38)) break;
      lVar6 = uVar11 * 0x10;
      if (*(int *)(this + uVar10 * 4 + 0x20) - *(int *)(*(long *)(this + 8) + 8 + lVar6) < 0) {
        *(undefined4 *)(lVar2 + 0xdc) = 1;
        uVar9 = (int)uVar10 + 1;
        uVar10 = (ulong)uVar9;
        if (uVar9 == 3) break;
      }
      else {
        this_00 = *(IOAccelMemory **)(*(long *)(this + 8) + lVar6);
        iVar7 = IOAccelMemory::getPrepareCount(this_00);
        if ((iVar7 == 0) && (((byte)this_00[0xc] & 1) != 0)) {
          uVar5 = IOAccelMemory::testAllEvent(this_00);
          if ((char)uVar5 == '\0') {
            *(undefined4 *)(*(long *)this + 0xdc) = 1;
          }
          else if ((*(uint *)(this_00 + 0xc) & 0x1400) == 0x400) {
            IOAccelMemory::pruneOrphanedMappings(this_00,lVar6,extraout_RDX);
          }
          else if (((*(uint *)(this_00 + 0xc) & 0x380) != 0) || (uVar3 <= uVar4)) {
            (**(code **)(*(long *)this_00 + 0x1b8))(this_00);
            bVar8 = true;
          }
        }
        uVar11 = (ulong)((int)uVar11 + 1);
      }
    } while ((uint)uVar11 < *(uint *)(this + 0x14));
    if (bVar8) {
      lVar2 = *(long *)this;
      IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar2 + 0x388) + 0x58),0x5c);
      piVar1 = (int *)(lVar2 + 0x310);
      *piVar1 = *piVar1 + 1;
      uVar11 = CONCAT71((int7)(uVar11 >> 8),1);
    }
    else {
      uVar11 = 0;
    }
  }
  return uVar11;
}



// IOAccelResidentMemorySet::getEarliestExpiredLRUSeed()

undefined4 __thiscall
IOAccelResidentMemorySet::getEarliestExpiredLRUSeed(IOAccelResidentMemorySet *this)

{
  int iVar1;
  
  iVar1 = *(int *)(this + 100) - *(int *)(this + 0x50);
  if (iVar1 < 0) {
    iVar1 = iVar1 + *(int *)(this + 0x60);
  }
  return *(undefined4 *)(*(long *)(this + 0x68) + (long)iVar1 * 4);
}



// IOAccelResidentMemorySet::LRUIterator::LRUIterator(IOAccelResidentMemorySet&)

void __thiscall IOAccelResidentMemorySet::LRUIterator::LRUIterator(LRUIterator *this,long param_1)

{
  *(long *)this = param_1;
  *(undefined8 *)(this + 8) = 0;
  *(undefined4 *)(this + 0x14) = *(undefined4 *)(param_1 + 0x1c);
  *(undefined4 *)(this + 0x10) = 0;
  return;
}



// IOAccelResidentMemorySet::LRUIterator::LRUIterator(IOAccelResidentMemorySet&)

void __thiscall IOAccelResidentMemorySet::LRUIterator::LRUIterator(LRUIterator *this,long param_1)

{
  *(long *)this = param_1;
  *(undefined8 *)(this + 8) = 0;
  *(undefined4 *)(this + 0x14) = *(undefined4 *)(param_1 + 0x1c);
  *(undefined4 *)(this + 0x10) = 0;
  return;
}



// IOAccelResidentMemorySet::LRUIterator::getNextMemory()

IOAccelMemory * __thiscall IOAccelResidentMemorySet::LRUIterator::getNextMemory(LRUIterator *this)

{
  uint uVar1;
  int iVar2;
  long lVar3;
  long lVar4;
  IOAccelMemory *this_00;
  int iVar5;
  
  *(undefined8 *)(this + 8) = 0;
  if (*(int *)(this + 0x14) != *(int *)(*(long *)this + 0x1c)) {
    *(int *)(this + 0x14) = *(int *)(*(long *)this + 0x1c);
    *(undefined4 *)(this + 0x10) = 0;
  }
  do {
    uVar1 = *(uint *)(this + 0x10);
    lVar3 = *(long *)this;
    if (*(uint *)(lVar3 + 0x14) <= uVar1) {
      return *(IOAccelMemory **)(this + 8);
    }
    lVar4 = *(long *)(lVar3 + 8);
    *(uint *)(this + 0x10) = uVar1 + 1;
    this_00 = *(IOAccelMemory **)(lVar4 + (ulong)uVar1 * 0x10);
    iVar2 = *(int *)(lVar3 + 0x18);
    iVar5 = IOAccelMemory::getLRUSeed(this_00);
  } while (iVar2 - iVar5 < 0);
  *(IOAccelMemory **)(this + 8) = this_00;
  return this_00;
}



// IOAccelResidentMemorySet::Iterator::Iterator(IOAccelResidentMemorySet&)

void __thiscall IOAccelResidentMemorySet::Iterator::Iterator(Iterator *this,long param_1)

{
  *(long *)this = param_1;
  *(undefined8 *)(this + 8) = 0;
  *(undefined4 *)(this + 0x14) = *(undefined4 *)(param_1 + 0x1c);
  *(undefined4 *)(this + 0x10) = 0;
  return;
}



// IOAccelResidentMemorySet::Iterator::Iterator(IOAccelResidentMemorySet&)

void __thiscall IOAccelResidentMemorySet::Iterator::Iterator(Iterator *this,long param_1)

{
  *(long *)this = param_1;
  *(undefined8 *)(this + 8) = 0;
  *(undefined4 *)(this + 0x14) = *(undefined4 *)(param_1 + 0x1c);
  *(undefined4 *)(this + 0x10) = 0;
  return;
}



// IOAccelResidentMemorySet::Iterator::getNextMemory()

undefined8 __thiscall IOAccelResidentMemorySet::Iterator::getNextMemory(Iterator *this)

{
  long lVar1;
  undefined8 uVar2;
  uint uVar3;
  
  *(undefined8 *)(this + 8) = 0;
  lVar1 = *(long *)this;
  if (*(int *)(this + 0x14) == *(int *)(lVar1 + 0x1c)) {
    uVar3 = *(uint *)(this + 0x10);
  }
  else {
    *(int *)(this + 0x14) = *(int *)(lVar1 + 0x1c);
    *(undefined4 *)(this + 0x10) = 0;
    uVar3 = 0;
  }
  if (uVar3 < *(uint *)(lVar1 + 0x14)) {
    lVar1 = *(long *)(lVar1 + 8);
    *(uint *)(this + 0x10) = uVar3 + 1;
    uVar2 = *(undefined8 *)(lVar1 + (ulong)uVar3 * 0x10);
    *(undefined8 *)(this + 8) = uVar2;
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



// IOAccelResidentMemorySet::ReverseIterator::ReverseIterator(IOAccelResidentMemorySet&)

void __thiscall
IOAccelResidentMemorySet::ReverseIterator::ReverseIterator(ReverseIterator *this,long param_1)

{
  *(long *)this = param_1;
  *(undefined8 *)(this + 8) = 0;
  *(undefined4 *)(this + 0x14) = *(undefined4 *)(param_1 + 0x1c);
  *(undefined4 *)(this + 0x10) = *(undefined4 *)(param_1 + 0x14);
  return;
}



// IOAccelResidentMemorySet::ReverseIterator::ReverseIterator(IOAccelResidentMemorySet&)

void __thiscall
IOAccelResidentMemorySet::ReverseIterator::ReverseIterator(ReverseIterator *this,long param_1)

{
  *(long *)this = param_1;
  *(undefined8 *)(this + 8) = 0;
  *(undefined4 *)(this + 0x14) = *(undefined4 *)(param_1 + 0x1c);
  *(undefined4 *)(this + 0x10) = *(undefined4 *)(param_1 + 0x14);
  return;
}



// IOAccelResidentMemorySet::ReverseIterator::getPrevMemory()

undefined8 __thiscall
IOAccelResidentMemorySet::ReverseIterator::getPrevMemory(ReverseIterator *this)

{
  long lVar1;
  undefined8 uVar2;
  int iVar3;
  
  *(undefined8 *)(this + 8) = 0;
  lVar1 = *(long *)this;
  if (*(int *)(this + 0x14) == *(int *)(lVar1 + 0x1c)) {
    iVar3 = *(int *)(this + 0x10);
  }
  else {
    *(int *)(this + 0x14) = *(int *)(lVar1 + 0x1c);
    iVar3 = *(int *)(lVar1 + 0x14);
    *(int *)(this + 0x10) = iVar3;
  }
  if (iVar3 == 0) {
    uVar2 = 0;
  }
  else {
    lVar1 = *(long *)(lVar1 + 8);
    *(uint *)(this + 0x10) = iVar3 - 1U;
    uVar2 = *(undefined8 *)(lVar1 + (ulong)(iVar3 - 1U) * 0x10);
    *(undefined8 *)(this + 8) = uVar2;
  }
  return uVar2;
}



// IOAccelMemory::MetaClass::MetaClass()

void __thiscall IOAccelMemory::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelMemory",(OSMetaClass *)PTR_gMetaClass_0006b068,0xb0);
  *(undefined ***)this = &PTR__MetaClass_0006c058;
  return;
}



// IOAccelMemory::MetaClass::~MetaClass()

void __thiscall IOAccelMemory::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelMemory::IOAccelMemory(OSMetaClass const*)

void __thiscall IOAccelMemory::IOAccelMemory(IOAccelMemory *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelMemory_0006be60;
  return;
}



// IOAccelMemory::~IOAccelMemory()

void __thiscall IOAccelMemory::~IOAccelMemory(IOAccelMemory *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelMemory::~IOAccelMemory()

void __thiscall IOAccelMemory::~IOAccelMemory(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelMemory::~IOAccelMemory()

void __thiscall IOAccelMemory::~IOAccelMemory(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelMemory::getMetaClass() const

undefined ** IOAccelMemory::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelMemory::MetaClass::MetaClass()

void __thiscall IOAccelMemory::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelMemory",(OSMetaClass *)PTR_gMetaClass_0006b068,0xb0);
  *(undefined ***)this = &PTR__MetaClass_0006c058;
  return;
}



// IOAccelMemory::MetaClass::alloc() const

undefined8 IOAccelMemory::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelMemory::operator new(unsigned long)

void * __thiscall IOAccelMemory::operator_new(IOAccelMemory *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelMemory_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelMemory::operator delete(void*, unsigned long)

void __cdecl IOAccelMemory::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelMemory_ktv,param_1,param_2);
  return;
}



// IOAccelMemory::init(IOGraphicsAccelerator2*)

bool __thiscall IOAccelMemory::init(IOAccelMemory *this,undefined8 param_1)

{
  long lVar1;
  long lVar2;
  
  (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  *(undefined8 *)(this + 0x28) = param_1;
  *(undefined8 *)(this + 0x30) = 0;
  *(undefined8 *)(this + 0x20) = 0;
  *(undefined2 *)(this + 0x58) = 1;
  lVar2 = _IOMallocTypeVarImpl(&init(IOGraphicsAccelerator2*)::kalloc_type_view_36,8);
  *(long *)(this + 0x50) = lVar2;
  if (lVar2 != 0) {
    *(undefined2 *)(this + 0x5a) = 0;
    *(undefined8 *)(this + 0x40) = 0;
    *(uint *)(this + 0xc) = *(uint *)(this + 0xc) & 0xfffda008 | 0x100;
    *(undefined8 *)(this + 0x38) = 0;
    *(undefined8 *)(this + 0x10) = 0;
    *(undefined4 *)(this + 0x18) = 0;
    lVar1 = fUniqueMemoryIdentifierSource + 1;
    *(long *)(this + 0x48) = fUniqueMemoryIdentifierSource;
    fUniqueMemoryIdentifierSource = lVar1;
  }
  return lVar2 != 0;
}



// IOAccelMemory::release() const

void __thiscall IOAccelMemory::release(IOAccelMemory *this,undefined8 param_1)

{
  undefined *puVar1;
  bool bVar2;
  int iVar3;
  uint uVar4;
  undefined8 uVar5;
  undefined8 *puVar6;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  
  puVar1 = PTR_vtable_0006b0a0;
  puVar6 = (undefined8 *)(PTR_vtable_0006b0a0 + 0x38);
  if (((byte)this[0xd] & 4) != 0) goto LAB_00002b8f;
  iVar3 = (**(code **)(*(long *)this + 0x18))(this);
  if (iVar3 < 2) goto LAB_00002b8f;
  (**(code **)(puVar1 + 0x38))(this);
  bVar2 = check_orphan_state(this);
  if (!bVar2) {
    return;
  }
  if ((*(byte *)(*(long *)(this + 0x28) + 0xc78) & 8) != 0) {
    puVar6 = (undefined8 *)(*(long *)this + 0x1c0);
    goto LAB_00002b8f;
  }
  uVar4 = *(uint *)(this + 0xc);
  if ((uVar4 >> 0xb & 1) == 0) {
    uVar5 = testAllEvent(this);
    if ((char)uVar5 == '\0') {
      uVar4 = *(uint *)(this + 0xc);
      goto LAB_00002b66;
    }
    (**(code **)(*(long *)this + 0x20))(this);
    uVar5 = extraout_RDX;
  }
  else {
LAB_00002b66:
    if ((uVar4 & 6) != 4) {
      puVar6 = (undefined8 *)(*(long *)this + 0x1c0);
      goto LAB_00002b8f;
    }
    (**(code **)(*(long *)this + 0x20))(this);
    uVar5 = extraout_RDX_00;
  }
  pruneOrphanedMappings(this,param_1,uVar5);
  puVar6 = (undefined8 *)(*(long *)this + 0x28);
LAB_00002b8f:
                    // WARNING: Could not recover jumptable at 0x00002b9c. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)*puVar6)(this);
  return;
}



// IOAccelMemory::check_orphan_state()

bool __thiscall IOAccelMemory::check_orphan_state(IOAccelMemory *this)

{
  int iVar1;
  ulong uVar2;
  int iVar3;
  
  if ((short)*(ushort *)(this + 0x5a) < 1) {
    iVar3 = 0;
  }
  else {
    uVar2 = 0;
    iVar3 = 0;
    do {
      iVar3 = iVar3 + (uint)((*(uint *)(*(long *)(*(long *)(this + 0x50) + uVar2 * 8) + 0x10) >> 3 &
                             1) != 0);
      uVar2 = uVar2 + 1;
    } while (*(ushort *)(this + 0x5a) != uVar2);
  }
  iVar1 = (**(code **)(*(long *)this + 0x18))();
  return iVar1 == iVar3;
}



// IOAccelMemory::testAllEvent()

undefined8 __thiscall IOAccelMemory::testAllEvent(IOAccelMemory *this)

{
  char cVar1;
  bool bVar2;
  long in_RAX;
  undefined7 extraout_var;
  long lVar3;
  
  if (0 < *(short *)(this + 0x5a)) {
    lVar3 = 0;
    do {
      cVar1 = (**(code **)(**(long **)(*(long *)(this + 0x28) + 0x380) + 400))
                        (*(long **)(*(long *)(this + 0x28) + 0x380),
                         *(long *)(*(long *)(this + 0x50) + lVar3 * 8) + 0x38);
      if (cVar1 == '\0') {
        return 0;
      }
      lVar3 = lVar3 + 1;
      in_RAX = (long)*(short *)(this + 0x5a);
    } while (lVar3 < in_RAX);
  }
  if (*(IOAccelExternalEvent **)(this + 0x60) != (IOAccelExternalEvent *)0x0) {
    bVar2 = IOAccelExternalEvent::test(*(IOAccelExternalEvent **)(this + 0x60));
    in_RAX = CONCAT71(extraout_var,bVar2);
    if (!bVar2) {
      return 0;
    }
  }
  return CONCAT71((int7)((ulong)in_RAX >> 8),1);
}



// IOAccelMemory::pruneOrphanedMappings()

void __thiscall
IOAccelMemory::pruneOrphanedMappings(IOAccelMemory *this,undefined8 param_1,undefined8 param_2)

{
  long *plVar1;
  char cVar2;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  ulong uVar3;
  
  if (((*(byte *)(*(long *)(this + 0x28) + 0xc78) & 8) == 0) &&
     (0 < (short)*(ushort *)(this + 0x5a))) {
    uVar3 = (ulong)*(ushort *)(this + 0x5a) + 1;
    do {
      plVar1 = *(long **)(*(long *)(this + 0x50) + (ulong)((int)uVar3 - 2) * 8);
      if ((*(byte *)(plVar1 + 2) & 8) != 0) {
        cVar2 = IOAccelMemoryMap::testEvent((long)plVar1,param_1,param_2);
        param_2 = extraout_RDX;
        if (cVar2 != '\0') {
          (**(code **)(*plVar1 + 0x28))(plVar1);
          param_2 = extraout_RDX_00;
        }
      }
      uVar3 = uVar3 - 1;
    } while (1 < uVar3);
  }
  return;
}



// IOAccelMemory::free()

void __thiscall IOAccelMemory::free(IOAccelMemory *this)

{
  long lVar1;
  long lVar2;
  
  if (*(long *)(this + 0x20) == 0) {
    lVar1 = *(long *)(this + 0x50);
    if (lVar1 != 0) {
      lVar2 = -0x8000000000000000;
      if (-1 < (long)*(short *)(this + 0x58)) {
        lVar2 = (long)*(short *)(this + 0x58) * 8;
      }
      *(undefined8 *)(this + 0x50) = 0;
      _IOFreeTypeVarImpl(&free()::kalloc_type_view_139,lVar1,lVar2);
      *(undefined8 *)(this + 0x50) = 0;
    }
    if (*(long **)(this + 0x60) != (long *)0x0) {
      (**(code **)(**(long **)(this + 0x60) + 0x28))();
    }
    *(undefined8 *)(this + 0x60) = 0;
                    // WARNING: Could not recover jumptable at 0x00002d1a. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
    return;
  }
  free();
  return;
}



// IOAccelMemory::updateLRUSeed()

void __thiscall IOAccelMemory::updateLRUSeed(IOAccelMemory *this)

{
  *(undefined4 *)(this + 0x18) = *(undefined4 *)(*(long *)(this + 0x28) + 0xa0);
  return;
}



// IOAccelMemory::getLRUSeed() const

int __thiscall IOAccelMemory::getLRUSeed(IOAccelMemory *this)

{
  IOAccelMemoryMap *this_00;
  int iVar1;
  int iVar2;
  long lVar3;
  
  iVar2 = *(int *)(this + 0x18);
  if (0 < *(short *)(this + 0x5a)) {
    lVar3 = 0;
    do {
      this_00 = *(IOAccelMemoryMap **)(*(long *)(this + 0x50) + lVar3 * 8);
      iVar1 = IOAccelMemoryMap::getLRUSeed(this_00);
      if (iVar2 - iVar1 < 0) {
        iVar2 = IOAccelMemoryMap::getLRUSeed(this_00);
      }
      lVar3 = lVar3 + 1;
    } while (lVar3 < *(short *)(this + 0x5a));
  }
  return iVar2;
}



// IOAccelMemory::add_mapping(IOAccelMemoryMap*)

void __thiscall IOAccelMemory::add_mapping(IOAccelMemory *this,undefined8 param_1)

{
  ushort uVar1;
  undefined8 uVar2;
  short sVar3;
  ulong uVar4;
  long lVar5;
  long lVar6;
  
  sVar3 = *(short *)(this + 0x5a);
  if (sVar3 == *(short *)(this + 0x58)) {
    lVar5 = (long)sVar3 << 4;
    if (sVar3 < 0) {
      lVar5 = -0x8000000000000000;
    }
    lVar5 = _IOMallocTypeVarImpl(&add_mapping(IOAccelMemoryMap*)::kalloc_type_view_183,lVar5);
    if (lVar5 == 0) {
      add_mapping();
      return;
    }
    uVar1 = *(ushort *)(this + 0x5a);
    if (0 < (short)uVar1) {
      uVar4 = 0;
      do {
        *(undefined8 *)(lVar5 + uVar4 * 8) = *(undefined8 *)(*(long *)(this + 0x50) + uVar4 * 8);
        uVar4 = uVar4 + 1;
      } while (uVar1 != uVar4);
    }
    lVar6 = -0x8000000000000000;
    if (-1 < (long)*(short *)(this + 0x58)) {
      lVar6 = (long)*(short *)(this + 0x58) * 8;
    }
    uVar2 = *(undefined8 *)(this + 0x50);
    *(undefined8 *)(this + 0x50) = 0;
    _IOFreeTypeVarImpl(&add_mapping(IOAccelMemoryMap*)::kalloc_type_view_188,uVar2,lVar6);
    *(long *)(this + 0x50) = lVar5;
    *(short *)(this + 0x58) = sVar3 * 2;
    sVar3 = *(short *)(this + 0x5a);
  }
  else {
    lVar5 = *(long *)(this + 0x50);
  }
  *(short *)(this + 0x5a) = sVar3 + 1;
  *(undefined8 *)(lVar5 + (long)sVar3 * 8) = param_1;
  return;
}



// IOAccelMemory::remove_mapping(IOAccelMemoryMap*)

void __thiscall IOAccelMemory::remove_mapping(IOAccelMemory *this,long param_1)

{
  short sVar1;
  uint uVar2;
  ulong uVar3;
  
  sVar1 = *(short *)(this + 0x5a);
  uVar2 = (uint)sVar1;
  if (sVar1 < 1) {
    uVar3 = 0;
LAB_00002ea6:
    if ((int)uVar3 < (int)uVar2) {
      uVar3 = uVar3 & 0xffffffff;
      do {
        *(undefined8 *)(*(long *)(this + 0x50) + uVar3 * 8) =
             *(undefined8 *)(*(long *)(this + 0x50) + 8 + uVar3 * 8);
        uVar3 = uVar3 + 1;
      } while (uVar2 != uVar3);
    }
  }
  else {
    uVar3 = 0;
    do {
      if (*(long *)(*(long *)(this + 0x50) + uVar3 * 8) == param_1) {
        *(short *)(this + 0x5a) = sVar1 + -1;
        uVar2 = (uint)(short)(sVar1 + -1);
        goto LAB_00002ea6;
      }
      uVar3 = uVar3 + 1;
    } while (uVar2 != uVar3);
  }
  return;
}



// IOAccelMemory::getActiveMappingCount()

int __thiscall IOAccelMemory::getActiveMappingCount(IOAccelMemory *this)

{
  int iVar1;
  ulong uVar2;
  
  if ((short)*(ushort *)(this + 0x5a) < 1) {
    iVar1 = 0;
  }
  else {
    uVar2 = 0;
    iVar1 = 0;
    do {
      iVar1 = (iVar1 + 1) -
              (uint)((*(uint *)(*(long *)(*(long *)(this + 0x50) + uVar2 * 8) + 0x10) >> 3 & 1) != 0
                    );
      uVar2 = uVar2 + 1;
    } while (*(ushort *)(this + 0x5a) != uVar2);
  }
  return iVar1;
}



// IOAccelMemory::getEventMachine() const

undefined8 __thiscall IOAccelMemory::getEventMachine(IOAccelMemory *this)

{
  return *(undefined8 *)(*(long *)(this + 0x28) + 0x380);
}



// IOAccelMemory::setFlags(unsigned int)

void __thiscall IOAccelMemory::setFlags(IOAccelMemory *this,byte param_1)

{
  if ((param_1 & 1) != 0) {
    this[0xd] = (IOAccelMemory)((byte)this[0xd] | 8);
  }
  if ((param_1 & 2) != 0) {
    this[0xd] = (IOAccelMemory)((byte)this[0xd] | 0x10);
  }
  return;
}



// IOAccelMemory::clearFlags(unsigned int)

void __thiscall IOAccelMemory::clearFlags(IOAccelMemory *this,byte param_1)

{
  if ((param_1 & 1) != 0) {
    this[0xd] = (IOAccelMemory)((byte)this[0xd] & 0xf7);
  }
  if ((param_1 & 2) != 0) {
    this[0xd] = (IOAccelMemory)((byte)this[0xd] & 0xef);
  }
  return;
}



// IOAccelMemory::orphanIt()

void __thiscall IOAccelMemory::orphanIt(IOAccelMemory *this)

{
  uint uVar1;
  
  uVar1 = *(uint *)(this + 0xc);
  *(uint *)(this + 0xc) = uVar1 | 0x400;
  if ((uVar1 & 0x802) == 0x800) {
                    // WARNING: Could not recover jumptable at 0x00002f70. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*(long *)this + 0x160))(this,3,0);
    return;
  }
  return;
}



// IOAccelMemory::unorphanIt(IOAccelShared2*)

void __thiscall IOAccelMemory::unorphanIt(IOAccelMemory *this,long param_1)

{
  uint uVar1;
  long lVar2;
  long *plVar3;
  long lVar4;
  ulong uVar5;
  long lVar6;
  
  if (*(long *)(this + 0x30) != param_1) {
    if (param_1 == 0) {
      lVar6 = 0;
    }
    else {
      lVar6 = *(long *)(param_1 + 0x88);
    }
    if (0 < (short)*(ushort *)(this + 0x5a)) {
      lVar2 = *(long *)(*(long *)(this + 0x28) + 0x150);
      uVar5 = (ulong)*(ushort *)(this + 0x5a) + 1;
      do {
        plVar3 = *(long **)(*(long *)(this + 0x50) + (ulong)((int)uVar5 - 2) * 8);
        lVar4 = plVar3[0x12];
        if ((lVar4 != lVar2) && (lVar4 != lVar6)) {
          (**(code **)(*plVar3 + 0x28))();
        }
        uVar5 = uVar5 - 1;
      } while (1 < uVar5);
    }
    *(long *)(this + 0x30) = param_1;
  }
  uVar1 = *(uint *)(this + 0xc);
  *(uint *)(this + 0xc) = uVar1 & 0xfffffbff;
  if ((uVar1 >> 0xb & 1) == 0) {
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0000302e. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x160))(this,2,0);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelMemory::createMappingInTask(IOAccelTask*, unsigned int)

void __cdecl IOAccelMemory::createMappingInTask(long *param_1)

{
                    // WARNING: Could not recover jumptable at 0x00003044. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*param_1 + 0x140))();
  return;
}



// IOAccelMemory::createMappingInTaskAtAddressLength(IOAccelTask*, unsigned int, unsigned long long,
// unsigned long long)

long * __thiscall
IOAccelMemory::createMappingInTaskAtAddressLength
          (IOAccelMemory *this,IOAccelTask *param_1,uint param_2,long param_3,long param_4)

{
  char cVar1;
  short sVar2;
  uint uVar3;
  long *plVar4;
  long extraout_RDX;
  long extraout_RDX_00;
  IOAccelTask *pIVar5;
  IOAccelTask *pIVar6;
  long lVar7;
  ulong uVar8;
  int iVar9;
  
  sVar2 = *(short *)(this + 0x5a);
  if (0 < sVar2) {
    lVar7 = 0;
    iVar9 = 0;
    pIVar6 = param_1;
    do {
      pIVar5 = (IOAccelTask *)(ulong)param_2;
      plVar4 = *(long **)(*(long *)(this + 0x50) + lVar7 * 8);
      if ((IOAccelTask *)plVar4[0x12] == param_1) {
        if (((param_2 & 8) == 0) || (cVar1 = (**(code **)(*plVar4 + 0x120))(plVar4), cVar1 != '\0'))
        {
          uVar3 = *(uint *)(plVar4 + 2);
          if ((uVar3 & 8) != 0) {
            if ((uVar3 & 1) != 0) {
              IOAccelMemoryMapList::removeMapping
                        ((IOAccelMemoryMapList *)(param_1 + 0x200),(long)plVar4);
              IOAccelMemoryMapList::addMapping
                        ((IOAccelMemoryMapList *)(param_1 + 0x1e8),(long)plVar4);
              uVar3 = *(uint *)(plVar4 + 2);
            }
            *(uint *)(plVar4 + 2) = uVar3 & 0xfffffff7;
            uVar3 = uVar3 & 0xfffffff5;
            if ((param_2 & 4) != 0) {
              uVar3 = uVar3 | 2;
            }
            *(uint *)(plVar4 + 2) = uVar3;
            return plVar4;
          }
          (**(code **)(*plVar4 + 0x20))(plVar4);
          if ((param_2 & 4) == 0) {
            return plVar4;
          }
          *(byte *)(plVar4 + 2) = *(byte *)(plVar4 + 2) | 2;
          return plVar4;
        }
        iVar9 = iVar9 + (uint)((*(uint *)(plVar4 + 2) >> 3 & 1) != 0);
        sVar2 = *(short *)(this + 0x5a);
        pIVar6 = pIVar5;
      }
      lVar7 = lVar7 + 1;
    } while (lVar7 < sVar2);
    if (((1 < iVar9) && (lVar7 = *(long *)(this + 0x28), (*(byte *)(lVar7 + 0xc78) & 8) == 0)) &&
       (0 < sVar2)) {
      uVar8 = (ulong)(uint)(int)sVar2 + 1;
      do {
        plVar4 = *(long **)(*(long *)(this + 0x50) + (ulong)((int)uVar8 - 2) * 8);
        if ((((IOAccelTask *)plVar4[0x12] == param_1) && ((*(byte *)(plVar4 + 2) & 8) != 0)) &&
           (cVar1 = IOAccelMemoryMap::testEvent((long)plVar4,pIVar6,lVar7), lVar7 = extraout_RDX,
           cVar1 != '\0')) {
          (**(code **)(*plVar4 + 0x28))(plVar4);
          lVar7 = extraout_RDX_00;
        }
        uVar8 = uVar8 - 1;
      } while (1 < uVar8);
    }
  }
  plVar4 = (long *)(**(code **)(**(long **)(this + 0x28) + 0x8c8))
                             (*(long **)(this + 0x28),param_1,this,param_2);
  if (plVar4 != (long *)0x0) {
    if ((*(byte *)(plVar4 + 2) & 2) == 0) {
      return plVar4;
    }
    if ((param_3 != 0) && (param_4 != 0)) {
      cVar1 = (**(code **)(*plVar4 + 0x158))(plVar4,param_3,param_4);
      if (cVar1 == '\0') {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: failed to reserve the GPUVM address 0x%llx length 0x%llx\n",
                          "virtual IOAccelMemoryMap *IOAccelMemory::createMappingInTaskAtAddressLength(IOAccelTask *, uint32_t, uint64_t, uint64_t)"
                          ,param_3,param_4);
        (**(code **)(*plVar4 + 0x28))(plVar4);
        plVar4 = (long *)0x0;
      }
      this[0xd] = (IOAccelMemory)((byte)this[0xd] & 0xe7);
      return plVar4;
    }
    cVar1 = (**(code **)(*plVar4 + 0x150))(plVar4);
    if (cVar1 != '\0') {
      return plVar4;
    }
    if ((*(byte *)(*(long *)(this + 0x28) + 0xc92) & 0x40) == 0) {
      cVar1 = (**(code **)(*(long *)param_1 + 0x120))(param_1,plVar4);
    }
    else {
      IOAccelTask::prune_orphaned_mappings(param_1);
      cVar1 = (**(code **)(*plVar4 + 0x150))(plVar4);
      if (cVar1 != '\0') {
        return plVar4;
      }
      IOAccelTask::free_orphaned_mappings(param_1);
      cVar1 = (**(code **)(*plVar4 + 0x150))(plVar4);
    }
    if (cVar1 != '\0') {
      return plVar4;
    }
    (**(code **)(*plVar4 + 0x28))(plVar4);
  }
  return (long *)0x0;
}



// IOAccelMemory::make_resident()

undefined8 __thiscall IOAccelMemory::make_resident(IOAccelMemory *this)

{
  undefined8 in_RAX;
  undefined8 uVar1;
  
  if (((byte)this[0xc] & 2) == 0) {
                    // WARNING: Could not recover jumptable at 0x000032c4. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (**(code **)(*(long *)this + 0x1b0))();
    return uVar1;
  }
  return CONCAT71((int7)((ulong)in_RAX >> 8),1);
}



// IOAccelMemory::prepare()

undefined8 __thiscall IOAccelMemory::prepare(IOAccelMemory *this)

{
  undefined4 uVar1;
  char cVar2;
  
  if ((((byte)this[0xc] & 2) == 0) &&
     (cVar2 = (**(code **)(*(long *)this + 0x1b0))(this), cVar2 == '\0')) {
    return 0;
  }
  *(int *)(this + 0x10) = *(int *)(this + 0x10) + 1;
  uVar1 = *(undefined4 *)(*(long *)(this + 0x28) + 0xa0);
  *(undefined4 *)(this + 0x18) = uVar1;
  return CONCAT71((uint7)(uint3)((uint)uVar1 >> 8),1);
}



// IOAccelMemory::complete()

void __thiscall IOAccelMemory::complete(IOAccelMemory *this)

{
  *(int *)(this + 0x10) = *(int *)(this + 0x10) + -1;
  return;
}



// IOAccelMemory::getPrepareCount() const

int __thiscall IOAccelMemory::getPrepareCount(IOAccelMemory *this)

{
  int iVar1;
  int iVar2;
  long lVar3;
  
  iVar2 = *(int *)(this + 0x10);
  if (0 < *(short *)(this + 0x5a)) {
    lVar3 = 0;
    do {
      iVar1 = IOAccelMemoryMap::getPrepareCount
                        (*(IOAccelMemoryMap **)(*(long *)(this + 0x50) + lVar3 * 8));
      iVar2 = (iVar2 + 1) - (uint)(iVar1 == 0);
      lVar3 = lVar3 + 1;
    } while (lVar3 < *(short *)(this + 0x5a));
  }
  return iVar2;
}



// IOAccelMemory::finishAllEvent()

void __thiscall IOAccelMemory::finishAllEvent(IOAccelMemory *this)

{
  long lVar1;
  
  if (0 < *(short *)(this + 0x5a)) {
    lVar1 = 0;
    do {
      (**(code **)(**(long **)(*(long *)(this + 0x28) + 0x380) + 0x188))
                (*(long **)(*(long *)(this + 0x28) + 0x380),
                 *(long *)(*(long *)(this + 0x50) + lVar1 * 8) + 0x38);
      lVar1 = lVar1 + 1;
    } while (lVar1 < *(short *)(this + 0x5a));
  }
  if (*(IOAccelExternalEvent **)(this + 0x60) != (IOAccelExternalEvent *)0x0) {
    IOAccelExternalEvent::finish(*(IOAccelExternalEvent **)(this + 0x60));
    return;
  }
  return;
}



// IOAccelMemory::getWireSerial() const

undefined8 __thiscall IOAccelMemory::getWireSerial(IOAccelMemory *this)

{
  return *(undefined8 *)(this + 0xa8);
}



// IOAccelMemory::addSizesToAllocationTotals(IOAccelMemoryInfoAllocTotals*)

void __thiscall IOAccelMemory::addSizesToAllocationTotals(IOAccelMemory *this,long param_1)

{
  long lVar1;
  int iVar2;
  long lVar3;
  long lVar4;
  char cVar5;
  uint uVar6;
  long lVar7;
  long *plVar8;
  ulonglong local_48;
  long local_40;
  undefined4 local_34;
  
  uVar6 = *(uint *)(this + 0xc);
  lVar7 = param_1 + 0x38;
  lVar1 = 0x38;
  if ((uVar6 & 4) == 0) {
    lVar7 = param_1;
    lVar1 = 0;
  }
  if ((uVar6 >> 10 & 1) != 0) {
    lVar3 = (**(code **)(*(long *)this + 0x120))(this);
    plVar8 = (long *)(lVar7 + 0x30);
    goto LAB_00003599;
  }
  if ((uVar6 & 0x20) == 0) {
    local_48 = CONCAT44(local_48._4_4_,0xaaaaaaaa);
    iVar2 = (**(code **)(*(long *)this + 0x160))(this,1,&local_48);
    local_34 = CONCAT31((int3)((int)local_48 - 3U >> 8),(int)local_48 - 3U < 2 && iVar2 == 0);
    uVar6 = *(uint *)(this + 0xc);
  }
  else {
    local_34 = 0;
  }
  if ((uVar6 & 4) == 0) {
    cVar5 = (char)((uVar6 & 2) >> 1);
    lVar3 = OSMetaClassBase::safeMetaCast
                      ((OSMetaClassBase *)this,(OSMetaClass *)&IOAccelSysMemory::gMetaClass);
    if (lVar3 == 0) {
      lVar3 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "Memory couldn\'t be casted to IOAccelSysMem: 0x%p\n",this);
      local_40 = 0;
    }
    else {
      local_48 = 0;
      iVar2 = IOMemoryDescriptor::getPageCounts(*(ulonglong **)(lVar3 + 0xd0),&local_48);
      if (iVar2 != -0x1ffffd28) {
        if (iVar2 == 0) {
          local_40 = 0;
          lVar3 = *(long *)PTR__page_size_0006b108 * local_48;
          goto LAB_0000355e;
        }
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: IOMemoryDescriptor::getPageCounts returned 0x%08x\n",
                          "void IOAccelMemory::addSizesToAllocationTotals(sIOAccelMemoryInfoAllocTotals *)"
                          ,iVar2);
      }
      local_40 = (**(code **)(*(long *)this + 0x120))(this);
      lVar3 = (**(code **)(*(long *)this + 0x120))(this);
    }
  }
  else {
    lVar3 = (**(code **)(*(long *)this + 0x120))(this);
    local_40 = 0;
    cVar5 = '\0';
  }
LAB_0000355e:
  lVar4 = (**(code **)(*(long *)this + 0x120))(this);
  *(long *)(param_1 + lVar1) = *(long *)(param_1 + lVar1) + lVar4;
  *(long *)(lVar7 + 8) = *(long *)(lVar7 + 8) + lVar3;
  *(long *)(lVar7 + 0x18) = *(long *)(lVar7 + 0x18) + local_40;
  if (cVar5 == '\0') {
    if ((char)local_34 != '\0') {
      plVar8 = (long *)(lVar7 + 0x20);
      goto LAB_00003599;
    }
  }
  else {
    *(long *)(lVar7 + 0x10) = *(long *)(lVar7 + 0x10) + lVar3;
  }
  plVar8 = (long *)(lVar7 + 0x28);
LAB_00003599:
  *plVar8 = *plVar8 + lVar3;
  return;
}



// IOAccelMemory::redirectActiveMappings(IOAccelMemory*)

bool __thiscall IOAccelMemory::redirectActiveMappings(IOAccelMemory *this,undefined8 param_1)

{
  long *plVar1;
  char cVar2;
  int iVar3;
  ulong uVar4;
  
  uVar4 = (ulong)(uint)(int)*(short *)(this + 0x5a);
  do {
    iVar3 = (int)uVar4;
    if (iVar3 < 1) break;
    plVar1 = *(long **)(*(long *)(this + 0x50) + -8 + uVar4 * 8);
    uVar4 = uVar4 - 1;
    cVar2 = (**(code **)(*plVar1 + 0x1c0))(plVar1,param_1);
  } while (cVar2 != '\0');
  return iVar3 < 1;
}



// IOAccelMemory::merge_mapping_events(IOAccelEvent*)

void __thiscall IOAccelMemory::merge_mapping_events(IOAccelMemory *this,undefined8 param_1)

{
  long lVar1;
  
  if (0 < *(short *)(this + 0x5a)) {
    lVar1 = 0;
    do {
      (**(code **)(**(long **)(*(long *)(this + 0x28) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x28) + 0x380),
                 *(long *)(*(long *)(this + 0x50) + lVar1 * 8) + 0x38,param_1);
      lVar1 = lVar1 + 1;
    } while (lVar1 < *(short *)(this + 0x5a));
  }
  return;
}



// IOAccelMemory::incrementExternalMemoryEvent()

undefined8 __thiscall IOAccelMemory::incrementExternalMemoryEvent(IOAccelMemory *this)

{
  IOAccelExternalEvent *this_00;
  
  this_00 = *(IOAccelExternalEvent **)(this + 0x60);
  if (this_00 == (IOAccelExternalEvent *)0x0) {
    this_00 = (IOAccelExternalEvent *)IOAccelExternalEvent::externalEvent();
    *(IOAccelExternalEvent **)(this + 0x60) = this_00;
  }
  IOAccelExternalEvent::increment(this_00);
  return *(undefined8 *)(this + 0x60);
}



// IOAccelMemory::scrubAllEvents()

ulong __thiscall IOAccelMemory::scrubAllEvents(IOAccelMemory *this)

{
  char cVar1;
  undefined8 unaff_RBX;
  ulong uVar2;
  long lVar3;
  
  if (*(short *)(this + 0x5a) < 1) {
    uVar2 = CONCAT71((int7)((ulong)unaff_RBX >> 8),1);
  }
  else {
    uVar2 = 1;
    lVar3 = 0;
    do {
      cVar1 = (**(code **)(**(long **)(*(long *)(this + 0x28) + 0x380) + 0x270))
                        (*(long **)(*(long *)(this + 0x28) + 0x380),
                         *(long *)(*(long *)(this + 0x50) + lVar3 * 8) + 0x38);
      if (cVar1 == '\0') {
        uVar2 = 0;
      }
      lVar3 = lVar3 + 1;
    } while (lVar3 < *(short *)(this + 0x5a));
  }
  return uVar2 & 0xffffffff;
}



// IOAccelMemory::_RESERVEDIOAccelMemory0()

void IOAccelMemory::_RESERVEDIOAccelMemory0(void)

{
  OSMetaClass::reservedCalled(0x81f08);
  return;
}



// IOAccelMemory::_RESERVEDIOAccelMemory1()

void IOAccelMemory::_RESERVEDIOAccelMemory1(void)

{
  OSMetaClass::reservedCalled(0x81f08);
  return;
}



// IOAccelMemory::_RESERVEDIOAccelMemory2()

void IOAccelMemory::_RESERVEDIOAccelMemory2(void)

{
  OSMetaClass::reservedCalled(0x81f08);
  return;
}



// IOAccelMemory::_RESERVEDIOAccelMemory3()

void IOAccelMemory::_RESERVEDIOAccelMemory3(void)

{
  OSMetaClass::reservedCalled(0x81f08);
  return;
}



// IOAccelMemory::_RESERVEDIOAccelMemory4()

void IOAccelMemory::_RESERVEDIOAccelMemory4(void)

{
  OSMetaClass::reservedCalled(0x81f08);
  return;
}



// IOAccelMemory::_RESERVEDIOAccelMemory5()

void IOAccelMemory::_RESERVEDIOAccelMemory5(void)

{
  OSMetaClass::reservedCalled(0x81f08);
  return;
}



// IOAccelMemory::MetaClass::~MetaClass()

void __thiscall IOAccelMemory::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelMemory::getLength() const

undefined8 __thiscall IOAccelMemory::getLength(IOAccelMemory *this)

{
  return *(undefined8 *)(this + 0x40);
}



void __GLOBAL__sub_I_IOAccelMemory_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelMemory::gMetaClass,"IOAccelMemory",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0xb0);
  IOAccelMemory::gMetaClass = (undefined *)&PTR__MetaClass_0006c058;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelMemory::gMetaClass);
  return;
}



// IOAccel2DContext2::MetaClass::MetaClass()

void __thiscall IOAccel2DContext2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccel2DContext2",(OSMetaClass *)&IOAccelContext2::gMetaClass,
             0x1100);
  *(undefined ***)this = &PTR__MetaClass_0006cce8;
  return;
}



// IOAccel2DContext2::MetaClass::~MetaClass()

void __thiscall IOAccel2DContext2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccel2DContext2::IOAccel2DContext2(OSMetaClass const*)

void __thiscall IOAccel2DContext2::IOAccel2DContext2(IOAccel2DContext2 *this,OSMetaClass *param_1)

{
  IOAccelContext2::IOAccelContext2((IOAccelContext2 *)this,param_1);
  *(undefined ***)this = &PTR__IOAccel2DContext2_0006c150;
  return;
}



// IOAccel2DContext2::~IOAccel2DContext2()

void __thiscall IOAccel2DContext2::~IOAccel2DContext2(IOAccel2DContext2 *this)

{
  IOAccelContext2::~IOAccelContext2((IOAccelContext2 *)this);
  return;
}



// IOAccel2DContext2::~IOAccel2DContext2()

void __thiscall IOAccel2DContext2::~IOAccel2DContext2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccel2DContext2::~IOAccel2DContext2()

void __thiscall IOAccel2DContext2::~IOAccel2DContext2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccel2DContext2::getMetaClass() const

undefined ** IOAccel2DContext2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccel2DContext2::MetaClass::MetaClass()

void __thiscall IOAccel2DContext2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccel2DContext2",(OSMetaClass *)&IOAccelContext2::gMetaClass,
             0x1100);
  *(undefined ***)this = &PTR__MetaClass_0006cce8;
  return;
}



// IOAccel2DContext2::MetaClass::alloc() const

undefined8 IOAccel2DContext2::MetaClass::alloc(void)

{
  return 0;
}



// IOAccel2DContext2::operator new(unsigned long)

void * __thiscall IOAccel2DContext2::operator_new(IOAccel2DContext2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccel2DContext2_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccel2DContext2::operator delete(void*, unsigned long)

void __cdecl IOAccel2DContext2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccel2DContext2_ktv,param_1,param_2);
  return;
}



// IOAccel2DContext2::set_surface(unsigned int, eIOAccelContextModeBits)

undefined8 __thiscall
IOAccel2DContext2::set_surface(IOAccel2DContext2 *this,uint param_1,uint param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  long *plVar2;
  char cVar3;
  uint uVar4;
  IOAccelSurface *this_00;
  undefined8 uVar5;
  undefined8 uVar6;
  
  if ((param_2 & 0x7f803f) == 0) {
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    uVar6 = 0;
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    if ((param_2 >> 0xb & 1) == 0) {
      plVar2 = *(long **)(this + 0x5c0);
      if (plVar2 != (long *)0x0) {
        (**(code **)(*plVar2 + 0xa00))(plVar2,this);
        (**(code **)(**(long **)(this + 0x5c0) + 0x9e0))();
        if (*(IOAccelLegacySurface **)(this + 0x5c8) != (IOAccelLegacySurface *)0x0) {
          IOAccelLegacySurface::pick_present_type(*(IOAccelLegacySurface **)(this + 0x5c8));
        }
        *(undefined8 *)(this + 0x5c0) = 0;
        *(undefined8 *)(this + 0x5c8) = 0;
      }
      uVar4 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x10b0))
      ;
      if (param_1 < uVar4) {
        cVar3 = IOAccelDisplayMachine::isFramebufferActive
                          (*(IOAccelDisplayMachine **)(this + 0x10b0),param_1);
        uVar6 = 0;
        if (cVar3 == '\0') {
          param_1 = 0;
        }
      }
      else {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Invalid framebuffer index = %u\n",
                          "IOReturn IOAccel2DContext2::set_surface(uint32_t, enum eIOAccelContextModeBits)"
                          ,param_1);
        uVar6 = 0xe00002c2;
        param_1 = 0;
      }
      *(uint *)(this + 0x10b8) = param_1;
      *(undefined4 *)(this + 0x10a8) = 0;
    }
    else {
      if (param_1 == 0) {
        this_00 = (IOAccelSurface *)0x0;
      }
      else {
        this_00 = (IOAccelSurface *)
                  IOAccelSurfaceList::findSurfaceForID
                            ((IOAccelSurfaceList *)(*(long *)(this + 0x5a8) + 0xaa8),param_1);
        if (this_00 == (IOAccelSurface *)0x0) {
          this_00 = (IOAccelSurface *)0x0;
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Invalid surface ID = %u\n",
                            "IOReturn IOAccel2DContext2::set_surface(uint32_t, enum eIOAccelContextModeBits)"
                            ,param_1);
          uVar6 = 0xe00002c2;
        }
      }
      plVar2 = *(long **)(this + 0x5c0);
      if (plVar2 != (long *)0x0) {
        (**(code **)(*plVar2 + 0xa00))(plVar2,this);
        if (*(IOAccelSurface **)(this + 0x5c0) != this_00) {
          (**(code **)(*(long *)*(IOAccelSurface **)(this + 0x5c0) + 0x9e0))();
        }
      }
      if (this_00 == (IOAccelSurface *)0x0) {
        *(undefined4 *)(this + 0x10b8) = 0;
        *(undefined8 *)(this + 0x5c0) = 0;
        *(undefined8 *)(this + 0x5c8) = 0;
      }
      else {
        if ((*(ulong *)(this_00 + 0x11b0) & 0xc00) != 0) {
          if (((uint)*(ulong *)(this_00 + 0x11b0) >> 0xb & 1) == 0) {
            param_2 = param_2 & 0xfffff3ff | 0x400;
          }
          else {
            param_2 = param_2 & 0xfffff3ff | 0x800;
          }
        }
        *(undefined4 *)(this + 0x10b8) = 0xffff;
        if (this_00 != *(IOAccelSurface **)(this + 0x5c0)) {
          (**(code **)(*(long *)this_00 + 0x9e8))(this_00);
        }
        IOAccelSurface::set_compatible_surface_mode(this_00,(long *)this,(ulong)param_2);
        *(uint *)(this + 0x10a8) = 2 - (uint)((param_2 & 0x400) == 0);
        *(uint *)(this + 0x10bc) = (param_2 & 0x400) >> 10;
        (**(code **)(*(long *)this_00 + 0x9f8))(this_00,this);
        *(IOAccelSurface **)(this + 0x5c0) = this_00;
        uVar5 = OSMetaClassBase::safeMetaCast
                          ((OSMetaClassBase *)this_00,
                           (OSMetaClass *)&IOAccelLegacySurface::gMetaClass);
        *(undefined8 *)(this + 0x5c8) = uVar5;
        (**(code **)(**(long **)(this + 0x5c0) + 0x9e0))();
        (**(code **)(**(long **)(this + 0x5c0) + 0x9d8))();
        if (*(IOAccelLegacySurface **)(this + 0x5c8) != (IOAccelLegacySurface *)0x0) {
          IOAccelLegacySurface::pick_present_type(*(IOAccelLegacySurface **)(this + 0x5c8));
        }
      }
    }
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Context mode contains surface mode bits\n",
                      "IOReturn IOAccel2DContext2::set_surface(uint32_t, enum eIOAccelContextModeBits)"
                     );
    uVar6 = 0xe00002c2;
  }
  return uVar6;
}



// IOAccel2DContext2::finish(unsigned int)

undefined8 __thiscall IOAccel2DContext2::finish(IOAccel2DContext2 *this,int param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  long lVar2;
  int iVar3;
  int *piVar4;
  
  if (param_1 == 0) {
    iVar3 = (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x178))
                      (*(long **)(*(long *)(this + 0x5a8) + 0x380),this + 0x5d0);
    if (iVar3 == -1) {
      return 0xe00002d6;
    }
    lVar2 = *(long *)(this + 0x5a8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar2 + 0x388) + 0x58),0x3f);
    piVar4 = (int *)(lVar2 + 0x29c);
  }
  else {
    if ((param_1 != 2) && (param_1 != 1)) {
      return 0xe00002c2;
    }
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    iVar3 = (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x158))();
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
    if (iVar3 == -1) {
      return 0xe00002d6;
    }
    lVar2 = *(long *)(this + 0x5a8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar2 + 0x388) + 0x58),0x3e);
    piVar4 = (int *)(lVar2 + 0x298);
  }
  *piVar4 = *piVar4 + iVar3;
  return 0;
}



// IOAccel2DContext2::blit(IOAccel2DBlitCommand*, unsigned long long)

undefined8 __thiscall IOAccel2DContext2::blit(IOAccel2DContext2 *this,uint *param_1,long param_2)

{
  uint uVar1;
  IOGraphicsAccelerator2 *pIVar2;
  char cVar3;
  uint uVar4;
  uintptr_t uVar5;
  long *plVar6;
  long lVar7;
  IOAccelLegacyDisplayMachine *this_00;
  long *plVar8;
  undefined8 uVar9;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  ulong local_38;
  
  if ((ulong)param_1[1] * 0xc + 0x10 != param_2) {
    return 0xe00002c2;
  }
  if (1 < *param_1) {
    return 0xe00002c2;
  }
  local_38 = 0;
LAB_00003d71:
  do {
    pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
    _OSIncrementAtomic(pIVar2 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar2 + 0x88));
    _OSDecrementAtomic(pIVar2 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar2);
    (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
    if (*(long *)(this + 0x5c8) == 0) {
      if (*(long *)(this + 0x5c0) != 0) goto LAB_00003dd3;
    }
    else if (0xff < *(uint *)(&DAT_00001168 + *(long *)(this + 0x5c8))) {
LAB_00003dd3:
      IOGraphicsAccelerator2::acceleratorWaitEnabled(*(IOGraphicsAccelerator2 **)(this + 0x5a8));
    }
    pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
    if (((byte)pIVar2[0xc78] & 2) == 0) {
      uVar9 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Submission with accelerator disabled\n",
                        "IOReturn IOAccel2DContext2::blit(IOAccel2DBlitCommand *, IOByteCount)");
      goto LAB_00004489;
    }
    lVar7 = *(long *)(this + 0x5c0);
    if (lVar7 == 0) {
      if (*(uint *)(this + 0x10b8) == 0xffff) {
        uVar9 = 0;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Submit with no surface and invalid framebuffer index\n",
                          "IOReturn IOAccel2DContext2::blit(IOAccel2DBlitCommand *, IOByteCount)");
        goto LAB_00004489;
      }
      plVar6 = (long *)IOAccelDisplayMachine::getFramebufferResource
                                 (*(IOAccelDisplayMachine **)(this + 0x10b0),
                                  (ulong)*(uint *)(this + 0x10b8),0);
      goto LAB_00003fca;
    }
    if (*(char *)(lVar7 + 0xf1) != '\0') {
      uVar5 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x85020075,uVar5,0,0,0,0);
      plVar6 = *(long **)(this + 0x5a8);
      uVar9 = *(undefined8 *)(this + 0x5c0);
      (**(code **)(*plVar6 + 0x858))(plVar6,"",0);
      _IOLockSleep_darwin14(plVar6[0x11],uVar9,0);
      (**(code **)(*plVar6 + 0x850))(plVar6,"",0);
      uVar5 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x85020076,uVar5,0,0,0,0);
      pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
      (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar2);
      _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
      goto LAB_00003d71;
    }
    if ((&DAT_0000118c)[lVar7] != '\0') {
      uVar9 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: surface disabled\n",
                        "IOReturn IOAccel2DContext2::blit(IOAccel2DBlitCommand *, IOByteCount)");
      goto LAB_00004489;
    }
    if (((&DAT_000010d0)[lVar7] == '\0') || (999 < (uint)local_38)) break;
    local_38 = (ulong)((uint)local_38 + 1);
    (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar2);
    _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
    _thread_block(0);
    _IOSleep(1);
  } while( true );
  plVar6 = *(long **)(&DAT_000011c0 + (long)*(int *)(this + 0x10bc) * 8 + lVar7);
LAB_00003fca:
  if (plVar6 == (long *)0x0) {
    uVar9 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: No dstBuffer\n",
                      "IOReturn IOAccel2DContext2::blit(IOAccel2DBlitCommand *, IOByteCount)");
    goto LAB_00004489;
  }
  cVar3 = (**(code **)(*plVar6 + 0x170))(plVar6);
  if (cVar3 == '\0') {
    uVar9 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Failed to wire down dstBuffer\n",
                      "IOReturn IOAccel2DContext2::blit(IOAccel2DBlitCommand *, IOByteCount)");
    goto LAB_00004489;
  }
  if (*param_1 == 1) {
    uVar1 = param_1[2];
    if (uVar1 == 0) {
      uVar1 = param_1[3];
      uVar4 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x10b0))
      ;
      if ((uVar1 < uVar4) &&
         (this_00 = (IOAccelLegacyDisplayMachine *)
                    OSMetaClassBase::safeMetaCast
                              (*(OSMetaClassBase **)(this + 0x10b0),
                               (OSMetaClass *)&IOAccelLegacyDisplayMachine::gMetaClass),
         this_00 != (IOAccelLegacyDisplayMachine *)0x0)) {
        lVar7 = IOAccelLegacyDisplayMachine::getFullScreenSurface(this_00,param_1[3]);
        if (lVar7 == 0) {
          plVar8 = (long *)IOAccelDisplayMachine::getFramebufferResource
                                     (*(IOAccelDisplayMachine **)(this + 0x10b0),(ulong)param_1[3],0
                                     );
        }
        else {
LAB_0000424f:
          plVar8 = *(long **)(&DAT_000011c0 + lVar7);
        }
        if (plVar8 == (long *)0x0) {
LAB_0000445e:
          uVar9 = 0;
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: No srcBuffer\n",
                            "IOReturn IOAccel2DContext2::blit(IOAccel2DBlitCommand *, IOByteCount)")
          ;
          goto LAB_00004489;
        }
        goto LAB_000042b5;
      }
    }
    else {
      plVar8 = plVar6;
      if (uVar1 == 2) {
LAB_000042b5:
        cVar3 = (**(code **)(*plVar8 + 0x170))(plVar8);
        if (cVar3 == '\0') {
          uVar9 = 0;
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: Failed to wire down srcBuffer\n",
                            "IOReturn IOAccel2DContext2::blit(IOAccel2DBlitCommand *, IOByteCount)")
          ;
          goto LAB_00004489;
        }
        local_40 = &DAT_aaaaaaaaaaaaaaaa;
        local_48 = &DAT_aaaaaaaaaaaaaaaa;
        local_50 = &DAT_aaaaaaaaaaaaaaaa;
        local_58 = &DAT_aaaaaaaaaaaaaaaa;
        local_60 = &DAT_aaaaaaaaaaaaaaaa;
        local_68 = &DAT_aaaaaaaaaaaaaaaa;
        local_70 = &DAT_aaaaaaaaaaaaaaaa;
        local_78 = &DAT_aaaaaaaaaaaaaaaa;
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x140))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_78);
        (**(code **)(*(long *)this + 0xb40))(this,&local_78,plVar8,plVar6,param_1 + 4,param_1[1]);
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_78,this + 0x5d0);
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_78,plVar8[8] + 0x38);
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_78,plVar6[8] + 0x38);
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_78,
                   (ulong)*(byte *)((long)plVar8 + 0x15) * 0x40 + plVar8[7]);
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_78,
                   (ulong)*(byte *)((long)plVar6 + 0x15) * 0x40 + plVar6[7]);
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_78,
                   (ulong)*(byte *)((long)plVar6 + 0x16) * 0x40 + plVar6[7]);
        (**(code **)(*plVar6 + 0x168))(plVar6,0,0);
        (**(code **)(*plVar8 + 0x178))(plVar8);
        goto LAB_000041b6;
      }
      if (uVar1 == 1) {
        lVar7 = IOAccelSurfaceList::findSurfaceForID
                          ((IOAccelSurfaceList *)(*(long *)(this + 0x5a8) + 0xaa8),param_1[3]);
        if (lVar7 != 0) {
          if ((&DAT_0000118c)[*(long *)(this + 0x5c0)] == '\0') goto LAB_0000424f;
          goto LAB_0000445e;
        }
      }
      else {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: blitCommand->sourceType invalid\n",
                          "IOReturn IOAccel2DContext2::blit(IOAccel2DBlitCommand *, IOByteCount)");
      }
    }
    (**(code **)(*plVar6 + 0x178))(plVar6);
    uVar9 = 0xe00002c2;
  }
  else {
    local_40 = &DAT_aaaaaaaaaaaaaaaa;
    local_48 = &DAT_aaaaaaaaaaaaaaaa;
    local_50 = &DAT_aaaaaaaaaaaaaaaa;
    local_58 = &DAT_aaaaaaaaaaaaaaaa;
    local_60 = &DAT_aaaaaaaaaaaaaaaa;
    local_68 = &DAT_aaaaaaaaaaaaaaaa;
    local_70 = &DAT_aaaaaaaaaaaaaaaa;
    local_78 = &DAT_aaaaaaaaaaaaaaaa;
    (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x140))
              (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_78);
    (**(code **)(*(long *)this + 0xb48))(this,&local_78,param_1[3],plVar6,param_1 + 4,param_1[1]);
    (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
              (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_78,this + 0x5d0);
    (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
              (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_78,plVar6[8] + 0x38);
    (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
              (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_78,
               (ulong)*(byte *)((long)plVar6 + 0x15) * 0x40 + plVar6[7]);
    (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
              (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_78,
               (ulong)*(byte *)((long)plVar6 + 0x16) * 0x40 + plVar6[7]);
    (**(code **)(*plVar6 + 0x168))(plVar6,0,0);
LAB_000041b6:
    (**(code **)(*plVar6 + 0x178))(plVar6);
    uVar9 = 0;
  }
LAB_00004489:
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar2);
  _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
  return uVar9;
}



// IOAccel2DContext2::contextStart()

ulong __thiscall IOAccel2DContext2::contextStart(IOAccel2DContext2 *this)

{
  long lVar1;
  long *plVar2;
  ulong uVar3;
  
  uVar3 = IOAccelContext2::contextStart((IOAccelContext2 *)this);
  if ((char)uVar3 != '\0') {
    lVar1 = *(long *)(this + 0x5a8);
    *(undefined8 *)(this + 0x10b0) = *(undefined8 *)(lVar1 + 0x378);
    *(undefined8 *)(this + 0x5c0) = 0;
    *(undefined8 *)(this + 0x5c8) = 0;
    *(undefined8 *)(this + 0x10b8) = 0;
    *(undefined4 *)(this + 0x10a8) = 0;
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar1 + 0x388) + 0x58),0x23);
    *(int *)(lVar1 + 0x22c) = *(int *)(lVar1 + 0x22c) + 1;
    plVar2 = *(long **)(*(long *)(this + 0x5a8) + 0x150);
    *(long **)(this + 0x598) = plVar2;
    (**(code **)(*plVar2 + 0x20))();
  }
  return uVar3 & 0xffffffff;
}



// IOAccel2DContext2::contextStop()

void __thiscall IOAccel2DContext2::contextStop(IOAccel2DContext2 *this)

{
  int *piVar1;
  uint uVar2;
  long *plVar3;
  long lVar4;
  ulong uVar5;
  undefined1 *puStack_30;
  undefined1 *puStack_28;
  undefined1 *puStack_20;
  
  plVar3 = *(long **)(this + 0x5c0);
  if (plVar3 != (long *)0x0) {
    puStack_20 = (undefined1 *)0x458e;
    (**(code **)(*plVar3 + 0xa00))(plVar3,this);
    puStack_20 = (undefined1 *)0x459e;
    (**(code **)(**(long **)(this + 0x5c0) + 0x9e0))();
    *(undefined8 *)(this + 0x5c0) = 0;
    *(undefined8 *)(this + 0x5c8) = 0;
  }
  lVar4 = *(long *)(this + 0x5a8);
  puStack_20 = (undefined1 *)0x45d1;
  IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar4 + 0x388) + 0x58),0x23);
  piVar1 = (int *)(lVar4 + 0x22c);
  *piVar1 = *piVar1 + -1;
  if (*(long **)(this + 0x598) != (long *)0x0) {
    puStack_20 = (undefined1 *)0x45ea;
    (**(code **)(**(long **)(this + 0x598) + 0x28))();
    *(undefined8 *)(this + 0x598) = 0;
  }
  IOAccelFenceMachine::cancelBlockFenceCallback
            (*(IOAccelFenceMachine **)(*(long *)(this + 0x5a8) + 0x390),(long)this);
  if (*(long **)(this + 0x588) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x588) + 0x28))();
    *(undefined8 *)(this + 0x588) = 0;
  }
  lVar4 = *(long *)(this + 0x5b8);
  if (lVar4 != 0) {
    uVar2 = **(uint **)(this + 0x5b0);
    if (uVar2 == 0) {
      uVar2 = 0;
    }
    else {
      uVar5 = 0;
      do {
        plVar3 = *(long **)(*(long *)(this + 0x5b8) + uVar5 * 8);
        if (plVar3 != (long *)0x0) {
          (**(code **)(*plVar3 + 0x28))();
          *(undefined8 *)(*(long *)(this + 0x5b8) + uVar5 * 8) = 0;
          uVar2 = **(uint **)(this + 0x5b0);
        }
        uVar5 = uVar5 + 1;
      } while (uVar5 < uVar2);
      lVar4 = *(long *)(this + 0x5b8);
    }
    *(undefined8 *)(this + 0x5b8) = 0;
    _IOFreeTypeVarImpl(&IOAccelContext2::contextStop()::kalloc_type_view_385,lVar4,(ulong)uVar2 << 3
                      );
    *(undefined8 *)(this + 0x5b8) = 0;
  }
  if (*(long **)(this + 0x6c0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x6c0) + 0x28))();
    *(undefined8 *)(this + 0x6c0) = 0;
    *(undefined8 *)(this + 0x6a0) = 0;
    *(undefined4 *)(this + 0x6c8) = 0;
  }
  if (*(long **)(this + 0x6d0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x6d0) + 0x28))();
    *(undefined8 *)(this + 0x6d0) = 0;
    *(undefined8 *)(this + 0x6a8) = 0;
    *(undefined4 *)(this + 0x6d8) = 0;
  }
  if (*(long **)(this + 0x6b0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x6b0) + 0x28))();
    *(undefined8 *)(this + 0x6b0) = 0;
    *(undefined8 *)(this + 0x620) = 0;
    *(undefined8 *)(this + 0x628) = 0;
  }
  uVar2 = *(uint *)(this + 0x6dc);
  if (uVar2 != 0) {
    uVar5 = 0;
    do {
      if (*(long **)(this + uVar5 * 8 + 0xfe0) != (long *)0x0) {
        (**(code **)(**(long **)(this + uVar5 * 8 + 0xfe0) + 0x28))();
        *(undefined8 *)(this + uVar5 * 8 + 0xfe0) = 0;
        uVar2 = *(uint *)(this + 0x6dc);
      }
      uVar5 = uVar5 + 1;
    } while (uVar5 < uVar2);
  }
  IOAccelContext2::freeAllDataBuffers((IOAccelContext2 *)this);
  if (*(IOAccelShared2 **)(this + 0x5a0) != (IOAccelShared2 *)0x0) {
    IOAccelShared2::decrement_ctx_refcount(*(IOAccelShared2 **)(this + 0x5a0));
    (**(code **)(**(long **)(this + 0x5a0) + 0x28))();
    *(undefined8 *)(this + 0x5a0) = 0;
  }
  if (*(long **)(this + 0x598) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x598) + 0x28))();
    *(undefined8 *)(this + 0x598) = 0;
  }
  if (*(long *)(this + 0x618) != 0) {
    (**(code **)(**(long **)(this + 0x5a8) + 0x8e0))();
    *(undefined8 *)(this + 0x618) = 0;
  }
  if (*(long *)(this + 0x5b0) != 0) {
    _IOFreeTypeImpl(&IOAccelContext2::contextStop()::kalloc_type_view_449);
    *(undefined8 *)(this + 0x5b0) = 0;
  }
  IOAccelContextList::removeContext
            ((IOAccelContextList *)(*(long *)(this + 0x5a8) + 0xa58),(long)this);
  puStack_30 = &DAT_aaaaaaaaaaaaaaaa;
  puStack_28 = &DAT_aaaaaaaaaaaaaaaa;
  puStack_20 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelChannelList::Iterator::Iterator
            ((Iterator *)&puStack_30,(undefined8 *)(*(long *)(this + 0x5a8) + 0xc38));
  plVar3 = (long *)IOAccelChannelList::Iterator::getNextChannel((Iterator *)&puStack_30);
  if (plVar3 != (long *)0x0) {
    do {
      (**(code **)(*plVar3 + 0x168))(plVar3,this);
      plVar3 = (long *)IOAccelChannelList::Iterator::getNextChannel((Iterator *)&puStack_30);
    } while (plVar3 != (long *)0x0);
  }
  return;
}



// IOAccel2DContext2::getTargetAndMethodForIndex(IOService**, unsigned int)

undefined ** __thiscall
IOAccel2DContext2::getTargetAndMethodForIndex
          (IOAccel2DContext2 *this,undefined8 *param_1,uint param_2)

{
  *param_1 = this;
  if (param_2 - 0x100 < 3) {
    return &s2DContextMethods + (ulong)(param_2 - 0x100) * 6;
  }
  if (param_2 == 2) {
    if ((this[0x570] == (IOAccel2DContext2)0x0) && (this[0x591] == (IOAccel2DContext2)0x0)) {
      return &IOAccelContext2::sSubmitDataBuffersForegroundOnlyOverride;
    }
    *param_1 = this;
  }
  else {
    *param_1 = this;
    if (7 < param_2) {
      return (undefined **)0x0;
    }
  }
  return &IOAccelContext2::sContextMethods + (ulong)param_2 * 6;
}



// IOAccel2DContext2::getSurfaceReqBits() const

undefined4 __thiscall IOAccel2DContext2::getSurfaceReqBits(IOAccel2DContext2 *this)

{
  return *(undefined4 *)(this + 0x10a8);
}



// IOAccel2DContext2::allowsExclusiveMode() const

undefined1 IOAccel2DContext2::allowsExclusiveMode(void)

{
  return 1;
}



// IOAccel2DContext2::_RESERVEDIOAccel2DContext0()

void IOAccel2DContext2::_RESERVEDIOAccel2DContext0(void)

{
  OSMetaClass::reservedCalled(0x81f30);
  return;
}



// IOAccel2DContext2::_RESERVEDIOAccel2DContext1()

void IOAccel2DContext2::_RESERVEDIOAccel2DContext1(void)

{
  OSMetaClass::reservedCalled(0x81f30);
  return;
}



// IOAccel2DContext2::_RESERVEDIOAccel2DContext2()

void IOAccel2DContext2::_RESERVEDIOAccel2DContext2(void)

{
  OSMetaClass::reservedCalled(0x81f30);
  return;
}



// IOAccel2DContext2::_RESERVEDIOAccel2DContext3()

void IOAccel2DContext2::_RESERVEDIOAccel2DContext3(void)

{
  OSMetaClass::reservedCalled(0x81f30);
  return;
}



// IOAccel2DContext2::_RESERVEDIOAccel2DContext4()

void IOAccel2DContext2::_RESERVEDIOAccel2DContext4(void)

{
  OSMetaClass::reservedCalled(0x81f30);
  return;
}



// IOAccel2DContext2::_RESERVEDIOAccel2DContext5()

void IOAccel2DContext2::_RESERVEDIOAccel2DContext5(void)

{
  OSMetaClass::reservedCalled(0x81f30);
  return;
}



// IOAccel2DContext2::MetaClass::~MetaClass()

void __thiscall IOAccel2DContext2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelContext2::getOwningTask() const

undefined8 __thiscall IOAccelContext2::getOwningTask(IOAccelContext2 *this)

{
  return *(undefined8 *)(this + 0x578);
}



// IOAccelContext2::getGPUTask() const

undefined8 __thiscall IOAccelContext2::getGPUTask(IOAccelContext2 *this)

{
  return *(undefined8 *)(this + 0x598);
}



// IOAccelContext2::getOwningTaskPid() const

undefined4 __thiscall IOAccelContext2::getOwningTaskPid(IOAccelContext2 *this)

{
  return *(undefined4 *)(this + 0x580);
}



// IOAccelSubmitter2::retireCommandBuffer(IOAccelEventFence*)

void IOAccelSubmitter2::retireCommandBuffer(void)

{
  return;
}



// IOAccelSubmitter2::setSubmissionError(unsigned int)

void IOAccelSubmitter2::setSubmissionError(void)

{
  return;
}



// IOAccelSubmitter2::isOpportunisticWorkload() const

undefined8 IOAccelSubmitter2::isOpportunisticWorkload(void)

{
  return 0;
}



// IOAccelContext2::postTokenSanityCheck(IOAccelCommandStreamInfo&)

void IOAccelContext2::postTokenSanityCheck(void)

{
  return;
}



// IOAccelContext2::getDataBufferPrivate(IOAccelResource2*, IOAccelResourcePrivate*, unsigned long
// long)

void IOAccelContext2::getDataBufferPrivate(void)

{
  return;
}



// IOAccelContext2::validateDataBuffer(unsigned long long, IOBufferMemoryDescriptor*,
// IOAccelResource2*)

undefined8 IOAccelContext2::validateDataBuffer(void)

{
  return 0;
}



// IOAccelContext2::invalidate()

void IOAccelContext2::invalidate(void)

{
  return;
}



// IOAccelContext2::getFrameDelimiter()

undefined8 IOAccelContext2::getFrameDelimiter(void)

{
  return 0;
}



void __GLOBAL__sub_I_IOAccel2DContext_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccel2DContext2::gMetaClass,"IOAccel2DContext2",
             (OSMetaClass *)&IOAccelContext2::gMetaClass,0x1100);
  IOAccel2DContext2::gMetaClass = (undefined *)&PTR__MetaClass_0006cce8;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccel2DContext2::gMetaClass);
  return;
}



// IOAccelNamespace::MetaClass::MetaClass()

void __thiscall IOAccelNamespace::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelNamespace",(OSMetaClass *)PTR_gMetaClass_0006b068,0x30);
  *(undefined ***)this = &PTR__MetaClass_0006cfa0;
  return;
}



// IOAccelNamespace::MetaClass::~MetaClass()

void __thiscall IOAccelNamespace::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelNamespace::IOAccelNamespace(OSMetaClass const*)

void __thiscall IOAccelNamespace::IOAccelNamespace(IOAccelNamespace *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelNamespace_0006ce70;
  return;
}



// IOAccelNamespace::IOAccelNamespace(OSMetaClass const*)

void __thiscall IOAccelNamespace::IOAccelNamespace(IOAccelNamespace *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelNamespace_0006ce70;
  return;
}



// IOAccelNamespace::~IOAccelNamespace()

void __thiscall IOAccelNamespace::~IOAccelNamespace(IOAccelNamespace *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelNamespace::~IOAccelNamespace()

void __thiscall IOAccelNamespace::~IOAccelNamespace(IOAccelNamespace *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelNamespace::~IOAccelNamespace()

void __thiscall IOAccelNamespace::~IOAccelNamespace(IOAccelNamespace *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelNamespace_ktv,this,0x30);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelNamespace::operator delete(void*, unsigned long)

void __cdecl IOAccelNamespace::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelNamespace_ktv,param_1,param_2);
  return;
}



// IOAccelNamespace::getMetaClass() const

undefined ** IOAccelNamespace::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelNamespace::MetaClass::MetaClass()

void __thiscall IOAccelNamespace::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelNamespace",(OSMetaClass *)PTR_gMetaClass_0006b068,0x30);
  *(undefined ***)this = &PTR__MetaClass_0006cfa0;
  return;
}



// IOAccelNamespace::MetaClass::alloc() const

OSObject * IOAccelNamespace::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelNamespace_ktv,0x30);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelNamespace::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelNamespace_0006ce70;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelNamespace::operator new(unsigned long)

void * __thiscall IOAccelNamespace::operator_new(IOAccelNamespace *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelNamespace_ktv,this);
  return pvVar1;
}



// IOAccelNamespace::IOAccelNamespace()

void __thiscall IOAccelNamespace::IOAccelNamespace(IOAccelNamespace *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelNamespace_0006ce70;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelNamespace::IOAccelNamespace()

void __thiscall IOAccelNamespace::IOAccelNamespace(IOAccelNamespace *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelNamespace_0006ce70;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelNamespace::init()

undefined8 __thiscall IOAccelNamespace::init(IOAccelNamespace *this)

{
  ulong uVar1;
  uint local_14;
  
  *(undefined8 *)(this + 0x10) = 0;
  *(undefined8 *)(this + 0x20) = 0;
  *(undefined4 *)(this + 0x18) = 0;
  *(undefined4 *)(this + 0x28) = 0;
  alloc_handles(this);
  uVar1 = allocId(this,0,&local_14);
  return CONCAT71((int7)(uVar1 >> 8),1);
}



// IOAccelNamespace::alloc_handles()

undefined8 __thiscall IOAccelNamespace::alloc_handles(IOAccelNamespace *this)

{
  uint uVar1;
  void *pvVar2;
  void *pvVar3;
  undefined8 uVar4;
  long lVar5;
  ulong uVar6;
  undefined8 uVar7;
  size_t sVar8;
  
  uVar1 = *(uint *)(this + 0x18);
  if ((ulong)uVar1 == 0) {
    uVar6 = 0x400;
  }
  else {
    if (0x3fffff < uVar1) {
      return 0;
    }
    uVar6 = (ulong)(uVar1 * 2);
  }
  pvVar2 = *(void **)(this + 0x10);
  pvVar3 = *(void **)(this + 0x20);
  lVar5 = _IOMallocTypeVarImpl(&alloc_handles()::kalloc_type_view_71,uVar6 << 3);
  *(long *)(this + 0x10) = lVar5;
  if (lVar5 == 0) {
    uVar7 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"IONewZero failed to alloc Handles\n");
    *(void **)(this + 0x10) = pvVar2;
  }
  else {
    lVar5 = _IOMallocZeroData(uVar6 >> 3);
    *(long *)(this + 0x20) = lVar5;
    if (lVar5 == 0) {
      uVar7 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "IOMallocZeroData failed to alloc Handles Map\n");
      uVar4 = *(undefined8 *)(this + 0x10);
      *(undefined8 *)(this + 0x10) = 0;
      _IOFreeTypeVarImpl(&alloc_handles()::kalloc_type_view_83,uVar4,uVar6 << 3);
      *(void **)(this + 0x10) = pvVar2;
      *(void **)(this + 0x20) = pvVar3;
    }
    else {
      *(int *)(this + 0x18) = (int)uVar6;
      uVar7 = CONCAT71((int7)(uVar6 >> 8),1);
      if (pvVar2 != (void *)0x0) {
        sVar8 = (ulong)uVar1 << 3;
        _memmove(*(void **)(this + 0x10),pvVar2,sVar8);
        _memmove(*(void **)(this + 0x20),pvVar3,(ulong)(uVar1 >> 3));
        _IOFreeTypeVarImpl(&alloc_handles()::kalloc_type_view_96,pvVar2,sVar8);
        _IOFreeData(pvVar3,(ulong)(uVar1 >> 3));
      }
    }
  }
  return uVar7;
}



// IOAccelNamespace::allocId(void*, unsigned int*)

ulong __thiscall IOAccelNamespace::allocId(IOAccelNamespace *this,undefined8 param_1,uint *param_2)

{
  uint *puVar1;
  ulong uVar2;
  undefined8 uVar3;
  uint uVar4;
  int iVar5;
  ulong unaff_R12;
  undefined7 uVar6;
  uint uVar7;
  bool bVar8;
  
  uVar7 = *(uint *)(this + 0x28) >> 5;
  do {
    uVar4 = *(uint *)(this + 0x18) >> 5;
    if (uVar7 < uVar4) {
      uVar2 = (ulong)uVar7;
      uVar7 = *(uint *)(*(long *)(this + 0x20) + uVar2 * 4);
      uVar6 = (undefined7)(unaff_R12 >> 8);
      if (uVar7 != 0xffffffff) {
        bVar8 = true;
LAB_00004b60:
        unaff_R12 = CONCAT71(uVar6,bVar8);
        uVar4 = 0;
        goto LAB_00004b62;
      }
      while (uVar4 - 1 != (int)uVar2) {
        uVar7 = *(uint *)(*(long *)(this + 0x20) + 4 + uVar2 * 4);
        uVar2 = uVar2 + 1;
        if (uVar7 != 0xffffffff) {
          bVar8 = uVar2 < uVar4;
          goto LAB_00004b60;
        }
      }
      unaff_R12 = CONCAT71(uVar6,uVar2 + 1 < (ulong)uVar4);
      uVar7 = uVar4;
    }
    else {
      unaff_R12 = 0;
    }
    uVar3 = alloc_handles(this);
  } while ((char)uVar3 != '\0');
  goto LAB_00004b9d;
  while (uVar4 = uVar4 + 1, uVar4 != 0x20) {
LAB_00004b62:
    if ((uVar7 >> (uVar4 & 0x1f) & 1) == 0) goto LAB_00004b73;
  }
  uVar4 = 0x20;
LAB_00004b73:
  iVar5 = (int)uVar2 * 0x20;
  uVar7 = uVar4 + iVar5;
  *(uint *)(this + 0x28) = iVar5 + uVar4 + 1;
  *(undefined8 *)(*(long *)(this + 0x10) + (ulong)uVar7 * 8) = param_1;
  puVar1 = (uint *)(*(long *)(this + 0x20) + (uVar2 & 0xffffffff) * 4);
  *puVar1 = *puVar1 | 1 << ((byte)uVar4 & 0x1f);
  *param_2 = uVar7;
LAB_00004b9d:
  return unaff_R12 & 0xffffffff;
}



// IOAccelNamespace::free()

void __thiscall IOAccelNamespace::free(IOAccelNamespace *this)

{
  free_handles(this);
                    // WARNING: Could not recover jumptable at 0x00004bd2. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelNamespace::free_handles()

void __thiscall IOAccelNamespace::free_handles(IOAccelNamespace *this)

{
  undefined8 uVar1;
  
  uVar1 = *(undefined8 *)(this + 0x10);
  *(undefined8 *)(this + 0x10) = 0;
  _IOFreeTypeVarImpl(&free_handles()::kalloc_type_view_105,uVar1,(ulong)*(uint *)(this + 0x18) << 3)
  ;
  _IOFreeData(*(undefined8 *)(this + 0x20),*(uint *)(this + 0x18) >> 3);
  return;
}



// IOAccelNamespace::lookupId(unsigned int, void**) const

undefined8 __thiscall IOAccelNamespace::lookupId(IOAccelNamespace *this,uint param_1,long *param_2)

{
  long lVar1;
  undefined8 uVar2;
  
  if ((param_1 < *(uint *)(this + 0x18)) &&
     (lVar1 = *(long *)(*(long *)(this + 0x10) + (ulong)param_1 * 8), lVar1 != 0)) {
    *param_2 = lVar1;
    uVar2 = CONCAT71((int7)((ulong)lVar1 >> 8),1);
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



// IOAccelNamespace::invalidateId(void*, unsigned int)

void __thiscall IOAccelNamespace::invalidateId(IOAccelNamespace *this,long param_1,uint param_2)

{
  long lVar1;
  ulong uVar2;
  
  uVar2 = (ulong)param_2;
  if (param_2 < *(uint *)(this + 0x18)) {
    lVar1 = *(long *)(*(long *)(this + 0x10) + uVar2 * 8);
    if (lVar1 == param_1) {
      *(undefined8 *)(*(long *)(this + 0x10) + uVar2 * 8) = 0;
    }
    else {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "Entry for handle %d %p is not equal to %p\n",uVar2,lVar1,param_1);
    }
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "trying to invalidate apparently bogus handle %d\n");
  }
  return;
}



// IOAccelNamespace::resurrectId(unsigned int, void*)

void __thiscall IOAccelNamespace::resurrectId(IOAccelNamespace *this,uint param_1,long param_2)

{
  long lVar1;
  
  lVar1 = *(long *)(*(long *)(this + 0x10) + (ulong)param_1 * 8);
  if (lVar1 == param_2 || lVar1 == 0) {
    *(long *)(*(long *)(this + 0x10) + (ulong)param_1 * 8) = param_2;
  }
  return;
}



// IOAccelNamespace::freeId(unsigned int)

void __thiscall IOAccelNamespace::freeId(IOAccelNamespace *this,uint param_1)

{
  uint *puVar1;
  byte bVar2;
  
  if (param_1 < *(uint *)(this + 0x18)) {
    if (param_1 < *(uint *)(this + 0x28)) {
      *(uint *)(this + 0x28) = param_1;
    }
    *(undefined8 *)(*(long *)(this + 0x10) + (ulong)param_1 * 8) = 0;
    bVar2 = (byte)param_1 & 0x1f;
    puVar1 = (uint *)(*(long *)(this + 0x20) + (ulong)(param_1 >> 5) * 4);
    *puVar1 = *puVar1 & (-2 << bVar2 | 0xfffffffeU >> 0x20 - bVar2);
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "trying to free apparently bogus texture handle %d\n");
  }
  return;
}



// IOAccelNamespace::MetaClass::~MetaClass()

void __thiscall IOAccelNamespace::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



void __GLOBAL__sub_I_IOAccelNamespace_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelNamespace::gMetaClass,"IOAccelNamespace",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x30);
  IOAccelNamespace::gMetaClass = (undefined *)&PTR__MetaClass_0006cfa0;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelNamespace::gMetaClass);
  return;
}



// IOAccelChannel2::MetaClass::MetaClass()

void __thiscall IOAccelChannel2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelChannel2",(OSMetaClass *)PTR_gMetaClass_0006b068,0x70);
  *(undefined ***)this = &PTR__MetaClass_0006d250;
  return;
}



// IOAccelChannel2::MetaClass::~MetaClass()

void __thiscall IOAccelChannel2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelChannel2::IOAccelChannel2(OSMetaClass const*)

void __thiscall IOAccelChannel2::IOAccelChannel2(IOAccelChannel2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelChannel2_0006d098;
  return;
}



// IOAccelChannel2::~IOAccelChannel2()

void __thiscall IOAccelChannel2::~IOAccelChannel2(IOAccelChannel2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelChannel2::~IOAccelChannel2()

void __thiscall IOAccelChannel2::~IOAccelChannel2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelChannel2::~IOAccelChannel2()

void __thiscall IOAccelChannel2::~IOAccelChannel2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelChannel2::getMetaClass() const

undefined ** IOAccelChannel2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelChannel2::MetaClass::MetaClass()

void __thiscall IOAccelChannel2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelChannel2",(OSMetaClass *)PTR_gMetaClass_0006b068,0x70);
  *(undefined ***)this = &PTR__MetaClass_0006d250;
  return;
}



// IOAccelChannel2::MetaClass::alloc() const

undefined8 IOAccelChannel2::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelChannel2::operator new(unsigned long)

void * __thiscall IOAccelChannel2::operator_new(IOAccelChannel2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelChannel2_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelChannel2::operator delete(void*, unsigned long)

void __cdecl IOAccelChannel2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelChannel2_ktv,param_1,param_2);
  return;
}



// IOAccelChannel2::init(IOGraphicsAccelerator2*, int)

undefined8 __thiscall IOAccelChannel2::init(IOAccelChannel2 *this,long param_1,undefined4 param_2)

{
  char cVar1;
  undefined8 uVar2;
  
  if ((param_1 != 0) && (cVar1 = (**(code **)(PTR_vtable_0006b0a0 + 0x98))(), cVar1 != '\0')) {
    *(long *)(this + 0x18) = param_1;
    *(undefined4 *)(this + 0x20) = param_2;
    uVar2 = _OSAddAtomic64(1,&___globalObjectIDCounter);
    *(undefined8 *)(this + 0x28) = uVar2;
    *(undefined8 *)(this + 0x10) = 0;
    uVar2 = IOAccelChannelList::addChannel
                      ((IOAccelChannelList *)(*(long *)(this + 0x18) + 0xc38),(long)this);
    return CONCAT71((int7)((ulong)uVar2 >> 8),1);
  }
  return 0;
}



// IOAccelChannel2::free()

void __thiscall IOAccelChannel2::free(IOAccelChannel2 *this)

{
  char *pcVar1;
  size_t sVar2;
  
  if (*(long *)(this + 0x18) != 0) {
    IOAccelChannelList::removeChannel
              ((IOAccelChannelList *)(*(long *)(this + 0x18) + 0xc38),(long)this);
  }
  pcVar1 = *(char **)(this + 0x68);
  if (pcVar1 != (char *)0x0) {
    sVar2 = _strnlen(pcVar1,0x400);
    _IOFreeData(pcVar1,sVar2 + 1);
    *(undefined8 *)(this + 0x68) = 0;
  }
                    // WARNING: Could not recover jumptable at 0x00004f3a. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelChannel2::setStampIndex(int)

void __thiscall IOAccelChannel2::setStampIndex(IOAccelChannel2 *this,undefined4 param_1)

{
  *(undefined4 *)(this + 0x20) = param_1;
  return;
}



// IOAccelChannel2::mergeEventExcluding(IOAccelEvent*, IOAccelEvent*)

void __thiscall
IOAccelChannel2::mergeEventExcluding(IOAccelChannel2 *this,undefined8 param_1,undefined8 param_2)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = *(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1c8);
                    // WARNING: Could not recover jumptable at 0x00004f6a. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)
            (*(long **)(*(long *)(this + 0x18) + 0x380),param_1,param_2,*(undefined4 *)(this + 0x20)
             ,UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelChannel2::setEventStamp(IOAccelEvent*)

void __thiscall IOAccelChannel2::setEventStamp(IOAccelChannel2 *this,undefined8 param_1)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = *(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1d0);
                    // WARNING: Could not recover jumptable at 0x00004f91. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)
            (*(long **)(*(long *)(this + 0x18) + 0x380),*(undefined4 *)(this + 0x20),param_1,
             UNRECOVERED_JUMPTABLE);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelChannel2::incrementStamp()

void __cdecl IOAccelChannel2::incrementStamp(long param_1,undefined8 param_2,undefined8 param_3)

{
  long *plVar1;
  code *UNRECOVERED_JUMPTABLE;
  
  plVar1 = *(long **)(*(long *)(param_1 + 0x18) + 0x380);
  UNRECOVERED_JUMPTABLE = *(code **)(*plVar1 + 0x1d8);
                    // WARNING: Could not recover jumptable at 0x00004fb4. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)(plVar1,*(undefined4 *)(param_1 + 0x20),param_3,UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelChannel2::writeStampCommand(IOAccelEventQueue*, vendevtCommandRec*)

void __thiscall
IOAccelChannel2::writeStampCommand(IOAccelChannel2 *this,undefined8 param_1,undefined8 param_2)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = *(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1e0);
                    // WARNING: Could not recover jumptable at 0x00004fdc. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)
            (*(long **)(*(long *)(this + 0x18) + 0x380),*(undefined4 *)(this + 0x20),param_1,param_2
             ,UNRECOVERED_JUMPTABLE);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelChannel2::writeEventBarrierCommand(IOAccelEventQueue*, IOAccelEvent*, vendevtBarrierRec*)

void __cdecl IOAccelChannel2::writeEventBarrierCommand(long param_1)

{
  long *plVar1;
  
  plVar1 = *(long **)(*(long *)(param_1 + 0x18) + 0x380);
                    // WARNING: Could not recover jumptable at 0x00005001. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*plVar1 + 0x1f0))(plVar1);
  return;
}



// IOAccelChannel2::willSubmitCommands(unsigned long long)

uintptr_t __thiscall IOAccelChannel2::willSubmitCommands(IOAccelChannel2 *this,uintptr_t param_1)

{
  uintptr_t arg1;
  uintptr_t arg2;
  uintptr_t arg4;
  
  arg2 = _OSAddAtomic64(1,&___globalObjectIDCounter);
  arg1 = *(uintptr_t *)(this + 0x28);
  arg4 = IORegistryEntry::getRegistryEntryID();
  _kernel_debug(0x8502007c,arg1,arg2,param_1,arg4,0);
  return arg2;
}



// IOAccelChannel2::getChannelLabel() const

char * __thiscall IOAccelChannel2::getChannelLabel(IOAccelChannel2 *this)

{
  int iVar1;
  char *pcVar2;
  char *param3;
  
  pcVar2 = *(char **)(this + 0x68);
  if (pcVar2 == (char *)0x0) {
    pcVar2 = (char *)_IOMallocData(0x400);
    *(char **)(this + 0x68) = pcVar2;
    if (pcVar2 == (char *)0x0) {
      pcVar2 = (char *)0x0;
    }
    else {
      if (*(long **)(*(long *)(this + 0x18) + 0x370) == (long *)0x0) {
        param3 = "Undefined";
      }
      else {
        param3 = (char *)(**(code **)(**(long **)(*(long *)(this + 0x18) + 0x370) + 0x148))();
      }
      iVar1 = _snprintf(pcVar2,0x400,"%s idx%d",param3,*(int *)(this + 0x20));
      if (iVar1 < 0x3ff) {
        pcVar2 = (char *)_IOMallocData((long)(iVar1 + 1));
        _strlcpy(pcVar2,*(char **)(this + 0x68),(long)(iVar1 + 1));
        _IOFreeData(*(undefined8 *)(this + 0x68),0x400);
        *(char **)(this + 0x68) = pcVar2;
      }
      else {
        pcVar2 = *(char **)(this + 0x68);
      }
    }
  }
  return pcVar2;
}



// IOGraphicsAccelerator2::getModelName() const

char * __thiscall IOGraphicsAccelerator2::getModelName(IOGraphicsAccelerator2 *this)

{
  char *pcVar1;
  
  if (*(long **)(this + 0x370) != (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00005134. Too many branches
                    // WARNING: Treating indirect jump as call
    pcVar1 = (char *)(**(code **)(**(long **)(this + 0x370) + 0x148))();
    return pcVar1;
  }
  return "Undefined";
}



// IOAccelChannel2::triage(char**, unsigned long long*)

undefined8 IOAccelChannel2::triage(void)

{
  return 0;
}



// IOAccelChannel2::_RESERVEDIOAccelChannel2()

void IOAccelChannel2::_RESERVEDIOAccelChannel2(void)

{
  OSMetaClass::reservedCalled(0x81f80);
  return;
}



// IOAccelChannel2::_RESERVEDIOAccelChannel3()

void IOAccelChannel2::_RESERVEDIOAccelChannel3(void)

{
  OSMetaClass::reservedCalled(0x81f80);
  return;
}



// IOAccelChannel2::_RESERVEDIOAccelChannel4()

void IOAccelChannel2::_RESERVEDIOAccelChannel4(void)

{
  OSMetaClass::reservedCalled(0x81f80);
  return;
}



// IOAccelChannel2::_RESERVEDIOAccelChannel5()

void IOAccelChannel2::_RESERVEDIOAccelChannel5(void)

{
  OSMetaClass::reservedCalled(0x81f80);
  return;
}



// IOAccelFIFOChannel2::MetaClass::MetaClass()

void __thiscall IOAccelFIFOChannel2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelFIFOChannel2",(OSMetaClass *)&IOAccelChannel2::gMetaClass,
             0xe8);
  *(undefined ***)this = &PTR__MetaClass_0006d570;
  return;
}



// IOAccelFIFOChannel2::MetaClass::~MetaClass()

void __thiscall IOAccelFIFOChannel2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelFIFOChannel2::IOAccelFIFOChannel2(OSMetaClass const*)

void __thiscall
IOAccelFIFOChannel2::IOAccelFIFOChannel2(IOAccelFIFOChannel2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelFIFOChannel2_0006d348;
  return;
}



// IOAccelFIFOChannel2::~IOAccelFIFOChannel2()

void __thiscall IOAccelFIFOChannel2::~IOAccelFIFOChannel2(IOAccelFIFOChannel2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelFIFOChannel2::~IOAccelFIFOChannel2()

void __thiscall IOAccelFIFOChannel2::~IOAccelFIFOChannel2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelFIFOChannel2::~IOAccelFIFOChannel2()

void __thiscall IOAccelFIFOChannel2::~IOAccelFIFOChannel2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelFIFOChannel2::getMetaClass() const

undefined ** IOAccelFIFOChannel2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelFIFOChannel2::MetaClass::MetaClass()

void __thiscall IOAccelFIFOChannel2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelFIFOChannel2",(OSMetaClass *)&IOAccelChannel2::gMetaClass,
             0xe8);
  *(undefined ***)this = &PTR__MetaClass_0006d570;
  return;
}



// IOAccelFIFOChannel2::MetaClass::alloc() const

undefined8 IOAccelFIFOChannel2::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelFIFOChannel2::operator new(unsigned long)

void * __thiscall IOAccelFIFOChannel2::operator_new(IOAccelFIFOChannel2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelFIFOChannel2_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelFIFOChannel2::operator delete(void*, unsigned long)

void __cdecl IOAccelFIFOChannel2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelFIFOChannel2_ktv,param_1,param_2);
  return;
}



// IOAccelFIFOChannel2::init(IOGraphicsAccelerator2*, int, int, int, int)

undefined8 __thiscall
IOAccelFIFOChannel2::init
          (IOAccelFIFOChannel2 *this,long param_1,undefined4 param_2,int param_3,uint param_4,
          int param_5)

{
  undefined8 uVar1;
  long lVar2;
  ulong uVar3;
  ulong uVar4;
  
  uVar1 = IOAccelChannel2::init((IOAccelChannel2 *)this,param_1,param_2);
  if ((char)uVar1 == '\0') {
LAB_00005370:
    uVar1 = 0;
  }
  else {
    *(undefined8 *)(this + 0x70) = 1;
    *(int *)(this + 0x88) = param_3;
    *(uint *)(this + 0x8c) = param_4;
    uVar4 = (ulong)param_5;
    *(ulong *)(this + 0x90) = uVar4;
    if (param_5 == 0) {
      uVar4 = 0;
      *(undefined8 *)(this + 0x98) = 0;
      *(undefined8 *)(this + 0x78) = 0;
      *(undefined8 *)(this + 0x80) = 0;
      *(undefined8 *)(this + 0xa0) = 0;
    }
    else {
      if (param_3 == 0) {
        return 0;
      }
      if (param_4 < 0x90) {
        return 0;
      }
      lVar2 = _IOMalloc(uVar4);
      *(long *)(this + 0x98) = lVar2;
      if (lVar2 == 0) goto LAB_00005370;
      if (uVar4 < *(ulong *)(this + 0x90)) {
        init();
        return 0;
      }
      ___bzero(lVar2);
      uVar3 = *(ulong *)(this + 0x98);
      *(ulong *)(this + 0x78) = uVar3;
      *(ulong *)(this + 0x80) = uVar3;
      *(ulong *)(this + 0xa0) = (uint)(*(int *)(this + 0x88) * *(int *)(this + 0x8c)) + uVar3;
      do {
        (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x140))
                  (*(long **)(*(long *)(this + 0x18) + 0x380),uVar3 + 0x30);
        uVar4 = (ulong)*(uint *)(this + 0x8c);
        uVar3 = uVar3 + uVar4;
      } while (uVar3 < *(ulong *)(this + 0xa0));
    }
    uVar1 = CONCAT71((int7)(uVar4 >> 8),1);
  }
  return uVar1;
}



void ___ZN19IOAccelFIFOChannel24initEP22IOGraphicsAccelerator2iii(long param_1)

{
  char cVar1;
  byte bVar2;
  long lVar3;
  code *pcVar4;
  OSMetaClassBase *pOVar5;
  long *plVar6;
  uint uVar7;
  char local_48 [48];
  long local_18;
  
  local_18 = *(long *)PTR____stack_chk_guard_0006b0b0;
  builtin_strncpy(local_48,"4@>]2AA=6]AC:G2E6]9:5]4=:6?E]6G6?E\\>@?:E@C",0x2b);
  lVar3 = 0;
  do {
    cVar1 = local_48[lVar3];
    uVar7 = ((uint)((cVar1 + 0xe) * -0x51b3) >> 0x10) + (int)cVar1 + 0xe & 0xffff;
    local_48[lVar3] = cVar1 + ((char)(uVar7 >> 6) + (char)(uVar7 >> 0xf)) * -0x5e + '/';
    lVar3 = lVar3 + 1;
  } while (lVar3 != 0x2a);
  if (*(char *)(param_1 + 0x98) == '\0') {
    pcVar4 = (code *)_ZN15IOAccelChannel210gMetaClassF;
    if (((ulong)_ZN15IOAccelChannel210gMetaClassF & 1) != 0) {
      pcVar4 = *(code **)(_ZN15IOAccelChannel210gMetaClassF + *(long *)(DAT_00081ea0 + param_1) + -1
                         );
    }
    plVar6 = (long *)(*pcVar4)();
    *(long **)(param_1 + 0x90) = plVar6;
    *(undefined1 *)(param_1 + 0x98) = 1;
  }
  else {
    plVar6 = *(long **)(param_1 + 0x90);
  }
  if (plVar6 != (long *)0x0) {
    pOVar5 = (OSMetaClassBase *)(**(code **)(*plVar6 + 0x208))(plVar6,local_48);
    if (pOVar5 != (OSMetaClassBase *)0x0) {
      plVar6 = (long *)OSMetaClassBase::safeMetaCast(pOVar5,*(OSMetaClass **)PTR_metaClass_0006b080)
      ;
      if (plVar6 != (long *)0x0) {
        bVar2 = (**(code **)(*plVar6 + 0x128))(plVar6);
        goto LAB_000054cb;
      }
    }
  }
  bVar2 = 0;
LAB_000054cb:
  *(byte *)(param_1 + 0x28) =
       *(byte *)(param_1 + 0x28) & 0xfd | ((*(byte *)(param_1 + 0x28) & 2) >> 1 & bVar2) * '\x02';
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_18) {
    return;
  }
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// IOAccelFIFOChannel2::free()

void __thiscall IOAccelFIFOChannel2::free(IOAccelFIFOChannel2 *this)

{
  if (*(long *)(this + 0x98) != 0) {
    (**(code **)(*(long *)this + 0x1a8))(this);
    _IOFree(*(undefined8 *)(this + 0x98),*(undefined8 *)(this + 0x90));
    *(undefined8 *)(this + 0x98) = 0;
  }
  IOAccelChannel2::free((IOAccelChannel2 *)this);
  return;
}



// IOAccelFIFOChannel2::finishChannel()

void __thiscall IOAccelFIFOChannel2::finishChannel(IOAccelFIFOChannel2 *this)

{
  long lVar1;
  
  if ((*(long *)(this + 0x18) != 0) && (lVar1 = *(long *)(this + 0x80), lVar1 != 0)) {
    *(long *)(this + 0x78) = lVar1;
    do {
      (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x188))
                (*(long **)(*(long *)(this + 0x18) + 0x380),lVar1 + 0x30);
      lVar1 = (ulong)*(uint *)(this + 0x8c) + *(long *)(this + 0x78);
      *(long *)(this + 0x78) = lVar1;
      if (*(long *)(this + 0xa0) == lVar1) {
        lVar1 = *(long *)(this + 0x98);
        *(long *)(this + 0x78) = lVar1;
      }
    } while (lVar1 != *(long *)(this + 0x80));
  }
  return;
}



// IOAccelFIFOChannel2::Iterator::Iterator(IOAccelFIFOChannel2&)

void __thiscall IOAccelFIFOChannel2::Iterator::Iterator(Iterator *this,long *param_1)

{
  Iterator IVar1;
  
  *(long **)this = param_1;
  this[0x10] = (Iterator)0x1;
  IVar1 = (Iterator)(**(code **)(*param_1 + 0x1b8))(param_1);
  this[0x11] = IVar1;
  *(long *)(this + 8) = param_1[0xf];
  return;
}



// IOAccelFIFOChannel2::Iterator::Iterator(IOAccelFIFOChannel2&)

void __thiscall IOAccelFIFOChannel2::Iterator::Iterator(Iterator *this,long *param_1)

{
  Iterator IVar1;
  
  *(long **)this = param_1;
  this[0x10] = (Iterator)0x1;
  IVar1 = (Iterator)(**(code **)(*param_1 + 0x1b8))(param_1);
  this[0x11] = IVar1;
  *(long *)(this + 8) = param_1[0xf];
  return;
}



// IOAccelFIFOChannel2::Iterator::getNextRingEntry()

long __thiscall IOAccelFIFOChannel2::Iterator::getNextRingEntry(Iterator *this)

{
  long lVar1;
  long lVar2;
  long lVar3;
  
  lVar1 = *(long *)this;
  lVar2 = *(long *)(this + 8);
  if ((lVar2 == *(long *)(lVar1 + 0x80)) &&
     ((this[0x10] == (Iterator)0x0 || (this[0x11] != (Iterator)0x0)))) {
    lVar2 = 0;
  }
  else {
    this[0x10] = (Iterator)0x0;
    lVar3 = (ulong)*(uint *)(lVar1 + 0x8c) + lVar2;
    *(long *)(this + 8) = lVar3;
    if (*(long *)(lVar1 + 0xa0) == lVar3) {
      *(undefined8 *)(this + 8) = *(undefined8 *)(lVar1 + 0x98);
    }
  }
  return lVar2;
}



// IOAccelFIFOChannel2::logRingBuffer()

void __thiscall IOAccelFIFOChannel2::logRingBuffer(IOAccelFIFOChannel2 *this)

{
  undefined8 *param1;
  
  _kprintf("%s enter: fRingBuffer=%p, fRingEnd=%p, fRingEntryBytes=%d, fRingHead=%p, fRingTail=%p.\n"
           ,"virtual void IOAccelFIFOChannel2::logRingBuffer()",*(void **)(this + 0x98),
           *(void **)(this + 0xa0),*(int *)(this + 0x8c),*(void **)(this + 0x78),
           *(void **)(this + 0x80));
  param1 = *(undefined8 **)(this + 0x80);
  do {
    _kprintf("\tentry=%p, ctx=%p, gputask=%p, stamp_idx=%d, stamp=%d, word_count=%d\n",param1,
             (void *)*param1,(void *)param1[1],*(int *)(param1 + 5),*(int *)((long)param1 + 0x2c),
             *(int *)(param1 + 3));
    param1 = (undefined8 *)((ulong)*(uint *)(this + 0x8c) + (long)param1);
    if (*(undefined8 **)(this + 0xa0) == param1) {
      param1 = *(undefined8 **)(this + 0x98);
    }
  } while (param1 != *(undefined8 **)(this + 0x80));
  _kprintf("%s exit\n","virtual void IOAccelFIFOChannel2::logRingBuffer()");
  return;
}



// IOAccelFIFOChannel2::pruneRingBuffer()

void __thiscall IOAccelFIFOChannel2::pruneRingBuffer(IOAccelFIFOChannel2 *this)

{
  char cVar1;
  long lVar2;
  
  lVar2 = *(long *)(this + 0x80);
  *(long *)(this + 0x78) = lVar2;
  do {
    cVar1 = (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 400))
                      (*(long **)(*(long *)(this + 0x18) + 0x380),lVar2 + 0x30);
    if (cVar1 == '\0') {
      return;
    }
    lVar2 = (ulong)*(uint *)(this + 0x8c) + *(long *)(this + 0x78);
    *(long *)(this + 0x78) = lVar2;
    if (*(long *)(this + 0xa0) == lVar2) {
      lVar2 = *(long *)(this + 0x98);
      *(long *)(this + 0x78) = lVar2;
    }
  } while (lVar2 != *(long *)(this + 0x80));
  return;
}



// IOAccelFIFOChannel2::waitForRingBufferSpace()

void __thiscall IOAccelFIFOChannel2::waitForRingBufferSpace(IOAccelFIFOChannel2 *this)

{
                    // WARNING: Could not recover jumptable at 0x000057a7. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x188))
            (*(long **)(*(long *)(this + 0x18) + 0x380),*(long *)(this + 0x80) + 0x30);
  return;
}



// IOAccelFIFOChannel2::restart()

void __thiscall IOAccelFIFOChannel2::restart(IOAccelFIFOChannel2 *this)

{
  IOAccelFIFOChannel2 *pIVar1;
  long *plVar2;
  long *plVar3;
  char cVar4;
  char *pcVar5;
  long lVar6;
  char *pcVar7;
  uint uVar8;
  long lVar9;
  long *plVar10;
  OSMetaClassBase *pOVar11;
  undefined8 uVar12;
  long lVar13;
  
  cVar4 = (**(code **)(*(long *)this + 0x1b8))();
  if (cVar4 == '\0') {
    pOVar11 = (OSMetaClassBase *)**(undefined8 **)(this + 0x78);
    uVar12 = (*(undefined8 **)(this + 0x78))[0xf];
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: ring is empty and all finished. Nothing to do.\n\n");
    if ((*(long *)(this + 0x70) != 0) && (-1 < *(int *)(*(long *)(this + 0x18) + 0xc90))) {
      _kernel_debug(0x85020098,(long)*(int *)(this + 0x20),0xffffffffffffffff,0,0,0);
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: GPURestartSkipped stampIdx=%d\n",
                        "virtual void IOAccelFIFOChannel2::restart()",*(undefined4 *)(this + 0x20));
      return;
    }
    uVar12 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: FIFOChannel[%d] indicates empty/idle - Forcing restart (fSubmitsSinceRestart=%llu)\n"
                      ,"virtual void IOAccelFIFOChannel2::restart()",*(undefined4 *)(this + 0x20),
                      *(long *)(this + 0x70));
    pOVar11 = (OSMetaClassBase *)0x0;
  }
  pcVar5 = (char *)(**(code **)(*(long *)this + 0x208))(this);
  if ((pcVar5 != (char *)0x0) && (lVar6 = _IOMallocData(0xffff), lVar6 != 0)) {
    *(undefined1 *)(lVar6 + 0xfffe) = 0;
    _IOLog("GPU hang: ");
    cVar4 = *pcVar5;
    if (cVar4 != '\0') {
      lVar13 = 0;
      lVar9 = 0;
      do {
        while( true ) {
          *(char *)(lVar6 + lVar9) = cVar4;
          lVar9 = lVar9 + 1;
          if (lVar9 == 0xfffe) break;
          cVar4 = pcVar5[lVar13 + 1];
          lVar13 = lVar13 + 1;
          if (cVar4 == '\0') {
            if (lVar9 != 0) {
              *(undefined1 *)(lVar6 + lVar9) = 0;
              _IOLog("%s",lVar6);
            }
            goto LAB_0000595b;
          }
        }
        _IOLog("%s",lVar6);
        cVar4 = pcVar5[lVar13 + 1];
        lVar13 = lVar13 + 1;
        lVar9 = 0;
      } while (cVar4 != '\0');
    }
LAB_0000595b:
    _IOLog("\n");
    _IOFreeData(lVar6,0xffff);
  }
  pIVar1 = this + 0x18;
  if (*(long **)(*(long *)(this + 0x18) + 0x370) == (long *)0x0) {
    pcVar7 = "Undefined";
  }
  else {
    pcVar7 = (char *)(**(code **)(**(long **)(*(long *)(this + 0x18) + 0x370) + 0x148))();
  }
  _IOLog("Trying to restart GPU (%s)...\n",pcVar7);
  uVar8 = *(int *)(*(long *)(*(IOGraphicsAccelerator2 **)pIVar1 + 0x380) + 0x94) - 2U < 3 ^ 3;
  IOGraphicsAccelerator2::reportGPURestart
            (*(IOGraphicsAccelerator2 **)pIVar1,(long *)pOVar11,pcVar5,uVar8,uVar12);
  if ((*(byte *)(*(long *)pIVar1 + 0xc9c) & 2) != 0) {
    restart((long *)this,(undefined8 *)pIVar1);
    return;
  }
  if (*(long *)(*(long *)(this + 0x78) + 0x70) == 0) {
    if (pOVar11 == (OSMetaClassBase *)0x0) goto LAB_00005ac0;
    lVar6 = OSMetaClassBase::safeMetaCast(pOVar11,(OSMetaClass *)&IOAccelCommandQueue::gMetaClass);
    if (lVar6 == 0) {
      (**(code **)(*(long *)pOVar11 + 0x978))(pOVar11,1,uVar8);
    }
    else {
      IOAccelFenceMachine::guiltyForHardwareReset
                (*(IOAccelFenceMachine **)(*(long *)pIVar1 + 0x390),lVar6,uVar8);
    }
  }
  else {
    IOAccelFenceMachine::setErrorOnEventFenceWithID
              (*(IOAccelFenceMachine **)(*(long *)pIVar1 + 0x390),(long)pOVar11,
               *(long *)(*(long *)(this + 0x78) + 0x70),uVar8);
    lVar6 = OSMetaClassBase::safeMetaCast(pOVar11,(OSMetaClass *)&IOAccelCommandQueue::gMetaClass);
    if (lVar6 != 0) {
      *(undefined1 *)(lVar6 + 0x595) = 1;
    }
    if (pOVar11 == (OSMetaClassBase *)0x0) goto LAB_00005ac0;
  }
  plVar10 = *(long **)(this + 0x78);
  plVar2 = *(long **)(this + 0x80);
  uVar8 = *(uint *)(this + 0x8c);
  plVar3 = *(long **)(this + 0xa0);
  do {
    if ((OSMetaClassBase *)*plVar10 == pOVar11) {
      *(undefined4 *)(plVar10 + 3) = 0;
    }
    plVar10 = (long *)((long)plVar10 + (ulong)uVar8);
    if (plVar3 == plVar10) {
      plVar10 = *(long **)(this + 0x98);
    }
  } while (plVar10 != plVar2);
LAB_00005ac0:
  (**(code **)(*(long *)this + 0x200))(this);
  *(undefined8 *)(this + 0x70) = 0;
  return;
}



// IOAccelFIFOChannel2::submitterDestroyed(IOAccelSubmitter2*)

void __thiscall IOAccelFIFOChannel2::submitterDestroyed(IOAccelFIFOChannel2 *this,long param_1)

{
  uint uVar1;
  long *plVar2;
  long *plVar3;
  
  plVar3 = *(long **)(this + 0x98);
  uVar1 = *(uint *)(this + 0x8c);
  plVar2 = *(long **)(this + 0xa0);
  do {
    if (*plVar3 == param_1) {
      *plVar3 = 0;
    }
    plVar3 = (long *)((long)plVar3 + (ulong)uVar1);
  } while (plVar3 < plVar2);
  return;
}



// IOAccelFIFOChannel2::submitCommands(IOAccelCommandDescriptor*)

void __thiscall IOAccelFIFOChannel2::submitCommands(IOAccelFIFOChannel2 *this,long param_1)

{
  uintptr_t uVar1;
  undefined8 *puVar2;
  long lVar3;
  char cVar4;
  undefined4 uVar5;
  uintptr_t uVar6;
  uintptr_t uVar7;
  long lVar8;
  uintptr_t arg3;
  
  if (___ktrace_kernel_enabled == 0) {
    arg3 = 0;
  }
  else {
    arg3 = *(uintptr_t *)(param_1 + 0x48);
    uVar6 = _OSAddAtomic64(1,&___globalObjectIDCounter);
    *(uintptr_t *)(param_1 + 0x40) = uVar6;
    if (*(long *)(param_1 + 0x10) != 0) {
      arg3 = *(uintptr_t *)(*(long *)(param_1 + 0x10) + 0x4d8);
    }
    if (___ktrace_kernel_enabled != 0) {
      uVar1 = *(uintptr_t *)(this + 0x28);
      uVar7 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x85120004,uVar1,uVar6,arg3,uVar7,0);
    }
  }
  (**(code **)(*(long *)this + 0x1c0))(this);
  if (*(long **)(param_1 + 0x10) != (long *)0x0) {
    cVar4 = (**(code **)(**(long **)(param_1 + 0x10) + 0x988))();
    if (cVar4 != '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: dropping ctx=%p commands on floor. Forcing word_count to zero\n",
                        "virtual void IOAccelFIFOChannel2::submitCommands(IOAccelCommandDescriptor *)"
                       );
      *(undefined4 *)(param_1 + 0x30) = 0;
    }
  }
  puVar2 = *(undefined8 **)(this + 0x80);
  *puVar2 = *(undefined8 *)(param_1 + 0x10);
  puVar2[1] = *(undefined8 *)(param_1 + 8);
  puVar2[4] = *(undefined8 *)(param_1 + 0x18);
  *(undefined4 *)(puVar2 + 3) = *(undefined4 *)(param_1 + 0x30);
  *(undefined4 *)(puVar2 + 5) = *(undefined4 *)(this + 0x20);
  uVar5 = (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x208))();
  lVar8 = *(long *)(this + 0x80);
  *(undefined4 *)(lVar8 + 0x2c) = uVar5;
  *(undefined8 *)(lVar8 + 0x70) = *(undefined8 *)(param_1 + 0x38);
  *(undefined8 *)(lVar8 + 0x78) = *(undefined8 *)(param_1 + 0x40);
  (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1d0))
            (*(long **)(*(long *)(this + 0x18) + 0x380),*(undefined4 *)(this + 0x20),lVar8 + 0x30);
  (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1f8))
            (*(long **)(*(long *)(this + 0x18) + 0x380),*(undefined4 *)(this + 0x20));
  uVar6 = *(uintptr_t *)(this + 0x28);
  uVar1 = *(uintptr_t *)(param_1 + 0x40);
  uVar7 = IORegistryEntry::getRegistryEntryID();
  _kernel_debug(0x8502007c,uVar6,uVar1,arg3,uVar7,0);
  (**(code **)(*(long *)this + 0x1f8))(this,param_1);
  if ((*(byte *)(*(long *)(this + 0x18) + 0xc92) & 8) != 0) {
    IOAccelEventMachine2::startHardwareProgressTimer
              (*(IOAccelEventMachine2 **)(*(long *)(this + 0x18) + 0x380));
  }
  *(long *)(this + 0x70) = *(long *)(this + 0x70) + 1;
  lVar8 = (ulong)*(uint *)(this + 0x8c) + *(long *)(this + 0x80);
  *(long *)(this + 0x80) = lVar8;
  if (*(long *)(this + 0xa0) == lVar8) {
    lVar8 = *(long *)(this + 0x98);
    *(long *)(this + 0x80) = lVar8;
  }
  if ((___ktrace_kernel_enabled != 0) && (lVar3 = *(long *)(param_1 + 0x10), lVar3 != 0)) {
    _kernel_debug(0x85120014,(long)*(int *)(this + 0x20),(ulong)*(uint *)(lVar8 + 0x2c),
                  *(uintptr_t *)(lVar3 + 0x4d8),*(uintptr_t *)(lVar3 + 0x4e0),0);
    return;
  }
  return;
}



// IOAccelFIFOChannel2::getFirstPendingEvent()

long __thiscall IOAccelFIFOChannel2::getFirstPendingEvent(IOAccelFIFOChannel2 *this)

{
  char cVar1;
  long lVar2;
  
  cVar1 = (**(code **)(*(long *)this + 0x1b8))();
  if (cVar1 == '\0') {
    lVar2 = *(long *)(this + 0x78) + 0x30;
  }
  else {
    lVar2 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: All are finished\n",
                      "virtual sIOAccelEvent *IOAccelFIFOChannel2::getFirstPendingEvent()");
  }
  return lVar2;
}



// IOAccelFIFOChannel2::writeStampCommand(IOAccelEventQueue*, vendevtCommandRec*)

void __thiscall
IOAccelFIFOChannel2::writeStampCommand
          (IOAccelFIFOChannel2 *this,undefined8 param_1,undefined8 param_2)

{
  (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1e0))
            (*(long **)(*(long *)(this + 0x18) + 0x380),*(undefined4 *)(this + 0x20),param_1,param_2
            );
  *(long *)(this + 0x70) = *(long *)(this + 0x70) + 1;
  return;
}



// IOAccelFIFOChannel2::triage(char**, unsigned long long*)

ulong __thiscall
IOAccelFIFOChannel2::triage
          (undefined8 param_1_00,undefined8 param_2_00,undefined8 param_3,undefined8 param_4,
          undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8,
          IOAccelFIFOChannel2 *this,long *param_10,size_t *param_11,undefined8 param_12,
          undefined8 param_13,undefined8 param_14)

{
  char cVar1;
  uint uVar2;
  char *pcVar3;
  ulong uVar4;
  void *pvVar5;
  long lVar6;
  undefined8 uVar7;
  char *pcVar8;
  undefined8 *puVar9;
  ulong uVar10;
  ulong uVar11;
  undefined8 extraout_XMM0_Qa;
  undefined8 extraout_XMM0_Qa_00;
  undefined8 extraout_XMM0_Qa_01;
  undefined8 extraout_XMM0_Qa_02;
  undefined8 extraout_XMM0_Qa_03;
  undefined8 extraout_XMM0_Qa_04;
  undefined8 extraout_XMM0_Qa_05;
  undefined8 extraout_XMM0_Qa_06;
  
  pcVar3 = (char *)(**(code **)(*(long *)this + 0x170))();
  pcVar8 = "N/A";
  if (pcVar3 != (char *)0x0) {
    pcVar8 = pcVar3;
  }
  cVar1 = (**(code **)(*(long *)this + 0x1b8))(this);
  if ((cVar1 == '\0') && (puVar9 = *(undefined8 **)(this + 0x78), puVar9 != (undefined8 *)0x0)) {
    uVar10 = (ulong)*(uint *)((long)puVar9 + 0x2c);
    uVar11 = (ulong)*(uint *)((long)puVar9 + 0x2c);
    uVar4 = glkBfLog(extraout_XMM0_Qa,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,
                     param_10,param_11,"%12s is processing stamp %d [0x%x] ",pcVar8,uVar10,uVar11);
    if ((int)uVar4 != 0) {
      return uVar4 & 0xffffffff;
    }
    pvVar5 = (void *)_IOMallocData(0xff);
    if (pvVar5 != (void *)0x0) {
      uVar2 = IOAccelTask::getProcessIDAndName((IOAccelTask *)puVar9[1],pvVar5,0xff);
      if (uVar2 == 0xffffffff) {
        _IOFreeData(pvVar5,0xff);
      }
      else {
        uVar10 = (ulong)uVar2;
        uVar4 = glkBfLog(extraout_XMM0_Qa_00,param_2_00,param_3,param_4,param_5,param_6,param_7,
                         param_8,param_10,param_11,"submitted from \'%s\'(%d)",pvVar5,uVar10,uVar11)
        ;
        _IOFreeData(pvVar5,0xff);
        if ((int)uVar4 != 0) {
          return uVar4 & 0xffffffff;
        }
      }
    }
    lVar6 = OSMetaClassBase::safeMetaCast
                      ((OSMetaClassBase *)*puVar9,(OSMetaClass *)&IOAccelCommandQueue::gMetaClass);
    if (lVar6 == 0) {
      lVar6 = OSMetaClassBase::safeMetaCast
                        ((OSMetaClassBase *)*puVar9,(OSMetaClass *)&IOAccelVideoContext2::gMetaClass
                        );
      if (lVar6 == 0) {
        lVar6 = OSMetaClassBase::safeMetaCast
                          ((OSMetaClassBase *)*puVar9,(OSMetaClass *)&IOAccelCLContext2::gMetaClass)
        ;
        if (lVar6 == 0) {
          lVar6 = OSMetaClassBase::safeMetaCast
                            ((OSMetaClassBase *)*puVar9,
                             (OSMetaClass *)&IOAccelGLContext2::gMetaClass);
          if (lVar6 == 0) {
            lVar6 = OSMetaClassBase::safeMetaCast
                              ((OSMetaClassBase *)*puVar9,
                               (OSMetaClass *)&IOAccelContext2::gMetaClass);
            pcVar8 = "Other";
            uVar7 = extraout_XMM0_Qa_06;
            if (lVar6 == 0) {
              pcVar8 = "Unknown";
            }
          }
          else {
            pcVar8 = "GL";
            uVar7 = extraout_XMM0_Qa_05;
          }
        }
        else {
          pcVar8 = "CL";
          uVar7 = extraout_XMM0_Qa_03;
        }
      }
      else {
        pcVar8 = "Video";
        uVar7 = extraout_XMM0_Qa_02;
      }
    }
    else {
      pcVar8 = "Metal";
      uVar7 = extraout_XMM0_Qa_01;
    }
    uVar4 = glkBfLog(uVar7,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,param_10,
                     param_11," on %s context",pcVar8,uVar10,uVar11);
    if ((int)uVar4 != 0) {
      return uVar4 & 0xffffffff;
    }
    uVar4 = 0xffffffff;
    do {
      puVar9 = (undefined8 *)((long)puVar9 + (ulong)*(uint *)(this + 0x8c));
      if (*(undefined8 **)(this + 0xa0) == puVar9) {
        puVar9 = *(undefined8 **)(this + 0x98);
      }
      uVar2 = (int)uVar4 + 1;
      uVar4 = (ulong)uVar2;
    } while (*(undefined8 **)(this + 0x80) != puVar9);
    if (uVar2 == 0) {
      return 0;
    }
    uVar7 = glkBfLog(extraout_XMM0_Qa_04,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,
                     param_10,param_11,"; %d pending",uVar4,uVar10,uVar11);
    uVar2 = (uint)uVar7;
  }
  else {
    uVar7 = glkBfLog(extraout_XMM0_Qa,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,
                     param_10,param_11,"%12s is idle",pcVar8,param_13,param_14);
    uVar2 = (uint)uVar7;
  }
  if (uVar2 == 0) {
    return 0;
  }
  return (ulong)uVar2;
}



// IOAccelFIFOChannel2::_RESERVEDIOAccelFIFOChannel0()

void IOAccelFIFOChannel2::_RESERVEDIOAccelFIFOChannel0(void)

{
  OSMetaClass::reservedCalled(0x81fa8);
  return;
}



// IOAccelFIFOChannel2::_RESERVEDIOAccelFIFOChannel1()

void IOAccelFIFOChannel2::_RESERVEDIOAccelFIFOChannel1(void)

{
  OSMetaClass::reservedCalled(0x81fa8);
  return;
}



// IOAccelFIFOChannel2::_RESERVEDIOAccelFIFOChannel2()

void IOAccelFIFOChannel2::_RESERVEDIOAccelFIFOChannel2(void)

{
  OSMetaClass::reservedCalled(0x81fa8);
  return;
}



// IOAccelFIFOChannel2::_RESERVEDIOAccelFIFOChannel3()

void IOAccelFIFOChannel2::_RESERVEDIOAccelFIFOChannel3(void)

{
  OSMetaClass::reservedCalled(0x81fa8);
  return;
}



// IOAccelFIFOChannel2::_RESERVEDIOAccelFIFOChannel4()

void IOAccelFIFOChannel2::_RESERVEDIOAccelFIFOChannel4(void)

{
  OSMetaClass::reservedCalled(0x81fa8);
  return;
}



// IOAccelFIFOChannel2::_RESERVEDIOAccelFIFOChannel5()

void IOAccelFIFOChannel2::_RESERVEDIOAccelFIFOChannel5(void)

{
  OSMetaClass::reservedCalled(0x81fa8);
  return;
}



// IOAccelChannel2::MetaClass::~MetaClass()

void __thiscall IOAccelChannel2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelChannel2::submitterDestroyed(IOAccelSubmitter2*)

void IOAccelChannel2::submitterDestroyed(void)

{
  return;
}



// IOAccelFIFOChannel2::MetaClass::~MetaClass()

void __thiscall IOAccelFIFOChannel2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



void __GLOBAL__sub_I_IOAccelChannel_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelChannel2::gMetaClass,"IOAccelChannel2",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x70);
  IOAccelChannel2::gMetaClass = (undefined *)&PTR__MetaClass_0006d250;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelFIFOChannel2::gMetaClass,"IOAccelFIFOChannel2",
             (OSMetaClass *)&IOAccelChannel2::gMetaClass,0xe8);
  IOAccelFIFOChannel2::gMetaClass = (undefined *)&PTR__MetaClass_0006d570;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelFIFOChannel2::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelChannel2::gMetaClass);
  return;
}



// IOAccelExternalEvent::MetaClass::MetaClass()

void __thiscall IOAccelExternalEvent::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelExternalEvent",(OSMetaClass *)PTR_gMetaClass_0006b068,0x20)
  ;
  *(undefined ***)this = &PTR__MetaClass_0006d798;
  return;
}



// IOAccelExternalEvent::MetaClass::~MetaClass()

void __thiscall IOAccelExternalEvent::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelExternalEvent::IOAccelExternalEvent(OSMetaClass const*)

void __thiscall
IOAccelExternalEvent::IOAccelExternalEvent(IOAccelExternalEvent *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelExternalEvent_0006d668;
  return;
}



// IOAccelExternalEvent::IOAccelExternalEvent(OSMetaClass const*)

void __thiscall
IOAccelExternalEvent::IOAccelExternalEvent(IOAccelExternalEvent *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelExternalEvent_0006d668;
  return;
}



// IOAccelExternalEvent::~IOAccelExternalEvent()

void __thiscall IOAccelExternalEvent::~IOAccelExternalEvent(IOAccelExternalEvent *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelExternalEvent::~IOAccelExternalEvent()

void __thiscall IOAccelExternalEvent::~IOAccelExternalEvent(IOAccelExternalEvent *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelExternalEvent::~IOAccelExternalEvent()

void __thiscall IOAccelExternalEvent::~IOAccelExternalEvent(IOAccelExternalEvent *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelExternalEvent_ktv,this,0x20);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelExternalEvent::operator delete(void*, unsigned long)

void __cdecl IOAccelExternalEvent::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelExternalEvent_ktv,param_1,param_2);
  return;
}



// IOAccelExternalEvent::getMetaClass() const

undefined8 * IOAccelExternalEvent::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelExternalEvent::MetaClass::MetaClass()

void __thiscall IOAccelExternalEvent::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelExternalEvent",(OSMetaClass *)PTR_gMetaClass_0006b068,0x20)
  ;
  *(undefined ***)this = &PTR__MetaClass_0006d798;
  return;
}



// IOAccelExternalEvent::MetaClass::alloc() const

OSObject * IOAccelExternalEvent::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelExternalEvent_ktv,0x20);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelExternalEvent::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelExternalEvent_0006d668;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelExternalEvent::operator new(unsigned long)

void * __thiscall IOAccelExternalEvent::operator_new(IOAccelExternalEvent *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelExternalEvent_ktv,this);
  return pvVar1;
}



// IOAccelExternalEvent::IOAccelExternalEvent()

void __thiscall IOAccelExternalEvent::IOAccelExternalEvent(IOAccelExternalEvent *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelExternalEvent_0006d668;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelExternalEvent::IOAccelExternalEvent()

void __thiscall IOAccelExternalEvent::IOAccelExternalEvent(IOAccelExternalEvent *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelExternalEvent_0006d668;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelExternalEvent::externalEvent()

long * IOAccelExternalEvent::externalEvent(void)

{
  char cVar1;
  long *plVar2;
  
  plVar2 = (long *)(**(code **)(gMetaClass + 0x88))(&gMetaClass);
  if (plVar2 != (long *)0x0) {
    cVar1 = (**(code **)(*plVar2 + 0x88))(plVar2);
    if (cVar1 != '\0') {
      return plVar2;
    }
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return (long *)0x0;
}



// IOAccelExternalEvent::init()

bool __thiscall IOAccelExternalEvent::init(IOAccelExternalEvent *this)

{
  char cVar1;
  bool bVar2;
  long lVar3;
  
  cVar1 = (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  if (cVar1 == '\0') {
    bVar2 = false;
  }
  else {
    lVar3 = _IOLockAlloc();
    *(long *)(this + 0x10) = lVar3;
    bVar2 = this != (IOAccelExternalEvent *)0x0 && lVar3 != 0;
  }
  return bVar2;
}



// IOAccelExternalEvent::free()

void __thiscall IOAccelExternalEvent::free(IOAccelExternalEvent *this)

{
  if (*(long *)(this + 0x10) != 0) {
    _IOLockFree();
    *(undefined8 *)(this + 0x10) = 0;
  }
                    // WARNING: Could not recover jumptable at 0x000063b9. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelExternalEvent::increment()

void __thiscall IOAccelExternalEvent::increment(IOAccelExternalEvent *this)

{
  _IOLockLock(*(undefined8 *)(this + 0x10));
  *(int *)(this + 0x18) = *(int *)(this + 0x18) + 1;
  _IOLockUnlock(*(undefined8 *)(this + 0x10));
  return;
}



// IOAccelExternalEvent::decrement()

void __thiscall IOAccelExternalEvent::decrement(IOAccelExternalEvent *this)

{
  IOAccelExternalEvent *pIVar1;
  
  _IOLockLock(*(undefined8 *)(this + 0x10));
  pIVar1 = this + 0x18;
  *(int *)pIVar1 = *(int *)pIVar1 + -1;
  if (*(int *)pIVar1 == 0) {
    _IOLockWakeup_darwin14(*(undefined8 *)(this + 0x10),this,0);
  }
  _IOLockUnlock(*(undefined8 *)(this + 0x10));
  return;
}



// IOAccelExternalEvent::test() const

bool __thiscall IOAccelExternalEvent::test(IOAccelExternalEvent *this)

{
  return *(int *)(this + 0x18) != 0;
}



// IOAccelExternalEvent::finish()

void __thiscall IOAccelExternalEvent::finish(IOAccelExternalEvent *this)

{
  _IOLockLock(*(undefined8 *)(this + 0x10));
  while (*(int *)(this + 0x18) != 0) {
    _IOLockSleep_darwin14(*(undefined8 *)(this + 0x10),this,0);
  }
  _IOLockUnlock(*(undefined8 *)(this + 0x10));
  return;
}



// IOAccelExternalEvent::MetaClass::~MetaClass()

void __thiscall IOAccelExternalEvent::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



void __GLOBAL__sub_I_IOAccelExternalEvent_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelExternalEvent::gMetaClass,"IOAccelExternalEvent",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x20);
  IOAccelExternalEvent::gMetaClass = &PTR__MetaClass_0006d798;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelExternalEvent::gMetaClass);
  return;
}



// IOAccelCLContext2::MetaClass::MetaClass()

void __thiscall IOAccelCLContext2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelCLContext2",(OSMetaClass *)&IOAccelContext2::gMetaClass,
             0x10e8);
  *(undefined ***)this = &PTR__MetaClass_0006e418;
  return;
}



// IOAccelCLContext2::MetaClass::~MetaClass()

void __thiscall IOAccelCLContext2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelCLContext2::IOAccelCLContext2(OSMetaClass const*)

void __thiscall IOAccelCLContext2::IOAccelCLContext2(IOAccelCLContext2 *this,OSMetaClass *param_1)

{
  IOAccelContext2::IOAccelContext2((IOAccelContext2 *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelCLContext2_0006d890;
  return;
}



// IOAccelCLContext2::IOAccelCLContext2(OSMetaClass const*)

void __thiscall IOAccelCLContext2::IOAccelCLContext2(IOAccelCLContext2 *this,OSMetaClass *param_1)

{
  IOAccelContext2::IOAccelContext2((IOAccelContext2 *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelCLContext2_0006d890;
  return;
}



// IOAccelCLContext2::~IOAccelCLContext2()

void __thiscall IOAccelCLContext2::~IOAccelCLContext2(IOAccelCLContext2 *this)

{
  IOAccelContext2::~IOAccelContext2((IOAccelContext2 *)this);
  return;
}



// IOAccelCLContext2::~IOAccelCLContext2()

void __thiscall IOAccelCLContext2::~IOAccelCLContext2(IOAccelCLContext2 *this)

{
  IOAccelContext2::~IOAccelContext2((IOAccelContext2 *)this);
  return;
}



// IOAccelCLContext2::~IOAccelCLContext2()

void __thiscall IOAccelCLContext2::~IOAccelCLContext2(IOAccelCLContext2 *this)

{
  IOAccelContext2::~IOAccelContext2((IOAccelContext2 *)this);
  _OSObject_typed_operator_delete(&IOAccelCLContext2_ktv,this,&DAT_000010e8);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelCLContext2::operator delete(void*, unsigned long)

void __cdecl IOAccelCLContext2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelCLContext2_ktv,param_1,param_2);
  return;
}



// IOAccelCLContext2::getMetaClass() const

undefined ** IOAccelCLContext2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelCLContext2::MetaClass::MetaClass()

void __thiscall IOAccelCLContext2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelCLContext2",(OSMetaClass *)&IOAccelContext2::gMetaClass,
             0x10e8);
  *(undefined ***)this = &PTR__MetaClass_0006e418;
  return;
}



// IOAccelCLContext2::MetaClass::alloc() const

undefined8 IOAccelCLContext2::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelCLContext2::operator new(unsigned long)

void * __thiscall IOAccelCLContext2::operator_new(IOAccelCLContext2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelCLContext2_ktv,this);
  return pvVar1;
}



// IOAccelCLContext2::contextStart()

ulong __thiscall IOAccelCLContext2::contextStart(IOAccelCLContext2 *this)

{
  int *piVar1;
  long lVar2;
  ulong uVar3;
  
  uVar3 = IOAccelContext2::contextStart((IOAccelContext2 *)this);
  if ((char)uVar3 != '\0') {
    ___ZN19IOAccelFIFOChannel24initEP22IOGraphicsAccelerator2iii(*(long *)(this + 0x5a0));
    lVar2 = *(long *)(this + 0x5a8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar2 + 0x388) + 0x58),0x26);
    piVar1 = (int *)(lVar2 + 0x238);
    *piVar1 = *piVar1 + 1;
    IOAccelContext2::set_background_rendering((long)this);
  }
  return uVar3 & 0xffffffff;
}



// IOAccelCLContext2::contextStop()

void __thiscall IOAccelCLContext2::contextStop(IOAccelCLContext2 *this)

{
  int *piVar1;
  uint uVar2;
  long *plVar3;
  long lVar4;
  ulong uVar5;
  undefined1 *puStack_30;
  undefined1 *puStack_28;
  undefined1 *puStack_20;
  
  lVar4 = *(long *)(this + 0x5a8);
  puStack_20 = (undefined1 *)0x6675;
  IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar4 + 0x388) + 0x58),0x26);
  piVar1 = (int *)(lVar4 + 0x238);
  *piVar1 = *piVar1 + -1;
  IOAccelFenceMachine::cancelBlockFenceCallback
            (*(IOAccelFenceMachine **)(*(long *)(this + 0x5a8) + 0x390),(long)this);
  if (*(long **)(this + 0x588) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x588) + 0x28))();
    *(undefined8 *)(this + 0x588) = 0;
  }
  lVar4 = *(long *)(this + 0x5b8);
  if (lVar4 != 0) {
    uVar2 = **(uint **)(this + 0x5b0);
    if (uVar2 == 0) {
      uVar2 = 0;
    }
    else {
      uVar5 = 0;
      do {
        plVar3 = *(long **)(*(long *)(this + 0x5b8) + uVar5 * 8);
        if (plVar3 != (long *)0x0) {
          (**(code **)(*plVar3 + 0x28))();
          *(undefined8 *)(*(long *)(this + 0x5b8) + uVar5 * 8) = 0;
          uVar2 = **(uint **)(this + 0x5b0);
        }
        uVar5 = uVar5 + 1;
      } while (uVar5 < uVar2);
      lVar4 = *(long *)(this + 0x5b8);
    }
    *(undefined8 *)(this + 0x5b8) = 0;
    _IOFreeTypeVarImpl(&IOAccelContext2::contextStop()::kalloc_type_view_385,lVar4,(ulong)uVar2 << 3
                      );
    *(undefined8 *)(this + 0x5b8) = 0;
  }
  if (*(long **)(this + 0x6c0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x6c0) + 0x28))();
    *(undefined8 *)(this + 0x6c0) = 0;
    *(undefined8 *)(this + 0x6a0) = 0;
    *(undefined4 *)(this + 0x6c8) = 0;
  }
  if (*(long **)(this + 0x6d0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x6d0) + 0x28))();
    *(undefined8 *)(this + 0x6d0) = 0;
    *(undefined8 *)(this + 0x6a8) = 0;
    *(undefined4 *)(this + 0x6d8) = 0;
  }
  if (*(long **)(this + 0x6b0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x6b0) + 0x28))();
    *(undefined8 *)(this + 0x6b0) = 0;
    *(undefined8 *)(this + 0x620) = 0;
    *(undefined8 *)(this + 0x628) = 0;
  }
  uVar2 = *(uint *)(this + 0x6dc);
  if (uVar2 != 0) {
    uVar5 = 0;
    do {
      if (*(long **)(this + uVar5 * 8 + 0xfe0) != (long *)0x0) {
        (**(code **)(**(long **)(this + uVar5 * 8 + 0xfe0) + 0x28))();
        *(undefined8 *)(this + uVar5 * 8 + 0xfe0) = 0;
        uVar2 = *(uint *)(this + 0x6dc);
      }
      uVar5 = uVar5 + 1;
    } while (uVar5 < uVar2);
  }
  IOAccelContext2::freeAllDataBuffers((IOAccelContext2 *)this);
  if (*(IOAccelShared2 **)(this + 0x5a0) != (IOAccelShared2 *)0x0) {
    IOAccelShared2::decrement_ctx_refcount(*(IOAccelShared2 **)(this + 0x5a0));
    (**(code **)(**(long **)(this + 0x5a0) + 0x28))();
    *(undefined8 *)(this + 0x5a0) = 0;
  }
  if (*(long **)(this + 0x598) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x598) + 0x28))();
    *(undefined8 *)(this + 0x598) = 0;
  }
  if (*(long *)(this + 0x618) != 0) {
    (**(code **)(**(long **)(this + 0x5a8) + 0x8e0))();
    *(undefined8 *)(this + 0x618) = 0;
  }
  if (*(long *)(this + 0x5b0) != 0) {
    _IOFreeTypeImpl(&IOAccelContext2::contextStop()::kalloc_type_view_449);
    *(undefined8 *)(this + 0x5b0) = 0;
  }
  IOAccelContextList::removeContext
            ((IOAccelContextList *)(*(long *)(this + 0x5a8) + 0xa58),(long)this);
  puStack_30 = &DAT_aaaaaaaaaaaaaaaa;
  puStack_28 = &DAT_aaaaaaaaaaaaaaaa;
  puStack_20 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelChannelList::Iterator::Iterator
            ((Iterator *)&puStack_30,(undefined8 *)(*(long *)(this + 0x5a8) + 0xc38));
  plVar3 = (long *)IOAccelChannelList::Iterator::getNextChannel((Iterator *)&puStack_30);
  if (plVar3 != (long *)0x0) {
    do {
      (**(code **)(*plVar3 + 0x168))(plVar3,this);
      plVar3 = (long *)IOAccelChannelList::Iterator::getNextChannel((Iterator *)&puStack_30);
    } while (plVar3 != (long *)0x0);
  }
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelCLContext2::processDataBuffers(unsigned int)

int __cdecl IOAccelCLContext2::processDataBuffers(long *param_1)

{
  long lVar1;
  IOGraphicsAccelerator2 *this;
  char cVar2;
  undefined4 uVar3;
  uint uVar4;
  int iVar5;
  ulong uVar6;
  
  uVar3 = IOGraphicsAccelerator2::acceleratorWaitEnabled((IOGraphicsAccelerator2 *)param_1[0xb5]);
  if ((char)uVar3 == '\0') {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: %s device terminated\n",
                      "virtual uint32_t IOAccelCLContext2::processDataBuffers(uint32_t)",
                      *(undefined8 *)(param_1[0xb5] + 0xc88));
    *(byte *)((long)param_1 + 0x63b) = *(byte *)((long)param_1 + 0x63b) | 8;
  }
  uVar4 = *(uint *)(param_1 + 199);
  IOGraphicsAccelerator2::update_gart_collector_age((IOGraphicsAccelerator2 *)param_1[0xb5]);
  (**(code **)(*param_1 + 0xa30))(param_1,param_1 + 0xca);
  if (param_1[0xc4] == 0) {
    iVar5 = -0x80000000;
  }
  else {
    cVar2 = (**(code **)(*param_1 + 0xa08))(param_1,param_1[0xc3],(uVar4 >> 0x1b & 1) == 0);
    iVar5 = (uint)(cVar2 == '\0') << 0x1f;
  }
  (**(code **)(*param_1 + 0xa38))(param_1,param_1 + 0xca);
  uVar4 = *(uint *)param_1[0xb6];
  if (uVar4 != 0) {
    uVar6 = 0;
    do {
      lVar1 = *(long *)(param_1[0xb7] + uVar6 * 8);
      if (lVar1 != 0) {
        (**(code **)(*param_1 + 0xaa0))(param_1,lVar1,uVar6 & 0xffffffff);
        (**(code **)(**(long **)(param_1[0xb7] + uVar6 * 8) + 0x178))();
        (**(code **)(**(long **)(param_1[0xb7] + uVar6 * 8) + 0x28))();
        *(undefined8 *)(param_1[0xb7] + uVar6 * 8) = 0;
        uVar4 = *(uint *)param_1[0xb6];
      }
      uVar6 = uVar6 + 1;
    } while (uVar6 < uVar4);
  }
  if ((((IOAccelResource2 *)param_1[0x1fc] != (IOAccelResource2 *)0x0) &&
      ((*(byte *)(param_1[0xb5] + 0xc92) & 4) != 0)) && (param_1[0xcb] != 0)) {
    IOAccelResource2::releaseKernelData((IOAccelResource2 *)param_1[0x1fc]);
    param_1[0xcb] = 0;
  }
  uVar4 = *(uint *)((long)param_1 + 0x6dc);
  if (uVar4 != 0) {
    uVar6 = 0;
    do {
      if (param_1[uVar6 + 0x1fc] != 0) {
        (**(code **)(*param_1 + 0xa98))(param_1,param_1[uVar6 + 0x1fc],uVar6 & 0xffffffff);
        (**(code **)(*(long *)param_1[uVar6 + 0x1fc] + 0x178))();
        (**(code **)(*(long *)param_1[uVar6 + 0x1fc] + 0x28))();
        param_1[uVar6 + 0x1fc] = 0;
        uVar4 = *(uint *)((long)param_1 + 0x6dc);
      }
      uVar6 = uVar6 + 1;
    } while (uVar6 < uVar4);
  }
  this = (IOGraphicsAccelerator2 *)param_1[0xb5];
  *(int *)(this + 0xdd4) = (int)param_1[0xb0];
  IOGraphicsAccelerator2::enable_gart_collector(this);
  return iVar5;
}



// IOAccelCLContext2::_RESERVEDIOAccelCLContext0()

void IOAccelCLContext2::_RESERVEDIOAccelCLContext0(void)

{
  OSMetaClass::reservedCalled(0x81ff8);
  return;
}



// IOAccelCLContext2::_RESERVEDIOAccelCLContext1()

void IOAccelCLContext2::_RESERVEDIOAccelCLContext1(void)

{
  OSMetaClass::reservedCalled(0x81ff8);
  return;
}



// IOAccelCLContext2::_RESERVEDIOAccelCLContext2()

void IOAccelCLContext2::_RESERVEDIOAccelCLContext2(void)

{
  OSMetaClass::reservedCalled(0x81ff8);
  return;
}



// IOAccelCLContext2::_RESERVEDIOAccelCLContext3()

void IOAccelCLContext2::_RESERVEDIOAccelCLContext3(void)

{
  OSMetaClass::reservedCalled(0x81ff8);
  return;
}



// IOAccelCLContext2::_RESERVEDIOAccelCLContext4()

void IOAccelCLContext2::_RESERVEDIOAccelCLContext4(void)

{
  OSMetaClass::reservedCalled(0x81ff8);
  return;
}



// IOAccelCLContext2::_RESERVEDIOAccelCLContext5()

void IOAccelCLContext2::_RESERVEDIOAccelCLContext5(void)

{
  OSMetaClass::reservedCalled(0x81ff8);
  return;
}



// IOAccelCLContext2::MetaClass::~MetaClass()

void __thiscall IOAccelCLContext2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelContext2::getOwningTask() const

undefined8 __thiscall IOAccelContext2::getOwningTask(IOAccelContext2 *this)

{
  return *(undefined8 *)(this + 0x578);
}



// IOAccelContext2::getGPUTask() const

undefined8 __thiscall IOAccelContext2::getGPUTask(IOAccelContext2 *this)

{
  return *(undefined8 *)(this + 0x598);
}



// IOAccelContext2::getOwningTaskPid() const

undefined4 __thiscall IOAccelContext2::getOwningTaskPid(IOAccelContext2 *this)

{
  return *(undefined4 *)(this + 0x580);
}



// IOAccelSubmitter2::retireCommandBuffer(IOAccelEventFence*)

void IOAccelSubmitter2::retireCommandBuffer(void)

{
  return;
}



// IOAccelSubmitter2::setSubmissionError(unsigned int)

void IOAccelSubmitter2::setSubmissionError(void)

{
  return;
}



// IOAccelSubmitter2::isOpportunisticWorkload() const

undefined8 IOAccelSubmitter2::isOpportunisticWorkload(void)

{
  return 0;
}



// IOAccelContext2::postTokenSanityCheck(IOAccelCommandStreamInfo&)

void IOAccelContext2::postTokenSanityCheck(void)

{
  return;
}



// IOAccelContext2::getDataBufferPrivate(IOAccelResource2*, IOAccelResourcePrivate*, unsigned long
// long)

void IOAccelContext2::getDataBufferPrivate(void)

{
  return;
}



// IOAccelContext2::validateDataBuffer(unsigned long long, IOBufferMemoryDescriptor*,
// IOAccelResource2*)

undefined8 IOAccelContext2::validateDataBuffer(void)

{
  return 0;
}



// IOAccelContext2::invalidate()

void IOAccelContext2::invalidate(void)

{
  return;
}



// IOAccelContext2::getFrameDelimiter()

undefined8 IOAccelContext2::getFrameDelimiter(void)

{
  return 0;
}



void __GLOBAL__sub_I_IOAccelCLContext_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelCLContext2::gMetaClass,"IOAccelCLContext2",
             (OSMetaClass *)&IOAccelContext2::gMetaClass,0x10e8);
  IOAccelCLContext2::gMetaClass = (undefined *)&PTR__MetaClass_0006e418;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelCLContext2::gMetaClass);
  return;
}



// IOAccelCommandBufferPool2::MetaClass::MetaClass()

void __thiscall IOAccelCommandBufferPool2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelCommandBufferPool2",(OSMetaClass *)PTR_gMetaClass_0006b068,
             0x18b8);
  *(undefined ***)this = &PTR__MetaClass_0006e678;
  return;
}



// IOAccelCommandBufferPool2::MetaClass::~MetaClass()

void __thiscall IOAccelCommandBufferPool2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelCommandBufferPool2::IOAccelCommandBufferPool2(OSMetaClass const*)

void __thiscall
IOAccelCommandBufferPool2::IOAccelCommandBufferPool2
          (IOAccelCommandBufferPool2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelCommandBufferPool2_0006e510;
  return;
}



// IOAccelCommandBufferPool2::IOAccelCommandBufferPool2(OSMetaClass const*)

void __thiscall
IOAccelCommandBufferPool2::IOAccelCommandBufferPool2
          (IOAccelCommandBufferPool2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelCommandBufferPool2_0006e510;
  return;
}



// IOAccelCommandBufferPool2::~IOAccelCommandBufferPool2()

void __thiscall
IOAccelCommandBufferPool2::~IOAccelCommandBufferPool2(IOAccelCommandBufferPool2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelCommandBufferPool2::~IOAccelCommandBufferPool2()

void __thiscall
IOAccelCommandBufferPool2::~IOAccelCommandBufferPool2(IOAccelCommandBufferPool2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelCommandBufferPool2::~IOAccelCommandBufferPool2()

void __thiscall
IOAccelCommandBufferPool2::~IOAccelCommandBufferPool2(IOAccelCommandBufferPool2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelCommandBufferPool2_ktv,this,0x18b8);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelCommandBufferPool2::operator delete(void*, unsigned long)

void __cdecl IOAccelCommandBufferPool2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelCommandBufferPool2_ktv,param_1,param_2);
  return;
}



// IOAccelCommandBufferPool2::getMetaClass() const

undefined1 * IOAccelCommandBufferPool2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelCommandBufferPool2::MetaClass::MetaClass()

void __thiscall IOAccelCommandBufferPool2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelCommandBufferPool2",(OSMetaClass *)PTR_gMetaClass_0006b068,
             0x18b8);
  *(undefined ***)this = &PTR__MetaClass_0006e678;
  return;
}



// IOAccelCommandBufferPool2::MetaClass::alloc() const

OSObject * IOAccelCommandBufferPool2::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelCommandBufferPool2_ktv,0x18b8);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelCommandBufferPool2::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelCommandBufferPool2_0006e510;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelCommandBufferPool2::operator new(unsigned long)

void * __thiscall IOAccelCommandBufferPool2::operator_new(IOAccelCommandBufferPool2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelCommandBufferPool2_ktv,this);
  return pvVar1;
}



// IOAccelCommandBufferPool2::IOAccelCommandBufferPool2()

void __thiscall
IOAccelCommandBufferPool2::IOAccelCommandBufferPool2(IOAccelCommandBufferPool2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelCommandBufferPool2_0006e510;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelCommandBufferPool2::IOAccelCommandBufferPool2()

void __thiscall
IOAccelCommandBufferPool2::IOAccelCommandBufferPool2(IOAccelCommandBufferPool2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelCommandBufferPool2_0006e510;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelCommandBufferPool2::init(IOGraphicsAccelerator2*, IOAccelChannel2*, IOAccelTask*, int,
// int, unsigned int, unsigned int, unsigned int, unsigned int)

ulong __thiscall
IOAccelCommandBufferPool2::init
          (IOAccelCommandBufferPool2 *this,undefined8 param_1,long *param_2,undefined8 param_3,
          short param_5_00,undefined4 param_5,undefined4 param_6,undefined4 param_7,uint param_8,
          undefined4 param_9)

{
  long lVar1;
  ulong uVar2;
  
  *(undefined8 *)(this + 0x10) = param_1;
  *(undefined8 *)(this + 0x18) = 0;
  *(undefined8 *)(this + 0x28) = param_3;
  *(long **)(this + 0x20) = param_2;
  (**(code **)(*param_2 + 0x20))(param_2);
  *(undefined2 *)(this + 0x1842) = 0xffff;
  *(undefined8 *)(this + 0x1858) = 0;
  *(undefined8 *)(this + 0x1848) = 0;
  *(undefined8 *)(this + 0x1850) = 0;
  *(undefined2 *)(this + 0x1832) = 0;
  *(short *)(this + 0x1830) = param_5_00;
  *(undefined4 *)(this + 0x1834) = param_5;
  *(undefined4 *)(this + 0x1838) = param_6;
  *(undefined4 *)(this + 0x183c) = param_7;
  *(undefined4 *)(this + 0x1870) = param_9;
  *(ulong *)(this + 0x1868) = (ulong)param_8;
  if (param_5_00 == 0) {
    *(undefined8 *)(this + 0x1860) = 0;
  }
  else {
    lVar1 = 0x40;
    do {
      *(undefined8 *)(this + lVar1 + -0x10) = 0;
      *(undefined8 *)(this + lVar1 + -8) = 0;
      *(undefined8 *)(this + lVar1) = 0;
      lVar1 = lVar1 + 0x18;
    } while (lVar1 != 0x1840);
    uVar2 = allocMoreCommandBuffers(this);
    if (((char)uVar2 == '\0') || ((short)*(ushort *)(this + 0x1842) < 0)) {
      uVar2 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Failed to allocate more command buffer\n",
                        "virtual bool IOAccelCommandBufferPool2::init(IOGraphicsAccelerator2 *, IOAccelChannel2 *, IOAccelTask *, int, int, IOOptionBits, uint32_t, uint32_t, uint32_t)"
                       );
      goto LAB_00006b69;
    }
    lVar1 = *(long *)(this + (ulong)*(ushort *)(this + 0x1842) * 0x18 + 0x40);
    *(long *)(this + 0x1848) = lVar1;
    *(ulong *)(this + 0x1850) =
         (ulong)(*(int *)(this + 0x1834) - *(int *)(this + 0x1870) & 0xfffffffc) + lVar1;
    *(long *)(this + 0x1858) = lVar1;
    lVar1 = (**(code **)(**(long **)(this + 0x10) + 0x8d8))();
    *(long *)(this + 0x1860) = lVar1;
    *(undefined8 *)(lVar1 + 8) = param_3;
  }
  IOAccelCommandBufferPoolList::addCommandPool
            ((IOAccelCommandBufferPoolList *)(*(long *)(this + 0x10) + 0xc68),(long)this);
  uVar2 = CONCAT71((int7)((ulong)this >> 8),1);
LAB_00006b69:
  return uVar2 & 0xffffffff;
}



// IOAccelCommandBufferPool2::allocMoreCommandBuffers()

ulong __thiscall IOAccelCommandBufferPool2::allocMoreCommandBuffers(IOAccelCommandBufferPool2 *this)

{
  ushort uVar1;
  IOAccelMemory *this_00;
  long lVar2;
  ulong uVar3;
  ulong uVar4;
  uint uVar5;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 extraout_RDX_01;
  undefined8 extraout_RDX_02;
  undefined8 uVar6;
  undefined *puVar7;
  IOAccelCommandBufferPool2 *unaff_R14;
  ulong uVar8;
  IOAccelCommandBufferPool2 *pIVar9;
  uint local_40;
  
  uVar1 = *(ushort *)(this + 0x1832);
  uVar4 = (ulong)uVar1;
  if (uVar1 == *(ushort *)(this + 0x1830)) {
LAB_00006b9b:
    uVar3 = 0;
  }
  else {
    uVar5 = 1;
    if (uVar1 != 0) {
      uVar5 = (uint)uVar1 + (uint)uVar1;
    }
    if (uVar1 < uVar5) {
      unaff_R14 = this + uVar4 * 0x18 + 0x30;
      uVar8 = uVar4;
      do {
        puVar7 = PTR__kernel_task_0006b100;
        this_00 = IOAccelSysMemory::withOptions
                            (*(IOGraphicsAccelerator2 **)(this + 0x10),
                             *(undefined8 *)PTR__kernel_task_0006b100,0,0,
                             *(uint *)(this + 0x1838) | 0x23,(ulong)*(uint *)(this + 0x1834));
        *(IOAccelMemory **)unaff_R14 = this_00;
        if (this_00 == (IOAccelMemory *)0x0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: IOAccelSysMemory::withOptions failed\n",
                            "bool IOAccelCommandBufferPool2::allocMoreCommandBuffers()");
LAB_00006cc4:
          uVar3 = 0;
          puVar7 = PTR___os_log_default_0006b0b8;
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: Failed to allocate more command buffers\n",
                            "bool IOAccelCommandBufferPool2::allocMoreCommandBuffers()");
          local_40 = (uint)uVar1;
          if (local_40 < (uint)uVar8) {
            uVar8 = uVar8 & 0xffffffff;
            uVar6 = extraout_RDX;
            do {
              uVar8 = uVar8 - 1;
              uVar3 = uVar8 & 0xffffffff;
              if (*(long *)(this + uVar3 * 0x18 + 0x38) != 0) {
                IOAccelMemoryMap::finishEvent(*(long *)(this + uVar3 * 0x18 + 0x38),puVar7,uVar6);
                (**(code **)(**(long **)(this + uVar3 * 0x18 + 0x38) + 0x28))();
                *(undefined8 *)(this + uVar3 * 0x18 + 0x38) = 0;
                uVar6 = extraout_RDX_00;
              }
              pIVar9 = this + uVar3 * 0x18 + 0x30;
              if (*(long *)(this + uVar3 * 0x18 + 0x40) != 0) {
                puVar7 = *(undefined **)PTR__kernel_task_0006b100;
                IOAccelSysMemory::unlockForCPUAccess(*(IOAccelSysMemory **)pIVar9,(long)puVar7);
                *(undefined8 *)(this + uVar3 * 0x18 + 0x40) = 0;
                uVar6 = extraout_RDX_01;
              }
              if (*(long **)pIVar9 != (long *)0x0) {
                (**(code **)(**(long **)pIVar9 + 0x28))();
                *(long *)pIVar9 = 0;
                uVar6 = extraout_RDX_02;
              }
            } while ((long)uVar4 < (long)uVar8);
            goto LAB_00006b9b;
          }
          goto LAB_00006d81;
        }
        lVar2 = IOAccelSysMemory::lockForCPUAccess
                          ((IOAccelSysMemory *)this_00,*(ulonglong *)puVar7,
                           (ulong)(*(uint *)(this + 0x1838) | 1));
        *(long *)(unaff_R14 + 0x10) = lVar2;
        if (lVar2 == 0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to map into kernel\n",
                            "bool IOAccelCommandBufferPool2::allocMoreCommandBuffers()");
          (**(code **)(**(long **)unaff_R14 + 0x28))();
          *(undefined8 *)unaff_R14 = 0;
          goto LAB_00006cc4;
        }
        uVar8 = uVar8 + 1;
        unaff_R14 = unaff_R14 + 0x18;
      } while (uVar5 != uVar8);
    }
    *(short *)(this + 0x1832) = (short)uVar5;
    setBufferCurrentIndex(this,(int)(short)uVar1);
    uVar3 = CONCAT71((int7)((ulong)unaff_R14 >> 8),1);
  }
LAB_00006d81:
  return uVar3 & 0xffffffff;
}



// IOAccelCommandBufferPool2::free()

void __thiscall IOAccelCommandBufferPool2::free(IOAccelCommandBufferPool2 *this)

{
  byte *pbVar1;
  undefined *puVar2;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 extraout_RDX_01;
  undefined8 extraout_RDX_02;
  undefined8 extraout_RDX_03;
  undefined8 uVar3;
  IOAccelCommandBufferPool2 *pIVar4;
  long lVar5;
  
  pIVar4 = this;
  IOAccelCommandBufferPoolList::removeCommandPool
            ((IOAccelCommandBufferPoolList *)(*(long *)(this + 0x10) + 0xc68),(long)this);
  uVar3 = extraout_RDX;
  if ((-1 < (short)*(ushort *)(this + 0x1842)) &&
     (*(long **)(this + (ulong)*(ushort *)(this + 0x1842) * 0x18 + 0x38) != (long *)0x0)) {
    (**(code **)(**(long **)(this + (ulong)*(ushort *)(this + 0x1842) * 0x18 + 0x38) + 0x140))();
    uVar3 = extraout_RDX_00;
  }
  puVar2 = PTR__kernel_task_0006b100;
  lVar5 = 0x40;
  do {
    if (*(long *)(this + lVar5 + -8) != 0) {
      IOAccelMemoryMap::finishEvent(*(long *)(this + lVar5 + -8),pIVar4,uVar3);
      (**(code **)(**(long **)(this + lVar5 + -8) + 0x28))();
      *(undefined8 *)(this + lVar5 + -8) = 0;
      uVar3 = extraout_RDX_01;
    }
    if (*(long *)(this + lVar5) != 0) {
      pIVar4 = *(IOAccelCommandBufferPool2 **)puVar2;
      IOAccelSysMemory::unlockForCPUAccess
                (*(IOAccelSysMemory **)(this + lVar5 + -0x10),(long)pIVar4);
      *(undefined8 *)(this + lVar5) = 0;
      uVar3 = extraout_RDX_02;
    }
    if (*(long *)(this + lVar5 + -0x10) != 0) {
      pbVar1 = (byte *)(*(long *)(this + lVar5 + -0x10) + 0xc);
      *pbVar1 = *pbVar1 | 1;
      (**(code **)(**(long **)(this + lVar5 + -0x10) + 0x28))();
      *(undefined8 *)(this + lVar5 + -0x10) = 0;
      uVar3 = extraout_RDX_03;
    }
    lVar5 = lVar5 + 0x18;
  } while (lVar5 != 0x1840);
  if (*(long **)(this + 0x20) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x20) + 0x28))();
    *(undefined8 *)(this + 0x20) = 0;
  }
  if (*(long *)(this + 0x1860) != 0) {
    (**(code **)(**(long **)(this + 0x10) + 0x8e0))();
    *(undefined8 *)(this + 0x1860) = 0;
  }
  *(undefined2 *)(this + 0x1842) = 0xfffe;
  *(undefined8 *)(this + 0x1858) = 0;
  *(undefined2 *)(this + 0x1832) = 0;
  *(undefined8 *)(this + 0x1848) = 0;
  *(undefined8 *)(this + 0x1850) = 0;
                    // WARNING: Could not recover jumptable at 0x00006ec8. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelCommandBufferPool2::getEventMachine() const

undefined8 __thiscall IOAccelCommandBufferPool2::getEventMachine(IOAccelCommandBufferPool2 *this)

{
  return *(undefined8 *)(*(long *)(this + 0x10) + 0x380);
}



// IOAccelCommandBufferPool2::setBufferCurrentIndex(short)

void __thiscall
IOAccelCommandBufferPool2::setBufferCurrentIndex(IOAccelCommandBufferPool2 *this,int param_1)

{
  char cVar1;
  long *plVar2;
  ulong uVar3;
  undefined8 extraout_RDX;
  IOAccelCommandBufferPool2 *pIVar4;
  
  pIVar4 = this + (long)param_1 * 0x18 + 0x38;
  plVar2 = *(long **)pIVar4;
  if (plVar2 == (long *)0x0) {
    plVar2 = (long *)(**(code **)(**(long **)(this + (long)param_1 * 0x18 + 0x30) + 0x138))
                               (*(long **)(this + (long)param_1 * 0x18 + 0x30),
                                *(undefined8 *)(this + 0x28),*(undefined4 *)(this + 0x183c));
    *(long **)pIVar4 = plVar2;
    if (plVar2 == (long *)0x0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to create mapping.\n",
                        "void IOAccelCommandBufferPool2::setBufferCurrentIndex(int16_t)");
      return;
    }
  }
  if ((((*(byte *)(plVar2 + 2) & 1) == 0) &&
      (cVar1 = (**(code **)(*plVar2 + 0x150))(), cVar1 == '\0')) &&
     (cVar1 = (**(code **)(**(long **)(this + 0x28) + 0x120))
                        (*(long **)(this + 0x28),*(long *)pIVar4), cVar1 == '\0')) {
    (**(code **)(**(long **)pIVar4 + 0x28))();
    *(long *)pIVar4 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: failed to allocate GPU virtual address for mapping.\n",
                      "void IOAccelCommandBufferPool2::setBufferCurrentIndex(int16_t)");
    return;
  }
  cVar1 = (**(code **)(**(long **)pIVar4 + 0x138))();
  if ((cVar1 == '\0') &&
     (uVar3 = IOGraphicsAccelerator2::freeToPrepareMapping
                        (*(IOGraphicsAccelerator2 **)(this + 0x10),*(long **)pIVar4,extraout_RDX),
     (char)uVar3 == '\0')) {
    (**(code **)(**(long **)pIVar4 + 0x28))();
    *(long *)pIVar4 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to wire down mapping.\n",
                      "void IOAccelCommandBufferPool2::setBufferCurrentIndex(int16_t)");
    return;
  }
  if ((-1 < (short)*(ushort *)(this + 0x1842)) &&
     (*(long **)(this + (ulong)*(ushort *)(this + 0x1842) * 0x18 + 0x38) != (long *)0x0)) {
    (**(code **)(**(long **)(this + (ulong)*(ushort *)(this + 0x1842) * 0x18 + 0x38) + 0x140))();
  }
  *(short *)(this + 0x1842) = (short)param_1;
  return;
}



// IOAccelCommandBufferPool2::getBufferPtrNoInc(unsigned int)

void __thiscall
IOAccelCommandBufferPool2::getBufferPtrNoInc(IOAccelCommandBufferPool2 *this,uint param_1)

{
  long lVar1;
  char cVar2;
  ulong uVar3;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 extraout_RDX_01;
  undefined8 uVar4;
  uint uVar5;
  ulong uVar6;
  
  if (*(ulong *)(this + 0x1858) + (ulong)param_1 * 4 <= *(ulong *)(this + 0x1850)) {
    return;
  }
  if (*(ulong *)(this + 0x1848) < *(ulong *)(this + 0x1858)) {
    submitBuffer(this);
    (**(code **)(**(long **)(this + 0x20) + 0x148))();
    if (*(long *)(this + 0x1858) + (ulong)param_1 * 4 <= *(ulong *)(this + 0x1850)) {
      return;
    }
  }
  uVar5 = (uint)(short)(*(short *)(this + 0x1832) - 1U & *(short *)(this + 0x1842) + 1U);
  uVar6 = (ulong)uVar5;
  setBufferCurrentIndex(this,uVar5);
  uVar4 = extraout_RDX;
  if ((((*(long *)(this + (long)*(short *)(this + 0x1842) * 0x18 + 0x38) == 0) ||
       (cVar2 = IOAccelMemoryMap::testEvent
                          (*(long *)(this + (long)*(short *)(this + 0x1842) * 0x18 + 0x38),uVar6,
                           extraout_RDX), uVar4 = extraout_RDX_00, cVar2 == '\0')) &&
      ((*(ushort *)(this + 0x1830) <= *(ushort *)(this + 0x1832) ||
       (uVar3 = allocMoreCommandBuffers(this), uVar4 = extraout_RDX_01, (char)uVar3 == '\0')))) &&
     (*(long *)(this + (long)*(short *)(this + 0x1842) * 0x18 + 0x38) != 0)) {
    IOAccelMemoryMap::finishEvent
              (*(long *)(this + (long)*(short *)(this + 0x1842) * 0x18 + 0x38),uVar6,uVar4);
  }
  lVar1 = *(long *)(this + (long)*(short *)(this + 0x1842) * 0x18 + 0x40);
  *(long *)(this + 0x1848) = lVar1;
  *(ulong *)(this + 0x1850) =
       (ulong)(*(int *)(this + 0x1834) - *(int *)(this + 0x1870) & 0xfffffffc) + lVar1;
  *(long *)(this + 0x1858) = lVar1;
  return;
}



// IOAccelCommandBufferPool2::submitBuffer()

void __thiscall IOAccelCommandBufferPool2::submitBuffer(IOAccelCommandBufferPool2 *this)

{
  long lVar1;
  long lVar2;
  char cVar3;
  long lVar4;
  ulong uVar5;
  ulong uVar6;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 extraout_RDX_01;
  undefined8 uVar7;
  uint uVar8;
  
  lVar1 = *(long *)(this + 0x1848);
  *(long *)(*(long *)(this + 0x1860) + 0x20) = lVar1;
  lVar4 = (**(code **)(**(long **)(this + (long)*(short *)(this + 0x1842) * 0x18 + 0x38) + 0x128))()
  ;
  lVar2 = *(long *)(this + 0x1860);
  *(long *)(lVar2 + 0x18) =
       (lVar4 + lVar1) - *(long *)(this + (long)*(short *)(this + 0x1842) * 0x18 + 0x40);
  *(int *)(lVar2 + 0x30) = (int)((ulong)(*(long *)(this + 0x1858) - *(long *)(this + 0x1848)) >> 2);
  (**(code **)(**(long **)(this + 0x20) + 0x130))();
  (**(code **)(**(long **)(this + 0x20) + 0x140))
            (*(long **)(this + 0x20),
             *(long *)(this + (long)*(short *)(this + 0x1842) * 0x18 + 0x38) + 0x38);
  lVar1 = *(long *)(this + 0x1868);
  if (lVar1 == 0) {
    uVar8 = (uint)(short)(*(short *)(this + 0x1832) - 1U & *(short *)(this + 0x1842) + 1U);
    uVar5 = (ulong)uVar8;
    setBufferCurrentIndex(this,uVar8);
    uVar7 = extraout_RDX;
    if ((((*(long *)(this + (long)*(short *)(this + 0x1842) * 0x18 + 0x38) == 0) ||
         (cVar3 = IOAccelMemoryMap::testEvent
                            (*(long *)(this + (long)*(short *)(this + 0x1842) * 0x18 + 0x38),uVar5,
                             extraout_RDX), uVar7 = extraout_RDX_00, cVar3 == '\0')) &&
        ((*(ushort *)(this + 0x1830) <= *(ushort *)(this + 0x1832) ||
         (uVar6 = allocMoreCommandBuffers(this), uVar7 = extraout_RDX_01, (char)uVar6 == '\0')))) &&
       (*(long *)(this + (long)*(short *)(this + 0x1842) * 0x18 + 0x38) != 0)) {
      IOAccelMemoryMap::finishEvent
                (*(long *)(this + (long)*(short *)(this + 0x1842) * 0x18 + 0x38),uVar5,uVar7);
    }
    lVar1 = *(long *)(this + (long)*(short *)(this + 0x1842) * 0x18 + 0x40);
    *(long *)(this + 0x1848) = lVar1;
    *(ulong *)(this + 0x1850) =
         (ulong)(*(int *)(this + 0x1834) - *(int *)(this + 0x1870) & 0xfffffffc) + lVar1;
    *(long *)(this + 0x1858) = lVar1;
    return;
  }
  uVar5 = -lVar1 & ((ulong)(*(uint *)(this + 0x1870) & 0xfffffffc) + *(long *)(this + 0x1858) +
                   lVar1) - 1;
  *(ulong *)(this + 0x1858) = uVar5;
  *(ulong *)(this + 0x1848) = uVar5;
  return;
}



// IOAccelCommandBufferPool2::setBufferPtr(unsigned int*)

void __thiscall
IOAccelCommandBufferPool2::setBufferPtr(IOAccelCommandBufferPool2 *this,undefined8 param_1)

{
  *(undefined8 *)(this + 0x1858) = param_1;
  return;
}



// IOAccelCommandBufferPool2::getGPUVirtualAddress(unsigned int*) const

long __thiscall
IOAccelCommandBufferPool2::getGPUVirtualAddress(IOAccelCommandBufferPool2 *this,long param_1)

{
  long lVar1;
  
  lVar1 = (**(code **)(**(long **)(this + (long)*(short *)(this + 0x1842) * 0x18 + 0x38) + 0x128))()
  ;
  return (lVar1 + param_1) - *(long *)(this + (long)*(short *)(this + 0x1842) * 0x18 + 0x40);
}



// IOAccelCommandBufferPool2::_RESERVEDIOAccelCommandBufferPool0()

void IOAccelCommandBufferPool2::_RESERVEDIOAccelCommandBufferPool0(void)

{
  OSMetaClass::reservedCalled(0x82020);
  return;
}



// IOAccelCommandBufferPool2::_RESERVEDIOAccelCommandBufferPool1()

void IOAccelCommandBufferPool2::_RESERVEDIOAccelCommandBufferPool1(void)

{
  OSMetaClass::reservedCalled(0x82020);
  return;
}



// IOAccelCommandBufferPool2::_RESERVEDIOAccelCommandBufferPool2()

void IOAccelCommandBufferPool2::_RESERVEDIOAccelCommandBufferPool2(void)

{
  OSMetaClass::reservedCalled(0x82020);
  return;
}



// IOAccelCommandBufferPool2::_RESERVEDIOAccelCommandBufferPool3()

void IOAccelCommandBufferPool2::_RESERVEDIOAccelCommandBufferPool3(void)

{
  OSMetaClass::reservedCalled(0x82020);
  return;
}



// IOAccelCommandBufferPool2::_RESERVEDIOAccelCommandBufferPool4()

void IOAccelCommandBufferPool2::_RESERVEDIOAccelCommandBufferPool4(void)

{
  OSMetaClass::reservedCalled(0x82020);
  return;
}



// IOAccelCommandBufferPool2::_RESERVEDIOAccelCommandBufferPool5()

void IOAccelCommandBufferPool2::_RESERVEDIOAccelCommandBufferPool5(void)

{
  OSMetaClass::reservedCalled(0x82020);
  return;
}



// IOAccelCommandBufferPool2::MetaClass::~MetaClass()

void __thiscall IOAccelCommandBufferPool2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelCommandBuffer_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelCommandBufferPool2::gMetaClass,"IOAccelCommandBufferPool2",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x18b8);
  _gMetaClass = &PTR__MetaClass_0006e678;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelCommandBufferPool2::gMetaClass);
  return;
}



// IOAccelContext2::MetaClass::MetaClass()

void __thiscall IOAccelContext2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelContext2",(OSMetaClass *)&IOAccelSubmitter2::gMetaClass,
             0x10a8);
  *(undefined ***)this = &PTR__MetaClass_0006f2c8;
  return;
}



// IOAccelContext2::MetaClass::~MetaClass()

void __thiscall IOAccelContext2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelContext2::IOAccelContext2(OSMetaClass const*)

void __thiscall IOAccelContext2::IOAccelContext2(IOAccelContext2 *this,OSMetaClass *param_1)

{
  IOAccelSubmitter2::IOAccelSubmitter2((IOAccelSubmitter2 *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelContext2_0006e770;
  return;
}



// IOAccelContext2::IOAccelContext2(OSMetaClass const*)

void __thiscall IOAccelContext2::IOAccelContext2(IOAccelContext2 *this,OSMetaClass *param_1)

{
  IOAccelSubmitter2::IOAccelSubmitter2((IOAccelSubmitter2 *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelContext2_0006e770;
  return;
}



// IOAccelContext2::~IOAccelContext2()

void __thiscall IOAccelContext2::~IOAccelContext2(IOAccelContext2 *this)

{
  IOAccelSubmitter2::~IOAccelSubmitter2((IOAccelSubmitter2 *)this);
  return;
}



// IOAccelContext2::~IOAccelContext2()

void __thiscall IOAccelContext2::~IOAccelContext2(IOAccelContext2 *this)

{
  IOAccelSubmitter2::~IOAccelSubmitter2((IOAccelSubmitter2 *)this);
  return;
}



// IOAccelContext2::~IOAccelContext2()

void __thiscall IOAccelContext2::~IOAccelContext2(IOAccelContext2 *this)

{
  IOAccelSubmitter2::~IOAccelSubmitter2((IOAccelSubmitter2 *)this);
  _OSObject_typed_operator_delete(&IOAccelContext2_ktv,this,&DAT_000010a8);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelContext2::operator delete(void*, unsigned long)

void __cdecl IOAccelContext2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelContext2_ktv,param_1,param_2);
  return;
}



// IOAccelContext2::getMetaClass() const

undefined1 * IOAccelContext2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelContext2::MetaClass::MetaClass()

void __thiscall IOAccelContext2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelContext2",(OSMetaClass *)&IOAccelSubmitter2::gMetaClass,
             0x10a8);
  *(undefined ***)this = &PTR__MetaClass_0006f2c8;
  return;
}



// IOAccelContext2::MetaClass::alloc() const

undefined8 IOAccelContext2::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelContext2::operator new(unsigned long)

void * __thiscall IOAccelContext2::operator_new(IOAccelContext2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelContext2_ktv,this);
  return pvVar1;
}



// IOAccelContext2::finish()

void __thiscall IOAccelContext2::finish(IOAccelContext2 *this)

{
                    // WARNING: Could not recover jumptable at 0x00007538. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x9f8))();
  return;
}



// IOAccelContext2::set_client_info(IOAccelClientInfo*, unsigned long long)

undefined8 __thiscall
IOAccelContext2::set_client_info(IOAccelContext2 *this,char *param_1,long param_2)

{
  undefined8 uVar1;
  
  uVar1 = 0xe00002c2;
  if (param_2 == 0x400) {
    _strlcpy((char *)(this + 0xd8),param_1,0x400);
    uVar1 = 0;
  }
  return uVar1;
}



// IOAccelContext2::submit_data_buffers(IOAccelContextSubmitDataBuffersIn*,
// IOAccelContextSubmitDataBuffersOut*, unsigned long long, unsigned long long*)

undefined8 __thiscall
IOAccelContext2::submit_data_buffers
          (IOAccelContext2 *this,undefined4 *param_1,undefined8 *param_2,undefined8 param_4_00,
          ulong *param_4)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  long lVar4;
  IOGraphicsAccelerator2 *pIVar5;
  IOAccelResource2 *pIVar6;
  char cVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  ulong uVar10;
  uintptr_t uVar11;
  uintptr_t uVar12;
  uintptr_t uVar13;
  long *plVar14;
  ulong *puVar15;
  ulong uVar16;
  ulong *puVar17;
  IOAccelContext2 *pIVar18;
  ulong uVar19;
  IOAccelResource2 *this_00;
  int iVar20;
  int iVar21;
  char *pcVar22;
  ulong uVar23;
  long lVar24;
  long lVar25;
  undefined8 uVar26;
  int local_60;
  undefined4 local_5c;
  uint local_54;
  ulong local_50;
  ulong *local_48;
  undefined8 *local_40;
  ulong *local_38;
  
  if (*(long *)(this + 0x5a0) == 0) {
    uVar26 = 0xe00002bc;
  }
  else {
    uVar1 = param_1[1];
    uVar16 = (ulong)uVar1 * 0x30 + 0x18;
    uVar26 = 0xe00002c2;
    if (uVar1 <= uVar16) {
      uVar2 = *(uint *)(this + 0x6dc);
      uVar10 = (ulong)uVar2;
      uVar23 = uVar10 * 0x30 + 0x18;
      uVar19 = *param_4;
      if (uVar23 < uVar16) {
        uVar23 = uVar16;
      }
      if (uVar23 <= uVar19) {
        uVar3 = *(uint *)(*(long *)(this + 0x5a8) + 0xce8);
        local_50 = (ulong)uVar3;
        local_48 = (ulong *)CONCAT44(local_48._4_4_,*param_1);
        if (uVar2 != 0) {
          lVar24 = 0;
          do {
            *(undefined8 *)((long)param_2 + lVar24 + 0x18) = 0;
            *(undefined8 *)((long)param_2 + lVar24 + 0x20) = 0;
            *(undefined8 *)((long)param_2 + lVar24 + 0x30) = 0;
            *(undefined8 *)((long)param_2 + lVar24 + 0x38) = 0;
            *(undefined8 *)((long)param_2 + lVar24 + 0x40) = 0;
            lVar24 = lVar24 + 0x30;
          } while (uVar10 * 0x30 != lVar24);
          uVar19 = *param_4;
        }
        *param_2 = 0;
        param_2[1] = 0;
        if ((ulong)(uVar1 * uVar3) <= uVar19 - uVar16) {
          if (uVar2 != 0) {
            uVar16 = 0;
            do {
              if (*(int *)(this + 0x644) != 0) break;
              uVar19 = *(ulong *)(param_1 + uVar16 * 2 + 2);
              lVar24 = uVar16 * 0x90;
              *(int *)(this + lVar24 + 0x6f4) = (int)uVar19;
              if ((((byte)this[lVar24 + 0x750] & 1) != 0) &&
                 (lVar4 = *(long *)(this + lVar24 + 0x708), lVar4 != 0)) {
                lVar25 = lVar4;
                iVar21 = -1;
                do {
                  iVar20 = iVar21;
                  lVar25 = *(long *)(lVar25 + 0xe0);
                  iVar21 = iVar20 + 1;
                } while (lVar25 != 0);
                if (iVar21 != -1) {
                  if (iVar21 == 0) {
                    if (*(ulong *)(lVar4 + 200) < uVar19) {
                      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                        "%s: bytes_to_validate is too large\n",
                                        "IOReturn IOAccelContext2::submit_data_buffers(sIOAccelContextSubmitDataBuffersIn *, sIOAccelContextSubmitDataBuffersOut *, IOByteCount, IOByteCount *)"
                                       );
                    }
                    else {
                      cVar7 = (**(code **)(*(long *)this + 0xa80))
                                        (this,uVar19,*(undefined8 *)(this + lVar24 + 0x760));
                      if (cVar7 != '\0') {
                        uVar10 = (ulong)*(uint *)(this + 0x6dc);
                        goto LAB_000076d2;
                      }
                      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                        "%s: vendorValidateDataBuffer failed for dbclass %d\n",
                                        "IOReturn IOAccelContext2::submit_data_buffers(sIOAccelContextSubmitDataBuffersIn *, sIOAccelContextSubmitDataBuffersOut *, IOByteCount, IOByteCount *)"
                                       );
                    }
                  }
                  else {
                    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                      "%s: multiple assigned validated buffers. dbclass=%d, assigned_count=%d\n"
                                      ,
                                      "IOReturn IOAccelContext2::submit_data_buffers(sIOAccelContextSubmitDataBuffersIn *, sIOAccelContextSubmitDataBuffersOut *, IOByteCount, IOByteCount *)"
                                      ,uVar16 & 0xffffffff,iVar20 + 2);
                  }
                  *(undefined4 *)(this + 0x644) = 0xffffffff;
                  break;
                }
              }
LAB_000076d2:
              uVar16 = uVar16 + 1;
            } while (uVar16 < uVar10);
          }
          local_38 = param_4;
          if (___ktrace_kernel_enabled != 0) {
            uVar26 = _OSAddAtomic64(1,&___globalObjectIDCounter);
            *(undefined8 *)(this + 0x4e0) = uVar26;
            uVar11 = _OSAddAtomic64(1,&___globalObjectIDCounter);
            *(uintptr_t *)(this + 0x4d8) = uVar11;
            local_40 = *(undefined8 **)(this + 0x4e0);
            uVar8 = (**(code **)(*(long *)this + 0xac8))(this);
            uVar9 = IORegistryEntry::getRegistryEntryID();
            _kernel_debug(0x850200c0,(uintptr_t)local_40,uVar11,0,CONCAT44(uVar8,uVar9),0);
            uVar11 = *(uintptr_t *)(this + 0x4e0);
            uVar12 = IORegistryEntry::getRegistryEntryID();
            _kernel_debug(0x85120048,uVar11,0,0,uVar12,0);
            if (___ktrace_kernel_enabled != 0) {
              uVar11 = *(uintptr_t *)(this + 0x4d8);
              uVar12 = *(uintptr_t *)(this + 0x4e0);
              uVar13 = IORegistryEntry::getRegistryEntryID();
              _kernel_debug(0x85120044,uVar11,uVar12,0,uVar13,0);
            }
          }
          pIVar5 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
          _OSIncrementAtomic(pIVar5 + 0x90);
          _IOLockLock(*(undefined8 *)(pIVar5 + 0x88));
          _OSDecrementAtomic(pIVar5 + 0x90);
          IOGraphicsAccelerator2::lock_busy(pIVar5);
          (**(code **)(*(long *)pIVar5 + 0x850))(pIVar5,"",0);
          plVar14 = (long *)(**(code **)(**(long **)(this + 0x5a8) + 0xaa8))();
          puVar17 = local_38;
          *(long **)(this + 0x1080) = plVar14;
          if (plVar14 != (long *)0x0) {
            cVar7 = (**(code **)(*plVar14 + 0x118))(plVar14,*(undefined8 *)(this + 0x5a8),this);
            if (cVar7 == '\0') {
              if (*(long **)(this + 0x1080) != (long *)0x0) {
                (**(code **)(**(long **)(this + 0x1080) + 0x28))();
              }
              *(undefined8 *)(this + 0x1080) = 0;
            }
            else {
              (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b0))
                        (*(long **)(*(long *)(this + 0x5a8) + 0x380),this + 0x5d0,
                         *(long *)(this + 0x1080) + 0x28);
            }
          }
          cVar7 = (**(code **)(*(long *)this + 0xab8))(this);
          if (cVar7 == '\0') {
            uVar1 = *(uint *)(this + 0x580);
            uVar11 = *(uintptr_t *)(this + 0x4e0);
            uVar12 = IORegistryEntry::getRegistryEntryID();
            _kernel_debug(0x85020080,(ulong)uVar1,uVar11,0,uVar12,0);
            do {
              pIVar5 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
              (**(code **)(*(long *)pIVar5 + 0x858))(pIVar5,"",0);
              IOGraphicsAccelerator2::unlock_busy(pIVar5);
              _IOLockUnlock(*(undefined8 *)(pIVar5 + 0x88));
              (**(code **)(*(long *)this + 0xac0))(this);
              pIVar5 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
              _OSIncrementAtomic(pIVar5 + 0x90);
              _IOLockLock(*(undefined8 *)(pIVar5 + 0x88));
              _OSDecrementAtomic(pIVar5 + 0x90);
              IOGraphicsAccelerator2::lock_busy(pIVar5);
              (**(code **)(*(long *)pIVar5 + 0x850))(pIVar5,"",0);
              cVar7 = (**(code **)(*(long *)this + 0xab8))(this);
            } while (cVar7 == '\0');
            uVar1 = *(uint *)(this + 0x580);
            uVar11 = *(uintptr_t *)(this + 0x4e0);
            uVar12 = IORegistryEntry::getRegistryEntryID();
            _kernel_debug(0x85020084,(ulong)uVar1,uVar11,0,uVar12,0);
            puVar17 = local_38;
          }
          if (this[0x570] == (IOAccelContext2)0x0) {
            local_54 = 0;
            if (*(int *)(this + 0x644) == 0) {
              local_54 = (**(code **)(*(long *)this + 0xa28))(this,(ulong)local_48 & 0xffffffff);
            }
          }
          else {
            this[0x570] = (IOAccelContext2)0x0;
            local_54 = 0;
          }
          uVar1 = *(uint *)(this + 0x6dc);
          *puVar17 = (ulong)uVar1 * 0x30 + (ulong)(uVar1 * (int)local_50) + 0x18;
          if ((ulong)uVar1 == 0) {
            uVar16 = 0;
          }
          else {
            uVar16 = 0;
            local_40 = param_2;
            do {
              puVar17 = *(ulong **)(param_1 + uVar16 * 2 + 2);
              lVar24 = uVar16 * 0x90;
              puVar15 = *(ulong **)(this + lVar24 + 0x6e0);
              if (*(IOAccelResource2 **)(this + lVar24 + 0x708) == (IOAccelResource2 *)0x0) {
                if (puVar15 < puVar17 + 0x400) goto LAB_00007c44;
LAB_00007c59:
                *(undefined4 *)(this + lVar24 + 0x740) = 0;
              }
              else {
                iVar21 = 1;
                this_00 = *(IOAccelResource2 **)(this + lVar24 + 0x708);
                local_48 = puVar15;
                local_38 = puVar17;
                do {
                  pIVar6 = *(IOAccelResource2 **)(this_00 + 0xe0);
                  if (pIVar6 == (IOAccelResource2 *)0x0) {
                    if ((IOAccelResource2 *)**(long **)(this_00 + 0xe8) != this_00) {
LAB_00007f2c:
                      pcVar22 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_00007f3c:
                    // WARNING: Subroutine does not return
                      _panic(pcVar22,this_00,0x637,"IOAccelContext.cpp",0x637);
                    }
                    *(long **)(this + lVar24 + 0x710) = *(long **)(this_00 + 0xe8);
                  }
                  else {
                    if (*(IOAccelResource2 **)(pIVar6 + 0xe8) != this_00 + 0xe0) {
                      pcVar22 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
                      goto LAB_00007f3c;
                    }
                    if ((IOAccelResource2 *)**(long **)(this_00 + 0xe8) != this_00)
                    goto LAB_00007f2c;
                    *(long **)(pIVar6 + 0xe8) = *(long **)(this_00 + 0xe8);
                  }
                  **(undefined8 **)(this_00 + 0xe8) = *(undefined8 *)(this_00 + 0xe0);
                  *(undefined8 *)(this_00 + 0xe0) = 0;
                  *(undefined8 *)(this_00 + 0xe8) = *(undefined8 *)(this + lVar24 + 0x720);
                  **(undefined8 **)(this + lVar24 + 0x720) = this_00;
                  *(IOAccelResource2 **)(this + lVar24 + 0x720) = this_00 + 0xe0;
                  IOAccelResource2::setPurgeable(this_00,1,3,(uint *)0x0);
                  iVar21 = iVar21 + -1;
                  this_00 = pIVar6;
                } while (pIVar6 != (IOAccelResource2 *)0x0);
                puVar15 = local_48;
                puVar17 = local_38;
                if (local_48 < local_38 + 0x400) {
LAB_00007c44:
                  if (puVar15 < *(ulong **)(this + lVar24 + 0x700)) {
                    update_data_buffer_desired_size(this,uVar16 & 0xffffffff,(long)puVar17);
                  }
                  goto LAB_00007c59;
                }
                if (iVar21 != 0) goto LAB_00007c59;
                pIVar18 = this + lVar24 + 0x740;
                if (local_38 < *(ulong **)(this + lVar24 + 0x6e8)) {
                  if (*(int *)pIVar18 == 0) {
                    *(int *)pIVar18 = *(int *)(*(long *)(this + 0x5a8) + 0xbc);
                    *(ulong **)(this + lVar24 + 0x748) = local_38;
                  }
                  else {
                    puVar17 = *(ulong **)(this + lVar24 + 0x748);
                    if (*(ulong **)(this + lVar24 + 0x748) < local_38) {
                      *(ulong **)(this + lVar24 + 0x748) = local_38;
                      puVar17 = local_38;
                    }
                    if ((*(int *)pIVar18 - *(int *)(*(long *)(this + 0x5a8) + 0xbc)) + 0xf0 < 0) {
                      update_data_buffer_desired_size(this,uVar16 & 0xffffffff,(long)puVar17);
                      goto LAB_00007c30;
                    }
                  }
                }
                else {
LAB_00007c30:
                  *(int *)pIVar18 = 0;
                }
              }
              param_2 = local_40;
              local_5c = *(undefined4 *)(this + lVar24 + 0x6e0);
              local_60 = (int)uVar16;
              iVar21 = (**(code **)(*(long *)this + 0xa68))
                                 (this,&local_60,local_40 + uVar16 * 6 + 3,
                                  (long)local_40 +
                                  (ulong)(uint)((int)local_50 * (int)uVar16) +
                                  (ulong)*(uint *)(this + 0x6dc) * 0x30 + 0x18);
              if (iVar21 != 0) {
                __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                  "%s: failed to get initial data buffer for class %d\n",
                                  "IOReturn IOAccelContext2::submit_data_buffers(sIOAccelContextSubmitDataBuffersIn *, sIOAccelContextSubmitDataBuffersOut *, IOByteCount, IOByteCount *)"
                                 );
                *(undefined4 *)(this + 0x644) = 0xfffffffa;
                break;
              }
              uVar16 = uVar16 + 1;
            } while (uVar16 < *(uint *)(this + 0x6dc));
          }
          if (*(long *)(this + 0x620) != 0) {
            (**(code **)(*(long *)this + 0xa00))
                      (this,*(long *)(this + 0x620),*(undefined4 *)(this + 0x6b8),
                       *(undefined4 *)(this + 0x6bc));
          }
          *(int *)param_2 = (int)uVar16;
          *(undefined4 *)((long)param_2 + 4) = *(undefined4 *)(this + 0x644);
          *(uint *)(param_2 + 1) = local_54;
          if (*(int *)(*(long *)(this + 0x5a8) + 0xdc8) == 0) {
            *(uint *)(param_2 + 1) = local_54 | *(uint *)(this + 0x638);
          }
          *(undefined4 *)((long)param_2 + 0xc) = *(undefined4 *)(this + 0x648);
          if (*(IOAccelSurface **)(this + 0x5c0) == (IOAccelSurface *)0x0) {
            uVar8 = 0;
          }
          else {
            uVar8 = IOAccelSurface::getFrontBufferResourceId(*(IOAccelSurface **)(this + 0x5c0));
          }
          *(undefined4 *)(param_2 + 2) = uVar8;
          *(undefined8 *)(this + 0x644) = 0;
          pIVar18 = this + 0x638;
          *(uint *)pIVar18 = *(uint *)pIVar18 & 0x8000000;
          if (((*(uint *)pIVar18 == 0) && (*(int *)(this + 0x63c) != 0)) &&
             (iVar21 = *(int *)(this + 0x640), *(uint *)(this + 0x640) = iVar21 + 1U,
             999 < iVar21 + 1U)) {
            *(undefined8 *)(this + 0x63c) = 0;
          }
          uVar26 = 0;
          _kernel_debug(0x8502000c,*(uintptr_t *)(this + 0x4d8),*(uintptr_t *)(this + 0x4e0),0,
                        (ulong)*(uint *)(this + 0x580),0);
          uVar11 = *(uintptr_t *)(this + 0x4d8);
          uVar12 = *(uintptr_t *)(this + 0x4e0);
          uVar13 = IORegistryEntry::getRegistryEntryID();
          _kernel_debug(0x850200c4,uVar11,uVar12,0,uVar13,0);
          _kernel_debug(0x85020004,*(uintptr_t *)(this + 0x4e0),0,(ulong)*(uint *)(this + 0x580),0,0
                       );
          uVar11 = *(uintptr_t *)(this + 0x4e0);
          uVar12 = IORegistryEntry::getRegistryEntryID();
          _kernel_debug(0x8512004c,uVar11,0,0,uVar12,0);
          IOAccelSubmitter2::updateLastSubmissionTime((IOAccelSubmitter2 *)this);
          if (*(long *)(this + 0x1080) != 0) {
            (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b0))
                      (*(long **)(*(long *)(this + 0x5a8) + 0x380),this + 0x5d0,
                       *(long *)(this + 0x1080) + 0x68);
            IOAccelFenceMachine::addEventFence
                      (*(IOAccelFenceMachine **)(*(long *)(this + 0x5a8) + 0x390),(long)this,
                       *(long *)(this + 0x1080));
            *(undefined8 *)(this + 0x1080) = 0;
          }
          pIVar5 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
          (**(code **)(*(long *)pIVar5 + 0x858))(pIVar5,"",0);
          IOGraphicsAccelerator2::unlock_busy(pIVar5);
          _IOLockUnlock(*(undefined8 *)(pIVar5 + 0x88));
        }
      }
    }
  }
  return uVar26;
}



// IOAccelContext2::get_data_buffer(IOAccelContextGetDataBufferIn*, IOAccelContextGetDataBufferOut*,
// unsigned long long, unsigned long long*)

undefined4 __thiscall
IOAccelContext2::get_data_buffer
          (IOAccelContext2 *this,undefined8 param_1,long param_2,ulong param_3,ulong *param_4)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined4 uVar2;
  long lVar3;
  
  if (*(long *)(this + 0x5a0) == 0) {
    uVar2 = 0xe00002bc;
  }
  else {
    uVar2 = 0xe00002c2;
    if ((7 < param_3) && (0x2f < *param_4)) {
      pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
      _OSIncrementAtomic(pIVar1 + 0x90);
      _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
      _OSDecrementAtomic(pIVar1 + 0x90);
      IOGraphicsAccelerator2::lock_busy(pIVar1);
      (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
      uVar2 = IOGraphicsAccelerator2::acceleratorWaitEnabled
                        (*(IOGraphicsAccelerator2 **)(this + 0x5a8));
      if ((char)uVar2 == '\0') {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: %s device terminated\n",
                          "IOReturn IOAccelContext2::get_data_buffer(sIOAccelContextGetDataBufferIn *, sIOAccelContextGetDataBufferOut *, IOByteCount, IOByteCount *)"
                          ,*(undefined8 *)(*(long *)(this + 0x5a8) + 0xc88));
        uVar2 = 0xe00002c0;
      }
      else {
        lVar3 = 0;
        if (*param_4 != 0x30) {
          lVar3 = param_2 + 0x30;
        }
        uVar2 = (**(code **)(*(long *)this + 0xa68))(this,param_1,param_2,lVar3);
      }
      pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
      (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar1);
      _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
    }
  }
  return uVar2;
}



// IOAccelContext2::reclaim_resources()

undefined8 __thiscall IOAccelContext2::reclaim_resources(IOAccelContext2 *this)

{
  IOGraphicsAccelerator2 *pIVar1;
  IOAccelResource2 *pIVar2;
  uint uVar3;
  undefined8 uVar4;
  long lVar5;
  char *pcVar6;
  ulong uVar7;
  IOAccelResource2 *this_00;
  
  if (*(long *)(this + 0x5a0) == 0) {
    uVar4 = 0xe00002c2;
  }
  else {
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    uVar3 = *(uint *)(this + 0x6dc);
    if (uVar3 != 0) {
      uVar7 = 0;
      do {
        lVar5 = uVar7 * 0x90;
        *(undefined8 *)(this + lVar5 + 0x6e0) = *(undefined8 *)(this + lVar5 + 0x6f8);
        if (*(IOAccelResource2 **)(this + lVar5 + 0x718) != (IOAccelResource2 *)0x0) {
          this_00 = *(IOAccelResource2 **)(this + lVar5 + 0x718);
          do {
            pIVar2 = *(IOAccelResource2 **)(this_00 + 0xe0);
            if (pIVar2 == (IOAccelResource2 *)0x0) {
              if ((IOAccelResource2 *)**(long **)(this_00 + 0xe8) != this_00) {
LAB_0000824c:
                pcVar6 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_0000825c:
                    // WARNING: Subroutine does not return
                _panic(pcVar6,this_00,0x942,"IOAccelContext.cpp",0x942);
              }
              *(long **)(this + lVar5 + 0x720) = *(long **)(this_00 + 0xe8);
            }
            else {
              if (*(IOAccelResource2 **)(pIVar2 + 0xe8) != this_00 + 0xe0) {
                pcVar6 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
                goto LAB_0000825c;
              }
              if ((IOAccelResource2 *)**(long **)(this_00 + 0xe8) != this_00) goto LAB_0000824c;
              *(long **)(pIVar2 + 0xe8) = *(long **)(this_00 + 0xe8);
            }
            **(undefined8 **)(this_00 + 0xe8) = *(undefined8 *)(this_00 + 0xe0);
            *(int *)(this + (ulong)*(uint *)(this_00 + 0xf0) * 0x90 + 0x728) =
                 *(int *)(this + (ulong)*(uint *)(this_00 + 0xf0) * 0x90 + 0x728) + -1;
            *(undefined4 *)(*(long *)(this_00 + 0x30) + 0x18) = 0;
            IOAccelResource2::databuffer_release(this_00,*(IOAccelShared2 **)(this + 0x5a0));
            (**(code **)(*(long *)this_00 + 0x28))(this_00);
            this_00 = pIVar2;
          } while (pIVar2 != (IOAccelResource2 *)0x0);
          uVar3 = *(uint *)(this + 0x6dc);
        }
        uVar7 = uVar7 + 1;
      } while (uVar7 < uVar3);
    }
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
    uVar4 = 0;
  }
  return uVar4;
}



// IOAccelContext2::finish_fence_event(unsigned int)

ulong __thiscall IOAccelContext2::finish_fence_event(IOAccelContext2 *this,uint param_1)

{
  int *piVar1;
  IOGraphicsAccelerator2 *pIVar2;
  long lVar3;
  int iVar4;
  uint uVar5;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  _OSIncrementAtomic(pIVar2 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar2 + 0x88));
  _OSDecrementAtomic(pIVar2 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar2);
  (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
  if (*(long *)(this + 0x6a8) == 0) {
    pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
    (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar2);
    _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
    uVar5 = 0xe00002c7;
  }
  else if (param_1 < *(uint *)(this + 0x6d8) >> 6) {
    local_30 = &DAT_aaaaaaaaaaaaaaaa;
    local_38 = &DAT_aaaaaaaaaaaaaaaa;
    local_40 = &DAT_aaaaaaaaaaaaaaaa;
    local_48 = &DAT_aaaaaaaaaaaaaaaa;
    local_50 = &DAT_aaaaaaaaaaaaaaaa;
    local_58 = &DAT_aaaaaaaaaaaaaaaa;
    local_60 = &DAT_aaaaaaaaaaaaaaaa;
    local_68 = &DAT_aaaaaaaaaaaaaaaa;
    (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b0))
              (*(long **)(*(long *)(this + 0x5a8) + 0x380),
               *(long *)(this + 0x6a8) + (ulong)param_1 * 0x40,&local_68);
    pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
    uVar5 = 0;
    (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar2);
    _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
    iVar4 = (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x178))
                      (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_68);
    if (iVar4 == -1) {
      uVar5 = 0xe00002d6;
    }
    else {
      lVar3 = *(long *)(this + 0x5a8);
      IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar3 + 0x388) + 0x58),0x2d);
      piVar1 = (int *)(lVar3 + 0x254);
      *piVar1 = *piVar1 + iVar4;
    }
  }
  else {
    pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
    (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar2);
    _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
    uVar5 = 0xe00002c2;
  }
  return (ulong)uVar5;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelContext2::set_background_rendering(unsigned int)

undefined8 __cdecl IOAccelContext2::set_background_rendering(long param_1)

{
  *(undefined1 *)(param_1 + 0x591) = 1;
  return 0;
}



// IOAccelContext2::init(OSDictionary*, task*)

undefined4 __thiscall
IOAccelContext2::init(IOAccelContext2 *this,undefined8 param_2_00,undefined8 param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  long lVar3;
  
  uVar1 = IOUserClient::init((OSDictionary *)this);
  if ((char)uVar1 != '\0') {
    _task_reference(param_2);
    *(undefined8 *)(this + 0x578) = param_2;
    lVar3 = _get_bsdtask_info(param_2);
    if (lVar3 == 0) {
      uVar2 = 0xffffffff;
    }
    else {
      uVar2 = _proc_pid(lVar3);
    }
    *(undefined4 *)(this + 0x580) = uVar2;
  }
  return uVar1;
}



// IOAccelContext2::attach(IOService*)

undefined8 __thiscall IOAccelContext2::attach(IOAccelContext2 *this,OSMetaClassBase *param_1)

{
  char cVar1;
  long lVar2;
  
  cVar1 = IOService::attach((IOService *)this);
  if (cVar1 != '\0') {
    lVar2 = OSMetaClassBase::safeMetaCast
                      (param_1,(OSMetaClass *)&IOGraphicsAccelerator2::gMetaClass);
    *(long *)(this + 0x5a8) = lVar2;
    if (lVar2 != 0) {
      return CONCAT71((int7)((ulong)lVar2 >> 8),1);
    }
  }
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelContext2::start(IOService*)

bool __cdecl IOAccelContext2::start(long *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined1 uVar2;
  undefined4 uVar3;
  bool bVar4;
  
  uVar3 = IOAccelSubmitter2::start(param_1);
  if ((char)uVar3 == '\0') {
    bVar4 = false;
  }
  else {
    pIVar1 = (IOGraphicsAccelerator2 *)param_1[0xb5];
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    uVar2 = (**(code **)(*param_1 + 0x9e0))(param_1);
    *(undefined1 *)(param_1 + 0xd3) = uVar2;
    pIVar1 = (IOGraphicsAccelerator2 *)param_1[0xb5];
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
    bVar4 = (char)param_1[0xd3] != '\0';
  }
  return bVar4;
}



// IOGraphicsAccelerator2::acceleratorLock()

void __thiscall IOGraphicsAccelerator2::acceleratorLock(IOGraphicsAccelerator2 *this)

{
  _OSIncrementAtomic(this + 0x90);
  _IOLockLock(*(undefined8 *)(this + 0x88));
  _OSDecrementAtomic(this + 0x90);
  lock_busy(this);
                    // WARNING: Could not recover jumptable at 0x0000861f. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x850))(this,"",0);
  return;
}



// IOGraphicsAccelerator2::acceleratorUnlock()

void __thiscall IOGraphicsAccelerator2::acceleratorUnlock(IOGraphicsAccelerator2 *this)

{
  (**(code **)(*(long *)this + 0x858))(this,"",0);
  unlock_busy(this);
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  return;
}



// IOAccelContext2::stopLocked()

void __thiscall IOAccelContext2::stopLocked(IOAccelContext2 *this)

{
  (**(code **)(*(long *)this + 0x9e8))();
  this[0x698] = (IOAccelContext2)0x0;
  IOAccelSubmitter2::stop((long)this);
  (**(code **)(*(long *)this + 0x678))(this,*(undefined8 *)(this + 0x5a8));
                    // WARNING: Could not recover jumptable at 0x000086a7. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x28))(this);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelContext2::stop(IOService*)

void __cdecl IOAccelContext2::stop(long *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  
  pIVar1 = (IOGraphicsAccelerator2 *)param_1[0xb5];
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  (**(code **)(*param_1 + 0x9e8))(param_1);
  *(undefined1 *)(param_1 + 0xd3) = 0;
  IOAccelSubmitter2::stop((long)param_1);
  (**(code **)(*param_1 + 0x678))(param_1,param_1[0xb5]);
  (**(code **)(*param_1 + 0x28))(param_1);
  pIVar1 = (IOGraphicsAccelerator2 *)param_1[0xb5];
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return;
}



// IOAccelContext2::clientClose()

undefined8 __thiscall IOAccelContext2::clientClose(IOAccelContext2 *this)

{
  if (this[0x698] == (IOAccelContext2)0x0) {
    if (*(long *)(this + 0x5a8) != 0) {
      (**(code **)(*(long *)this + 0x678))();
    }
  }
  else {
    (**(code **)(*(long *)this + 0x600))(this,0);
  }
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelContext2::finalize(unsigned int)

void __cdecl IOAccelContext2::finalize(long *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  char cVar2;
  OSSet *pOVar3;
  
  if (param_1[0xb4] != 0) {
    cVar2 = IOService::isInactive();
    if (cVar2 != '\0') {
      pIVar1 = (IOGraphicsAccelerator2 *)param_1[0xb5];
      _OSIncrementAtomic(pIVar1 + 0x90);
      _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
      _OSDecrementAtomic(pIVar1 + 0x90);
      IOGraphicsAccelerator2::lock_busy(pIVar1);
      (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
      pOVar3 = (OSSet *)OSSet::withCapacity(1);
      (**(code **)(*param_1 + 0x990))(param_1,pOVar3);
      IOAccelShared2::add_orphaned_mappings((IOAccelShared2 *)param_1[0xb4],pOVar3);
      (**(code **)(*(long *)pOVar3 + 0x28))(pOVar3);
      pIVar1 = (IOGraphicsAccelerator2 *)param_1[0xb5];
      (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar1);
      _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
    }
  }
  IOService::finalize((uint)param_1);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelContext2::orphanClientMappings(OSSet*)

void __cdecl IOAccelContext2::orphanClientMappings(long param_1)

{
                    // WARNING: Could not recover jumptable at 0x000088c4. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(param_1 + 0x5a0) + 0x130))();
  return;
}



// IOAccelContext2::contextStart()

undefined8 __thiscall IOAccelContext2::contextStart(IOAccelContext2 *this)

{
  int iVar1;
  uint uVar2;
  long lVar3;
  IOAccelContext2 IVar4;
  long lVar5;
  ulong uVar6;
  IOAccelContext2 *pIVar7;
  long *plVar9;
  uint local_320 [2];
  undefined4 auStack_318 [2];
  undefined8 auStack_310 [3];
  uint auStack_2f8 [184];
  undefined8 uVar8;
  
  *(undefined8 *)(this + 0x6b0) = 0;
  *(undefined8 *)(this + 0x620) = 0;
  *(undefined8 *)(this + 0x628) = 0;
  *(undefined8 *)(this + 0x5c0) = 0;
  *(undefined8 *)(this + 0x618) = 0;
  *(undefined8 *)(this + 0x568) = 0;
  *(undefined8 *)(this + 0x6c0) = 0;
  *(undefined4 *)(this + 0x6c8) = 0;
  *(undefined8 *)(this + 0x6a0) = 0;
  *(undefined8 *)(this + 0x6d0) = 0;
  *(undefined4 *)(this + 0x6d8) = 0;
  *(undefined8 *)(this + 0x6a8) = 0;
  *(undefined8 *)(this + 0x630) = 0;
  *(undefined8 *)(this + 0x610) = 0;
  *(undefined8 *)(this + 0x1080) = 0;
  (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x140))
            (*(long **)(*(long *)(this + 0x5a8) + 0x380),this + 0x5d0);
  IOAccelContextList::addContext((IOAccelContextList *)(*(long *)(this + 0x5a8) + 0xa58),(long)this)
  ;
  lVar5 = _IOMallocTypeImpl(&contextStart()::kalloc_type_view_228);
  if (lVar5 != 0) {
    lVar3 = *(long *)(this + 0x5a8);
    *(undefined4 *)(lVar5 + 4) = *(undefined4 *)(lVar3 + 0xcbc);
    *(undefined4 *)(lVar5 + 8) = *(undefined4 *)(lVar3 + 0xcc0);
    *(long *)(this + 0x5b0) = lVar5;
    (**(code **)(*(long *)this + 0xa88))(this,lVar5);
    *(undefined4 *)(this + 0x648) = 0;
    *(undefined8 *)(this + 0x638) = 0;
    *(undefined8 *)(this + 0x640) = 0;
    this[0x570] = (IOAccelContext2)0x1;
    lVar5 = (**(code **)(**(long **)(this + 0x5a8) + 0x8d8))();
    *(long *)(this + 0x618) = lVar5;
    if (lVar5 == 0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Failed to allocate command descriptor\n",
                        "virtual bool IOAccelContext2::contextStart()");
    }
    else {
      *(IOAccelContext2 **)(lVar5 + 0x10) = this;
      if (*(long *)(this + 0x5a0) != 0) {
        *(undefined8 *)(lVar5 + 8) = *(undefined8 *)(*(long *)(this + 0x5a0) + 0x88);
      }
      if ((ulong)**(uint **)(this + 0x5b0) != 0) {
        lVar5 = _IOMallocTypeVarImpl
                          (&contextStart()::kalloc_type_view_259,
                           (ulong)**(uint **)(this + 0x5b0) << 3);
        *(long *)(this + 0x5b8) = lVar5;
        if (lVar5 == 0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: Failed to allocate current texture array\n",
                            "virtual bool IOAccelContext2::contextStart()");
          goto LAB_00008cd4;
        }
      }
      lVar5 = 0x1fc;
      do {
        *(undefined8 *)(this + lVar5 * 8) = 0;
        lVar5 = lVar5 + 1;
      } while (lVar5 != 0x20c);
      uVar6 = IOGraphicsAccelerator2::find_vram_descriptor
                        (*(IOGraphicsAccelerator2 **)(this + 0x5a8));
      if (((char)uVar6 != '\0') || ((*(byte *)(*(long *)(this + 0x5a8) + 0xc93) & 2) != 0)) {
        ___bzero(this + 0x6e0,0x900);
        _memset(local_320,0xaa,0x308);
        (**(code **)(*(long *)this + 0x9f0))(local_320,this);
        *(uint *)(this + 0x6dc) = local_320[0];
        if ((ulong)local_320[0] != 0) {
          pIVar7 = this + 0x75c;
          lVar5 = 0;
          do {
            *(undefined8 *)(pIVar7 + -0x54) = 0;
            *(IOAccelContext2 **)(pIVar7 + -0x4c) = pIVar7 + -0x54;
            *(undefined8 *)(pIVar7 + -0x44) = 0;
            *(IOAccelContext2 **)(pIVar7 + -0x3c) = pIVar7 + -0x44;
            uVar8 = *(undefined8 *)((long)auStack_310 + lVar5);
            *(undefined8 *)(pIVar7 + -100) = uVar8;
            *(undefined8 *)(pIVar7 + -0x7c) = uVar8;
            *(undefined8 *)(pIVar7 + -0x74) = 0;
            *(undefined8 *)(pIVar7 + -0x5c) = *(undefined8 *)((long)auStack_310 + lVar5 + 8);
            *(undefined4 *)(pIVar7 + -0x34) = 0;
            *(undefined4 *)(pIVar7 + -0x30) = *(undefined4 *)((long)auStack_318 + lVar5);
            *(undefined4 *)(pIVar7 + -0x2c) = *(undefined4 *)((long)auStack_318 + lVar5 + 4);
            *(undefined8 *)(pIVar7 + -0x24) = *(undefined8 *)((long)auStack_310 + lVar5 + 0x10);
            *(undefined4 *)(pIVar7 + -0xc) = *(undefined4 *)((long)auStack_2f8 + lVar5);
            *(uint *)(pIVar7 + -8) = *(uint *)((long)auStack_2f8 + lVar5 + 4) | 0x10023;
            *(undefined4 *)(pIVar7 + -4) = *(undefined4 *)((long)auStack_2f8 + lVar5 + 8);
            *(undefined4 *)pIVar7 = *(undefined4 *)((long)auStack_2f8 + lVar5 + 0xc);
            pIVar7 = pIVar7 + 0x90;
            lVar5 = lVar5 + 0x30;
          } while ((ulong)local_320[0] * 0x30 != lVar5);
        }
        if (*(IOAccelShared2 **)(this + 0x5a0) == (IOAccelShared2 *)0x0) {
          IVar4 = (IOAccelContext2)0x0;
        }
        else {
          uVar8 = IOAccelShared2::doesEntitlementExist
                            (*(IOAccelShared2 **)(this + 0x5a0),
                             "com.apple.private.allow-explicit-graphics-priority");
          IVar4 = SUB81(uVar8,0);
        }
        this[0x590] = IVar4;
        this[0x591] = (IOAccelContext2)0x1;
        *(undefined8 *)(this + 0x588) = 0;
        iVar1 = *(int *)(*(long *)(this + 0x5b0) + 4);
        *(int *)(this + 0x6b8) = iVar1;
        uVar2 = *(uint *)(*(long *)(this + 0x5b0) + 8);
        uVar6 = (ulong)uVar2;
        *(uint *)(this + 0x6bc) = uVar2;
        if (iVar1 != 0) {
          plVar9 = (long *)(**(code **)(**(long **)(this + 0x5a8) + 0x920))
                                     (*(long **)(this + 0x5a8),0x10023,iVar1,
                                      *(undefined8 *)PTR__page_size_0006b108);
          *(long **)(this + 0x6b0) = plVar9;
          if (plVar9 == (long *)0x0) {
            *(undefined4 *)(this + 0x6b8) = 0;
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                              "%s: Failed to allocate fSidebandMemory\n",
                              "virtual bool IOAccelContext2::contextStart()");
            goto LAB_00008cd4;
          }
          lVar5 = (**(code **)(*plVar9 + 0x2e0))(plVar9);
          *(long *)(this + 0x620) = lVar5;
          *(ulong *)(this + 0x628) = (ulong)(*(uint *)(this + 0x6b8) & 0xfffffffc) + lVar5;
          uVar6 = IOGeneralMemoryDescriptor::setOwnership
                            (*(task **)(this + 0x6b0),(int)*(undefined8 *)(this + 0x578),4);
        }
        return CONCAT71((int7)(uVar6 >> 8),1);
      }
    }
  }
LAB_00008cd4:
  contextStop(this);
  return 0;
}



// IOAccelContext2::isExplicitPriorityAllowed()

undefined8 __thiscall IOAccelContext2::isExplicitPriorityAllowed(IOAccelContext2 *this)

{
  undefined8 uVar1;
  
  if (*(IOAccelShared2 **)(this + 0x5a0) != (IOAccelShared2 *)0x0) {
    uVar1 = IOAccelShared2::doesEntitlementExist
                      (*(IOAccelShared2 **)(this + 0x5a0),
                       "com.apple.private.allow-explicit-graphics-priority");
    return uVar1;
  }
  return 0;
}



// IOAccelContext2::isBackgroundRenderingAllowed()

undefined1 IOAccelContext2::isBackgroundRenderingAllowed(void)

{
  return 1;
}



// IOAccelContext2::contextStop()

void __thiscall IOAccelContext2::contextStop(IOAccelContext2 *this)

{
  uint uVar1;
  long *plVar2;
  long lVar3;
  ulong uVar4;
  undefined1 *local_30;
  undefined1 *local_28;
  undefined1 *local_20;
  
  IOAccelFenceMachine::cancelBlockFenceCallback
            (*(IOAccelFenceMachine **)(*(long *)(this + 0x5a8) + 0x390),(long)this);
  if (*(long **)(this + 0x588) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x588) + 0x28))();
    *(undefined8 *)(this + 0x588) = 0;
  }
  lVar3 = *(long *)(this + 0x5b8);
  if (lVar3 != 0) {
    uVar1 = **(uint **)(this + 0x5b0);
    if (uVar1 == 0) {
      uVar1 = 0;
    }
    else {
      uVar4 = 0;
      do {
        plVar2 = *(long **)(*(long *)(this + 0x5b8) + uVar4 * 8);
        if (plVar2 != (long *)0x0) {
          (**(code **)(*plVar2 + 0x28))();
          *(undefined8 *)(*(long *)(this + 0x5b8) + uVar4 * 8) = 0;
          uVar1 = **(uint **)(this + 0x5b0);
        }
        uVar4 = uVar4 + 1;
      } while (uVar4 < uVar1);
      lVar3 = *(long *)(this + 0x5b8);
    }
    *(undefined8 *)(this + 0x5b8) = 0;
    _IOFreeTypeVarImpl(&contextStop()::kalloc_type_view_385,lVar3,(ulong)uVar1 << 3);
    *(undefined8 *)(this + 0x5b8) = 0;
  }
  if (*(long **)(this + 0x6c0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x6c0) + 0x28))();
    *(undefined8 *)(this + 0x6c0) = 0;
    *(undefined8 *)(this + 0x6a0) = 0;
    *(undefined4 *)(this + 0x6c8) = 0;
  }
  if (*(long **)(this + 0x6d0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x6d0) + 0x28))();
    *(undefined8 *)(this + 0x6d0) = 0;
    *(undefined8 *)(this + 0x6a8) = 0;
    *(undefined4 *)(this + 0x6d8) = 0;
  }
  if (*(long **)(this + 0x6b0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x6b0) + 0x28))();
    *(undefined8 *)(this + 0x6b0) = 0;
    *(undefined8 *)(this + 0x620) = 0;
    *(undefined8 *)(this + 0x628) = 0;
  }
  uVar1 = *(uint *)(this + 0x6dc);
  if (uVar1 != 0) {
    uVar4 = 0;
    do {
      if (*(long **)(this + uVar4 * 8 + 0xfe0) != (long *)0x0) {
        (**(code **)(**(long **)(this + uVar4 * 8 + 0xfe0) + 0x28))();
        *(undefined8 *)(this + uVar4 * 8 + 0xfe0) = 0;
        uVar1 = *(uint *)(this + 0x6dc);
      }
      uVar4 = uVar4 + 1;
    } while (uVar4 < uVar1);
  }
  freeAllDataBuffers(this);
  if (*(IOAccelShared2 **)(this + 0x5a0) != (IOAccelShared2 *)0x0) {
    IOAccelShared2::decrement_ctx_refcount(*(IOAccelShared2 **)(this + 0x5a0));
    (**(code **)(**(long **)(this + 0x5a0) + 0x28))();
    *(undefined8 *)(this + 0x5a0) = 0;
  }
  if (*(long **)(this + 0x598) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x598) + 0x28))();
    *(undefined8 *)(this + 0x598) = 0;
  }
  if (*(long *)(this + 0x618) != 0) {
    (**(code **)(**(long **)(this + 0x5a8) + 0x8e0))();
    *(undefined8 *)(this + 0x618) = 0;
  }
  if (*(long *)(this + 0x5b0) != 0) {
    _IOFreeTypeImpl(&contextStop()::kalloc_type_view_449);
    *(undefined8 *)(this + 0x5b0) = 0;
  }
  IOAccelContextList::removeContext
            ((IOAccelContextList *)(*(long *)(this + 0x5a8) + 0xa58),(long)this);
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  local_20 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelChannelList::Iterator::Iterator
            ((Iterator *)&local_30,(undefined8 *)(*(long *)(this + 0x5a8) + 0xc38));
  plVar2 = (long *)IOAccelChannelList::Iterator::getNextChannel((Iterator *)&local_30);
  if (plVar2 != (long *)0x0) {
    do {
      (**(code **)(*plVar2 + 0x168))(plVar2,this);
      plVar2 = (long *)IOAccelChannelList::Iterator::getNextChannel((Iterator *)&local_30);
    } while (plVar2 != (long *)0x0);
  }
  return;
}



// IOAccelContext2::freeAllDataBuffers()

void __thiscall IOAccelContext2::freeAllDataBuffers(IOAccelContext2 *this)

{
  IOAccelResource2 *pIVar1;
  ulong uVar2;
  undefined8 uVar3;
  IOAccelResource2 *this_00;
  char *pcVar4;
  undefined8 uVar5;
  long lVar6;
  
  if (*(int *)(this + 0x6dc) != 0) {
    uVar2 = 0;
    do {
      lVar6 = uVar2 * 0x90;
      *(undefined8 *)(this + lVar6 + 0x6e0) = *(undefined8 *)(this + lVar6 + 0x6f8);
      if (*(IOAccelResource2 **)(this + lVar6 + 0x718) != (IOAccelResource2 *)0x0) {
        this_00 = *(IOAccelResource2 **)(this + lVar6 + 0x718);
        do {
          pIVar1 = *(IOAccelResource2 **)(this_00 + 0xe0);
          if (pIVar1 == (IOAccelResource2 *)0x0) {
            if ((IOAccelResource2 *)**(long **)(this_00 + 0xe8) != this_00) {
LAB_000091cd:
              pcVar4 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
              goto LAB_000091e6;
            }
            *(long **)(this + lVar6 + 0x720) = *(long **)(this_00 + 0xe8);
          }
          else {
            if (*(IOAccelResource2 **)(pIVar1 + 0xe8) != this_00 + 0xe0) {
              pcVar4 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
LAB_000091e6:
              uVar3 = 0x8ca;
              uVar5 = 0x8ca;
              goto LAB_00009219;
            }
            if ((IOAccelResource2 *)**(long **)(this_00 + 0xe8) != this_00) goto LAB_000091cd;
            *(long **)(pIVar1 + 0xe8) = *(long **)(this_00 + 0xe8);
          }
          **(undefined8 **)(this_00 + 0xe8) = *(undefined8 *)(this_00 + 0xe0);
          *(int *)(this + (ulong)*(uint *)(this_00 + 0xf0) * 0x90 + 0x728) =
               *(int *)(this + (ulong)*(uint *)(this_00 + 0xf0) * 0x90 + 0x728) + -1;
          *(undefined4 *)(*(long *)(this_00 + 0x30) + 0x18) = 0;
          IOAccelResource2::databuffer_release(this_00,*(IOAccelShared2 **)(this + 0x5a0));
          (**(code **)(*(long *)this_00 + 0x28))(this_00);
          this_00 = pIVar1;
        } while (pIVar1 != (IOAccelResource2 *)0x0);
      }
      if (*(IOAccelResource2 **)(this + lVar6 + 0x708) != (IOAccelResource2 *)0x0) {
        this_00 = *(IOAccelResource2 **)(this + lVar6 + 0x708);
        do {
          pIVar1 = *(IOAccelResource2 **)(this_00 + 0xe0);
          if (pIVar1 == (IOAccelResource2 *)0x0) {
            if ((IOAccelResource2 *)**(long **)(this_00 + 0xe8) != this_00) {
LAB_000091d6:
              pcVar4 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_00009204:
              uVar3 = 0x8d0;
              uVar5 = 0x8d0;
LAB_00009219:
                    // WARNING: Subroutine does not return
              _panic(pcVar4,this_00,uVar3,"IOAccelContext.cpp",uVar5);
            }
            *(long **)(this + lVar6 + 0x710) = *(long **)(this_00 + 0xe8);
          }
          else {
            if (*(IOAccelResource2 **)(pIVar1 + 0xe8) != this_00 + 0xe0) {
              pcVar4 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
              goto LAB_00009204;
            }
            if ((IOAccelResource2 *)**(long **)(this_00 + 0xe8) != this_00) goto LAB_000091d6;
            *(long **)(pIVar1 + 0xe8) = *(long **)(this_00 + 0xe8);
          }
          **(undefined8 **)(this_00 + 0xe8) = *(undefined8 *)(this_00 + 0xe0);
          *(int *)(this + (ulong)*(uint *)(this_00 + 0xf0) * 0x90 + 0x728) =
               *(int *)(this + (ulong)*(uint *)(this_00 + 0xf0) * 0x90 + 0x728) + -1;
          *(undefined4 *)(*(long *)(this_00 + 0x30) + 0x18) = 0;
          IOAccelResource2::databuffer_release(this_00,*(IOAccelShared2 **)(this + 0x5a0));
          (**(code **)(*(long *)this_00 + 0x28))(this_00);
          this_00 = pIVar1;
        } while (pIVar1 != (IOAccelResource2 *)0x0);
      }
      if (*(long **)(this + lVar6 + 0x768) != (long *)0x0) {
        (**(code **)(**(long **)(this + lVar6 + 0x768) + 0x28))();
        *(undefined8 *)(this + lVar6 + 0x768) = 0;
      }
      if (*(long **)(this + lVar6 + 0x760) != (long *)0x0) {
        (**(code **)(**(long **)(this + lVar6 + 0x760) + 0x28))();
        *(undefined8 *)(this + lVar6 + 0x760) = 0;
      }
      uVar2 = uVar2 + 1;
    } while (uVar2 < *(uint *)(this + 0x6dc));
  }
  return;
}



// IOAccelContext2::free()

void __thiscall IOAccelContext2::free(IOAccelContext2 *this)

{
  if (*(long *)(this + 0x578) != 0) {
    _task_deallocate();
  }
  IOUserClient::free();
  return;
}



// IOAccelContext2::connectClient(IOUserClient*)

undefined8 __thiscall IOAccelContext2::connectClient(IOAccelContext2 *this,OSMetaClassBase *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  IOAccelShared2 *this_00;
  long *plVar2;
  char cVar3;
  long lVar4;
  long lVar5;
  
  lVar4 = OSMetaClassBase::safeMetaCast
                    (param_1,(OSMetaClass *)&IOAccelSharedUserClient2::gMetaClass);
  if (lVar4 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Received a bogus share device.\n",
                      "virtual IOReturn IOAccelContext2::connectClient(IOUserClient *)");
  }
  else {
    lVar5 = OSMetaClassBase::safeMetaCast
                      ((OSMetaClassBase *)this,(OSMetaClass *)&IOAccel2DContext2::gMetaClass);
    if (lVar5 == 0) {
      pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
      if (pIVar1 != *(IOGraphicsAccelerator2 **)(lVar4 + 0xf8)) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Received a bogus share device.\n",
                          "virtual IOReturn IOAccelContext2::connectClient(IOUserClient *)");
        return 0xe00002c2;
      }
      if (*(long *)(lVar4 + 0xe0) == *(long *)(this + 0x578)) {
        _OSIncrementAtomic(pIVar1 + 0x90);
        _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
        _OSDecrementAtomic(pIVar1 + 0x90);
        IOGraphicsAccelerator2::lock_busy(pIVar1);
        (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
        if (*(long *)(this + 0x5a0) != 0) {
          pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
          (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
          IOGraphicsAccelerator2::unlock_busy(pIVar1);
          _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
          return 0xe00002c2;
        }
        this_00 = *(IOAccelShared2 **)(lVar4 + 0x100);
        *(IOAccelShared2 **)(this + 0x5a0) = this_00;
        IOAccelShared2::increment_ctx_refcount(this_00);
        (**(code **)(**(long **)(this + 0x5a0) + 0x20))();
        plVar2 = *(long **)(*(long *)(this + 0x5a0) + 0x88);
        *(long **)(this + 0x598) = plVar2;
        (**(code **)(*plVar2 + 0x20))();
        if (*(long *)(this + 0x618) != 0) {
          *(undefined8 *)(*(long *)(this + 0x618) + 8) = *(undefined8 *)(this + 0x598);
        }
        IOGraphicsAccelerator2::acceleratorUnlock(*(IOGraphicsAccelerator2 **)(this + 0x5a8));
        cVar3 = (**(code **)(*(long *)this + 0x5c0))(this,*(undefined8 *)(this + 0x5a8));
        if (cVar3 != '\0') {
          (**(code **)(*(long *)this + 0x20))(this);
          return 0;
        }
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Start failed for new context\n",
                          "virtual IOReturn IOAccelContext2::connectClient(IOUserClient *)");
      }
      else {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Shared device belongs to the wrong task.\n",
                          "virtual IOReturn IOAccelContext2::connectClient(IOUserClient *)");
      }
    }
    else {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Trying to connect 2D context to shared user client\n",
                        "virtual IOReturn IOAccelContext2::connectClient(IOUserClient *)");
    }
  }
  return 0xe00002bc;
}



// IOAccelContext2::populateContextConfig(IOAccelContextConfig*)

void IOAccelContext2::populateContextConfig(void)

{
  return;
}



// IOAccelContext2::getTargetAndMethodForIndex(IOService**, unsigned int)

undefined ** __thiscall
IOAccelContext2::getTargetAndMethodForIndex(IOAccelContext2 *this,undefined8 *param_1,uint param_2)

{
  if (param_2 == 2) {
    if ((this[0x570] == (IOAccelContext2)0x0) && (this[0x591] == (IOAccelContext2)0x0)) {
      return &sSubmitDataBuffersForegroundOnlyOverride;
    }
    *param_1 = this;
  }
  else {
    *param_1 = this;
    if (7 < param_2) {
      return (undefined **)0x0;
    }
  }
  return &sContextMethods + (ulong)param_2 * 6;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelContext2::externalMethod(unsigned int, IOExternalMethodArguments*,
// IOExternalMethodDispatch*, OSObject*, void*)

undefined8 __cdecl
IOAccelContext2::externalMethod
          (void *param_1,IOExternalMethodArguments *param_2,IOExternalMethodDispatch *param_3,
          undefined **param_4,void *param_5)

{
  undefined8 uVar1;
  
  if (*(char *)((long)param_1 + 0x698) == '\0') {
    return 0xe00002d8;
  }
  if ((int)param_2 == 6) {
    param_4 = &externalMethod(unsigned_int,IOExternalMethodArguments*,IOExternalMethodDispatch*,OSObject*,void*)
               ::enableBlockFencesDispatch;
    param_5 = param_1;
  }
  uVar1 = IOUserClient::externalMethod((uint)param_1,param_2,param_3,(OSObject *)param_4,param_5);
  return uVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelContext2::s_enable_block_fences(IOAccelContext2*, void*, IOExternalMethodArguments*)

undefined8 __cdecl
IOAccelContext2::s_enable_block_fences(IOAccelContext2 *param_1,undefined8 param_2,long param_3)

{
  undefined8 uVar1;
  
  if (*(long *)(param_3 + 0x10) != 0) {
    uVar1 = enable_block_fences(param_1,*(long *)(param_3 + 0x10));
    return uVar1;
  }
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: asyncReference is NULL!\n",
                    "static IOReturn IOAccelContext2::s_enable_block_fences(IOAccelContext2 *, void *, IOExternalMethodArguments *)"
                   );
  return 0xe00002c2;
}



// IOAccelContext2::clientMemoryForType(unsigned int, unsigned int*, IOMemoryDescriptor**)

undefined8 __thiscall
IOAccelContext2::clientMemoryForType
          (IOAccelContext2 *this,int param_1,int *param_2,undefined8 *param_3)

{
  uint uVar1;
  IOGraphicsAccelerator2 *pIVar2;
  int *piVar3;
  uint uVar4;
  task *ptVar5;
  long lVar6;
  long lVar7;
  undefined8 *puVar8;
  long lVar9;
  ulong uVar10;
  uint uVar11;
  undefined8 uVar12;
  
  if ((*(int *)(this + 0x644) != 0) || (this[0x698] == (IOAccelContext2)0x0)) {
    *param_2 = *(int *)(this + 0x644);
    *param_3 = 0;
    return 0xe00002c2;
  }
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  _OSIncrementAtomic(pIVar2 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar2 + 0x88));
  _OSDecrementAtomic(pIVar2 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar2);
  (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
  if (param_1 == 2) {
    if (*(long *)(this + 0x6d0) == 0) {
      uVar10 = *(ulong *)PTR__page_size_0006b108;
      *(int *)(this + 0x6d8) = (int)uVar10;
      ptVar5 = (task *)(**(code **)(**(long **)(this + 0x5a8) + 0x920))
                                 (*(long **)(this + 0x5a8),0x10023,uVar10 & 0xffffffff);
      *(task **)(this + 0x6d0) = ptVar5;
      if (ptVar5 == (task *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: fAccelerator->createBufferMemoryDescriptorWithOptions failed\n",
                          "virtual IOReturn IOAccelContext2::clientMemoryForType(UInt32, IOOptionBits *, IOMemoryDescriptor **)"
                         );
        goto LAB_00009c8a;
      }
      IOGeneralMemoryDescriptor::setOwnership(ptVar5,(int)*(undefined8 *)(this + 0x578),4);
      uVar12 = (**(code **)(**(long **)(this + 0x6d0) + 0x2e0))();
      *(undefined8 *)(this + 0x6a8) = uVar12;
      uVar4 = *(uint *)(this + 0x6d8);
      if (0x3f < uVar4) {
        uVar10 = 0;
        do {
          (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x140))
                    (*(long **)(*(long *)(this + 0x5a8) + 0x380),*(long *)(this + 0x6a8) + uVar10);
          uVar10 = uVar10 + 0x40;
        } while ((uVar4 & 0xffffffc0) != uVar10);
      }
    }
    else {
      uVar12 = 0xe00002be;
      if (0x3fffffff < *(uint *)(this + 0x6d8)) goto LAB_00009c90;
      uVar4 = *(uint *)(this + 0x6d8) * 2;
      ptVar5 = (task *)(**(code **)(**(long **)(this + 0x5a8) + 0x920))
                                 (*(long **)(this + 0x5a8),0x10023,uVar4,
                                  *(undefined8 *)PTR__page_size_0006b108);
      if (ptVar5 == (task *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: fAccelerator->createBufferMemoryDescriptorWithOptions failed\n",
                          "virtual IOReturn IOAccelContext2::clientMemoryForType(UInt32, IOOptionBits *, IOMemoryDescriptor **)"
                         );
        goto LAB_00009c90;
      }
      IOGeneralMemoryDescriptor::setOwnership(ptVar5,(int)*(undefined8 *)(this + 0x578),4);
      lVar7 = (**(code **)(*(long *)ptVar5 + 0x2e0))(ptVar5);
      uVar11 = 0;
      uVar1 = *(uint *)(this + 0x6d8);
      if (0x3f < uVar1) {
        uVar11 = uVar1 >> 6;
        uVar10 = 0;
        do {
          (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x140))
                    (*(long **)(*(long *)(this + 0x5a8) + 0x380),lVar7 + uVar10);
          (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1a8))
                    (*(long **)(*(long *)(this + 0x5a8) + 0x380),*(long *)(this + 0x6a8) + uVar10,
                     lVar7 + uVar10);
          uVar10 = uVar10 + 0x40;
        } while ((uVar1 & 0xffffffc0) != uVar10);
      }
      if (uVar11 < uVar4 >> 6) {
        lVar9 = (ulong)(uVar4 >> 6) - (ulong)uVar11;
        lVar6 = lVar7 + (ulong)uVar11 * 0x40;
        do {
          (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x140))
                    (*(long **)(*(long *)(this + 0x5a8) + 0x380),lVar6);
          lVar6 = lVar6 + 0x40;
          lVar9 = lVar9 + -1;
        } while (lVar9 != 0);
      }
      (**(code **)(**(long **)(this + 0x6d0) + 0x28))();
      *(task **)(this + 0x6d0) = ptVar5;
      *(uint *)(this + 0x6d8) = uVar4;
      *(long *)(this + 0x6a8) = lVar7;
    }
    (**(code **)(**(long **)(this + 0x6d0) + 0x20))();
    *param_2 = 0x1000;
    uVar12 = *(undefined8 *)(this + 0x6d0);
LAB_00009b1e:
    *param_3 = uVar12;
  }
  else {
    if (param_1 == 1) {
      if (*(long *)(this + 0x6c0) == 0) {
        uVar4 = *(uint *)(this + 0x6d8);
        uVar1 = uVar4 >> 6;
        uVar11 = uVar1 * 0x10 + 0xfff & 0x7ffff000;
        *(uint *)(this + 0x6c8) = uVar11;
        ptVar5 = (task *)(**(code **)(**(long **)(this + 0x5a8) + 0x920))
                                   (*(long **)(this + 0x5a8),0x10023,uVar11,
                                    *(undefined8 *)PTR__page_size_0006b108);
        *(task **)(this + 0x6c0) = ptVar5;
        if (ptVar5 != (task *)0x0) {
          IOGeneralMemoryDescriptor::setOwnership(ptVar5,(int)*(undefined8 *)(this + 0x578),4);
          lVar7 = (**(code **)(**(long **)(this + 0x6c0) + 0x2e0))();
          *(long *)(this + 0x6a0) = lVar7;
          if (0x3f < uVar4) {
            uVar10 = 1;
            if (1 < uVar1) {
              uVar10 = (ulong)uVar1;
            }
            lVar6 = 0;
            do {
              *(undefined4 *)(lVar7 + lVar6) = 0;
              *(undefined8 *)(lVar7 + 8 + lVar6) = 0;
              lVar6 = lVar6 + 0x10;
            } while (uVar10 * 0x10 != lVar6);
          }
          goto LAB_00009b03;
        }
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: fAccelerator->createBufferMemoryDescriptorWithOptions failed\n",
                          "virtual IOReturn IOAccelContext2::clientMemoryForType(UInt32, IOOptionBits *, IOMemoryDescriptor **)"
                         );
      }
      else {
        uVar4 = *(uint *)(this + 0x6c8);
        uVar1 = *(uint *)(this + 0x6d8) >> 6;
        uVar11 = uVar1 * 0x10 + 0xfff & 0x7ffff000;
        ptVar5 = (task *)(**(code **)(**(long **)(this + 0x5a8) + 0x920))
                                   (*(long **)(this + 0x5a8),0x10023,uVar11,
                                    *(undefined8 *)PTR__page_size_0006b108);
        if (ptVar5 != (task *)0x0) {
          IOGeneralMemoryDescriptor::setOwnership(ptVar5,(int)*(undefined8 *)(this + 0x578),4);
          lVar7 = (**(code **)(*(long *)ptVar5 + 0x2e0))();
          uVar10 = 0;
          if (0xf < uVar4) {
            uVar4 = uVar4 >> 4;
            uVar10 = 1;
            if (1 < uVar4) {
              uVar10 = (ulong)uVar4;
            }
            lVar6 = *(long *)(this + 0x6a0);
            lVar9 = 0;
            do {
              *(undefined4 *)(lVar7 + lVar9) = *(undefined4 *)(lVar6 + lVar9);
              *(undefined8 *)(lVar7 + 8 + lVar9) = *(undefined8 *)(lVar6 + 8 + lVar9);
              lVar9 = lVar9 + 0x10;
            } while (uVar10 << 4 != lVar9);
          }
          if ((uint)uVar10 < uVar1) {
            lVar6 = uVar1 - uVar10;
            puVar8 = (undefined8 *)(uVar10 * 0x10 + lVar7 + 8);
            do {
              *(undefined4 *)(puVar8 + -1) = 0;
              *puVar8 = 0;
              puVar8 = puVar8 + 2;
              lVar6 = lVar6 + -1;
            } while (lVar6 != 0);
          }
          (**(code **)(**(long **)(this + 0x6c0) + 0x28))();
          *(task **)(this + 0x6c0) = ptVar5;
          *(uint *)(this + 0x6c8) = uVar11;
          *(long *)(this + 0x6a0) = lVar7;
LAB_00009b03:
          (**(code **)(**(long **)(this + 0x6c0) + 0x20))();
          *param_2 = 0;
          uVar12 = *(undefined8 *)(this + 0x6c0);
          goto LAB_00009b1e;
        }
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: fAccelerator->createBufferMemoryDescriptorWithOptions failed\n",
                          "virtual IOReturn IOAccelContext2::clientMemoryForType(UInt32, IOOptionBits *, IOMemoryDescriptor **)"
                         );
      }
LAB_00009c8a:
      uVar12 = 0xe00002be;
      goto LAB_00009c90;
    }
    if (param_1 != 0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Invalid memory type\n",
                        "virtual IOReturn IOAccelContext2::clientMemoryForType(UInt32, IOOptionBits *, IOMemoryDescriptor **)"
                       );
      uVar12 = 0xe00002c2;
      goto LAB_00009c90;
    }
    uVar4 = *(uint *)(this + 0x6b8);
    if ((uVar4 < *(uint *)(this + 0x6bc)) &&
       ((piVar3 = *(int **)(this + 0x620), piVar3 == (int *)0x0 ||
        ((uint)(*piVar3 * 3) >> 2 <= (uint)piVar3[2])))) {
      uVar10 = *(ulong *)PTR__page_size_0006b108 & 0xffffffff;
      if (uVar4 != 0) {
        uVar10 = (ulong)(uVar4 * 2);
      }
      ptVar5 = (task *)(**(code **)(**(long **)(this + 0x5a8) + 0x920))
                                 (*(long **)(this + 0x5a8),0x10023,uVar10);
      if (ptVar5 == (task *)0x0) {
        *(uint *)(this + 0x6bc) = (uint)uVar10 >> 1;
        ptVar5 = *(task **)(this + 0x6b0);
        if (ptVar5 == (task *)0x0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: Couldn\'t allocate sideband buffer!\n\n",
                            "virtual IOReturn IOAccelContext2::clientMemoryForType(UInt32, IOOptionBits *, IOMemoryDescriptor **)"
                           );
          goto LAB_00009c8a;
        }
      }
      else {
        IOGeneralMemoryDescriptor::setOwnership(ptVar5,(int)*(undefined8 *)(this + 0x578),4);
        if (*(long **)(this + 0x6b0) != (long *)0x0) {
          (**(code **)(**(long **)(this + 0x6b0) + 0x28))();
        }
        *(task **)(this + 0x6b0) = ptVar5;
        *(uint *)(this + 0x6b8) = (uint)uVar10;
      }
      lVar7 = (**(code **)(*(long *)ptVar5 + 0x2e0))(ptVar5);
      *(long *)(this + 0x620) = lVar7;
      *(ulong *)(this + 0x628) = (ulong)(*(uint *)(this + 0x6b8) & 0xfffffffc) + lVar7;
    }
    (**(code **)(**(long **)(this + 0x6b0) + 0x20))();
    *param_2 = 0;
    *param_3 = *(undefined8 *)(this + 0x6b0);
    (**(code **)(*(long *)this + 0xa00))
              (this,*(undefined8 *)(this + 0x620),*(undefined4 *)(this + 0x6b8),
               *(undefined4 *)(this + 0x6bc));
  }
  uVar12 = 0;
LAB_00009c90:
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar2);
  _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
  return uVar12;
}



// IOAccelContext2::beginCommandStream(IOAccelCommandStreamInfo&)

void IOAccelContext2::beginCommandStream(void)

{
  return;
}



// IOAccelContext2::endCommandStream(IOAccelCommandStreamInfo&)

void IOAccelContext2::endCommandStream(void)

{
  return;
}



// IOAccelContext2::addDataBufferToChannel(IOAccelResource2*, unsigned int)

void IOAccelContext2::addDataBufferToChannel(void)

{
  return;
}



// IOAccelContext2::removeDataBufferFromChannel(IOAccelResource2*, unsigned int)

void IOAccelContext2::removeDataBufferFromChannel(void)

{
  return;
}



// IOAccelContext2::removeCurrentResourceFromChannel(IOAccelResource2*, unsigned int)

void IOAccelContext2::removeCurrentResourceFromChannel(void)

{
  return;
}



// IOAccelContext2::initSidebandBufferHeader(IOAccelSidebandBufferHeader*, unsigned long long,
// unsigned long long)

void __thiscall
IOAccelContext2::initSidebandBufferHeader
          (undefined8 param_1_00,undefined4 *param_2,long param_3,long param_4)

{
  *(undefined8 *)(param_2 + 2) = 0;
  *param_2 = (int)(param_3 + 0x3fffffff0U >> 2);
  param_2[1] = (int)(param_4 + 0x3fffffff0U >> 2);
  *(undefined8 *)(param_2 + 4) = 0x20100;
  *(undefined8 *)(param_2 + 6) = 0x200;
  return;
}



// IOAccelContext2::validateTokenSize(IOAccelCommandStreamInfo&, unsigned short)

bool __thiscall
IOAccelContext2::validateTokenSize(IOAccelContext2 *this,long param_1,ushort param_2)

{
  ushort uVar1;
  undefined *puVar2;
  
  puVar2 = PTR___os_log_default_0006b0b8;
  uVar1 = *(ushort *)(param_1 + 0x22);
  if (uVar1 < param_2) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: token (0x%x) does not match expected size (in words): size=%u expected=%u\n\n"
                      ,
                      "bool IOAccelContext2::validateTokenSize(IOAccelCommandStreamInfo &, uint16_t)"
                      ,*(undefined1 *)(param_1 + 0x21),uVar1,param_2);
    __os_log_internal(0,puVar2,0x11,
                      "%s: stream error found.  token_id was 0x%04x token_size was 0x%04x\n",
                      "void IOAccelContext2::setContextError(uint32_t)",
                      *(undefined2 *)(this + 0x670),*(undefined2 *)(this + 0x672));
    *(undefined2 *)(this + 0x672) = 0;
    *(undefined4 *)(this + 0x684) = 0;
    *(undefined4 *)(this + 0x644) = 0xfffffffb;
  }
  return param_2 <= uVar1;
}



// IOAccelContext2::setContextError(unsigned int)

void __thiscall IOAccelContext2::setContextError(IOAccelContext2 *this,undefined4 param_1)

{
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                    "%s: stream error found.  token_id was 0x%04x token_size was 0x%04x\n",
                    "void IOAccelContext2::setContextError(uint32_t)",*(undefined2 *)(this + 0x670),
                    *(undefined2 *)(this + 0x672));
  *(undefined2 *)(this + 0x672) = 0;
  *(undefined4 *)(this + 0x684) = 0;
  *(undefined4 *)(this + 0x644) = param_1;
  return;
}



// IOAccelContext2::processSidebandToken(IOAccelCommandStreamInfo&)

void __thiscall IOAccelContext2::processSidebandToken(IOAccelContext2 *this,long param_1)

{
  if ((byte)(*(ushort *)(param_1 + 0x20) >> 8) < 6) {
                    // WARNING: Could not recover jumptable at 0x00009e9c. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(&DAT_00009fcc +
              *(int *)(&DAT_00009fcc + (ulong)(*(ushort *)(param_1 + 0x20) >> 8) * 4)))();
    return;
  }
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: unrecognized  token id: token=0x%x\n",
                    "virtual void IOAccelContext2::processSidebandToken(IOAccelCommandStreamInfo &)"
                   );
  *(undefined4 *)(this + 0x644) = 0xfffffffb;
  return;
}



// IOAccelContext2::process_token_Start(IOAccelCommandStreamInfo&)

void __thiscall IOAccelContext2::process_token_Start(IOAccelContext2 *this,long param_1)

{
  undefined *puVar1;
  undefined8 in_RAX;
  undefined4 uVar2;
  
  puVar1 = PTR___os_log_default_0006b0b8;
  uVar2 = (undefined4)((ulong)in_RAX >> 0x20);
  if (*(long *)(param_1 + 0x18) != *(long *)(this + 0x620) + 0x10) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Internal Error: kIOAccelGLStreamStart found in middle of command buffer\n"
                      ,"void IOAccelContext2::process_token_Start(IOAccelCommandStreamInfo &)");
    __os_log_internal(0,puVar1,0x11,
                      "%s: stream error found.  token_id was 0x%04x token_size was 0x%04x\n",
                      "void IOAccelContext2::setContextError(uint32_t)",
                      *(undefined2 *)(this + 0x670),CONCAT44(uVar2,(uint)*(ushort *)(this + 0x672)))
    ;
    *(undefined2 *)(this + 0x672) = 0;
    *(undefined4 *)(this + 0x684) = 0;
    *(undefined4 *)(this + 0x644) = 0xfffffffc;
  }
  return;
}



// IOAccelContext2::process_token_Noop(IOAccelCommandStreamInfo&)

void IOAccelContext2::process_token_Noop(void)

{
  return;
}



// IOAccelContext2::process_token_End(IOAccelCommandStreamInfo&)

void __thiscall IOAccelContext2::process_token_End(IOAccelContext2 *this,long param_1)

{
  undefined *puVar1;
  
  puVar1 = PTR___os_log_default_0006b0b8;
  if (*(short *)(param_1 + 0x22) != 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: token does not match expected size: size=%u expected=%u\n",
                      "void IOAccelContext2::process_token_End(IOAccelCommandStreamInfo &)",
                      *(short *)(param_1 + 0x22),0);
    __os_log_internal(0,puVar1,0x11,
                      "%s: stream error found.  token_id was 0x%04x token_size was 0x%04x\n",
                      "void IOAccelContext2::setContextError(uint32_t)",
                      *(undefined2 *)(this + 0x670),*(undefined2 *)(this + 0x672));
    *(undefined2 *)(this + 0x672) = 0;
    *(undefined4 *)(this + 0x684) = 0;
    *(undefined4 *)(this + 0x644) = 0xfffffffb;
  }
  return;
}



// IOAccelContext2::process_token_BindDataBuffer(IOAccelCommandStreamInfo&)

void __thiscall IOAccelContext2::process_token_BindDataBuffer(IOAccelContext2 *this,long param_1)

{
  byte bVar1;
  long lVar2;
  char cVar3;
  ulong uVar4;
  undefined8 uVar5;
  byte bVar6;
  ulong uVar7;
  IOAccelResource2 *local_30;
  
  bVar1 = *(byte *)(param_1 + 0x20);
  uVar7 = (ulong)bVar1;
  local_30 = (IOAccelResource2 *)&DAT_aaaaaaaaaaaaaaaa;
  lVar2 = *(long *)(param_1 + 0x18);
  cVar3 = IOAccelShared2::lookupResource
                    (*(IOAccelShared2 **)(this + 0x5a0),*(uint *)(lVar2 + 8),(long *)&local_30);
  if (cVar3 == '\0') {
    local_30 = (IOAccelResource2 *)0x0;
  }
  else if (((uint)bVar1 < *(uint *)(this + 0x6dc)) && (local_30[0x14] == (IOAccelResource2)0xa)) {
    if ((bVar1 == 0) &&
       ((*(long *)(this + 0x658) != 0 &&
        (*(IOAccelResource2 **)(this + 0xfe0) != (IOAccelResource2 *)0x0)))) {
      IOAccelResource2::releaseKernelData(*(IOAccelResource2 **)(this + 0xfe0));
      *(undefined8 *)(this + 0x658) = 0;
    }
    if (*(long *)(this + uVar7 * 8 + 0xfe0) != 0) {
      (**(code **)(*(long *)this + 0xa98))(this,*(long *)(this + uVar7 * 8 + 0xfe0),bVar1);
      (**(code **)(**(long **)(this + uVar7 * 8 + 0xfe0) + 0x178))();
      (**(code **)(**(long **)(this + uVar7 * 8 + 0xfe0) + 0x28))();
      *(undefined8 *)(this + uVar7 * 8 + 0xfe0) = 0;
    }
    uVar4 = IOAccelResource2::checkDirty(local_30);
    bVar6 = *(int *)(param_1 + 0x34) != 0 & (byte)uVar4;
    if (bVar6 == 1) {
      (**(code **)(*(long *)this + 0xa38))(this,param_1);
    }
    cVar3 = (**(code **)(*(long *)local_30 + 0x170))();
    if (cVar3 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to prepare\n",
                        "void IOAccelContext2::process_token_BindDataBuffer(IOAccelCommandStreamInfo &)"
                       );
    }
    else {
      (**(code **)(*(long *)this + 0xa90))(this,local_30,bVar1);
      *(IOAccelResource2 **)(this + uVar7 * 8 + 0xfe0) = local_30;
      (**(code **)(*(long *)local_30 + 0x20))();
    }
    if (bVar6 != 0) {
      (**(code **)(*(long *)this + 0xa30))(this,param_1);
    }
    if (bVar1 != 0) {
      return;
    }
    if ((*(byte *)(*(long *)(this + 0x5a8) + 0xc92) & 4) == 0) {
      return;
    }
    uVar5 = IOAccelResource2::getKernelData(local_30);
    *(undefined8 *)(this + 0x658) = uVar5;
    *(undefined4 *)(this + 0x660) =
         *(undefined4 *)(local_30 + (ulong)(*(long *)(local_30 + 0x88) == 0) * 8 + 200);
    return;
  }
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: bad texbuf id. id=0x%08x\n",
                    "void IOAccelContext2::process_token_BindDataBuffer(IOAccelCommandStreamInfo &)"
                    ,*(undefined4 *)(lVar2 + 8));
  *(undefined4 *)(this + 0x644) = 0xfffffffe;
  return;
}



// IOAccelContext2::process_token_ResourcePurgeable(IOAccelCommandStreamInfo&)

void __thiscall IOAccelContext2::process_token_ResourcePurgeable(IOAccelContext2 *this,long param_1)

{
  uint *puVar1;
  undefined8 *puVar2;
  char cVar3;
  IOAccelResource2 *local_20;
  
  local_20 = (IOAccelResource2 *)&DAT_aaaaaaaaaaaaaaaa;
  puVar1 = *(uint **)(param_1 + 0x28);
  cVar3 = IOAccelShared2::lookupResource
                    (*(IOAccelShared2 **)(this + 0x5a0),*puVar1,(long *)&local_20);
  if (cVar3 == '\0') {
    local_20 = (IOAccelResource2 *)0x0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: bad texbuf id. id=0x%08x\n",
                      "void IOAccelContext2::process_token_ResourcePurgeable(IOAccelCommandStreamInfo &)"
                      ,*puVar1);
    *(undefined4 *)(this + 0x644) = 0xfffffffe;
  }
  else {
    IOAccelResource2::setPurgeable
              (local_20,(char)puVar1[1] == '\0' ^ 3,*(char *)((long)puVar1 + 5) == '\0' ^ 3,
               (uint *)0x0);
    if (*(char *)((long)puVar1 + 6) != '\0') {
      puVar2 = *(undefined8 **)(local_20 + 0x30);
      *puVar2 = 0;
      puVar2[1] = 0;
      puVar2[2] = 0;
      *(byte *)((long)puVar2 + 0x1c) = *(byte *)((long)puVar2 + 0x1c) & 0xfe;
    }
    IOAccelResource2::clientRelease((long *)local_20);
  }
  return;
}



// IOAccelContext2::process_token_ResourceRelease(IOAccelCommandStreamInfo&)

void __thiscall IOAccelContext2::process_token_ResourceRelease(IOAccelContext2 *this,long param_1)

{
  uint *puVar1;
  char cVar2;
  long *local_20;
  
  local_20 = (long *)&DAT_aaaaaaaaaaaaaaaa;
  puVar1 = *(uint **)(param_1 + 0x28);
  cVar2 = IOAccelShared2::lookupResource
                    (*(IOAccelShared2 **)(this + 0x5a0),*puVar1,(long *)&local_20);
  if (cVar2 == '\0') {
    local_20 = (long *)0x0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: bad texbuf id. id=0x%08x\n",
                      "void IOAccelContext2::process_token_ResourceRelease(IOAccelCommandStreamInfo &)"
                      ,*puVar1);
    *(undefined4 *)(this + 0x644) = 0xfffffffe;
  }
  else {
    IOAccelResource2::clientRelease(local_20);
  }
  return;
}



// IOAccelContext2::process_token_SetBlockFence(IOAccelCommandStreamInfo&)

void __thiscall IOAccelContext2::process_token_SetBlockFence(IOAccelContext2 *this,long param_1)

{
  undefined8 uVar1;
  undefined8 uVar2;
  char cVar3;
  long *plVar4;
  
  if (*(long *)(this + 0x588) == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: tried to set a block fence with no async ref!\n",
                      "void IOAccelContext2::process_token_SetBlockFence(IOAccelCommandStreamInfo &)"
                     );
    *(undefined4 *)(this + 0x644) = 0xffffffff;
  }
  else {
    uVar1 = **(undefined8 **)(param_1 + 0x28);
    uVar2 = (*(undefined8 **)(param_1 + 0x28))[1];
    plVar4 = (long *)(**(code **)(**(long **)(this + 0x5a8) + 0x8e8))();
    if (plVar4 != (long *)0x0) {
      cVar3 = (**(code **)(*plVar4 + 0x128))
                        (plVar4,*(undefined8 *)(this + 0x5a8),this,*(undefined8 *)(this + 0x588),
                         uVar1,uVar2);
      if (cVar3 != '\0') {
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b0))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),this + 0x5d0,plVar4 + 0xd);
        IOAccelFenceMachine::addEventFence
                  (*(IOAccelFenceMachine **)(*(long *)(this + 0x5a8) + 0x390),(long)this,
                   (long)plVar4);
        return;
      }
      (**(code **)(*plVar4 + 0x28))(plVar4);
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: failed to alloc memory for block fence!\n",
                      "void IOAccelContext2::process_token_SetBlockFence(IOAccelCommandStreamInfo &)"
                     );
    *(undefined4 *)(this + 0x644) = 0xfffffff9;
  }
  return;
}



// IOAccelContext2::discardSidebandToken(IOAccelCommandStreamInfo&)

void __thiscall IOAccelContext2::discardSidebandToken(IOAccelContext2 *this,long param_1)

{
  processSidebandToken(this,param_1);
  return;
}



// IOAccelContext2::lookupResource(unsigned int, void**) const

void __thiscall IOAccelContext2::lookupResource(IOAccelContext2 *this,uint param_1,long *param_2)

{
  char cVar1;
  
  cVar1 = IOAccelShared2::lookupResource(*(IOAccelShared2 **)(this + 0x5a0),param_1,param_2);
  if (cVar1 == '\0') {
    *param_2 = 0;
  }
  return;
}



// IOAccelContext2::processSidebandBuffer(IOAccelCommandDescriptor*, bool)

undefined8 __thiscall
IOAccelContext2::processSidebandBuffer(IOAccelContext2 *this,long param_2,IOAccelContext2 param_3)

{
  IOAccelContext2 *pIVar1;
  ushort uVar2;
  uint uVar3;
  undefined8 uVar4;
  undefined *puVar5;
  undefined4 uVar6;
  long lVar7;
  undefined2 *puVar8;
  
  pIVar1 = this + 0x650;
  *(undefined4 *)(this + 0x680) = 0;
  *(undefined8 *)(this + 0x650) = 0;
  *(undefined8 *)(this + 0x658) = 0;
  *(undefined4 *)(this + 0x660) = 0;
  puVar8 = (undefined2 *)(*(long *)(this + 0x620) + 0x10);
  *(undefined2 **)(this + 0x668) = puVar8;
  *(undefined4 *)(this + 0x688) = 0;
  this[0x68c] = param_3;
  do {
    puVar5 = PTR___os_log_default_0006b0b8;
    if (*(undefined2 **)(this + 0x628) < puVar8 + 4) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: out of sideband buffer.\n",
                        "virtual bool IOAccelContext2::processSidebandBuffer(IOAccelCommandDescriptor *, bool)"
                       );
      __os_log_internal(0,puVar5,0x11,
                        "%s: stream error found.  token_id was 0x%04x token_size was 0x%04x\n",
                        "void IOAccelContext2::setContextError(uint32_t)",
                        *(undefined2 *)(this + 0x670),*(undefined2 *)(this + 0x672));
LAB_0000a8ae:
      *(undefined2 *)(this + 0x672) = 0;
      *(undefined4 *)(this + 0x684) = 0;
      *(undefined4 *)(this + 0x644) = 0xfffffffb;
LAB_0000a8cb:
      this[0x68c] = (IOAccelContext2)0x0;
      break;
    }
    *(undefined2 *)(this + 0x670) = *puVar8;
    uVar2 = puVar8[1];
    *(ushort *)(this + 0x672) = uVar2;
    uVar3 = *(uint *)(puVar8 + 2);
    *(uint *)(this + 0x674) = uVar3;
    *(undefined2 **)(this + 0x678) = puVar8 + 4;
    puVar5 = PTR___os_log_default_0006b0b8;
    if (*(undefined2 **)(this + 0x628) < puVar8 + (ulong)uVar2 * 2) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: out of sideband buffer.\n",
                        "virtual bool IOAccelContext2::processSidebandBuffer(IOAccelCommandDescriptor *, bool)"
                       );
      __os_log_internal(0,puVar5,0x11,
                        "%s: stream error found.  token_id was 0x%04x token_size was 0x%04x\n",
                        "void IOAccelContext2::setContextError(uint32_t)",
                        *(undefined2 *)(this + 0x670),*(undefined2 *)(this + 0x672));
      goto LAB_0000a8ae;
    }
    if (*(long *)(this + 0xfe0) == 0) {
      *(undefined8 *)pIVar1 = 0;
      uVar6 = 0;
    }
    else {
      if (*(uint *)(this + 0x660) >> 2 <= uVar3) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: out of command_buffer.\n",
                          "virtual bool IOAccelContext2::processSidebandBuffer(IOAccelCommandDescriptor *, bool)"
                         );
        __os_log_internal(0,puVar5,0x11,
                          "%s: stream error found.  token_id was 0x%04x token_size was 0x%04x\n",
                          "void IOAccelContext2::setContextError(uint32_t)",
                          *(undefined2 *)(this + 0x670),*(undefined2 *)(this + 0x672));
        goto LAB_0000a8ae;
      }
      lVar7 = *(long *)(this + 0x658) + (ulong)uVar3 * 4;
      *(long *)(this + 0x650) = lVar7;
      uVar6 = (undefined4)
              (lVar7 - ((ulong)(*(uint *)(this + 0x680) & 0xfffffffc) + *(long *)(this + 0x658)) >>
              2);
    }
    *(undefined4 *)(this + 0x684) = uVar6;
    (**(code **)(*(long *)this + 0xa10 + (ulong)(this[0x68c] == (IOAccelContext2)0x0) * 8))
              (this,pIVar1);
    if (*(int *)(this + 0x644) != 0) {
      _IOLog("The graphics driver has encountered internal error 0x%x, 0x%x.\n",
             *(undefined4 *)(this + 0x638));
      lVar7 = *(long *)(this + 0x618);
      *(undefined8 *)(lVar7 + 0x20) = 0;
      *(undefined8 *)(lVar7 + 0x18) = 0;
      *(undefined4 *)(lVar7 + 0x30) = 0;
      *(undefined8 *)(lVar7 + 0x28) = 0;
      goto LAB_0000a8cb;
    }
    (**(code **)(*(long *)this + 0xa20))(this,pIVar1);
    puVar8 = puVar8 + (ulong)*(ushort *)(this + 0x672) * 2;
    *(undefined2 **)(this + 0x668) = puVar8;
  } while ((ulong)*(ushort *)(this + 0x672) != 0);
  if (*(long *)(this + 0xfe0) == 0) {
    *(undefined8 *)(param_2 + 0x20) = 0;
    lVar7 = 0;
  }
  else {
    uVar3 = *(uint *)(this + 0x680);
    *(ulong *)(param_2 + 0x20) = (ulong)(uVar3 & 0xfffffffc) + *(long *)(this + 0x658);
    lVar7 = (**(code **)(**(long **)(*(long *)(this + 0xfe0) + 0x40) + 0x128))();
    lVar7 = lVar7 + (ulong)uVar3;
  }
  *(long *)(param_2 + 0x18) = lVar7;
  *(undefined4 *)(param_2 + 0x30) = *(undefined4 *)(this + 0x684);
  uVar4 = *(undefined8 *)(this + 0x650);
  *(undefined8 *)(param_2 + 0x28) = uVar4;
  return CONCAT71((int7)((ulong)uVar4 >> 8),this[0x68c]);
}



// IOAccelContext2::compactCurrentVidMemory()

undefined8 __thiscall IOAccelContext2::compactCurrentVidMemory(IOAccelContext2 *this)

{
  char cVar1;
  int iVar2;
  long lVar3;
  IOAccelMemory *this_00;
  undefined8 uVar4;
  ulong uVar5;
  OSMetaClassBase *pOVar6;
  ulong uVar7;
  long lVar8;
  
  if (((ulong)**(uint **)(this + 0x5b0) != 0) &&
     (lVar3 = _IOMallocTypeVarImpl
                        (&compactCurrentVidMemory()::kalloc_type_view_1244,
                         (ulong)**(uint **)(this + 0x5b0) << 3), lVar3 != 0)) {
    uVar5 = 0;
    if (**(int **)(this + 0x5b0) != 0) {
      uVar7 = 0;
      do {
        lVar8 = *(long *)(*(long *)(this + 0x5b8) + uVar7 * 8);
        if (lVar8 != 0) {
          pOVar6 = *(OSMetaClassBase **)(lVar8 + 0x88);
          if (pOVar6 == (OSMetaClassBase *)0x0) {
            pOVar6 = *(OSMetaClassBase **)(lVar8 + 0x80);
          }
          this_00 = (IOAccelMemory *)
                    OSMetaClassBase::safeMetaCast
                              (pOVar6,(OSMetaClass *)&IOAccelVidMemory::gMetaClass);
          if ((this_00 != (IOAccelMemory *)0x0) &&
             (iVar2 = IOAccelMemory::getPrepareCount(this_00), iVar2 < 2)) {
            IOAccelMemory::finishAllEvent(this_00);
            (**(code **)(**(long **)(*(long *)(this + 0x5b8) + uVar7 * 8) + 0x178))();
            (**(code **)(*(long *)this_00 + 0x1b8))(this_00);
            *(undefined8 *)(lVar3 + uVar7 * 8) =
                 *(undefined8 *)(*(long *)(this + 0x5b8) + uVar7 * 8);
            *(undefined8 *)(*(long *)(this + 0x5b8) + uVar7 * 8) = 0;
            uVar5 = (ulong)((int)uVar5 + 1);
          }
        }
        uVar7 = uVar7 + 1;
      } while (uVar7 < **(uint **)(this + 0x5b0));
      if ((int)uVar5 != 0) {
        lVar8 = 0;
        do {
          if (*(long **)(lVar3 + lVar8) != (long *)0x0) {
            cVar1 = (**(code **)(**(long **)(lVar3 + lVar8) + 0x170))();
            if (cVar1 == '\0') {
              __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                "%s: failed to prepare resource %p\n",
                                "virtual bool IOAccelContext2::compactCurrentVidMemory()");
            }
            else {
              *(undefined8 *)(*(long *)(this + 0x5b8) + lVar8) = *(undefined8 *)(lVar3 + lVar8);
            }
            uVar5 = (ulong)((int)uVar5 - 1);
          }
          lVar8 = lVar8 + 8;
        } while ((int)uVar5 != 0);
        uVar4 = _IOFreeTypeVarImpl(&compactCurrentVidMemory()::kalloc_type_view_1294,lVar3,
                                   (ulong)**(uint **)(this + 0x5b0) << 3);
        return CONCAT71((int7)((ulong)uVar4 >> 8),1);
      }
      uVar5 = (ulong)**(uint **)(this + 0x5b0) << 3;
    }
    _IOFreeTypeVarImpl(&compactCurrentVidMemory()::kalloc_type_view_1276,lVar3,uVar5);
  }
  return 0;
}



// IOAccelContext2::compactCurrentMappings(IOAccelMemoryMap*)

undefined1 __thiscall
IOAccelContext2::compactCurrentMappings(IOAccelContext2 *this,undefined8 param_1)

{
  undefined1 uVar1;
  char cVar2;
  int iVar3;
  IOAccelMemoryMap *this_00;
  undefined8 extraout_RDX;
  undefined8 uVar4;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelMemoryMapList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_40,*(long *)(this + 0x598) + 0x1e8);
  this_00 = (IOAccelMemoryMap *)
            IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_40);
  if (this_00 == (IOAccelMemoryMap *)0x0) {
    uVar1 = 0;
  }
  else {
    uVar1 = 0;
    do {
      if (((((byte)this_00[0x10] & 2) == 0) &&
          (uVar4 = param_1, cVar2 = (**(code **)(*(long *)this_00 + 0x148))(this_00), cVar2 != '\0')
          ) && (iVar3 = IOAccelMemoryMap::getPrepareCount(this_00), iVar3 == 0)) {
        IOAccelMemoryMap::finishEvent((long)this_00,uVar4,extraout_RDX);
        if (((byte)this_00[0x10] & 4) != 0) {
          IOAccelMemoryMap::release_pte(this_00);
        }
        (**(code **)(*(long *)this_00 + 0x160))(this_00);
        this_00 = (IOAccelMemoryMap *)
                  IOAccelMemoryMapList::ReverseIterator::getPrevMapping
                            ((ReverseIterator *)&local_40);
        uVar1 = 1;
      }
      else {
        this_00 = (IOAccelMemoryMap *)
                  IOAccelMemoryMapList::ReverseIterator::getPrevMapping
                            ((ReverseIterator *)&local_40);
      }
    } while (this_00 != (IOAccelMemoryMap *)0x0);
  }
  return uVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelContext2::processDataBuffers(unsigned int)

int __cdecl IOAccelContext2::processDataBuffers(long *param_1)

{
  long lVar1;
  IOGraphicsAccelerator2 *this;
  char cVar2;
  uint uVar3;
  int iVar4;
  ulong uVar5;
  
  uVar3 = *(uint *)(param_1 + 199);
  IOGraphicsAccelerator2::update_gart_collector_age((IOGraphicsAccelerator2 *)param_1[0xb5]);
  (**(code **)(*param_1 + 0xa30))(param_1,param_1 + 0xca);
  if (param_1[0xc4] == 0) {
    iVar4 = -0x80000000;
  }
  else {
    cVar2 = (**(code **)(*param_1 + 0xa08))(param_1,param_1[0xc3],(uVar3 >> 0x1b & 1) == 0);
    iVar4 = (uint)(cVar2 == '\0') << 0x1f;
  }
  (**(code **)(*param_1 + 0xa38))(param_1,param_1 + 0xca);
  uVar3 = *(uint *)param_1[0xb6];
  if (uVar3 != 0) {
    uVar5 = 0;
    do {
      lVar1 = *(long *)(param_1[0xb7] + uVar5 * 8);
      if (lVar1 != 0) {
        (**(code **)(*param_1 + 0xaa0))(param_1,lVar1,uVar5 & 0xffffffff);
        (**(code **)(**(long **)(param_1[0xb7] + uVar5 * 8) + 0x178))();
        (**(code **)(**(long **)(param_1[0xb7] + uVar5 * 8) + 0x28))();
        *(undefined8 *)(param_1[0xb7] + uVar5 * 8) = 0;
        uVar3 = *(uint *)param_1[0xb6];
      }
      uVar5 = uVar5 + 1;
    } while (uVar5 < uVar3);
  }
  if ((((IOAccelResource2 *)param_1[0x1fc] != (IOAccelResource2 *)0x0) &&
      ((*(byte *)(param_1[0xb5] + 0xc92) & 4) != 0)) && (param_1[0xcb] != 0)) {
    IOAccelResource2::releaseKernelData((IOAccelResource2 *)param_1[0x1fc]);
    param_1[0xcb] = 0;
  }
  uVar3 = *(uint *)((long)param_1 + 0x6dc);
  if (uVar3 != 0) {
    uVar5 = 0;
    do {
      if (param_1[uVar5 + 0x1fc] != 0) {
        (**(code **)(*param_1 + 0xa98))(param_1,param_1[uVar5 + 0x1fc],uVar5 & 0xffffffff);
        (**(code **)(*(long *)param_1[uVar5 + 0x1fc] + 0x178))();
        (**(code **)(*(long *)param_1[uVar5 + 0x1fc] + 0x28))();
        param_1[uVar5 + 0x1fc] = 0;
        uVar3 = *(uint *)((long)param_1 + 0x6dc);
      }
      uVar5 = uVar5 + 1;
    } while (uVar5 < uVar3);
  }
  this = (IOGraphicsAccelerator2 *)param_1[0xb5];
  *(int *)(this + 0xdd4) = (int)param_1[0xb0];
  IOGraphicsAccelerator2::enable_gart_collector(this);
  return iVar4;
}



// IOAccelContext2::update_data_buffer_desired_size(unsigned int, unsigned long long)

void __thiscall
IOAccelContext2::update_data_buffer_desired_size
          (IOAccelContext2 *this,ulong param_2_00,long param_2)

{
  long lVar1;
  long lVar2;
  ulong uVar3;
  ulong uVar4;
  ulong uVar5;
  long lVar6;
  
  lVar2 = (param_2_00 & 0xffffffff) * 0x90;
  uVar4 = *(ulong *)(this + lVar2 + 0x6f8);
  uVar3 = *(ulong *)(this + lVar2 + 0x700);
  if ((uVar4 < param_2 + 0x2000U) && (uVar4 < uVar3)) {
    do {
      uVar5 = uVar4;
      uVar4 = uVar5 * *(uint *)(this + lVar2 + 0x75c);
      if (param_2 + 0x2000U <= uVar4) break;
    } while (uVar4 < uVar3);
  }
  else {
    uVar5 = 0;
  }
  if (uVar4 < uVar3) {
    uVar3 = uVar4;
  }
  lVar1 = *(long *)PTR__page_size_0006b108;
  lVar6 = 0;
  if (0x2000 < uVar5) {
    lVar6 = ((lVar1 + uVar5) - 1 & -lVar1) - 0x2000;
  }
  *(ulong *)(this + lVar2 + 0x6e0) = (uVar3 + lVar1) - 1 & -lVar1;
  *(long *)(this + lVar2 + 0x6e8) = lVar6;
  return;
}



// IOAccelContext2::getDataBuffer(IOAccelContextGetDataBufferIn*, IOAccelContextGetDataBufferOut*,
// IOAccelResourcePrivate*, unsigned long long)

undefined8 __thiscall
IOAccelContext2::getDataBuffer
          (IOAccelContext2 *this,uint *param_1,IOAccelContext2 *param_2,undefined8 param_3,
          undefined8 param_4)

{
  int *piVar1;
  IOAccelResource2 IVar2;
  uint uVar3;
  IOGraphicsAccelerator2 *pIVar4;
  char cVar5;
  int iVar6;
  ulong uVar7;
  IOAccelResource2 *this_00;
  IOAccelResource2 *pIVar8;
  long lVar9;
  task *ptVar10;
  undefined8 uVar11;
  long lVar12;
  long *plVar13;
  ulong uVar14;
  ulong uVar15;
  char *pcVar16;
  undefined8 uVar17;
  IOAccelContext2 *pIVar18;
  uint uVar19;
  undefined1 *local_98;
  undefined1 *local_90;
  undefined1 *local_88;
  undefined1 *local_80;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined8 local_58;
  undefined8 local_50;
  ulong local_48;
  IOAccelContext2 *local_40;
  long local_38;
  
  uVar3 = *param_1;
  uVar14 = (ulong)uVar3;
  uVar19 = 0;
  *(undefined8 *)(param_2 + 0x28) = 0;
  *(undefined8 *)(param_2 + 0x20) = 0;
  *(undefined8 *)(param_2 + 0x18) = 0;
  *(undefined8 *)(param_2 + 0x10) = 0;
  *(undefined8 *)(param_2 + 8) = 0;
  *(undefined8 *)param_2 = 0;
  if (*(uint *)(this + 0x6dc) <= uVar3) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Requested invalid data buffer class %d\n",
                      "virtual IOReturn IOAccelContext2::getDataBuffer(sIOAccelContextGetDataBufferIn *, sIOAccelContextGetDataBufferOut *, sIOAccelResourcePrivate *, IOByteCount)"
                     );
    *(undefined8 *)param_2 = 0;
    *(undefined8 *)(param_2 + 8) = 0;
    *(undefined8 *)(param_2 + 0x18) = 0;
    *(undefined8 *)(param_2 + 0x20) = 0;
    return 0xe00002c2;
  }
  lVar12 = uVar14 * 0x90;
  pIVar18 = this + lVar12 + 0x6e0;
  lVar9 = *(long *)(this + lVar12 + 0x708);
  local_58 = param_4;
  local_50 = param_3;
  local_38 = lVar12;
  if (lVar9 != 0) {
    if (*(ulong *)pIVar18 < *(ulong *)(this + lVar12 + 0x700)) {
      uVar15 = *(ulong *)pIVar18 * (ulong)*(uint *)(this + lVar12 + 0x75c);
      uVar7 = (ulong)param_1[1];
      if (uVar15 < uVar7 || uVar15 - uVar7 == 0) {
        uVar15 = uVar7;
      }
      local_40 = param_2;
      update_data_buffer_desired_size(this,(ulong)uVar3,uVar15);
      *(undefined4 *)(this + lVar12 + 0x740) = 0;
      lVar9 = *(long *)(this + lVar12 + 0x708);
      param_2 = local_40;
      if (lVar9 == 0) goto LAB_0000af03;
    }
    uVar19 = 0;
    do {
      uVar19 = uVar19 + 1;
      lVar9 = *(long *)(lVar9 + 0xe0);
    } while (lVar9 != 0);
  }
LAB_0000af03:
  if (*(uint *)(this + local_38 + 0x730) <= uVar19) {
    *(long *)param_2 = 0;
    *(long *)(param_2 + 8) = 0;
    *(long *)(param_2 + 0x18) = 0;
    *(long *)(param_2 + 0x20) = 0;
    return 0xe00002be;
  }
  local_40 = this + local_38 + 0x718;
  this_00 = (IOAccelResource2 *)**(long **)(*(long *)(this + local_38 + 0x720) + 8);
  local_48 = uVar14;
  if (this_00 == (IOAccelResource2 *)0x0) {
    if (*(uint *)(this + local_38 + 0x72c) <= *(uint *)(this + local_38 + 0x728)) {
LAB_0000b023:
      lVar9 = *(long *)local_40;
      if (lVar9 != 0) {
        local_60 = &DAT_aaaaaaaaaaaaaaaa;
        local_68 = &DAT_aaaaaaaaaaaaaaaa;
        local_70 = &DAT_aaaaaaaaaaaaaaaa;
        local_78 = &DAT_aaaaaaaaaaaaaaaa;
        local_80 = &DAT_aaaaaaaaaaaaaaaa;
        local_88 = &DAT_aaaaaaaaaaaaaaaa;
        local_90 = &DAT_aaaaaaaaaaaaaaaa;
        local_98 = &DAT_aaaaaaaaaaaaaaaa;
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x140))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_98);
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b0))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),
                   (ulong)*(byte *)(lVar9 + 0x15) * 0x40 + *(long *)(lVar9 + 0x38),&local_98);
        IOGraphicsAccelerator2::acceleratorUnlock(*(IOGraphicsAccelerator2 **)(this + 0x5a8));
        iVar6 = (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x178))
                          (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_98);
        IOGraphicsAccelerator2::acceleratorLock(*(IOGraphicsAccelerator2 **)(this + 0x5a8));
        lVar9 = *(long *)(this + 0x5a8);
        IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar9 + 0x388) + 0x58),0x31);
        piVar1 = (int *)(lVar9 + 0x264);
        *piVar1 = *piVar1 + iVar6;
        this_00 = *(IOAccelResource2 **)local_40;
        if (this_00 != (IOAccelResource2 *)0x0) {
          pIVar8 = (IOAccelResource2 *)0x0;
          do {
            cVar5 = (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 400))
                              (*(long **)(*(long *)(this + 0x5a8) + 0x380),
                               (ulong)(byte)this_00[0x15] * 0x40 + *(long *)(this_00 + 0x38));
            if ((cVar5 != '\0') &&
               (pIVar8 = this_00, *(ulong *)(this_00 + 200) == *(ulong *)pIVar18))
            goto LAB_0000b1f0;
            this_00 = *(IOAccelResource2 **)(this_00 + 0xe0);
          } while (this_00 != (IOAccelResource2 *)0x0);
          if (pIVar8 != (IOAccelResource2 *)0x0) {
            iVar6 = (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x188))
                              (*(long **)(*(long *)(this + 0x5a8) + 0x380),
                               (ulong)(byte)pIVar8[0x15] * 0x40 + *(long *)(pIVar8 + 0x38));
            lVar9 = *(long *)(this + 0x5a8);
            IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar9 + 0x388) + 0x58),0x31);
            piVar1 = (int *)(lVar9 + 0x264);
            *piVar1 = *piVar1 + iVar6;
            this_00 = pIVar8;
            goto LAB_0000b1b7;
          }
        }
      }
    }
  }
  else {
    pIVar8 = (IOAccelResource2 *)0x0;
    do {
      cVar5 = (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 400))
                        (*(long **)(*(long *)(this + 0x5a8) + 0x380),
                         (ulong)(byte)this_00[0x15] * 0x40 + *(long *)(this_00 + 0x38));
      if ((cVar5 != '\0') && (pIVar8 = this_00, *(ulong *)(this_00 + 200) == *(ulong *)pIVar18))
      goto LAB_0000b1f0;
      this_00 = (IOAccelResource2 *)**(long **)(*(long *)(this_00 + 0xe8) + 8);
    } while (this_00 != (IOAccelResource2 *)0x0);
    if (*(uint *)(this + local_38 + 0x72c) <= *(uint *)(this + local_38 + 0x728)) {
      this_00 = pIVar8;
      if (pIVar8 == (IOAccelResource2 *)0x0) goto LAB_0000b023;
LAB_0000b1b7:
      lVar9 = *(long *)(this_00 + 0xe0);
      if (lVar9 == 0) {
        if ((IOAccelResource2 *)**(long **)(this_00 + 0xe8) != this_00) {
LAB_0000b885:
          pcVar16 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
          goto LAB_0000b8b3;
        }
        *(long **)(local_40 + 8) = *(long **)(this_00 + 0xe8);
      }
      else {
        if (*(IOAccelResource2 **)(lVar9 + 0xe8) != this_00 + 0xe0) {
          pcVar16 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
LAB_0000b8b3:
          uVar11 = 0x7b8;
          uVar17 = 0x7b8;
          goto LAB_0000b8ef;
        }
        if ((IOAccelResource2 *)**(long **)(this_00 + 0xe8) != this_00) goto LAB_0000b885;
        *(long **)(lVar9 + 0xe8) = *(long **)(this_00 + 0xe8);
      }
      **(undefined8 **)(this_00 + 0xe8) = *(undefined8 *)(this_00 + 0xe0);
      *(int *)(this + (ulong)*(uint *)(this_00 + 0xf0) * 0x90 + 0x728) =
           *(int *)(this + (ulong)*(uint *)(this_00 + 0xf0) * 0x90 + 0x728) + -1;
      *(undefined4 *)(*(long *)(this_00 + 0x30) + 0x18) = 0;
      IOAccelResource2::databuffer_release(this_00,*(IOAccelShared2 **)(this + 0x5a0));
      (**(code **)(*(long *)this_00 + 0x28))(this_00);
    }
  }
  lVar9 = local_38;
  this_00 = (IOAccelResource2 *)
            (**(code **)(*(long *)this + 0xa70))
                      (this,(*(uint *)(this + local_38 + 0x750) & 2) >> 1,local_48);
  if (this_00 == (IOAccelResource2 *)0x0) {
    lVar9 = *(long *)local_40;
    if (lVar9 == 0) {
LAB_0000b517:
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: failed to find existing data buffer, failed to alloc new data buffer\n"
                        ,
                        "virtual IOReturn IOAccelContext2::getDataBuffer(sIOAccelContextGetDataBufferIn *, sIOAccelContextGetDataBufferOut *, sIOAccelResourcePrivate *, IOByteCount)"
                       );
      return 0xe00002be;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Failed to alloc a new data buffer, will try old buffer %p\n",
                      "virtual IOReturn IOAccelContext2::getDataBuffer(sIOAccelContextGetDataBufferIn *, sIOAccelContextGetDataBufferOut *, sIOAccelResourcePrivate *, IOByteCount)"
                      ,lVar9);
    local_60 = &DAT_aaaaaaaaaaaaaaaa;
    local_68 = &DAT_aaaaaaaaaaaaaaaa;
    local_70 = &DAT_aaaaaaaaaaaaaaaa;
    local_78 = &DAT_aaaaaaaaaaaaaaaa;
    local_80 = &DAT_aaaaaaaaaaaaaaaa;
    local_88 = &DAT_aaaaaaaaaaaaaaaa;
    local_90 = &DAT_aaaaaaaaaaaaaaaa;
    local_98 = &DAT_aaaaaaaaaaaaaaaa;
    (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x140))
              (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_98);
    (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b0))
              (*(long **)(*(long *)(this + 0x5a8) + 0x380),
               (ulong)*(byte *)(lVar9 + 0x15) * 0x40 + *(long *)(lVar9 + 0x38),&local_98);
    pIVar4 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
    (**(code **)(*(long *)pIVar4 + 0x858))(pIVar4,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar4);
    _IOLockUnlock(*(undefined8 *)(pIVar4 + 0x88));
    iVar6 = (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x178))
                      (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_98);
    pIVar4 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
    _OSIncrementAtomic(pIVar4 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar4 + 0x88));
    _OSDecrementAtomic(pIVar4 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar4);
    (**(code **)(*(long *)pIVar4 + 0x850))(pIVar4,"",0);
    lVar9 = *(long *)(this + 0x5a8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar9 + 0x388) + 0x58),0x31);
    piVar1 = (int *)(lVar9 + 0x264);
    *piVar1 = *piVar1 + iVar6;
    this_00 = *(IOAccelResource2 **)local_40;
    if (this_00 == (IOAccelResource2 *)0x0) goto LAB_0000b517;
    iVar6 = (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x188))
                      (*(long **)(*(long *)(this + 0x5a8) + 0x380),
                       (ulong)(byte)this_00[0x15] * 0x40 + *(long *)(this_00 + 0x38));
    lVar9 = *(long *)(this + 0x5a8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar9 + 0x388) + 0x58),0x31);
    piVar1 = (int *)(lVar9 + 0x264);
    *piVar1 = *piVar1 + iVar6;
    pIVar8 = this_00 + 0xe0;
    lVar9 = *(long *)(this_00 + 0xe0);
    if (lVar9 == 0) {
      plVar13 = *(long **)(this_00 + 0xe8);
      if ((IOAccelResource2 *)*plVar13 == this_00) goto LAB_0000b558;
LAB_0000b8ca:
      pcVar16 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
    }
    else {
      if (*(IOAccelResource2 **)(lVar9 + 0xe8) == pIVar8) {
        plVar13 = *(long **)(this_00 + 0xe8);
        if ((IOAccelResource2 *)*plVar13 == this_00) goto LAB_0000b50e;
        goto LAB_0000b8ca;
      }
      pcVar16 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
    }
    uVar11 = 0x7e2;
    uVar17 = 0x7e2;
LAB_0000b8ef:
                    // WARNING: Subroutine does not return
    _panic(pcVar16,this_00,uVar11,"IOAccelContext.cpp",uVar17);
  }
  *(undefined8 *)(this_00 + 0xe0) = 0;
  *(undefined8 *)(this_00 + 0xe8) = *(undefined8 *)(this + lVar9 + 0x710);
  **(long **)(this + lVar9 + 0x710) = (long)this_00;
  *(IOAccelResource2 **)(this + lVar9 + 0x710) = this_00 + 0xe0;
LAB_0000b5b6:
  *(undefined2 *)(*(long *)(this_00 + 0x30) + 0xc) = 1;
  pIVar18 = this + lVar9 + 0x760;
  if ((*(long **)pIVar18 != (long *)0x0) &&
     (lVar12 = (**(code **)(**(long **)pIVar18 + 0x1c8))(), lVar9 = local_38,
     lVar12 != *(long *)(this_00 + 200))) {
    (**(code **)(**(long **)(this + local_38 + 0x768) + 0x28))();
    *(undefined8 *)(this + local_38 + 0x768) = 0;
    (**(code **)(**(long **)pIVar18 + 0x28))();
    *(long *)pIVar18 = 0;
    lVar9 = local_38;
  }
  if ((((byte)this[lVar9 + 0x750] & 1) != 0) && (*(long *)pIVar18 == 0)) {
    ptVar10 = (task *)(**(code **)(**(long **)(this + 0x5a8) + 0x920))
                                (*(long **)(this + 0x5a8),0x10023,*(undefined4 *)(this_00 + 200),
                                 *(undefined8 *)PTR__page_size_0006b108);
    *(task **)pIVar18 = ptVar10;
    if (ptVar10 == (task *)0x0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: failed to allocate a bounce buffer\n",
                        "virtual IOReturn IOAccelContext2::getDataBuffer(sIOAccelContextGetDataBufferIn *, sIOAccelContextGetDataBufferOut *, sIOAccelResourcePrivate *, IOByteCount)"
                       );
      return 0xe00002be;
    }
    IOGeneralMemoryDescriptor::setOwnership(ptVar10,(int)*(undefined8 *)(this + 0x578),4);
    uVar11 = (**(code **)(**(long **)pIVar18 + 0x2e0))();
    ___bzero(uVar11,*(undefined4 *)(this_00 + 200));
    lVar12 = IOMemoryDescriptor::createMappingInTask
                       (*(task **)pIVar18,*(ulonglong *)(this + 0x578),0,1,0);
    *(long *)(this + local_38 + 0x768) = lVar12;
    lVar9 = local_38;
    if (lVar12 == 0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to allocate a bounce map\n"
                        ,
                        "virtual IOReturn IOAccelContext2::getDataBuffer(sIOAccelContextGetDataBufferIn *, sIOAccelContextGetDataBufferOut *, sIOAccelResourcePrivate *, IOByteCount)"
                       );
      (**(code **)(**(long **)pIVar18 + 0x28))();
      *(long *)pIVar18 = 0;
      return 0xe00002be;
    }
  }
  *(undefined4 *)(param_2 + 0x28) = *(undefined4 *)(*(long *)(this_00 + 0x38) + 0x100);
  IOAccelResource2::getClientSharedAddresses
            (this_00,(long *)(param_2 + 0x18),(long *)(param_2 + 0x20));
  if (((byte)this[lVar9 + 0x750] & 1) == 0) {
    lVar12 = (**(code **)(**(long **)(this_00 + 0x60) + 0x118))();
    *(ulong *)param_2 = (ulong)*(uint *)(this + lVar9 + 0x758) + lVar12;
    lVar12 = (**(code **)(**(long **)(this_00 + 0x60) + 0x128))();
    lVar12 = lVar12 - (ulong)*(uint *)(this + lVar9 + 0x758);
  }
  else {
    lVar12 = (**(code **)(**(long **)(this + lVar9 + 0x768) + 0x118))();
    *(long *)param_2 = lVar12;
    lVar12 = (**(code **)(**(long **)(this + lVar9 + 0x768) + 0x128))();
  }
  *(long *)(param_2 + 8) = lVar12;
  if (((byte)this_00[0x108] & 4) == 0) goto LAB_0000b802;
  plVar13 = *(long **)(this_00 + 0x40);
  if (plVar13 == (long *)0x0) {
    IOAccelResource2::map(this_00);
    plVar13 = *(long **)(this_00 + 0x40);
    if (plVar13 == (long *)0x0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to create mapping.\n",
                        "virtual IOReturn IOAccelContext2::getDataBuffer(sIOAccelContextGetDataBufferIn *, sIOAccelContextGetDataBufferOut *, sIOAccelResourcePrivate *, IOByteCount)"
                       );
      return 0xe00002be;
    }
  }
  lVar9 = (**(code **)(*plVar13 + 0x130))();
  IVar2 = this_00[0x14];
  if (IVar2 == (IOAccelResource2)0x0) {
LAB_0000b710:
    uVar14 = *(ulong *)(this_00 + 0xf8);
  }
  else if (IVar2 == (IOAccelResource2)0x82) {
    uVar14 = (ulong)*(uint *)(this_00 + 0xfc);
  }
  else {
    if (IVar2 == (IOAccelResource2)0x80) goto LAB_0000b710;
    uVar14 = 0;
  }
  *(ulong *)(param_2 + 0x10) = uVar14 + lVar9;
LAB_0000b802:
  (**(code **)(*(long *)this + 0xa78))(this,this_00,local_50,local_58);
  return 0;
LAB_0000b1f0:
  pIVar8 = this_00 + 0xe0;
  lVar9 = *(long *)(this_00 + 0xe0);
  if (lVar9 == 0) {
    plVar13 = *(long **)(this_00 + 0xe8);
    if ((IOAccelResource2 *)*plVar13 != this_00) {
LAB_0000b236:
      pcVar16 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
      goto LAB_0000b895;
    }
LAB_0000b558:
    *(long **)(local_40 + 8) = plVar13;
  }
  else {
    if (*(IOAccelResource2 **)(lVar9 + 0xe8) != pIVar8) {
      pcVar16 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
LAB_0000b895:
      uVar11 = 0x7f7;
      uVar17 = 0x7f7;
      goto LAB_0000b8ef;
    }
    plVar13 = *(long **)(this_00 + 0xe8);
    if ((IOAccelResource2 *)*plVar13 != this_00) goto LAB_0000b236;
LAB_0000b50e:
    *(long **)(lVar9 + 0xe8) = plVar13;
  }
  **(undefined8 **)(this_00 + 0xe8) = *(undefined8 *)(this_00 + 0xe0);
  *(undefined8 *)(this_00 + 0xe0) = 0;
  *(undefined8 *)(this_00 + 0xe8) = *(undefined8 *)(this + local_38 + 0x710);
  **(undefined8 **)(this + local_38 + 0x710) = this_00;
  *(IOAccelResource2 **)(this + local_38 + 0x710) = pIVar8;
  IOAccelResource2::setPurgeable(this_00,1,2,(uint *)0x0);
  lVar9 = local_38;
  goto LAB_0000b5b6;
}



// IOAccelContext2::freeOneDataBuffer(IOAccelResource2*)

void __thiscall IOAccelContext2::freeOneDataBuffer(IOAccelContext2 *this,IOAccelResource2 *param_1)

{
  *(int *)(this + (ulong)*(uint *)(param_1 + 0xf0) * 0x90 + 0x728) =
       *(int *)(this + (ulong)*(uint *)(param_1 + 0xf0) * 0x90 + 0x728) + -1;
  *(undefined4 *)(*(long *)(param_1 + 0x30) + 0x18) = 0;
  IOAccelResource2::databuffer_release(param_1,*(IOAccelShared2 **)(this + 0x5a0));
                    // WARNING: Could not recover jumptable at 0x0000b93a. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)param_1 + 0x28))(param_1);
  return;
}



// IOAccelContext2::allocOneDataBuffer(bool, unsigned int)

IOAccelResource2 * __thiscall
IOAccelContext2::allocOneDataBuffer(IOAccelContext2 *this,uint param_2_00,uint param_2)

{
  char cVar1;
  IOAccelResource2 *this_00;
  long lVar2;
  
  lVar2 = (ulong)param_2 * 0x90;
  this_00 = IOAccelResource2::newDataBufferResource
                      (*(long **)(this + 0x5a8),*(IOAccelShared2 **)(this + 0x5a0),
                       *(undefined8 *)(this + lVar2 + 0x6e0),(ulong)param_2_00,param_2,
                       *(undefined4 *)(this + lVar2 + 0x750));
  if (this_00 == (IOAccelResource2 *)0x0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: allocVendorTextureBuffer failed to alloc a data buffer object\n",
                      "virtual IOAccelResource2 *IOAccelContext2::allocOneDataBuffer(bool, unsigned int)"
                     );
  }
  else {
    cVar1 = (**(code **)(*(long *)this_00 + 0x140))(this_00,0,0);
    if (cVar1 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: initialize failed\n",
                        "virtual IOAccelResource2 *IOAccelContext2::allocOneDataBuffer(bool, unsigned int)"
                       );
    }
    else {
      cVar1 = (**(code **)(*(long *)this_00 + 0x128))
                        (this_00,*(undefined8 *)(this + 0x5a0),param_2_00 & 0xff,
                         *(undefined4 *)(this + lVar2 + 0x754));
      if (cVar1 != '\0') {
        *(int *)(this + lVar2 + 0x728) = *(int *)(this + lVar2 + 0x728) + 1;
        *(undefined4 *)(*(long *)(this_00 + 0x30) + 0x18) = 1;
        (**(code **)(*(long *)this_00 + 0x20))(this_00);
        return this_00;
      }
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: allocMemory failed\n",
                        "virtual IOAccelResource2 *IOAccelContext2::allocOneDataBuffer(bool, unsigned int)"
                       );
    }
    IOAccelResource2::databuffer_release(this_00,*(IOAccelShared2 **)(this + 0x5a0));
  }
  return (IOAccelResource2 *)0x0;
}



// IOAccelContext2::freeUnassignedDataBuffers()

void __thiscall IOAccelContext2::freeUnassignedDataBuffers(IOAccelContext2 *this)

{
  IOAccelResource2 *pIVar1;
  uint uVar2;
  char *pcVar3;
  IOAccelResource2 *this_00;
  ulong uVar4;
  
  uVar2 = *(uint *)(this + 0x6dc);
  if (uVar2 != 0) {
    uVar4 = 0;
    do {
      if (*(IOAccelResource2 **)(this + uVar4 * 0x90 + 0x718) != (IOAccelResource2 *)0x0) {
        this_00 = *(IOAccelResource2 **)(this + uVar4 * 0x90 + 0x718);
        do {
          pIVar1 = *(IOAccelResource2 **)(this_00 + 0xe0);
          if (pIVar1 == (IOAccelResource2 *)0x0) {
            if ((IOAccelResource2 *)**(long **)(this_00 + 0xe8) != this_00) {
LAB_0000bb9c:
              pcVar3 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_0000bbac:
                    // WARNING: Subroutine does not return
              _panic(pcVar3,this_00,0x8b9,"IOAccelContext.cpp",0x8b9);
            }
            *(long **)(this + uVar4 * 0x90 + 0x720) = *(long **)(this_00 + 0xe8);
          }
          else {
            if (*(IOAccelResource2 **)(pIVar1 + 0xe8) != this_00 + 0xe0) {
              pcVar3 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
              goto LAB_0000bbac;
            }
            if ((IOAccelResource2 *)**(long **)(this_00 + 0xe8) != this_00) goto LAB_0000bb9c;
            *(long **)(pIVar1 + 0xe8) = *(long **)(this_00 + 0xe8);
          }
          **(undefined8 **)(this_00 + 0xe8) = *(undefined8 *)(this_00 + 0xe0);
          *(int *)(this + (ulong)*(uint *)(this_00 + 0xf0) * 0x90 + 0x728) =
               *(int *)(this + (ulong)*(uint *)(this_00 + 0xf0) * 0x90 + 0x728) + -1;
          *(undefined4 *)(*(long *)(this_00 + 0x30) + 0x18) = 0;
          IOAccelResource2::databuffer_release(this_00,*(IOAccelShared2 **)(this + 0x5a0));
          (**(code **)(*(long *)this_00 + 0x28))(this_00);
          this_00 = pIVar1;
        } while (pIVar1 != (IOAccelResource2 *)0x0);
        uVar2 = *(uint *)(this + 0x6dc);
      }
      uVar4 = uVar4 + 1;
    } while (uVar4 < uVar2);
  }
  return;
}



// IOAccelContext2::bindResource(IOAccelCommandStreamInfo&, IOAccelResource2*, bool,
// IOAccelChannel2*, unsigned int, bool)

undefined4 __thiscall
IOAccelContext2::bindResource
          (IOAccelContext2 *this,undefined8 param_1,IOAccelResource2 *param_2,undefined8 param_4_00,
          undefined8 param_4,uint param_5,char param_6)

{
  undefined4 uVar1;
  ulong uVar2;
  char cVar3;
  
  if (param_6 == '\0') {
    cVar3 = '\0';
  }
  else {
    uVar2 = IOAccelResource2::checkDirty(param_2);
    cVar3 = (char)uVar2;
  }
  if ((((param_5 & 1) == 0) || ((*(uint *)(*(long *)(this + 0x5a8) + 0xc90) & 0x40000000) == 0)) ||
     (((byte)param_2[0xd] & 2) != 0)) {
    if (cVar3 != '\0') {
      (**(code **)(*(long *)this + 0xa38))(this,param_1);
    }
    uVar1 = (**(code **)(*(long *)param_2 + 0x170))(param_2);
    if ((char)uVar1 != '\0') {
      (**(code **)(*(long *)param_2 + 400))(param_2,param_4,param_5);
    }
    if (cVar3 != '\0') {
      (**(code **)(*(long *)this + 0xa30))(this,param_1);
    }
  }
  else {
    uVar1 = 0;
  }
  return uVar1;
}



// IOAccelContext2::unbindResource(IOAccelCommandStreamInfo&, IOAccelResource2*, IOAccelChannel2*)

void __thiscall
IOAccelContext2::unbindResource
          (IOAccelContext2 *this,undefined8 param_2_00,long *param_2,undefined8 param_3)

{
  (**(code **)(*param_2 + 0x198))(param_2,param_3);
                    // WARNING: Could not recover jumptable at 0x0000bcae. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*param_2 + 0x178))(param_2);
  return;
}



// IOAccelContext2::prepareResources(IOAccelResource2**, int)

ulong __thiscall IOAccelContext2::prepareResources(IOAccelContext2 *this,long param_1,uint param_2)

{
  long lVar1;
  char cVar2;
  long lVar3;
  ulong uVar4;
  ulong uVar5;
  ulong uVar6;
  
  if ((int)param_2 < 1) {
    uVar4 = 0;
  }
  else {
    uVar6 = (ulong)param_2;
    uVar4 = uVar6 + 1;
    do {
      lVar1 = *(long *)(param_1 + (ulong)((int)uVar4 - 2) * 8);
      lVar3 = *(long *)(lVar1 + 0x88);
      if (lVar3 == 0) {
        lVar3 = *(long *)(lVar1 + 0x80);
      }
      if ((~*(uint *)(lVar3 + 0xc) & 6) == 0) {
        IOAccelVidMemoryList::moveMemoryToHead
                  ((IOAccelVidMemoryList *)(*(long *)(this + 0x5a8) + 0xb48),lVar3);
      }
      uVar4 = uVar4 - 1;
    } while (1 < uVar4);
    uVar5 = 0;
    do {
      cVar2 = (**(code **)(**(long **)(param_1 + uVar5 * 8) + 0x170))();
      uVar4 = uVar5;
      if (cVar2 == '\0') break;
      uVar5 = uVar5 + 1;
      uVar4 = uVar6;
    } while (uVar6 != uVar5);
  }
  return uVar4 & 0xffffffff;
}



// IOAccelContext2::context_finish()

undefined8 __thiscall IOAccelContext2::context_finish(IOAccelContext2 *this)

{
  int *piVar1;
  long lVar2;
  int iVar3;
  undefined8 uVar4;
  
  iVar3 = (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x178))
                    (*(long **)(*(long *)(this + 0x5a8) + 0x380),this + 0x5d0);
  if (iVar3 == -1) {
    uVar4 = 0xe00002d6;
  }
  else {
    lVar2 = *(long *)(this + 0x5a8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar2 + 0x388) + 0x58),0x2b);
    piVar1 = (int *)(lVar2 + 0x24c);
    *piVar1 = *piVar1 + iVar3;
    uVar4 = 0;
  }
  return uVar4;
}



// IOAccelContext2::getDataBufferLimits()

IOAccelContext2 * __thiscall IOAccelContext2::getDataBufferLimits(IOAccelContext2 *this)

{
  ___bzero(this,0x308);
  *(undefined4 *)this = 2;
  *(char **)(this + 0x20) = "Default";
  *(undefined8 *)(this + 8) = 0x100000008;
  *(undefined8 *)(this + 0x10) = 0x10000;
  *(undefined8 *)(this + 0x18) = 0x80000;
  *(undefined4 *)(this + 0x2c) = 0x400;
  *(undefined4 *)(this + 0x34) = 2;
  *(char **)(this + 0x50) = "Data";
  *(undefined8 *)(this + 0x38) = 0x200000004;
  *(undefined8 *)(this + 0x40) = 0x10000;
  *(undefined8 *)(this + 0x48) = 0x80000;
  *(undefined4 *)(this + 0x5c) = 0x400;
  *(undefined4 *)(this + 100) = 2;
  return this;
}



// IOAccelContext2::affectedByHardwareReset(bool, unsigned int)

void __thiscall
IOAccelContext2::affectedByHardwareReset(IOAccelContext2 *this,int param_2_00,undefined4 param_2)

{
  int iVar1;
  char cVar2;
  
  if (param_2_00 != 0) {
    this[0x63b] = (IOAccelContext2)((byte)this[0x63b] | 0x20);
    *(undefined4 *)(this + 0x644) = param_2;
    iVar1 = *(int *)(this + 0x63c);
    *(int *)(this + 0x63c) = iVar1 + 1;
    if ((iVar1 + 1 == 2) && (*(IOAccelShared2 **)(this + 0x5a0) != (IOAccelShared2 *)0x0)) {
      cVar2 = IOAccelShared2::noIgnoreOnGPURestart(*(IOAccelShared2 **)(this + 0x5a0));
      if (cVar2 == '\0') {
        this[0x63b] = (IOAccelContext2)((byte)this[0x63b] | 8);
      }
    }
  }
  this[0x63b] = (IOAccelContext2)((byte)this[0x63b] | 0x40);
  this[0x68c] = (IOAccelContext2)0x0;
  return;
}



// IOAccelContext2::shouldHardwareCommandNooped()

bool __thiscall IOAccelContext2::shouldHardwareCommandNooped(IOAccelContext2 *this)

{
  return this[0x68c] == (IOAccelContext2)0x0;
}



// IOAccelContext2::getSurfaceReqBits() const

undefined8 IOAccelContext2::getSurfaceReqBits(void)

{
  return 0;
}



// IOAccelContext2::requiresBackingStore() const

undefined8 IOAccelContext2::requiresBackingStore(void)

{
  return 0;
}



// IOAccelContext2::add_task_surface_to_array(OSArray*, bool)

void __thiscall
IOAccelContext2::add_task_surface_to_array(IOAccelContext2 *this,long *param_1,char param_2)

{
  short sVar1;
  long lVar2;
  uint uVar3;
  long *plVar4;
  long *plVar5;
  
  lVar2 = *(long *)(this + 0x5c0);
  if (lVar2 != 0) {
    if (param_2 == '\0') {
      plVar4 = (long *)OSDictionary::withCapacity(1);
      sVar1 = *(short *)(&DAT_000011be + lVar2);
      plVar5 = (long *)OSNumber::withNumber
                                 ((ulong)(uint)(int)*(short *)(&DAT_000011bc + lVar2),0x10);
      (**(code **)(*plVar4 + 0x1d0))(plVar4,"width",plVar5);
      (**(code **)(*plVar5 + 0x28))(plVar5);
      plVar5 = (long *)OSNumber::withNumber((long)sVar1 & 0xffffffff,0x10);
      (**(code **)(*plVar4 + 0x1d0))(plVar4,"height",plVar5);
      (**(code **)(*plVar5 + 0x28))(plVar5);
      plVar5 = (long *)OSString::withCString("ctx");
      (**(code **)(*plVar4 + 0x1d0))(plVar4,"surfaceType",plVar5);
      (**(code **)(*plVar5 + 0x28))(plVar5);
      uVar3 = (**(code **)(*(long *)this + 0x970))(this);
      plVar5 = (long *)OSNumber::withNumber((ulong)uVar3,0x20);
      (**(code **)(*plVar4 + 0x1d0))(plVar4,"pid",plVar5);
      (**(code **)(*plVar5 + 0x28))(plVar5);
    }
    else {
      uVar3 = (**(code **)(*(long *)this + 0x970))(this);
      plVar4 = (long *)OSNumber::withNumber((ulong)uVar3,0x20);
    }
    (**(code **)(*param_1 + 0x1b8))(param_1,plVar4);
                    // WARNING: Could not recover jumptable at 0x0000c00b. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*plVar4 + 0x28))(plVar4);
    return;
  }
  return;
}



// IOAccelContext2::set_compatible_surface_mode(unsigned long long*, unsigned long long, unsigned
// int)

undefined1 IOAccelContext2::set_compatible_surface_mode(void)

{
  return 1;
}



// IOAccelContext2::remove_surface(IOAccelSurface*)

void __thiscall IOAccelContext2::remove_surface(IOAccelContext2 *this,long param_1)

{
  if (*(long *)(this + 0x5c0) != param_1) {
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0000c029. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0xb18))();
  return;
}



// IOAccelContext2::removeSurface()

void __thiscall IOAccelContext2::removeSurface(IOAccelContext2 *this)

{
  *(undefined8 *)(this + 0x5c0) = 0;
  return;
}



// IOAccelContext2::allowsExclusiveMode() const

undefined8 IOAccelContext2::allowsExclusiveMode(void)

{
  return 0;
}



// IOAccelContext2::isTripleBuffered() const

undefined8 IOAccelContext2::isTripleBuffered(void)

{
  return 0;
}



// IOAccelContext2::contextModeBits() const

undefined8 IOAccelContext2::contextModeBits(void)

{
  return 0;
}



// IOAccelContext2::describeDriverAllocations(IOAccelAllocationInfo*)

void __thiscall
IOAccelContext2::describeDriverAllocations(IOAccelContext2 *this,IOAccelAllocationInfo *param_1)

{
  IOAccelResource2 *pIVar1;
  ulong uVar2;
  long lVar3;
  char local_138 [256];
  long local_38;
  
  local_38 = *(long *)PTR____stack_chk_guard_0006b0b0;
  if (*(int *)(this + 0x6dc) != 0) {
    uVar2 = 0;
    do {
      _memset(local_138,0xaa,0x100);
      lVar3 = uVar2 * 0x90;
      _snprintf(local_138,0x100,"Data Buffer Class %d: %s",(int)uVar2,
                *(char **)(this + lVar3 + 0x738));
      for (pIVar1 = *(IOAccelResource2 **)(this + lVar3 + 0x718); pIVar1 != (IOAccelResource2 *)0x0;
          pIVar1 = *(IOAccelResource2 **)(pIVar1 + 0xe0)) {
        IOAccelResource2::describeAllocationsWithString(pIVar1,param_1,local_138);
      }
      for (pIVar1 = *(IOAccelResource2 **)(this + lVar3 + 0x708); pIVar1 != (IOAccelResource2 *)0x0;
          pIVar1 = *(IOAccelResource2 **)(pIVar1 + 0xe0)) {
        IOAccelResource2::describeAllocationsWithString(pIVar1,param_1,local_138);
      }
      uVar2 = uVar2 + 1;
    } while (uVar2 < *(uint *)(this + 0x6dc));
  }
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_38) {
    return;
  }
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// IOAccelContext2::enable_block_fences(unsigned long long*)

undefined8 __thiscall IOAccelContext2::enable_block_fences(IOAccelContext2 *this,undefined8 param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  char cVar2;
  IOAccelBlockFencePort2 *this_00;
  undefined8 uVar3;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (*(long *)(this + 0x588) == 0) {
    this_00 = IOAccelBlockFencePort2::operator_new
                        ((IOAccelBlockFencePort2 *)&segment_command_00000020.filesize);
    IOAccelBlockFencePort2::IOAccelBlockFencePort2(this_00);
    *(IOAccelBlockFencePort2 **)(this + 0x588) = this_00;
    if (this_00 != (IOAccelBlockFencePort2 *)0x0) {
      cVar2 = (**(code **)(*(long *)this_00 + 0x118))(this_00,param_1);
      uVar3 = 0;
      if (cVar2 != '\0') goto LAB_0000c260;
      if (*(long **)(this + 0x588) != (long *)0x0) {
        (**(code **)(**(long **)(this + 0x588) + 0x28))();
      }
    }
    *(undefined8 *)(this + 0x588) = 0;
    uVar3 = 0xe00002bd;
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: attempted to enable block fences while already enabled!\n",
                      "IOReturn IOAccelContext2::enable_block_fences(io_user_reference_t *)");
    uVar3 = 0xe00002c9;
  }
LAB_0000c260:
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar3;
}



// IOAccelContext2::canSubmitCommandBuffer()

undefined1 IOAccelContext2::canSubmitCommandBuffer(void)

{
  return 1;
}



// IOAccelContext2::pauseSubmitCommandBuffer()

void IOAccelContext2::pauseSubmitCommandBuffer(void)

{
  _IOSleep(1);
  return;
}



// IOAccelContext2::getPriorityInfo()

undefined8 IOAccelContext2::getPriorityInfo(void)

{
  return 0xffffffff;
}



// IOAccelContext2::_RESERVEDIOAccelContext0()

void IOAccelContext2::_RESERVEDIOAccelContext0(void)

{
  OSMetaClass::reservedCalled(0x82048);
  return;
}



// IOAccelContext2::_RESERVEDIOAccelContext1()

void IOAccelContext2::_RESERVEDIOAccelContext1(void)

{
  OSMetaClass::reservedCalled(0x82048);
  return;
}



// IOAccelContext2::_RESERVEDIOAccelContext2()

void IOAccelContext2::_RESERVEDIOAccelContext2(void)

{
  OSMetaClass::reservedCalled(0x82048);
  return;
}



// IOAccelContext2::_RESERVEDIOAccelContext3()

void IOAccelContext2::_RESERVEDIOAccelContext3(void)

{
  OSMetaClass::reservedCalled(0x82048);
  return;
}



// IOAccelContext2::_RESERVEDIOAccelContext4()

void IOAccelContext2::_RESERVEDIOAccelContext4(void)

{
  OSMetaClass::reservedCalled(0x82048);
  return;
}



// IOAccelContext2::_RESERVEDIOAccelContext5()

void IOAccelContext2::_RESERVEDIOAccelContext5(void)

{
  OSMetaClass::reservedCalled(0x82048);
  return;
}



// IOAccelContext2::MetaClass::~MetaClass()

void __thiscall IOAccelContext2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelContext2::getOwningTask() const

undefined8 __thiscall IOAccelContext2::getOwningTask(IOAccelContext2 *this)

{
  return *(undefined8 *)(this + 0x578);
}



// IOAccelContext2::getGPUTask() const

undefined8 __thiscall IOAccelContext2::getGPUTask(IOAccelContext2 *this)

{
  return *(undefined8 *)(this + 0x598);
}



// IOAccelContext2::getOwningTaskPid() const

undefined4 __thiscall IOAccelContext2::getOwningTaskPid(IOAccelContext2 *this)

{
  return *(undefined4 *)(this + 0x580);
}



// IOAccelSubmitter2::retireCommandBuffer(IOAccelEventFence*)

void IOAccelSubmitter2::retireCommandBuffer(void)

{
  return;
}



// IOAccelSubmitter2::setSubmissionError(unsigned int)

void IOAccelSubmitter2::setSubmissionError(void)

{
  return;
}



// IOAccelSubmitter2::isOpportunisticWorkload() const

undefined8 IOAccelSubmitter2::isOpportunisticWorkload(void)

{
  return 0;
}



// IOAccelContext2::postTokenSanityCheck(IOAccelCommandStreamInfo&)

void IOAccelContext2::postTokenSanityCheck(void)

{
  return;
}



// IOAccelContext2::getDataBufferPrivate(IOAccelResource2*, IOAccelResourcePrivate*, unsigned long
// long)

void IOAccelContext2::getDataBufferPrivate(void)

{
  return;
}



// IOAccelContext2::validateDataBuffer(unsigned long long, IOBufferMemoryDescriptor*,
// IOAccelResource2*)

undefined8 IOAccelContext2::validateDataBuffer(void)

{
  return 0;
}



// IOAccelContext2::invalidate()

void IOAccelContext2::invalidate(void)

{
  return;
}



// IOAccelContext2::getFrameDelimiter()

undefined8 IOAccelContext2::getFrameDelimiter(void)

{
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelContext_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelContext2::gMetaClass,"IOAccelContext2",
             (OSMetaClass *)&IOAccelSubmitter2::gMetaClass,0x10a8);
  _gMetaClass = &PTR__MetaClass_0006f2c8;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelContext2::gMetaClass);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLDrawableUserClient::s_set_surface(IOAccelGLDrawableUserClient*, void*,
// IOExternalMethodArguments*)

void __cdecl
IOAccelGLDrawableUserClient::s_set_surface
          (IOAccelGLDrawableUserClient *param_1,undefined8 param_2,long param_3)

{
  set_surface(param_1,*(ulong **)(param_3 + 0x30));
  return;
}



// IOAccelGLDrawableUserClient::s_set_surface_get_config_status(IOAccelGLDrawableUserClient*, void*,
// IOExternalMethodArguments*)

void __thiscall
IOAccelGLDrawableUserClient::s_set_surface_get_config_status
          (IOAccelGLDrawableUserClient *this,undefined8 param_2_00,long param_2)

{
  set_surface_get_config_status(this,*(ulong **)(param_2 + 0x30),*(undefined8 **)(param_2 + 0x58));
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLDrawableUserClient::s_set_swap_rect(IOAccelGLDrawableUserClient*, void*,
// IOExternalMethodArguments*)

undefined8 __cdecl
IOAccelGLDrawableUserClient::s_set_swap_rect(long param_1,undefined8 param_2,long param_3)

{
  undefined2 uVar1;
  undefined2 uVar2;
  undefined2 uVar3;
  undefined2 *puVar4;
  
  puVar4 = *(undefined2 **)(param_3 + 0x20);
  uVar1 = puVar4[4];
  uVar2 = puVar4[8];
  uVar3 = puVar4[0xc];
  *(undefined2 *)(param_1 + 0x10a) = *puVar4;
  *(undefined2 *)(param_1 + 0x10c) = uVar1;
  *(undefined2 *)(param_1 + 0x10e) = uVar2;
  *(undefined2 *)(param_1 + 0x110) = uVar3;
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLDrawableUserClient::s_set_swap_interval(IOAccelGLDrawableUserClient*, void*,
// IOExternalMethodArguments*)

undefined8 __cdecl
IOAccelGLDrawableUserClient::s_set_swap_interval(long param_1,undefined8 param_2,long param_3)

{
  undefined2 uVar1;
  
  uVar1 = (*(undefined2 **)(param_3 + 0x20))[4];
  *(undefined2 *)(param_1 + 0x112) = **(undefined2 **)(param_3 + 0x20);
  *(undefined2 *)(param_1 + 0x114) = uVar1;
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLDrawableUserClient::s_signal_shared_event(IOAccelGLDrawableUserClient*, void*,
// IOExternalMethodArguments*)

void __cdecl
IOAccelGLDrawableUserClient::s_signal_shared_event
          (IOAccelGLDrawableUserClient *param_1,undefined8 param_2,long param_3)

{
  long *plVar1;
  
  plVar1 = *(long **)(param_3 + 0x20);
  signal_shared_event(param_1,*(task **)(param_1 + 0xe0),*plVar1,*(uint *)(plVar1 + 1),plVar1[2]);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLDrawableUserClient::s_create_mach_port_from_iosurface(IOAccelGLDrawableUserClient*,
// void*, IOExternalMethodArguments*)

void __cdecl
IOAccelGLDrawableUserClient::s_create_mach_port_from_iosurface
          (long param_1,undefined8 param_2,long param_3)

{
  create_mach_port_from_iosurface(param_1,(int)**(undefined8 **)(param_3 + 0x20));
  return;
}



// IOAccelGLDrawableUserClient::MetaClass::MetaClass()

void __thiscall IOAccelGLDrawableUserClient::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelGLDrawableUserClient",
             (OSMetaClass *)PTR_gMetaClass_0006b018,0x670);
  *(undefined ***)this = &PTR__MetaClass_00070010;
  return;
}



// IOAccelGLDrawableUserClient::MetaClass::~MetaClass()

void __thiscall IOAccelGLDrawableUserClient::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelGLDrawableUserClient::IOAccelGLDrawableUserClient(OSMetaClass const*)

void __thiscall
IOAccelGLDrawableUserClient::IOAccelGLDrawableUserClient
          (IOAccelGLDrawableUserClient *this,OSMetaClass *param_1)

{
  IOUserClient::IOUserClient((IOUserClient *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelGLDrawableUserClient_0006f620;
  return;
}



// IOAccelGLDrawableUserClient::IOAccelGLDrawableUserClient(OSMetaClass const*)

void __thiscall
IOAccelGLDrawableUserClient::IOAccelGLDrawableUserClient
          (IOAccelGLDrawableUserClient *this,OSMetaClass *param_1)

{
  IOUserClient::IOUserClient((IOUserClient *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelGLDrawableUserClient_0006f620;
  return;
}



// IOAccelGLDrawableUserClient::~IOAccelGLDrawableUserClient()

void __thiscall
IOAccelGLDrawableUserClient::~IOAccelGLDrawableUserClient(IOAccelGLDrawableUserClient *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  return;
}



// IOAccelGLDrawableUserClient::~IOAccelGLDrawableUserClient()

void __thiscall
IOAccelGLDrawableUserClient::~IOAccelGLDrawableUserClient(IOAccelGLDrawableUserClient *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  return;
}



// IOAccelGLDrawableUserClient::~IOAccelGLDrawableUserClient()

void __thiscall
IOAccelGLDrawableUserClient::~IOAccelGLDrawableUserClient(IOAccelGLDrawableUserClient *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  _OSObject_typed_operator_delete(&IOAccelGLDrawableUserClient_ktv,this,0x670);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLDrawableUserClient::operator delete(void*, unsigned long)

void __cdecl IOAccelGLDrawableUserClient::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelGLDrawableUserClient_ktv,param_1,param_2);
  return;
}



// IOAccelGLDrawableUserClient::getMetaClass() const

undefined1 * IOAccelGLDrawableUserClient::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelGLDrawableUserClient::MetaClass::MetaClass()

void __thiscall IOAccelGLDrawableUserClient::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelGLDrawableUserClient",
             (OSMetaClass *)PTR_gMetaClass_0006b018,0x670);
  *(undefined ***)this = &PTR__MetaClass_00070010;
  return;
}



// IOAccelGLDrawableUserClient::MetaClass::alloc() const

IOUserClient * IOAccelGLDrawableUserClient::MetaClass::alloc(void)

{
  IOUserClient *this;
  
  this = (IOUserClient *)_OSObject_typed_operator_new(&IOAccelGLDrawableUserClient_ktv,0x670);
  IOUserClient::IOUserClient(this,(OSMetaClass *)&IOAccelGLDrawableUserClient::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelGLDrawableUserClient_0006f620;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelGLDrawableUserClient::operator new(unsigned long)

void * __thiscall IOAccelGLDrawableUserClient::operator_new(IOAccelGLDrawableUserClient *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelGLDrawableUserClient_ktv,this);
  return pvVar1;
}



// IOAccelGLDrawableUserClient::IOAccelGLDrawableUserClient()

void __thiscall
IOAccelGLDrawableUserClient::IOAccelGLDrawableUserClient(IOAccelGLDrawableUserClient *this)

{
  IOUserClient::IOUserClient((IOUserClient *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelGLDrawableUserClient_0006f620;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelGLDrawableUserClient::IOAccelGLDrawableUserClient()

void __thiscall
IOAccelGLDrawableUserClient::IOAccelGLDrawableUserClient(IOAccelGLDrawableUserClient *this)

{
  IOUserClient::IOUserClient((IOUserClient *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelGLDrawableUserClient_0006f620;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelGLDrawableUserClient::init(OSDictionary*, task*)

undefined4 __thiscall
IOAccelGLDrawableUserClient::init
          (IOAccelGLDrawableUserClient *this,undefined8 param_2_00,undefined8 param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  long lVar3;
  
  uVar1 = (**(code **)(PTR_vtable_0006b088 + 600))();
  if ((char)uVar1 != '\0') {
    _task_reference(param_2);
    *(undefined8 *)(this + 0xe0) = param_2;
    lVar3 = _get_bsdtask_info(param_2);
    if (lVar3 == 0) {
      uVar2 = 0xffffffff;
    }
    else {
      uVar2 = _proc_pid(lVar3);
    }
    *(undefined4 *)(this + 0xe8) = uVar2;
  }
  return uVar1;
}



// IOAccelGLDrawableUserClient::attach(IOService*)

void __thiscall
IOAccelGLDrawableUserClient::attach(IOAccelGLDrawableUserClient *this,undefined8 param_1)

{
  char cVar1;
  
  cVar1 = (**(code **)(PTR_vtable_0006b088 + 0x680))();
  if (cVar1 != '\0') {
    *(undefined8 *)(this + 0xf8) = param_1;
  }
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLDrawableUserClient::start(IOService*)

bool __cdecl IOAccelGLDrawableUserClient::start(long *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  char cVar2;
  undefined1 uVar3;
  bool bVar4;
  
  cVar2 = (**(code **)(PTR_vtable_0006b088 + 0x5d0))();
  if (cVar2 == '\0') {
    bVar4 = false;
  }
  else {
    pIVar1 = (IOGraphicsAccelerator2 *)param_1[0x1f];
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    uVar3 = (**(code **)(*param_1 + 0x960))(param_1);
    *(undefined1 *)(param_1 + 0x21) = uVar3;
    pIVar1 = (IOGraphicsAccelerator2 *)param_1[0x1f];
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
    bVar4 = (char)param_1[0x21] != '\0';
  }
  return bVar4;
}



// IOGraphicsAccelerator2::acceleratorUnlock()

void __thiscall IOGraphicsAccelerator2::acceleratorUnlock(IOGraphicsAccelerator2 *this)

{
  (**(code **)(*(long *)this + 0x858))(this,"",0);
  unlock_busy(this);
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  return;
}



// IOAccelGLDrawableUserClient::stopLocked()

void __thiscall IOAccelGLDrawableUserClient::stopLocked(IOAccelGLDrawableUserClient *this)

{
  (**(code **)(*(long *)this + 0x968))();
  this[0x108] = (IOAccelGLDrawableUserClient)0x0;
  (**(code **)(PTR_vtable_0006b088 + 0x5d8))(this,*(undefined8 *)(this + 0xf8));
  (**(code **)(*(long *)this + 0x678))(this,*(undefined8 *)(this + 0xf8));
                    // WARNING: Could not recover jumptable at 0x0000c841. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x28))(this);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLDrawableUserClient::stop(IOService*)

void __cdecl IOAccelGLDrawableUserClient::stop(long *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  
  pIVar1 = (IOGraphicsAccelerator2 *)param_1[0x1f];
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  (**(code **)(*param_1 + 0x968))(param_1);
  *(undefined1 *)(param_1 + 0x21) = 0;
  (**(code **)(PTR_vtable_0006b088 + 0x5d8))(param_1,param_1[0x1f]);
  (**(code **)(*param_1 + 0x678))(param_1,param_1[0x1f]);
  (**(code **)(*param_1 + 0x28))(param_1);
  pIVar1 = (IOGraphicsAccelerator2 *)param_1[0x1f];
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return;
}



// IOAccelGLDrawableUserClient::clientClose()

undefined8 __thiscall IOAccelGLDrawableUserClient::clientClose(IOAccelGLDrawableUserClient *this)

{
  if (this[0x108] == (IOAccelGLDrawableUserClient)0x0) {
    if (*(long *)(this + 0xf8) != 0) {
      (**(code **)(*(long *)this + 0x678))();
    }
  }
  else {
    (**(code **)(*(long *)this + 0x600))(this,0);
  }
  return 0;
}



// IOAccelGLDrawableUserClient::drawableStart()

undefined8 __thiscall IOAccelGLDrawableUserClient::drawableStart(IOAccelGLDrawableUserClient *this)

{
  undefined8 uVar1;
  
  *(undefined8 *)(this + 0x100) = 0;
  *(undefined8 *)(this + 0xd8) = 0;
  uVar1 = IOAccelGLDrawableUserClientList::addGLDrawableUserClient
                    ((IOAccelGLDrawableUserClientList *)(*(long *)(this + 0xf8) + 0xad8),(long)this)
  ;
  return CONCAT71((int7)((ulong)uVar1 >> 8),1);
}



// IOAccelGLDrawableUserClient::drawableStop()

void __thiscall IOAccelGLDrawableUserClient::drawableStop(IOAccelGLDrawableUserClient *this)

{
  if (*(long **)(this + 0xf0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xf0) + 0x28))();
    *(undefined8 *)(this + 0xf0) = 0;
  }
  IOAccelGLDrawableUserClientList::removeGLDrawableUserClient
            ((IOAccelGLDrawableUserClientList *)(*(long *)(this + 0xf8) + 0xad8),(long)this);
  return;
}



// IOAccelGLDrawableUserClient::free()

void __thiscall IOAccelGLDrawableUserClient::free(IOAccelGLDrawableUserClient *this)

{
  if (*(long *)(this + 0xe0) != 0) {
    _task_deallocate();
  }
                    // WARNING: Could not recover jumptable at 0x0000c9e2. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b088 + 0xa0))(this);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLDrawableUserClient::externalMethod(unsigned int, IOExternalMethodArguments*,
// IOExternalMethodDispatch*, OSObject*, void*)

undefined8 __cdecl IOAccelGLDrawableUserClient::externalMethod(long param_1)

{
  undefined8 uVar1;
  
  if (*(char *)(param_1 + 0x108) == '\0') {
    return 0xe00002d8;
  }
                    // WARNING: Could not recover jumptable at 0x0000ca27. Too many branches
                    // WARNING: Treating indirect jump as call
  uVar1 = (**(code **)(PTR_vtable_0006b088 + 0x860))();
  return uVar1;
}



// IOAccelGLDrawableUserClient::set_client_info(IOAccelClientInfo*, unsigned long long)

undefined8 __thiscall
IOAccelGLDrawableUserClient::set_client_info
          (IOAccelGLDrawableUserClient *this,char *param_1,long param_2)

{
  undefined8 uVar1;
  
  uVar1 = 0xe00002c2;
  if (param_2 == 0x400) {
    _strlcpy((char *)(this + 0x22c),param_1,0x400);
    uVar1 = 0;
  }
  return uVar1;
}



// IOAccelGLDrawableUserClient::contextModeBits()

undefined8 IOAccelGLDrawableUserClient::contextModeBits(void)

{
  return 0x300803fc0;
}



// IOAccelGLDrawableUserClient::getSurfaceReqBits()

undefined4 __thiscall
IOAccelGLDrawableUserClient::getSurfaceReqBits(IOAccelGLDrawableUserClient *this)

{
  return *(undefined4 *)(this + 0x118);
}



// IOAccelGLDrawableUserClient::requiresBackingStore()

IOAccelGLDrawableUserClient __thiscall
IOAccelGLDrawableUserClient::requiresBackingStore(IOAccelGLDrawableUserClient *this)

{
  return this[0x11c];
}



// IOAccelGLDrawableUserClient::add_task_surface_to_array(OSArray*)

void __thiscall
IOAccelGLDrawableUserClient::add_task_surface_to_array
          (IOAccelGLDrawableUserClient *this,long *param_1)

{
  short sVar1;
  long lVar2;
  long *plVar3;
  long *plVar4;
  
  lVar2 = *(long *)(this + 0x100);
  if (lVar2 != 0) {
    plVar3 = (long *)OSDictionary::withCapacity(1);
    sVar1 = *(short *)(lVar2 + 0x166);
    plVar4 = (long *)OSNumber::withNumber((ulong)(uint)(int)*(short *)(lVar2 + 0x164),0x10);
    (**(code **)(*plVar3 + 0x1d0))(plVar3,"width",plVar4);
    (**(code **)(*plVar4 + 0x28))(plVar4);
    plVar4 = (long *)OSNumber::withNumber((long)sVar1 & 0xffffffff,0x10);
    (**(code **)(*plVar3 + 0x1d0))(plVar3,"height",plVar4);
    (**(code **)(*plVar4 + 0x28))(plVar4);
    plVar4 = (long *)OSString::withCString("ctx");
    (**(code **)(*plVar3 + 0x1d0))(plVar3,"surfaceType",plVar4);
    (**(code **)(*plVar4 + 0x28))(plVar4);
    plVar4 = (long *)OSNumber::withNumber((ulong)*(uint *)(this + 0xe8),0x20);
    (**(code **)(*plVar3 + 0x1d0))(plVar3,"pid",plVar4);
    (**(code **)(*plVar4 + 0x28))(plVar4);
    (**(code **)(*param_1 + 0x1b8))(param_1,plVar3);
                    // WARNING: Could not recover jumptable at 0x0000cbad. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*plVar3 + 0x28))(plVar3);
    return;
  }
  return;
}



// IOAccelGLDrawableUserClient::set_compatible_surface_mode(unsigned long long*, unsigned long long,
// unsigned int)

undefined1 IOAccelGLDrawableUserClient::set_compatible_surface_mode(void)

{
  return 1;
}



// IOAccelGLDrawableUserClient::remove_surface(IOAccelSurfaceMTL*)

void __thiscall
IOAccelGLDrawableUserClient::remove_surface(IOAccelGLDrawableUserClient *this,long param_1)

{
  if (*(long *)(this + 0x100) != param_1) {
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0000cbdb. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x9b8))();
  return;
}



// IOAccelGLDrawableUserClient::invalidate()

void IOAccelGLDrawableUserClient::invalidate(void)

{
  return;
}



// IOAccelGLDrawableUserClient::removeSurface()

void __thiscall IOAccelGLDrawableUserClient::removeSurface(IOAccelGLDrawableUserClient *this)

{
  *(undefined8 *)(this + 0x100) = 0;
  return;
}



// IOAccelGLDrawableUserClient::allowsExclusiveMode()

undefined8 IOAccelGLDrawableUserClient::allowsExclusiveMode(void)

{
  return 0;
}



// IOAccelGLDrawableUserClient::isTripleBuffered()

undefined8 IOAccelGLDrawableUserClient::isTripleBuffered(void)

{
  return 0;
}



// IOAccelGLDrawableUserClient::set_surface(IOAccelGLDrawableClientSetSurfaceData*)

undefined8 __thiscall
IOAccelGLDrawableUserClient::set_surface(IOAccelGLDrawableUserClient *this,ulong *param_1)

{
  int iVar1;
  IOGraphicsAccelerator2 *pIVar2;
  ulong uVar3;
  uint uVar4;
  uint uVar5;
  IOAccelSurfaceMTL *this_00;
  ulong uVar6;
  uint uVar7;
  uint uVar8;
  bool bVar9;
  uint uVar10;
  ulong uVar11;
  uint uVar12;
  undefined8 uVar13;
  
  uVar11 = *param_1;
  if ((uVar11 & 0x7f803f) != 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Context mode contains surface mode bits\n",
                      "IOReturn IOAccelGLDrawableUserClient::set_surface(sIOAccelGLDrawableClientSetSurfaceData *)"
                     );
    return 0xe00002c2;
  }
  iVar1 = (int)param_1[1];
  uVar12 = (uint)param_1[2];
  uVar5 = *(uint *)((long)param_1 + 0x14);
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar2 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar2 + 0x88));
  _OSDecrementAtomic(pIVar2 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar2);
  this_00 = (IOAccelSurfaceMTL *)0x0;
  (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
  if (iVar1 != 0) {
    this_00 = (IOAccelSurfaceMTL *)
              IOAccelSurfaceMTLList::findSurfaceForID
                        ((IOAccelSurfaceMTLList *)(*(long *)(this + 0xf8) + 0xac0),iVar1);
    if (this_00 == (IOAccelSurfaceMTL *)0x0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Invalid surface ID = %u\n",
                        "IOReturn IOAccelGLDrawableUserClient::set_surface(sIOAccelGLDrawableClientSetSurfaceData *)"
                        ,iVar1);
LAB_0000ce6d:
      pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
      (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar2);
      _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
      return 0xe00002c2;
    }
    uVar3 = *(ulong *)(this_00 + 0x158);
    if ((uVar3 & 0x700000) == 0) {
      if (uVar12 != 0 || uVar5 != 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Invalid face = %u or level = %u\n",
                          "IOReturn IOAccelGLDrawableUserClient::set_surface(sIOAccelGLDrawableClientSetSurfaceData *)"
                          ,uVar12,uVar5);
        goto LAB_0000ce6d;
      }
    }
    else {
      if (((uint)uVar3 & 0x700000) == 0x300000) {
        if (5 < uVar12) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Invalid face = %u\n",
                            "IOReturn IOAccelGLDrawableUserClient::set_surface(sIOAccelGLDrawableClientSetSurfaceData *)"
                            ,uVar12);
          goto LAB_0000cedd;
        }
      }
      else if (uVar12 != 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Invalid face = %u\n",
                          "IOReturn IOAccelGLDrawableUserClient::set_surface(sIOAccelGLDrawableClientSetSurfaceData *)"
                          ,uVar12);
        goto LAB_0000ce6d;
      }
      if (((uint)(uVar3 >> 0x10) & 0xf) < uVar5) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Invalid level = %u\n",
                          "IOReturn IOAccelGLDrawableUserClient::set_surface(sIOAccelGLDrawableClientSetSurfaceData *)"
                          ,uVar5);
LAB_0000cedd:
        IOGraphicsAccelerator2::acceleratorUnlock(*(IOGraphicsAccelerator2 **)(this + 0xf8));
        return 0xe00002c2;
      }
    }
  }
  if (*(IOAccelSurfaceMTL **)(this + 0x100) != (IOAccelSurfaceMTL *)0x0) {
    IOAccelSurfaceMTL::remove_drawable_from_list(*(IOAccelSurfaceMTL **)(this + 0x100),(long)this);
    if (*(IOAccelSurfaceMTL **)(this + 0x100) != this_00) {
      IOAccelSurfaceMTL::prune_buffers(*(IOAccelSurfaceMTL **)(this + 0x100));
    }
  }
  if (this_00 == (IOAccelSurfaceMTL *)0x0) {
    *(undefined8 *)(this + 0x100) = 0;
    uVar12 = 0;
    uVar5 = 0;
    uVar13 = 0;
    goto LAB_0000d0e3;
  }
  if ((*(ulong *)(this_00 + 0x158) & 0xc00) != 0) {
    if (((uint)*(ulong *)(this_00 + 0x158) >> 0xb & 1) == 0) {
      uVar11 = uVar11 & 0xfffffffffffff3ff | 0x400;
    }
    else {
      uVar11 = uVar11 & 0xfffffffffffff3ff | 0x800;
    }
  }
  if (this_00 != *(IOAccelSurfaceMTL **)(this + 0x100)) {
    IOAccelSurfaceMTL::reset_req_bits(this_00);
  }
  uVar6 = IOAccelSurfaceMTL::set_compatible_surface_mode(this_00,(long *)this,uVar11);
  uVar3 = *(ulong *)(this_00 + 0x158);
  uVar10 = (uint)uVar11;
  if ((uVar3 & 0x700000) == 0) {
    if (((uVar12 == 0 && uVar5 == 0) & (byte)uVar6) == 1) goto LAB_0000cf62;
  }
  else {
    bVar9 = uVar12 == 0;
    if (((uint)uVar3 & 0x700000) == 0x300000) {
      bVar9 = uVar12 < 6;
    }
    if ((byte)(uVar5 <= ((uint)(uVar3 >> 0x10) & 0xf) & bVar9 & (byte)uVar6) != 0) {
LAB_0000cf62:
      *(undefined4 *)(this + 0x118) = 0;
      this[0x11c] = (IOAccelGLDrawableUserClient)((byte)(uVar11 >> 0x17) & 1);
      this[0x11d] = (IOAccelGLDrawableUserClient)((byte)(uVar11 >> 0x21) & 1);
      uVar7 = (uint)(uVar11 >> 2);
      uVar7 = uVar7 & 0x400 |
              uVar10 & 0x80 | uVar7 & 0x10 | (uint)(uVar11 >> 0xb) & 1 | (uint)(uVar11 >> 9) & 2;
      if ((uVar11 & 0x1cc0) != 0) {
        *(uint *)(this + 0x118) = uVar7;
      }
      if ((uVar11 & 0x300) != 0) {
        uVar7 = (uint)(uVar11 >> 8) & 0x20 | uVar7;
        uVar4 = uVar7 | 4;
        *(uint *)(this + 0x118) = uVar4;
        uVar8 = (uint)(uVar11 & 0x300);
        if ((uVar10 >> 0xe & 1) == 0) {
          if (0x1ff < uVar8) {
            uVar10 = uVar10 >> 7 & 0x40 | uVar4 | 8;
LAB_0000d0b0:
            *(uint *)(this + 0x118) = uVar10;
          }
        }
        else {
          uVar7 = uVar7 | 0x104;
          *(uint *)(this + 0x118) = uVar7;
          if (0x1ff < uVar8) {
            uVar10 = uVar10 >> 7 & 0x40 | uVar7 | 0x208;
            goto LAB_0000d0b0;
          }
        }
      }
      IOAccelSurfaceMTL::add_drawable_to_list(this_00,(long *)this);
      *(IOAccelSurfaceMTL **)(this + 0x100) = this_00;
      IOAccelSurfaceMTL::prune_buffers(this_00);
      IOAccelSurfaceMTL::update_shape(*(IOAccelSurfaceMTL **)(this + 0x100));
      uVar13 = 0;
      goto LAB_0000d0e3;
    }
  }
  if (*(IOAccelSurfaceMTL **)(this + 0x100) == this_00) {
    IOAccelSurfaceMTL::prune_buffers(this_00);
    IOAccelSurfaceMTL::update_shape(*(IOAccelSurfaceMTL **)(this + 0x100));
  }
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Bad match mode = 0x%X\n",
                    "IOReturn IOAccelGLDrawableUserClient::set_surface(sIOAccelGLDrawableClientSetSurfaceData *)"
                    ,uVar11 & 0xffffffff);
  *(undefined8 *)(this + 0x100) = 0;
  uVar13 = 0xe00002c2;
LAB_0000d0e3:
  *(uint *)(this + 0x120) = uVar12;
  *(uint *)(this + 0x124) = uVar5;
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar2);
  _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
  return uVar13;
}



// IOAccelGLDrawableUserClient::set_swap_rect(int, int, int, int)

undefined8 __thiscall
IOAccelGLDrawableUserClient::set_swap_rect
          (IOAccelGLDrawableUserClient *this,undefined2 param_1,undefined2 param_2,
          undefined2 param_3,undefined2 param_4)

{
  *(undefined2 *)(this + 0x10a) = param_1;
  *(undefined2 *)(this + 0x10c) = param_2;
  *(undefined2 *)(this + 0x10e) = param_3;
  *(undefined2 *)(this + 0x110) = param_4;
  return 0;
}



// IOAccelGLDrawableUserClient::set_swap_interval(int, int)

undefined8 __thiscall
IOAccelGLDrawableUserClient::set_swap_interval
          (IOAccelGLDrawableUserClient *this,undefined2 param_1,undefined2 param_2)

{
  *(undefined2 *)(this + 0x112) = param_1;
  *(undefined2 *)(this + 0x114) = param_2;
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLDrawableUserClient::create_mach_port_from_iosurface(unsigned long long, unsigned int*)

undefined4 __cdecl
IOAccelGLDrawableUserClient::create_mach_port_from_iosurface(long param_1,int param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined4 uVar2;
  uint *puVar3;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(param_1 + 0xf8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  uVar2 = 0xe00002c2;
  if (*(IOAccelSurfaceMTL **)(param_1 + 0x100) != (IOAccelSurfaceMTL *)0x0) {
    puVar3 = (uint *)IOAccelSurfaceMTL::getSurfaceBuffer
                               (*(IOAccelSurfaceMTL **)(param_1 + 0x100),param_2);
    if (puVar3 != (uint *)0x0) {
      uVar2 = IOSurfaceRoot::copyPortNameForSurfaceInTask
                        (*(task **)(*(long *)(param_1 + 0xf8) + 0x170),
                         *(IOSurface **)(param_1 + 0xe0),puVar3);
    }
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(param_1 + 0xf8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLDrawableUserClient::set_surface_get_config_status(IOAccelGLDrawableClientSetSurfaceData*,
// IOAccelGLDrawableClientGetConfigStatus*, unsigned long long, unsigned long long*)

ulong __cdecl
IOAccelGLDrawableUserClient::set_surface_get_config_status
          (IOAccelGLDrawableUserClient *param_1,ulong *param_2,undefined8 *param_3)

{
  uint uVar1;
  IOGraphicsAccelerator2 *pIVar2;
  long *plVar3;
  long lVar4;
  ulong uVar5;
  undefined8 uVar6;
  IOAccelSurfaceMTL *this;
  bool bVar7;
  undefined4 local_68;
  undefined2 local_64;
  undefined2 local_62;
  undefined2 local_60;
  undefined2 local_5e;
  undefined1 *local_5c;
  undefined1 *local_54;
  undefined1 *local_4c;
  undefined1 *local_44;
  uint local_3c;
  undefined8 *local_38;
  
  if (((int)param_2[1] != 0) && (*(int *)((long)param_2 + 0xc) != -1)) {
    pIVar2 = *(IOGraphicsAccelerator2 **)(param_1 + 0xf8);
    local_38 = param_3;
    _OSIncrementAtomic(pIVar2 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar2 + 0x88));
    _OSDecrementAtomic(pIVar2 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar2);
    (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
    lVar4 = IOAccelSurfaceMTLList::findSurfaceForID
                      ((IOAccelSurfaceMTLList *)(*(long *)(param_1 + 0xf8) + 0xac0),(int)param_2[1])
    ;
    if (lVar4 == 0) {
      bVar7 = true;
      uVar5 = 0;
    }
    else {
      bVar7 = ((uint)*(undefined8 *)(lVar4 + 0x158) & 0xf) == (*(uint *)((long)param_2 + 0xc) & 0xf)
      ;
      uVar5 = 0xe00002bc;
      if (bVar7) {
        uVar5 = 0;
      }
    }
    pIVar2 = *(IOGraphicsAccelerator2 **)(param_1 + 0xf8);
    (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar2);
    _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
    param_3 = local_38;
    if (!bVar7) {
      return uVar5;
    }
  }
  uVar5 = set_surface(param_1,param_2);
  if ((int)uVar5 == 0) {
    if (*(int *)((long)param_2 + 0x1c) != 0) {
      pIVar2 = *(IOGraphicsAccelerator2 **)(param_1 + 0xf8);
      _OSIncrementAtomic(pIVar2 + 0x90);
      _IOLockLock(*(undefined8 *)(pIVar2 + 0x88));
      _OSDecrementAtomic(pIVar2 + 0x90);
      IOGraphicsAccelerator2::lock_busy(pIVar2);
      (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
      uVar1 = (uint)param_2[4];
      if ((uVar1 & 1) == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: No surface option\n",
                          "IOReturn IOAccelGLDrawableUserClient::set_surface_get_config_status(sIOAccelGLDrawableClientSetSurfaceData *, sIOAccelGLDrawableClientGetConfigStatus *, IOByteCount, IOByteCount *)"
                         );
        uVar5 = 0xe00002c7;
      }
      else {
        local_44 = &DAT_aaaaaaaaaaaaaaaa;
        local_4c = &DAT_aaaaaaaaaaaaaaaa;
        local_54 = &DAT_aaaaaaaaaaaaaaaa;
        local_5c = &DAT_aaaaaaaaaaaaaaaa;
        local_68 = 0;
        local_64 = *(undefined2 *)((long)param_2 + 0x24);
        local_62 = (undefined2)param_2[5];
        this = *(IOAccelSurfaceMTL **)(param_1 + 0x100);
        local_60 = local_64;
        local_5e = local_62;
        local_38 = param_3;
        if (this != (IOAccelSurfaceMTL *)0x0) {
          local_3c = uVar1 & 2 | uVar1 >> 2 & 1;
          do {
            if (this[0xf2] == (IOAccelSurfaceMTL)0x0) {
              uVar5 = IOAccelSurfaceMTL::set_scaling(this,(ulong)local_3c,(long)&local_68);
              uVar5 = uVar5 & 0xffffffff;
              param_3 = local_38;
              goto LAB_0000d567;
            }
            if (___ktrace_kernel_enabled != 0) {
              _kernel_debug(0x85020075,0,0,0,0,0);
              this = *(IOAccelSurfaceMTL **)(param_1 + 0x100);
            }
            plVar3 = *(long **)(param_1 + 0xf8);
            (**(code **)(*plVar3 + 0x858))(plVar3,"",0);
            _IOLockSleep_darwin14(plVar3[0x11],this,0);
            (**(code **)(*plVar3 + 0x850))(plVar3,"",0);
            if (___ktrace_kernel_enabled != 0) {
              _kernel_debug(0x85020076,0,0,0,0,0);
            }
            this = *(IOAccelSurfaceMTL **)(param_1 + 0x100);
          } while (this != (IOAccelSurfaceMTL *)0x0);
        }
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: No surface\n",
                          "IOReturn IOAccelGLDrawableUserClient::set_surface_get_config_status(sIOAccelGLDrawableClientSetSurfaceData *, sIOAccelGLDrawableClientGetConfigStatus *, IOByteCount, IOByteCount *)"
                         );
        uVar5 = 0xe00002c7;
        param_3 = local_38;
      }
LAB_0000d567:
      pIVar2 = *(IOGraphicsAccelerator2 **)(param_1 + 0xf8);
      (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar2);
      _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
      if ((int)uVar5 != 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s failed scale_surface\n\n",
                          "IOReturn IOAccelGLDrawableUserClient::set_surface_get_config_status(sIOAccelGLDrawableClientSetSurfaceData *, sIOAccelGLDrawableClientGetConfigStatus *, IOByteCount, IOByteCount *)"
                         );
        return uVar5;
      }
    }
    get_config(param_1,(uint *)(param_3 + 3));
    uVar6 = (**(code **)(**(long **)(param_1 + 0xf8) + 0x868))();
    param_3[4] = uVar6;
    uVar5 = get_surface_size(param_1,(uint *)(param_3 + 1),(uint *)((long)param_3 + 0xc),
                             (uint *)(param_3 + 2),(uint *)((long)param_3 + 0x14));
    if ((int)uVar5 == 0) {
      uVar5 = 0;
      if (*(long *)(param_1 + 0x100) == 0) {
        uVar6 = 0;
      }
      else {
        uVar6 = *(undefined8 *)(*(long *)(param_1 + 0x100) + 0x158);
      }
      *param_3 = uVar6;
    }
    else {
      uVar5 = uVar5 & 0xffffffff;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s failed get_surface_size\n\n",
                        "IOReturn IOAccelGLDrawableUserClient::set_surface_get_config_status(sIOAccelGLDrawableClientSetSurfaceData *, sIOAccelGLDrawableClientGetConfigStatus *, IOByteCount, IOByteCount *)"
                       );
    }
  }
  else {
    uVar5 = uVar5 & 0xffffffff;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s failed set_surface\n\n",
                      "IOReturn IOAccelGLDrawableUserClient::set_surface_get_config_status(sIOAccelGLDrawableClientSetSurfaceData *, sIOAccelGLDrawableClientGetConfigStatus *, IOByteCount, IOByteCount *)"
                     );
  }
  return uVar5;
}



// IOAccelGLDrawableUserClient::get_config(unsigned int*)

undefined8 __thiscall
IOAccelGLDrawableUserClient::get_config(IOAccelGLDrawableUserClient *this,uint *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  *param_1 = (uint)*(ushort *)(pIVar1 + 0xc90);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return 0;
}



// IOAccelGLDrawableUserClient::get_surface_size(unsigned int*, unsigned int*, unsigned int*,
// unsigned int*)

undefined8 __thiscall
IOAccelGLDrawableUserClient::get_surface_size
          (IOAccelGLDrawableUserClient *this,uint *param_1,uint *param_2,uint *param_3,uint *param_4
          )

{
  short sVar1;
  long lVar2;
  undefined8 uVar3;
  int iVar4;
  short *psVar5;
  uint uVar6;
  
  lVar2 = *(long *)(this + 0x100);
  if (lVar2 == 0) {
    uVar3 = 0xe00002bc;
  }
  else {
    sVar1 = *(short *)(lVar2 + 0x164);
    if ((*(short *)(lVar2 + 0x160) == sVar1) &&
       (*(short *)(lVar2 + 0x162) == *(short *)(lVar2 + 0x166))) {
      psVar5 = (short *)(lVar2 + 0x166);
      *param_1 = (int)sVar1;
    }
    else {
      *param_1 = (int)*(short *)(lVar2 + 0x160);
      psVar5 = (short *)(lVar2 + 0x162);
    }
    uVar6 = (uint)*psVar5;
    *param_2 = uVar6;
    if (0 < *(int *)(this + 0x124)) {
      iVar4 = *(int *)(this + 0x124) + 1;
      do {
        if (1 < *param_1) {
          *param_1 = *param_1 >> 1;
          uVar6 = *param_2;
        }
        if (1 < uVar6) {
          uVar6 = uVar6 >> 1;
          *param_2 = uVar6;
        }
        iVar4 = iVar4 + -1;
      } while (1 < iVar4);
    }
    *param_3 = (int)sVar1;
    uVar6 = (uint)*(short *)(lVar2 + 0x166);
    *param_4 = uVar6;
    uVar3 = 0;
    if (0 < *(int *)(this + 0x124)) {
      iVar4 = *(int *)(this + 0x124) + 1;
      do {
        if (1 < *param_3) {
          *param_3 = *param_3 >> 1;
          uVar6 = *param_4;
        }
        if (1 < uVar6) {
          uVar6 = uVar6 >> 1;
          *param_4 = uVar6;
        }
        iVar4 = iVar4 + -1;
      } while (1 < iVar4);
    }
  }
  return uVar3;
}



// IOAccelGLDrawableUserClient::get_status(unsigned int*)

undefined8 IOAccelGLDrawableUserClient::get_status(void)

{
  return 0;
}



// IOAccelGLDrawableUserClient::signal_shared_event(task*, unsigned long long, unsigned int,
// unsigned long long)

ulong __thiscall
IOAccelGLDrawableUserClient::signal_shared_event
          (IOAccelGLDrawableUserClient *this,task *param_1,long param_2,uint param_3,long param_4)

{
  IOGraphicsAccelerator2 *pIVar1;
  uint uVar2;
  long lVar3;
  ulonglong uVar4;
  ulong uVar5;
  OSObject *local_48;
  long local_40;
  uint local_34;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  local_40 = param_4;
  local_34 = param_3;
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  uVar5 = 0xe00002c7;
  if (param_2 == 1) {
    if (*(IOAccelSurfaceMTL **)(this + 0x100) == (IOAccelSurfaceMTL *)0x0) {
      local_48 = (OSObject *)0x0;
      uVar2 = IOUserClient::copyObjectForPortNameInTask(param_1,local_34,&local_48);
      uVar5 = (ulong)uVar2;
      if (uVar2 == 0) {
        lVar3 = OSMetaClassBase::safeMetaCast
                          ((OSMetaClassBase *)local_48,*(OSMetaClass **)PTR_metaClass_0006b048);
        if (lVar3 != 0) {
          uVar4 = IOSurfaceSharedEventReference::getSharedEvent();
          IOSurfaceSharedEvent::signalCompleted(uVar4);
        }
      }
      if (local_48 != (OSObject *)0x0) {
        (**(code **)(*(long *)local_48 + 0x28))();
      }
    }
    else {
      uVar5 = IOAccelSurfaceMTL::signal_shared_event
                        (*(IOAccelSurfaceMTL **)(this + 0x100),param_1,1,local_34,local_40);
      uVar5 = uVar5 & 0xffffffff;
    }
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  }
  return uVar5;
}



// IOAccelGLDrawableUserClient::_RESERVEDIOAccelGLDrawableUserClient0()

void IOAccelGLDrawableUserClient::_RESERVEDIOAccelGLDrawableUserClient0(void)

{
  OSMetaClass::reservedCalled(0x82070);
  return;
}



// IOAccelGLDrawableUserClient::_RESERVEDIOAccelGLDrawableUserClient1()

void IOAccelGLDrawableUserClient::_RESERVEDIOAccelGLDrawableUserClient1(void)

{
  OSMetaClass::reservedCalled(0x82070);
  return;
}



// IOAccelGLDrawableUserClient::_RESERVEDIOAccelGLDrawableUserClient2()

void IOAccelGLDrawableUserClient::_RESERVEDIOAccelGLDrawableUserClient2(void)

{
  OSMetaClass::reservedCalled(0x82070);
  return;
}



// IOAccelGLDrawableUserClient::_RESERVEDIOAccelGLDrawableUserClient3()

void IOAccelGLDrawableUserClient::_RESERVEDIOAccelGLDrawableUserClient3(void)

{
  OSMetaClass::reservedCalled(0x82070);
  return;
}



// IOAccelGLDrawableUserClient::_RESERVEDIOAccelGLDrawableUserClient4()

void IOAccelGLDrawableUserClient::_RESERVEDIOAccelGLDrawableUserClient4(void)

{
  OSMetaClass::reservedCalled(0x82070);
  return;
}



// IOAccelGLDrawableUserClient::_RESERVEDIOAccelGLDrawableUserClient5()

void IOAccelGLDrawableUserClient::_RESERVEDIOAccelGLDrawableUserClient5(void)

{
  OSMetaClass::reservedCalled(0x82070);
  return;
}



// IOAccelGLDrawableUserClient::MetaClass::~MetaClass()

void __thiscall IOAccelGLDrawableUserClient::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelGLDrawableUserClient_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelGLDrawableUserClient::gMetaClass,"IOAccelGLDrawableUserClient",
             (OSMetaClass *)PTR_gMetaClass_0006b018,0x670);
  _gMetaClass = &PTR__MetaClass_00070010;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelGLDrawableUserClient::gMetaClass);
  return;
}



// IOAccelDevice2::MetaClass::MetaClass()

void __thiscall IOAccelDevice2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDevice2",(OSMetaClass *)PTR_gMetaClass_0006b018,0x188);
  *(undefined ***)this = &PTR__MetaClass_00070ad0;
  return;
}



// IOAccelDevice2::MetaClass::~MetaClass()

void __thiscall IOAccelDevice2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelDevice2::IOAccelDevice2(OSMetaClass const*)

void __thiscall IOAccelDevice2::IOAccelDevice2(IOAccelDevice2 *this,OSMetaClass *param_1)

{
  IOUserClient::IOUserClient((IOUserClient *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDevice2_00070110;
  return;
}



// IOAccelDevice2::IOAccelDevice2(OSMetaClass const*)

void __thiscall IOAccelDevice2::IOAccelDevice2(IOAccelDevice2 *this,OSMetaClass *param_1)

{
  IOUserClient::IOUserClient((IOUserClient *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDevice2_00070110;
  return;
}



// IOAccelDevice2::~IOAccelDevice2()

void __thiscall IOAccelDevice2::~IOAccelDevice2(IOAccelDevice2 *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  return;
}



// IOAccelDevice2::~IOAccelDevice2()

void __thiscall IOAccelDevice2::~IOAccelDevice2(IOAccelDevice2 *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  return;
}



// IOAccelDevice2::~IOAccelDevice2()

void __thiscall IOAccelDevice2::~IOAccelDevice2(IOAccelDevice2 *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  _OSObject_typed_operator_delete(&IOAccelDevice2_ktv,this,0x188);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDevice2::operator delete(void*, unsigned long)

void __cdecl IOAccelDevice2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelDevice2_ktv,param_1,param_2);
  return;
}



// IOAccelDevice2::getMetaClass() const

undefined1 * IOAccelDevice2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelDevice2::MetaClass::MetaClass()

void __thiscall IOAccelDevice2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDevice2",(OSMetaClass *)PTR_gMetaClass_0006b018,0x188);
  *(undefined ***)this = &PTR__MetaClass_00070ad0;
  return;
}



// IOAccelDevice2::MetaClass::alloc() const

IOUserClient * IOAccelDevice2::MetaClass::alloc(void)

{
  IOUserClient *this;
  
  this = (IOUserClient *)_OSObject_typed_operator_new(&IOAccelDevice2_ktv,0x188);
  IOUserClient::IOUserClient(this,(OSMetaClass *)&IOAccelDevice2::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDevice2_00070110;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelDevice2::operator new(unsigned long)

void * __thiscall IOAccelDevice2::operator_new(IOAccelDevice2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelDevice2_ktv,this);
  return pvVar1;
}



// IOAccelDevice2::IOAccelDevice2()

void __thiscall IOAccelDevice2::IOAccelDevice2(IOAccelDevice2 *this)

{
  IOUserClient::IOUserClient((IOUserClient *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDevice2_00070110;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDevice2::IOAccelDevice2()

void __thiscall IOAccelDevice2::IOAccelDevice2(IOAccelDevice2 *this)

{
  IOUserClient::IOUserClient((IOUserClient *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDevice2_00070110;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDevice2::init(OSDictionary*, task*)

undefined4 __thiscall
IOAccelDevice2::init(IOAccelDevice2 *this,undefined8 param_2_00,undefined8 param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined8 uVar3;
  long lVar4;
  
  uVar1 = (**(code **)(PTR_vtable_0006b088 + 600))();
  if ((char)uVar1 != '\0') {
    uVar3 = _IOLockAlloc();
    *(undefined8 *)(this + 0x178) = uVar3;
    _task_reference(param_2);
    *(undefined8 *)(this + 0xe8) = param_2;
    lVar4 = _get_bsdtask_info(param_2);
    if (lVar4 == 0) {
      uVar2 = 0xffffffff;
    }
    else {
      uVar2 = _proc_pid(lVar4);
    }
    *(undefined4 *)(this + 0xf0) = uVar2;
  }
  return uVar1;
}



// IOAccelDevice2::start(IOService*)

bool __thiscall IOAccelDevice2::start(IOAccelDevice2 *this,OSMetaClassBase *param_1)

{
  char cVar1;
  IOAccelDevice2 IVar2;
  IOGraphicsAccelerator2 *pIVar3;
  
  cVar1 = (**(code **)(PTR_vtable_0006b088 + 0x5d0))();
  if (cVar1 != '\0') {
    pIVar3 = (IOGraphicsAccelerator2 *)
             OSMetaClassBase::safeMetaCast
                       (param_1,(OSMetaClass *)&IOGraphicsAccelerator2::gMetaClass);
    *(IOGraphicsAccelerator2 **)(this + 0x108) = pIVar3;
    if (pIVar3 != (IOGraphicsAccelerator2 *)0x0) {
      _OSIncrementAtomic(pIVar3 + 0x90);
      _IOLockLock(*(undefined8 *)(pIVar3 + 0x88));
      _OSDecrementAtomic(pIVar3 + 0x90);
      IOGraphicsAccelerator2::lock_busy(pIVar3);
      (**(code **)(*(long *)pIVar3 + 0x850))(pIVar3,"",0);
      IVar2 = (IOAccelDevice2)(**(code **)(*(long *)this + 0x960))(this);
      this[0x111] = IVar2;
      this[0x110] = (IOAccelDevice2)0x0;
      pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0x108);
      (**(code **)(*(long *)pIVar3 + 0x858))(pIVar3,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar3);
      _IOLockUnlock(*(undefined8 *)(pIVar3 + 0x88));
      return this[0x111] != (IOAccelDevice2)0x0;
    }
  }
  return false;
}



// IOAccelDevice2::free()

void __thiscall IOAccelDevice2::free(IOAccelDevice2 *this)

{
  if (*(long *)(this + 0x178) != 0) {
    _IOLockFree();
    *(undefined8 *)(this + 0x178) = 0;
  }
  if (*(long **)(this + 0x170) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x170) + 0x28))();
  }
  *(undefined8 *)(this + 0x170) = 0;
  if (*(long *)(this + 0xe8) != 0) {
    _task_deallocate();
  }
                    // WARNING: Could not recover jumptable at 0x0000dd63. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b088 + 0xa0))(this);
  return;
}



// IOAccelDevice2::requestTerminate(IOService*, unsigned int)

undefined8 IOAccelDevice2::requestTerminate(void)

{
  return 0;
}



// IOAccelDevice2::didTerminate(IOService*, unsigned int, bool*)

void __thiscall
IOAccelDevice2::didTerminate
          (IOAccelDevice2 *this,undefined8 param_1,undefined4 param_2,undefined1 *param_3)

{
  int iVar1;
  IOGraphicsAccelerator2 *this_00;
  
  *param_3 = 1;
  this[0x112] = (IOAccelDevice2)0x1;
  _IOLockLock(*(undefined8 *)(this + 0x178));
  iVar1 = *(int *)(this + 0x180);
  this[0x113] = (IOAccelDevice2)(iVar1 != 0);
  _IOLockUnlock(*(undefined8 *)(this + 0x178));
  if (iVar1 == 0) {
    this_00 = *(IOGraphicsAccelerator2 **)(this + 0x108);
    (**(code **)(*(long *)this_00 + 0x20))(this_00);
    _OSIncrementAtomic(this_00 + 0x90);
    _IOLockLock(*(undefined8 *)(this_00 + 0x88));
    _OSDecrementAtomic(this_00 + 0x90);
    IOGraphicsAccelerator2::lock_busy(this_00);
    (**(code **)(*(long *)this_00 + 0x850))(this_00,"",0);
    detach_device(this);
    (**(code **)(*(long *)this_00 + 0x858))(this_00,"",0);
    IOGraphicsAccelerator2::unlock_busy(this_00);
    _IOLockUnlock(*(undefined8 *)(this_00 + 0x88));
    (**(code **)(*(long *)this_00 + 0x28))(this_00);
  }
                    // WARNING: Could not recover jumptable at 0x0000de83. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b088 + 0x418))(this,param_1,param_2,param_3);
  return;
}



// IOAccelDevice2::detach_device()

void __thiscall IOAccelDevice2::detach_device(IOAccelDevice2 *this)

{
  long *plVar1;
  OSSet *pOVar2;
  undefined8 uVar3;
  OSDictionary *pOVar4;
  long lVar5;
  
  pOVar2 = (OSSet *)OSSet::withCapacity(1);
  (**(code **)(*(long *)this + 0x970))(this);
  plVar1 = *(long **)(this + 0x170);
  if (plVar1 == (long *)0x0) {
    uVar3 = OSSet::withSet(pOVar2,0);
    *(undefined8 *)(this + 0x170) = uVar3;
  }
  else {
    (**(code **)(*plVar1 + 0x1d0))(plVar1,pOVar2);
  }
  (**(code **)(*(long *)pOVar2 + 0x28))(pOVar2);
  (**(code **)(*(long *)this + 0x20))(this);
  (**(code **)(*(long *)this + 0x968))(this);
  this[0x111] = (IOAccelDevice2)0x0;
  (**(code **)(PTR_vtable_0006b088 + 0x5d8))(this,*(undefined8 *)(this + 0x108));
  (**(code **)(*(long *)this + 0x678))(this);
  (**(code **)(*(long *)this + 0x28))(this);
  pOVar4 = (OSDictionary *)IOService::nameMatching("IOResources",(OSDictionary *)0x0);
  lVar5 = IOService::copyMatchingService(pOVar4);
  (**(code **)(*(long *)pOVar4 + 0x28))(pOVar4);
  if (lVar5 != 0) {
    (**(code **)(*(long *)this + 0x670))(this,lVar5);
  }
                    // WARNING: Could not recover jumptable at 0x0000df7f. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x28))(this);
  return;
}



// IOAccelDevice2::add_orphaned_mappings(OSSet*)

void __thiscall IOAccelDevice2::add_orphaned_mappings(IOAccelDevice2 *this,OSSet *param_1)

{
  undefined8 uVar1;
  
  if (*(long **)(this + 0x170) != (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0000dfa7. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0x170) + 0x1d0))();
    return;
  }
  uVar1 = OSSet::withSet(param_1,0);
  *(undefined8 *)(this + 0x170) = uVar1;
  return;
}



// IOAccelDevice2::stopLocked()

void __thiscall IOAccelDevice2::stopLocked(IOAccelDevice2 *this)

{
  (**(code **)(*(long *)this + 0x968))();
  this[0x111] = (IOAccelDevice2)0x0;
  (**(code **)(PTR_vtable_0006b088 + 0x5d8))(this,*(undefined8 *)(this + 0x108));
  (**(code **)(*(long *)this + 0x678))(this,*(undefined8 *)(this + 0x108));
                    // WARNING: Could not recover jumptable at 0x0000e011. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x28))(this);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDevice2::orphanClientMappings(OSSet*)

void __cdecl IOAccelDevice2::orphanClientMappings(long param_1,long *param_2,undefined8 param_3)

{
  if (*(long *)(param_1 + 0x120) != 0) {
                    // WARNING: Could not recover jumptable at 0x0000e035. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*param_2 + 0x1c0))
              (param_2,*(long *)(param_1 + 0x120),param_3,*(code **)(*param_2 + 0x1c0));
    return;
  }
  return;
}



// IOAccelDevice2::get_config(IOAccelDeviceConfigData*)

undefined8 __thiscall IOAccelDevice2::get_config(IOAccelDevice2 *this,uint *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  long *plVar2;
  undefined8 uVar3;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x108);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  plVar2 = *(long **)(this + 0x108);
  *param_1 = *(uint *)(plVar2 + 0x192) >> 9 & 0x1000 | *(uint *)(plVar2 + 0x192) & 0xffff;
  param_1[1] = *(uint *)(plVar2 + 0x193);
  *(long *)(param_1 + 4) = plVar2[0x195];
  uVar3 = (**(code **)(*plVar2 + 0x868))();
  *(undefined8 *)(param_1 + 2) = uVar3;
  plVar2 = *(long **)(this + 0x108);
  param_1[6] = *(uint *)(plVar2 + 0x2f);
  uVar3 = (**(code **)(*plVar2 + 0x990))();
  *(undefined8 *)(param_1 + 8) = uVar3;
  uVar3 = (**(code **)(**(long **)(this + 0x108) + 0xa90))();
  *(undefined8 *)(param_1 + 10) = uVar3;
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x108);
  *(undefined8 *)(param_1 + 0xc) = *(undefined8 *)(pIVar1 + 0xd10);
  param_1[0xe] = (uint)*(ushort *)(pIVar1 + 0xd18);
  param_1[0xf] = (uint)*(ushort *)(pIVar1 + 0xd1a);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return 0;
}



// IOAccelDevice2::get_name(char*)

undefined8 __thiscall IOAccelDevice2::get_name(IOAccelDevice2 *this,long param_1)

{
  ___strncpy_chk(param_1,*(undefined8 *)(*(long *)(this + 0x108) + 0xc88),0x40,0xffffffffffffffff);
  *(undefined1 *)(param_1 + 0x3f) = 0;
  return 0;
}



// IOAccelDevice2::get_event_machine(IOAccelDeviceEventMachineData*)

undefined8 __thiscall IOAccelDevice2::get_event_machine(IOAccelDevice2 *this,long *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  int iVar2;
  undefined4 uVar3;
  long lVar4;
  char *pcVar5;
  ulong uVar6;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x108);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  lVar4 = (**(code **)(**(long **)(this + 0x120) + 0x118))();
  *param_1 = (ulong)*(uint *)(this + 0x128) + lVar4;
  lVar4 = *(long *)(this + 0x108);
  *(undefined4 *)(param_1 + 1) = *(undefined4 *)(lVar4 + 0xce0);
  *(undefined4 *)((long)param_1 + 0xc) = *(undefined4 *)(lVar4 + 0xce4);
  *(undefined4 *)(param_1 + 2) = *(undefined4 *)(lVar4 + 0xce8);
  pcVar5 = (char *)(**(code **)(**(long **)(lVar4 + 0x380) + 0x120))();
  _strlcpy((char *)(param_1 + 3),pcVar5,0x40);
  iVar2 = (**(code **)(**(long **)(*(long *)(this + 0x108) + 0x380) + 0x128))();
  *(int *)((long)param_1 + 0x14) = iVar2;
  if (0 < iVar2) {
    uVar6 = 0;
    do {
      uVar3 = (**(code **)(**(long **)(*(long *)(this + 0x108) + 0x380) + 0x138))
                        (*(long **)(*(long *)(this + 0x108) + 0x380),uVar6 & 0xffffffff);
      *(undefined4 *)((long)param_1 + uVar6 * 4 + 0x58) = uVar3;
      uVar6 = uVar6 + 1;
    } while ((long)uVar6 < (long)*(int *)((long)param_1 + 0x14));
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x108);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return 0;
}



// IOAccelDevice2::get_surface_info(unsigned int, IOAccelDeviceSurfaceData*)

ulong __thiscall IOAccelDevice2::get_surface_info(IOAccelDevice2 *this,int param_1,ulong *param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  undefined *puVar3;
  long lVar4;
  long lVar5;
  ulong uVar6;
  undefined4 uVar7;
  uint uVar8;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x108);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  uVar7 = 0;
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (param_1 != 0) {
    lVar4 = IOAccelSurfaceList::findSurfaceForID
                      ((IOAccelSurfaceList *)(*(long *)(this + 0x108) + 0xaa8),param_1);
    if (lVar4 != 0) {
      uVar2 = *(ulong *)((long)&DAT_000011b0 + lVar4);
      *param_2 = uVar2;
      uVar6 = 0x200;
      if (((*(uint *)((long)&DAT_00001190 + lVar4) & 0x80) != 0) ||
         (uVar6 = 0x100, (*(uint *)((long)&DAT_00001190 + lVar4) & 0x40) != 0)) {
        *param_2 = uVar2 | uVar6;
      }
      if ((*(short *)(&DAT_000011b8 + lVar4) == *(short *)(&DAT_000011bc + lVar4)) &&
         (*(short *)(&DAT_000011ba + lVar4) == *(short *)(&DAT_000011be + lVar4))) {
        puVar3 = &DAT_000011be;
        *(int *)(param_2 + 1) = (int)*(short *)(&DAT_000011bc + lVar4);
      }
      else {
        *(int *)(param_2 + 1) = (int)*(short *)(&DAT_000011b8 + lVar4);
        puVar3 = &DAT_000011ba;
      }
      *(int *)((long)param_2 + 0xc) = (int)*(short *)(puVar3 + lVar4);
      lVar4 = *(long *)(&DAT_000011c0 + lVar4);
      if (lVar4 == 0) {
        *(undefined4 *)(param_2 + 2) = 0;
        uVar7 = 0;
      }
      else {
        lVar5 = *(long *)(lVar4 + 0xb8);
        if (lVar5 == 0) {
          lVar5 = *(long *)(lVar4 + 0xc0);
        }
        *(int *)(param_2 + 2) = (int)lVar5;
        uVar7 = *(undefined4 *)(lVar4 + 200 + (ulong)(*(long *)(lVar4 + 0x88) == 0) * 8);
      }
      uVar8 = 0;
      goto LAB_0000e45e;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Invalid surface ID = %u\n",
                      "IOReturn IOAccelDevice2::get_surface_info(uint32_t, sIOAccelDeviceSurfaceData *)"
                      ,param_1);
  }
  *param_2 = 0;
  param_2[1] = 0;
  *(undefined4 *)(param_2 + 2) = 0;
  uVar8 = 0xe00002c2;
LAB_0000e45e:
  *(undefined4 *)((long)param_2 + 0x14) = uVar7;
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x108);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return (ulong)uVar8;
}



// IOAccelDevice2::set_stereo(unsigned int, unsigned int)

undefined8 IOAccelDevice2::set_stereo(void)

{
  return 0xe00002c7;
}



// IOAccelDevice2::get_next_global_object_id(IOAccelDeviceGlobalObjectIDData*)

undefined8 __thiscall
IOAccelDevice2::get_next_global_object_id(undefined8 param_1_00,undefined8 *param_2)

{
  undefined8 uVar1;
  
  uVar1 = _OSAddAtomic64(1,&___globalObjectIDCounter);
  *param_2 = uVar1;
  return 0;
}



// IOAccelDevice2::get_current_trace_filter(IOAccelDeviceTraceFilterData*)

undefined8 __thiscall
IOAccelDevice2::get_current_trace_filter(undefined8 param_1_00,undefined8 *param_2)

{
  *param_2 = 0;
  return 0;
}



// IOAccelDevice2::get_device_info(IOAccelDeviceInfoReturnData*)

undefined8 __thiscall IOAccelDevice2::get_device_info(IOAccelDevice2 *this,undefined8 *param_1)

{
  undefined4 uVar1;
  long *plVar2;
  undefined8 uVar3;
  
  *param_1 = *(undefined8 *)(this + 0xf8);
  plVar2 = *(long **)(this + 0x100);
  if (plVar2 == (long *)0x0) {
    plVar2 = (long *)IOGraphicsAccelerator2::createGlobalCommPageClientMapping
                               (*(undefined8 *)(this + 0x108),*(ulonglong *)(this + 0xe8));
    *(long **)(this + 0x100) = plVar2;
    if (plVar2 == (long *)0x0) {
      param_1[1] = 0;
      uVar3 = 0xe00002bd;
      uVar1 = 0;
      goto LAB_0000e54a;
    }
  }
  uVar3 = (**(code **)(*plVar2 + 0x118))();
  param_1[1] = uVar3;
  uVar1 = (**(code **)(**(long **)(this + 0x100) + 0x128))();
  uVar3 = 0;
LAB_0000e54a:
  *(undefined4 *)(param_1 + 2) = uVar1;
  return uVar3;
}



// IOAccelDevice2::get_next_gid_group(IOAccelDeviceGIDGroupData*)

undefined8 __thiscall IOAccelDevice2::get_next_gid_group(undefined8 param_1_00,long *param_2)

{
  long lVar1;
  long lVar2;
  char cVar3;
  
  do {
    lVar2 = ___globalObjectIDCounter;
    lVar1 = ___globalObjectIDCounter + 0x1000000;
    cVar3 = _OSCompareAndSwap64(___globalObjectIDCounter,lVar1,&___globalObjectIDCounter);
  } while (cVar3 == '\0');
  *param_2 = lVar2;
  param_2[1] = lVar1;
  return 0;
}



// IOAccelDevice2::set_api_property(IOAccelDeviceAPIProperty*)

undefined1 __thiscall IOAccelDevice2::set_api_property(IOAccelDevice2 *this,char *param_1)

{
  undefined1 uVar1;
  undefined1 *local_38;
  undefined1 *local_30;
  undefined1 local_28;
  long local_20;
  
  local_20 = *(long *)PTR____stack_chk_guard_0006b0b0;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  local_28 = 0xaa;
  _strlcpy((char *)&local_38,param_1,0x11);
  uVar1 = (**(code **)(*(long *)this + 0x270))(this,"API",&local_38);
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_20) {
    return uVar1;
  }
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// IOAccelDevice2::deviceStart()

undefined8 __thiscall IOAccelDevice2::deviceStart(IOAccelDevice2 *this)

{
  long *plVar1;
  long lVar2;
  undefined8 uVar3;
  
  plVar1 = (long *)(**(code **)(**(long **)(this + 0x108) + 0x878))
                             (*(long **)(this + 0x108),this + 0x128);
  *(long **)(this + 0x118) = plVar1;
  if (plVar1 != (long *)0x0) {
    (**(code **)(*plVar1 + 0x20))(plVar1);
    lVar2 = IOMemoryDescriptor::createMappingInTask
                      (*(task **)(this + 0x118),*(ulonglong *)(this + 0xe8),0,0x4001001,0);
    *(long *)(this + 0x120) = lVar2;
    if (lVar2 != 0) {
      uVar3 = _OSAddAtomic64(1,&___globalObjectIDCounter);
      *(undefined8 *)(this + 0xf8) = uVar3;
      uVar3 = IOAccelDeviceList::addDevice
                        ((IOAccelDeviceList *)(*(long *)(this + 0x108) + 0xa78),(long)this);
      return CONCAT71((int7)((ulong)uVar3 >> 8),1);
    }
    (**(code **)(**(long **)(this + 0x118) + 0x28))();
    *(undefined8 *)(this + 0x118) = 0;
  }
  return 0;
}



// IOAccelDevice2::deviceStop()

void __thiscall IOAccelDevice2::deviceStop(IOAccelDevice2 *this)

{
  this[0x111] = (IOAccelDevice2)0x0;
  IOAccelDeviceList::removeDevice((IOAccelDeviceList *)(*(long *)(this + 0x108) + 0xa78),(long)this)
  ;
  if (*(long **)(this + 0x120) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x120) + 0x28))();
    *(undefined8 *)(this + 0x120) = 0;
  }
  if (*(long **)(this + 0x118) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x118) + 0x28))();
    *(undefined8 *)(this + 0x118) = 0;
  }
  if (*(long **)(this + 0x100) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x100) + 0x28))();
    *(undefined8 *)(this + 0x100) = 0;
  }
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDevice2::stop(IOService*)

void __cdecl IOAccelDevice2::stop(long *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  
  if (*(char *)((long)param_1 + 0x111) != '\0') {
    pIVar1 = (IOGraphicsAccelerator2 *)param_1[0x21];
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    (**(code **)(*param_1 + 0x968))(param_1);
    *(undefined1 *)((long)param_1 + 0x111) = 0;
    (**(code **)(PTR_vtable_0006b088 + 0x5d8))(param_1,param_1[0x21]);
    (**(code **)(*param_1 + 0x678))(param_1,param_1[0x21]);
    (**(code **)(*param_1 + 0x28))(param_1);
    pIVar1 = (IOGraphicsAccelerator2 *)param_1[0x21];
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
    return;
  }
  return;
}



// IOAccelDevice2::clientClose()

undefined8 __thiscall IOAccelDevice2::clientClose(IOAccelDevice2 *this)

{
  (**(code **)(*(long *)this + 0x600))(this,0);
  return 0;
}



// IOAccelDevice2::externalMethod(unsigned int, IOExternalMethodArguments*,
// IOExternalMethodDispatch*, OSObject*, void*)

undefined4 __thiscall
IOAccelDevice2::externalMethod
          (IOAccelDevice2 *this,undefined4 param_1,undefined8 param_2,undefined8 param_3,
          undefined8 param_4,undefined8 param_5)

{
  IOGraphicsAccelerator2 *this_00;
  undefined4 uVar1;
  int iVar2;
  
  _OSIncrementAtomic(this + 0x180);
  uVar1 = 0xe00002d7;
  if (this[0x112] == (IOAccelDevice2)0x0) {
    uVar1 = (**(code **)(PTR_vtable_0006b088 + 0x860))(this,param_1,param_2,param_3,param_4,param_5)
    ;
  }
  iVar2 = _OSDecrementAtomic(this + 0x180);
  if ((iVar2 == 1) && (this[0x112] != (IOAccelDevice2)0x0)) {
    _IOLockLock(*(undefined8 *)(this + 0x178));
    if (this[0x113] == (IOAccelDevice2)0x0) {
      _IOLockUnlock(*(undefined8 *)(this + 0x178));
    }
    else {
      this[0x113] = (IOAccelDevice2)0x0;
      _IOLockUnlock(*(undefined8 *)(this + 0x178));
      this_00 = *(IOGraphicsAccelerator2 **)(this + 0x108);
      (**(code **)(*(long *)this_00 + 0x20))(this_00);
      _OSIncrementAtomic(this_00 + 0x90);
      _IOLockLock(*(undefined8 *)(this_00 + 0x88));
      _OSDecrementAtomic(this_00 + 0x90);
      IOGraphicsAccelerator2::lock_busy(this_00);
      (**(code **)(*(long *)this_00 + 0x850))(this_00,"",0);
      detach_device(this);
      (**(code **)(*(long *)this_00 + 0x858))(this_00,"",0);
      IOGraphicsAccelerator2::unlock_busy(this_00);
      _IOLockUnlock(*(undefined8 *)(this_00 + 0x88));
      (**(code **)(*(long *)this_00 + 0x28))(this_00);
    }
  }
  return uVar1;
}



// IOAccelDevice2::getTargetAndMethodForIndex(IOService**, unsigned int)

undefined ** __thiscall
IOAccelDevice2::getTargetAndMethodForIndex(IOAccelDevice2 *this,undefined8 *param_1,uint param_2)

{
  undefined **ppuVar1;
  
  *param_1 = this;
  ppuVar1 = (undefined **)0x0;
  if (param_2 < 10) {
    ppuVar1 = &sDeviceMethods + (ulong)param_2 * 6;
  }
  return ppuVar1;
}



// IOAccelDevice2::_RESERVEDIOAccelDevice0()

void IOAccelDevice2::_RESERVEDIOAccelDevice0(void)

{
  OSMetaClass::reservedCalled(0x82098);
  return;
}



// IOAccelDevice2::_RESERVEDIOAccelDevice1()

void IOAccelDevice2::_RESERVEDIOAccelDevice1(void)

{
  OSMetaClass::reservedCalled(0x82098);
  return;
}



// IOAccelDevice2::_RESERVEDIOAccelDevice2()

void IOAccelDevice2::_RESERVEDIOAccelDevice2(void)

{
  OSMetaClass::reservedCalled(0x82098);
  return;
}



// IOAccelDevice2::_RESERVEDIOAccelDevice3()

void IOAccelDevice2::_RESERVEDIOAccelDevice3(void)

{
  OSMetaClass::reservedCalled(0x82098);
  return;
}



// IOAccelDevice2::_RESERVEDIOAccelDevice4()

void IOAccelDevice2::_RESERVEDIOAccelDevice4(void)

{
  OSMetaClass::reservedCalled(0x82098);
  return;
}



// IOAccelDevice2::_RESERVEDIOAccelDevice5()

void IOAccelDevice2::_RESERVEDIOAccelDevice5(void)

{
  OSMetaClass::reservedCalled(0x82098);
  return;
}



// IOAccelDevice2::MetaClass::~MetaClass()

void __thiscall IOAccelDevice2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelDevice_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelDevice2::gMetaClass,"IOAccelDevice2",
             (OSMetaClass *)PTR_gMetaClass_0006b018,0x188);
  _gMetaClass = &PTR__MetaClass_00070ad0;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelDevice2::gMetaClass);
  return;
}



// IOAccelDisplayMachine::MetaClass::MetaClass()

void __thiscall IOAccelDisplayMachine::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDisplayMachine",(OSMetaClass *)PTR_gMetaClass_0006b070,
             0x178);
  *(undefined ***)this = &PTR__MetaClass_000716a8;
  return;
}



// IOAccelDisplayMachine::MetaClass::~MetaClass()

void __thiscall IOAccelDisplayMachine::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelDisplayMachine::IOAccelDisplayMachine(OSMetaClass const*)

void __thiscall
IOAccelDisplayMachine::IOAccelDisplayMachine(IOAccelDisplayMachine *this,OSMetaClass *param_1)

{
  IOService::IOService((IOService *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDisplayMachine_00070db0;
  return;
}



// IOAccelDisplayMachine::~IOAccelDisplayMachine()

void __thiscall IOAccelDisplayMachine::~IOAccelDisplayMachine(IOAccelDisplayMachine *this)

{
  IOService::~IOService((IOService *)this);
  return;
}



// IOAccelDisplayMachine::~IOAccelDisplayMachine()

void __thiscall IOAccelDisplayMachine::~IOAccelDisplayMachine(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelDisplayMachine::~IOAccelDisplayMachine()

void __thiscall IOAccelDisplayMachine::~IOAccelDisplayMachine(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelDisplayMachine::getMetaClass() const

undefined1 * IOAccelDisplayMachine::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelDisplayMachine::MetaClass::MetaClass()

void __thiscall IOAccelDisplayMachine::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDisplayMachine",(OSMetaClass *)PTR_gMetaClass_0006b070,
             0x178);
  *(undefined ***)this = &PTR__MetaClass_000716a8;
  return;
}



// IOAccelDisplayMachine::MetaClass::alloc() const

undefined8 IOAccelDisplayMachine::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelDisplayMachine::operator new(unsigned long)

void * __thiscall IOAccelDisplayMachine::operator_new(IOAccelDisplayMachine *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelDisplayMachine_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayMachine::operator delete(void*, unsigned long)

void __cdecl IOAccelDisplayMachine::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelDisplayMachine_ktv,param_1,param_2);
  return;
}



// IOAccelDisplayMachine::init(IOGraphicsAccelerator2*)

void __thiscall IOAccelDisplayMachine::init(IOAccelDisplayMachine *this,undefined8 param_1)

{
  undefined8 uVar1;
  
  *(undefined8 *)(this + 0x128) = param_1;
  uVar1 = _IOLockAlloc();
  *(undefined8 *)(this + 0x110) = uVar1;
  *(undefined4 *)(this + 0x118) = 0;
  *(undefined8 *)(this + 0x108) = 0;
  return;
}



// IOAccelDisplayMachine::free()

void __thiscall IOAccelDisplayMachine::free(IOAccelDisplayMachine *this)

{
  if (*(long *)(this + 0x110) != 0) {
    _IOLockFree();
    *(undefined8 *)(this + 0x110) = 0;
  }
  if (*(long **)(this + 0x120) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x120) + 0x28))();
  }
  *(undefined8 *)(this + 0x120) = 0;
                    // WARNING: Could not recover jumptable at 0x0000ec1c. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a8 + 0xa0))(this);
  return;
}



// IOAccelDisplayMachine::start(IOPCIDevice*)

bool __thiscall IOAccelDisplayMachine::start(IOAccelDisplayMachine *this,long *param_1)

{
  int iVar1;
  OSMetaClass *pOVar2;
  OSMetaClass *pOVar3;
  long *plVar4;
  long *plVar5;
  OSMetaClassBase *pOVar6;
  long *plVar7;
  long lVar8;
  
  plVar4 = (long *)(**(code **)(*param_1 + 800))(param_1,*(undefined8 *)PTR__gIODTPlane_0006b0c0);
  plVar5 = (long *)OSSymbol::withCString("IOFramebuffer");
  iVar1 = *(int *)(this + 0x170);
  if (iVar1 == 0) {
    if ((plVar4 != (long *)0x0) && (plVar5 != (long *)0x0)) {
      pOVar6 = (OSMetaClassBase *)(**(code **)(*plVar4 + 0x128))(plVar4);
      pOVar2 = *(OSMetaClass **)PTR_metaClass_0006b078;
      plVar7 = (long *)OSMetaClassBase::safeMetaCast(pOVar6,pOVar2);
      if (plVar7 != (long *)0x0) {
        pOVar3 = *(OSMetaClass **)PTR_metaClass_0006b030;
        do {
          pOVar6 = (OSMetaClassBase *)(**(code **)(*plVar7 + 0x420))(plVar7,plVar5);
          plVar7 = (long *)OSMetaClassBase::safeMetaCast(pOVar6,pOVar3);
          if (plVar7 != (long *)0x0) {
            (**(code **)(*(long *)this + 0x8d8))(this,plVar7);
            (**(code **)(*plVar7 + 0x28))(plVar7);
          }
          pOVar6 = (OSMetaClassBase *)(**(code **)(*plVar4 + 0x128))(plVar4);
          plVar7 = (long *)OSMetaClassBase::safeMetaCast(pOVar6,pOVar2);
        } while (plVar7 != (long *)0x0);
      }
      (**(code **)(*plVar4 + 0x28))(plVar4);
    }
    plVar4 = (long *)(**(code **)(*param_1 + 0x6a8))(param_1);
    if (plVar4 != (long *)0x0) {
      pOVar6 = (OSMetaClassBase *)(**(code **)(*plVar4 + 0x128))(plVar4);
      if (pOVar6 != (OSMetaClassBase *)0x0) {
        pOVar2 = *(OSMetaClass **)PTR_metaClass_0006b030;
        do {
          lVar8 = OSMetaClassBase::safeMetaCast(pOVar6,pOVar2);
          if (lVar8 == 0) {
            plVar7 = (long *)(**(code **)(*(long *)pOVar6 + 0x6a8))(pOVar6);
            lVar8 = *plVar7;
            while( true ) {
              pOVar6 = (OSMetaClassBase *)(**(code **)(lVar8 + 0x128))(plVar7);
              if (pOVar6 == (OSMetaClassBase *)0x0) break;
              lVar8 = OSMetaClassBase::safeMetaCast(pOVar6,pOVar2);
              if (lVar8 != 0) {
                (**(code **)(*(long *)this + 0x8d8))(this,lVar8);
              }
              lVar8 = *plVar7;
            }
            (**(code **)(*plVar7 + 0x28))(plVar7);
          }
          else {
            (**(code **)(*(long *)this + 0x8d8))(this,lVar8);
          }
          pOVar6 = (OSMetaClassBase *)(**(code **)(*plVar4 + 0x128))(plVar4);
        } while (pOVar6 != (OSMetaClassBase *)0x0);
      }
      (**(code **)(*plVar4 + 0x28))(plVar4);
    }
    if (plVar5 != (long *)0x0) {
      (**(code **)(*plVar5 + 0x28))();
    }
  }
  return iVar1 == 0;
}



// IOAccelDisplayMachine::stop()

void __thiscall IOAccelDisplayMachine::stop(IOAccelDisplayMachine *this)

{
  ulong uVar1;
  
  if (*(int *)(this + 0x108) != 0) {
    uVar1 = 0;
    do {
      (**(code **)(**(long **)(this + uVar1 * 8 + 0x88) + 0x28))();
      *(undefined8 *)(this + uVar1 * 8 + 0x88) = 0;
      uVar1 = uVar1 + 1;
    } while (uVar1 < *(uint *)(this + 0x108));
  }
  return;
}



// IOAccelDisplayMachine::getFramebufferCount() const

undefined4 __thiscall IOAccelDisplayMachine::getFramebufferCount(IOAccelDisplayMachine *this)

{
  return *(undefined4 *)(this + 0x108);
}



// IOAccelDisplayMachine::enable_pipe_event_interrupt(unsigned int)

void __thiscall
IOAccelDisplayMachine::enable_pipe_event_interrupt(IOAccelDisplayMachine *this,byte param_1)

{
  _IOLockLock(*(undefined8 *)(this + 0x110));
  *(uint *)(this + 0x118) = *(uint *)(this + 0x118) | 1 << (param_1 & 0x1f);
  IOAccelEventMachine2::setDisplayMachineInterrupt
            (*(IOAccelEventMachine2 **)(*(long *)(this + 0x128) + 0x380),(long)this);
  _IOLockUnlock(*(undefined8 *)(this + 0x110));
  return;
}



// IOAccelDisplayMachine::disable_pipe_event_interrupt(unsigned int)

void __thiscall
IOAccelDisplayMachine::disable_pipe_event_interrupt(IOAccelDisplayMachine *this,byte param_1)

{
  IOAccelDisplayMachine *pIVar1;
  
  _IOLockLock(*(undefined8 *)(this + 0x110));
  pIVar1 = this + 0x118;
  *(uint *)pIVar1 =
       *(uint *)pIVar1 & (-2 << (param_1 & 0x1f) | 0xfffffffeU >> 0x20 - (param_1 & 0x1f));
  if (*(uint *)pIVar1 == 0) {
    IOAccelEventMachine2::setDisplayMachineInterrupt
              (*(IOAccelEventMachine2 **)(*(long *)(this + 0x128) + 0x380),0);
  }
  _IOLockUnlock(*(undefined8 *)(this + 0x110));
  return;
}



// IOAccelDisplayMachine::signalEventInterrupt()

void __thiscall IOAccelDisplayMachine::signalEventInterrupt(IOAccelDisplayMachine *this)

{
  uint uVar1;
  ulong uVar2;
  uint uVar3;
  
  uVar1 = *(uint *)(this + 0x108);
  if ((ulong)uVar1 != 0) {
    uVar3 = *(uint *)(this + 0x118);
    uVar2 = 0;
    do {
      if ((uVar3 & 1) != 0) {
        IOAccelDisplayPipe::signal_event_interrupt
                  (*(IOAccelDisplayPipe **)(this + uVar2 * 8 + 0x88));
      }
      uVar2 = uVar2 + 1;
      uVar3 = uVar3 >> 1;
    } while (uVar1 != uVar2);
  }
  return;
}



// IOAccelDisplayMachine::isFramebufferActive(unsigned int) const

void __thiscall IOAccelDisplayMachine::isFramebufferActive(IOAccelDisplayMachine *this,uint param_1)

{
  IOAccelDisplayPipe::isActive(*(IOAccelDisplayPipe **)(this + (ulong)param_1 * 8 + 0x88));
  return;
}



// IOAccelDisplayMachine::getFramebufferWidth(unsigned int) const

void __thiscall IOAccelDisplayMachine::getFramebufferWidth(IOAccelDisplayMachine *this,uint param_1)

{
  IOAccelDisplayPipe::getWidth(*(IOAccelDisplayPipe **)(this + (ulong)param_1 * 8 + 0x88));
  return;
}



// IOAccelDisplayMachine::getFramebufferHeight(unsigned int) const

void __thiscall
IOAccelDisplayMachine::getFramebufferHeight(IOAccelDisplayMachine *this,uint param_1)

{
  IOAccelDisplayPipe::getHeight(*(IOAccelDisplayPipe **)(this + (ulong)param_1 * 8 + 0x88));
  return;
}



// IOAccelDisplayMachine::getIOFramebuffer(unsigned int) const

void __thiscall IOAccelDisplayMachine::getIOFramebuffer(IOAccelDisplayMachine *this,uint param_1)

{
  IOAccelDisplayPipe::getFramebuffer(*(IOAccelDisplayPipe **)(this + (ulong)param_1 * 8 + 0x88));
  return;
}



// IOAccelDisplayMachine::getFramebufferResource(unsigned int, unsigned int) const

void __thiscall
IOAccelDisplayMachine::getFramebufferResource
          (IOAccelDisplayMachine *this,ulong param_2_00,int param_2)

{
  IOAccelDisplayPipe::getFramebufferResource
            (*(IOAccelDisplayPipe **)(this + (param_2_00 & 0xffffffff) * 8 + 0x88),param_2);
  return;
}



// IOAccelDisplayMachine::getDisplayPipe(unsigned int) const

undefined8 __thiscall
IOAccelDisplayMachine::getDisplayPipe(IOAccelDisplayMachine *this,uint param_1)

{
  return *(undefined8 *)(this + (ulong)param_1 * 8 + 0x88);
}



// IOAccelDisplayMachine::found_framebuffer(IOFramebuffer*)

ulong __thiscall IOAccelDisplayMachine::found_framebuffer(IOAccelDisplayMachine *this,long param_1)

{
  long *plVar1;
  long lVar2;
  undefined8 uVar3;
  uint uVar4;
  ulong uVar5;
  
  if (*(int *)(this + 0x108) == 0) {
    uVar4 = 0;
  }
  else {
    uVar5 = 0;
    do {
      lVar2 = IOAccelDisplayPipe::getFramebuffer(*(IOAccelDisplayPipe **)(this + uVar5 * 8 + 0x88));
      if (lVar2 == param_1) goto LAB_0000f045;
      uVar5 = uVar5 + 1;
      uVar4 = *(uint *)(this + 0x108);
    } while (uVar5 < uVar4);
  }
  plVar1 = *(long **)(this + 0x128);
  if (uVar4 < *(uint *)(plVar1 + 0x196)) {
    uVar3 = (**(code **)(*plVar1 + 0x908))(plVar1,param_1);
    *(undefined8 *)(this + (ulong)*(uint *)(this + 0x108) * 8 + 0x88) = uVar3;
    IOGraphicsAccelerator2::find_vram_descriptor(*(IOGraphicsAccelerator2 **)(this + 0x128));
    *(int *)(this + 0x108) = *(int *)(this + 0x108) + 1;
LAB_0000f045:
    uVar5 = CONCAT71((int7)((ulong)this >> 8),1);
  }
  else {
    uVar5 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: trying to init too many framebuffers\n",
                      "virtual bool IOAccelDisplayMachine::found_framebuffer(IOFramebuffer *)");
  }
  return uVar5 & 0xffffffff;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayMachine::display_mode_will_change(unsigned int)

ulong __cdecl IOAccelDisplayMachine::display_mode_will_change(long *param_1)

{
  int iVar1;
  bool bVar2;
  uint uVar3;
  IOGraphicsAccelerator2 *pIVar4;
  ulong uVar5;
  IOGraphicsAccelerator2 *this;
  
  pIVar4 = (IOGraphicsAccelerator2 *)param_1[0x25];
  _OSIncrementAtomic(pIVar4 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar4 + 0x88));
  _OSDecrementAtomic(pIVar4 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar4);
  (**(code **)(*(long *)pIVar4 + 0x850))(pIVar4,"",0);
  iVar1 = *(int *)((long)param_1 + 0x10c);
  *(int *)((long)param_1 + 0x10c) = iVar1 + 1;
  this = (IOGraphicsAccelerator2 *)param_1[0x25];
  uVar5 = CONCAT71((int7)((ulong)pIVar4 >> 8),1);
  if (iVar1 == 0) {
    (**(code **)(**(long **)(this + 0x380) + 0x158))();
    if ((int)param_1[0x21] != 0) {
      uVar5 = 0;
      do {
        (**(code **)(*(long *)param_1[uVar5 + 0x11] + 0x868))();
        uVar5 = uVar5 + 1;
      } while (uVar5 < *(uint *)(param_1 + 0x21));
      if (*(uint *)(param_1 + 0x21) != 0) {
        uVar5 = 0;
        do {
          bVar2 = IOAccelDisplayPipe::isActive((IOAccelDisplayPipe *)param_1[uVar5 + 0x11]);
          if (bVar2) {
            IOAccelDisplayPipe::destroy_framebuffer_resource
                      ((IOAccelDisplayPipe *)param_1[uVar5 + 0x11],
                       *(IOAccelResource2 **)((IOAccelDisplayPipe *)param_1[uVar5 + 0x11] + 0xe0));
          }
          uVar5 = uVar5 + 1;
        } while (uVar5 < *(uint *)(param_1 + 0x21));
      }
    }
    pIVar4 = (IOGraphicsAccelerator2 *)param_1[0x25];
    uVar3 = *(uint *)(pIVar4 + 0xc90);
    if ((~uVar3 & 0x1200000) == 0) {
      IOGraphicsAccelerator2::unload_dirty_resources(pIVar4);
      pIVar4 = (IOGraphicsAccelerator2 *)param_1[0x25];
      uVar3 = *(uint *)(pIVar4 + 0xc90);
    }
    if ((uVar3 >> 0x17 & 1) != 0) {
      (**(code **)(*(long *)pIVar4 + 0x958))();
      (**(code **)(*(long *)param_1[0x25] + 0x948))();
      pIVar4 = (IOGraphicsAccelerator2 *)param_1[0x25];
    }
    (**(code **)(**(long **)(pIVar4 + 0x380) + 0x158))();
    uVar3 = (**(code **)(*param_1 + 0x868))(param_1);
    uVar5 = (ulong)uVar3;
    if ((char)uVar3 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: vendor driver returned false\n",
                        "virtual bool IOAccelDisplayMachine::display_mode_will_change(uint32_t)");
    }
    IOGraphicsAccelerator2::disableAccelerator((IOGraphicsAccelerator2 *)param_1[0x25]);
    this = (IOGraphicsAccelerator2 *)param_1[0x25];
  }
  (**(code **)(*(long *)this + 0x858))(this,"",0);
  IOGraphicsAccelerator2::unlock_busy(this);
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  return uVar5 & 0xffffffff;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayMachine::display_mode_did_change(unsigned int)

ulong __cdecl IOAccelDisplayMachine::display_mode_did_change(long *param_1)

{
  long *plVar1;
  int *piVar2;
  int iVar3;
  uint uVar4;
  char cVar5;
  ulong uVar6;
  uint uVar7;
  undefined8 extraout_RDX;
  char *pcVar8;
  IOGraphicsAccelerator2 *pIVar9;
  ulong uVar10;
  
  plVar1 = param_1 + 0x25;
  pIVar9 = (IOGraphicsAccelerator2 *)param_1[0x25];
  _OSIncrementAtomic(pIVar9 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar9 + 0x88));
  _OSDecrementAtomic(pIVar9 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar9);
  pcVar8 = "";
  (**(code **)(*(long *)pIVar9 + 0x850))(pIVar9,"",0);
  piVar2 = (int *)((long)param_1 + 0x10c);
  *piVar2 = *piVar2 + -1;
  if (*piVar2 != 0) goto LAB_0000f2b5;
  cVar5 = (**(code **)(*param_1 + 0x870))(param_1);
  pIVar9 = (IOGraphicsAccelerator2 *)param_1[0x25];
  if (cVar5 == '\0') {
    if (((byte)pIVar9[0xc91] & 0x20) == 0) {
      display_mode_did_change(plVar1);
      return 0;
    }
    uVar10 = 0;
    goto LAB_0000f2ba;
  }
  if (*(long *)(pIVar9 + 0x180) != 0) {
    IOGraphicsAccelerator2::enableAccelerator(pIVar9,pcVar8,extraout_RDX);
    _IOLockWakeup_darwin14(*(undefined8 *)(*plVar1 + 0x88),*plVar1,0);
  }
  if ((int)param_1[0x21] == 0) {
    if ((*(byte *)(*plVar1 + 0xc92) & 0x20) != 0) goto LAB_0000f3c4;
  }
  else {
    uVar10 = 0;
    do {
      (**(code **)(*(long *)param_1[uVar10 + 0x11] + 0x870))();
      uVar10 = uVar10 + 1;
      uVar6 = (ulong)*(uint *)(param_1 + 0x21);
    } while (uVar10 < uVar6);
    if (((byte)((IOGraphicsAccelerator2 *)*plVar1)[0xc92] & 0x20) != 0) {
      if (uVar6 != 0) {
        uVar10 = 0;
LAB_0000f371:
        iVar3 = *(int *)(*(long *)(param_1[uVar10 + 0x11] + 0xe0) + 200 +
                        (ulong)(*(long *)(*(long *)(param_1[uVar10 + 0x11] + 0xe0) + 0x88) == 0) * 8
                        );
        if (iVar3 == 0) goto code_r0x0000f399;
        uVar4 = 0x2000000;
        do {
          uVar7 = uVar4;
          uVar4 = uVar7 * 2;
        } while (uVar7 < (uint)(iVar3 * 6));
        uVar4 = 0x10000000;
        if (uVar7 < 0x10000000) {
          uVar4 = uVar7;
        }
        IOGraphicsAccelerator2::update_gc_low_water_mark
                  ((IOGraphicsAccelerator2 *)*plVar1,(ulong)uVar4);
        if ((int)param_1[0x21] == (int)uVar10) goto LAB_0000f3c4;
        goto LAB_0000f2b5;
      }
LAB_0000f3c4:
      IOGraphicsAccelerator2::update_gc_low_water_mark((IOGraphicsAccelerator2 *)*plVar1,0x2000000);
    }
  }
LAB_0000f2b5:
  pIVar9 = (IOGraphicsAccelerator2 *)*plVar1;
  uVar10 = CONCAT71((int7)((ulong)plVar1 >> 8),1);
LAB_0000f2ba:
  (**(code **)(*(long *)pIVar9 + 0x858))(pIVar9,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar9);
  _IOLockUnlock(*(undefined8 *)(pIVar9 + 0x88));
  return uVar10 & 0xffffffff;
code_r0x0000f399:
  uVar10 = uVar10 + 1;
  if (uVar6 == uVar10) goto LAB_0000f3c4;
  goto LAB_0000f371;
}



// IOAccelDisplayMachine::wsaa_will_enter_defer(unsigned int, int)

undefined4 __thiscall
IOAccelDisplayMachine::wsaa_will_enter_defer
          (IOAccelDisplayMachine *this,uint param_1,undefined4 param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined4 uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  uVar2 = 0;
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (param_1 < *(uint *)(this + 0x108)) {
    uVar2 = (**(code **)(**(long **)(this + (ulong)param_1 * 8 + 0x88) + 0x908))
                      (*(long **)(this + (ulong)param_1 * 8 + 0x88),param_2);
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2;
}



// IOAccelDisplayMachine::wsaa_did_enter_defer(unsigned int, int)

undefined4 __thiscall
IOAccelDisplayMachine::wsaa_did_enter_defer
          (IOAccelDisplayMachine *this,uint param_1,undefined4 param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined4 uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  uVar2 = 0;
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (param_1 < *(uint *)(this + 0x108)) {
    uVar2 = (**(code **)(**(long **)(this + (ulong)param_1 * 8 + 0x88) + 0x910))
                      (*(long **)(this + (ulong)param_1 * 8 + 0x88),param_2);
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2;
}



// IOAccelDisplayMachine::wsaa_will_exit_defer(unsigned int, int)

undefined4 __thiscall
IOAccelDisplayMachine::wsaa_will_exit_defer
          (IOAccelDisplayMachine *this,uint param_1,undefined4 param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined4 uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  uVar2 = 0;
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (param_1 < *(uint *)(this + 0x108)) {
    uVar2 = (**(code **)(**(long **)(this + (ulong)param_1 * 8 + 0x88) + 0x8f8))
                      (*(long **)(this + (ulong)param_1 * 8 + 0x88),param_2);
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2;
}



// IOAccelDisplayMachine::wsaa_did_exit_defer(unsigned int, int)

undefined4 __thiscall
IOAccelDisplayMachine::wsaa_did_exit_defer
          (IOAccelDisplayMachine *this,uint param_1,undefined4 param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined4 uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  uVar2 = 0;
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (param_1 < *(uint *)(this + 0x108)) {
    uVar2 = (**(code **)(**(long **)(this + (ulong)param_1 * 8 + 0x88) + 0x900))
                      (*(long **)(this + (ulong)param_1 * 8 + 0x88),param_2);
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2;
}



// IOAccelDisplayMachine::framebuffer_will_power_off(unsigned int)

undefined8 __thiscall
IOAccelDisplayMachine::framebuffer_will_power_off(IOAccelDisplayMachine *this,ulong param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined8 uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  (**(code **)(**(long **)(this + (param_1 & 0xffffffff) * 8 + 0x88) + 0x978))();
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  uVar2 = _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return CONCAT71((int7)((ulong)uVar2 >> 8),1);
}



// IOAccelDisplayMachine::framebuffer_did_power_on(unsigned int)

undefined8 __thiscall
IOAccelDisplayMachine::framebuffer_did_power_on(IOAccelDisplayMachine *this,ulong param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined8 uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  (**(code **)(**(long **)(this + (param_1 & 0xffffffff) * 8 + 0x88) + 0x980))();
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  uVar2 = _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return CONCAT71((int7)((ulong)uVar2 >> 8),1);
}



// IOAccelDisplayMachine::framebuffer_terminated(unsigned int)

void __thiscall
IOAccelDisplayMachine::framebuffer_terminated(IOAccelDisplayMachine *this,ulong param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  (**(code **)(**(long **)(this + (param_1 & 0xffffffff) * 8 + 0x88) + 0x988))();
  *(int *)(this + 0x170) = *(int *)(this + 0x170) + 1;
  _IOLockWakeup_darwin14(*(undefined8 *)(*(long *)(this + 0x128) + 0x88),*(long *)(this + 0x128),0);
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  IOGraphicsAccelerator2::display_pipe_terminated(*(IOGraphicsAccelerator2 **)(this + 0x128));
  return;
}



// IOAccelDisplayMachine::finish_transaction_queue(unsigned int)

void __thiscall
IOAccelDisplayMachine::finish_transaction_queue(IOAccelDisplayMachine *this,uint param_1)

{
  IOAccelDisplayPipe::finishTransactionQueue
            (*(IOAccelDisplayPipe **)(this + (ulong)param_1 * 8 + 0x88));
  return;
}



// IOAccelDisplayMachine::get_finished_transactions(DisplayTransactionListHead*)

void __thiscall
IOAccelDisplayMachine::get_finished_transactions(IOAccelDisplayMachine *this,undefined8 param_1)

{
  ulong uVar1;
  
  if (*(int *)(this + 0x108) != 0) {
    uVar1 = 0;
    do {
      IOAccelDisplayPipe::get_finished_transactions
                (*(IOAccelDisplayPipe **)(this + uVar1 * 8 + 0x88),param_1);
      uVar1 = uVar1 + 1;
    } while (uVar1 < *(uint *)(this + 0x108));
  }
  return;
}



// IOAccelDisplayMachine::device_terminated()

void __thiscall IOAccelDisplayMachine::device_terminated(IOAccelDisplayMachine *this)

{
  ulong uVar1;
  
  if (*(int *)(this + 0x108) != 0) {
    uVar1 = 0;
    do {
      IOAccelDisplayPipe::device_terminated(*(IOAccelDisplayPipe **)(this + uVar1 * 8 + 0x88));
      uVar1 = uVar1 + 1;
    } while (uVar1 < *(uint *)(this + 0x108));
  }
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayMachine::invertUpdateCopyMatrix(IOAccelAffineTransform)

void __cdecl IOAccelDisplayMachine::invertUpdateCopyMatrix(double *param_1)

{
  double dVar1;
  double in_stack_00000008;
  double in_stack_00000010;
  double in_stack_00000018;
  double in_stack_00000020;
  double in_stack_00000028;
  double in_stack_00000030;
  
  dVar1 = in_stack_00000008 * in_stack_00000020 - in_stack_00000018 * in_stack_00000010;
  if ((dVar1 != 0.0) || (NAN(dVar1))) {
    dVar1 = 1.0 / dVar1;
    *param_1 = in_stack_00000020 * dVar1;
    param_1[1] = -(in_stack_00000010 * dVar1);
    param_1[2] = -(in_stack_00000018 * dVar1);
    param_1[3] = in_stack_00000008 * dVar1;
    param_1[4] = in_stack_00000018 * dVar1 * in_stack_00000030 -
                 in_stack_00000028 * in_stack_00000020 * dVar1;
    param_1[5] = in_stack_00000010 * dVar1 * in_stack_00000028 -
                 in_stack_00000030 * in_stack_00000008 * dVar1;
  }
  else {
    param_1[5] = in_stack_00000030;
    param_1[4] = in_stack_00000028;
    param_1[3] = in_stack_00000020;
    param_1[2] = in_stack_00000018;
    param_1[1] = in_stack_00000010;
    *param_1 = in_stack_00000008;
  }
  return;
}



// IOAccelDisplayMachine::calculateUpdateCopyMatrix(unsigned int, unsigned int, unsigned int,
// unsigned int, unsigned int)

void __thiscall
IOAccelDisplayMachine::calculateUpdateCopyMatrix
          (IOAccelDisplayMachine *this,uint param_1,uint param_2,uint param_3,uint param_4,
          ulong param_5)

{
  long lVar1;
  uint uVar2;
  double dVar3;
  double dVar4;
  double dVar5;
  double dVar6;
  double dVar7;
  double dVar8;
  double dVar9;
  double dVar10;
  double dVar11;
  double dVar12;
  double dVar13;
  double dVar14;
  double dVar15;
  
  dVar5 = (double)param_1;
  dVar8 = (double)param_2;
  dVar4 = (double)param_3;
  dVar3 = (double)param_4;
  if ((param_5 & 0x10) == 0) {
    if ((param_5 & 1) != 0) {
      dVar7 = dVar4 / dVar5;
      dVar6 = dVar3 / dVar8;
      goto LAB_0000fb54;
    }
    dVar7 = dVar4;
    dVar6 = dVar3;
    if (dVar4 / dVar3 < dVar5 / dVar8) {
LAB_0000fb4c:
      dVar7 = dVar7 / dVar5;
      dVar6 = dVar7;
      goto LAB_0000fb54;
    }
  }
  else {
    if ((param_5 & 1) != 0) {
      dVar7 = dVar4 / dVar8;
      dVar6 = dVar3 / dVar5;
      goto LAB_0000fb54;
    }
    dVar7 = dVar3;
    dVar6 = dVar4;
    if (dVar8 / dVar5 <= dVar4 / dVar3) goto LAB_0000fb4c;
  }
  dVar7 = dVar6 / dVar8;
  dVar6 = dVar7;
LAB_0000fb54:
  uVar2 = ((uint)(param_5 >> 4) & 0xf) - 3;
  if (uVar2 < 4) {
    lVar1 = (long)(int)uVar2;
    dVar9 = *(double *)(&DAT_0006add0 + lVar1 * 8);
    dVar11 = *(double *)(&DAT_0006adf0 + lVar1 * 8);
    dVar12 = *(double *)(&DAT_0006ae10 + lVar1 * 8);
  }
  else {
    dVar9 = 1.0;
    dVar11 = 0.0;
    dVar12 = 0.0;
  }
  dVar13 = dVar12 * 0.0 + dVar9;
  dVar15 = dVar11 + dVar9 * 0.0;
  dVar10 = dVar9 * 0.0 + dVar12;
  dVar14 = dVar11 * 0.0 + dVar9;
  dVar12 = dVar5 * -0.5 * dVar9 + dVar12 * dVar8 * -0.5 + 0.0;
  dVar5 = dVar5 * -0.5 * dVar11 + dVar8 * -0.5 * dVar9 + 0.0;
  dVar9 = dVar13 * dVar7 + dVar15 * 0.0;
  dVar13 = dVar13 * 0.0 + dVar6 * dVar15;
  dVar15 = dVar10 * dVar7 + dVar14 * 0.0;
  dVar11 = dVar10 * 0.0 + dVar6 * dVar14;
  dVar8 = dVar7 * dVar12 + dVar5 * 0.0 + 0.0;
  dVar5 = dVar12 * 0.0 + dVar6 * dVar5 + 0.0;
  *(double *)this = dVar13 * 0.0 + dVar9;
  *(double *)(this + 8) = dVar9 * 0.0 + dVar13;
  *(double *)(this + 0x10) = dVar11 * 0.0 + dVar15;
  *(double *)(this + 0x18) = dVar15 * 0.0 + dVar11;
  *(double *)(this + 0x20) = dVar5 * 0.0 + dVar8 + dVar4 * 0.5;
  *(double *)(this + 0x28) = dVar8 * 0.0 + dVar5 + dVar3 * 0.5;
  return;
}



// IOAccelDisplayMachine::initFramebufferResource(unsigned int, unsigned int, IOFramebuffer*,
// IOAccelResource2*)

undefined8 IOAccelDisplayMachine::initFramebufferResource(void)

{
  return 0;
}



// IOAccelDisplayMachine::destroyFramebufferResource(unsigned int, unsigned int, IOFramebuffer*,
// IOAccelResource2*)

void IOAccelDisplayMachine::destroyFramebufferResource(void)

{
  return;
}



// IOAccelDisplayMachine::get_pipe_workloop()

void __thiscall IOAccelDisplayMachine::get_pipe_workloop(IOAccelDisplayMachine *this)

{
  undefined8 uVar1;
  
  if (*(long *)(this + 0x120) == 0) {
    uVar1 = IOWorkLoop::workLoop();
    *(undefined8 *)(this + 0x120) = uVar1;
  }
  return;
}



// IOAccelDisplayMachine::ktraceStateChanged()

void __thiscall IOAccelDisplayMachine::ktraceStateChanged(IOAccelDisplayMachine *this)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (*(int *)(this + 0x108) != 0) {
    uVar2 = 0;
    do {
      IOAccelDisplayPipe::ktraceStateChanged();
      uVar2 = uVar2 + 1;
    } while (uVar2 < *(uint *)(this + 0x108));
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x128);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return;
}



// IOAccelDisplayMachine::isDeferred(unsigned int) const

undefined8 __thiscall IOAccelDisplayMachine::isDeferred(IOAccelDisplayMachine *this,uint param_1)

{
  return CONCAT71((int7)((ulong)*(long *)(this + (ulong)param_1 * 8 + 0x88) >> 8),
                  *(undefined1 *)(*(long *)(this + (ulong)param_1 * 8 + 0x88) + 0x2ac));
}



// IOAccelDisplayMachine::system_will_sleep()

void __thiscall IOAccelDisplayMachine::system_will_sleep(IOAccelDisplayMachine *this)

{
  ulong uVar1;
  
  if (*(int *)(this + 0x108) != 0) {
    uVar1 = 0;
    do {
      IOAccelDisplayPipe::system_will_sleep(*(IOAccelDisplayPipe **)(this + uVar1 * 8 + 0x88));
      uVar1 = uVar1 + 1;
    } while (uVar1 < *(uint *)(this + 0x108));
  }
  return;
}



// IOAccelDisplayMachine::waitForStampTimeout(int)

undefined1 __thiscall
IOAccelDisplayMachine::waitForStampTimeout(IOAccelDisplayMachine *this,int param_1)

{
  bool bVar1;
  ulong uVar2;
  
  if (*(int *)(this + 0x108) != 0) {
    uVar2 = 0;
    do {
      bVar1 = IOAccelDisplayPipe::waitForStampTimeout
                        (*(IOAccelDisplayPipe **)(this + uVar2 * 8 + 0x88),param_1);
      if (bVar1) {
        return 1;
      }
      uVar2 = uVar2 + 1;
    } while (uVar2 < *(uint *)(this + 0x108));
  }
  return 0;
}



// IOAccelDisplayMachine::is_current_display_resource(IOAccelResource2*)

ulong __thiscall
IOAccelDisplayMachine::is_current_display_resource(IOAccelDisplayMachine *this,long param_1)

{
  bool bVar1;
  long lVar2;
  uint uVar3;
  ulong uVar4;
  bool bVar5;
  ulong unaff_R15;
  
  if (*(int *)(this + 0x108) != 0) {
    uVar4 = 0;
    do {
      unaff_R15 = CONCAT71((int7)(unaff_R15 >> 8),1);
      uVar3 = 0;
      bVar1 = true;
      do {
        bVar5 = bVar1;
        lVar2 = IOAccelDisplayPipe::getCurrentPlaneResource
                          (*(IOAccelDisplayPipe **)(this + uVar4 * 8 + 0x88),uVar3,0);
        if (lVar2 == param_1) goto LAB_0000feef;
        uVar3 = 1;
        bVar1 = false;
      } while (bVar5);
      uVar4 = uVar4 + 1;
    } while (uVar4 < *(uint *)(this + 0x108));
  }
  unaff_R15 = 0;
LAB_0000feef:
  return unaff_R15 & 0xffffffff;
}



// IOAccelDisplayMachine::triage(char**, unsigned long long*)

undefined8 __thiscall
IOAccelDisplayMachine::triage
          (undefined8 param_1_00,undefined8 param_2_00,undefined8 param_3,undefined8 param_4,
          undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8,
          IOAccelDisplayMachine *this,long *param_10,size_t *param_11,undefined8 param_12,
          undefined8 param_13,undefined8 param_14)

{
  long *plVar1;
  undefined8 uVar2;
  uint uVar3;
  ulong uVar4;
  ulong uVar5;
  undefined8 extraout_XMM0_Qa;
  undefined8 extraout_XMM0_Qa_00;
  undefined8 extraout_XMM0_Qa_01;
  
  uVar2 = glkBfLog(param_1_00,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,param_10,
                   param_11,"%s","IOAccelDisplayMachine\n",param_13,param_14);
  if ((int)uVar2 == 0) {
    uVar3 = *(uint *)(this + 0x108);
    uVar2 = 0;
    if (uVar3 != 0) {
      uVar5 = 0;
      uVar2 = extraout_XMM0_Qa;
      do {
        plVar1 = *(long **)(this + uVar5 * 8 + 0x88);
        if (plVar1 != (long *)0x0) {
          uVar4 = uVar5 & 0xffffffff;
          uVar2 = glkBfLog(uVar2,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,param_10
                           ,param_11,"Pipe [%02d]:\n",uVar4,param_13,param_14);
          if ((int)uVar2 != 0) {
            return uVar2;
          }
          uVar2 = (**(code **)(*plVar1 + 0x938))(plVar1,param_10,param_11);
          if ((int)uVar2 != 0) {
            return uVar2;
          }
          uVar2 = glkBfLog(extraout_XMM0_Qa_00,param_2_00,param_3,param_4,param_5,param_6,param_7,
                           param_8,param_10,param_11,"\n",uVar4,param_13,param_14);
          if ((int)uVar2 != 0) {
            return uVar2;
          }
          uVar3 = *(uint *)(this + 0x108);
          uVar2 = extraout_XMM0_Qa_01;
        }
        uVar5 = uVar5 + 1;
      } while (uVar5 < uVar3);
      uVar2 = 0;
    }
  }
  return uVar2;
}



// IOAccelDisplayMachine::_RESERVEDIOAccelDisplayMachine1()

void IOAccelDisplayMachine::_RESERVEDIOAccelDisplayMachine1(void)

{
  OSMetaClass::reservedCalled(0x820c0);
  return;
}



// IOAccelDisplayMachine::_RESERVEDIOAccelDisplayMachine2()

void IOAccelDisplayMachine::_RESERVEDIOAccelDisplayMachine2(void)

{
  OSMetaClass::reservedCalled(0x820c0);
  return;
}



// IOAccelDisplayMachine::_RESERVEDIOAccelDisplayMachine3()

void IOAccelDisplayMachine::_RESERVEDIOAccelDisplayMachine3(void)

{
  OSMetaClass::reservedCalled(0x820c0);
  return;
}



// IOAccelDisplayMachine::_RESERVEDIOAccelDisplayMachine4()

void IOAccelDisplayMachine::_RESERVEDIOAccelDisplayMachine4(void)

{
  OSMetaClass::reservedCalled(0x820c0);
  return;
}



// IOAccelDisplayMachine::_RESERVEDIOAccelDisplayMachine5()

void IOAccelDisplayMachine::_RESERVEDIOAccelDisplayMachine5(void)

{
  OSMetaClass::reservedCalled(0x820c0);
  return;
}



// IOAccelDisplayMachine::MetaClass::~MetaClass()

void __thiscall IOAccelDisplayMachine::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelDisplayMachine_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelDisplayMachine::gMetaClass,"IOAccelDisplayMachine",
             (OSMetaClass *)PTR_gMetaClass_0006b070,0x178);
  _gMetaClass = &PTR__MetaClass_000716a8;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelDisplayMachine::gMetaClass);
  return;
}



// IOAccelSurfaceMTL::MetaClass::MetaClass()

void __thiscall IOAccelSurfaceMTL::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelSurfaceMTL",(OSMetaClass *)PTR_gMetaClass_0006b018,0x340);
  *(undefined ***)this = &PTR__MetaClass_00072168;
  return;
}



// IOAccelSurfaceMTL::MetaClass::~MetaClass()

void __thiscall IOAccelSurfaceMTL::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelSurfaceMTL::IOAccelSurfaceMTL(OSMetaClass const*)

void __thiscall IOAccelSurfaceMTL::IOAccelSurfaceMTL(IOAccelSurfaceMTL *this,OSMetaClass *param_1)

{
  IOUserClient::IOUserClient((IOUserClient *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelSurfaceMTL_000717a0;
  return;
}



// IOAccelSurfaceMTL::IOAccelSurfaceMTL(OSMetaClass const*)

void __thiscall IOAccelSurfaceMTL::IOAccelSurfaceMTL(IOAccelSurfaceMTL *this,OSMetaClass *param_1)

{
  IOUserClient::IOUserClient((IOUserClient *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelSurfaceMTL_000717a0;
  return;
}



// IOAccelSurfaceMTL::~IOAccelSurfaceMTL()

void __thiscall IOAccelSurfaceMTL::~IOAccelSurfaceMTL(IOAccelSurfaceMTL *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  return;
}



// IOAccelSurfaceMTL::~IOAccelSurfaceMTL()

void __thiscall IOAccelSurfaceMTL::~IOAccelSurfaceMTL(IOAccelSurfaceMTL *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  return;
}



// IOAccelSurfaceMTL::~IOAccelSurfaceMTL()

void __thiscall IOAccelSurfaceMTL::~IOAccelSurfaceMTL(IOAccelSurfaceMTL *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  _OSObject_typed_operator_delete(&IOAccelSurfaceMTL_ktv,this,0x340);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurfaceMTL::operator delete(void*, unsigned long)

void __cdecl IOAccelSurfaceMTL::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelSurfaceMTL_ktv,param_1,param_2);
  return;
}



// IOAccelSurfaceMTL::getMetaClass() const

undefined1 * IOAccelSurfaceMTL::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelSurfaceMTL::MetaClass::MetaClass()

void __thiscall IOAccelSurfaceMTL::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelSurfaceMTL",(OSMetaClass *)PTR_gMetaClass_0006b018,0x340);
  *(undefined ***)this = &PTR__MetaClass_00072168;
  return;
}



// IOAccelSurfaceMTL::MetaClass::alloc() const

IOUserClient * IOAccelSurfaceMTL::MetaClass::alloc(void)

{
  IOUserClient *this;
  
  this = (IOUserClient *)_OSObject_typed_operator_new(&IOAccelSurfaceMTL_ktv,0x340);
  IOUserClient::IOUserClient(this,(OSMetaClass *)&IOAccelSurfaceMTL::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelSurfaceMTL_000717a0;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelSurfaceMTL::operator new(unsigned long)

void * __thiscall IOAccelSurfaceMTL::operator_new(IOAccelSurfaceMTL *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelSurfaceMTL_ktv,this);
  return pvVar1;
}



// IOAccelSurfaceMTL::IOAccelSurfaceMTL()

void __thiscall IOAccelSurfaceMTL::IOAccelSurfaceMTL(IOAccelSurfaceMTL *this)

{
  IOUserClient::IOUserClient((IOUserClient *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelSurfaceMTL_000717a0;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelSurfaceMTL::IOAccelSurfaceMTL()

void __thiscall IOAccelSurfaceMTL::IOAccelSurfaceMTL(IOAccelSurfaceMTL *this)

{
  IOUserClient::IOUserClient((IOUserClient *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelSurfaceMTL_000717a0;
  OSMetaClass::instanceConstructed();
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurfaceMTL::s_signal_shared_event(IOAccelSurfaceMTL*, void*, IOExternalMethodArguments*)

void __cdecl
IOAccelSurfaceMTL::s_signal_shared_event(IOAccelSurfaceMTL *param_1,undefined8 param_2,long param_3)

{
  ulong *puVar1;
  
  puVar1 = *(ulong **)(param_3 + 0x20);
  signal_shared_event(param_1,*(task **)(param_1 + 0xe8),*puVar1,(uint)puVar1[1],puVar1[2]);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurfaceMTL::surface_read_lock_options(unsigned int, IOAccelSurfaceInformation*, unsigned
// long long)

undefined8 __cdecl
IOAccelSurfaceMTL::surface_read_lock_options(long param_1,undefined8 param_2,undefined8 param_3)

{
  surface_lock_options(param_1,param_2,param_3,(undefined8 *)param_3);
  return 0;
}



// IOAccelSurfaceMTL::surface_read_unlock_options(unsigned int)

undefined8 IOAccelSurfaceMTL::surface_read_unlock_options(void)

{
  return 0;
}



// IOAccelSurfaceMTL::get_state(eIOAccelSurfaceStateBits*)

undefined8 __thiscall IOAccelSurfaceMTL::get_state(IOAccelSurfaceMTL *this,uint *param_1)

{
  byte bVar1;
  
  bVar1 = (**(code **)(**(long **)(this + 0x2f8) + 0x870))();
  *param_1 = (uint)bVar1;
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurfaceMTL::surface_write_lock_options(unsigned int, IOAccelSurfaceInformation*, unsigned
// long long)

undefined8 __cdecl
IOAccelSurfaceMTL::surface_write_lock_options(long param_1,undefined8 param_2,undefined8 param_3)

{
  surface_lock_options(param_1,param_2,param_3,(undefined8 *)param_3);
  return 0;
}



// IOAccelSurfaceMTL::surface_write_unlock_options(unsigned int)

undefined8 IOAccelSurfaceMTL::surface_write_unlock_options(void)

{
  return 0;
}



// IOAccelSurfaceMTL::surface_read(IOAccelSurfaceReadData*, unsigned long long)

undefined8 IOAccelSurfaceMTL::surface_read(void)

{
  return 0xe00002c7;
}



// IOAccelSurfaceMTL::set_id_mode(unsigned int, unsigned int)

undefined8 __thiscall
IOAccelSurfaceMTL::set_id_mode(IOAccelSurfaceMTL *this,int param_1,uint param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  IOAccelSurfaceMTL IVar2;
  int iVar3;
  undefined8 in_RAX;
  undefined4 uVar4;
  uint uVar5;
  uint uVar6;
  undefined8 uVar7;
  undefined4 uVar8;
  
  uVar8 = (undefined4)((ulong)in_RAX >> 0x20);
  if ((param_2 & 0xff8033c0) != 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Surface mode contains bad bits\n",
                      "IOReturn IOAccelSurfaceMTL::set_id_mode(uint32_t, uint32_t)");
    return 0xe00002c2;
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x2f8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if ((~param_2 & 0xc00) == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Surface mode illegal. Can\'t force both front and back buffers at the same time.\n"
                      ,"IOReturn IOAccelSurfaceMTL::set_id_mode(uint32_t, uint32_t)");
  }
  else {
    uVar6 = param_2 & 0xffffbfff;
    iVar3 = (**(code **)(**(long **)(this + 0x100) + 0x130))();
    if (iVar3 != 0) {
      if (((param_2 ^ (uint)*(undefined8 *)(this + 0x158)) & 0x7f8c3f) != 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Surface mode incompatible\n",
                          "IOReturn IOAccelSurfaceMTL::set_id_mode(uint32_t, uint32_t)");
        goto LAB_0001046e;
      }
      uVar6 = (uint)*(undefined8 *)(this + 0x158) & 0xff8073c0 | uVar6;
    }
    uVar5 = (uVar6 & 0xf) - 3;
    IVar2 = (IOAccelSurfaceMTL)0x0;
    uVar4 = 0;
    if (uVar5 < 0xd) {
      IVar2 = *(IOAccelSurfaceMTL *)(&DAT_0006ae2d + (uVar6 & 0xf));
      uVar4 = *(undefined4 *)("1555ARGB" + (long)(int)uVar5 * 4);
    }
    if ((uVar6 & 0x20) != 0) {
      iVar3 = *(int *)(this + 0x128);
      if ((iVar3 == -0x20) || (iVar3 == param_1)) {
        *(ulong *)(this + 0x158) = (ulong)uVar6;
        *(int *)(this + 0x128) = param_1;
        this[0xf0] = IVar2;
        *(undefined4 *)(this + 0xf8) = uVar4;
        *(undefined4 *)(this + 0x134) = 0;
        reset_req_bits(this);
        prune_buffers(this);
        update_shape(this);
        this[0x138] = (IOAccelSurfaceMTL)0x0;
        uVar7 = 0;
      }
      else {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Surface already has id (0x%08x), can not accept new id (0x%08x)\n",
                          "IOReturn IOAccelSurfaceMTL::set_id_mode(uint32_t, uint32_t)",iVar3,
                          CONCAT44(uVar8,param_1));
        uVar7 = 0xe00002c2;
      }
      goto LAB_00010474;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Non Windowed Surfaces are not supported\n",
                      "IOReturn IOAccelSurfaceMTL::set_id_mode(uint32_t, uint32_t)");
  }
LAB_0001046e:
  uVar7 = 0xe00002bc;
LAB_00010474:
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x2f8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar7;
}



// IOAccelSurfaceMTL::set_scale(unsigned int, IOAccelSurfaceScaling*, unsigned long long)

ulong __thiscall
IOAccelSurfaceMTL::set_scale(IOAccelSurfaceMTL *this,uint param_1,long param_2,long param_3)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  if ((param_3 == 0x2c) || (param_3 == 0)) {
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x2f8);
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    if (param_3 == 0) {
      param_2 = 0;
    }
    uVar2 = set_scaling(this,(ulong)param_1,param_2);
    uVar2 = uVar2 & 0xffffffff;
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x2f8);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  }
  else {
    uVar2 = 0xe00002c2;
  }
  return uVar2;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurfaceMTL::set_shape(eIOAccelSurfaceShapeBits, unsigned int, IOAccelDeviceRegion*,
// unsigned long long)

undefined8 __cdecl
IOAccelSurfaceMTL::set_shape
          (IOAccelSurfaceMTL *param_1,uint param_2,int param_3,uint *param_4,undefined8 param_5,
          undefined8 param_6)

{
  undefined8 uVar1;
  
  if ((param_2 & 0x3000) != 0) {
    return 0xe00002c7;
  }
  uVar1 = set_shape_backing_length_ext(param_1,param_2,param_3,0,param_5,param_6,param_4,param_5);
  return uVar1;
}



// IOAccelSurfaceMTL::surface_flush(unsigned int, unsigned int)

undefined8 IOAccelSurfaceMTL::surface_flush(void)

{
  return 0xe00002c7;
}



// IOAccelSurfaceMTL::surface_query_lock()

undefined8 IOAccelSurfaceMTL::surface_query_lock(void)

{
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurfaceMTL::surface_read_lock(IOAccelSurfaceInformation*, unsigned long long)

undefined8 __cdecl
IOAccelSurfaceMTL::surface_read_lock(long param_1,undefined8 param_2,undefined8 param_3)

{
  surface_lock_options(param_1,param_2,param_3,(undefined8 *)param_2);
  return 0;
}



// IOAccelSurfaceMTL::surface_read_unlock()

undefined8 IOAccelSurfaceMTL::surface_read_unlock(void)

{
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurfaceMTL::surface_write_lock(IOAccelSurfaceInformation*, unsigned long long)

undefined8 __cdecl
IOAccelSurfaceMTL::surface_write_lock(long param_1,undefined8 param_2,undefined8 param_3)

{
  surface_lock_options(param_1,param_2,param_3,(undefined8 *)param_2);
  return 0;
}



// IOAccelSurfaceMTL::surface_write_unlock()

undefined8 IOAccelSurfaceMTL::surface_write_unlock(void)

{
  return 0;
}



// IOAccelSurfaceMTL::surface_control(unsigned int, unsigned int, unsigned int*)

ulong __thiscall
IOAccelSurfaceMTL::surface_control
          (IOAccelSurfaceMTL *this,undefined4 param_1,int param_2,uint *param_3)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x2f8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  uVar2 = surface_control_with_lock(this,param_1,param_2,param_3);
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x2f8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2 & 0xffffffff;
}



// IOAccelSurfaceMTL::init(OSDictionary*, task*)

undefined4 __thiscall
IOAccelSurfaceMTL::init(IOAccelSurfaceMTL *this,undefined8 param_2_00,undefined8 param_2)

{
  undefined4 uVar1;
  
  uVar1 = (**(code **)(PTR_vtable_0006b088 + 600))();
  if ((char)uVar1 != '\0') {
    _task_reference(param_2);
    *(undefined8 *)(this + 0xe8) = param_2;
  }
  return uVar1;
}



// IOAccelSurfaceMTL::start(IOService*)

bool __thiscall IOAccelSurfaceMTL::start(IOAccelSurfaceMTL *this,OSMetaClassBase *param_1)

{
  char cVar1;
  IOAccelSurfaceMTL IVar2;
  IOGraphicsAccelerator2 *pIVar3;
  
  cVar1 = (**(code **)(PTR_vtable_0006b088 + 0x5d0))();
  if (cVar1 != '\0') {
    pIVar3 = (IOGraphicsAccelerator2 *)
             OSMetaClassBase::safeMetaCast
                       (param_1,(OSMetaClass *)&IOGraphicsAccelerator2::gMetaClass);
    *(IOGraphicsAccelerator2 **)(this + 0x2f8) = pIVar3;
    if (pIVar3 != (IOGraphicsAccelerator2 *)0x0) {
      _OSIncrementAtomic(pIVar3 + 0x90);
      _IOLockLock(*(undefined8 *)(pIVar3 + 0x88));
      _OSDecrementAtomic(pIVar3 + 0x90);
      IOGraphicsAccelerator2::lock_busy(pIVar3);
      (**(code **)(*(long *)pIVar3 + 0x850))(pIVar3,"",0);
      IVar2 = (IOAccelSurfaceMTL)(**(code **)(*(long *)this + 0x960))(this);
      this[0xf3] = IVar2;
      pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0x2f8);
      (**(code **)(*(long *)pIVar3 + 0x858))(pIVar3,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar3);
      _IOLockUnlock(*(undefined8 *)(pIVar3 + 0x88));
      return this[0xf3] != (IOAccelSurfaceMTL)0x0;
    }
  }
  return false;
}



// IOAccelSurfaceMTL::stopLocked()

void __thiscall IOAccelSurfaceMTL::stopLocked(IOAccelSurfaceMTL *this)

{
  (**(code **)(*(long *)this + 0x968))();
  this[0xf3] = (IOAccelSurfaceMTL)0x0;
  (**(code **)(*(long *)this + 0x678))(this,*(undefined8 *)(this + 0x2f8));
  *(undefined8 *)(this + 0x2f8) = 0;
                    // WARNING: Could not recover jumptable at 0x000108b1. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x28))(this);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurfaceMTL::stop(IOService*)

void __cdecl IOAccelSurfaceMTL::stop(long *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  
  if (*(char *)((long)param_1 + 0xf3) != '\0') {
    pIVar1 = (IOGraphicsAccelerator2 *)param_1[0x5f];
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    pIVar1 = (IOGraphicsAccelerator2 *)param_1[0x5f];
    (**(code **)(*(long *)pIVar1 + 0x20))(pIVar1);
    (**(code **)(*param_1 + 0x968))(param_1);
    *(undefined1 *)((long)param_1 + 0xf3) = 0;
    (**(code **)(*param_1 + 0x678))(param_1,param_1[0x5f]);
    param_1[0x5f] = 0;
    (**(code **)(*param_1 + 0x28))(param_1);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
                    // WARNING: Could not recover jumptable at 0x00010997. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*(long *)pIVar1 + 0x28))(pIVar1);
    return;
  }
  return;
}



// IOAccelSurfaceMTL::clientClose()

undefined8 __thiscall IOAccelSurfaceMTL::clientClose(IOAccelSurfaceMTL *this)

{
  IOGraphicsAccelerator2 *pIVar1;
  int iVar2;
  OSMetaClassBase *pOVar3;
  IOAccelGLDrawableUserClient *this_00;
  uint uVar4;
  
  if (this[0xf3] != (IOAccelSurfaceMTL)0x0) {
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x2f8);
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    if (*(long **)(this + 0x100) != (long *)0x0) {
      iVar2 = (**(code **)(**(long **)(this + 0x100) + 0x130))();
      if (0 < iVar2) {
        uVar4 = iVar2 + 1;
        do {
          pOVar3 = (OSMetaClassBase *)
                   (**(code **)(**(long **)(this + 0x100) + 0x1e8))
                             (*(long **)(this + 0x100),uVar4 - 2);
          this_00 = (IOAccelGLDrawableUserClient *)
                    OSMetaClassBase::safeMetaCast
                              (pOVar3,(OSMetaClass *)&IOAccelGLDrawableUserClient::gMetaClass);
          if (this_00 == (IOAccelGLDrawableUserClient *)0x0) {
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: unknown object type\n",
                              "virtual IOReturn IOAccelSurfaceMTL::clientClose()");
          }
          else {
            IOAccelGLDrawableUserClient::remove_surface(this_00,(long)this);
          }
          uVar4 = uVar4 - 1;
        } while (1 < uVar4);
      }
    }
    this[0x138] = (IOAccelSurfaceMTL)0x1;
    *(undefined4 *)(this + 0x128) = 0xffffffe0;
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x2f8);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
    (**(code **)(*(long *)this + 0x600))(this,0);
  }
  return 0;
}



// IOAccelSurfaceMTL::surfaceStart()

undefined8 __thiscall IOAccelSurfaceMTL::surfaceStart(IOAccelSurfaceMTL *this)

{
  int *piVar1;
  undefined8 uVar2;
  long lVar3;
  
  this[0xf3] = (IOAccelSurfaceMTL)0x0;
  *(undefined8 *)(this + 0x2f0) = *(undefined8 *)(*(long *)(this + 0x2f8) + 0x150);
  *(undefined4 *)(this + 0x128) = 0xffffffe0;
  uVar2 = OSArray::withCapacity(1);
  *(undefined8 *)(this + 0x100) = uVar2;
  *(undefined8 *)(this + 0x158) = 0;
  *(undefined4 *)(this + 0x134) = 0;
  *(undefined4 *)(this + 0x13c) = 0;
  *(undefined8 *)(this + 0x140) = 0;
  *(undefined8 *)(this + 0x148) = 0;
  *(undefined8 *)(this + 300) = 0;
  *(undefined8 *)(this + 0x160) = 0;
  this[0xf0] = (IOAccelSurfaceMTL)0x0;
  lVar3 = 0x9a;
  do {
    *(undefined8 *)(this + lVar3 * 8 + -0x368) = 0;
    *(undefined4 *)(this + lVar3 * 4) = 0;
    lVar3 = lVar3 + 1;
  } while (lVar3 != 0xba);
  this[0x138] = (IOAccelSurfaceMTL)0x1;
  *(undefined4 *)(this + 0x110) = 0;
  *(undefined4 *)(this + 0xfc) = 0;
  uVar2 = OSArray::withCapacity(1);
  *(undefined8 *)(this + 0x2e8) = uVar2;
  IOAccelSurfaceMTLList::addSurface
            ((IOAccelSurfaceMTLList *)(*(long *)(this + 0x2f8) + 0xac0),(long)this);
  lVar3 = *(long *)(this + 0x2f8);
  uVar2 = IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar3 + 0x388) + 0x58),0x21);
  piVar1 = (int *)(lVar3 + 0x224);
  *piVar1 = *piVar1 + 1;
  this[0xf3] = (IOAccelSurfaceMTL)0x1;
  return CONCAT71((int7)((ulong)uVar2 >> 8),1);
}



// IOAccelSurfaceMTL::surfaceStop()

void __thiscall IOAccelSurfaceMTL::surfaceStop(IOAccelSurfaceMTL *this)

{
  int *piVar1;
  int iVar2;
  OSMetaClassBase *pOVar3;
  IOAccelGLDrawableUserClient *this_00;
  uint uVar4;
  long lVar5;
  
  this[0xf3] = (IOAccelSurfaceMTL)0x0;
  if (*(int *)(this + 0xfc) != 0) {
    lVar5 = *(long *)(this + 0x2f8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar5 + 0x388) + 0x58),0x22);
    piVar1 = (int *)(lVar5 + 0x228);
    *piVar1 = *piVar1 + -1;
  }
  if (*(long **)(this + 0x100) != (long *)0x0) {
    iVar2 = (**(code **)(**(long **)(this + 0x100) + 0x130))();
    if (0 < iVar2) {
      uVar4 = iVar2 + 1;
      do {
        pOVar3 = (OSMetaClassBase *)
                 (**(code **)(**(long **)(this + 0x100) + 0x1e8))
                           (*(long **)(this + 0x100),uVar4 - 2);
        this_00 = (IOAccelGLDrawableUserClient *)
                  OSMetaClassBase::safeMetaCast
                            (pOVar3,(OSMetaClass *)&IOAccelGLDrawableUserClient::gMetaClass);
        if (this_00 == (IOAccelGLDrawableUserClient *)0x0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: unknown object type\n",
                            "virtual void IOAccelSurfaceMTL::surfaceStop()");
        }
        else {
          IOAccelGLDrawableUserClient::remove_surface(this_00,(long)this);
        }
        IOGraphicsAccelerator2::decrement_busy_count(*(IOGraphicsAccelerator2 **)(this + 0x2f8));
        uVar4 = uVar4 - 1;
      } while (1 < uVar4);
    }
    (**(code **)(**(long **)(this + 0x100) + 0x28))();
    *(undefined8 *)(this + 0x100) = 0;
  }
  lVar5 = 0x2d;
  do {
    if (*(long *)(this + lVar5 * 8) != 0) {
      *(undefined8 *)(this + lVar5 * 8) = 0;
      IOSurfaceRoot::release_surface_async(*(IOSurface **)(*(long *)(this + 0x2f8) + 0x170));
    }
    lVar5 = lVar5 + 1;
  } while (lVar5 != 0x4d);
  IOAccelSurfaceMTLList::removeSurface
            ((IOAccelSurfaceMTLList *)(*(long *)(this + 0x2f8) + 0xac0),(long)this);
  lVar5 = *(long *)(this + 0x2f8);
  IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar5 + 0x388) + 0x58),0x21);
  piVar1 = (int *)(lVar5 + 0x224);
  *piVar1 = *piVar1 + 1;
  set_surface_blocking(this,0);
  return;
}



// IOAccelSurfaceMTL::set_surface_blocking(unsigned int)

undefined8 __thiscall IOAccelSurfaceMTL::set_surface_blocking(IOAccelSurfaceMTL *this,int param_1)

{
  int iVar1;
  long *plVar2;
  int iVar3;
  
  this[0xf2] = (IOAccelSurfaceMTL)(param_1 != 0);
  if (param_1 == 0) {
    iVar1 = (**(code **)(**(long **)(this + 0x2e8) + 0x130))();
    if (iVar1 != 0) {
      iVar3 = 0;
      do {
        plVar2 = (long *)(**(code **)(**(long **)(this + 0x2e8) + 0x1e8))
                                   (*(long **)(this + 0x2e8),iVar3);
        (**(code **)(*plVar2 + 0x118))(plVar2);
        iVar3 = iVar3 + 1;
      } while (iVar1 != iVar3);
    }
    (**(code **)(**(long **)(this + 0x2e8) + 0x158))();
    _IOLockWakeup_darwin14(*(undefined8 *)(*(long *)(this + 0x2f8) + 0x88),this,0);
  }
  return 0;
}



// IOAccelSurfaceMTL::free()

void __thiscall IOAccelSurfaceMTL::free(IOAccelSurfaceMTL *this)

{
  if (*(long **)(this + 0x2e8) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x2e8) + 0x28))();
  }
  *(undefined8 *)(this + 0x2e8) = 0;
  _task_deallocate(*(undefined8 *)(this + 0xe8));
                    // WARNING: Could not recover jumptable at 0x00010e7c. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b088 + 0xa0))(this);
  return;
}



// IOAccelSurfaceMTL::getTargetAndMethodForIndex(IOService**, unsigned int)

undefined ** __thiscall
IOAccelSurfaceMTL::getTargetAndMethodForIndex
          (IOAccelSurfaceMTL *this,undefined8 *param_1,uint param_2)

{
  undefined **ppuVar1;
  
  *param_1 = this;
  ppuVar1 = (undefined **)0x0;
  if (param_2 < 0x13) {
    ppuVar1 = &sSurfaceMethods + (ulong)param_2 * 6;
  }
  return ppuVar1;
}



// IOAccelSurfaceMTL::add_drawable_to_list(IOAccelGLDrawableUserClient*)

void __thiscall IOAccelSurfaceMTL::add_drawable_to_list(IOAccelSurfaceMTL *this,long *param_1)

{
  uint uVar1;
  
  (**(code **)(**(long **)(this + 0x100) + 0x1b8))();
  IOGraphicsAccelerator2::increment_busy_count(*(IOGraphicsAccelerator2 **)(this + 0x2f8));
  uVar1 = (**(code **)(*param_1 + 0x9a0))(param_1);
  *(uint *)(this + 0x13c) = *(uint *)(this + 0x13c) | uVar1;
  return;
}



// IOAccelSurfaceMTL::remove_drawable_from_list(IOAccelGLDrawableUserClient*)

void __thiscall IOAccelSurfaceMTL::remove_drawable_from_list(IOAccelSurfaceMTL *this,long param_1)

{
  int iVar1;
  long lVar2;
  int iVar3;
  
  iVar1 = (**(code **)(**(long **)(this + 0x100) + 0x130))();
  if (0 < iVar1) {
    iVar3 = 0;
    do {
      lVar2 = (**(code **)(**(long **)(this + 0x100) + 0x1e8))(*(long **)(this + 0x100),iVar3);
      if (lVar2 == param_1) {
        (**(code **)(**(long **)(this + 0x100) + 0x1d8))(*(long **)(this + 0x100),iVar3);
        break;
      }
      iVar3 = iVar3 + 1;
    } while (iVar1 != iVar3);
  }
  IOGraphicsAccelerator2::decrement_busy_count(*(IOGraphicsAccelerator2 **)(this + 0x2f8));
  reset_req_bits(this);
  return;
}



// IOAccelSurfaceMTL::reset_req_bits()

void __thiscall IOAccelSurfaceMTL::reset_req_bits(IOAccelSurfaceMTL *this)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  OSMetaClassBase *pOVar4;
  long *plVar5;
  int iVar6;
  
  *(undefined4 *)(this + 0x134) = 0;
  uVar3 = 3;
  if ((*(uint *)(this + 0x158) >> 10 & 1) == 0) {
    uVar3 = *(uint *)(this + 0x13c) & 3;
  }
  *(uint *)(this + 0x13c) = uVar3;
  iVar2 = (**(code **)(**(long **)(this + 0x100) + 0x130))();
  if (0 < iVar2) {
    iVar6 = 0;
    do {
      pOVar4 = (OSMetaClassBase *)
               (**(code **)(**(long **)(this + 0x100) + 0x1e8))(*(long **)(this + 0x100),iVar6);
      plVar5 = (long *)OSMetaClassBase::safeMetaCast
                                 (pOVar4,(OSMetaClass *)&IOAccelGLDrawableUserClient::gMetaClass);
      if (plVar5 == (long *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: unknown object type\n",
                          "void IOAccelSurfaceMTL::reset_req_bits()");
      }
      else {
        bVar1 = (**(code **)(*plVar5 + 0x9a8))(plVar5);
        this[0xf4] = (IOAccelSurfaceMTL)((byte)this[0xf4] | bVar1);
        uVar3 = (**(code **)(*plVar5 + 0x9a0))(plVar5);
        *(uint *)(this + 0x13c) = *(uint *)(this + 0x13c) | uVar3;
      }
      iVar6 = iVar6 + 1;
    } while (iVar2 != iVar6);
  }
  return;
}



// IOAccelSurfaceMTL::set_compatible_surface_mode(IOAccelGLDrawableUserClient*, unsigned long long)

ulong __thiscall
IOAccelSurfaceMTL::set_compatible_surface_mode(IOAccelSurfaceMTL *this,long *param_1,ulong param_2)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  long *plVar4;
  ulong uVar5;
  ulong uVar6;
  ulong local_30;
  
  uVar6 = *(ulong *)(this + 0x158);
  local_30 = uVar6;
  uVar2 = (**(code **)(**(long **)(this + 0x100) + 0x130))();
  if ((uVar2 < 2) &&
     ((iVar3 = (**(code **)(**(long **)(this + 0x100) + 0x130))(), iVar3 != 1 ||
      (plVar4 = (long *)(**(code **)(**(long **)(this + 0x100) + 0x1f0))(), plVar4 == param_1)))) {
    uVar5 = (**(code **)(*param_1 + 0x9d0))(param_1);
    local_30 = ~uVar5 & param_2 | (ulong)((uint)uVar6 & 0x7f8c3f);
  }
  else {
    cVar1 = (**(code **)(*param_1 + 0x9b0))(param_1,&local_30,param_2,*(undefined4 *)(this + 0x13c))
    ;
    if (cVar1 == '\0') {
      uVar6 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Failing fWindowMode = 0x%llx, mode = 0x%llx\n",
                        "bool IOAccelSurfaceMTL::set_compatible_surface_mode(IOAccelGLDrawableUserClient *, uint64_t)"
                        ,*(undefined8 *)(this + 0x158),param_2);
      goto LAB_00011135;
    }
  }
  *(ulong *)(this + 0x158) = local_30;
  uVar6 = CONCAT71((int7)((ulong)this >> 8),1);
LAB_00011135:
  return uVar6 & 0xffffffff;
}



// IOAccelSurfaceMTL::prune_buffers()

void __thiscall IOAccelSurfaceMTL::prune_buffers(IOAccelSurfaceMTL *this)

{
  uint uVar1;
  uint uVar2;
  long lVar3;
  long *plVar4;
  
  uVar2 = *(uint *)(this + 0x13c);
  if ((*(ulong *)(this + 0x158) & 0x20) != 0) {
    uVar1 = *(uint *)(this + 0x134);
    *(uint *)(this + 0x134) = uVar2 & 3 | uVar1;
    uVar2 = uVar2 | uVar1;
    if (((uint)*(ulong *)(this + 0x158) & 0x8020) == 0x20) goto LAB_00011186;
  }
  uVar2 = uVar2 | 1;
LAB_00011186:
  *(uint *)(this + 0x13c) = uVar2;
  lVar3 = 0;
  do {
    uVar2 = (uint)lVar3;
    if ((*(uint *)(this + 0x13c) >> (uVar2 & 0x1f) & 1) == 0) {
      if (*(long *)(this + lVar3 * 8 + 0x168) != 0) {
        *(undefined8 *)(this + lVar3 * 8 + 0x168) = 0;
        IOSurfaceRoot::release_surface_async(*(IOSurface **)(*(long *)(this + 0x2f8) + 0x170));
        *(ulong *)(this + 0x148) = *(ulong *)(this + 0x148) & (long)~(1 << ((byte)lVar3 & 0x1f));
      }
    }
    else if ((*(long *)(this + lVar3 * 8 + 0x168) == 0) && (((byte)this[0x15a] & 0x70) != 0)) {
      if (uVar2 == 1) {
        plVar4 = *(long **)(this + 0x168);
      }
      else {
        if (uVar2 != 0) goto LAB_0001124d;
        plVar4 = *(long **)(this + 0x170);
      }
      if (plVar4 != (long *)0x0) {
        (**(code **)(*plVar4 + 0x20))(plVar4);
        IOSurface::clientRetain();
        attach_surface_at_index(this,uVar2,plVar4);
        IOSurfaceRoot::release_surface_async(*(IOSurface **)(*(long *)(this + 0x2f8) + 0x170));
      }
    }
LAB_0001124d:
    lVar3 = lVar3 + 1;
    if (lVar3 == 0xb) {
      return;
    }
  } while( true );
}



// IOAccelSurfaceMTL::update_shape()

void __thiscall IOAccelSurfaceMTL::update_shape(IOAccelSurfaceMTL *this)

{
  short sVar1;
  short sVar2;
  uint uVar3;
  ulong uVar4;
  uint uVar5;
  ulong uVar6;
  ulong uVar7;
  bool bVar8;
  
  if (this[0xf1] != (IOAccelSurfaceMTL)0x0) {
    sVar1 = *(short *)(this + 0x164);
    sVar2 = *(short *)(this + 0x166);
    uVar4 = *(ulong *)(this + 0x158);
    uVar3 = *(uint *)(this + 0x13c);
    uVar5 = ~*(uint *)(this + 0x148) & uVar3 | 3;
    if (((*(ulong *)(this + 0x140) ^ uVar4) & 0x7f000f) == 0) {
      uVar5 = ~*(uint *)(this + 0x148) & uVar3;
    }
    if ((((uint)*(ushort *)(this + 0x150) != (int)sVar1) ||
        ((uint)*(ushort *)(this + 0x152) != (int)sVar2)) ||
       (((*(ulong *)(this + 0x140) ^ uVar4) & 0x7f0000) != 0)) {
      uVar5 = uVar5 | uVar3;
    }
    uVar5 = uVar5 & uVar3;
    uVar6 = (ulong)uVar5;
    if (uVar5 != 0) {
      uVar4 = 0;
      uVar7 = uVar6;
      do {
        if ((((uVar7 & 1) != 0) && (((byte)this[0x15a] & 0x70) == 0)) &&
           (*(long *)(this + uVar4 * 8 + 0x168) != 0)) {
          *(undefined8 *)(this + uVar4 * 8 + 0x168) = 0;
          IOSurfaceRoot::release_surface_async(*(IOSurface **)(*(long *)(this + 0x2f8) + 0x170));
        }
        if (uVar7 < 2) break;
        uVar7 = uVar7 >> 1;
        bVar8 = uVar4 < 10;
        uVar4 = uVar4 + 1;
      } while (bVar8);
      uVar4 = *(ulong *)(this + 0x158);
    }
    if ((uVar4 & 0x700000) != 0) {
      uVar4 = (ulong)(uVar5 & 0xfffffffd);
      if ((*(ulong *)(this + 0x148) & 1) == 0) {
        uVar4 = uVar6;
      }
      uVar6 = (ulong)((uint)uVar4 & 0xfffffffe);
      if ((*(ulong *)(this + 0x148) & 2) == 0) {
        uVar6 = uVar4;
      }
      if ((~(uint)uVar6 & 3) == 0) {
        uVar6 = (ulong)((uint)uVar6 & 0xfffffffc) | 1;
      }
    }
    (**(code **)(*(long *)this + 0x978))(this,uVar6,sVar1,sVar2);
    *(undefined8 *)(this + 0x140) = *(undefined8 *)(this + 0x158);
    *(ulong *)(this + 0x148) = (ulong)*(uint *)(this + 0x13c);
    *(short *)(this + 0x150) = sVar1;
    *(short *)(this + 0x152) = sVar2;
  }
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurfaceMTL::surface_lock_options(eLockType, unsigned int, IOAccelSurfaceInformation*,
// unsigned long long)

undefined8 __cdecl
IOAccelSurfaceMTL::surface_lock_options
          (long param_1,undefined8 param_2,undefined8 param_3,undefined8 *param_4)

{
  int iVar1;
  int iVar2;
  short *psVar3;
  uint uVar4;
  uint uVar5;
  bool bVar6;
  
  if (*(long *)(param_1 + 0x168) == 0) {
    uVar5 = 0;
    uVar4 = 0x7fffffff;
  }
  else {
    iVar1 = *(int *)(param_1 + 0x268);
    iVar2 = IOSurface::getUnlockSeed();
    bVar6 = iVar1 != iVar2;
    uVar4 = 1;
    if (!bVar6) {
      uVar4 = 0x7fffffff;
    }
    uVar5 = (uint)bVar6 << 0xb;
  }
  if (*(long *)(param_1 + 0x170) != 0) {
    iVar1 = *(int *)(param_1 + 0x26c);
    iVar2 = IOSurface::getUnlockSeed();
    if (iVar1 != iVar2) {
      uVar4 = 0;
      uVar5 = uVar5 | 0x400;
    }
  }
  param_4[10] = 0;
  param_4[9] = 0;
  param_4[8] = 0;
  param_4[7] = 0;
  param_4[6] = 0;
  param_4[5] = 0;
  param_4[4] = 0;
  param_4[3] = 0;
  param_4[2] = 0;
  param_4[1] = 0;
  *param_4 = 0;
  if (uVar4 != 0x7fffffff) {
    *(undefined4 *)(param_4 + 4) = 0xbada55;
    *param_4 = 0x13375fc;
    param_4[2] = (ulong)uVar4;
    param_4[3] = (ulong)uVar5;
  }
  if ((*(short *)(param_1 + 0x160) == *(short *)(param_1 + 0x164)) &&
     (*(short *)(param_1 + 0x162) == *(short *)(param_1 + 0x166))) {
    psVar3 = (short *)(param_1 + 0x166);
    *(int *)((long)param_4 + 0x24) = (int)*(short *)(param_1 + 0x164);
  }
  else {
    *(int *)((long)param_4 + 0x24) = (int)*(short *)(param_1 + 0x160);
    psVar3 = (short *)(param_1 + 0x162);
  }
  *(int *)(param_4 + 5) = (int)*psVar3;
  *(uint *)((long)param_4 + 0x2c) = *(uint *)(param_1 + 0x158) & 0xf;
  return 0;
}



// IOAccelSurfaceMTL::surface_unlock_options(eLockType, unsigned int)

undefined8 IOAccelSurfaceMTL::surface_unlock_options(void)

{
  return 0;
}



// IOAccelSurfaceMTL::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, unsigned int, unsigned
// long long, unsigned int, unsigned long long, IOAccelDeviceRegion*, unsigned long long)

undefined8 __thiscall
IOAccelSurfaceMTL::set_shape_backing_length_ext
          (IOAccelSurfaceMTL *this,uint param_1,int param_2,long param_3,undefined8 param_4,
          undefined8 param_5,uint *param_6,ulong param_7)

{
  short sVar1;
  IOGraphicsAccelerator2 *pIVar2;
  char cVar3;
  short sVar4;
  undefined4 uVar5;
  uint uVar6;
  undefined8 uVar7;
  uint local_50 [6];
  uint *local_38;
  
  local_50[2] = 0;
  local_50[3] = 0;
  local_50[0] = 0;
  local_50[1] = 0;
  local_50[4] = 0;
  if (param_2 != 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Bad frame buffer index\n",
                      "IOReturn IOAccelSurfaceMTL::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                     );
    return 0xe00002bc;
  }
  if (param_7 == 0) {
    local_38 = local_50;
LAB_0001161f:
    pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x2f8);
    _OSIncrementAtomic(pIVar2 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar2 + 0x88));
    _OSDecrementAtomic(pIVar2 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar2);
    (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
    if (((param_1 & 0x80) == 0) ||
       (uVar5 = IOGraphicsAccelerator2::acceleratorWaitEnabled
                          (*(IOGraphicsAccelerator2 **)(this + 0x2f8)), (char)uVar5 != '\0')) {
      *(uint *)(this + 0x130) = param_1;
      uVar6 = *(uint *)(this + 0x114);
      if (((param_1 & 4) != 0) && ((uVar6 & 2) != 0)) {
        uVar6 = uVar6 & 0xfffffffd;
        *(uint *)(this + 0x114) = uVar6;
      }
      *(undefined8 *)(this + 0x120) = *(undefined8 *)(local_38 + 1);
      this[0xf1] = (IOAccelSurfaceMTL)0x1;
      if ((uVar6 & 2) == 0) {
        *(short *)(this + 0x164) = (short)local_38[2];
        *(undefined2 *)(this + 0x166) = *(undefined2 *)((long)local_38 + 10);
      }
      if ((param_3 == 0) || (*local_38 != 1)) {
        sVar4 = *(short *)(this + 0x164);
        sVar1 = *(short *)(this + 0x166);
        *(short *)(this + 0x160) = sVar4;
        *(short *)(this + 0x162) = sVar1;
      }
      else {
        *(short *)(this + 0x160) = (short)local_38[4];
        *(undefined2 *)(this + 0x162) = *(undefined2 *)((long)local_38 + 0x12);
        sVar4 = *(short *)(this + 0x164);
        sVar1 = *(short *)(this + 0x166);
      }
      cVar3 = (**(code **)(*(long *)this + 0x970))(this,(int)sVar4,(int)sVar1);
      uVar7 = 0;
      if (cVar3 == '\0') {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: bounds are too big\n",
                          "IOReturn IOAccelSurfaceMTL::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                         );
        this[0x138] = (IOAccelSurfaceMTL)0x1;
        uVar7 = 0xe00002be;
      }
      pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x2f8);
      (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar2);
      _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
    }
    else {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: %s device terminated\n",
                        "IOReturn IOAccelSurfaceMTL::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                        ,*(undefined8 *)(*(long *)(this + 0x2f8) + 0xc88));
      pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x2f8);
      (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar2);
      _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
      uVar7 = 0xe00002c0;
    }
  }
  else {
    uVar7 = 0xe00002bc;
    if (param_7 < 0xc) {
      return 0xe00002bc;
    }
    if ((ulong)*param_6 * 8 + 0xc != param_7) {
      return 0xe00002bc;
    }
    sVar4 = (short)param_6[2];
    if ((-1 < sVar4) && (-1 < *(short *)((long)param_6 + 10))) {
      cVar3 = (**(code **)(*(long *)this + 0x970))
                        (this,(int)sVar4,(int)*(short *)((long)param_6 + 10));
      sVar4 = (short)param_6[2];
      if (cVar3 != '\0') {
        local_38 = param_6;
        if ((sVar4 == 0) || (*(short *)((long)param_6 + 10) == 0)) {
          param_6[2] = 0x10001;
          param_3 = 0;
        }
        goto LAB_0001161f;
      }
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: bounds width or height invalid, w=%d h=%d\n",
                      "IOReturn IOAccelSurfaceMTL::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                      ,(int)sVar4,(int)*(short *)((long)param_6 + 10));
  }
  return uVar7;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurfaceMTL::s_set_shape(IOAccelSurfaceMTL*, void*, IOExternalMethodArguments*)

ulong __cdecl
IOAccelSurfaceMTL::s_set_shape
          (IOAccelSurfaceMTL *param_1,undefined8 param_2,long param_3,undefined8 param_4,
          undefined8 param_5,undefined8 param_6)

{
  uint uVar1;
  long *plVar2;
  uint *puVar3;
  ulong uVar4;
  ulong uVar5;
  
  plVar2 = *(long **)(param_3 + 0x40);
  if (plVar2 == (long *)0x0) {
    uVar4 = (ulong)*(uint *)(param_3 + 0x38);
    puVar3 = *(uint **)(param_3 + 0x30);
    plVar2 = (long *)0x0;
  }
  else {
    plVar2 = (long *)(**(code **)(*plVar2 + 0x200))(plVar2,0x1000);
    if (plVar2 == (long *)0x0) {
      return 0xe00002c8;
    }
    puVar3 = (uint *)(**(code **)(*plVar2 + 0x118))(plVar2);
    uVar4 = (**(code **)(**(long **)(param_3 + 0x40) + 0x1c8))();
  }
  uVar5 = 0xe00002c2;
  if ((puVar3 != (uint *)0x0) && (0xb < uVar4)) {
    uVar1 = **(uint **)(param_3 + 0x20);
    uVar5 = 0xe00002c7;
    if ((uVar1 & 0x3000) == 0) {
      uVar5 = set_shape_backing_length_ext
                        (param_1,uVar1,(*(uint **)(param_3 + 0x20))[2],0,param_5,param_6,puVar3,
                         uVar4);
      uVar5 = uVar5 & 0xffffffff;
    }
  }
  if (plVar2 != (long *)0x0) {
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return uVar5;
}



// IOAccelSurfaceMTL::externalMethod(unsigned int, IOExternalMethodArguments*,
// IOExternalMethodDispatch*, OSObject*, void*)

void __thiscall
IOAccelSurfaceMTL::externalMethod
          (IOAccelSurfaceMTL *this,undefined8 param_2_00,long param_2,undefined **param_3,
          IOAccelSurfaceMTL *param_4,undefined8 param_5)

{
  uint *puVar1;
  int iVar2;
  
  iVar2 = (int)param_2_00;
  if (iVar2 < 0x11) {
    if (iVar2 == 6) {
LAB_0001196e:
      puVar1 = *(uint **)(param_2 + 0x20);
      set_shape_backing_length_ext
                (this,*puVar1,puVar1[2],*(long *)(puVar1 + 4),(ulong)*(uint *)(param_2 + 0x38),
                 param_5,*(uint **)(param_2 + 0x30),(ulong)*(uint *)(param_2 + 0x38));
      return;
    }
    if (iVar2 == 9) {
      param_3 = &externalMethod(unsigned_int,IOExternalMethodArguments*,IOExternalMethodDispatch*,OSObject*,void*)
                 ::newResourceDispatch;
      param_2_00 = 9;
      param_4 = this;
    }
  }
  else {
    if (iVar2 == 0x11) goto LAB_0001196e;
    if (iVar2 == 0x12) {
      param_3 = &sSignalEventDispatch;
      param_2_00 = 0x12;
      param_4 = this;
    }
  }
                    // WARNING: Could not recover jumptable at 0x0001199a. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b088 + 0x860))(this,param_2_00,param_2,param_3,param_4);
  return;
}



// IOAccelSurfaceMTL::set_scaling(unsigned int, IOAccelSurfaceScaling*)

undefined8 __thiscall
IOAccelSurfaceMTL::set_scaling(IOAccelSurfaceMTL *this,ulong param_2_00,long param_2)

{
  undefined2 uVar1;
  char cVar2;
  undefined2 uVar3;
  undefined8 uVar4;
  IOAccelSurfaceMTL *pIVar5;
  
  if (((param_2_00 & 2) == 0) || (uVar4 = 0xe00002c2, param_2 != 0)) {
    if ((param_2_00 & 2) == 0) {
      this[0x114] = (IOAccelSurfaceMTL)((byte)this[0x114] & 0xfd);
      uVar3 = *(undefined2 *)(this + 0x124);
      *(undefined2 *)(this + 0x164) = uVar3;
      pIVar5 = this + 0x126;
    }
    else {
      if (((byte)this[0x158] & 0x20) == 0) {
        *(undefined4 *)(this + 0x160) = *(undefined4 *)(this + 0x164);
        return 0xe00002bc;
      }
      this[0x114] = (IOAccelSurfaceMTL)((byte)this[0x114] | 2);
      uVar3 = *(undefined2 *)(param_2 + 4);
      *(undefined2 *)(this + 0x164) = uVar3;
      pIVar5 = (IOAccelSurfaceMTL *)(param_2 + 6);
    }
    uVar1 = *(undefined2 *)pIVar5;
    *(undefined2 *)(this + 0x166) = uVar1;
    *(undefined2 *)(this + 0x160) = uVar3;
    *(undefined2 *)(this + 0x162) = uVar1;
    update_shape(this);
    this[0x138] = (IOAccelSurfaceMTL)0x0;
    cVar2 = (**(code **)(*(long *)this + 0x970))
                      (this,(int)*(short *)(this + 0x164),(int)*(short *)(this + 0x166));
    uVar4 = 0;
    if (cVar2 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: bounds are too big\n",
                        "IOReturn IOAccelSurfaceMTL::set_scaling(IOOptionBits, IOAccelSurfaceScaling *)"
                       );
      this[0x138] = (IOAccelSurfaceMTL)0x1;
      uVar4 = 0xe00002be;
    }
  }
  return uVar4;
}



// IOAccelSurfaceMTL::surface_control_with_lock(unsigned int, unsigned int, unsigned int*)

undefined8 __thiscall
IOAccelSurfaceMTL::surface_control_with_lock
          (IOAccelSurfaceMTL *this,undefined4 param_1,int param_2,uint *param_3)

{
  uint uVar1;
  undefined8 uVar2;
  ulong uVar3;
  
  uVar2 = 0xe00002c7;
  switch(param_1) {
  case 1:
    set_surface_blocking(this,param_2);
    break;
  default:
    return 0xe00002c2;
  case 4:
  case 0x13:
    *param_3 = 0;
    break;
  case 5:
    goto switchD_00011ac7_caseD_5;
  case 0x10:
    *param_3 = 1;
    break;
  case 0x11:
    *param_3 = 0;
    uVar1 = *(uint *)(this + 0x13c);
    *param_3 = uVar1 & 1;
    *param_3 = (uVar1 & 1) + (uint)((*(uint *)(this + 0x13c) >> 1 & 1) != 0);
    break;
  case 0x12:
    *param_3 = 0;
    return 0xe00002c7;
  case 0x14:
    uVar3 = convertGLDrawableIndexToBufferIndex(this,param_2);
    uVar2 = 0xe00002c2;
    if (((int)uVar3 != 0xffff) &&
       (*(uint **)(this + (uVar3 & 0xffffffff) * 8 + 0x168) != (uint *)0x0)) {
      uVar2 = IOSurfaceRoot::copyPortNameForSurfaceInTask
                        (*(task **)(*(long *)(this + 0x2f8) + 0x170),*(IOSurface **)(this + 0xe8),
                         *(uint **)(this + (uVar3 & 0xffffffff) * 8 + 0x168));
    }
    *param_3 = 0xaaaaaaaa;
    goto switchD_00011ac7_caseD_5;
  }
  uVar2 = 0;
switchD_00011ac7_caseD_5:
  return uVar2;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurfaceMTL::getSurfaceBuffer(eIOAccelGLDrawableClientBufferType)

undefined8 __cdecl IOAccelSurfaceMTL::getSurfaceBuffer(IOAccelSurfaceMTL *param_1,int param_2)

{
  ulong uVar1;
  undefined8 uVar2;
  
  uVar1 = convertGLDrawableIndexToBufferIndex(param_1,param_2);
  if ((int)uVar1 == 0xffff) {
    uVar2 = 0;
  }
  else {
    uVar2 = *(undefined8 *)(param_1 + (uVar1 & 0xffffffff) * 8 + 0x168);
  }
  return uVar2;
}



// IOAccelSurfaceMTL::signal_shared_event(task*, unsigned long long, unsigned int, unsigned long
// long)

undefined8 __thiscall
IOAccelSurfaceMTL::signal_shared_event
          (IOAccelSurfaceMTL *this,task *param_1,ulong param_2,uint param_3,long param_4)

{
  IOGraphicsAccelerator2 *pIVar1;
  int iVar2;
  long lVar3;
  long *plVar4;
  IOAccelEventFence *pIVar5;
  ulonglong uVar6;
  undefined8 uVar7;
  OSObject *local_40;
  long local_38;
  
  if (1 < param_2) {
    return 0xe00002c7;
  }
  local_40 = (OSObject *)0x0;
  iVar2 = IOUserClient::copyObjectForPortNameInTask(param_1,param_3,&local_40);
  if ((iVar2 != 0) ||
     (lVar3 = OSMetaClassBase::safeMetaCast
                        ((OSMetaClassBase *)local_40,*(OSMetaClass **)PTR_metaClass_0006b048),
     lVar3 == 0)) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s:signal_shared_event: bad event port name: %d obj: %p\n",
                      "IOReturn IOAccelSurfaceMTL::signal_shared_event(task_t, uint64_t, mach_port_name_t, uint64_t)"
                      ,param_3,local_40);
    uVar7 = 0xe00002c2;
    goto LAB_00011e2a;
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x2f8);
  local_38 = lVar3;
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  uVar7 = 0;
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (param_2 == 1) {
    if (this[0xf2] != (IOAccelSurfaceMTL)0x0) {
      plVar4 = (long *)IOSurfaceSharedEventReference::getSharedEvent();
      plVar4 = IOSurfaceMTLSharedEventFence::withSharedEvent(plVar4,param_4);
      if (plVar4 != (long *)0x0) {
        (**(code **)(**(long **)(this + 0x2e8) + 0x1b8))(*(long **)(this + 0x2e8),plVar4);
        (**(code **)(*plVar4 + 0x28))(plVar4);
        goto LAB_00011dfa;
      }
    }
LAB_00011de6:
    uVar6 = IOSurfaceSharedEventReference::getSharedEvent();
    IOSurfaceSharedEvent::signalCompleted(uVar6);
    uVar7 = 0;
  }
  else {
    uVar7 = 0;
    if (param_2 == 0) {
      if ((*(void **)(this + 0x168) != (void *)0x0) &&
         (plVar4 = IOGraphicsAccelerator2::deviceCacheForIOSurface
                             (*(IOGraphicsAccelerator2 **)(this + 0x2f8),*(void **)(this + 0x168)),
         plVar4 != (long *)0x0)) {
        lVar3 = plVar4[4];
        (**(code **)(*plVar4 + 0x28))(plVar4);
        if (lVar3 != 0) {
          plVar4 = (long *)IOSurfaceSharedEventReference::getSharedEvent();
          pIVar5 = IOAccelSharedEventFence::withSharedEvent
                             (plVar4,param_4,*(long *)(this + 0x2f8),0);
          if (pIVar5 == (IOAccelEventFence *)0x0) {
            uVar7 = 0xe00002bd;
          }
          else {
            (**(code **)(**(long **)(*(long *)(this + 0x2f8) + 0x380) + 0x1b0))
                      (*(long **)(*(long *)(this + 0x2f8) + 0x380),
                       (ulong)*(byte *)(lVar3 + 0x16) * 0x40 + *(long *)(lVar3 + 0x38),pIVar5 + 0x68
                      );
            IOAccelFenceMachine::addEventFence
                      (*(IOAccelFenceMachine **)(*(long *)(this + 0x2f8) + 0x390),0,(long)pIVar5);
            uVar7 = 0;
          }
          goto LAB_00011dfa;
        }
      }
      goto LAB_00011de6;
    }
  }
LAB_00011dfa:
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x2f8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
LAB_00011e2a:
  if (local_40 != (OSObject *)0x0) {
    (**(code **)(*(long *)local_40 + 0x28))();
  }
  return uVar7;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOSurfaceMTLSharedEventFence::withSharedEvent(IOSurfaceSharedEvent*, unsigned long long)

long * __cdecl IOSurfaceMTLSharedEventFence::withSharedEvent(long *param_1,long param_2)

{
  char cVar1;
  long *plVar2;
  
  plVar2 = (long *)(**(code **)(gMetaClass + 0x88))(&gMetaClass);
  if (plVar2 != (long *)0x0) {
    cVar1 = (**(code **)(PTR_vtable_0006b0a0 + 0x98))(plVar2);
    if (cVar1 != '\0') {
      plVar2[2] = (long)param_1;
      (**(code **)(*param_1 + 0x20))(param_1);
      plVar2[3] = param_2;
      return plVar2;
    }
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return (long *)0x0;
}



// IOAccelSurfaceMTL::invalidate_drawables()

void __thiscall IOAccelSurfaceMTL::invalidate_drawables(IOAccelSurfaceMTL *this)

{
  int iVar1;
  OSMetaClassBase *pOVar2;
  long lVar3;
  int iVar4;
  
  iVar1 = (**(code **)(**(long **)(this + 0x100) + 0x130))();
  if (0 < iVar1) {
    iVar4 = 0;
    do {
      pOVar2 = (OSMetaClassBase *)
               (**(code **)(**(long **)(this + 0x100) + 0x1e8))(*(long **)(this + 0x100),iVar4);
      lVar3 = OSMetaClassBase::safeMetaCast
                        (pOVar2,(OSMetaClass *)&IOAccelGLDrawableUserClient::gMetaClass);
      if (lVar3 != 0) {
        IOAccelGLDrawableUserClient::invalidate();
      }
      iVar4 = iVar4 + 1;
    } while (iVar1 != iVar4);
  }
  return;
}



// IOAccelSurfaceMTL::flip_buffers()

void __thiscall IOAccelSurfaceMTL::flip_buffers(IOAccelSurfaceMTL *this)

{
  long lVar1;
  
  lVar1 = *(long *)(this + 0x170);
  if (lVar1 == 0) {
    return;
  }
  *(undefined8 *)(this + 0x170) = *(undefined8 *)(this + 0x168);
  *(long *)(this + 0x168) = lVar1;
                    // WARNING: Subroutine does not return
  _panic("\"should never hit flip_buffers\" @%s:%d","IOAccelSurfaceMTL.cpp",0x507);
}



// IOAccelSurfaceMTL::attach_surface_at_index(int, IOSurface*)

void __thiscall
IOAccelSurfaceMTL::attach_surface_at_index(IOAccelSurfaceMTL *this,int param_1,long *param_2)

{
  undefined4 uVar1;
  long lVar2;
  
  lVar2 = (long)param_1;
  if (*(long **)(this + lVar2 * 8 + 0x168) != param_2) {
    if (*(long **)(this + lVar2 * 8 + 0x168) != (long *)0x0) {
      *(undefined8 *)(this + lVar2 * 8 + 0x168) = 0;
      IOSurfaceRoot::release_surface_async(*(IOSurface **)(*(long *)(this + 0x2f8) + 0x170));
    }
    (**(code **)(*param_2 + 0x20))(param_2);
    IOSurface::clientRetain();
    *(long **)(this + lVar2 * 8 + 0x168) = param_2;
    uVar1 = IOSurface::getUnlockSeed();
    *(undefined4 *)(this + lVar2 * 4 + 0x268) = uVar1;
  }
  return;
}



// IOAccelSurfaceMTL::detach_surface_at_index(int)

void __thiscall IOAccelSurfaceMTL::detach_surface_at_index(IOAccelSurfaceMTL *this,int param_1)

{
  *(undefined8 *)(this + (long)param_1 * 8 + 0x168) = 0;
  IOSurfaceRoot::release_surface_async(*(IOSurface **)(*(long *)(this + 0x2f8) + 0x170));
  return;
}



// IOAccelSurfaceMTL::isSurfaceSizeSupported(short, short)

undefined2 __thiscall
IOAccelSurfaceMTL::isSurfaceSizeSupported(IOAccelSurfaceMTL *this,int param_2_00,short param_2)

{
  ushort uVar1;
  undefined2 uVar2;
  
  if ((int)(uint)*(ushort *)(*(long *)(this + 0x2f8) + 0xcb8) < param_2_00) {
    uVar2 = 0;
  }
  else {
    uVar1 = *(ushort *)(*(long *)(this + 0x2f8) + 0xcba);
    uVar2 = CONCAT11((char)(uVar1 >> 8),(int)param_2 <= (int)(uint)uVar1);
  }
  return uVar2;
}



// IOAccelSurfaceMTL::convertGLDrawableIndexToBufferIndex(eIOAccelGLDrawableClientBufferType)

undefined8 __thiscall
IOAccelSurfaceMTL::convertGLDrawableIndexToBufferIndex(IOAccelSurfaceMTL *this,int param_1)

{
  undefined8 uVar1;
  
  uVar1 = 1;
  switch(param_1) {
  case 0:
    break;
  case 2:
  case 5:
  case 8:
  case 9:
  case 10:
  case 0xb:
switchD_00012062_caseD_2:
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: bad gl_index %d\n",
                      "uint32_t IOAccelSurfaceMTL::convertGLDrawableIndexToBufferIndex(eIOAccelGLDrawableClientBufferType)"
                      ,0xaaaaaaaa);
    uVar1 = 0xffff;
    break;
  case 3:
    uVar1 = 2;
    break;
  case 4:
    uVar1 = 3;
    break;
  case 6:
    uVar1 = 5;
    break;
  case 7:
    uVar1 = 6;
    break;
  case 0xc:
    uVar1 = 10;
    break;
  case 0xd:
    uVar1 = 4;
    break;
  case 0xe:
    uVar1 = 7;
    break;
  default:
    if (param_1 != 0x7fffffff) goto switchD_00012062_caseD_2;
  case 1:
    uVar1 = 0;
  }
  return uVar1;
}



// IOAccelSurfaceMTL::shape_buffers(unsigned int, unsigned int, unsigned short, unsigned short,
// bool)

void __thiscall
IOAccelSurfaceMTL::shape_buffers
          (IOAccelSurfaceMTL *this,uint param_1,uint param_2,uint param_3,uint param_5_00,
          char param_5)

{
  undefined8 uVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined8 uVar4;
  int iVar5;
  undefined4 uVar6;
  long *plVar7;
  undefined8 uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  long lVar13;
  
  iVar5 = 0x1f;
  if (param_3 - 1 != 0) {
    for (; param_3 - 1 >> iVar5 == 0; iVar5 = iVar5 + -1) {
    }
  }
  uVar9 = 1 << (-((byte)iVar5 ^ 0x1f) & 0x1f);
  if ((ushort)param_3 < 2) {
    uVar9 = 1;
  }
  iVar5 = 0x1f;
  if (param_5_00 - 1 != 0) {
    for (; param_5_00 - 1 >> iVar5 == 0; iVar5 = iVar5 + -1) {
    }
  }
  uVar10 = 1 << (-((byte)iVar5 ^ 0x1f) & 0x1f);
  if ((ushort)param_5_00 < 2) {
    uVar10 = 1;
  }
  uVar1 = *(undefined8 *)PTR__kIOSurfacePixelFormat_0006b0e0;
  uVar2 = *(undefined8 *)PTR__kIOSurfaceBytesPerElement_0006b0d0;
  uVar3 = *(undefined8 *)PTR__kIOSurfaceWidth_0006b0e8;
  uVar4 = *(undefined8 *)PTR__kIOSurfaceHeight_0006b0d8;
  lVar13 = 0;
  do {
    if ((param_1 >> ((uint)lVar13 & 0x1f) & 1) != 0) {
      plVar7 = (long *)OSDictionary::withCapacity(4);
      uVar12 = uVar9;
      uVar11 = uVar10;
      if (param_5 != '\0') {
        setUInt32(plVar7,uVar1,*(uint *)(this + 0xf8));
        uVar12 = param_3;
        uVar11 = param_5_00;
      }
      setUInt32(plVar7,uVar2,param_2);
      setUInt32(plVar7,uVar3,uVar12);
      setUInt32(plVar7,uVar4,uVar11);
      uVar8 = IOSurfaceRoot::createSurface
                        (*(task **)(*(long *)(this + 0x2f8) + 0x170),*(OSDictionary **)(this + 0xe8)
                        );
      IOSurface::clientRetain();
      if (*(long *)(this + lVar13 * 8 + 0x168) != 0) {
        IOSurfaceRoot::release_surface_async(*(IOSurface **)(*(long *)(this + 0x2f8) + 0x170));
      }
      *(undefined8 *)(this + lVar13 * 8 + 0x168) = uVar8;
      uVar6 = IOSurface::getUnlockSeed();
      *(undefined4 *)(this + lVar13 * 4 + 0x268) = uVar6;
      (**(code **)(*plVar7 + 0x28))(plVar7);
    }
    lVar13 = lVar13 + 1;
  } while (lVar13 != 0xb);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// setUInt32(OSDictionary*, char const*, unsigned int)

void __cdecl setUInt32(long *param_1,undefined8 param_2,uint param_3)

{
  long *plVar1;
  
  plVar1 = (long *)OSNumber::withNumber((ulong)param_3,0x20);
  if (plVar1 != (long *)0x0) {
    (**(code **)(*param_1 + 0x1d0))(param_1,param_2,plVar1);
                    // WARNING: Could not recover jumptable at 0x000122f2. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*plVar1 + 0x28))(plVar1);
    return;
  }
  return;
}



// IOAccelSurfaceMTL::shapeSurface(unsigned int, unsigned short, unsigned short)

void __thiscall
IOAccelSurfaceMTL::shapeSurface(IOAccelSurfaceMTL *this,uint param_1,ushort param_2,ushort param_3)

{
  uint uVar1;
  uint uVar2;
  
  uVar2 = (uint)param_2;
  uVar1 = (uint)param_3;
  if ((param_1 & 0xf) != 0) {
    shape_buffers(this,param_1 & 0xf,(uint)(byte)this[0xf0],uVar2,uVar1,'\x01');
  }
  if ((param_1 & 0x70) != 0) {
    shape_buffers(this,param_1 & 0x70,4,uVar2,uVar1,'\0');
  }
  if ((param_1 & 0x380) != 0) {
    shape_buffers(this,param_1 & 0x380,1,uVar2,uVar1,'\0');
    return;
  }
  return;
}



// IOAccelSurfaceMTL::getOwningTaskPid()

undefined8 __thiscall IOAccelSurfaceMTL::getOwningTaskPid(IOAccelSurfaceMTL *this)

{
  long lVar1;
  undefined8 uVar2;
  
  lVar1 = _get_bsdtask_info(*(undefined8 *)(this + 0xe8));
  if (lVar1 != 0) {
    uVar2 = _proc_pid(lVar1);
    return uVar2;
  }
  return 0xffffffff;
}



// IOAccelSurfaceMTL::_RESERVEDIOAccelSurfaceMTL0()

void IOAccelSurfaceMTL::_RESERVEDIOAccelSurfaceMTL0(void)

{
  OSMetaClass::reservedCalled(0x820e8);
  return;
}



// IOAccelSurfaceMTL::_RESERVEDIOAccelSurfaceMTL1()

void IOAccelSurfaceMTL::_RESERVEDIOAccelSurfaceMTL1(void)

{
  OSMetaClass::reservedCalled(0x820e8);
  return;
}



// IOAccelSurfaceMTL::_RESERVEDIOAccelSurfaceMTL2()

void IOAccelSurfaceMTL::_RESERVEDIOAccelSurfaceMTL2(void)

{
  OSMetaClass::reservedCalled(0x820e8);
  return;
}



// IOAccelSurfaceMTL::_RESERVEDIOAccelSurfaceMTL3()

void IOAccelSurfaceMTL::_RESERVEDIOAccelSurfaceMTL3(void)

{
  OSMetaClass::reservedCalled(0x820e8);
  return;
}



// IOAccelSurfaceMTL::_RESERVEDIOAccelSurfaceMTL4()

void IOAccelSurfaceMTL::_RESERVEDIOAccelSurfaceMTL4(void)

{
  OSMetaClass::reservedCalled(0x820e8);
  return;
}



// IOAccelSurfaceMTL::_RESERVEDIOAccelSurfaceMTL5()

void IOAccelSurfaceMTL::_RESERVEDIOAccelSurfaceMTL5(void)

{
  OSMetaClass::reservedCalled(0x820e8);
  return;
}



// IOSurfaceMTLSharedEventFence::MetaClass::MetaClass()

void __thiscall IOSurfaceMTLSharedEventFence::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOSurfaceMTLSharedEventFence",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x20);
  *(undefined ***)this = &PTR__MetaClass_00072760;
  return;
}



// IOSurfaceMTLSharedEventFence::MetaClass::~MetaClass()

void __thiscall IOSurfaceMTLSharedEventFence::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOSurfaceMTLSharedEventFence::IOSurfaceMTLSharedEventFence(OSMetaClass const*)

void __thiscall
IOSurfaceMTLSharedEventFence::IOSurfaceMTLSharedEventFence
          (IOSurfaceMTLSharedEventFence *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOSurfaceMTLSharedEventFence_00072628;
  return;
}



// IOSurfaceMTLSharedEventFence::IOSurfaceMTLSharedEventFence(OSMetaClass const*)

void __thiscall
IOSurfaceMTLSharedEventFence::IOSurfaceMTLSharedEventFence
          (IOSurfaceMTLSharedEventFence *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOSurfaceMTLSharedEventFence_00072628;
  return;
}



// IOSurfaceMTLSharedEventFence::~IOSurfaceMTLSharedEventFence()

void __thiscall
IOSurfaceMTLSharedEventFence::~IOSurfaceMTLSharedEventFence(IOSurfaceMTLSharedEventFence *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOSurfaceMTLSharedEventFence::~IOSurfaceMTLSharedEventFence()

void __thiscall
IOSurfaceMTLSharedEventFence::~IOSurfaceMTLSharedEventFence(IOSurfaceMTLSharedEventFence *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOSurfaceMTLSharedEventFence::~IOSurfaceMTLSharedEventFence()

void __thiscall
IOSurfaceMTLSharedEventFence::~IOSurfaceMTLSharedEventFence(IOSurfaceMTLSharedEventFence *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOSurfaceMTLSharedEventFence_ktv,this,0x20);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOSurfaceMTLSharedEventFence::operator delete(void*, unsigned long)

void __cdecl IOSurfaceMTLSharedEventFence::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOSurfaceMTLSharedEventFence_ktv,param_1,param_2);
  return;
}



// IOSurfaceMTLSharedEventFence::getMetaClass() const

undefined8 * IOSurfaceMTLSharedEventFence::getMetaClass(void)

{
  return &gMetaClass;
}



// IOSurfaceMTLSharedEventFence::MetaClass::MetaClass()

void __thiscall IOSurfaceMTLSharedEventFence::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOSurfaceMTLSharedEventFence",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x20);
  *(undefined ***)this = &PTR__MetaClass_00072760;
  return;
}



// IOSurfaceMTLSharedEventFence::MetaClass::alloc() const

OSObject * IOSurfaceMTLSharedEventFence::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOSurfaceMTLSharedEventFence_ktv,0x20);
  OSObject::OSObject(this,(OSMetaClass *)&IOSurfaceMTLSharedEventFence::gMetaClass);
  *(undefined ***)this = &PTR__IOSurfaceMTLSharedEventFence_00072628;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOSurfaceMTLSharedEventFence::operator new(unsigned long)

void * __thiscall IOSurfaceMTLSharedEventFence::operator_new(IOSurfaceMTLSharedEventFence *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOSurfaceMTLSharedEventFence_ktv,this);
  return pvVar1;
}



// IOSurfaceMTLSharedEventFence::IOSurfaceMTLSharedEventFence()

void __thiscall
IOSurfaceMTLSharedEventFence::IOSurfaceMTLSharedEventFence(IOSurfaceMTLSharedEventFence *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOSurfaceMTLSharedEventFence_00072628;
  OSMetaClass::instanceConstructed();
  return;
}



// IOSurfaceMTLSharedEventFence::IOSurfaceMTLSharedEventFence()

void __thiscall
IOSurfaceMTLSharedEventFence::IOSurfaceMTLSharedEventFence(IOSurfaceMTLSharedEventFence *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOSurfaceMTLSharedEventFence_00072628;
  OSMetaClass::instanceConstructed();
  return;
}



// IOSurfaceMTLSharedEventFence::initWithSharedEvent(IOSurfaceSharedEvent*, unsigned long long)

undefined4 __thiscall
IOSurfaceMTLSharedEventFence::initWithSharedEvent
          (IOSurfaceMTLSharedEventFence *this,long *param_1,undefined8 param_2)

{
  undefined4 uVar1;
  
  uVar1 = (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  if ((char)uVar1 != '\0') {
    *(long **)(this + 0x10) = param_1;
    (**(code **)(*param_1 + 0x20))(param_1);
    *(undefined8 *)(this + 0x18) = param_2;
  }
  return uVar1;
}



// IOSurfaceMTLSharedEventFence::free()

void __thiscall IOSurfaceMTLSharedEventFence::free(IOSurfaceMTLSharedEventFence *this)

{
  if (*(long **)(this + 0x10) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x10) + 0x28))();
  }
  *(undefined8 *)(this + 0x10) = 0;
                    // WARNING: Could not recover jumptable at 0x00012672. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOSurfaceMTLSharedEventFence::notifyClient()

void __thiscall IOSurfaceMTLSharedEventFence::notifyClient(IOSurfaceMTLSharedEventFence *this)

{
  IOSurfaceSharedEvent::signalCompleted(*(ulonglong *)(this + 0x10));
  return;
}



// IOAccelSurfaceMTL::MetaClass::~MetaClass()

void __thiscall IOAccelSurfaceMTL::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOSurfaceMTLSharedEventFence::MetaClass::~MetaClass()

void __thiscall IOSurfaceMTLSharedEventFence::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelSurfaceMTL_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelSurfaceMTL::gMetaClass,"IOAccelSurfaceMTL",
             (OSMetaClass *)PTR_gMetaClass_0006b018,0x340);
  _gMetaClass = &PTR__MetaClass_00072168;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOSurfaceMTLSharedEventFence::gMetaClass,"IOSurfaceMTLSharedEventFence"
             ,(OSMetaClass *)PTR_gMetaClass_0006b068,0x20);
  IOSurfaceMTLSharedEventFence::gMetaClass = &PTR__MetaClass_00072760;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOSurfaceMTLSharedEventFence::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelSurfaceMTL::gMetaClass);
  return;
}



// IOAccelDrawable2::MetaClass::MetaClass()

void __thiscall IOAccelDrawable2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDrawable2",(OSMetaClass *)PTR_gMetaClass_0006b068,0x208);
  *(undefined ***)this = &PTR__MetaClass_000729b8;
  return;
}



// IOAccelDrawable2::MetaClass::~MetaClass()

void __thiscall IOAccelDrawable2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelDrawable2::IOAccelDrawable2(OSMetaClass const*)

void __thiscall IOAccelDrawable2::IOAccelDrawable2(IOAccelDrawable2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDrawable2_00072858;
  return;
}



// IOAccelDrawable2::IOAccelDrawable2(OSMetaClass const*)

void __thiscall IOAccelDrawable2::IOAccelDrawable2(IOAccelDrawable2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDrawable2_00072858;
  return;
}



// IOAccelDrawable2::~IOAccelDrawable2()

void __thiscall IOAccelDrawable2::~IOAccelDrawable2(IOAccelDrawable2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelDrawable2::~IOAccelDrawable2()

void __thiscall IOAccelDrawable2::~IOAccelDrawable2(IOAccelDrawable2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelDrawable2::~IOAccelDrawable2()

void __thiscall IOAccelDrawable2::~IOAccelDrawable2(IOAccelDrawable2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelDrawable2_ktv,this,0x208);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDrawable2::operator delete(void*, unsigned long)

void __cdecl IOAccelDrawable2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelDrawable2_ktv,param_1,param_2);
  return;
}



// IOAccelDrawable2::getMetaClass() const

undefined1 * IOAccelDrawable2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelDrawable2::MetaClass::MetaClass()

void __thiscall IOAccelDrawable2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDrawable2",(OSMetaClass *)PTR_gMetaClass_0006b068,0x208);
  *(undefined ***)this = &PTR__MetaClass_000729b8;
  return;
}



// IOAccelDrawable2::MetaClass::alloc() const

OSObject * IOAccelDrawable2::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelDrawable2_ktv,0x208);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelDrawable2::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDrawable2_00072858;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelDrawable2::operator new(unsigned long)

void * __thiscall IOAccelDrawable2::operator_new(IOAccelDrawable2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelDrawable2_ktv,this);
  return pvVar1;
}



// IOAccelDrawable2::IOAccelDrawable2()

void __thiscall IOAccelDrawable2::IOAccelDrawable2(IOAccelDrawable2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDrawable2_00072858;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDrawable2::IOAccelDrawable2()

void __thiscall IOAccelDrawable2::IOAccelDrawable2(IOAccelDrawable2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDrawable2_00072858;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDrawable2::init(IOGraphicsAccelerator2*, IOAccelSurface*, IOAccelShared2*, bool)

undefined8 __thiscall
IOAccelDrawable2::init
          (IOAccelDrawable2 *this,undefined8 param_2,long param_3,undefined8 param_4,
          IOAccelDrawable2 param_5)

{
  undefined8 *puVar1;
  long lVar2;
  
  *(undefined8 *)(this + 0x10) = param_2;
  *(long *)(this + 0x20) = param_3;
  *(undefined8 *)(this + 0x18) = param_4;
  this[0x204] = param_5;
  *(undefined4 *)(this + 0x140) = 0;
  if (param_3 != 0) {
    *(undefined8 *)(this + 0x130) = 0;
    puVar1 = *(undefined8 **)(&DAT_00001020 + param_3);
    *(undefined8 **)(this + 0x138) = puVar1;
    *puVar1 = this;
    *(IOAccelDrawable2 **)(&DAT_00001020 + *(long *)(this + 0x20)) = this + 0x130;
  }
  lVar2 = -0x20;
  do {
    *(undefined8 *)(this + lVar2 * 8 + 0x128) = 0;
    *(undefined4 *)(this + lVar2 * 4 + 0x1c4) = 0xffffffff;
    this[lVar2 + 0x1e4] = (IOAccelDrawable2)0xff;
    this[lVar2 + 0x204] = (IOAccelDrawable2)0xff;
    lVar2 = lVar2 + 1;
  } while (lVar2 != 0);
  return 1;
}



// IOAccelDrawable2::free()

void __thiscall IOAccelDrawable2::free(IOAccelDrawable2 *this)

{
  long lVar1;
  long *plVar2;
  char *pcVar3;
  
  remove_buffers(this);
  if (*(long *)(this + 0x20) == 0) goto LAB_000129dd;
  lVar1 = *(long *)(this + 0x130);
  if (lVar1 == 0) {
    plVar2 = *(long **)(this + 0x138);
    if ((IOAccelDrawable2 *)*plVar2 != this) {
LAB_000129f3:
      pcVar3 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_00012a03:
                    // WARNING: Subroutine does not return
      _panic(pcVar3,this,0x46,"IOAccelDrawable.cpp",0x46);
    }
    *(long **)(&DAT_00001020 + *(long *)(this + 0x20)) = plVar2;
  }
  else {
    if (*(IOAccelDrawable2 **)(lVar1 + 0x138) != this + 0x130) {
      pcVar3 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
      goto LAB_00012a03;
    }
    if ((IOAccelDrawable2 *)**(long **)(this + 0x138) != this) goto LAB_000129f3;
    *(long **)(lVar1 + 0x138) = *(long **)(this + 0x138);
    plVar2 = *(long **)(this + 0x138);
  }
  *plVar2 = lVar1;
LAB_000129dd:
                    // WARNING: Could not recover jumptable at 0x000129ed. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelDrawable2::remove_buffers()

void __thiscall IOAccelDrawable2::remove_buffers(IOAccelDrawable2 *this)

{
  byte bVar1;
  long lVar2;
  
  lVar2 = 0;
  do {
    if (*(long **)(this + lVar2 * 8 + 0x28) != (long *)0x0) {
      IOAccelResource2::clientRelease(*(long **)(this + lVar2 * 8 + 0x28));
      (**(code **)(**(long **)(this + lVar2 * 8 + 0x28) + 0x28))();
      bVar1 = (byte)lVar2 & 0x1f;
      *(undefined8 *)(this + lVar2 * 8 + 0x28) = 0;
      *(uint *)(this + 0x140) =
           *(uint *)(this + 0x140) & (-2 << bVar1 | 0xfffffffeU >> 0x20 - bVar1);
    }
    lVar2 = lVar2 + 1;
  } while (lVar2 != 0x20);
  return;
}



// IOAccelDrawable2::checkDirty()

bool __thiscall IOAccelDrawable2::checkDirty(IOAccelDrawable2 *this)

{
  ulong uVar1;
  ulong uVar2;
  uint uVar3;
  uint uVar4;
  bool bVar5;
  
  uVar4 = *(uint *)(this + 0x140);
  if (uVar4 == 0) {
    uVar3 = 0;
  }
  else {
    uVar3 = 0;
    uVar2 = 0;
    do {
      if (((uVar4 & 1) != 0) &&
         (*(IOAccelResource2 **)(this + uVar2 * 8 + 0x28) != (IOAccelResource2 *)0x0)) {
        uVar1 = IOAccelResource2::checkDirty(*(IOAccelResource2 **)(this + uVar2 * 8 + 0x28));
        uVar3 = uVar3 | (uint)uVar1 & 0xff;
      }
      if (uVar4 < 2) break;
      uVar4 = uVar4 >> 1;
      bVar5 = uVar2 < 0x1f;
      uVar2 = uVar2 + 1;
    } while (bVar5);
  }
  return uVar3 != 0;
}



// IOAccelDrawable2::dirtyLevel()

void __thiscall IOAccelDrawable2::dirtyLevel(IOAccelDrawable2 *this)

{
  long *plVar1;
  uint uVar2;
  ulong uVar3;
  int iVar4;
  bool bVar5;
  
  uVar2 = *(uint *)(this + 0x140);
  if (uVar2 != 0) {
    uVar3 = 0;
    do {
      if (((uVar2 & 1) != 0) &&
         (plVar1 = *(long **)(this + uVar3 * 8 + 0x28), plVar1 != (long *)0x0)) {
        if ((this[0x204] == (IOAccelDrawable2)0x0) || (*(char *)((long)plVar1 + 0xac) != '\x06')) {
          (**(code **)(*plVar1 + 0x168))
                    (plVar1,(int)(char)this[uVar3 + 0x1c4],(int)(char)this[uVar3 + 0x1e4]);
        }
        else {
          iVar4 = 0;
          do {
            (**(code **)(*plVar1 + 0x168))(plVar1,iVar4,(int)(char)this[uVar3 + 0x1e4]);
            iVar4 = iVar4 + 1;
          } while (iVar4 != 6);
        }
      }
      if (uVar2 < 2) {
        return;
      }
      uVar2 = uVar2 >> 1;
      bVar5 = uVar3 < 0x1f;
      uVar3 = uVar3 + 1;
    } while (bVar5);
  }
  return;
}



// IOAccelDrawable2::addToChannel(IOAccelChannel2*)

void __thiscall IOAccelDrawable2::addToChannel(IOAccelDrawable2 *this,undefined8 param_1)

{
  long *plVar1;
  ulong uVar2;
  uint uVar3;
  bool bVar4;
  
  uVar3 = *(uint *)(this + 0x140);
  if (uVar3 != 0) {
    uVar2 = 0;
    do {
      if (((uVar3 & 1) != 0) &&
         (plVar1 = *(long **)(this + uVar2 * 8 + 0x28), plVar1 != (long *)0x0)) {
        (**(code **)(*plVar1 + 400))(plVar1,param_1,1);
      }
      if (uVar3 < 2) {
        return;
      }
      uVar3 = uVar3 >> 1;
      bVar4 = uVar2 < 0x1f;
      uVar2 = uVar2 + 1;
    } while (bVar4);
  }
  return;
}



// IOAccelDrawable2::removeFromChannel(IOAccelChannel2*)

void __thiscall IOAccelDrawable2::removeFromChannel(IOAccelDrawable2 *this,undefined8 param_1)

{
  long *plVar1;
  ulong uVar2;
  uint uVar3;
  bool bVar4;
  
  uVar3 = *(uint *)(this + 0x140);
  if (uVar3 != 0) {
    uVar2 = 0;
    do {
      if (((uVar3 & 1) != 0) &&
         (plVar1 = *(long **)(this + uVar2 * 8 + 0x28), plVar1 != (long *)0x0)) {
        (**(code **)(*plVar1 + 0x198))(plVar1,param_1);
      }
      if (uVar3 < 2) {
        return;
      }
      uVar3 = uVar3 >> 1;
      bVar4 = uVar2 < 0x1f;
      uVar2 = uVar2 + 1;
    } while (bVar4);
  }
  return;
}



// IOAccelDrawable2::prepare()

bool __thiscall IOAccelDrawable2::prepare(IOAccelDrawable2 *this)

{
  byte bVar1;
  uint uVar2;
  char cVar3;
  uint uVar4;
  ulong uVar5;
  ulong uVar6;
  uint uVar7;
  bool bVar8;
  
  if (*(uint *)(this + 0x140) == 0) {
    bVar8 = true;
  }
  else {
    uVar7 = 0;
    uVar6 = 0;
    uVar2 = *(uint *)(this + 0x140);
    do {
      uVar4 = uVar2;
      if (((uVar4 & 1) != 0) && (*(long **)(this + uVar6 * 8 + 0x28) != (long *)0x0)) {
        cVar3 = (**(code **)(**(long **)(this + uVar6 * 8 + 0x28) + 0x170))();
        if (cVar3 == '\0') {
          bVar8 = false;
          uVar5 = uVar6 & 0xffffffff;
          goto LAB_00012cb2;
        }
        uVar7 = uVar7 | 1 << ((uint)uVar6 & 0x1f);
      }
      uVar5 = uVar6 + 1;
    } while ((1 < uVar4) && (bVar8 = uVar6 < 0x1f, uVar6 = uVar5, uVar2 = uVar4 >> 1, bVar8));
    bVar8 = uVar4 < 2;
LAB_00012cb2:
    if ((bVar8 == false) && (uVar7 != 0)) {
      uVar6 = uVar5 & 0xffffffff;
      do {
        bVar1 = (byte)(uVar6 - 1);
        if ((((uint)(1L << (bVar1 & 0x3f)) & uVar7) != 0) &&
           (*(long **)(this + uVar6 * 8 + 0x20) != (long *)0x0)) {
          (**(code **)(**(long **)(this + uVar6 * 8 + 0x20) + 0x178))();
        }
        bVar1 = bVar1 & 0x1f;
        uVar7 = uVar7 & (-2 << bVar1 | 0xfffffffeU >> 0x20 - bVar1);
        uVar6 = uVar6 - 1;
      } while (uVar7 != 0);
      bVar8 = false;
    }
  }
  return bVar8;
}



// IOAccelDrawable2::complete()

void __thiscall IOAccelDrawable2::complete(IOAccelDrawable2 *this)

{
  uint uVar1;
  ulong uVar2;
  bool bVar3;
  
  uVar1 = *(uint *)(this + 0x140);
  if (uVar1 != 0) {
    uVar2 = 0;
    do {
      if (((uVar1 & 1) != 0) && (*(long **)(this + uVar2 * 8 + 0x28) != (long *)0x0)) {
        (**(code **)(**(long **)(this + uVar2 * 8 + 0x28) + 0x178))();
      }
      if (uVar1 < 2) {
        return;
      }
      uVar1 = uVar1 >> 1;
      bVar3 = uVar2 < 0x1f;
      uVar2 = uVar2 + 1;
    } while (bVar3);
  }
  return;
}



// IOAccelDrawable2::client_release()

void __thiscall IOAccelDrawable2::client_release(IOAccelDrawable2 *this)

{
  long lVar1;
  
  lVar1 = 0;
  do {
    if (*(long **)(this + lVar1 * 8 + 0x28) != (long *)0x0) {
      IOAccelResource2::clientRelease(*(long **)(this + lVar1 * 8 + 0x28));
    }
    lVar1 = lVar1 + 1;
  } while (lVar1 != 0x20);
  return;
}



// IOAccelDrawable2::MetaClass::~MetaClass()

void __thiscall IOAccelDrawable2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelDrawable2::update()

void IOAccelDrawable2::update(void)

{
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelDrawable_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelDrawable2::gMetaClass,"IOAccelDrawable2",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x208);
  _gMetaClass = &PTR__MetaClass_000729b8;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelDrawable2::gMetaClass);
  return;
}



// IOAccelEventMachine2::MetaClass::MetaClass()

void __thiscall IOAccelEventMachine2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelEventMachine2",(OSMetaClass *)PTR_gMetaClass_0006b068,0xf0)
  ;
  *(undefined ***)this = &PTR__MetaClass_00072d68;
  return;
}



// IOAccelEventMachine2::MetaClass::~MetaClass()

void __thiscall IOAccelEventMachine2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelEventMachine2::IOAccelEventMachine2(OSMetaClass const*)

void __thiscall
IOAccelEventMachine2::IOAccelEventMachine2(IOAccelEventMachine2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelEventMachine2_00072ab0;
  return;
}



// IOAccelEventMachine2::~IOAccelEventMachine2()

void __thiscall IOAccelEventMachine2::~IOAccelEventMachine2(IOAccelEventMachine2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelEventMachine2::~IOAccelEventMachine2()

void __thiscall IOAccelEventMachine2::~IOAccelEventMachine2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelEventMachine2::~IOAccelEventMachine2()

void __thiscall IOAccelEventMachine2::~IOAccelEventMachine2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelEventMachine2::getMetaClass() const

undefined1 * IOAccelEventMachine2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelEventMachine2::MetaClass::MetaClass()

void __thiscall IOAccelEventMachine2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelEventMachine2",(OSMetaClass *)PTR_gMetaClass_0006b068,0xf0)
  ;
  *(undefined ***)this = &PTR__MetaClass_00072d68;
  return;
}



// IOAccelEventMachine2::MetaClass::alloc() const

undefined8 IOAccelEventMachine2::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelEventMachine2::operator new(unsigned long)

void * __thiscall IOAccelEventMachine2::operator_new(IOAccelEventMachine2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelEventMachine2_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelEventMachine2::operator delete(void*, unsigned long)

void __cdecl IOAccelEventMachine2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelEventMachine2_ktv,param_1,param_2);
  return;
}



// IOAccelEventMachine2::init(IOGraphicsAccelerator2*, unsigned int, int)

undefined8 __thiscall
IOAccelEventMachine2::init(IOAccelEventMachine2 *this,undefined8 param_1,int param_2,uint param_3)

{
  undefined8 uVar1;
  long lVar2;
  
  (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  *(undefined8 *)(this + 0x10) = param_1;
  *(undefined8 *)(this + 0x18) = 0;
  *(undefined8 *)(this + 0x20) = 0;
  *(undefined8 *)(this + 0x28) = 0;
  *(uint *)(this + 0x30) = param_3;
  *(undefined8 *)(this + 0x38) = 0;
  this[0x40] = (IOAccelEventMachine2)0x1;
  *(undefined8 *)(this + 0xa0) = 0;
  *(undefined8 *)(this + 0x58) = 0;
  if (param_3 - 0x81 < 0xffffff80) {
    return 0;
  }
  uVar1 = _IOMallocZeroData((ulong)param_3 << 2);
  *(undefined8 *)(this + 0x48) = uVar1;
  uVar1 = _IOLockAlloc();
  *(undefined8 *)(this + 0x50) = uVar1;
  *(undefined8 *)(this + 0x88) = 0;
  *(undefined8 *)(this + 0x68) = 0;
  *(undefined8 *)(this + 0x60) = 0;
  *(undefined4 *)(this + 0x70) = 0;
  this[0x74] = (IOAccelEventMachine2)0x0;
  *(undefined8 *)(this + 0x78) = 0;
  *(undefined8 *)(this + 0x80) = 0;
  *(undefined4 *)(this + 0x94) = 0;
  uVar1 = _IOMallocZeroData((ulong)param_3 << 2);
  *(undefined8 *)(this + 0x98) = uVar1;
  *(uint *)(this + 0x90) = param_3;
  lVar2 = IOWorkLoop::workLoop();
  *(long *)(this + 0x58) = lVar2;
  if (lVar2 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to alloc workloop\n",
                      "virtual bool IOAccelEventMachine2::init(IOGraphicsAccelerator2 *, uint32_t, int32_t)"
                     );
  }
  else {
    lVar2 = _IOLockAlloc();
    *(long *)(this + 0x88) = lVar2;
    if (lVar2 != 0) {
      if (param_2 == 0) {
LAB_00013064:
        lVar2 = IOInterruptEventSource::interruptEventSource
                          ((OSObject *)this,hardwareErrorEvent,(IOService *)0x0,0);
        *(long *)(this + 0x80) = lVar2;
        if (lVar2 != 0) {
          (**(code **)(**(long **)(this + 0x58) + 0x140))(*(long **)(this + 0x58),lVar2);
          this = *(IOAccelEventMachine2 **)(this + 0x80);
          uVar1 = 1;
          lVar2 = 0x2a;
          goto LAB_000130e4;
        }
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: failed to allocate HW error interrupt\n",
                          "virtual bool IOAccelEventMachine2::init(IOGraphicsAccelerator2 *, uint32_t, int32_t)"
                         );
      }
      else {
        *(int *)(this + 0x70) = param_2;
        lVar2 = IOTimerEventSource::timerEventSource((OSObject *)this,gpu_progress_check_timer);
        *(long *)(this + 0x60) = lVar2;
        if (lVar2 == 0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: failed to allocate HW progress timer\n",
                            "virtual bool IOAccelEventMachine2::init(IOGraphicsAccelerator2 *, uint32_t, int32_t)"
                           );
        }
        else {
          (**(code **)(**(long **)(this + 0x58) + 0x140))(*(long **)(this + 0x58),lVar2);
          (**(code **)(**(long **)(this + 0x60) + 0x150))();
          lVar2 = IOInterruptEventSource::interruptEventSource
                            ((OSObject *)this,resetHardwareProgressTimer,(IOService *)0x0,0);
          *(long *)(this + 0x78) = lVar2;
          if (lVar2 == 0) {
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                              "%s: failed to allocate HW progress check reset interrupt\n",
                              "virtual bool IOAccelEventMachine2::init(IOGraphicsAccelerator2 *, uint32_t, int32_t)"
                             );
          }
          else {
            (**(code **)(**(long **)(this + 0x58) + 0x140))(*(long **)(this + 0x58),lVar2);
            (**(code **)(**(long **)(this + 0x78) + 0x150))();
            lVar2 = IOInterruptEventSource::interruptEventSource
                              ((OSObject *)this,gpu_progress_check,(IOService *)0x0,0);
            *(long *)(this + 0x68) = lVar2;
            if (lVar2 != 0) {
              (**(code **)(**(long **)(this + 0x58) + 0x140))(*(long **)(this + 0x58),lVar2);
              (**(code **)(**(long **)(this + 0x68) + 0x150))();
              goto LAB_00013064;
            }
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                              "%s: failed to allocate HW progress interrupt\n",
                              "virtual bool IOAccelEventMachine2::init(IOGraphicsAccelerator2 *, uint32_t, int32_t)"
                             );
          }
        }
      }
    }
  }
  (**(code **)(*(long *)this + 0x268))(this);
  lVar2 = 0x12;
  uVar1 = 0;
LAB_000130e4:
  (**(code **)(*(long *)this + lVar2 * 8))(this);
  return uVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelEventMachine2::gpu_progress_check_timer(IOTimerEventSource*)

void __cdecl IOAccelEventMachine2::gpu_progress_check_timer(long param_1)

{
  _IOLockLock(*(undefined8 *)(param_1 + 0x88));
  if (*(char *)(param_1 + 0x74) != '\0') {
    (**(code **)(**(long **)(param_1 + 0x68) + 0x1d8))(*(long **)(param_1 + 0x68),0,0,0);
  }
  _IOLockUnlock(*(undefined8 *)(param_1 + 0x88));
  return;
}



// IOAccelEventMachine2::resetHardwareProgressTimer()

void __thiscall IOAccelEventMachine2::resetHardwareProgressTimer(IOAccelEventMachine2 *this)

{
  char cVar1;
  
  _IOLockLock(*(undefined8 *)(this + 0x88));
  if (*(int *)(this + 0x94) == 0) {
    cVar1 = (**(code **)(*(long *)this + 0x170))(this);
    if (cVar1 == '\0') {
      if (this[0x74] != (IOAccelEventMachine2)0x0) {
        (**(code **)(**(long **)(this + 0x60) + 0x1d0))
                  (*(long **)(this + 0x60),*(undefined4 *)(this + 0x70));
      }
    }
    else if ((this[0x74] != (IOAccelEventMachine2)0x0) && (*(long **)(this + 0x60) != (long *)0x0))
    {
      this[0x74] = (IOAccelEventMachine2)0x0;
      (**(code **)(**(long **)(this + 0x60) + 0x218))();
    }
  }
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelEventMachine2::gpu_progress_check(IOInterruptEventSource*, int)

void __cdecl IOAccelEventMachine2::gpu_progress_check(long *param_1)

{
  long lVar1;
  char cVar2;
  
  _IOLockLock(param_1[0x11]);
  lVar1 = param_1[2];
  if (((*(byte *)(lVar1 + 0xc78) & 1) != 0) || (*(int *)(lVar1 + 0xdc8) != 0)) {
    _IOLockUnlock(param_1[0x11]);
    return;
  }
  if ((*(byte *)(lVar1 + 0xc92) & 8) == 0) {
    *(undefined1 *)((long)param_1 + 0x74) = 0;
    _IOLockUnlock(param_1[0x11]);
    (**(code **)(*param_1 + 0x210))(param_1);
    IOGraphicsAccelerator2::sendAGCStatusMessage((IOGraphicsAccelerator2 *)param_1[2]);
    return;
  }
  cVar2 = *(char *)((long)param_1 + 0x74);
  _IOLockUnlock(param_1[0x11]);
  if (cVar2 != '\0') {
    cVar2 = (**(code **)(*param_1 + 0x170))(param_1);
    if (cVar2 == '\0') {
      (**(code **)(*param_1 + 0x210))(param_1);
    }
                    // WARNING: Could not recover jumptable at 0x0001331d. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*(long *)param_1[0xf] + 0x1d8))((long *)param_1[0xf],0,0,0);
    return;
  }
  return;
}



// IOAccelEventMachine2::hardwareErrorEvent()

void __thiscall IOAccelEventMachine2::hardwareErrorEvent(IOAccelEventMachine2 *this)

{
  uint uVar1;
  IOGraphicsAccelerator2 *pIVar2;
  int iVar3;
  uintptr_t arg1;
  ulong uVar4;
  long lVar5;
  
  _IOLockLock(*(undefined8 *)(this + 0x88));
  _IOLockLock(*(undefined8 *)(this + 0x50));
  if (*(int *)(this + 0x94) == 0) {
    uVar1 = *(uint *)(this + 0x30);
    if ((int)uVar1 < 1) {
      uVar4 = 0;
    }
    else {
      uVar4 = 0;
      do {
        iVar3 = *(int *)(*(long *)(this + 0x98) + uVar4 * 4);
        if (*(int *)(this + 0x94) < iVar3) {
          *(int *)(this + 0x94) = iVar3;
          *(int *)(this + 0x90) = (int)uVar4;
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11);
          goto LAB_00013440;
        }
        uVar4 = uVar4 + 1;
      } while (uVar1 != uVar4);
      uVar4 = (ulong)uVar1;
    }
  }
  else {
    uVar4 = (ulong)*(int *)(this + 0x90);
    iVar3 = *(int *)(*(long *)(this + 0x98) + uVar4 * 4);
    if (*(int *)(this + 0x94) < iVar3) {
      *(int *)(this + 0x94) = iVar3;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11);
    }
  }
LAB_00013440:
  _IOLockUnlock(*(undefined8 *)(this + 0x50));
  if ((int)uVar4 < *(int *)(this + 0x30)) {
    pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x10);
    iVar3 = _IOLockTryLock(*(undefined8 *)(pIVar2 + 0x88));
    if (iVar3 == 0) {
      if (___ktrace_kernel_enabled != 0) {
        arg1 = IORegistryEntry::getRegistryEntryID();
        _kernel_debug(0x8512001c,arg1,0,0,0,0);
      }
      _kernel_debug(0x85020094,(long)*(int *)(this + 0x90),(ulong)*(uint *)(this + 0x94),0,0,0);
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: GPURestartDeferred stampIdx=%d type=%d\n",
                        "void IOAccelEventMachine2::hardwareErrorEvent()",
                        *(undefined4 *)(this + 0x90),*(undefined4 *)(this + 0x94));
      if (0 < *(int *)(this + 0x30)) {
        lVar5 = 0;
        do {
          _thread_wakeup_prim(*(undefined8 *)(*(long *)(this + 0x28) + lVar5 * 8),0,0);
          lVar5 = lVar5 + 1;
        } while (lVar5 < *(int *)(this + 0x30));
      }
      _IOLockUnlock(*(undefined8 *)(this + 0x88));
      _IOSleep(10);
                    // WARNING: Could not recover jumptable at 0x00013629. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(**(long **)(this + 0x80) + 0x1d8))(*(long **)(this + 0x80),0,0,0);
      return;
    }
    IOGraphicsAccelerator2::lock_busy(pIVar2);
    (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
    _kernel_debug(0x85020090,(long)*(int *)(this + 0x90),(ulong)*(uint *)(this + 0x94),
                  0xffffffffffffffff,0xffffffffffffffff,0);
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: GPURestartDequeued stampIdx=%d type=%d\n",
                      "void IOAccelEventMachine2::hardwareErrorEvent()",*(undefined4 *)(this + 0x90)
                      ,*(undefined4 *)(this + 0x94));
    restart_channel(this);
    pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x10);
    (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar2);
    _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
  }
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  return;
}



// IOAccelEventMachine2::stop()

void __thiscall IOAccelEventMachine2::stop(IOAccelEventMachine2 *this)

{
  if (*(_func_int **)(this + 0x58) != (_func_int *)0x0) {
    IOWorkLoop::runActionBlock(*(_func_int **)(this + 0x58));
    (**(code **)(**(long **)(this + 0x58) + 0x28))();
    *(undefined8 *)(this + 0x58) = 0;
  }
  return;
}



undefined8 ____ZN20IOAccelEventMachine24stopEv_block_invoke(long param_1)

{
  long lVar1;
  
  lVar1 = *(long *)(param_1 + 0x20);
  if (*(long *)(lVar1 + 0x60) != 0) {
    (**(code **)(**(long **)(lVar1 + 0x58) + 0x148))();
    (**(code **)(**(long **)(lVar1 + 0x60) + 0x28))();
    *(undefined8 *)(lVar1 + 0x60) = 0;
    if (*(long *)(lVar1 + 0x78) != 0) {
      (**(code **)(**(long **)(lVar1 + 0x58) + 0x148))();
      (**(code **)(**(long **)(lVar1 + 0x78) + 0x28))();
      *(undefined8 *)(lVar1 + 0x78) = 0;
    }
    if (*(long *)(lVar1 + 0x68) != 0) {
      (**(code **)(**(long **)(lVar1 + 0x58) + 0x148))();
      (**(code **)(**(long **)(lVar1 + 0x68) + 0x28))();
      *(undefined8 *)(lVar1 + 0x68) = 0;
    }
  }
  return 0;
}



// IOAccelEventMachine2::free()

void __thiscall IOAccelEventMachine2::free(IOAccelEventMachine2 *this)

{
  IOAccelEventMachine2 *pIVar1;
  long lVar2;
  long lVar3;
  
  if (*(long *)(this + 0x88) != 0) {
    _IOLockFree();
    *(undefined8 *)(this + 0x88) = 0;
  }
  _IOLockFree(*(undefined8 *)(this + 0x50));
  lVar2 = *(long *)(this + 0x48);
  if (lVar2 != 0) {
    lVar3 = (long)*(int *)(this + 0x30) * 4;
    *(undefined8 *)(this + 0x48) = 0;
    if ((long)*(int *)(this + 0x30) < 0) {
      lVar3 = -0x8000000000000000;
    }
    _IOFreeData(lVar2,lVar3);
    *(undefined8 *)(this + 0x48) = 0;
  }
  lVar2 = *(long *)(this + 0x98);
  if (lVar2 != 0) {
    lVar3 = (long)*(int *)(this + 0x30) * 4;
    *(undefined8 *)(this + 0x98) = 0;
    if ((long)*(int *)(this + 0x30) < 0) {
      lVar3 = -0x8000000000000000;
    }
    _IOFreeData(lVar2,lVar3);
    *(undefined8 *)(this + 0x98) = 0;
  }
  *(undefined8 *)(this + 0x10) = 0;
  *(undefined8 *)(this + 0x18) = 0;
  pIVar1 = *(IOAccelEventMachine2 **)(this + 0x28);
  if ((pIVar1 != (IOAccelEventMachine2 *)0x0) && (pIVar1 != this + 0x20)) {
    lVar2 = (long)*(int *)(this + 0x30) * 8;
    if ((long)*(int *)(this + 0x30) < 0) {
      lVar2 = -0x8000000000000000;
    }
    *(undefined8 *)(this + 0x28) = 0;
    _IOFreeTypeVarImpl(&free()::kalloc_type_view_210,pIVar1,lVar2);
  }
  *(undefined4 *)(this + 0x30) = 0;
                    // WARNING: Could not recover jumptable at 0x00013815. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelEventMachine2::getStampOffset(int)

int __thiscall IOAccelEventMachine2::getStampOffset(undefined8 param_1_00,int param_2)

{
  return param_2 * 4;
}



// IOAccelEventMachine2::setStampBaseAddress(unsigned int volatile*)

void __thiscall
IOAccelEventMachine2::setStampBaseAddress(IOAccelEventMachine2 *this,undefined8 param_1)

{
  int iVar1;
  uint uVar2;
  undefined8 uVar3;
  long lVar4;
  ulong uVar5;
  
  *(undefined8 *)(this + 0x20) = param_1;
  iVar1 = *(int *)(this + 0x30);
  if ((long)iVar1 == 1) {
    *(IOAccelEventMachine2 **)(this + 0x28) = this + 0x20;
  }
  else {
    lVar4 = -0x8000000000000000;
    if (-1 < iVar1) {
      lVar4 = (long)iVar1 << 3;
    }
    uVar3 = _IOMallocTypeVarImpl(&setStampBaseAddress(unsigned_int*)::kalloc_type_view_232,lVar4);
    *(undefined8 *)(this + 0x28) = uVar3;
    if (*(int *)(this + 0x30) < 1) {
      return;
    }
  }
  uVar5 = 0;
  do {
    lVar4 = *(long *)(this + 0x20);
    uVar2 = (**(code **)(*(long *)this + 0x138))(this,uVar5 & 0xffffffff);
    *(ulong *)(*(long *)(this + 0x28) + uVar5 * 8) = (ulong)uVar2 + lVar4;
    uVar5 = uVar5 + 1;
  } while ((long)uVar5 < (long)*(int *)(this + 0x30));
  return;
}



// IOAccelEventMachine2::getNumStamps()

undefined4 __thiscall IOAccelEventMachine2::getNumStamps(IOAccelEventMachine2 *this)

{
  return *(undefined4 *)(this + 0x30);
}



// IOAccelEventMachine2::waitForStamp(int, unsigned int, unsigned int*)

undefined8 __thiscall
IOAccelEventMachine2::waitForStamp
          (IOAccelEventMachine2 *this,int param_1,undefined8 param_3_00,int *param_3)

{
  int iVar1;
  int *piVar2;
  long lVar3;
  int iVar4;
  int iVar5;
  long lVar6;
  int iVar7;
  undefined8 local_48;
  ulong local_40;
  int local_38;
  int local_34;
  
  local_48 = 0;
  if (*(int *)(*(long *)(this + 0x10) + 0xdc8) == 0) {
    lVar6 = (long)param_1;
    piVar2 = *(int **)(*(long *)(this + 0x28) + lVar6 * 8);
    _IOLockLock(*(undefined8 *)(this + 0x50));
    iVar5 = *(int *)(*(long *)(this + 0x48) + lVar6 * 4);
    *(int *)(*(long *)(this + 0x48) + lVar6 * 4) = iVar5 + 1;
    if (iVar5 == 0) {
      (**(code **)(*(long *)this + 0x240))(this,param_1);
    }
    local_34 = param_1;
    _IOLockUnlock(*(undefined8 *)(this + 0x50));
    lVar3 = *(long *)(this + 0x10);
    iVar5 = (int)param_3_00;
    if ((*(byte *)(lVar3 + 0xc9c) & 1) == 0) {
      if (*(int *)(lVar3 + 0xdc8) == 0) {
        iVar7 = *piVar2 + -1;
        local_40 = 1;
        local_38 = 1;
        do {
          if (iVar7 != *piVar2) {
            iVar7 = *piVar2;
            _clock_interval_to_deadline(local_38,1000000000,&local_48);
          }
          iVar4 = _assert_wait_deadline(piVar2,0,local_48);
          iVar1 = *piVar2;
          *param_3 = iVar1;
          if (iVar5 - iVar1 < 1) {
            _thread_wakeup_prim(piVar2,0,0);
            break;
          }
          if (iVar4 == -1) {
            iVar4 = _thread_block(0);
          }
          if (*(int *)(this + 0x94) != 0) {
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                              "%s: a graphics error occurred, fRestartType = <%d>, exiting..\n",
                              "virtual IOReturn IOAccelEventMachine2::waitForStamp(int32_t, stamp_t, stamp_t *)"
                              ,*(undefined4 *)(this + 0x94));
            _IOLockLock(*(undefined8 *)(this + 0x50));
            iVar5 = *(int *)(*(long *)(this + 0x48) + lVar6 * 4);
            *(int *)(*(long *)(this + 0x48) + lVar6 * 4) = iVar5 + -1;
            if (iVar5 == 1) {
              (**(code **)(*(long *)this + 0x248))(this,local_34);
            }
            _IOLockUnlock(*(undefined8 *)(this + 0x50));
            return 0xe00002e9;
          }
          if (iVar4 == 1) {
            iVar1 = *piVar2;
            if ((int)local_40 != 1) {
              *param_3 = iVar1;
              if (0 < iVar5 - iVar1) {
                __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                  "%s: timeout waiting for %s stamp %u (gpu_stamp=%u)\n",
                                  "virtual IOReturn IOAccelEventMachine2::waitForStamp(int32_t, stamp_t, stamp_t *)"
                                  ,*(undefined8 *)(*(long *)(this + 0x10) + 0xc88),param_3_00,iVar1)
                ;
                disable_stamp_interrupt(this,local_34);
                return 0xe00002d6;
              }
              break;
            }
            local_40 = 1;
            if (iVar7 == iVar1) {
              local_40 = (ulong)*(uint *)(*(long *)(this + 0x10) + 0xcf0);
              local_38 = *(uint *)(*(long *)(this + 0x10) + 0xcf0) - 1;
              _clock_interval_to_deadline(local_38,1000000000,&local_48);
              __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                "%s: initial wait for %d second expired. Continue wait for %d seconds. stamp %u (gpu_stamp=%u)\n"
                                ,
                                "virtual IOReturn IOAccelEventMachine2::waitForStamp(int32_t, stamp_t, stamp_t *)"
                                ,1,*(int *)(*(long *)(this + 0x10) + 0xcf0) + -1,param_3_00,*param_3
                               );
            }
          }
          else if ((iVar4 == 0) && (iVar1 = *piVar2, *param_3 = iVar1, iVar5 - iVar1 < 1)) break;
        } while (*(int *)(*(long *)(this + 0x10) + 0xdc8) == 0);
      }
    }
    else {
      do {
        iVar7 = *piVar2;
        *param_3 = iVar7;
        if (iVar5 - iVar7 < 1) break;
      } while (*(int *)(lVar3 + 0xdc8) == 0);
    }
    _IOLockLock(*(undefined8 *)(this + 0x50));
    iVar5 = *(int *)(*(long *)(this + 0x48) + lVar6 * 4);
    *(int *)(*(long *)(this + 0x48) + lVar6 * 4) = iVar5 + -1;
    if (iVar5 == 1) {
      (**(code **)(*(long *)this + 0x248))(this,local_34);
    }
    _IOLockUnlock(*(undefined8 *)(this + 0x50));
  }
  return 0;
}



// IOAccelEventMachine2::disable_stamp_interrupt(int)

void __thiscall
IOAccelEventMachine2::disable_stamp_interrupt(IOAccelEventMachine2 *this,int param_1)

{
  int iVar1;
  
  _IOLockLock(*(undefined8 *)(this + 0x50));
  iVar1 = *(int *)(*(long *)(this + 0x48) + (long)param_1 * 4);
  *(int *)(*(long *)(this + 0x48) + (long)param_1 * 4) = iVar1 + -1;
  if (iVar1 == 1) {
    (**(code **)(*(long *)this + 0x248))(this,param_1);
  }
  _IOLockUnlock(*(undefined8 *)(this + 0x50));
  return;
}



// IOAccelEventMachine2::handleFinishChannelRestart(int, int, unsigned int)

void __thiscall
IOAccelEventMachine2::handleFinishChannelRestart
          (IOAccelEventMachine2 *this,int param_1,int param_2,uint param_3)

{
  char cVar1;
  
  cVar1 = IOAccelDisplayMachine::waitForStampTimeout
                    (*(IOAccelDisplayMachine **)(*(long *)(this + 0x10) + 0x378),param_2);
  if (cVar1 != '\0') {
    return;
  }
  _IOLockLock(*(undefined8 *)(this + 0x88));
  if (param_1 != -0x1ffffd17) {
    *(undefined4 *)(this + 0x94) = 4;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s - Setting restart type to %d\n",
                      "void IOAccelEventMachine2::handleFinishChannelRestart(IOReturn, int32_t, uint32_t)"
                     );
    *(int *)(this + 0x90) = param_2;
  }
  _kernel_debug(0x85020090,(long)*(int *)(this + 0x90),(ulong)*(uint *)(this + 0x94),(ulong)param_3,
                (long)param_2,0);
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                    "%s: GPURestartDequeued stampIdx=%d type=%d fromWhere=%d waitingOnIdx=%d\n",
                    "void IOAccelEventMachine2::handleFinishChannelRestart(IOReturn, int32_t, uint32_t)"
                    ,*(undefined4 *)(this + 0x90),*(undefined4 *)(this + 0x94),(ulong)param_3,
                    param_2);
  restart_channel(this);
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  return;
}



// IOAccelEventMachine2::restart_channel()

void __thiscall IOAccelEventMachine2::restart_channel(IOAccelEventMachine2 *this)

{
  undefined *puVar1;
  char cVar2;
  undefined8 in_RAX;
  long *plVar3;
  undefined4 uVar4;
  
  uVar4 = (undefined4)((ulong)in_RAX >> 0x20);
  if (*(int *)(this + 0x94) == 2) {
    cVar2 = (**(code **)(*(long *)this + 0x218))(this,*(undefined4 *)(this + 0x90));
    if (cVar2 != '\0') goto LAB_00013f56;
  }
  if ((this[0x74] != (IOAccelEventMachine2)0x0) && (*(long **)(this + 0x60) != (long *)0x0)) {
    this[0x74] = (IOAccelEventMachine2)0x0;
    (**(code **)(**(long **)(this + 0x60) + 0x218))();
  }
  IOGraphicsAccelerator2::appendLog(*(IOGraphicsAccelerator2 **)(this + 0x10),0x33);
  plVar3 = (long *)(**(code **)(*(long *)this + 0x220))(this,*(undefined4 *)(this + 0x90));
  if (plVar3 == (long *)0x0) {
    _kernel_debug(0x85020098,(long)*(int *)(this + 0x90),(ulong)*(uint *)(this + 0x94),0,0,0);
    puVar1 = PTR___os_log_default_0006b0b8;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: GPURestartSkipped stampIdx=%d type=%d\n",
                      "void IOAccelEventMachine2::restart_channel()",*(undefined4 *)(this + 0x90),
                      CONCAT44(uVar4,*(undefined4 *)(this + 0x94)));
    __os_log_internal(0,puVar1,0x11,"%s: no channel associated with stamp_idx %d (type %d)\n",
                      "void IOAccelEventMachine2::restart_channel()",*(undefined4 *)(this + 0x90),
                      *(undefined4 *)(this + 0x94));
  }
  else {
    _kernel_debug(0x8502009c,(long)*(int *)(this + 0x90),(ulong)*(uint *)(this + 0x94),0,0,0);
    puVar1 = PTR___os_log_default_0006b0b8;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11);
    (**(code **)(*plVar3 + 0x160))(plVar3);
    _kernel_debug(0x850200a0,(long)*(int *)(this + 0x90),(ulong)*(uint *)(this + 0x94),0,0,0);
    __os_log_internal(0,puVar1,0x11,"%s: GPURestartEnd stampIdx=%d type=%d\n",
                      "void IOAccelEventMachine2::restart_channel()",*(undefined4 *)(this + 0x90),
                      CONCAT44(uVar4,*(undefined4 *)(this + 0x94)));
  }
  IOGraphicsAccelerator2::appendLog(*(IOGraphicsAccelerator2 **)(this + 0x10),0x33);
  if ((this[0x74] == (IOAccelEventMachine2)0x0) &&
     (plVar3 = *(long **)(this + 0x60), plVar3 != (long *)0x0)) {
    this[0x74] = (IOAccelEventMachine2)0x1;
    (**(code **)(*plVar3 + 0x1d0))(plVar3,*(undefined4 *)(this + 0x70));
  }
LAB_00013f56:
  _IOLockLock(*(undefined8 *)(this + 0x50));
  *(undefined4 *)(*(long *)(this + 0x98) + (long)*(int *)(this + 0x90) * 4) = 0;
  *(undefined4 *)(this + 0x94) = 0;
  *(undefined4 *)(this + 0x90) = *(undefined4 *)(this + 0x30);
  _IOLockUnlock(*(undefined8 *)(this + 0x50));
                    // WARNING: Could not recover jumptable at 0x00013faf. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0x80) + 0x1d8))(*(long **)(this + 0x80),0,0,0);
  return;
}



// IOAccelEventMachine2::signalStamp(int, unsigned int)

void __thiscall
IOAccelEventMachine2::signalStamp(IOAccelEventMachine2 *this,int param_1,uint param_2)

{
  uintptr_t arg3;
  
  _thread_wakeup_prim(*(undefined8 *)(*(long *)(this + 0x28) + (long)param_1 * 8),0,0);
  _thread_wakeup_prim(this,0,0);
  if (*(IOAccelDisplayMachine **)(this + 0xa8) != (IOAccelDisplayMachine *)0x0) {
    IOAccelDisplayMachine::signalEventInterrupt(*(IOAccelDisplayMachine **)(this + 0xa8));
  }
  if ((*(byte *)(*(long *)(this + 0x10) + 0xc92) & 8) != 0) {
    (**(code **)(**(long **)(this + 0x78) + 0x1d8))(*(long **)(this + 0x78),0,0,0);
  }
  if (___ktrace_kernel_enabled != 0) {
    arg3 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x8512000c,(long)param_1,(ulong)param_2,arg3,0,0);
    return;
  }
  return;
}



// IOAccelEventMachine2::signalAllStamps()

void __thiscall IOAccelEventMachine2::signalAllStamps(IOAccelEventMachine2 *this)

{
  int iVar1;
  ulong uVar2;
  
  if (*(long *)(this + 0x28) != 0) {
    iVar1 = *(int *)(this + 0x30);
    if (0 < iVar1) {
      uVar2 = 0;
      do {
        if (*(long *)(*(long *)(this + 0x28) + uVar2 * 8) != 0) {
          (**(code **)(*(long *)this + 0x228))(this,uVar2 & 0xffffffff,0);
          iVar1 = *(int *)(this + 0x30);
        }
        uVar2 = uVar2 + 1;
      } while ((long)uVar2 < (long)iVar1);
    }
  }
  return;
}



// IOAccelEventMachine2::deviceTerminatedUnlocked()

void __thiscall IOAccelEventMachine2::deviceTerminatedUnlocked(IOAccelEventMachine2 *this)

{
  signalAllStamps(this);
  return;
}



// IOAccelEventMachine2::setDisplayMachineInterrupt(IOAccelDisplayMachine*)

void __thiscall
IOAccelEventMachine2::setDisplayMachineInterrupt(IOAccelEventMachine2 *this,long param_1)

{
  if (param_1 == 0) {
    if (*(long *)(this + 0xa8) == 0) {
      return;
    }
    param_1 = 0;
  }
  else if (*(long *)(this + 0xa8) != 0) {
    return;
  }
  *(long *)(this + 0xa8) = param_1;
  return;
}



// IOAccelEventMachine2::signalHardwareError(eRestartRequest, int)

void __thiscall
IOAccelEventMachine2::signalHardwareError(IOAccelEventMachine2 *this,uint param_1,int param_2)

{
  ulong arg2;
  uintptr_t arg1;
  
  arg2 = (ulong)param_1;
  _IOLockLock(*(undefined8 *)(this + 0x50));
  arg1 = (uintptr_t)param_2;
  _kernel_debug(0x85020088,arg1,arg2,(ulong)*(uint *)(*(long *)(this + 0x98) + arg1 * 4),
                (long)*(int *)(this + 0x30),0);
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11);
  if (*(int *)(*(long *)(this + 0x98) + arg1 * 4) < (int)param_1) {
    *(uint *)(*(long *)(this + 0x98) + arg1 * 4) = param_1;
    (**(code **)(**(long **)(this + 0x80) + 0x1d8))(*(long **)(this + 0x80),0,0);
    _kernel_debug(0x8502008c,arg1,arg2,0,0,0);
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: GPURestartEnqueued stampIdx=%d type=%d\n",
                      "void IOAccelEventMachine2::signalHardwareError(eRestartRequest, int32_t)",
                      param_2,arg2);
  }
  _IOLockUnlock(*(undefined8 *)(this + 0x50));
  return;
}



// IOAccelEventMachine2::stopHardwareProgressTimerUnlocked()

void __thiscall IOAccelEventMachine2::stopHardwareProgressTimerUnlocked(IOAccelEventMachine2 *this)

{
  long *plVar1;
  
  if ((this[0x74] != (IOAccelEventMachine2)0x0) &&
     (plVar1 = *(long **)(this + 0x60), plVar1 != (long *)0x0)) {
    this[0x74] = (IOAccelEventMachine2)0x0;
                    // WARNING: Could not recover jumptable at 0x00014206. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*plVar1 + 0x218))(plVar1);
    return;
  }
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelEventMachine2::startHardwareProgressTimerUnlocked()

void __cdecl
IOAccelEventMachine2::startHardwareProgressTimerUnlocked
          (long param_1,undefined8 param_2,undefined8 param_3)

{
  long *plVar1;
  
  if ((*(char *)(param_1 + 0x74) == '\0') &&
     (plVar1 = *(long **)(param_1 + 0x60), plVar1 != (long *)0x0)) {
    *(undefined1 *)(param_1 + 0x74) = 1;
                    // WARNING: Could not recover jumptable at 0x00014238. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*plVar1 + 0x1d0))
              (plVar1,*(undefined4 *)(param_1 + 0x70),param_3,*(code **)(*plVar1 + 0x1d0));
    return;
  }
  return;
}



// IOAccelEventMachine2::startHardwareProgressTimer()

void __thiscall IOAccelEventMachine2::startHardwareProgressTimer(IOAccelEventMachine2 *this)

{
  long *plVar1;
  
  _IOLockLock(*(undefined8 *)(this + 0x88));
  if ((this[0x74] == (IOAccelEventMachine2)0x0) &&
     (plVar1 = *(long **)(this + 0x60), plVar1 != (long *)0x0)) {
    this[0x74] = (IOAccelEventMachine2)0x1;
    (**(code **)(*plVar1 + 0x1d0))(plVar1,*(undefined4 *)(this + 0x70));
  }
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  return;
}



// IOAccelEventMachine2::stopHardwareProgressTimer()

void __thiscall IOAccelEventMachine2::stopHardwareProgressTimer(IOAccelEventMachine2 *this)

{
  _IOLockLock(*(undefined8 *)(this + 0x88));
  if ((this[0x74] != (IOAccelEventMachine2)0x0) && (*(long **)(this + 0x60) != (long *)0x0)) {
    this[0x74] = (IOAccelEventMachine2)0x0;
    (**(code **)(**(long **)(this + 0x60) + 0x218))();
  }
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  return;
}



// IOAccelEventMachine2::enableStampInterrupt(int)

void IOAccelEventMachine2::enableStampInterrupt(void)

{
  return;
}



// IOAccelEventMachine2::disableStampInterrupt(int)

void IOAccelEventMachine2::disableStampInterrupt(void)

{
  return;
}



// IOAccelEventMachine2::_RESERVEDIOAccelEventMachine2()

void IOAccelEventMachine2::_RESERVEDIOAccelEventMachine2(void)

{
  OSMetaClass::reservedCalled(0x82160);
  return;
}



// IOAccelEventMachine2::_RESERVEDIOAccelEventMachine3()

void IOAccelEventMachine2::_RESERVEDIOAccelEventMachine3(void)

{
  OSMetaClass::reservedCalled(0x82160);
  return;
}



// IOAccelEventMachine2::_RESERVEDIOAccelEventMachine4()

void IOAccelEventMachine2::_RESERVEDIOAccelEventMachine4(void)

{
  OSMetaClass::reservedCalled(0x82160);
  return;
}



// IOAccelEventMachine2::_RESERVEDIOAccelEventMachine5()

void IOAccelEventMachine2::_RESERVEDIOAccelEventMachine5(void)

{
  OSMetaClass::reservedCalled(0x82160);
  return;
}



// IOAccelEventMachine2::collectAllLiveEventIfNeeded()

void IOAccelEventMachine2::collectAllLiveEventIfNeeded(void)

{
  return;
}



// IOAccelEventMachine2::MetaClass::~MetaClass()

void __thiscall IOAccelEventMachine2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelEventMachine_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelEventMachine2::gMetaClass,"IOAccelEventMachine2",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0xf0);
  _gMetaClass = &PTR__MetaClass_00072d68;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelEventMachine2::gMetaClass);
  return;
}



// IOAccelLegacySurface::MetaClass::MetaClass()

void __thiscall IOAccelLegacySurface::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelLegacySurface",(OSMetaClass *)&IOAccelSurface::gMetaClass,
             0x13b0);
  *(undefined ***)this = &PTR__MetaClass_00073908;
  return;
}



// IOAccelLegacySurface::MetaClass::~MetaClass()

void __thiscall IOAccelLegacySurface::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelLegacySurface::IOAccelLegacySurface(OSMetaClass const*)

void __thiscall
IOAccelLegacySurface::IOAccelLegacySurface(IOAccelLegacySurface *this,OSMetaClass *param_1)

{
  IOAccelSurface::IOAccelSurface((IOAccelSurface *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelLegacySurface_00072e80;
  return;
}



// IOAccelLegacySurface::~IOAccelLegacySurface()

void __thiscall IOAccelLegacySurface::~IOAccelLegacySurface(IOAccelLegacySurface *this)

{
  IOAccelSurface::~IOAccelSurface((IOAccelSurface *)this);
  return;
}



// IOAccelLegacySurface::~IOAccelLegacySurface()

void __thiscall IOAccelLegacySurface::~IOAccelLegacySurface(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelLegacySurface::~IOAccelLegacySurface()

void __thiscall IOAccelLegacySurface::~IOAccelLegacySurface(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelLegacySurface::getMetaClass() const

undefined1 * IOAccelLegacySurface::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelLegacySurface::MetaClass::MetaClass()

void __thiscall IOAccelLegacySurface::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelLegacySurface",(OSMetaClass *)&IOAccelSurface::gMetaClass,
             0x13b0);
  *(undefined ***)this = &PTR__MetaClass_00073908;
  return;
}



// IOAccelLegacySurface::MetaClass::alloc() const

undefined8 IOAccelLegacySurface::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelLegacySurface::operator new(unsigned long)

void * __thiscall IOAccelLegacySurface::operator_new(IOAccelLegacySurface *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelLegacySurface_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelLegacySurface::operator delete(void*, unsigned long)

void __cdecl IOAccelLegacySurface::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelLegacySurface_ktv,param_1,param_2);
  return;
}



// IOAccelLegacySurface::clientClose()

undefined8 __thiscall IOAccelLegacySurface::clientClose(IOAccelLegacySurface *this)

{
  IOGraphicsAccelerator2 *pIVar1;
  int iVar2;
  OSMetaClassBase *pOVar3;
  IOAccelContext2 *this_00;
  uint uVar4;
  IOAccelLegacySurface *pIVar5;
  
  if (this[0xf2] == (IOAccelLegacySurface)0x0) goto LAB_00014657;
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (*(long **)(this + 0x1028) != (long *)0x0) {
    iVar2 = (**(code **)(**(long **)(this + 0x1028) + 0x130))();
    if (0 < iVar2) {
      uVar4 = iVar2 + 1;
      do {
        pOVar3 = (OSMetaClassBase *)
                 (**(code **)(**(long **)(this + 0x1028) + 0x1e8))
                           (*(long **)(this + 0x1028),uVar4 - 2);
        this_00 = (IOAccelContext2 *)
                  OSMetaClassBase::safeMetaCast(pOVar3,(OSMetaClass *)&IOAccelContext2::gMetaClass);
        if (this_00 == (IOAccelContext2 *)0x0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: unknown object type\n",
                            "virtual IOReturn IOAccelLegacySurface::clientClose()");
        }
        else {
          IOAccelContext2::remove_surface(this_00,(long)this);
        }
        uVar4 = uVar4 - 1;
      } while (1 < uVar4);
    }
  }
  uVar4 = *(uint *)(this + 0x1390);
  if ((uVar4 == 0xffff) || (((byte)this[0x11b1] & 0x80) == 0)) {
    if ((*(int *)(this + 0x1398) != 0xffff) && (((byte)this[0x11b1] & 0x80) != 0)) {
      pIVar5 = this + 0x1398;
      leave_assembly_fullscreen(this);
      IOAccelLegacyDisplayMachine::reset_scanout
                (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),*(uint *)(this + 0x1398));
      goto LAB_000145e8;
    }
  }
  else {
    if (*(uint *)(this + 0x1168) < 0x100) {
      leave_assembly_fullscreen(this);
      uVar4 = *(uint *)(this + 0x1390);
    }
    pIVar5 = this + 0x1390;
    IOAccelLegacyDisplayMachine::reset_fullscreen
              (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),uVar4,'\0');
LAB_000145e8:
    this[0x11b1] = (IOAccelLegacySurface)((byte)this[0x11b1] & 0x7f);
    *(undefined4 *)pIVar5 = 0xffff;
  }
  if (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8) != (IOAccelLegacyDisplayMachine *)0x0) {
    IOAccelLegacyDisplayMachine::surface_will_stop
              (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),(long)this);
  }
  this[0x118c] = (IOAccelLegacySurface)0x1;
  *(uint *)(this + 0x1168) = -0x20 - (uint)(*(uint *)(this + 0x1168) < 0x100);
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
LAB_00014657:
  (**(code **)(*(long *)this + 0x600))(this,0);
  return 0;
}



// IOAccelLegacySurface::leave_assembly_fullscreen()

void __thiscall IOAccelLegacySurface::leave_assembly_fullscreen(IOAccelLegacySurface *this)

{
  IOAccelLegacySurface *pIVar1;
  IOAccelLegacySurface *pIVar2;
  IOAccelLegacySurface *pIVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  int iVar6;
  ulong uVar7;
  IOAccelLegacySurface *pIVar8;
  IOAccelLegacySurface *pIVar9;
  uint uVar10;
  IOAccelLegacySurface *pIVar11;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  
  if (((*(uint *)(this + 0x1190) & 2) != 0) && (this[0x118c] == (IOAccelLegacySurface)0x0)) {
    uVar10 = *(uint *)(this + 0x1190) & 7;
    if ((uVar10 == 0) ||
       (uVar7 = IOAccelSurface::prepare_buffers((IOAccelSurface *)this,uVar10), (char)uVar7 != '\0')
       ) {
      IOAccelSurface::complete_buffers((IOAccelSurface *)this,uVar10);
      uVar10 = *(uint *)(this + 0x1390);
      if ((uVar10 != 0xffff) || (uVar10 = *(uint *)(this + 0x1398), uVar10 != 0xffff)) {
        IOAccelDisplayMachine::finish_transaction_queue
                  (*(IOAccelDisplayMachine **)(this + 0x13a8),uVar10);
      }
      local_30 = &DAT_aaaaaaaaaaaaaaaa;
      local_38 = &DAT_aaaaaaaaaaaaaaaa;
      local_40 = &DAT_aaaaaaaaaaaaaaaa;
      local_48 = &DAT_aaaaaaaaaaaaaaaa;
      local_50 = &DAT_aaaaaaaaaaaaaaaa;
      local_58 = &DAT_aaaaaaaaaaaaaaaa;
      local_60 = &DAT_aaaaaaaaaaaaaaaa;
      local_68 = &DAT_aaaaaaaaaaaaaaaa;
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x140))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_68);
      (**(code **)(*(long *)this + 0x970))
                (this,&local_68,*(undefined8 *)(this + 0x11c0),*(undefined8 *)(this + 0x11c8));
      (**(code **)(**(long **)(this + 0x11c8) + 0x168))(*(long **)(this + 0x11c8),0,0);
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_68,
                 (ulong)*(byte *)(*(long *)(this + 0x11c0) + 0x15) * 0x40 +
                 *(long *)(*(long *)(this + 0x11c0) + 0x38));
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_68,
                 (ulong)*(byte *)(*(long *)(this + 0x11c8) + 0x15) * 0x40 +
                 *(long *)(*(long *)(this + 0x11c8) + 0x38));
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_68,
                 (ulong)*(byte *)(*(long *)(this + 0x11c8) + 0x16) * 0x40 +
                 *(long *)(*(long *)(this + 0x11c8) + 0x38));
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x148))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_68);
      if (*(long *)(this + 0x11d0) != 0) {
        (**(code **)(*(long *)this + 0x970))(this,&local_68,*(undefined8 *)(this + 0x11c0));
        (**(code **)(**(long **)(this + 0x11d0) + 0x168))(*(long **)(this + 0x11d0),0,0);
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_68,
                   (ulong)*(byte *)(*(long *)(this + 0x11c0) + 0x15) * 0x40 +
                   *(long *)(*(long *)(this + 0x11c0) + 0x38));
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_68,
                   (ulong)*(byte *)(*(long *)(this + 0x11d0) + 0x15) * 0x40 +
                   *(long *)(*(long *)(this + 0x11d0) + 0x38));
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_68,
                   (ulong)*(byte *)(*(long *)(this + 0x11d0) + 0x16) * 0x40 +
                   *(long *)(*(long *)(this + 0x11d0) + 0x38));
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x148))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_68);
      }
      pIVar1 = this + 0x11c0;
      pIVar2 = this + 0x11c8;
      pIVar3 = this + 0x11d0;
      uVar7 = get_current_backbuffer_index(this);
      iVar6 = (int)uVar7;
      pIVar8 = pIVar1;
      pIVar9 = pIVar2;
      pIVar11 = pIVar3;
      if (((iVar6 != 0) && (pIVar8 = pIVar2, pIVar9 = pIVar3, pIVar11 = pIVar1, iVar6 != 2)) &&
         (pIVar8 = pIVar3, pIVar9 = pIVar1, pIVar11 = pIVar2, iVar6 != 1)) {
                    // WARNING: Subroutine does not return
        _panic("\"%s: get_current_backbuffer_index returned unexpected value: %d\" @%s:%d",
               "void IOAccelLegacySurface::leave_assembly_fullscreen()",uVar7 & 0xffffffff,
               "IOAccelLegacySurface.cpp",0x980);
      }
      uVar4 = *(undefined8 *)pIVar11;
      uVar5 = *(undefined8 *)pIVar9;
      *(undefined8 *)(this + 0x11c0) = *(undefined8 *)pIVar8;
      *(undefined8 *)(this + 0x11c8) = uVar5;
      *(undefined8 *)(this + 0x11d0) = uVar4;
      this[0x138d] = (IOAccelLegacySurface)0x1;
    }
    else {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Failed to alloc surface\n",
                        "void IOAccelLegacySurface::leave_assembly_fullscreen()");
    }
  }
  return;
}



// IOGraphicsAccelerator2::acceleratorUnlock()

void __thiscall IOGraphicsAccelerator2::acceleratorUnlock(IOGraphicsAccelerator2 *this)

{
  (**(code **)(*(long *)this + 0x858))(this,"",0);
  unlock_busy(this);
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  return;
}



// IOAccelLegacySurface::surfaceStart()

ulong __thiscall IOAccelLegacySurface::surfaceStart(IOAccelLegacySurface *this)

{
  ulong uVar1;
  long lVar2;
  ulong uVar3;
  
  uVar1 = IOAccelSurface::surfaceStart((IOAccelSurface *)this);
  uVar3 = uVar1 & 0xffffffff;
  if ((char)uVar1 != '\0') {
    lVar2 = OSMetaClassBase::safeMetaCast
                      (*(OSMetaClassBase **)(*(long *)(this + 0x12c8) + 0x378),
                       (OSMetaClass *)&IOAccelLegacyDisplayMachine::gMetaClass);
    *(long *)(this + 0x13a8) = lVar2;
    if ((lVar2 == 0) || (lVar2 != *(long *)(this + 0x12d0))) {
      surfaceStart();
      uVar3 = 0;
    }
    else {
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x140))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),this + 0x10e8);
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x140))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),this + 0x1128);
      lVar2 = 0;
      *(undefined8 *)(this + 0x1338) = 0;
      *(undefined2 *)(this + 0x1342) = 0;
      *(undefined8 *)(this + 0x13a0) = 0;
      this[0x138c] = (IOAccelLegacySurface)0x0;
      *(undefined4 *)(this + 0x1344) = 0xffff;
      *(undefined4 *)(this + 0x1350) = 0;
      *(undefined8 *)(this + 0x1354) = 0;
      *(undefined8 *)(this + 0x1360) = 0;
      do {
        *(undefined4 *)(this + (long)(&DAT_00001368 + lVar2 * 4)) = 0;
        lVar2 = lVar2 + 1;
      } while (lVar2 != 8);
      *(undefined4 *)(this + 5000) = 0;
      *(undefined2 *)(this + 0x1340) = 0;
      *(undefined8 *)(this + 0x1390) = 0xffff0000ffff;
      *(undefined8 *)(this + 0x1398) = 0xffff0000ffff;
      this[0x138d] = (IOAccelLegacySurface)0x1;
    }
  }
  return uVar3;
}



// IOAccelLegacySurface::surfaceStop()

void __thiscall IOAccelLegacySurface::surfaceStop(IOAccelLegacySurface *this)

{
  uint uVar1;
  IOAccelLegacySurface *pIVar2;
  
  if (((*(uint *)(this + 0x1168) < 0x100) || (*(uint *)(this + 0x1168) == 0xffffffdf)) &&
     (((byte)(*(IOGraphicsAccelerator2 **)(this + 0x12c8))[0xc92] & 1) != 0)) {
    IOGraphicsAccelerator2::decrement_busy_count(*(IOGraphicsAccelerator2 **)(this + 0x12c8));
  }
  uVar1 = *(uint *)(this + 0x1390);
  if ((uVar1 == 0xffff) || (((byte)this[0x11b1] & 0x80) == 0)) {
    if ((*(int *)(this + 0x1398) == 0xffff) || (((byte)this[0x11b1] & 0x80) == 0))
    goto LAB_00014be4;
    pIVar2 = this + 0x1398;
    leave_assembly_fullscreen(this);
    IOAccelLegacyDisplayMachine::reset_scanout
              (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),*(uint *)(this + 0x1398));
  }
  else {
    if (*(uint *)(this + 0x1168) < 0x100) {
      leave_assembly_fullscreen(this);
      uVar1 = *(uint *)(this + 0x1390);
    }
    pIVar2 = this + 0x1390;
    IOAccelLegacyDisplayMachine::reset_fullscreen
              (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),uVar1,'\0');
  }
  this[0x11b1] = (IOAccelLegacySurface)((byte)this[0x11b1] & 0x7f);
  *(undefined4 *)pIVar2 = 0xffff;
LAB_00014be4:
  if (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8) != (IOAccelLegacyDisplayMachine *)0x0) {
    IOAccelLegacyDisplayMachine::surface_will_stop
              (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),(long)this);
  }
  *(undefined8 *)(this + 0x1338) = 0;
  IOAccelSurface::surfaceStop((IOAccelSurface *)this);
  return;
}



// IOAccelLegacySurface::add_context_to_list(IOAccelContext2*)

void __thiscall IOAccelLegacySurface::add_context_to_list(IOAccelLegacySurface *this,long *param_1)

{
  uint uVar1;
  char cVar2;
  byte bVar3;
  
  uVar1 = *(uint *)(this + 0x1190);
  IOAccelSurface::add_context_to_list((IOAccelSurface *)this,param_1);
  cVar2 = (**(code **)(*param_1 + 0xb28))(param_1);
  if (cVar2 != '\0') {
    *(int *)(this + 0x133c) = *(int *)(this + 0x133c) + 1;
  }
  cVar2 = (**(code **)(*param_1 + 0xb20))(param_1);
  if (cVar2 == '\0') {
    *(int *)(this + 0x1338) = *(int *)(this + 0x1338) + 1;
  }
  if (*(uint *)(this + 0x1344) != 0xffff) {
    if ((*(int *)(this + 0x1338) == 0) || (((byte)this[0x11b1] & 4) != 0)) {
      if (((uVar1 ^ *(uint *)(this + 0x1190)) & 2) == 0) goto LAB_00014cb6;
      cVar2 = '\0';
      bVar3 = 0;
    }
    else {
      cVar2 = '\x01';
      bVar3 = 1;
    }
    update_exclusive_bit(this,(ulong)*(uint *)(this + 0x1344),cVar2,bVar3);
  }
LAB_00014cb6:
  if (((*(int *)(this + 0x133c) != 0) && (((byte)this[0x11b1] & 0x80) != 0)) &&
     ((*(uint *)(this + 0x1190) & 4) == 0)) {
    *(uint *)(this + 0x1190) = *(uint *)(this + 0x1190) | 4;
  }
  return;
}



// IOAccelLegacySurface::update_exclusive_bit(unsigned int, bool, bool)

undefined8 __thiscall
IOAccelLegacySurface::update_exclusive_bit
          (IOAccelLegacySurface *this,ulong param_2_00,char param_2,byte param_3)

{
  IOAccelLegacySurface IVar1;
  short sVar2;
  int *piVar3;
  char cVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  undefined8 uVar8;
  long lVar9;
  IOAccelLegacySurface *pIVar10;
  ulong uVar11;
  byte bVar12;
  ulong uVar13;
  uint uVar14;
  bool bVar15;
  bool bVar16;
  
  uVar11 = param_2_00 & 0xffffffff;
  uVar14 = (uint)param_2_00;
  if (this[0x138c] != (IOAccelLegacySurface)0x0) {
    uVar8 = update_exclusive_scanout_bit(this,uVar14,param_2);
    return uVar8;
  }
  if (((*(uint *)(this + 0x1168) < 0x100) && (*(int *)(this + 0x1394) == 0xffff)) ||
     (((uint)*(ulong *)(this + 0x11b0) & 0x700020) != 0x20)) {
LAB_00014f25:
    uVar8 = 0;
  }
  else {
    uVar13 = param_2_00;
    if (((param_2 == '\0') && (((byte)this[0x1350] & 2) == 0)) &&
       ((*(int *)(this + 0x1338) == 0 || ((*(ulong *)(this + 0x11b0) & 0x400) != 0)))) {
      piVar3 = *(int **)(this + (long)(&DAT_00001050 + uVar11 * 0x10));
      uVar13 = param_2_00 & 0xffffffff;
      cVar4 = IOAccelDisplayMachine::isFramebufferActive
                        (*(IOAccelDisplayMachine **)(this + 0x13a8),uVar14);
      if (cVar4 == '\0') goto LAB_00014ecd;
      uVar13 = param_2_00 & 0xffffffff;
      cVar4 = IOAccelLegacyDisplayMachine::is_framebuffer_safe_for_exclusive
                        (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),uVar14);
      if (cVar4 == '\0') goto LAB_00014ecd;
      iVar6 = piVar3[2];
      uVar13 = param_2_00 & 0xffffffff;
      iVar5 = IOAccelDisplayMachine::getFramebufferWidth
                        (*(IOAccelDisplayMachine **)(this + 0x13a8),uVar14);
      if (iVar5 != (short)iVar6) goto LAB_00014ecd;
      sVar2 = *(short *)((long)piVar3 + 10);
      uVar13 = param_2_00 & 0xffffffff;
      iVar6 = IOAccelDisplayMachine::getFramebufferHeight
                        (*(IOAccelDisplayMachine **)(this + 0x13a8),uVar14);
      if (iVar6 != sVar2) goto LAB_00014ecd;
      IVar1 = this[0x1342];
      uVar13 = param_2_00 & 0xffffffff;
      uVar7 = IOAccelLegacyDisplayMachine::getFramebufferPixelBytes
                        (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),uVar14);
      if (uVar7 != (byte)IVar1) goto LAB_00014ecd;
      *(uint *)(this + 0x1344) = uVar14;
      if (((((byte)this[0x1190] & 2) == 0) && (((byte)this[0x11b1] & 0xc) == 0)) ||
         ((((byte)this[0x1170] & 2) != 0 ||
          (((*piVar3 != 1 || ((short)piVar3[3] != 0)) || (*(short *)((long)piVar3 + 0xe) != 0))))))
      goto LAB_00014ed7;
      iVar6 = piVar3[4];
      uVar13 = param_2_00 & 0xffffffff;
      iVar5 = IOAccelDisplayMachine::getFramebufferWidth
                        (*(IOAccelDisplayMachine **)(this + 0x13a8),uVar14);
      if ((iVar5 != (short)iVar6) ||
         (sVar2 = *(short *)((long)piVar3 + 0x12),
         iVar6 = IOAccelDisplayMachine::getFramebufferHeight
                           (*(IOAccelDisplayMachine **)(this + 0x13a8),uVar14), uVar13 = uVar11,
         iVar6 != sVar2)) goto LAB_00014ed7;
      uVar13 = (ulong)*(uint *)(this + 0x1344);
      lVar9 = IOAccelLegacyDisplayMachine::getFullScreenSurface
                        (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),*(uint *)(this + 0x1344));
      if (lVar9 == 0) {
        bVar15 = true;
      }
      else {
        uVar13 = (ulong)*(uint *)(this + 0x1344);
        pIVar10 = (IOAccelLegacySurface *)
                  IOAccelLegacyDisplayMachine::getFullScreenSurface
                            (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),
                             *(uint *)(this + 0x1344));
        bVar15 = pIVar10 == this;
      }
      uVar11 = *(ulong *)(this + 0x11b0);
      bVar12 = bVar15 ^ 1;
      bVar16 = (uVar11 & 0x8000) == 0;
      uVar8 = CONCAT71((int7)(uVar13 >> 8),bVar16);
      if ((!bVar16) || (bVar15 == false)) goto LAB_00014eea;
LAB_00014f51:
      *(ulong *)(this + 0x11b0) = uVar11 | 0x8000;
      uVar8 = enter_exclusive_mode(this,uVar14,(uint)param_3);
    }
    else {
LAB_00014ecd:
      *(undefined4 *)(this + 0x1344) = 0xffff;
LAB_00014ed7:
      uVar11 = *(ulong *)(this + 0x11b0);
      uVar8 = CONCAT71((int7)(uVar13 >> 8),((uint)uVar11 >> 0xf & 1) == 0);
      bVar12 = 1;
      bVar15 = false;
LAB_00014eea:
      if (((char)uVar8 != '\0') || (bVar15 != false)) {
        if ((char)uVar8 == '\0') {
          bVar12 = *(uint *)(this + 0x1390) == uVar14 | bVar12;
          if (bVar12 == 0) {
            if (*(uint *)(this + 0x1390) != 0xffff) {
              *(ulong *)(this + 0x11b0) = uVar11 & 0xffffffffffff7fff;
              leave_exclusive_mode(this,CONCAT71((int7)((ulong)uVar8 >> 8),bVar12),param_3);
              uVar11 = *(ulong *)(this + 0x11b0);
            }
            goto LAB_00014f51;
          }
        }
        goto LAB_00014f25;
      }
      *(ulong *)(this + 0x11b0) = uVar11 & 0xffffffffffff7fff;
      uVar8 = leave_exclusive_mode(this,uVar8,param_3);
    }
    uVar8 = CONCAT71((int7)((ulong)uVar8 >> 8),1);
  }
  return uVar8;
}



// IOAccelLegacySurface::remove_context_from_list(IOAccelContext2*)

void __thiscall
IOAccelLegacySurface::remove_context_from_list(IOAccelLegacySurface *this,long *param_1)

{
  char cVar1;
  
  cVar1 = (**(code **)(*param_1 + 0xb20))(param_1);
  if (cVar1 == '\0') {
    *(int *)(this + 0x1338) = *(int *)(this + 0x1338) + -1;
  }
  cVar1 = (**(code **)(*param_1 + 0xb28))(param_1);
  if (cVar1 != '\0') {
    *(int *)(this + 0x133c) = *(int *)(this + 0x133c) + -1;
  }
  IOAccelSurface::remove_context_from_list((IOAccelSurface *)this,(long)param_1);
  return;
}



// IOAccelLegacySurface::set_id_mode(unsigned int, unsigned int)

undefined8 __thiscall
IOAccelLegacySurface::set_id_mode(IOAccelLegacySurface *this,uint param_1,uint param_2)

{
  uint uVar1;
  IOGraphicsAccelerator2 *pIVar2;
  long lVar3;
  bool bVar4;
  char cVar5;
  IOAccelLegacySurface IVar6;
  undefined2 uVar7;
  int iVar8;
  uint uVar9;
  undefined8 in_RAX;
  IOAccelLegacySurface *pIVar10;
  long lVar11;
  long lVar12;
  uint uVar13;
  IOAccelLegacySurface IVar14;
  undefined8 uVar15;
  undefined4 uVar16;
  
  uVar16 = (undefined4)((ulong)in_RAX >> 0x20);
  if ((param_2 & 0xff8073c0) != 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Surface mode contains bad bits\n",
                      "virtual IOReturn IOAccelLegacySurface::set_id_mode(uint32_t, uint32_t)");
    return 0xe00002c2;
  }
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
  _OSIncrementAtomic(pIVar2 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar2 + 0x88));
  _OSDecrementAtomic(pIVar2 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar2);
  (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
  if ((this[0x10d0] != (IOAccelLegacySurface)0x0) || (this[0x10d1] != (IOAccelLegacySurface)0x0)) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: surface data read or write locked\n"
                      ,"virtual IOReturn IOAccelLegacySurface::set_id_mode(uint32_t, uint32_t)");
    uVar15 = 0xe00002cc;
    goto LAB_000150d2;
  }
  if ((~param_2 & 0xc00) == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Surface mode illegal. Can\'t force both front and back buffers at the same time.\n"
                      ,"virtual IOReturn IOAccelLegacySurface::set_id_mode(uint32_t, uint32_t)");
    goto LAB_000153d1;
  }
  iVar8 = (**(code **)(**(long **)(this + 0x1028) + 0x130))();
  if (iVar8 != 0) {
    if ((((uint)*(undefined8 *)(this + 0x11b0) ^ param_2) & 0x7f8c3f) != 0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Surface mode incompatible\n",
                        "virtual IOReturn IOAccelLegacySurface::set_id_mode(uint32_t, uint32_t)");
      goto LAB_000153d1;
    }
    param_2 = (uint)*(undefined8 *)(this + 0x11b0) & 0xff8073c0 | param_2;
  }
  IVar14 = (IOAccelLegacySurface)0x2;
  bVar4 = false;
  switch(param_2 & 0xf) {
  case 3:
    goto switchD_000151d1_caseD_3;
  case 4:
  case 0xf:
    IVar14 = (IOAccelLegacySurface)0x4;
    break;
  default:
    bVar4 = true;
    IVar14 = (IOAccelLegacySurface)0x0;
    goto switchD_000151d1_caseD_3;
  case 0xb:
  case 0xc:
    IVar14 = (IOAccelLegacySurface)0x8;
    break;
  case 0xd:
    IVar14 = (IOAccelLegacySurface)0x10;
  }
  bVar4 = false;
switchD_000151d1_caseD_3:
  if ((param_2 & 0x20) == 0) {
    uVar9 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x13a8));
    if (param_1 < uVar9) {
      cVar5 = IOAccelDisplayMachine::isFramebufferActive
                        (*(IOAccelDisplayMachine **)(this + 0x13a8),param_1);
      if (cVar5 == '\0') {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: framebuffer %d inactive\n",
                          "virtual IOReturn IOAccelLegacySurface::set_id_mode(uint32_t, uint32_t)",
                          param_1);
      }
      else {
        pIVar10 = (IOAccelLegacySurface *)
                  IOAccelLegacyDisplayMachine::getFullScreenSurface
                            (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),param_1);
        if ((((pIVar10 == (IOAccelLegacySurface *)0x0) || (pIVar10 == this)) ||
            (((byte)pIVar10[0x11b0] & 0x20) != 0)) || ((param_2 & 0x8000) == 0)) {
          uVar9 = IOAccelLegacyDisplayMachine::getFramebufferPixelBytes
                            (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),param_1);
          if (uVar9 == (byte)IVar14) {
            uVar13 = ~param_1;
            uVar9 = param_1;
            goto LAB_00015448;
          }
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: Invalid fullscreen color: 0x%X\n",
                            "virtual IOReturn IOAccelLegacySurface::set_id_mode(uint32_t, uint32_t)"
                            ,param_2 & 0xf);
        }
        else {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Frame buffer %u already FS\n",
                            "virtual IOReturn IOAccelLegacySurface::set_id_mode(uint32_t, uint32_t)"
                            ,param_1);
        }
      }
    }
    else {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Invalid frame buffer index: %d\n",
                        "virtual IOReturn IOAccelLegacySurface::set_id_mode(uint32_t, uint32_t)",
                        param_1);
    }
LAB_000153d1:
    uVar15 = 0xe00002bc;
  }
  else {
    uVar9 = *(uint *)(this + 0x1168);
    if ((uVar9 != 0xffffffe0) && (uVar9 != param_1)) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Surface already has id (0x%08x), can not accept new id (0x%08x)\n",
                        "virtual IOReturn IOAccelLegacySurface::set_id_mode(uint32_t, uint32_t)",
                        uVar9,CONCAT44(uVar16,param_1));
      uVar15 = 0xe00002c2;
      goto LAB_000150d2;
    }
    uVar9 = 0xffff;
    if ((param_2 >> 0xf & 1) == 0) {
      IVar6 = (IOAccelLegacySurface)0x0;
    }
    else {
      if (*(uint *)(this + 0x1390) == 0xffff) {
        param_2 = param_2 & 0xffff7fff;
      }
      else {
        if ((bVar4) ||
           (uVar9 = IOAccelLegacyDisplayMachine::getFramebufferPixelBytes
                              (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),
                               *(uint *)(this + 0x1390)), uVar9 != (byte)IVar14)) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: mode=%08x has exclusive bit but it is not appropriate for full screen: Removing exclusive bit\n"
                            ,
                            "virtual IOReturn IOAccelLegacySurface::set_id_mode(uint32_t, uint32_t)"
                            ,param_2);
          param_2 = param_2 & 0xffff7fff;
          IVar6 = (IOAccelLegacySurface)0x1;
          uVar9 = 0xffff;
          goto LAB_00015415;
        }
        uVar9 = *(uint *)(this + 0x1390);
      }
      IVar6 = (IOAccelLegacySurface)0x1;
    }
LAB_00015415:
    this[0x1343] = IVar6;
    *(uint *)(this + 0x1344) = uVar9;
    uVar13 = param_1;
    if ((param_1 < 0x100) && (((byte)(*(IOGraphicsAccelerator2 **)(this + 0x12c8))[0xc92] & 1) != 0)
       ) {
      IOGraphicsAccelerator2::increment_busy_count(*(IOGraphicsAccelerator2 **)(this + 0x12c8));
    }
LAB_00015448:
    uVar1 = *(uint *)(this + 0x1390);
    if (((uVar1 != 0xffff) && (uVar1 != uVar9)) &&
       (pIVar10 = (IOAccelLegacySurface *)
                  IOAccelLegacyDisplayMachine::getFullScreenSurface
                            (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),uVar1),
       pIVar10 == this)) {
      IOAccelLegacyDisplayMachine::reset_fullscreen
                (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),*(uint *)(this + 0x1390),'\0');
    }
    *(ulong *)(this + 0x11b0) = (ulong)param_2;
    *(uint *)(this + 0x1168) = uVar13;
    *(uint *)(this + 0x1390) = uVar9;
    this[0x1342] = IVar14;
    *(undefined4 *)(this + 0x1188) = 0;
    (**(code **)(*(long *)this + 0x9e8))(this);
    IOAccelSurface::reset_access((IOAccelSurface *)this);
    uVar15 = 0;
    if (((byte)this[0x11b0] & 0x20) == 0) {
      *(undefined4 *)(this + 0x1170) = 0;
      uVar15 = 0;
      if (*(int *)(this + (long)(&DAT_00001058 + (ulong)*(uint *)(this + 0x1390) * 0x10)) != 0xc) {
        lVar11 = _IOMallocData(0xc);
        if (lVar11 == 0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Failed to alloc region\n",
                            "virtual IOReturn IOAccelLegacySurface::set_id_mode(uint32_t, uint32_t)"
                           );
          uVar15 = 0xe00002be;
        }
        else {
          _IOFreeData(*(undefined8 *)
                       (this + (long)(&DAT_00001050 + (ulong)*(uint *)(this + 0x1390) * 0x10)),
                      *(undefined4 *)
                       (this + (long)(&DAT_00001058 + (ulong)*(uint *)(this + 0x1390) * 0x10)));
          lVar3 = *(long *)(this + 0x12c8);
          lVar12 = (ulong)*(uint *)(this + 0x1390) * 0x10;
          if (lVar3 == 0) {
            *(long *)(this + (long)(&DAT_00001050 + lVar12)) = lVar11;
            *(undefined4 *)(this + (long)(&DAT_00001058 + lVar12)) = 0xc;
            uVar15 = 0;
          }
          else {
            iVar8 = *(int *)(this + (long)(&DAT_00001058 + lVar12));
            IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar3 + 0x388) + 0x58),0x51);
            *(int *)(lVar3 + 0x2e4) = *(int *)(lVar3 + 0x2e4) - iVar8;
            lVar3 = *(long *)(this + 0x12c8);
            uVar9 = *(uint *)(this + 0x1390);
            *(long *)(this + (long)(&DAT_00001050 + (ulong)uVar9 * 0x10)) = lVar11;
            *(undefined4 *)(this + (long)(&DAT_00001058 + (ulong)uVar9 * 0x10)) = 0xc;
            if (lVar3 != 0) {
              IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar3 + 0x388) + 0x58),0x51)
              ;
              *(int *)(lVar3 + 0x2e4) = *(int *)(lVar3 + 0x2e4) + 0xc;
            }
          }
        }
      }
      uVar9 = *(uint *)(this + 0x1390);
      **(undefined8 **)(this + (long)(&DAT_00001050 + (ulong)uVar9 * 0x10)) = 0;
      uVar7 = IOAccelDisplayMachine::getFramebufferWidth
                        (*(IOAccelDisplayMachine **)(this + 0x13a8),uVar9);
      uVar9 = *(uint *)(this + 0x1390);
      *(undefined2 *)(*(long *)(this + (long)(&DAT_00001050 + (ulong)uVar9 * 0x10)) + 8) = uVar7;
      *(undefined2 *)(this + 0x11b8) = uVar7;
      *(undefined2 *)(this + 0x11bc) = uVar7;
      uVar7 = IOAccelDisplayMachine::getFramebufferHeight
                        (*(IOAccelDisplayMachine **)(this + 0x13a8),uVar9);
      uVar9 = *(uint *)(this + 0x1390);
      *(undefined2 *)(*(long *)(this + (long)(&DAT_00001050 + (ulong)uVar9 * 0x10)) + 10) = uVar7;
      *(undefined2 *)(this + 0x11ba) = uVar7;
      *(undefined2 *)(this + 0x11be) = uVar7;
      this[(long)(&DAT_0000105c + (ulong)uVar9 * 0x10)] = (IOAccelLegacySurface)0x0;
    }
    (**(code **)(*(long *)this + 0x9e0))(this);
    (**(code **)(*(long *)this + 0x9d8))(this);
    pick_present_type(this);
    this[0x118c] = (IOAccelLegacySurface)0x0;
    if ((*(int *)(this + 0x1390) != 0xffff) && (((byte)this[0x11b1] & 0x80) != 0)) {
      IOAccelLegacyDisplayMachine::setup_fullscreen
                (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),(long)this);
    }
  }
LAB_000150d2:
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
  (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar2);
  _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
  return uVar15;
}



// IOAccelLegacySurface::pick_present_type()

void __thiscall IOAccelLegacySurface::pick_present_type(IOAccelLegacySurface *this)

{
  int iVar1;
  uint uVar2;
  ulong uVar3;
  
  *(undefined4 *)(this + 5000) = 0;
  iVar1 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x13a8));
  if (iVar1 != 0) {
    uVar3 = 0;
    do {
      iVar1 = (**(code **)(*(long *)this + 0xa60))(this,uVar3 & 0xffffffff);
      *(int *)(this + (long)(&DAT_00001368 + uVar3 * 4)) = iVar1;
      if ((iVar1 != 0) && ((iVar1 <= *(int *)(this + 5000) || (*(int *)(this + 5000) == 0)))) {
        *(int *)(this + 5000) = iVar1;
      }
      uVar3 = uVar3 + 1;
      uVar2 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x13a8))
      ;
    } while (uVar3 < uVar2);
  }
  uVar2 = *(uint *)(this + 0x1398);
  if ((uVar2 != 0xffff) || (uVar2 = *(uint *)(this + 0x1390), uVar2 != 0xffff)) {
    *(undefined4 *)(this + 5000) = *(undefined4 *)(this + (long)(&DAT_00001368 + (ulong)uVar2 * 4));
  }
  return;
}



// IOAccelLegacySurface::surface_flush(unsigned int, unsigned int)

undefined8 __thiscall
IOAccelLegacySurface::surface_flush(IOAccelLegacySurface *this,uint param_1,uint param_2)

{
  int *piVar1;
  bool bVar2;
  char cVar3;
  undefined4 uVar4;
  int iVar5;
  long lVar6;
  ulong uVar7;
  IOGraphicsAccelerator2 *pIVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  uint local_34;
  
  pIVar8 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
  _OSIncrementAtomic(pIVar8 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar8 + 0x88));
  _OSDecrementAtomic(pIVar8 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar8);
  (**(code **)(*(long *)pIVar8 + 0x850))(pIVar8,"",0);
  if (this[0x118c] == (IOAccelLegacySurface)0x0) {
    if (*(int *)(this + 5000) == 1) {
      pIVar8 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
      (**(code **)(*(long *)pIVar8 + 0x858))(pIVar8,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar8);
      _IOLockUnlock(*(undefined8 *)(pIVar8 + 0x88));
      return 0xe00002c7;
    }
    local_34 = param_2;
    uVar4 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x13a8));
    uVar9 = ~(-1 << ((byte)uVar4 & 0x1f)) & param_1;
    if ((*(int *)(this + 0x1394) == 0xffff) && (*(int *)(this + 0x139c) == 0xffff)) {
      if (uVar9 == 0) {
LAB_00015926:
        IOGraphicsAccelerator2::acceleratorUnlock(*(IOGraphicsAccelerator2 **)(this + 0x12c8));
        return 0;
      }
      uVar10 = 0;
      uVar11 = uVar9;
      do {
        if ((((uVar11 & 1) != 0) &&
            (lVar6 = IOAccelLegacyDisplayMachine::getFullScreenSurface
                               (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),uVar10), lVar6 != 0
            )) && (0xff < *(uint *)(&DAT_00001168 + lVar6))) {
          uVar9 = uVar9 & ~(1 << (uVar10 & 0x1f));
        }
        uVar10 = uVar10 + 1;
        bVar2 = 1 < uVar11;
        uVar11 = uVar11 >> 1;
      } while (bVar2);
      if (uVar9 == 0) goto LAB_00015926;
    }
    if (((*(uint *)(this + 0x1168) < 0x100) || (this[0x1340] == (IOAccelLegacySurface)0x0)) ||
       (cVar3 = (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 400))
                          (*(long **)(*(long *)(this + 0x12c8) + 0x380),this + 0x10e8),
       cVar3 != '\0')) {
      uVar11 = *(uint *)(this + 0x1188) & 7;
      uVar7 = IOAccelSurface::prepare_buffers((IOAccelSurface *)this,uVar11);
      if ((char)uVar7 == '\0') {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to prepare buffers.\n",
                          "IOReturn IOAccelLegacySurface::surface_flush(uint32_t, IOOptionBits)");
      }
      else if (*(int *)(this + 5000) == 4) {
        if (this[0x138c] == (IOAccelLegacySurface)0x0) {
          if (((byte)this[0x11b1] & 4) != 0) {
            IOAccelSurface::flip_buffers((IOAccelSurface *)this);
          }
          if ((local_34 >> 0x11 & 1) == 0) {
            IOAccelLegacyDisplayMachine::submit_flip
                      (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),this + 0x10e8,
                       *(uint *)(this + 0x1390),local_34 >> 2 & 2);
          }
        }
        else {
          IOAccelSurface::flip_buffers((IOAccelSurface *)this);
          if ((local_34 >> 0x11 & 1) == 0) {
            IOAccelLegacyDisplayMachine::submit_scanout_flip
                      (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),this + 0x10e8,
                       *(uint *)(this + 0x1398),local_34 >> 2 & 2);
          }
        }
        IOAccelSurface::complete_buffers((IOAccelSurface *)this,uVar11);
      }
      else {
        present_surface_with_swap(this,uVar9,local_34);
        IOAccelSurface::complete_buffers((IOAccelSurface *)this,uVar11);
        if (*(uint *)(this + 0x1394) != 0xffff) {
          update_exclusive_bit(this,(ulong)*(uint *)(this + 0x1394),'\0',0);
          pick_present_type(this);
        }
        if (*(uint *)(this + 0x139c) != 0xffff) {
          update_exclusive_scanout_bit(this,*(uint *)(this + 0x139c),'\0');
          pick_present_type(this);
        }
      }
    }
    else {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Skipping swap\n",
                        "IOReturn IOAccelLegacySurface::surface_flush(uint32_t, IOOptionBits)");
    }
    if (((0xff < *(uint *)(this + 0x1168)) && (*(int *)(this + 5000) != 4)) &&
       (((byte)this[0x11b1] & 4) == 0)) {
      local_40 = &DAT_aaaaaaaaaaaaaaaa;
      local_48 = &DAT_aaaaaaaaaaaaaaaa;
      local_50 = &DAT_aaaaaaaaaaaaaaaa;
      local_58 = &DAT_aaaaaaaaaaaaaaaa;
      local_60 = &DAT_aaaaaaaaaaaaaaaa;
      local_68 = &DAT_aaaaaaaaaaaaaaaa;
      local_70 = &DAT_aaaaaaaaaaaaaaaa;
      local_78 = &DAT_aaaaaaaaaaaaaaaa;
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x140))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_78);
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b0))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),this + 0x1128,&local_78);
      pIVar8 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
      (**(code **)(*(long *)pIVar8 + 0x858))(pIVar8,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar8);
      _IOLockUnlock(*(undefined8 *)(pIVar8 + 0x88));
      iVar5 = (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x178))
                        (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_78);
      lVar6 = *(long *)(this + 0x12c8);
      IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar6 + 0x388) + 0x58),0x35);
      piVar1 = (int *)(lVar6 + 0x274);
      *piVar1 = *piVar1 + iVar5;
      pIVar8 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
      _OSIncrementAtomic(pIVar8 + 0x90);
      _IOLockLock(*(undefined8 *)(pIVar8 + 0x88));
      _OSDecrementAtomic(pIVar8 + 0x90);
      IOGraphicsAccelerator2::lock_busy(pIVar8);
      (**(code **)(*(long *)pIVar8 + 0x850))(pIVar8,"",0);
    }
    pIVar8 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
    lVar6 = *(long *)pIVar8;
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Surface disabled. skiping flush\n",
                      "IOReturn IOAccelLegacySurface::surface_flush(uint32_t, IOOptionBits)");
    pIVar8 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
    lVar6 = *(long *)pIVar8;
  }
  (**(code **)(lVar6 + 0x858))(pIVar8,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar8);
  _IOLockUnlock(*(undefined8 *)(pIVar8 + 0x88));
  return 0;
}



// IOAccelLegacySurface::present_surface_with_swap(unsigned int, unsigned int)

uint __thiscall
IOAccelLegacySurface::present_surface_with_swap
          (IOAccelLegacySurface *this,uint param_1,uint param_2)

{
  int *piVar1;
  IOAccelLegacySurface IVar2;
  long lVar3;
  bool bVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  long lVar8;
  uint uVar9;
  
  IVar2 = this[0x1340];
  uVar7 = 2;
  if (((param_2 & 8) == 0) && (this[0x1341] == (IOAccelLegacySurface)0x0)) {
    uVar7 = *(int *)(this + 0x1350) * 2 & 2;
  }
  (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b0))
            (*(long **)(*(long *)(this + 0x12c8) + 0x380),this + 0x10e8,this + 0x1128);
  if (param_1 == 0) {
    uVar9 = 0;
  }
  else {
    uVar5 = (uint)(byte)((byte)((param_2 & 0x10) >> 4) | IVar2 != (IOAccelLegacySurface)0x0);
    lVar8 = 0;
    uVar9 = 0;
    do {
      if (((param_1 & 1) != 0) && (*(int *)(this + (long)(&DAT_00001368 + lVar8 * 4)) != 0)) {
        if (this[0x138c] == (IOAccelLegacySurface)0x0) {
          uVar6 = submit_swap(this,(uint)lVar8,param_2 & 0x20000 | uVar5 | uVar7);
          uVar9 = uVar9 | uVar6;
        }
        else {
          submit_scanout_swap(this,(uint)lVar8,uVar7 | uVar5);
        }
        lVar3 = *(long *)(this + 0x12c8);
        IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar3 + 0x388) + 0x58),0x27);
        piVar1 = (int *)(lVar3 + 0x23c);
        *piVar1 = *piVar1 + 1;
      }
      lVar8 = lVar8 + 1;
      bVar4 = 1 < param_1;
      param_1 = param_1 >> 1;
    } while (bVar4);
  }
  return uVar9;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelLegacySurface::update_exclusive_scanout_bit(unsigned int, bool, bool)

undefined8 __cdecl
IOAccelLegacySurface::update_exclusive_scanout_bit
          (IOAccelLegacySurface *param_1,uint param_2,char param_3)

{
  IOAccelLegacySurface IVar1;
  short sVar2;
  int *piVar3;
  char cVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  long lVar8;
  IOAccelLegacySurface *pIVar9;
  ulong uVar10;
  undefined8 uVar11;
  bool bVar12;
  
  if ((*(uint *)(param_1 + 0x1168) < 0x100) && (*(int *)(param_1 + 0x139c) == 0xffff)) {
    return 0;
  }
  uVar10 = *(ulong *)(param_1 + 0x11b0);
  if (((uint)uVar10 & 0x700020) != 0x20) {
    return 0;
  }
  if ((param_3 == '\0') && ((uVar10 & 0x400) != 0)) {
    piVar3 = *(int **)(param_1 + (long)(&DAT_00001050 + (ulong)param_2 * 0x10));
    cVar4 = IOAccelDisplayMachine::isFramebufferActive
                      (*(IOAccelDisplayMachine **)(param_1 + 0x13a8),param_2);
    if ((((cVar4 == '\0') ||
         (cVar4 = IOAccelLegacyDisplayMachine::is_framebuffer_safe_for_exclusive
                            (*(IOAccelLegacyDisplayMachine **)(param_1 + 0x13a8),param_2),
         cVar4 == '\0')) ||
        (iVar6 = piVar3[2],
        iVar5 = IOAccelLegacyDisplayMachine::getScanoutWidth
                          (*(IOAccelLegacyDisplayMachine **)(param_1 + 0x13a8),param_2),
        iVar5 != (short)iVar6)) ||
       ((sVar2 = *(short *)((long)piVar3 + 10),
        iVar6 = IOAccelLegacyDisplayMachine::getScanoutHeight
                          (*(IOAccelLegacyDisplayMachine **)(param_1 + 0x13a8),param_2),
        iVar6 != sVar2 ||
        (IVar1 = param_1[0x1342],
        uVar7 = IOAccelLegacyDisplayMachine::getFramebufferPixelBytes
                          (*(IOAccelLegacyDisplayMachine **)(param_1 + 0x13a8),param_2),
        uVar7 != (byte)IVar1)))) {
      *(undefined4 *)(param_1 + 0x1348) = 0xffff;
LAB_00015f58:
      uVar10 = *(ulong *)(param_1 + 0x11b0);
      goto LAB_00015f5f;
    }
    *(uint *)(param_1 + 0x1348) = param_2;
    if ((((((byte)param_1[0x1190] & 2) == 0) && (((byte)param_1[0x11b1] & 0xc) == 0)) ||
        ((((byte)param_1[0x1170] & 2) != 0 ||
         (((*piVar3 != 1 || ((short)piVar3[3] != 0)) || (*(short *)((long)piVar3 + 0xe) != 0))))))
       || ((iVar6 = piVar3[4],
           iVar5 = IOAccelLegacyDisplayMachine::getScanoutWidth
                             (*(IOAccelLegacyDisplayMachine **)(param_1 + 0x13a8),param_2),
           iVar5 != (short)iVar6 ||
           (sVar2 = *(short *)((long)piVar3 + 0x12),
           iVar6 = IOAccelLegacyDisplayMachine::getScanoutHeight
                             (*(IOAccelLegacyDisplayMachine **)(param_1 + 0x13a8),param_2),
           iVar6 != sVar2)))) goto LAB_00015f58;
    lVar8 = IOAccelLegacyDisplayMachine::getScanoutSurface
                      (*(IOAccelLegacyDisplayMachine **)(param_1 + 0x13a8),
                       *(uint *)(param_1 + 0x1348));
    if (lVar8 == 0) {
      bVar12 = false;
    }
    else {
      pIVar9 = (IOAccelLegacySurface *)
               IOAccelLegacyDisplayMachine::getScanoutSurface
                         (*(IOAccelLegacyDisplayMachine **)(param_1 + 0x13a8),
                          *(uint *)(param_1 + 0x1348));
      bVar12 = pIVar9 != param_1;
    }
    uVar10 = *(ulong *)(param_1 + 0x11b0);
    uVar7 = (uint)uVar10 & 0x8000;
    cVar4 = (char)(uVar7 >> 0xf);
    if ((uVar7 >> 0xf != 0) || (bVar12)) goto LAB_00015f70;
  }
  else {
    *(undefined4 *)(param_1 + 0x1348) = 0xffff;
LAB_00015f5f:
    uVar7 = (uint)uVar10 & 0x8000;
    cVar4 = (char)(uVar7 >> 0xf);
    bVar12 = true;
LAB_00015f70:
    if ((cVar4 != '\0') && (bVar12)) {
      *(ulong *)(param_1 + 0x11b0) = uVar10 & 0xffffffffffff7fff;
      uVar11 = leave_scanout_mode(param_1);
      goto LAB_00015fe7;
    }
    if ((uVar7 == 0) || (*(uint *)(param_1 + 0x1398) == param_2 || bVar12)) {
      return 0;
    }
    if (*(uint *)(param_1 + 0x1398) != 0xffff) {
      *(ulong *)(param_1 + 0x11b0) = uVar10 & 0xffffffffffff7fff;
      leave_scanout_mode(param_1);
      uVar10 = *(ulong *)(param_1 + 0x11b0);
    }
  }
  *(ulong *)(param_1 + 0x11b0) = uVar10 | 0x8000;
  uVar11 = enter_scanout_mode(param_1,param_2);
LAB_00015fe7:
  return CONCAT71((int7)((ulong)uVar11 >> 8),1);
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelLegacySurface::surface_lock_options(eLockType, unsigned int, IOAccelSurfaceInformation*,
// unsigned long long)

undefined8 __cdecl
IOAccelLegacySurface::surface_lock_options
          (IOAccelLegacySurface *param_1,int param_2,uint param_3,long *param_4)

{
  IOGraphicsAccelerator2 *pIVar1;
  IOAccelResource2 *this;
  uint uVar2;
  undefined4 uVar3;
  long lVar4;
  IOAccelLegacySurface *pIVar5;
  ulong uVar6;
  IOAccelLegacySurface IVar7;
  undefined8 uVar8;
  undefined4 local_38;
  int local_34;
  
  param_4[10] = 0;
  param_4[9] = 0;
  param_4[8] = 0;
  param_4[7] = 0;
  param_4[6] = 0;
  param_4[5] = 0;
  param_4[4] = 0;
  param_4[3] = 0;
  param_4[2] = 0;
  param_4[1] = 0;
  *param_4 = 0;
  pIVar1 = *(IOGraphicsAccelerator2 **)(param_1 + 0x12c8);
  local_34 = param_2;
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  uVar2 = param_3 & 0xfffffffc | 1;
  if (*(int *)(param_1 + 0x1394) == 0xffff) {
    uVar2 = param_3;
  }
  uVar6 = (ulong)(local_34 == 1) ^ 0x10d1;
  if (param_1[uVar6] == (IOAccelLegacySurface)0x0) {
    do {
      if (((*(uint *)(param_1 + 0x1190) & 3) == 0) && (((byte)param_1[0x11b1] & 0x80) == 0)) {
        param_1[0x1188] = (IOAccelLegacySurface)((byte)param_1[0x1188] | 1);
        *(uint *)(param_1 + 0x1190) = *(uint *)(param_1 + 0x1190) | 1;
        (**(code **)(*(long *)param_1 + 0x9e0))(param_1);
        (**(code **)(*(long *)param_1 + 0x9d8))(param_1);
      }
      pIVar5 = param_1 + 0x11c0;
      if ((*(uint *)(param_1 + 0x1168) < 0x100) &&
         (pIVar5 = param_1 + 0x11c8, ((byte)param_1[0x1190] & 2) == 0)) {
        pIVar5 = param_1 + 0x11c0;
      }
      if (param_1[0x118c] != (IOAccelLegacySurface)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Surface disabled\n",
                          "virtual IOReturn IOAccelLegacySurface::surface_lock_options(enum eLockType, uint32_t, IOAccelSurfaceData *, IOByteCount)"
                         );
LAB_000162bc:
        uVar8 = 0xe00002cc;
LAB_0001645b:
        pIVar1 = *(IOGraphicsAccelerator2 **)(param_1 + 0x12c8);
        (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
        IOGraphicsAccelerator2::unlock_busy(pIVar1);
        _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
        return uVar8;
      }
      this = *(IOAccelResource2 **)pIVar5;
      if (this == (IOAccelResource2 *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: No buffer\n",
                          "virtual IOReturn IOAccelLegacySurface::surface_lock_options(enum eLockType, uint32_t, IOAccelSurfaceData *, IOByteCount)"
                         );
        goto LAB_000162bc;
      }
      if (*(long *)(this + 200) == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Surface has null shape\n",
                          "virtual IOReturn IOAccelLegacySurface::surface_lock_options(enum eLockType, uint32_t, IOAccelSurfaceData *, IOByteCount)"
                         );
        goto LAB_000162bc;
      }
      local_38 = 0;
      if ((uVar2 & 3) == 3) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Bogus options\n",
                          "virtual IOReturn IOAccelLegacySurface::surface_lock_options(enum eLockType, uint32_t, IOAccelSurfaceData *, IOByteCount)"
                         );
        pIVar1 = *(IOGraphicsAccelerator2 **)(param_1 + 0x12c8);
        (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
        IOGraphicsAccelerator2::unlock_busy(pIVar1);
        _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
        return 0xe00002c2;
      }
      if ((local_34 != 2) && (param_1[0xf3] == (IOAccelLegacySurface)0x0)) {
        IVar7 = (IOAccelLegacySurface)0x2;
LAB_0001632d:
        lVar4 = 0;
LAB_00016391:
        *(undefined4 *)(param_4 + 4) = local_38;
        *param_4 = lVar4;
        *(uint *)((long)param_4 + 0x24) = (uint)*(ushort *)(this + 0xb0);
        *(uint *)(param_4 + 5) = (uint)*(ushort *)(this + 0xb2);
        uVar2 = *(uint *)(param_1 + 0x11b0) & 0xf;
        *(uint *)((long)param_4 + 0x2c) = uVar2;
        if (uVar2 == 6) {
          uVar3 = 0x79757673;
LAB_000163e4:
          *(undefined4 *)((long)param_4 + 0x2c) = uVar3;
        }
        else {
          if (uVar2 == 10) {
            uVar3 = 4;
            goto LAB_000163e4;
          }
          if (uVar2 == 9) {
            uVar3 = 0x32767579;
            goto LAB_000163e4;
          }
        }
        *(undefined4 *)(param_4 + 6) = *(undefined4 *)(param_1 + 0x1038);
        *(undefined4 *)((long)param_4 + 0x44) = *(undefined4 *)(param_1 + 0x103c);
        *(undefined4 *)(param_4 + 9) = *(undefined4 *)(param_1 + 0x1040);
        *(undefined4 *)((long)param_4 + 0x4c) = *(undefined4 *)(param_1 + 0x1044);
        *(undefined4 *)(param_4 + 10) = *(undefined4 *)(param_1 + 0x1048);
        *(undefined4 *)((long)param_4 + 0x34) = 0x1cccc;
        uVar8 = 0;
        if (IVar7 != (IOAccelLegacySurface)0x0) {
          if (local_34 == 1) {
            param_1[0x10d0] = IVar7;
            pIVar5 = param_1 + 0x10d8;
          }
          else {
            param_1[0x10d1] = IVar7;
            pIVar5 = param_1 + 0x10e0;
          }
          *(IOAccelResource2 **)pIVar5 = this;
          (**(code **)(*(long *)this + 0x20))(this);
        }
        goto LAB_0001645b;
      }
      if (((byte)param_1[0x11b1] & 0x80) == 0) {
        if ((uVar2 & 4) == 0) {
          IVar7 = (IOAccelLegacySurface)0x0;
          lVar4 = IOAccelResource2::lockForCPUAccess
                            (this,*(ulonglong *)(param_1 + 0xe8),local_34,1,(uVar2 & 3) == 0,0,0,
                             &local_38);
          if (lVar4 == 0) goto LAB_0001632d;
          IVar7 = (IOAccelLegacySurface)(((byte)this[0xd] & 0x10) >> 3 | 1);
        }
        else {
          local_38 = 0xbada55;
          lVar4 = 0x13375fc;
          IVar7 = (IOAccelLegacySurface)0x4;
        }
        goto LAB_00016391;
      }
      update_exclusive_bit(param_1,(ulong)*(uint *)(param_1 + 0x1390),'\x01',1);
      pick_present_type(param_1);
    } while (param_1[uVar6] == (IOAccelLegacySurface)0x0);
  }
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Surface is already locked\n",
                    "virtual IOReturn IOAccelLegacySurface::surface_lock_options(enum eLockType, uint32_t, IOAccelSurfaceData *, IOByteCount)"
                   );
  pIVar1 = *(IOGraphicsAccelerator2 **)(param_1 + 0x12c8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return 0xe00002cc;
}



// IOAccelLegacySurface::submit_scanout_swap(unsigned int, unsigned int)

void __thiscall
IOAccelLegacySurface::submit_scanout_swap
          (IOAccelLegacySurface *this,uint param_1,undefined4 param_2)

{
  IOAccelLegacySurface *pIVar1;
  long lVar2;
  long *plVar3;
  long lVar4;
  ulong uVar5;
  uint uVar6;
  
  uVar6 = *(uint *)(this + 0x1190) & 3;
  if (uVar6 != 0) {
    uVar5 = IOAccelSurface::prepare_buffers((IOAccelSurface *)this,uVar6);
    if ((char)uVar5 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Failed to alloc front buffer\n",
                        "void IOAccelLegacySurface::submit_scanout_swap(uint32_t, uint32_t)");
      return;
    }
  }
  lVar2 = *(long *)(this + 0x11c8);
  if (lVar2 != 0) {
    plVar3 = *(long **)(this + 0x11c0);
    if (plVar3 != (long *)0x0) {
      lVar4 = *(long *)(this + (long)(&DAT_00001050 + (ulong)param_1 * 0x10));
      *(long *)(this + 0x1360) = lVar4;
      pIVar1 = this + 0x10e8;
      (**(code **)(*(long *)this + 0xa38))
                (this,pIVar1,lVar2,plVar3,this + 0x1350,param_2,(ulong)param_1,0,lVar4 + 4);
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),pIVar1,
                 (ulong)*(byte *)(lVar2 + 0x15) * 0x40 + *(long *)(lVar2 + 0x38));
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),pIVar1,
                 (ulong)*(byte *)((long)plVar3 + 0x15) * 0x40 + plVar3[7]);
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),pIVar1,
                 (ulong)*(byte *)((long)plVar3 + 0x16) * 0x40 + plVar3[7]);
      (**(code **)(*plVar3 + 0x168))(plVar3,0,0);
    }
  }
  IOAccelSurface::complete_buffers((IOAccelSurface *)this,uVar6);
  return;
}



// IOAccelLegacySurface::submit_swap(unsigned int, unsigned int)

int __thiscall
IOAccelLegacySurface::submit_swap(IOAccelLegacySurface *this,uint param_1,uint param_2)

{
  long lVar1;
  IOAccelLegacySurface *pIVar2;
  byte bVar3;
  char cVar4;
  IOAccelLegacySurface *pIVar5;
  ulong uVar6;
  IOAccelLegacyDisplayPipe *this_00;
  IOAccelLegacySurface *pIVar7;
  long lVar8;
  IOAccelSurface *pIVar9;
  uint uVar10;
  int iVar11;
  uint uVar12;
  IOAccelSurface *this_01;
  undefined1 *local_98;
  undefined1 *local_90;
  undefined1 *local_88;
  undefined1 *local_80;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  IOAccelSurface *local_58;
  uint local_4c;
  ulong local_48;
  IOAccelLegacySurface *local_40;
  uint local_38;
  byte local_31;
  
  pIVar5 = (IOAccelLegacySurface *)
           IOAccelLegacyDisplayMachine::getFullScreenSurface
                     (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),param_1);
  pIVar9 = (IOAccelSurface *)0x0;
  if (pIVar5 != this) {
    pIVar9 = (IOAccelSurface *)pIVar5;
  }
  local_38 = param_2;
  if (pIVar9 == (IOAccelSurface *)0x0) {
    lVar8 = IOAccelLegacyDisplayMachine::getFullScreenSurface
                      (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),param_1);
    if (lVar8 == 0) {
      pIVar5 = (IOAccelLegacySurface *)
               IOAccelLegacyDisplayMachine::getWindowServerFullScreenAssemblySurface
                         (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),param_1);
    }
    else {
      pIVar5 = (IOAccelLegacySurface *)0x0;
    }
  }
  else {
    uVar6 = IOAccelSurface::prepare_buffers(pIVar9,*(uint *)(pIVar9 + 0x1190));
    pIVar5 = (IOAccelLegacySurface *)0x0;
    if ((char)uVar6 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Failed to alloc fullscreen back buffer\n",
                        "uint32_t IOAccelLegacySurface::submit_swap(uint32_t, uint32_t)");
      return 0;
    }
  }
  this_01 = (IOAccelSurface *)0x0;
  if (pIVar5 != this) {
    this_01 = (IOAccelSurface *)pIVar5;
  }
  if ((this_01 != (IOAccelSurface *)0x0) &&
     (uVar6 = IOAccelSurface::prepare_buffers(this_01,*(uint *)(this_01 + 0x1190)),
     (char)uVar6 == '\0')) {
    iVar11 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Failed to alloc fullscreen back buffer\n",
                      "uint32_t IOAccelLegacySurface::submit_swap(uint32_t, uint32_t)");
    if (pIVar9 == (IOAccelSurface *)0x0) {
      return 0;
    }
    uVar12 = *(uint *)(pIVar9 + 0x1190);
    goto LAB_00016b46;
  }
  uVar12 = *(uint *)(this + 0x1190) & 3;
  local_58 = this_01;
  if ((uVar12 != 0) &&
     (uVar6 = IOAccelSurface::prepare_buffers((IOAccelSurface *)this,uVar12), (char)uVar6 == '\0'))
  {
    iVar11 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Failed to alloc front buffer\n",
                      "uint32_t IOAccelLegacySurface::submit_swap(uint32_t, uint32_t)");
    if (pIVar9 != (IOAccelSurface *)0x0) {
      IOAccelSurface::complete_buffers(pIVar9,*(uint *)(pIVar9 + 0x1190));
    }
    if (local_58 == (IOAccelSurface *)0x0) {
      return 0;
    }
    uVar12 = *(uint *)(local_58 + 0x1190);
    pIVar9 = local_58;
    goto LAB_00016b46;
  }
  local_48 = (ulong)param_1;
  this_00 = (IOAccelLegacyDisplayPipe *)
            IOAccelLegacyDisplayMachine::getLegacyDisplayPipe
                      (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),param_1);
  local_31 = IOAccelLegacyDisplayPipe::isAcceleratorBacked(this_00);
  uVar6 = local_48;
  if ((bool)local_31) {
    local_38 = 0;
  }
  uVar10 = 0;
  if (pIVar9 == (IOAccelSurface *)0x0) {
    uVar10 = local_38;
  }
  if ((((byte)this[0x11b1] & 0x84) == 0) && (((byte)this[0x1190] & 1) != 0)) {
    pIVar5 = this + 0x11c0;
  }
  else {
    pIVar5 = this + 0x11c8;
  }
  pIVar5 = *(IOAccelLegacySurface **)pIVar5;
  local_4c = uVar12;
  if (pIVar9 == (IOAccelSurface *)0x0) {
    local_40 = pIVar5;
    cVar4 = IOAccelDisplayMachine::isFramebufferActive
                      (*(IOAccelDisplayMachine **)(this + 0x12d0),(uint)local_48);
    if (cVar4 != '\0') {
      if (((byte)this[0x11b1] & 0x80) == 0) {
        pIVar7 = (IOAccelLegacySurface *)
                 IOAccelDisplayMachine::getFramebufferResource
                           (*(IOAccelDisplayMachine **)(this + 0x13a8),local_48,0);
        pIVar5 = local_40;
      }
      else {
        pIVar7 = *(IOAccelLegacySurface **)(this + 0x11c0);
        pIVar5 = local_40;
      }
      goto LAB_00016892;
    }
    (**(code **)(*(long *)this + 0xa40))(this,uVar6 & 0xffffffff,local_38);
  }
  else {
    pIVar7 = *(IOAccelLegacySurface **)(pIVar9 + 0x11c8);
    if (pIVar7 == (IOAccelLegacySurface *)0x0) {
      pIVar7 = *(IOAccelLegacySurface **)(pIVar9 + 0x11c0);
    }
LAB_00016892:
    if (((pIVar5 != (IOAccelLegacySurface *)0x0) && (pIVar7 != (IOAccelLegacySurface *)0x0)) &&
       (pIVar5 != pIVar7)) {
      lVar8 = *(long *)(this + (long)(&DAT_00001050 + (local_48 & 0xffffffff) * 0x10));
      *(long *)(this + 0x1360) = lVar8;
      local_40 = this + 0x10e8;
      (**(code **)(*(long *)this + 0xa38))
                (this,local_40,pIVar5,pIVar7,this + 0x1350,uVar10,local_48,0,lVar8 + 4);
      pIVar2 = local_40;
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),local_40,
                 (ulong)(byte)pIVar5[0x15] * 0x40 + *(long *)(pIVar5 + 0x38));
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),pIVar2,
                 (ulong)(byte)pIVar7[0x15] * 0x40 + *(long *)(pIVar7 + 0x38));
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),pIVar2,
                 (ulong)(byte)pIVar7[0x16] * 0x40 + *(long *)(pIVar7 + 0x38));
      (**(code **)(*(long *)pIVar7 + 0x168))(pIVar7,0,0);
    }
    uVar12 = local_38;
    uVar6 = local_48;
    uVar10 = (uint)local_48;
    (**(code **)(*(long *)this + 0xa40))(this,local_48 & 0xffffffff,local_38);
    if (pIVar9 != (IOAccelSurface *)0x0) {
      IOAccelSurface::flip_buffers(pIVar9);
      if ((uVar12 >> 0x11 & 1) == 0) {
        IOAccelLegacyDisplayMachine::submit_flip
                  (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),this + 0x10e8,uVar10,uVar12);
      }
      IOAccelSurface::complete_buffers(pIVar9,*(uint *)(pIVar9 + 0x1190));
    }
  }
  bVar3 = local_31;
  pIVar9 = local_58;
  if ((local_58 != (IOAccelSurface *)0x0) &&
     (cVar4 = IOAccelDisplayMachine::isFramebufferActive
                        (*(IOAccelDisplayMachine **)(this + 0x12d0),(uint)uVar6), cVar4 != '\0')) {
    local_60 = &DAT_aaaaaaaaaaaaaaaa;
    local_68 = &DAT_aaaaaaaaaaaaaaaa;
    local_70 = &DAT_aaaaaaaaaaaaaaaa;
    local_78 = &DAT_aaaaaaaaaaaaaaaa;
    local_80 = &DAT_aaaaaaaaaaaaaaaa;
    local_88 = &DAT_aaaaaaaaaaaaaaaa;
    local_90 = &DAT_aaaaaaaaaaaaaaaa;
    local_98 = &DAT_aaaaaaaaaaaaaaaa;
    (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x140))();
    lVar8 = IOAccelDisplayMachine::getFramebufferResource
                      (*(IOAccelDisplayMachine **)(this + 0x12d0),uVar6 & 0xffffffff,0);
    if ((lVar8 != 0) && (lVar1 = *(long *)(pIVar9 + 0x11c8), lVar1 != 0)) {
      (**(code **)(*(long *)this + 0x970))(this,&local_98,lVar8,lVar1);
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_98,
                 (ulong)*(byte *)(lVar8 + 0x15) * 0x40 + *(long *)(lVar8 + 0x38));
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_98,
                 (ulong)*(byte *)(lVar1 + 0x15) * 0x40 + *(long *)(lVar1 + 0x38));
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_98,
                 (ulong)*(byte *)(lVar1 + 0x16) * 0x40 + *(long *)(lVar1 + 0x38));
      (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x148))
                (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_98);
    }
    IOAccelSurface::complete_buffers(pIVar9,*(uint *)(pIVar9 + 0x1190));
  }
  iVar11 = (uint)bVar3 << 0x1c;
  pIVar9 = (IOAccelSurface *)this;
  uVar12 = local_4c;
LAB_00016b46:
  IOAccelSurface::complete_buffers(pIVar9,uVar12);
  return iVar11;
}



// IOAccelLegacySurface::present_surface_with_flip(unsigned int)

ulong __thiscall
IOAccelLegacySurface::present_surface_with_flip(IOAccelLegacySurface *this,uint param_1)

{
  int *piVar1;
  IOAccelLegacySurface IVar2;
  long lVar3;
  uint uVar4;
  ulong uVar5;
  
  IVar2 = this[0x1340];
  uVar4 = 2;
  if (((param_1 & 8) == 0) && (this[0x1341] == (IOAccelLegacySurface)0x0)) {
    uVar4 = *(int *)(this + 0x1350) * 2 & 2;
  }
  (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b0))
            (*(long **)(*(long *)(this + 0x12c8) + 0x380),this + 0x10e8,this + 0x1128);
  uVar5 = IOAccelLegacyDisplayMachine::submit_flip
                    (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),this + 0x10e8,
                     *(uint *)(this + 0x1390),
                     (byte)((byte)((param_1 & 0x10) >> 4) | IVar2 != (IOAccelLegacySurface)0x0) |
                     uVar4);
  lVar3 = *(long *)(this + 0x12c8);
  IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar3 + 0x388) + 0x58),0x28);
  piVar1 = (int *)(lVar3 + 0x240);
  *piVar1 = *piVar1 + 1;
  return uVar5 & 0xffffffff;
}



// IOAccelLegacySurface::copy_forward(unsigned int, IOAccelDeviceRegion*, unsigned long long)

int __thiscall
IOAccelLegacySurface::copy_forward
          (IOAccelLegacySurface *this,undefined4 param_1,uint *param_2,long param_3)

{
  uint uVar1;
  IOGraphicsAccelerator2 *pIVar2;
  int iVar3;
  ulong uVar4;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  
  if (((short)param_2[2] < 0) || (*(short *)((long)param_2 + 10) < 0)) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: bounds width or height invalid, w=%d h=%d\n",
                      "IOReturn IOAccelLegacySurface::copy_forward(uint32_t, IOAccelDeviceRegion *, IOByteCount)"
                      ,(int)(short)param_2[2],(int)*(short *)((long)param_2 + 10));
    iVar3 = -0x1ffffd44;
  }
  else if ((param_3 == 0) || (iVar3 = -0x1ffffd44, (ulong)*param_2 * 8 + 0xc == param_3)) {
    pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
    _OSIncrementAtomic(pIVar2 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar2 + 0x88));
    _OSDecrementAtomic(pIVar2 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar2);
    (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
    if ((*(long *)(this + 0x11c0) == 0) || (*(long *)(this + 0x11c8) == 0)) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Missing one or more required buffers\n",
                        "IOReturn IOAccelLegacySurface::copy_forward(uint32_t, IOAccelDeviceRegion *, IOByteCount)"
                       );
      iVar3 = -0x1ffffd44;
    }
    else {
      uVar1 = *(uint *)(this + 0x1188);
      uVar4 = IOAccelSurface::prepare_buffers((IOAccelSurface *)this,uVar1 & 7);
      iVar3 = -0x1ffffd44;
      if ((char)uVar4 != '\0') {
        local_38 = &DAT_aaaaaaaaaaaaaaaa;
        local_40 = &DAT_aaaaaaaaaaaaaaaa;
        local_48 = &DAT_aaaaaaaaaaaaaaaa;
        local_50 = &DAT_aaaaaaaaaaaaaaaa;
        local_58 = &DAT_aaaaaaaaaaaaaaaa;
        local_60 = &DAT_aaaaaaaaaaaaaaaa;
        local_68 = &DAT_aaaaaaaaaaaaaaaa;
        local_70 = &DAT_aaaaaaaaaaaaaaaa;
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x140))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70);
        iVar3 = (**(code **)(*(long *)this + 0xa50))
                          (this,&local_70,param_1,*(undefined8 *)(this + 0x11c0),
                           *(undefined8 *)(this + 0x11c8),param_2 + 3,*param_2);
        if (iVar3 == 0) {
          (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                     (ulong)*(byte *)(*(long *)(this + 0x11c0) + 0x15) * 0x40 +
                     *(long *)(*(long *)(this + 0x11c0) + 0x38));
          (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                     (ulong)*(byte *)(*(long *)(this + 0x11c8) + 0x15) * 0x40 +
                     *(long *)(*(long *)(this + 0x11c8) + 0x38));
          (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                     (ulong)*(byte *)(*(long *)(this + 0x11c8) + 0x16) * 0x40 +
                     *(long *)(*(long *)(this + 0x11c8) + 0x38));
          (**(code **)(**(long **)(this + 0x11c8) + 0x168))(*(long **)(this + 0x11c8),0,0);
        }
        IOAccelSurface::complete_buffers((IOAccelSurface *)this,uVar1 & 7);
      }
    }
    pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
    (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar2);
    _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
  }
  return iVar3;
}



// IOAccelLegacySurface::did_update(unsigned int, IOAccelDeviceRegion*, unsigned long long)

undefined4 __thiscall
IOAccelLegacySurface::did_update
          (IOAccelLegacySurface *this,undefined4 param_1,uint *param_2,long param_3)

{
  uint uVar1;
  IOGraphicsAccelerator2 *pIVar2;
  undefined4 uVar3;
  ulong uVar4;
  
  if (((short)param_2[2] < 0) || (*(short *)((long)param_2 + 10) < 0)) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: bounds width or height invalid, w=%d h=%d\n",
                      "IOReturn IOAccelLegacySurface::did_update(uint32_t, IOAccelDeviceRegion *, IOByteCount)"
                      ,(int)(short)param_2[2],(int)*(short *)((long)param_2 + 10));
    uVar3 = 0xe00002bc;
  }
  else if ((param_3 == 0) || (uVar3 = 0xe00002bc, (ulong)*param_2 * 8 + 0xc == param_3)) {
    pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
    _OSIncrementAtomic(pIVar2 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar2 + 0x88));
    _OSDecrementAtomic(pIVar2 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar2);
    (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
    uVar1 = *(uint *)(this + 0x1188);
    uVar4 = IOAccelSurface::prepare_buffers((IOAccelSurface *)this,uVar1 & 7);
    uVar3 = 0xe00002be;
    if ((char)uVar4 != '\0') {
      uVar3 = (**(code **)(*(long *)this + 0xa58))(this,param_1,param_2 + 3,*param_2);
      IOAccelSurface::complete_buffers((IOAccelSurface *)this,uVar1 & 7);
    }
    pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
    (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar2);
    _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
  }
  return uVar3;
}



// IOAccelLegacySurface::submitFullScreenUpdate(unsigned int)

void __thiscall
IOAccelLegacySurface::submitFullScreenUpdate(IOAccelLegacySurface *this,uint param_1)

{
  undefined2 uVar1;
  ulong in_RAX;
  undefined8 local_28;
  
  local_28 = in_RAX & 0xffffffff00000000;
  uVar1 = IOAccelDisplayMachine::getFramebufferWidth
                    (*(IOAccelDisplayMachine **)(this + 0x13a8),param_1);
  local_28._0_6_ = CONCAT24(uVar1,(undefined4)local_28);
  uVar1 = IOAccelDisplayMachine::getFramebufferHeight
                    (*(IOAccelDisplayMachine **)(this + 0x13a8),param_1);
  local_28 = CONCAT26(uVar1,(undefined6)local_28);
  (**(code **)(*(long *)this + 0xa58))(this,param_1,&local_28,1);
  return;
}



// IOAccelLegacySurface::set_shape(eIOAccelSurfaceShapeBits, unsigned int, IOAccelDeviceRegion*,
// unsigned long long)

void __thiscall
IOAccelLegacySurface::set_shape
          (IOAccelLegacySurface *this,uint param_1,undefined4 param_2,uint *param_3,long param_4)

{
  if ((param_1 >> 0xc & 1) != 0) {
    copy_forward(this,param_2,param_3,param_4);
    return;
  }
  if ((param_1 >> 0xd & 1) == 0) {
    (**(code **)(*(long *)this + 0xa18))();
    return;
  }
  did_update(this,param_2,param_3,param_4);
  return;
}



// IOAccelLegacySurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, unsigned int,
// unsigned long long, unsigned int, unsigned long long, IOAccelDeviceRegion*, unsigned long long)

undefined8 __thiscall
IOAccelLegacySurface::set_shape_backing_length_ext
          (IOAccelLegacySurface *this,uint param_1,uint param_2,ulong param_3,uint param_4,
          ulong param_5,uint *param_6,ulong param_7)

{
  ulong uVar1;
  int *piVar2;
  undefined2 uVar3;
  ushort uVar4;
  short sVar5;
  IOGraphicsAccelerator2 *pIVar6;
  IOAccelResource2 *this_00;
  char cVar7;
  IOAccelLegacySurface IVar8;
  bool bVar9;
  short sVar10;
  uint uVar11;
  int iVar12;
  uint *puVar13;
  IOAccelLegacyDisplayPipe *pIVar14;
  undefined8 *puVar15;
  ulong uVar16;
  undefined8 uVar17;
  ulong uVar18;
  uint uVar19;
  short sVar20;
  short sVar21;
  uint *puVar22;
  long lVar23;
  ulong uVar24;
  ulong uVar25;
  byte bVar26;
  IOAccelLegacySurface *pIVar27;
  bool bVar28;
  bool bVar29;
  uint local_90 [2];
  undefined8 local_88;
  undefined4 local_80;
  ulong local_78;
  IOAccelLegacySurface *local_70;
  long local_68;
  long local_60;
  ulong local_58;
  undefined4 local_4c;
  ulong local_48;
  uint local_3c;
  uint *local_38;
  
  local_88 = 0;
  local_90[0] = 0;
  local_90[1] = 0;
  local_80 = 0;
  local_78 = param_5;
  uVar11 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x12d0));
  if (uVar11 <= param_2) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Bad frame buffer index\n",
                      "virtual IOReturn IOAccelLegacySurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                     );
    return 0xe00002bc;
  }
  local_58 = param_3;
  local_48 = (ulong)param_4;
  if (param_7 == 0) {
    local_38 = local_90;
  }
  else {
    if (param_7 < 0xc) {
      return 0xe00002bc;
    }
    if ((ulong)*param_6 * 8 + 0xc != param_7) {
      return 0xe00002bc;
    }
    sVar20 = (short)param_6[2];
    if ((sVar20 < 0) || (*(short *)((long)param_6 + 10) < 0)) {
LAB_0001734b:
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: bounds width or height invalid, w=%d h=%d\n",
                        "virtual IOReturn IOAccelLegacySurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                        ,(int)sVar20,(int)*(short *)((long)param_6 + 10));
      return 0xe00002bc;
    }
    local_38 = param_6;
    cVar7 = (**(code **)(*(long *)this + 0x988))
                      (this,(int)sVar20,(int)*(short *)((long)param_6 + 10));
    sVar20 = (short)param_6[2];
    if (cVar7 == '\0') goto LAB_0001734b;
    if ((sVar20 == 0) || (*(short *)((long)param_6 + 10) == 0)) {
      param_6[2] = 0x10001;
      local_48 = 0;
      local_58 = 0;
    }
  }
  pIVar6 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
  _OSIncrementAtomic(pIVar6 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar6 + 0x88));
  _OSDecrementAtomic(pIVar6 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar6);
  (**(code **)(*(long *)pIVar6 + 0x850))(pIVar6,"",0);
  uVar16 = (ulong)param_1;
  if ((param_1 & 0x80) != 0) {
    IOGraphicsAccelerator2::acceleratorWaitEnabled(*(IOGraphicsAccelerator2 **)(this + 0x12c8));
  }
  uVar11 = (uint)local_48;
  if ((this[0x10d0] != (IOAccelLegacySurface)0x0) || (this[0x10d1] != (IOAccelLegacySurface)0x0)) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Deadlock.  SetSurfaceShape called with buffer locked.\n",
                      "virtual IOReturn IOAccelLegacySurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                     );
    uVar17 = 0xe00002cc;
    goto LAB_0001729f;
  }
  puVar13 = *(uint **)(this + 0x11b0);
  if (((ulong)puVar13 & 0x20) == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Called on full screen surface.\n",
                      "virtual IOReturn IOAccelLegacySurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                     );
    uVar17 = 0xe00002bc;
    goto LAB_0001729f;
  }
  *(uint *)(this + 0x1170) = param_1;
  bVar28 = (*(uint *)(this + 0x1350) & 2) != 0;
  local_3c = param_1;
  bVar29 = (param_1 & 4) != 0;
  if (bVar29 && bVar28) {
    this[0x1005] = (IOAccelLegacySurface)0x0;
    *(uint *)(this + 0x1350) = *(uint *)(this + 0x1350) & 0xfffffffd;
  }
  if ((param_1 >> 0xe & 1) != 0) {
    if (*(uint *)(this + 0x1168) < 0x100) {
      cVar7 = IOAccelDisplayMachine::isFramebufferActive
                        (*(IOAccelDisplayMachine **)(this + 0x13a8),param_2);
      if (cVar7 != '\0') {
        pIVar14 = (IOAccelLegacyDisplayPipe *)
                  IOAccelLegacyDisplayMachine::getLegacyDisplayPipe
                            (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),param_2);
        bVar9 = IOAccelLegacyDisplayPipe::isAcceleratorBacked(pIVar14);
        if (bVar9) {
          this[0x138c] = (IOAccelLegacySurface)0x1;
          *(uint *)(this + 0x139c) = param_2;
          pIVar14 = (IOAccelLegacyDisplayPipe *)
                    IOAccelLegacyDisplayMachine::getLegacyDisplayPipe
                              (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),param_2);
          IOAccelLegacyDisplayPipe::set_windowserver_scanout_surface(pIVar14,this);
          lVar23 = IOAccelLegacyDisplayMachine::getScanoutResource
                             (*(long *)(this + 0x13a8),(ulong)param_2);
          uVar3 = *(undefined2 *)(lVar23 + 0xb0);
          local_88 = CONCAT62(local_88._2_6_,uVar3);
          lVar23 = IOAccelLegacyDisplayMachine::getScanoutResource
                             (*(long *)(this + 0x13a8),(ulong)param_2);
          uVar4 = *(ushort *)(lVar23 + 0xb2);
          puVar13 = (uint *)(ulong)uVar4;
          local_90[0] = 1;
          local_88 = (ulong)CONCAT22(uVar4,(undefined2)local_88);
          local_80 = CONCAT22(uVar4,uVar3);
          puVar22 = local_90;
          goto LAB_000176a6;
        }
      }
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Tried to set up scanout surface on non-active framebuffer index %d\n\n"
                        ,
                        "virtual IOReturn IOAccelLegacySurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                        ,param_2);
    }
    else {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Tried to set up scanout surface for non-WindowServer surface\n\n",
                        "virtual IOReturn IOAccelLegacySurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                       );
    }
    uVar17 = 0xe00002bc;
LAB_00017994:
    uVar16 = (ulong)local_3c;
    goto LAB_0001729f;
  }
  puVar22 = local_38;
  if ((((ulong)puVar13 & 0xc00) != 0) &&
     (puVar13 = (uint *)IOAccelDisplayMachine::isFramebufferActive
                                  (*(IOAccelDisplayMachine **)(this + 0x13a8),param_2),
     puVar22 = local_38, (char)puVar13 != '\0')) {
    local_60 = CONCAT44(local_60._4_4_,(int)(short)local_38[2]);
    puVar13 = (uint *)IOAccelDisplayMachine::getFramebufferWidth
                                (*(IOAccelDisplayMachine **)(this + 0x13a8),param_2);
    if (((int)puVar13 == (int)local_60) &&
       ((((sVar20 = *(short *)((long)puVar22 + 10),
          puVar13 = (uint *)IOAccelDisplayMachine::getFramebufferHeight
                                      (*(IOAccelDisplayMachine **)(this + 0x13a8),param_2),
          puVar22 = local_38, (int)puVar13 == (int)sVar20 &&
          (IVar8 = this[0x1342],
          puVar13 = (uint *)IOAccelLegacyDisplayMachine::getFramebufferPixelBytes
                                      (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),param_2),
          puVar22 = local_38, (uint)puVar13 == (uint)(byte)IVar8)) &&
         (IVar8 = this[0x1342],
         puVar13 = (uint *)IOAccelLegacyDisplayMachine::getFramebufferPixelBytes
                                     (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),param_2),
         puVar22 = local_38, (uint)puVar13 == (uint)(byte)IVar8)) && (((byte)this[0x1170] & 2) == 0)
        ))) {
      if (((((this[0x1343] == (IOAccelLegacySurface)0x1) && (puVar13 = local_38, *local_38 == 1)) &&
           ((short)local_38[3] == 0)) &&
          ((*(short *)((long)local_38 + 0xe) == 0 &&
           (uVar11 = local_38[4],
           puVar13 = (uint *)IOAccelDisplayMachine::getFramebufferWidth
                                       (*(IOAccelDisplayMachine **)(this + 0x13a8),param_2),
           (int)puVar13 == (int)(short)uVar11)))) &&
         (sVar20 = *(short *)((long)local_38 + 0x12),
         puVar13 = (uint *)IOAccelDisplayMachine::getFramebufferHeight
                                     (*(IOAccelDisplayMachine **)(this + 0x13a8),param_2),
         (int)puVar13 == (int)sVar20)) {
        *(uint *)(this + 0x1394) = param_2;
        pIVar14 = (IOAccelLegacyDisplayPipe *)
                  IOAccelLegacyDisplayMachine::getLegacyDisplayPipe
                            (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),param_2);
        puVar13 = (uint *)IOAccelLegacyDisplayPipe::set_windowserver_fullscreen_assembly_surface
                                    (pIVar14,this);
      }
      uVar11 = (uint)local_48;
      puVar22 = local_38;
    }
  }
LAB_000176a6:
  if ((bVar29 && bVar28) ||
     ((((byte)this[0x1350] & 2) == 0 &&
      ((puVar13 = (uint *)(ulong)*(ushort *)(this + 0x11bc),
       *(ushort *)(this + 0x11bc) != (ushort)puVar22[2] ||
       (puVar13 = (uint *)(ulong)*(ushort *)(this + 0x11be),
       *(ushort *)(this + 0x11be) != *(ushort *)((long)puVar22 + 10))))))) {
    local_4c = (undefined4)CONCAT71((int7)((ulong)puVar13 >> 8),1);
  }
  else {
    local_4c = 0;
  }
  lVar23 = (ulong)param_2 * 0x10;
  pIVar27 = this + lVar23 + 0x1050;
  uVar19 = (uint)param_7;
  if ((*(uint *)(this + lVar23 + 0x1058) < param_7) ||
     ((uVar19 & 0xffffff00) != (*(uint *)(this + lVar23 + 0x1058) & 0xffffff00))) {
    local_60 = lVar23;
    local_38 = puVar22;
    puVar15 = (undefined8 *)_IOMallocData();
    if (puVar15 == (undefined8 *)0x0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Failed to alloc region\n",
                        "virtual IOReturn IOAccelLegacySurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                       );
      uVar17 = 0xe00002be;
      goto LAB_00017994;
    }
    local_70 = this + local_60 + 0x1058;
    lVar23 = *(long *)(this + 0x12c8);
    if (lVar23 != 0) {
      local_68 = lVar23;
      IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar23 + 0x388) + 0x58),0x51);
      *(int *)(local_68 + 0x2e4) = *(int *)(local_68 + 0x2e4) + uVar19;
    }
    _IOFreeData(*(long *)pIVar27,*(uint *)local_70);
    lVar23 = *(long *)(this + 0x12c8);
    if (lVar23 != 0) {
      local_68 = CONCAT44(local_68._4_4_,*(uint *)local_70);
      IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar23 + 0x388) + 0x58),0x51);
      *(int *)(lVar23 + 0x2e4) = *(int *)(lVar23 + 0x2e4) - (int)local_68;
    }
    *(undefined8 **)pIVar27 = puVar15;
    *(uint *)local_70 = uVar19;
    puVar22 = local_38;
    lVar23 = local_60;
  }
  else {
    puVar15 = *(undefined8 **)pIVar27;
  }
  uVar1 = local_58;
  *(uint *)(puVar15 + 1) = puVar22[2];
  *puVar15 = *(undefined8 *)puVar22;
  if (*puVar22 == 0) {
LAB_00017830:
    this[(long)(&DAT_0000105c + lVar23)] = (IOAccelLegacySurface)0x0;
    bVar28 = false;
LAB_0001783f:
    bVar29 = bVar28;
    IVar8 = (IOAccelLegacySurface)0x1;
  }
  else {
    uVar16 = 0;
    do {
      *(undefined8 *)(*(long *)pIVar27 + 0xc + uVar16 * 8) =
           *(undefined8 *)(puVar22 + uVar16 * 2 + 3);
      uVar16 = uVar16 + 1;
    } while (uVar16 < *puVar22);
    if (*puVar22 != 1) goto LAB_00017830;
    uVar19 = puVar22[4];
    if (((short)uVar19 == 0) || (*(short *)((long)puVar22 + 0x12) == 0)) {
      this[(long)(&DAT_0000105c + lVar23)] = (IOAccelLegacySurface)0x1;
    }
    else {
      this[(long)(&DAT_0000105c + lVar23)] = (IOAccelLegacySurface)0x0;
    }
    bVar28 = true;
    if ((((0xff < *(uint *)(this + 0x1168)) || (bVar28 = true, (short)puVar22[2] != 1)) ||
        (*(short *)((long)puVar22 + 10) != 1)) || ((short)uVar19 != 0)) goto LAB_0001783f;
    bVar29 = true;
    bVar28 = true;
    if (*(short *)((long)puVar22 + 0x12) != 0) goto LAB_0001783f;
    IVar8 = (IOAccelLegacySurface)0x0;
  }
  uVar16 = (ulong)local_3c;
  this[0xf0] = IVar8;
  if (((byte)this[0x1350] & 2) == 0) {
    *(short *)(this + 0x11bc) = (short)puVar22[2];
    *(undefined2 *)(this + 0x11be) = *(undefined2 *)((long)puVar22 + 10);
  }
  if (bVar29 && local_58 != 0) {
    sVar20 = (short)puVar22[4];
    sVar21 = *(short *)((long)puVar22 + 0x12);
    sVar10 = *(short *)(this + 0x11bc);
    sVar5 = *(short *)(this + 0x11be);
  }
  else {
    sVar20 = *(short *)(this + 0x11bc);
    sVar21 = *(short *)(this + 0x11be);
    sVar10 = sVar20;
    sVar5 = sVar21;
  }
  *(short *)(this + 0x11b8) = sVar20;
  *(short *)(this + 0x11ba) = sVar21;
  cVar7 = (**(code **)(*(long *)this + 0x988))(this,(int)sVar10,(int)sVar5);
  if (cVar7 == '\0') {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: bounds are too big\n",
                      "virtual IOReturn IOAccelLegacySurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                     );
    this[0x118c] = (IOAccelLegacySurface)0x1;
    uVar17 = 0xe00002be;
    goto LAB_0001729f;
  }
  bVar28 = false;
  bVar26 = (byte)local_4c;
  if (uVar11 != 0xffffffff) {
    if (((uVar11 == 0) || (uVar1 == 0)) || ((*(uint *)(this + 0x1190) & 3) != 0)) {
      if ((this[0x10d0] != (IOAccelLegacySurface)0x3) &&
         (bVar28 = false, this[0x10d1] != (IOAccelLegacySurface)0x3)) goto LAB_00017a16;
      bVar28 = false;
      if (((byte)this[0x1190] & 1) != 0) {
        IOAccelSurface::detach_buffer_at_index((IOAccelSurface *)this,0);
        this[0x11a0] = (IOAccelLegacySurface)((byte)this[0x11a0] & 0xfe);
        bVar28 = true;
      }
    }
    else {
      *(uint *)(this + 0x1190) = *(uint *)(this + 0x1190) | 1;
      bVar28 = true;
    }
    (**(code **)(*(long *)this + 0x9e0))(this);
  }
LAB_00017a16:
  uVar17 = update_exclusive_bit(this,(ulong)param_2,'\0',bVar26);
  if ((char)uVar17 == '\0') {
    if (bVar26 == 0) {
      uVar16 = IOAccelSurface::update_displayable((IOAccelSurface *)this);
      if ((bVar28) && ((char)uVar16 == '\0')) {
        (**(code **)(*(long *)this + 0x9d8))(this);
      }
    }
    else {
      this[0xf3] = (IOAccelLegacySurface)0x0;
      (**(code **)(*(long *)this + 0x9d8))(this);
      IOAccelSurface::update_contexts((IOAccelSurface *)this);
    }
  }
  pick_present_type(this);
  uVar19 = local_3c;
  if ((*(uint *)(this + 0x1168) < 0x100) && ((*(uint *)(this + 0x1190) & 2) != 0)) {
    pIVar27 = this + 0x11c8;
  }
  else {
    uVar17 = 0;
    uVar16 = (ulong)local_3c;
    if ((*(uint *)(this + 0x1190) & 1) == 0) goto LAB_0001729f;
    pIVar27 = this + 0x11c0;
  }
  uVar16 = (ulong)local_3c;
  uVar17 = 0;
  if ((uVar11 != 0xffffffff) &&
     (this_00 = *(IOAccelResource2 **)pIVar27, this_00 != (IOAccelResource2 *)0x0)) {
    if (*(long *)(this_00 + 0x80) != 0) {
      IOAccelResource2::deleteBackingMemory(this_00);
    }
    if ((uVar11 != 0) && (uVar17 = 0, local_58 != 0)) {
      if ((local_78 == 0) &&
         (local_78 = (ulong)*(ushort *)(this_00 + 0xb2) * (ulong)uVar11 & 0xffffffff,
         (int)((ulong)*(ushort *)(this_00 + 0xb2) * (ulong)uVar11 >> 0x20) != 0)) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: size overflow\n",
                          "virtual IOReturn IOAccelLegacySurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                         );
      }
      else {
        uVar1 = *(long *)PTR__page_size_0006b108 - 1;
        uVar11 = (uint)local_58;
        uVar24 = (local_78 & 0xffffffff) + (ulong)((uint)uVar1 & uVar11);
        if (!CARRY8(uVar24,uVar1)) {
          uVar18 = -*(long *)PTR__page_size_0006b108;
          uVar25 = local_58 & uVar18;
          lVar23 = IOAccelSysMemory::withClientBuffer
                             (*(long **)(this + 0x12c8),*(undefined8 *)(this + 0xe8),0,uVar25,
                              uVar24 + uVar1 & uVar18);
          if (lVar23 == 0) {
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: bad backing\n",
                              "virtual IOReturn IOAccelLegacySurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                             );
            uVar17 = 0xe00002c8;
          }
          else {
            if ((uVar19 & 0x20) == 0) {
              this[0xf3] = (IOAccelLegacySurface)0x1;
            }
            IOAccelResource2::setBackingMemory
                      (this_00,lVar23,uVar11 - (int)uVar25,(int)local_48,
                       (uint)((uVar19 & 0x20) == 0));
            uVar17 = 0;
          }
          goto LAB_0001729f;
        }
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: size overflow\n",
                          "virtual IOReturn IOAccelLegacySurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                         );
      }
      uVar17 = 0xe0000001;
    }
  }
LAB_0001729f:
  this[0x1341] = SUB41(((uint)uVar16 & 8) >> 3,0);
  IVar8 = (IOAccelLegacySurface)0x1;
  if (((uVar16 & 8) == 0) && (((byte)this[0x1350] & 1) == 0)) {
    IVar8 = (IOAccelLegacySurface)((byte)(uVar16 >> 4) & 1);
  }
  this[0x1340] = IVar8;
  if ((uVar16 & 1) == 0) {
    iVar12 = (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x188))
                       (*(long **)(*(long *)(this + 0x12c8) + 0x380),this + 0x10e8);
    lVar23 = *(long *)(this + 0x12c8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar23 + 0x388) + 0x58),0x3b);
    piVar2 = (int *)(lVar23 + 0x28c);
    *piVar2 = *piVar2 + iVar12;
  }
  pIVar6 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
  (**(code **)(*(long *)pIVar6 + 0x858))(pIVar6,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar6);
  _IOLockUnlock(*(undefined8 *)(pIVar6 + 0x88));
  return uVar17;
}



// IOAccelLegacySurface::set_scaling(unsigned int, IOAccelSurfaceScaling*)

undefined8 __thiscall
IOAccelLegacySurface::set_scaling(IOAccelLegacySurface *this,uint param_1,undefined2 *param_2)

{
  short sVar1;
  long lVar2;
  ulong uVar3;
  short sVar4;
  IOAccelLegacySurface IVar5;
  char cVar6;
  short sVar7;
  byte bVar8;
  undefined8 uVar9;
  
  if (((param_1 & 2) != 0) && (param_2 == (undefined2 *)0x0)) {
    return 0xe00002c2;
  }
  IVar5 = (IOAccelLegacySurface)0x1;
  if (this[0x1340] == (IOAccelLegacySurface)0x0) {
    IVar5 = (IOAccelLegacySurface)((byte)this[0x1350] & 1);
  }
  this[0x1340] = IVar5;
  if ((param_1 & 2) != 0) {
    uVar3 = *(ulong *)(this + 0x11b0);
    if ((uVar3 & 0x20) == 0) {
      *(undefined4 *)(this + 0x11b8) = *(undefined4 *)(this + 0x11bc);
      uVar9 = 0xe00002bc;
      if (((byte)this[0x1350] & 2) == 0) {
        return 0xe00002bc;
      }
      bVar8 = 0;
    }
    else {
      this[0x1005] = (IOAccelLegacySurface)0x1;
      *(uint *)(this + 0x1350) = param_1;
      sVar1 = param_2[2];
      if (*(short *)(this + 0x11bc) == sVar1) {
        sVar7 = *(short *)(this + 0x11be);
        sVar4 = param_2[3];
        if (sVar7 != param_2[3]) goto LAB_00017d1f;
        bVar8 = 0;
      }
      else {
        sVar4 = param_2[3];
LAB_00017d1f:
        sVar7 = sVar4;
        bVar8 = 1;
      }
      *(short *)(this + 0x11bc) = sVar1;
      *(short *)(this + 0x11be) = sVar7;
      *(undefined2 *)(this + 0x1354) = *param_2;
      *(undefined2 *)(this + 0x1356) = param_2[1];
      *(undefined2 *)(this + 0x1358) = param_2[4];
      *(undefined2 *)(this + 0x135a) = param_2[5];
      *(short *)(this + 0x11b8) = sVar1;
      *(short *)(this + 0x11ba) = sVar7;
      uVar9 = 0;
    }
    if (*(uint *)(this + 0x1344) != 0xffff) {
      update_exclusive_bit(this,(ulong)*(uint *)(this + 0x1344),'\0',bVar8);
    }
    if ((uVar3 & 0x20) == 0) {
      return uVar9;
    }
    goto LAB_00017d94;
  }
  this[0x1005] = (IOAccelLegacySurface)0x0;
  *(uint *)(this + 0x1350) = param_1;
  lVar2 = *(long *)(this + 0x1050);
  sVar1 = *(short *)(lVar2 + 8);
  if (*(short *)(this + 0x11bc) == sVar1) {
    sVar7 = *(short *)(this + 0x11be);
    sVar4 = *(short *)(lVar2 + 10);
    if (sVar7 != *(short *)(lVar2 + 10)) goto LAB_00017cc6;
    bVar8 = 0;
  }
  else {
    sVar4 = *(short *)(lVar2 + 10);
LAB_00017cc6:
    sVar7 = sVar4;
    bVar8 = 1;
  }
  *(short *)(this + 0x11bc) = sVar1;
  *(short *)(this + 0x11be) = sVar7;
  *(short *)(this + 0x11b8) = sVar1;
  *(short *)(this + 0x11ba) = sVar7;
LAB_00017d94:
  if (bVar8 != 0) {
    this[0xf3] = (IOAccelLegacySurface)0x0;
  }
  (**(code **)(*(long *)this + 0x9d8))(this);
  pick_present_type(this);
  IOAccelSurface::update_contexts((IOAccelSurface *)this);
  this[0x118c] = (IOAccelLegacySurface)0x0;
  cVar6 = (**(code **)(*(long *)this + 0x988))
                    (this,(int)*(short *)(this + 0x11bc),(int)*(short *)(this + 0x11be));
  uVar9 = 0;
  if (cVar6 == '\0') {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: bounds are too big\n",
                      "virtual IOReturn IOAccelLegacySurface::set_scaling(IOOptionBits, IOAccelSurfaceScaling *)"
                     );
    this[0x118c] = (IOAccelLegacySurface)0x1;
    uVar9 = 0xe00002be;
  }
  return uVar9;
}



// IOAccelLegacySurface::get_current_backbuffer_index()

undefined8 __thiscall IOAccelLegacySurface::get_current_backbuffer_index(IOAccelLegacySurface *this)

{
  undefined8 uVar1;
  long lVar2;
  
  if ((*(uint *)(this + 0x1190) & 4) == 0) {
    if ((*(uint *)(this + 0x1190) & 2) == 0) {
      return 0;
    }
    lVar2 = *(long *)(this + 0x11c8);
  }
  else {
    if ((*(long *)(this + 0x11c8) != 0) && ((*(byte *)(*(long *)(this + 0x11c8) + 0xc) & 0x10) != 0)
       ) {
      return 2;
    }
    lVar2 = *(long *)(this + 0x11d0);
  }
  if ((lVar2 == 0) || (uVar1 = 1, (*(byte *)(lVar2 + 0xc) & 0x10) == 0)) {
    uVar1 = 0;
  }
  return uVar1;
}



// IOAccelLegacySurface::surface_control_with_lock(unsigned int, unsigned int, unsigned int*)

undefined8 __thiscall
IOAccelLegacySurface::surface_control_with_lock
          (IOAccelLegacySurface *this,undefined8 param_2_00,int param_2,uint *param_3)

{
  byte bVar1;
  uint uVar2;
  undefined8 uVar3;
  
  switch((int)param_2_00) {
  case 0x10:
    if (((((byte)this[0x1190] & 4) == 0) ||
        (((*(int *)(this + 0x1390) == 0xffff && (*(int *)(this + 0x1398) == 0xffff)) ||
         (((byte)this[0x11b1] & 0x80) == 0)))) ||
       ((*(long *)(this + 0x11c8) == 0 || (*(long *)(this + 0x11d0) == 0)))) goto LAB_00017f18;
    bVar1 = (**(code **)(*(long *)this + 0xa48))(this,param_2);
    uVar2 = (uint)bVar1;
    break;
  case 0x11:
    if ((*(uint *)(this + 0x1190) & 4) != 0) {
      *param_3 = 3;
      return 0;
    }
    if ((*(uint *)(this + 0x1190) & 2) != 0) {
      *param_3 = 2;
      return 0;
    }
LAB_00017f18:
    *param_3 = 1;
    return 0;
  case 0x12:
    uVar3 = get_current_backbuffer_index(this);
    *param_3 = (uint)uVar3;
    if (this[0x138d] == (IOAccelLegacySurface)0x0) {
      return 0;
    }
    if (((byte)this[0x11b1] & 0x80) == 0) {
      return 0;
    }
    this[0x138d] = (IOAccelLegacySurface)0x0;
    uVar2 = (uint)uVar3 | 0x80000000;
    break;
  case 0x13:
    uVar2 = IOAccelSurface::getFrontBufferResourceId((IOAccelSurface *)this);
    break;
  default:
    uVar3 = IOAccelSurface::surface_control_with_lock
                      ((IOAccelSurface *)this,(int)param_2_00,param_2,param_3);
    return uVar3;
  }
  *param_3 = uVar2;
  return 0;
}



// IOAccelLegacySurface::isBackBufferReady(unsigned int)

undefined1 IOAccelLegacySurface::isBackBufferReady(void)

{
  return 1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelLegacySurface::is_back_buffer_ready()

undefined8 __cdecl
IOAccelLegacySurface::is_back_buffer_ready(long *param_1,undefined8 param_2,undefined8 param_3)

{
  int iVar1;
  undefined8 in_RAX;
  undefined8 uVar2;
  
  if ((((*(byte *)(param_1 + 0x232) & 4) != 0) &&
      ((((int)param_1[0x272] != 0xffff || ((int)param_1[0x273] != 0xffff)) &&
       ((*(byte *)((long)param_1 + 0x11b1) & 0x80) != 0)))) &&
     ((param_1[0x239] != 0 && (param_1[0x23a] != 0)))) {
    iVar1 = (int)param_1[0x272];
    if ((int)param_1[0x273] != 0xffff) {
      iVar1 = (int)param_1[0x273];
    }
                    // WARNING: Could not recover jumptable at 0x00017fe5. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar2 = (**(code **)(*param_1 + 0xa48))(param_1,iVar1,param_3,*(code **)(*param_1 + 0xa48));
    return uVar2;
  }
  return CONCAT71((int7)((ulong)in_RAX >> 8),1);
}



// IOAccelLegacySurface::enter_scanout_mode(unsigned int)

void __thiscall
IOAccelLegacySurface::enter_scanout_mode(IOAccelLegacySurface *this,undefined4 param_1)

{
  *(undefined4 *)(this + 0x1398) = param_1;
  if (*(int *)(this + 0x133c) != 0) {
    this[0x1190] = (IOAccelLegacySurface)((byte)this[0x1190] | 4);
  }
  (**(code **)(*(long *)this + 0x9e0))(this);
  (**(code **)(*(long *)this + 0x9d8))(this);
  pick_present_type(this);
  IOAccelLegacyDisplayMachine::setup_scanout
            (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),(long)this);
  IOAccelSurface::update_contexts((IOAccelSurface *)this);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelLegacySurface::leave_scanout_mode(unsigned int)

void __cdecl IOAccelLegacySurface::leave_scanout_mode(IOAccelLegacySurface *param_1)

{
  leave_assembly_fullscreen(param_1);
  IOAccelLegacyDisplayMachine::reset_scanout
            (*(IOAccelLegacyDisplayMachine **)(param_1 + 0x13a8),*(uint *)(param_1 + 0x1398));
  *(undefined4 *)(param_1 + 0x1398) = 0xffff;
  pick_present_type(param_1);
  return;
}



// IOAccelLegacySurface::enter_exclusive_mode(unsigned int, bool)

void __thiscall
IOAccelLegacySurface::enter_exclusive_mode
          (IOAccelLegacySurface *this,undefined4 param_1,int param_2)

{
  long *plVar1;
  char cVar2;
  long *plVar3;
  long *plVar4;
  long *plVar5;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  
  if (param_2 == 0) {
    if ((*(uint *)(this + 0x1190) & 2) == 0) {
      plVar5 = (long *)0x0;
    }
    else {
      plVar5 = *(long **)(this + 0x11c8);
    }
    if ((*(uint *)(this + 0x1190) & 4) == 0) {
      plVar4 = (long *)0x0;
    }
    else {
      plVar4 = *(long **)(this + 0x11d0);
    }
    if (plVar5 != (long *)0x0) {
      (**(code **)(*plVar5 + 0x20))(plVar5);
    }
    if (plVar4 != (long *)0x0) {
      (**(code **)(*plVar4 + 0x20))(plVar4);
      goto LAB_000180e7;
    }
  }
  else {
    plVar5 = (long *)0x0;
  }
  plVar4 = (long *)0x0;
LAB_000180e7:
  *(undefined4 *)(this + 0x1390) = param_1;
  if (*(int *)(this + 0x133c) != 0) {
    this[0x1190] = (IOAccelLegacySurface)((byte)this[0x1190] | 4);
  }
  (**(code **)(*(long *)this + 0x9e0))(this);
  (**(code **)(*(long *)this + 0x9d8))(this);
  pick_present_type(this);
  if (this[0x138c] == (IOAccelLegacySurface)0x0) {
    plVar3 = (long *)IOAccelDisplayMachine::getFramebufferResource
                               (*(IOAccelDisplayMachine **)(this + 0x13a8),
                                (ulong)*(uint *)(this + 0x1390),0);
  }
  else {
    plVar3 = (long *)IOAccelLegacyDisplayMachine::getScanoutResource
                               ((long)*(IOAccelDisplayMachine **)(this + 0x13a8),
                                (ulong)*(uint *)(this + 0x1398));
  }
  if ((((plVar3 != (long *)0x0) && (plVar1 = *(long **)(this + 0x11c0), plVar1 != (long *)0x0)) &&
      (plVar3 != plVar1)) && (((((ushort *)plVar1[6])[6] | *(ushort *)plVar1[6]) & 1) == 0)) {
    cVar2 = (**(code **)(*plVar3 + 0x170))(plVar3);
    if (cVar2 != '\0') {
      cVar2 = (**(code **)(**(long **)(this + 0x11c0) + 0x170))();
      if (cVar2 != '\0') {
        local_38 = &DAT_aaaaaaaaaaaaaaaa;
        local_40 = &DAT_aaaaaaaaaaaaaaaa;
        local_48 = &DAT_aaaaaaaaaaaaaaaa;
        local_50 = &DAT_aaaaaaaaaaaaaaaa;
        local_58 = &DAT_aaaaaaaaaaaaaaaa;
        local_60 = &DAT_aaaaaaaaaaaaaaaa;
        local_68 = &DAT_aaaaaaaaaaaaaaaa;
        local_70 = &DAT_aaaaaaaaaaaaaaaa;
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x140))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70);
        (**(code **)(*(long *)this + 0x970))(this,&local_70,plVar3,*(undefined8 *)(this + 0x11c0));
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                   (ulong)*(byte *)((long)plVar3 + 0x15) * 0x40 + plVar3[7]);
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                   (ulong)*(byte *)(*(long *)(this + 0x11c0) + 0x15) * 0x40 +
                   *(long *)(*(long *)(this + 0x11c0) + 0x38));
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                   (ulong)*(byte *)(*(long *)(this + 0x11c0) + 0x16) * 0x40 +
                   *(long *)(*(long *)(this + 0x11c0) + 0x38));
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x148))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70);
        (**(code **)(**(long **)(this + 0x11c0) + 0x168))(*(long **)(this + 0x11c0),0,0);
        (**(code **)(**(long **)(this + 0x11c0) + 0x178))();
      }
      (**(code **)(*plVar3 + 0x178))(plVar3);
    }
  }
  if (plVar5 != (long *)0x0) {
    local_38 = &DAT_aaaaaaaaaaaaaaaa;
    local_40 = &DAT_aaaaaaaaaaaaaaaa;
    local_48 = &DAT_aaaaaaaaaaaaaaaa;
    local_50 = &DAT_aaaaaaaaaaaaaaaa;
    local_58 = &DAT_aaaaaaaaaaaaaaaa;
    local_60 = &DAT_aaaaaaaaaaaaaaaa;
    local_68 = &DAT_aaaaaaaaaaaaaaaa;
    local_70 = &DAT_aaaaaaaaaaaaaaaa;
    (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x140))();
    if (((((byte)this[0x1190] & 2) != 0) && (*(long **)(this + 0x11c8) != (long *)0x0)) &&
       (plVar5 != *(long **)(this + 0x11c8))) {
      cVar2 = (**(code **)(*plVar5 + 0x170))(plVar5);
      if (cVar2 != '\0') {
        cVar2 = (**(code **)(**(long **)(this + 0x11c8) + 0x170))();
        if (cVar2 != '\0') {
          (**(code **)(*(long *)this + 0x970))(this,&local_70,plVar5,*(undefined8 *)(this + 0x11c8))
          ;
          (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                     (ulong)*(byte *)((long)plVar5 + 0x15) * 0x40 + plVar5[7]);
          (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                     (ulong)*(byte *)(*(long *)(this + 0x11c8) + 0x15) * 0x40 +
                     *(long *)(*(long *)(this + 0x11c8) + 0x38));
          (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                     (ulong)*(byte *)(*(long *)(this + 0x11c8) + 0x16) * 0x40 +
                     *(long *)(*(long *)(this + 0x11c8) + 0x38));
          (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x148))
                    (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70);
          (**(code **)(**(long **)(this + 0x11c8) + 0x168))(*(long **)(this + 0x11c8),0,0);
          (**(code **)(**(long **)(this + 0x11c8) + 0x178))();
        }
        (**(code **)(*plVar5 + 0x178))(plVar5);
      }
    }
    (**(code **)(*plVar5 + 0x28))(plVar5);
  }
  if (plVar4 != (long *)0x0) {
    local_38 = &DAT_aaaaaaaaaaaaaaaa;
    local_40 = &DAT_aaaaaaaaaaaaaaaa;
    local_48 = &DAT_aaaaaaaaaaaaaaaa;
    local_50 = &DAT_aaaaaaaaaaaaaaaa;
    local_58 = &DAT_aaaaaaaaaaaaaaaa;
    local_60 = &DAT_aaaaaaaaaaaaaaaa;
    local_68 = &DAT_aaaaaaaaaaaaaaaa;
    local_70 = &DAT_aaaaaaaaaaaaaaaa;
    (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x140))();
    if (((((byte)this[0x1190] & 4) != 0) && (*(long **)(this + 0x11d0) != (long *)0x0)) &&
       (plVar4 != *(long **)(this + 0x11d0))) {
      cVar2 = (**(code **)(*plVar4 + 0x170))(plVar4);
      if (cVar2 != '\0') {
        cVar2 = (**(code **)(**(long **)(this + 0x11d0) + 0x170))();
        if (cVar2 != '\0') {
          (**(code **)(*(long *)this + 0x970))(this,&local_70,plVar4,*(undefined8 *)(this + 0x11d0))
          ;
          (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                     (ulong)*(byte *)((long)plVar4 + 0x15) * 0x40 + plVar4[7]);
          (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                     (ulong)*(byte *)(*(long *)(this + 0x11d0) + 0x15) * 0x40 +
                     *(long *)(*(long *)(this + 0x11d0) + 0x38));
          (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                     (ulong)*(byte *)(*(long *)(this + 0x11d0) + 0x16) * 0x40 +
                     *(long *)(*(long *)(this + 0x11d0) + 0x38));
          (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x148))
                    (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70);
          (**(code **)(**(long **)(this + 0x11d0) + 0x168))(*(long **)(this + 0x11d0),0,0);
          (**(code **)(**(long **)(this + 0x11d0) + 0x178))();
        }
        (**(code **)(*plVar4 + 0x178))(plVar4);
      }
    }
    (**(code **)(*plVar4 + 0x28))(plVar4);
  }
  IOAccelLegacyDisplayMachine::setup_fullscreen
            (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),(long)this);
  IOAccelSurface::update_contexts((IOAccelSurface *)this);
  return;
}



// IOAccelLegacySurface::leave_exclusive_mode(unsigned int, bool)

void __thiscall
IOAccelLegacySurface::leave_exclusive_mode
          (IOAccelLegacySurface *this,undefined8 param_2_00,byte param_2)

{
  int iVar1;
  uint uVar2;
  ulong uVar3;
  long *plVar4;
  long *plVar5;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  
  if (*(uint *)(this + 0x1168) < 0x100) {
    leave_assembly_fullscreen(this);
    goto LAB_000189e4;
  }
  if (param_2 == 0) {
    plVar4 = *(long **)(this + 0x11c8);
    (**(code **)(*plVar4 + 0x20))(plVar4);
    (**(code **)(*plVar4 + 0x170))(plVar4);
    IOAccelSurface::detach_buffer_at_index((IOAccelSurface *)this,1);
    this[0x11a0] = (IOAccelLegacySurface)((byte)this[0x11a0] & 0xfd);
    plVar5 = *(long **)(this + 0x11c0);
    (**(code **)(*plVar5 + 0x20))(plVar5);
    (**(code **)(*plVar5 + 0x170))(plVar5);
    IOAccelSurface::detach_buffer_at_index((IOAccelSurface *)this,0);
    this[0x11a0] = (IOAccelLegacySurface)((byte)this[0x11a0] & 0xfe);
    if (*(long *)(this + 0x11d0) != 0) {
      uVar3 = 0xfffffffffffffffb;
      iVar1 = 2;
      goto LAB_000186f5;
    }
  }
  else {
    plVar5 = (long *)0x0;
    IOAccelSurface::detach_buffer_at_index((IOAccelSurface *)this,0);
    this[0x11a0] = (IOAccelLegacySurface)((byte)this[0x11a0] & 0xfe);
    uVar3 = 0xfffffffffffffffd;
    iVar1 = 1;
    plVar4 = (long *)0x0;
LAB_000186f5:
    IOAccelSurface::detach_buffer_at_index((IOAccelSurface *)this,iVar1);
    *(ulong *)(this + 0x11a0) = *(ulong *)(this + 0x11a0) & uVar3;
  }
  uVar2 = *(uint *)(this + 0x1190);
  if ((uVar2 & 2) != 0) {
    this[0x1188] = (IOAccelLegacySurface)((byte)this[0x1188] | 1);
  }
  if ((uVar2 & 4) != 0) {
    *(uint *)(this + 0x1190) = uVar2 & 0xfffffffb;
  }
  (**(code **)(*(long *)this + 0x9e0))(this);
  (**(code **)(*(long *)this + 0x9d8))(this);
  if ((this[0x118c] == (IOAccelLegacySurface)0x0) && (param_2 == 0)) {
    uVar2 = *(uint *)(this + 0x1190) & 3;
    if (uVar2 != 0) {
      uVar3 = IOAccelSurface::prepare_buffers((IOAccelSurface *)this,uVar2);
      if ((char)uVar3 == '\0') {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Failed to alloc surface\n",
                          "void IOAccelLegacySurface::leave_exclusive_mode(uint32_t, bool)");
        goto LAB_000189e4;
      }
    }
    local_38 = &DAT_aaaaaaaaaaaaaaaa;
    local_40 = &DAT_aaaaaaaaaaaaaaaa;
    local_48 = &DAT_aaaaaaaaaaaaaaaa;
    local_50 = &DAT_aaaaaaaaaaaaaaaa;
    local_58 = &DAT_aaaaaaaaaaaaaaaa;
    local_60 = &DAT_aaaaaaaaaaaaaaaa;
    local_68 = &DAT_aaaaaaaaaaaaaaaa;
    local_70 = &DAT_aaaaaaaaaaaaaaaa;
    (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x140))();
    if (plVar4 != (long *)0x0) {
      if ((*(long **)(this + 0x11c8) != (long *)0x0) && (plVar4 != *(long **)(this + 0x11c8))) {
        (**(code **)(*(long *)this + 0x970))(this,&local_70,plVar4);
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                   (ulong)*(byte *)((long)plVar4 + 0x15) * 0x40 + plVar4[7]);
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                   (ulong)*(byte *)(*(long *)(this + 0x11c8) + 0x15) * 0x40 +
                   *(long *)(*(long *)(this + 0x11c8) + 0x38));
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                   (ulong)*(byte *)(*(long *)(this + 0x11c8) + 0x16) * 0x40 +
                   *(long *)(*(long *)(this + 0x11c8) + 0x38));
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x148))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70);
        (**(code **)(**(long **)(this + 0x11c8) + 0x168))(*(long **)(this + 0x11c8),0,0);
      }
      (**(code **)(*plVar4 + 0x178))(plVar4);
      (**(code **)(*plVar4 + 0x28))(plVar4);
    }
    if (plVar5 != (long *)0x0) {
      if ((*(long **)(this + 0x11c0) != (long *)0x0) && (plVar5 != *(long **)(this + 0x11c0))) {
        (**(code **)(*(long *)this + 0x970))(this,&local_70,plVar5);
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                   (ulong)*(byte *)((long)plVar5 + 0x15) * 0x40 + plVar5[7]);
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                   (ulong)*(byte *)(*(long *)(this + 0x11c0) + 0x15) * 0x40 +
                   *(long *)(*(long *)(this + 0x11c0) + 0x38));
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70,
                   (ulong)*(byte *)(*(long *)(this + 0x11c0) + 0x16) * 0x40 +
                   *(long *)(*(long *)(this + 0x11c0) + 0x38));
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x148))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_70);
        (**(code **)(**(long **)(this + 0x11c0) + 0x168))(*(long **)(this + 0x11c0),0,0);
      }
      (**(code **)(*plVar5 + 0x178))(plVar5);
      (**(code **)(*plVar5 + 0x28))(plVar5);
    }
    IOAccelSurface::complete_buffers((IOAccelSurface *)this,uVar2);
  }
LAB_000189e4:
  IOAccelLegacyDisplayMachine::reset_fullscreen
            (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),*(uint *)(this + 0x1390),param_2 ^ 1);
  *(undefined4 *)(this + 0x1390) = 0xffff;
  pick_present_type(this);
  IOAccelSurface::update_contexts((IOAccelSurface *)this);
  return;
}



// IOAccelLegacySurface::reset_req_bits()

void __thiscall IOAccelLegacySurface::reset_req_bits(IOAccelLegacySurface *this)

{
  uint uVar1;
  
  uVar1 = *(uint *)(this + 0x1190);
  IOAccelSurface::reset_req_bits((IOAccelSurface *)this);
  if ((((uVar1 ^ *(uint *)(this + 0x1190)) & 2) != 0) && (*(uint *)(this + 0x1344) != 0xffff)) {
    update_exclusive_bit(this,(ulong)*(uint *)(this + 0x1344),'\0',0);
    return;
  }
  return;
}



// IOAccelLegacySurface::prune_buffers()

void __thiscall IOAccelLegacySurface::prune_buffers(IOAccelLegacySurface *this)

{
  ulong uVar1;
  uint uVar2;
  long *plVar3;
  IOAccelResource2 *this_00;
  byte bVar4;
  uint uVar5;
  IOAccelDisplayMachine *this_01;
  long lVar6;
  
  uVar1 = *(ulong *)(this + 0x11b0);
  uVar2 = *(uint *)(this + 0x1190);
  if ((uVar1 & 0x20) == 0) {
LAB_00018abe:
    uVar5 = (uint)uVar1 & 0x8000;
    uVar2 = uVar2 | 1;
  }
  else {
    uVar5 = *(uint *)(this + 0x1188);
    *(uint *)(this + 0x1188) = uVar2 & 7 | uVar5;
    uVar2 = uVar5 | uVar2;
    if (((uint)uVar1 & 0x8020) != 0x20) goto LAB_00018abe;
    uVar5 = 0;
  }
  *(uint *)(this + 0x1190) = uVar2;
  if (((uVar1 & 0x20) != 0) && (uVar5 == 0)) goto LAB_00018c5f;
  if (uVar5 == 0) {
    if (((uVar2 & 1) == 0) || (uVar2 = *(uint *)(this + 0x1390), uVar2 == 0xffff))
    goto LAB_00018c5f;
    this_01 = *(IOAccelDisplayMachine **)(this + 0x13a8);
LAB_00018c4b:
    plVar3 = (long *)IOAccelDisplayMachine::getFramebufferResource(this_01,(ulong)uVar2,0);
  }
  else {
    if (*(uint *)(this + 0x1168) < 0x100) {
      bVar4 = 0;
    }
    else {
      bVar4 = (*(byte *)(*(long *)(this + 0x12c8) + 0xcec) & 4) >> 2;
    }
    if ((uVar2 & 4) == 0) {
      if ((~uVar2 & 3) != 0) {
        if ((char)((uVar2 & 2) >> 1) != '\0' || bVar4 != 0) goto LAB_00018c5f;
        goto LAB_00018be4;
      }
      if ((*(long *)(this + 0x11c8) != 0) &&
         ((*(byte *)(*(long *)(this + 0x11c8) + 0xc) & 0x10) != 0)) {
        if ((*(long *)(this + 0x11c0) != 0) &&
           ((*(byte *)(*(long *)(this + 0x11c0) + 0xc) & 0x10) != 0)) {
          IOAccelSurface::detach_buffer_at_index((IOAccelSurface *)this,0);
          this[0x11a0] = (IOAccelLegacySurface)((byte)this[0x11a0] & 0xfe);
        }
        goto LAB_00018c5f;
      }
      if (*(long *)(this + 0x11c0) == 0) {
        if (bVar4 != 0) goto LAB_00018c5f;
      }
      else {
        if ((*(byte *)(*(long *)(this + 0x11c0) + 0xc) & 0x10) != 0 || bVar4 != 0)
        goto LAB_00018c5f;
        IOAccelSurface::detach_buffer_at_index((IOAccelSurface *)this,0);
        this[0x11a0] = (IOAccelLegacySurface)((byte)this[0x11a0] & 0xfe);
      }
      if (this[0x138c] == (IOAccelLegacySurface)0x0) {
        this_01 = *(IOAccelDisplayMachine **)(this + 0x12d0);
        goto LAB_00018c45;
      }
      this_01 = *(IOAccelDisplayMachine **)(this + 0x13a8);
    }
    else {
      if (((*(long *)(this + 0x11d0) != 0) &&
          ((*(byte *)(*(long *)(this + 0x11d0) + 0xc) & 0x10) != 0)) ||
         ((*(long *)(this + 0x11c8) != 0 &&
          ((*(byte *)(*(long *)(this + 0x11c8) + 0xc) & 0x10) != 0)))) goto LAB_00018c5f;
      if ((*(long *)(this + 0x11c0) != 0) &&
         ((*(byte *)(*(long *)(this + 0x11c0) + 0xc) & 0x10) == 0)) {
        IOAccelSurface::detach_buffer_at_index((IOAccelSurface *)this,0);
        this[0x11a0] = (IOAccelLegacySurface)((byte)this[0x11a0] & 0xfe);
      }
LAB_00018be4:
      this_01 = *(IOAccelDisplayMachine **)(this + 0x13a8);
      if (this[0x138c] == (IOAccelLegacySurface)0x0) {
LAB_00018c45:
        uVar2 = *(uint *)(this + 0x1390);
        goto LAB_00018c4b;
      }
    }
    plVar3 = (long *)IOAccelLegacyDisplayMachine::getScanoutResource
                               ((long)this_01,(ulong)*(uint *)(this + 0x1398));
  }
  IOAccelSurface::attach_buffer_at_index((IOAccelSurface *)this,0,plVar3);
LAB_00018c5f:
  lVar6 = 0;
  do {
    uVar2 = (uint)lVar6;
    if ((*(uint *)(this + 0x1190) >> (uVar2 & 0x1f) & 1) == 0) {
      if (*(long *)(this + (long)(&DAT_000011c0 + lVar6 * 8)) != 0) {
        IOAccelSurface::detach_buffer_at_index((IOAccelSurface *)this,uVar2);
        *(ulong *)(this + 0x11a0) = *(ulong *)(this + 0x11a0) & (long)~(1 << ((byte)lVar6 & 0x1f));
      }
    }
    else if (*(long *)(this + (long)(&DAT_000011c0 + lVar6 * 8)) == 0) {
      if (((byte)this[0x11b2] & 0x70) == 0) {
LAB_00018ce8:
        this_00 = (IOAccelResource2 *)
                  (**(code **)(**(long **)(this + 0x12c8) + 0x8d0))
                            (*(long **)(this + 0x12c8),0,0x40);
        this_00[0xc] = (IOAccelResource2)((byte)this_00[0xc] | 4);
        IOAccelResource2::updateReadWriteBits(this_00,1,'\x01');
        IOAccelResourceList::addResource
                  ((IOAccelResourceList *)(*(long *)(this + 0x12c8) + 0xb00),(long)this_00);
      }
      else {
        if (uVar2 == 0) {
          this_00 = *(IOAccelResource2 **)(this + 0x11c8);
        }
        else {
          if (uVar2 != 1) goto LAB_00018ce8;
          this_00 = *(IOAccelResource2 **)(this + 0x11c0);
        }
        if (this_00 == (IOAccelResource2 *)0x0) goto LAB_00018ce8;
        (**(code **)(*(long *)this_00 + 0x20))(this_00);
      }
      IOAccelSurface::attach_buffer_at_index((IOAccelSurface *)this,uVar2,(long *)this_00);
      (**(code **)(*(long *)this_00 + 0x28))(this_00);
    }
    lVar6 = lVar6 + 1;
    if (lVar6 == 0xd) {
      return;
    }
  } while( true );
}



// IOAccelLegacySurface::didSubmitSwap(unsigned int, unsigned int)

void IOAccelLegacySurface::didSubmitSwap(void)

{
  return;
}



// IOAccelLegacySurface::update_shape()

void __thiscall IOAccelLegacySurface::update_shape(IOAccelLegacySurface *this)

{
  ushort uVar1;
  ushort uVar2;
  ushort uVar3;
  undefined2 *puVar4;
  long *plVar5;
  long *plVar6;
  byte bVar7;
  char cVar8;
  uint uVar9;
  uint uVar10;
  IOAccelResource2 *pIVar11;
  uint uVar12;
  ulong uVar13;
  ulong uVar14;
  long lVar15;
  ulong uVar16;
  bool bVar17;
  undefined1 *local_80;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  ulong local_40;
  uint local_34;
  
  if (this[0xf0] == (IOAccelLegacySurface)0x0) {
    if (*(uint *)(this + 0x1168) < 0x100) {
      lVar15 = 0;
      do {
        pIVar11 = *(IOAccelResource2 **)(this + (long)(&DAT_000011c0 + lVar15 * 8));
        if ((pIVar11 != (IOAccelResource2 *)0x0) && (((byte)pIVar11[0xc] & 0x10) == 0)) {
          IOAccelResource2::setPurgeable(pIVar11,3,3,(uint *)0x0);
          puVar4 = *(undefined2 **)(*(long *)(this + (long)(&DAT_000011c0 + lVar15 * 8)) + 0x30);
          puVar4[6] = 0;
          *puVar4 = 0;
        }
        lVar15 = lVar15 + 1;
      } while (lVar15 != 0xd);
    }
  }
  else {
    local_40 = *(ulong *)(this + 0x1198) ^ *(ulong *)(this + 0x11b0);
    uVar10 = ~*(uint *)(this + 0x11a0) & *(uint *)(this + 0x1190) | 7;
    uVar9 = ~*(uint *)(this + 0x11a0) & *(uint *)(this + 0x1190);
    if ((local_40 & 0x7f000f) != 0) {
      uVar9 = uVar10;
    }
    if ((((((uint)local_40 >> 0xf & 1) != 0) ||
         (uVar12 = uVar9, ((*(uint *)(this + 0x1170) ^ *(uint *)(this + 0x1330)) & 0x8000) != 0)) &&
        (uVar12 = uVar10, *(uint *)(this + 0x1168) < 0x100)) &&
       (uVar12 = uVar9, ((uint)*(ulong *)(this + 0x11b0) >> 0xf & 1) != 0)) {
      uVar12 = ~*(uint *)(this + 0x13a0) & 7 | uVar9;
    }
    uVar1 = *(ushort *)(this + 0x11bc);
    uVar2 = *(ushort *)(this + 0x11be);
    uVar9 = (**(code **)(*(long *)this + 0x998))(this);
    uVar9 = uVar9 | uVar12;
    uVar10 = (uint)*(ushort *)(this + 0x11a8);
    if (*(uint *)(this + 0x1168) < 0x100) {
      uVar3 = *(ushort *)(this + 0x11aa);
      if ((((int)uVar10 < (int)*(short *)(this + 0x11bc)) ||
          ((int)(uint)uVar3 < (int)*(short *)(this + 0x11be))) || ((local_40 & 0x7f0000) != 0)) {
        uVar9 = uVar9 | *(uint *)(this + 0x1190);
      }
      uVar12 = (int)(short)uVar1;
      if ((uint)(int)(short)uVar1 < uVar10) {
        uVar12 = (uint)*(ushort *)(this + 0x11a8);
      }
      local_34 = (int)(short)uVar2;
      if ((uint)(int)(short)uVar2 < (uint)uVar3) {
        local_34 = (uint)uVar3;
      }
    }
    else {
      if (((uVar10 != (int)*(short *)(this + 0x11bc)) ||
          ((uint)*(ushort *)(this + 0x11aa) != (int)*(short *)(this + 0x11be))) ||
         ((local_40 & 0x7f0000) != 0)) {
        uVar9 = uVar9 | *(uint *)(this + 0x1190);
      }
      uVar12 = (uint)uVar1;
      local_34 = (uint)uVar2;
    }
    uVar13 = (ulong)(uVar9 & *(uint *)(this + 0x1190));
    local_40 = CONCAT44(local_40._4_4_,uVar12);
    if ((uVar9 & *(uint *)(this + 0x1190)) == 0) {
      uVar13 = 0;
    }
    else {
      uVar14 = uVar13;
      uVar16 = 0;
      do {
        if ((uVar14 & 1) != 0) {
          if ((*(byte *)(*(long *)(this + (long)(&DAT_000011c0 + uVar16 * 8)) + 0xc) & 0x10) == 0) {
            if ((((byte)this[0x11b2] & 0x70) == 0) &&
               (*(long *)(*(long *)(this + (long)(&DAT_000011c0 + uVar16 * 8)) + 200) != 0)) {
              IOAccelSurface::detach_buffer_at_index((IOAccelSurface *)this,(int)uVar16);
              pIVar11 = (IOAccelResource2 *)
                        (**(code **)(**(long **)(this + 0x12c8) + 0x8d0))
                                  (*(long **)(this + 0x12c8),0,0x40);
              pIVar11[0xc] = (IOAccelResource2)((byte)pIVar11[0xc] | 4);
              IOAccelResource2::updateReadWriteBits(pIVar11,1,'\x01');
              IOAccelResourceList::addResource
                        ((IOAccelResourceList *)(*(long *)(this + 0x12c8) + 0xb00),(long)pIVar11);
              IOAccelSurface::attach_buffer_at_index
                        ((IOAccelSurface *)this,(int)uVar16,(long *)pIVar11);
              uVar12 = (uint)local_40;
              (**(code **)(*(long *)pIVar11 + 0x28))(pIVar11);
            }
          }
          else {
            bVar7 = (byte)uVar16 & 0x1f;
            uVar13 = uVar13 & (long)(int)(-2 << bVar7 | 0xfffffffeU >> 0x20 - bVar7);
          }
        }
        if (uVar14 < 2) break;
        uVar14 = uVar14 >> 1;
        bVar17 = uVar16 < 0xc;
        uVar16 = uVar16 + 1;
      } while (bVar17);
    }
    if (((byte)this[0x11b2] & 0x70) != 0) {
      uVar14 = uVar13 & 0xfffffffffffffffd;
      if ((*(ulong *)(this + 0x11a0) & 1) == 0) {
        uVar14 = uVar13;
      }
      uVar13 = uVar14 & 0xfffffffffffffffe;
      if ((*(ulong *)(this + 0x11a0) & 2) == 0) {
        uVar13 = uVar14;
      }
      if ((~(uint)uVar13 & 3) == 0) {
        uVar13 = uVar13 & 0xfffffffffffffffc | 1;
      }
    }
    (**(code **)(*(long *)this + 0x990))(this,uVar13,uVar12 & 0xffff);
    if (*(uint *)(this + 0x1168) < 0x100) {
      lVar15 = 0;
      do {
        pIVar11 = *(IOAccelResource2 **)(this + (long)(&DAT_000011c0 + lVar15 * 8));
        if ((pIVar11 != (IOAccelResource2 *)0x0) && (((byte)pIVar11[0xc] & 0x10) == 0)) {
          IOAccelResource2::setPurgeable(pIVar11,2,2,(uint *)0x0);
        }
        lVar15 = lVar15 + 1;
      } while (lVar15 != 0xd);
    }
    if ((((this[0xf3] != (IOAccelLegacySurface)0x0) && ((uVar13 & 2) != 0)) &&
        ((~*(uint *)(this + 0x1190) & 3) == 0)) &&
       (((((byte)this[0x11a0] & 2) == 0 &&
         (plVar5 = *(long **)(this + 0x11c0), plVar5 != (long *)0x0)) &&
        ((plVar6 = *(long **)(this + 0x11c8), plVar6 != (long *)0x0 &&
         ((plVar5 != plVar6 && (cVar8 = (**(code **)(*plVar5 + 0x170))(plVar5), cVar8 != '\0')))))))
       ) {
      cVar8 = (**(code **)(*plVar6 + 0x170))(plVar6);
      if (cVar8 != '\0') {
        local_48 = &DAT_aaaaaaaaaaaaaaaa;
        local_50 = &DAT_aaaaaaaaaaaaaaaa;
        local_58 = &DAT_aaaaaaaaaaaaaaaa;
        local_60 = &DAT_aaaaaaaaaaaaaaaa;
        local_68 = &DAT_aaaaaaaaaaaaaaaa;
        local_70 = &DAT_aaaaaaaaaaaaaaaa;
        local_78 = &DAT_aaaaaaaaaaaaaaaa;
        local_80 = &DAT_aaaaaaaaaaaaaaaa;
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x140))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_80);
        (**(code **)(*(long *)this + 0x970))(this,&local_80,plVar5,plVar6);
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_80,
                   (ulong)*(byte *)((long)plVar5 + 0x15) * 0x40 + plVar5[7]);
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_80,
                   (ulong)*(byte *)((long)plVar6 + 0x15) * 0x40 + plVar6[7]);
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_80,
                   (ulong)*(byte *)((long)plVar6 + 0x16) * 0x40 + plVar6[7]);
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x148))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_80);
        (**(code **)(*plVar6 + 0x178))(plVar6);
      }
      (**(code **)(*plVar5 + 0x178))(plVar5);
    }
    if (((uint)*(undefined8 *)(this + 0x11b0) >> 0xf & 1) == 0) {
      *(ulong *)(this + 0x13a0) = *(ulong *)(this + 0x13a0) & ~uVar13;
    }
    else {
      *(ulong *)(this + 0x13a0) = *(ulong *)(this + 0x13a0) | uVar13;
    }
    *(undefined8 *)(this + 0x1198) = *(undefined8 *)(this + 0x11b0);
    *(ulong *)(this + 0x11a0) = (ulong)*(uint *)(this + 0x1190);
    *(short *)(this + 0x11a8) = (short)local_40;
    *(short *)(this + 0x11aa) = (short)local_34;
    *(undefined4 *)(this + 0x1330) = *(undefined4 *)(this + 0x1170);
  }
  return;
}



// IOAccelLegacySurface::pickPresentType(unsigned int)

uint __thiscall IOAccelLegacySurface::pickPresentType(IOAccelLegacySurface *this,uint param_1)

{
  char cVar1;
  uint uVar2;
  IOAccelLegacySurface *pIVar3;
  
  if (*(uint *)(this + 0x1168) < 0x100) {
    uVar2 = 4 - (((byte)this[0x11b1] & 0x80) == 0);
  }
  else if (this[(long)(&DAT_0000105c + (ulong)param_1 * 0x10)] == (IOAccelLegacySurface)0x0) {
    cVar1 = IOAccelDisplayMachine::isFramebufferActive
                      (*(IOAccelDisplayMachine **)(this + 0x13a8),param_1);
    uVar2 = 1;
    if (((cVar1 != '\0') && ((*(byte *)(*(long *)(this + 0x12c8) + 0xc78) & 2) != 0)) &&
       (uVar2 = 2, ((byte)this[0x11b1] & 0x80) != 0)) {
      pIVar3 = (IOAccelLegacySurface *)
               IOAccelLegacyDisplayMachine::getFullScreenSurface
                         (*(IOAccelLegacyDisplayMachine **)(this + 0x13a8),*(uint *)(this + 0x1390))
      ;
      uVar2 = (uint)(pIVar3 == this) << 2;
    }
  }
  else {
    uVar2 = (uint)((*(uint *)(this + 0x11b0) >> 0xf & 1) == 0);
  }
  return uVar2;
}



// IOAccelLegacySurface::MetaClass::~MetaClass()

void __thiscall IOAccelLegacySurface::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelLegacySurface::submitCopyForward(IOAccelEvent*, unsigned int, IOAccelResource2*,
// IOAccelResource2*, IOAccelBounds const*, unsigned int)

undefined8 IOAccelLegacySurface::submitCopyForward(void)

{
  return 0xe00002c7;
}



// IOAccelLegacySurface::submitUpdate(unsigned int, IOAccelBounds*, unsigned int)

undefined8 IOAccelLegacySurface::submitUpdate(void)

{
  return 0xe00002c7;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelLegacySurface_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelLegacySurface::gMetaClass,"IOAccelLegacySurface",
             (OSMetaClass *)&IOAccelSurface::gMetaClass,0x13b0);
  _gMetaClass = &PTR__MetaClass_00073908;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelLegacySurface::gMetaClass);
  return;
}



// IOAccelSubmitter2::MetaClass::MetaClass()

void __thiscall IOAccelSubmitter2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelSubmitter2",(OSMetaClass *)PTR_gMetaClass_0006b018,0x568);
  *(undefined ***)this = &PTR__MetaClass_000743f8;
  return;
}



// IOAccelSubmitter2::MetaClass::~MetaClass()

void __thiscall IOAccelSubmitter2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelSubmitter2::IOAccelSubmitter2(OSMetaClass const*)

void __thiscall IOAccelSubmitter2::IOAccelSubmitter2(IOAccelSubmitter2 *this,OSMetaClass *param_1)

{
  IOUserClient::IOUserClient((IOUserClient *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelSubmitter2_00073a00;
  return;
}



// IOAccelSubmitter2::~IOAccelSubmitter2()

void __thiscall IOAccelSubmitter2::~IOAccelSubmitter2(IOAccelSubmitter2 *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  return;
}



// IOAccelSubmitter2::~IOAccelSubmitter2()

void __thiscall IOAccelSubmitter2::~IOAccelSubmitter2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelSubmitter2::~IOAccelSubmitter2()

void __thiscall IOAccelSubmitter2::~IOAccelSubmitter2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelSubmitter2::getMetaClass() const

undefined1 * IOAccelSubmitter2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelSubmitter2::MetaClass::MetaClass()

void __thiscall IOAccelSubmitter2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelSubmitter2",(OSMetaClass *)PTR_gMetaClass_0006b018,0x568);
  *(undefined ***)this = &PTR__MetaClass_000743f8;
  return;
}



// IOAccelSubmitter2::MetaClass::alloc() const

undefined8 IOAccelSubmitter2::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelSubmitter2::operator new(unsigned long)

void * __thiscall IOAccelSubmitter2::operator_new(IOAccelSubmitter2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelSubmitter2_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSubmitter2::operator delete(void*, unsigned long)

void __cdecl IOAccelSubmitter2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelSubmitter2_ktv,param_1,param_2);
  return;
}



// IOAccelSubmitter2::_RESERVEDIOAccelSubmitter0()

void IOAccelSubmitter2::_RESERVEDIOAccelSubmitter0(void)

{
  OSMetaClass::reservedCalled(0x821b0);
  return;
}



// IOAccelSubmitter2::_RESERVEDIOAccelSubmitter1()

void IOAccelSubmitter2::_RESERVEDIOAccelSubmitter1(void)

{
  OSMetaClass::reservedCalled(0x821b0);
  return;
}



// IOAccelSubmitter2::_RESERVEDIOAccelSubmitter2()

void IOAccelSubmitter2::_RESERVEDIOAccelSubmitter2(void)

{
  OSMetaClass::reservedCalled(0x821b0);
  return;
}



// IOAccelSubmitter2::_RESERVEDIOAccelSubmitter3()

void IOAccelSubmitter2::_RESERVEDIOAccelSubmitter3(void)

{
  OSMetaClass::reservedCalled(0x821b0);
  return;
}



// IOAccelSubmitter2::_RESERVEDIOAccelSubmitter4()

void IOAccelSubmitter2::_RESERVEDIOAccelSubmitter4(void)

{
  OSMetaClass::reservedCalled(0x821b0);
  return;
}



// IOAccelSubmitter2::_RESERVEDIOAccelSubmitter5()

void IOAccelSubmitter2::_RESERVEDIOAccelSubmitter5(void)

{
  OSMetaClass::reservedCalled(0x821b0);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSubmitter2::start(IOService*)

undefined4 __cdecl IOAccelSubmitter2::start(long *param_1)

{
  undefined4 uVar1;
  long lVar2;
  
  uVar1 = (**(code **)(PTR_vtable_0006b088 + 0x5d0))();
  if ((char)uVar1 != '\0') {
    param_1[0xa5] = 0;
    param_1[0xa6] = (long)(param_1 + 0xa5);
    lVar2 = OSNumber::withNumber(0,0x40);
    param_1[0xab] = lVar2;
    (**(code **)(*param_1 + 600))(param_1,___lastSubmissionTimeSymbol,lVar2);
    lVar2 = OSNumber::withNumber(0,0x40);
    param_1[0xac] = lVar2;
    (**(code **)(*param_1 + 600))(param_1,___accumulatedGPUTimeSymbol,lVar2);
  }
  return uVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSubmitter2::stop(IOService*)

void __cdecl IOAccelSubmitter2::stop(long param_1)

{
  (**(code **)(PTR_vtable_0006b088 + 0x5d8))();
  if (*(long **)(param_1 + 0x558) != (long *)0x0) {
    (**(code **)(**(long **)(param_1 + 0x558) + 0x28))();
  }
  *(undefined8 *)(param_1 + 0x558) = 0;
  if (*(long **)(param_1 + 0x560) != (long *)0x0) {
    (**(code **)(**(long **)(param_1 + 0x560) + 0x28))();
  }
  *(undefined8 *)(param_1 + 0x560) = 0;
  return;
}



// IOAccelSubmitter2::orphanClientMappings(OSSet*)

void IOAccelSubmitter2::orphanClientMappings(void)

{
  return;
}



// IOAccelSubmitter2::setProtectionOptions(unsigned long long)

void __thiscall IOAccelSubmitter2::setProtectionOptions(IOAccelSubmitter2 *this,undefined8 param_1)

{
  *(undefined8 *)(this + 0x550) = param_1;
  return;
}



// IOAccelSubmitter2::updateLastSubmissionTime()

void __thiscall IOAccelSubmitter2::updateLastSubmissionTime(IOAccelSubmitter2 *this)

{
  long *plVar1;
  code *UNRECOVERED_JUMPTABLE;
  uint64_t uVar2;
  undefined8 extraout_RDX;
  
  plVar1 = *(long **)(this + 0x558);
  uVar2 = _mach_absolute_time();
  UNRECOVERED_JUMPTABLE = *(code **)(*plVar1 + 0x160);
                    // WARNING: Could not recover jumptable at 0x00019620. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)(plVar1,uVar2,extraout_RDX,UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelSubmitter2::MetaClass::~MetaClass()

void __thiscall IOAccelSubmitter2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelSubmitter2::retireCommandBuffer(IOAccelEventFence*)

void IOAccelSubmitter2::retireCommandBuffer(void)

{
  return;
}



// IOAccelSubmitter2::setSubmissionError(unsigned int)

void IOAccelSubmitter2::setSubmissionError(void)

{
  return;
}



// IOAccelSubmitter2::isOpportunisticWorkload() const

undefined8 IOAccelSubmitter2::isOpportunisticWorkload(void)

{
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelSubmitter_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelSubmitter2::gMetaClass,"IOAccelSubmitter2",
             (OSMetaClass *)PTR_gMetaClass_0006b018,0x568);
  _gMetaClass = &PTR__MetaClass_000743f8;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelSubmitter2::gMetaClass);
  return;
}



// IOAccelGLContext2::MetaClass::MetaClass()

void __thiscall IOAccelGLContext2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelGLContext2",(OSMetaClass *)&IOAccelContext2::gMetaClass,
             0x1238);
  *(undefined ***)this = &PTR__MetaClass_000750b0;
  return;
}



// IOAccelGLContext2::MetaClass::~MetaClass()

void __thiscall IOAccelGLContext2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelGLContext2::IOAccelGLContext2(OSMetaClass const*)

void __thiscall IOAccelGLContext2::IOAccelGLContext2(IOAccelGLContext2 *this,OSMetaClass *param_1)

{
  IOAccelContext2::IOAccelContext2((IOAccelContext2 *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelGLContext2_000744f0;
  return;
}



// IOAccelGLContext2::~IOAccelGLContext2()

void __thiscall IOAccelGLContext2::~IOAccelGLContext2(IOAccelGLContext2 *this)

{
  IOAccelContext2::~IOAccelContext2((IOAccelContext2 *)this);
  return;
}



// IOAccelGLContext2::~IOAccelGLContext2()

void __thiscall IOAccelGLContext2::~IOAccelGLContext2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelGLContext2::~IOAccelGLContext2()

void __thiscall IOAccelGLContext2::~IOAccelGLContext2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelGLContext2::getMetaClass() const

undefined1 * IOAccelGLContext2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelGLContext2::MetaClass::MetaClass()

void __thiscall IOAccelGLContext2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelGLContext2",(OSMetaClass *)&IOAccelContext2::gMetaClass,
             0x1238);
  *(undefined ***)this = &PTR__MetaClass_000750b0;
  return;
}



// IOAccelGLContext2::MetaClass::alloc() const

undefined8 IOAccelGLContext2::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelGLContext2::operator new(unsigned long)

void * __thiscall IOAccelGLContext2::operator_new(IOAccelGLContext2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelGLContext2_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLContext2::operator delete(void*, unsigned long)

void __cdecl IOAccelGLContext2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelGLContext2_ktv,param_1,param_2);
  return;
}



// IOAccelGLContext2::contextStart()

ulong __thiscall IOAccelGLContext2::contextStart(IOAccelGLContext2 *this)

{
  int *piVar1;
  ulong uVar2;
  long lVar3;
  
  this[0x698] = (IOAccelGLContext2)0x0;
  uVar2 = IOAccelContext2::contextStart((IOAccelContext2 *)this);
  if ((char)uVar2 != '\0') {
    *(undefined8 *)(this + 0x10c0) = *(undefined8 *)(*(long *)(this + 0x5a8) + 0x378);
    lVar3 = 0;
    *(undefined8 *)(this + 0x5c0) = 0;
    *(undefined8 *)(this + 0x5c8) = 0;
    *(undefined8 *)(this + 0x10cc) = 0;
    *(undefined8 *)(this + 0x10a8) = 0;
    *(undefined2 *)(this + 0x10c8) = 0;
    this[0x10b4] = (IOAccelGLContext2)0x0;
    *(undefined4 *)(this + 0x10b0) = 0x10000;
    do {
      (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x140))
                (*(long **)(*(long *)(this + 0x5a8) + 0x380),this + (long)(&DAT_000010f0 + lVar3));
      lVar3 = lVar3 + 0x40;
    } while (lVar3 != 0x100);
    *(undefined4 *)(this + 0x11f0) = 0;
    *(undefined4 *)(this + 0x10b8) = 0;
    ___ZN19IOAccelFIFOChannel24initEP22IOGraphicsAccelerator2iii(*(long *)(this + 0x5a0));
    *(undefined8 *)(this + 0x10d8) = 0;
    *(undefined8 *)(this + 0x10e8) = 0;
    *(undefined8 *)(this + 0x10e0) = 0;
    lVar3 = *(long *)(this + 0x5a8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar3 + 0x388) + 0x58),0x25);
    piVar1 = (int *)(lVar3 + 0x234);
    *piVar1 = *piVar1 + 1;
    sGLContextMethodsDispatch = &contextStart()::methodDispatchDescs;
  }
  return uVar2 & 0xffffffff;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLContext2::s_set_surface(IOAccelGLContext2*, void*, IOExternalMethodArguments*)

void __cdecl
IOAccelGLContext2::s_set_surface(IOAccelGLContext2 *param_1,undefined8 param_2,long param_3)

{
  set_surface(param_1,*(ulong **)(param_3 + 0x30));
  return;
}



// IOAccelGLContext2::s_set_surface_get_config_status(IOAccelGLContext2*, void*,
// IOExternalMethodArguments*)

void __thiscall
IOAccelGLContext2::s_set_surface_get_config_status
          (IOAccelGLContext2 *this,undefined8 param_2_00,long param_2)

{
  set_surface_get_config_status(this,*(ulong **)(param_2 + 0x30),*(undefined8 **)(param_2 + 0x58));
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLContext2::s_set_swap_rect(IOAccelGLContext2*, void*, IOExternalMethodArguments*)

undefined8 __cdecl IOAccelGLContext2::s_set_swap_rect(long param_1,undefined8 param_2,long param_3)

{
  undefined2 uVar1;
  undefined2 uVar2;
  undefined2 uVar3;
  undefined2 *puVar4;
  
  puVar4 = *(undefined2 **)(param_3 + 0x20);
  uVar1 = puVar4[4];
  uVar2 = puVar4[8];
  uVar3 = puVar4[0xc];
  *(undefined2 *)(&DAT_000010a8 + param_1) = *puVar4;
  *(undefined2 *)(&DAT_000010aa + param_1) = uVar1;
  *(undefined2 *)(&DAT_000010ac + param_1) = uVar2;
  *(undefined2 *)(&DAT_000010ae + param_1) = uVar3;
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLContext2::s_set_swap_interval(IOAccelGLContext2*, void*, IOExternalMethodArguments*)

undefined8 __cdecl
IOAccelGLContext2::s_set_swap_interval(long param_1,undefined8 param_2,long param_3)

{
  undefined2 uVar1;
  
  uVar1 = (*(undefined2 **)(param_3 + 0x20))[4];
  *(undefined2 *)(&DAT_000010b0 + param_1) = **(undefined2 **)(param_3 + 0x20);
  *(undefined2 *)(&DAT_000010b2 + param_1) = uVar1;
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLContext2::s_set_surface_volatile_state(IOAccelGLContext2*, void*,
// IOExternalMethodArguments*)

undefined8 __cdecl
IOAccelGLContext2::s_set_surface_volatile_state
          (IOAccelGLContext2 *param_1,undefined8 param_2,long param_3)

{
  set_surface_volatile_state(param_1,**(int **)(param_3 + 0x20));
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLContext2::s_read_buffer(IOAccelGLContext2*, void*, IOExternalMethodArguments*)

void __cdecl
IOAccelGLContext2::s_read_buffer(IOAccelGLContext2 *param_1,undefined8 param_2,long param_3)

{
  read_buffer(param_1,*(long **)(param_3 + 0x30));
  return;
}



// IOAccelGLContext2::contextStop()

void __thiscall IOAccelGLContext2::contextStop(IOAccelGLContext2 *this)

{
  int *piVar1;
  long *plVar2;
  long lVar3;
  
  if (this[0x698] != (IOAccelGLContext2)0x0) {
    if (*(long **)(this + 0x10e0) != (long *)0x0) {
      (**(code **)(**(long **)(this + 0x10e0) + 0x28))();
      *(undefined8 *)(this + 0x10e0) = 0;
    }
    plVar2 = *(long **)(this + 0x5c0);
    if (plVar2 != (long *)0x0) {
      (**(code **)(*plVar2 + 0xa00))(plVar2,this);
      (**(code **)(**(long **)(this + 0x5c0) + 0x9e0))();
      *(undefined8 *)(this + 0x5c0) = 0;
      *(undefined8 *)(this + 0x5c8) = 0;
    }
    if (*(long **)(this + 0x10e8) != (long *)0x0) {
      (**(code **)(**(long **)(this + 0x10e8) + 0x28))();
      *(undefined8 *)(this + 0x10e8) = 0;
    }
    if (*(long **)(this + 0x10d8) != (long *)0x0) {
      (**(code **)(**(long **)(this + 0x10d8) + 0x28))();
      *(undefined8 *)(this + 0x10d8) = 0;
    }
    lVar3 = *(long *)(this + 0x5a8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar3 + 0x388) + 0x58),0x25);
    piVar1 = (int *)(lVar3 + 0x234);
    *piVar1 = *piVar1 + -1;
  }
  IOAccelContext2::contextStop((IOAccelContext2 *)this);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLContext2::externalMethod(unsigned int, IOExternalMethodArguments*,
// IOExternalMethodDispatch*, OSObject*, void*)

undefined8 __cdecl
IOAccelGLContext2::externalMethod
          (long param_1,uint param_2,IOExternalMethodDispatch *param_3,long param_4,long param_5)

{
  undefined8 uVar1;
  uint uVar2;
  
  uVar2 = param_2 - 0x100;
  if (uVar2 < 6) {
    if (*(char *)(param_1 + 0x698) == '\0') {
      return 0xe00002d8;
    }
    param_4 = (ulong)uVar2 * 0x18 + sGLContextMethodsDispatch;
    param_2 = uVar2;
    if (param_5 == 0) {
      param_5 = param_1;
    }
  }
  uVar1 = IOAccelContext2::externalMethod
                    ((void *)param_1,(IOExternalMethodArguments *)param_2,param_3,
                     (undefined **)param_4,(void *)param_5);
  return uVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLContext2::processDataBuffers(unsigned int)

uint __cdecl IOAccelGLContext2::processDataBuffers(long *param_1,char *param_2,undefined8 param_3)

{
  int *piVar1;
  long lVar2;
  long *plVar3;
  IOAccelSurface *this;
  IOGraphicsAccelerator2 *pIVar4;
  uint uVar5;
  char cVar6;
  uint uVar7;
  int iVar8;
  uint uVar9;
  uintptr_t arg1;
  undefined8 uVar10;
  IOAccelDrawable2 *this_00;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 extraout_RDX_01;
  long *plVar11;
  uint uVar12;
  uint uVar13;
  ulong uVar14;
  
  plVar11 = param_1 + 0x21d;
  uVar12 = 0;
  do {
    while( true ) {
      if (((param_1[0xb8] == 0) || (param_1[0xb9] == 0)) ||
         (0xff < *(uint *)(&DAT_00001168 + param_1[0xb9]))) {
        IOGraphicsAccelerator2::acceleratorWaitEnabled((IOGraphicsAccelerator2 *)param_1[0xb5]);
        param_3 = extraout_RDX;
      }
      uVar7 = 0x80000000;
      if ((*(byte *)(param_1[0xb5] + 0xc78) & 2) == 0) goto LAB_00019df1;
      this_00 = (IOAccelDrawable2 *)param_1[0x21d];
      lVar2 = param_1[0xb8];
      if (this_00 == (IOAccelDrawable2 *)0x0) {
        if (lVar2 == 0) goto LAB_00019cce;
        if ((&DAT_0000118c)[lVar2] != '\0') {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Surface disabled\n",
                            "virtual uint32_t IOAccelGLContext2::processDataBuffers(uint32_t)");
          goto LAB_00019df1;
        }
      }
      else if (lVar2 == 0) goto LAB_00019c90;
      if (*(char *)(lVar2 + 0xf1) == '\0') break;
      arg1 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x85020075,arg1,0,0,0,0);
      plVar3 = (long *)param_1[0xb5];
      lVar2 = param_1[0xb8];
      (**(code **)(*plVar3 + 0x858))(plVar3,"",0);
      _IOLockSleep_darwin14(plVar3[0x11],lVar2,0);
      (**(code **)(*plVar3 + 0x850))(plVar3,"",0);
      param_2 = (char *)IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x85020076,(uintptr_t)param_2,0,0,0,0);
      param_3 = extraout_RDX_00;
    }
    if ((((long *)param_1[0xb9] == (long *)0x0) ||
        (uVar10 = IOAccelLegacySurface::is_back_buffer_ready((long *)param_1[0xb9],param_2,param_3),
        (char)uVar10 != '\0')) || (uVar12 = uVar12 + 1, 999 < uVar12)) {
      if (((&DAT_000010d0)[param_1[0xb8]] == '\0') || (uVar12 = uVar12 + 1, 999 < uVar12)) break;
      pIVar4 = (IOGraphicsAccelerator2 *)param_1[0xb5];
      (**(code **)(*(long *)pIVar4 + 0x858))(pIVar4,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar4);
      _IOLockUnlock(*(undefined8 *)(pIVar4 + 0x88));
      _thread_block(0);
      uVar10 = 1;
    }
    else {
      pIVar4 = (IOGraphicsAccelerator2 *)param_1[0xb5];
      (**(code **)(*(long *)pIVar4 + 0x858))(pIVar4,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar4);
      _IOLockUnlock(*(undefined8 *)(pIVar4 + 0x88));
      uVar10 = 2;
    }
    _IOSleep(uVar10);
    pIVar4 = (IOGraphicsAccelerator2 *)param_1[0xb5];
    _OSIncrementAtomic(pIVar4 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar4 + 0x88));
    _OSDecrementAtomic(pIVar4 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar4);
    param_2 = "";
    (**(code **)(*(long *)pIVar4 + 0x850))(pIVar4,"",0);
    param_3 = extraout_RDX_01;
  } while( true );
  if ((*(IOAccelResource2 **)(&DAT_000011c8 + param_1[0xb8]) != (IOAccelResource2 *)0x0) &&
     (*(char *)((long)param_1 + 0x10c9) != '\0')) {
    IOAccelResource2::setPurgeable
              (*(IOAccelResource2 **)(&DAT_000011c8 + param_1[0xb8]),1,2,(uint *)0x0);
  }
  this_00 = (IOAccelDrawable2 *)*plVar11;
  if (this_00 == (IOAccelDrawable2 *)0x0) {
    if ((IOAccelDrawable2 *)param_1[0x21c] != (IOAccelDrawable2 *)0x0) {
      plVar11 = param_1 + 0x21c;
      IOAccelDrawable2::checkDirty((IOAccelDrawable2 *)param_1[0x21c]);
      cVar6 = (**(code **)(*(long *)*plVar11 + 0x130))();
      if (cVar6 == '\0') {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Failed to wire down surface drawable\n",
                          "virtual uint32_t IOAccelGLContext2::processDataBuffers(uint32_t)");
        goto LAB_00019deb;
      }
LAB_00019cad:
      (**(code **)(*param_1 + 0xb40))(param_1,*plVar11);
      plVar11 = (long *)*plVar11;
      param_1[0x21b] = (long)plVar11;
      (**(code **)(*plVar11 + 0x20))();
    }
LAB_00019cce:
    if (uVar12 < 0x3e9) {
      uVar7 = IOAccelContext2::processDataBuffers(param_1);
      uVar12 = *(uint *)(param_1 + 0xd2);
      *(undefined4 *)(param_1 + 0xd2) = 0;
      if ((IOAccelDrawable2 *)param_1[0x21b] != (IOAccelDrawable2 *)0x0) {
        IOAccelDrawable2::dirtyLevel((IOAccelDrawable2 *)param_1[0x21b]);
        (**(code **)(*param_1 + 0xb48))(param_1,param_1[0x21b]);
      }
      uVar9 = 0;
      if ((uVar12 != 0) &&
         (this = (IOAccelSurface *)param_1[0xb8], uVar9 = 0, this != (IOAccelSurface *)0x0)) {
        uVar13 = 0;
        if ((uVar12 & 2) != 0) {
          if ((param_1[0xb9] == 0) ||
             ((iVar8 = *(int *)(param_1[0xb9] + 5000), iVar8 != 0 && (iVar8 < 3)))) {
            this[0xf3] = (IOAccelSurface)0x1;
            IOAccelSurface::update_previous_swap(this);
            uVar9 = 0x10000000;
            uVar5 = uVar12 & 1;
            uVar12 = 1;
            uVar13 = 0x10000000;
            if (uVar5 == 0) goto LAB_0001a0d3;
          }
          else {
            this[0xf3] = (IOAccelSurface)0x1;
            IOAccelSurface::update_previous_swap(this);
            uVar13 = 0;
          }
        }
        uVar9 = (**(code **)(*param_1 + 0xb70))(param_1,uVar12);
        uVar9 = uVar13 | uVar9;
      }
LAB_0001a0d3:
      if ((long *)param_1[0x21b] != (long *)0x0) {
        (**(code **)(*(long *)param_1[0x21b] + 0x138))();
        (**(code **)(*(long *)param_1[0x21b] + 0x28))();
        param_1[0x21b] = 0;
      }
      goto LAB_00019f59;
    }
  }
  else {
LAB_00019c90:
    IOAccelDrawable2::checkDirty(this_00);
    cVar6 = (**(code **)(*(long *)*plVar11 + 0x130))();
    if (cVar6 != '\0') goto LAB_00019cad;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Failed to wire down fbo drawable\n",
                      "virtual uint32_t IOAccelGLContext2::processDataBuffers(uint32_t)");
LAB_00019deb:
    uVar7 = 0x84000000;
  }
LAB_00019df1:
  (**(code **)(*param_1 + 0xa08))(param_1,param_1[0xc3],0);
  if (param_1[0x21b] != 0) {
    (**(code **)(*param_1 + 0xb48))(param_1);
    (**(code **)(*(long *)param_1[0x21b] + 0x138))();
    (**(code **)(*(long *)param_1[0x21b] + 0x28))();
    param_1[0x21b] = 0;
  }
  uVar12 = *(uint *)param_1[0xb6];
  if (uVar12 != 0) {
    uVar14 = 0;
    do {
      lVar2 = *(long *)(param_1[0xb7] + uVar14 * 8);
      if (lVar2 != 0) {
        (**(code **)(*param_1 + 0xaa0))(param_1,lVar2,uVar14 & 0xffffffff);
        (**(code **)(**(long **)(param_1[0xb7] + uVar14 * 8) + 0x178))();
        (**(code **)(**(long **)(param_1[0xb7] + uVar14 * 8) + 0x28))();
        *(undefined8 *)(param_1[0xb7] + uVar14 * 8) = 0;
        uVar12 = *(uint *)param_1[0xb6];
      }
      uVar14 = uVar14 + 1;
    } while (uVar14 < uVar12);
  }
  if ((((IOAccelResource2 *)param_1[0x1fc] != (IOAccelResource2 *)0x0) &&
      ((*(byte *)(param_1[0xb5] + 0xc92) & 4) != 0)) && (param_1[0xcb] != 0)) {
    IOAccelResource2::releaseKernelData((IOAccelResource2 *)param_1[0x1fc]);
    param_1[0xcb] = 0;
  }
  uVar12 = *(uint *)((long)param_1 + 0x6dc);
  if (uVar12 != 0) {
    uVar14 = 0;
    do {
      if (param_1[uVar14 + 0x1fc] != 0) {
        (**(code **)(*param_1 + 0xa98))(param_1,param_1[uVar14 + 0x1fc],uVar14 & 0xffffffff);
        (**(code **)(*(long *)param_1[uVar14 + 0x1fc] + 0x178))();
        (**(code **)(*(long *)param_1[uVar14 + 0x1fc] + 0x28))();
        param_1[uVar14 + 0x1fc] = 0;
        uVar12 = *(uint *)((long)param_1 + 0x6dc);
      }
      uVar14 = uVar14 + 1;
    } while (uVar14 < uVar12);
  }
  uVar9 = 0;
LAB_00019f59:
  pIVar4 = (IOGraphicsAccelerator2 *)param_1[0xb5];
  (**(code **)(*(long *)pIVar4 + 0x858))(pIVar4,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar4);
  _IOLockUnlock(*(undefined8 *)(pIVar4 + 0x88));
  iVar8 = (**(code **)(*param_1 + 0xb58))(param_1,(int)param_1[0x23e]);
  lVar2 = param_1[0xb5];
  IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar2 + 0x388) + 0x58),0x35);
  piVar1 = (int *)(lVar2 + 0x274);
  *piVar1 = *piVar1 + iVar8;
  pIVar4 = (IOGraphicsAccelerator2 *)param_1[0xb5];
  _OSIncrementAtomic(pIVar4 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar4 + 0x88));
  _OSDecrementAtomic(pIVar4 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar4);
  (**(code **)(*(long *)pIVar4 + 0x850))(pIVar4,"",0);
  return uVar9 | uVar7;
}



// IOGraphicsAccelerator2::acceleratorUnlock()

void __thiscall IOGraphicsAccelerator2::acceleratorUnlock(IOGraphicsAccelerator2 *this)

{
  (**(code **)(*(long *)this + 0x858))(this,"",0);
  unlock_busy(this);
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  return;
}



// IOGraphicsAccelerator2::acceleratorLock()

void __thiscall IOGraphicsAccelerator2::acceleratorLock(IOGraphicsAccelerator2 *this)

{
  _OSIncrementAtomic(this + 0x90);
  _IOLockLock(*(undefined8 *)(this + 0x88));
  _OSDecrementAtomic(this + 0x90);
  lock_busy(this);
                    // WARNING: Could not recover jumptable at 0x0001a18f. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x850))(this,"",0);
  return;
}



// IOAccelGLContext2::processSidebandToken(IOAccelCommandStreamInfo&)

void __thiscall IOAccelGLContext2::processSidebandToken(IOAccelGLContext2 *this,long param_1)

{
  bool bVar1;
  
  switch(*(undefined1 *)(param_1 + 0x21)) {
  case 0x40:
    bVar1 = IOAccelContext2::validateTokenSize((IOAccelContext2 *)this,param_1,2);
    if (bVar1) {
      if (*(char *)(param_1 + 0x3c) == '\0') {
LAB_0001a2c9:
        IOAccelContext2::process_token_Noop();
        return;
      }
      if (*(long *)(this + 0x5c0) != 0) {
        *(undefined1 *)(*(long *)(this + 0x5c0) + 0xf3) = 1;
      }
    }
    break;
  case 0x41:
    bVar1 = IOAccelContext2::validateTokenSize((IOAccelContext2 *)this,param_1,0);
    if (bVar1) {
      if (*(char *)(param_1 + 0x3c) == '\0') goto LAB_0001a2c9;
      *(undefined4 *)(param_1 + 0x40) = 3;
    }
    break;
  case 0x42:
    bVar1 = IOAccelContext2::validateTokenSize((IOAccelContext2 *)this,param_1,0);
    if (bVar1) {
      if (*(char *)(param_1 + 0x3c) == '\0') goto LAB_0001a2c9;
      *(undefined4 *)(param_1 + 0x40) = 2;
    }
    break;
  case 0x43:
    bVar1 = IOAccelContext2::validateTokenSize((IOAccelContext2 *)this,param_1,4);
    if (bVar1) {
      process_token_SetSurfaceState(this,param_1);
      return;
    }
    break;
  case 0x44:
    bVar1 = IOAccelContext2::validateTokenSize((IOAccelContext2 *)this,param_1,4);
    if (bVar1) {
      process_token_BindDrawFBO(this,param_1);
      return;
    }
    break;
  case 0x45:
    bVar1 = IOAccelContext2::validateTokenSize((IOAccelContext2 *)this,param_1,2);
    if (bVar1) {
      process_token_UnbindDrawFBO(this,param_1);
      return;
    }
    break;
  default:
    IOAccelContext2::processSidebandToken((IOAccelContext2 *)this,param_1);
    return;
  }
  return;
}



// IOAccelGLContext2::process_token_Swap(IOAccelCommandStreamInfo&)

void __thiscall IOAccelGLContext2::process_token_Swap(undefined8 param_1_00,long param_2)

{
  *(undefined4 *)(param_2 + 0x40) = 3;
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLContext2::process_token_UserEnd(IOAccelCommandStreamInfo&)

void __cdecl IOAccelGLContext2::process_token_UserEnd(long param_1)

{
  if (*(long *)(param_1 + 0x5c0) != 0) {
    *(undefined1 *)(*(long *)(param_1 + 0x5c0) + 0xf3) = 1;
  }
  return;
}



// IOAccelGLContext2::process_token_Flush(IOAccelCommandStreamInfo&)

void __thiscall IOAccelGLContext2::process_token_Flush(undefined8 param_1_00,long param_2)

{
  *(undefined4 *)(param_2 + 0x40) = 2;
  return;
}



// IOAccelGLContext2::process_token_SetSurfaceState(IOAccelCommandStreamInfo&)

void __thiscall
IOAccelGLContext2::process_token_SetSurfaceState(IOAccelGLContext2 *this,long param_1)

{
  if (**(int **)(param_1 + 0x28) == 0x132) {
    if (*(IOAccelSurface **)(this + 0x5c0) != (IOAccelSurface *)0x0) {
      IOAccelSurface::set_volatile_state
                (*(IOAccelSurface **)(this + 0x5c0),(*(int **)(param_1 + 0x28))[1]);
      return;
    }
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: bad enum (%d).\n",
                      "void IOAccelGLContext2::process_token_SetSurfaceState(IOAccelCommandStreamInfo &)"
                     );
  }
  return;
}



// IOAccelGLContext2::process_token_BindDrawFBO(IOAccelCommandStreamInfo&)

void __thiscall IOAccelGLContext2::process_token_BindDrawFBO(IOAccelGLContext2 *this,long param_1)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  long lVar4;
  char cVar5;
  bool bVar6;
  long *plVar7;
  ushort *puVar8;
  ulong uVar9;
  uint uVar10;
  ulong uVar11;
  long *local_58;
  IOAccelContext2 *local_50;
  ulong local_48;
  uint local_40;
  uint local_3c;
  long local_38;
  
  local_58 = (long *)&DAT_aaaaaaaaaaaaaaaa;
  uVar11 = (ulong)*(ushort *)(param_1 + 0x22);
  if (uVar11 < 4) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: BindDrawFBO token too small to fit header\n",
                      "void IOAccelGLContext2::process_token_BindDrawFBO(IOAccelCommandStreamInfo &)"
                     );
LAB_0001a633:
    *(undefined4 *)(this + 0x644) = 0xfffffffb;
    return;
  }
  lVar4 = *(long *)(param_1 + 0x18);
  bVar1 = *(byte *)(lVar4 + 0xe);
  if (0x20 < bVar1) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: too many attachments: %d\n",
                      "void IOAccelGLContext2::process_token_BindDrawFBO(IOAccelCommandStreamInfo &)"
                      ,bVar1);
    goto LAB_0001a633;
  }
  uVar9 = (ulong)bVar1 * 0xc + 0x10 >> 2;
  if (uVar9 != uVar11) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: unexpected token size, expected %zu, received %d\n",
                      "void IOAccelGLContext2::process_token_BindDrawFBO(IOAccelCommandStreamInfo &)"
                      ,uVar9,uVar11);
    goto LAB_0001a633;
  }
  local_38 = param_1;
  if (*(IOAccelDrawable2 **)(this + 0x10d8) != (IOAccelDrawable2 *)0x0) {
    IOAccelDrawable2::dirtyLevel(*(IOAccelDrawable2 **)(this + 0x10d8));
    (**(code **)(*(long *)this + 0xb48))(this,*(undefined8 *)(this + 0x10d8));
    (**(code **)(**(long **)(this + 0x10d8) + 0x138))();
  }
  if (*(long **)(this + 0x10e8) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x10e8) + 0x28))();
    *(undefined8 *)(this + 0x10e8) = 0;
  }
  plVar7 = (long *)(**(code **)(**(long **)(this + 0x5a8) + 0x8f8))
                             (*(long **)(this + 0x5a8),0,*(undefined8 *)(this + 0x5a0),
                              *(char *)(lVar4 + 0xd) != '\0');
  *(long **)(this + 0x10e8) = plVar7;
  if (plVar7 == (long *)0x0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to allocate memory\n",
                      "void IOAccelGLContext2::process_token_BindDrawFBO(IOAccelCommandStreamInfo &)"
                     );
    *(undefined4 *)(this + 0x644) = 0xfffffff9;
    return;
  }
  if (bVar1 == 0) {
LAB_0001a5bb:
    (**(code **)(*plVar7 + 0x140))(plVar7);
    if ((*(char *)(local_38 + 0x3c) != '\0') &&
       (bVar6 = IOAccelDrawable2::checkDirty(*(IOAccelDrawable2 **)(this + 0x10e8)), bVar6)) {
      (**(code **)(*(long *)this + 0xa38))(this,local_38);
      bVar6 = true;
      goto LAB_0001a684;
    }
  }
  else {
    puVar8 = (ushort *)(lVar4 + 0x1a);
    uVar11 = 0;
    local_50 = (IOAccelContext2 *)this;
    do {
      this = (IOAccelGLContext2 *)local_50;
      uVar10 = *(uint *)(puVar8 + -5);
      if (uVar10 == 0x10) {
        uVar10 = 0x1e;
      }
      else if (uVar10 == 0x11) {
        uVar10 = 0x1f;
      }
      else if (0xf < uVar10) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: unknown buffer_index %d for fbo attachment\n",
                          "void IOAccelGLContext2::process_token_BindDrawFBO(IOAccelCommandStreamInfo &)"
                          ,uVar10);
        goto LAB_0001a633;
      }
      cVar5 = IOAccelContext2::lookupResource(local_50,*(uint *)(puVar8 + -3),(long *)&local_58);
      plVar7 = local_58;
      if (cVar5 == '\0') {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: bogus texture id (id=%d) at attachment %d\n",
                          "void IOAccelGLContext2::process_token_BindDrawFBO(IOAccelCommandStreamInfo &)"
                          ,*(undefined4 *)(puVar8 + -3),uVar11);
LAB_0001a787:
        *(undefined4 *)((IOAccelContext2 *)this + 0x644) = 0xfffffffe;
        return;
      }
      bVar2 = (byte)puVar8[-1];
      bVar3 = *(byte *)((long)puVar8 + -1);
      local_48 = uVar11;
      local_40 = uVar10;
      if ((*(byte *)((long)local_58 + 0xac) < bVar2) || (*(byte *)((long)local_58 + 0xad) < bVar3))
      {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: out of range face (%d, %d) and level (%d, %d) at attachment %d\n",
                          "void IOAccelGLContext2::process_token_BindDrawFBO(IOAccelCommandStreamInfo &)"
                          ,uVar11,bVar2,*(byte *)((long)local_58 + 0xac),bVar3,
                          *(byte *)((long)local_58 + 0xad));
        goto LAB_0001a787;
      }
      lVar4 = *(long *)(local_50 + 0x10e8);
      local_3c = (uint)*puVar8;
      (**(code **)(*local_58 + 0x20))(local_58);
      uVar11 = (ulong)local_40;
      *(long **)(lVar4 + 0x28 + uVar11 * 8) = plVar7;
      *(uint *)(lVar4 + 0x140) = *(uint *)(lVar4 + 0x140) | 1 << ((byte)local_40 & 0x1f);
      *(byte *)(lVar4 + 0x1c4 + uVar11) = bVar2;
      *(byte *)(lVar4 + 0x1e4 + uVar11) = bVar3;
      *(uint *)(lVar4 + 0x144 + uVar11 * 4) = local_3c;
      uVar11 = local_48 + 1;
      puVar8 = puVar8 + 6;
    } while (bVar1 != uVar11);
    plVar7 = *(long **)(local_50 + 0x10e8);
    this = (IOAccelGLContext2 *)local_50;
    if (plVar7 != (long *)0x0) goto LAB_0001a5bb;
  }
  bVar6 = false;
LAB_0001a684:
  if (*(long **)(this + 0x10d8) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x10d8) + 0x28))();
    *(long *)(this + 0x10d8) = 0;
  }
  if (*(long **)(this + 0x10e8) != (long *)0x0) {
    cVar5 = (**(code **)(**(long **)(this + 0x10e8) + 0x130))();
    if ((cVar5 == '\0') &&
       ((cVar5 = (**(code **)(*(long *)this + 0xa50))(this), cVar5 == '\0' ||
        (cVar5 = (**(code **)(**(long **)(this + 0x10e8) + 0x130))(), cVar5 == '\0')))) {
      if (bVar6) {
        (**(code **)(*(long *)this + 0xa30))(this,local_38);
      }
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: prepare failed\n",
                        "void IOAccelGLContext2::process_token_BindDrawFBO(IOAccelCommandStreamInfo &)"
                       );
      *(undefined1 *)(local_38 + 0x3c) = 0;
      return;
    }
    (**(code **)(*(long *)this + 0xb40))(this,*(long *)(this + 0x10e8));
    *(long **)(this + 0x10d8) = *(long **)(this + 0x10e8);
    (**(code **)(**(long **)(this + 0x10e8) + 0x20))();
    if (bVar6) {
      (**(code **)(*(long *)this + 0xa30))(this,local_38);
    }
    IOAccelDrawable2::dirtyLevel(*(IOAccelDrawable2 **)(this + 0x10d8));
    return;
  }
  return;
}



// IOAccelGLContext2::process_token_UnbindDrawFBO(IOAccelCommandStreamInfo&)

void __thiscall IOAccelGLContext2::process_token_UnbindDrawFBO(IOAccelGLContext2 *this,long param_1)

{
  char cVar1;
  bool bVar2;
  
  if (*(IOAccelDrawable2 **)(this + 0x10d8) != (IOAccelDrawable2 *)0x0) {
    IOAccelDrawable2::dirtyLevel(*(IOAccelDrawable2 **)(this + 0x10d8));
    (**(code **)(*(long *)this + 0xb48))(this,*(undefined8 *)(this + 0x10d8));
    (**(code **)(**(long **)(this + 0x10d8) + 0x138))();
  }
  if (*(long **)(this + 0x10e8) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x10e8) + 0x28))();
    *(undefined8 *)(this + 0x10e8) = 0;
  }
  if ((*(long *)(this + 0x5c0) != 0) && ((&DAT_0000118c)[*(long *)(this + 0x5c0)] == '\0')) {
    bVar2 = false;
    if ((*(IOAccelDrawable2 **)(this + 0x10e0) == (IOAccelDrawable2 *)0x0) ||
       (*(char *)(param_1 + 0x3c) == '\0')) goto LAB_0001a8bc;
    bVar2 = IOAccelDrawable2::checkDirty(*(IOAccelDrawable2 **)(this + 0x10e0));
    if (bVar2) {
      (**(code **)(*(long *)this + 0xa38))(this,param_1);
      bVar2 = true;
      goto LAB_0001a8bc;
    }
  }
  bVar2 = false;
LAB_0001a8bc:
  if (*(long **)(this + 0x10d8) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x10d8) + 0x28))();
    *(undefined8 *)(this + 0x10d8) = 0;
  }
  if ((*(long **)(this + 0x10e0) != (long *)0x0) && (*(char *)(param_1 + 0x3c) != '\0')) {
    cVar1 = (**(code **)(**(long **)(this + 0x10e0) + 0x130))();
    if (cVar1 != '\0') {
      (**(code **)(*(long *)this + 0xb40))(this,*(undefined8 *)(this + 0x10e0));
      *(long **)(this + 0x10d8) = *(long **)(this + 0x10e0);
      (**(code **)(**(long **)(this + 0x10e0) + 0x20))();
      if (bVar2) {
        (**(code **)(*(long *)this + 0xa30))(this,param_1);
      }
      IOAccelDrawable2::dirtyLevel(*(IOAccelDrawable2 **)(this + 0x10d8));
      return;
    }
    if (bVar2) {
      (**(code **)(*(long *)this + 0xa30))(this,param_1);
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: fSurface->fDrawable->prepare failed\n",
                      "void IOAccelGLContext2::process_token_UnbindDrawFBO(IOAccelCommandStreamInfo &)"
                     );
    *(char *)(param_1 + 0x3c) = '\0';
  }
  return;
}



// IOAccelGLContext2::discardSidebandToken(IOAccelCommandStreamInfo&)

void __thiscall IOAccelGLContext2::discardSidebandToken(IOAccelGLContext2 *this,long param_1)

{
  processSidebandToken(this,param_1);
  return;
}



// IOAccelGLContext2::bind_surface_drawable()

undefined8 __thiscall IOAccelGLContext2::bind_surface_drawable(IOAccelGLContext2 *this)

{
  long lVar1;
  undefined8 uVar2;
  
  lVar1 = *(long *)(this + 0x5c0);
  if ((lVar1 == 0) || ((&DAT_0000118c)[lVar1] != '\0')) {
    uVar2 = 0;
  }
  else {
    uVar2 = CONCAT71((int7)((ulong)lVar1 >> 8),*(long *)(this + 0x10e0) != 0);
  }
  return uVar2;
}



// IOAccelGLContext2::removeSurface()

void __thiscall IOAccelGLContext2::removeSurface(IOAccelGLContext2 *this)

{
  if (*(long **)(this + 0x10e0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x10e0) + 0x28))();
    *(undefined8 *)(this + 0x10e0) = 0;
  }
  *(undefined8 *)(this + 0x5c0) = 0;
  return;
}



// IOAccelGLContext2::getSurfaceReqBits() const

undefined4 __thiscall IOAccelGLContext2::getSurfaceReqBits(IOAccelGLContext2 *this)

{
  return *(undefined4 *)(this + 0x10b8);
}



// IOAccelGLContext2::requiresBackingStore() const

IOAccelGLContext2 __thiscall IOAccelGLContext2::requiresBackingStore(IOAccelGLContext2 *this)

{
  return this[0x10c8];
}



// IOAccelGLContext2::allowsExclusiveMode() const

undefined1 IOAccelGLContext2::allowsExclusiveMode(void)

{
  return 1;
}



// IOAccelGLContext2::isTripleBuffered() const

IOAccelGLContext2 __thiscall IOAccelGLContext2::isTripleBuffered(IOAccelGLContext2 *this)

{
  return this[0x10b4];
}



// IOAccelGLContext2::contextModeBits() const

undefined8 IOAccelGLContext2::contextModeBits(void)

{
  return 0x300803fc0;
}



// IOAccelGLContext2::set_compatible_surface_mode(unsigned long long*, unsigned long long, unsigned
// int)

undefined8 __thiscall
IOAccelGLContext2::set_compatible_surface_mode
          (IOAccelGLContext2 *this,ulong *param_1,ulong param_2,uint param_3)

{
  ulong in_RAX;
  undefined8 uVar1;
  
  if ((((param_2 & 0x300) == 0) || (in_RAX = 0, (param_3 & 0x40) == 0)) ||
     (in_RAX = (ulong)(param_3 >> 9), (((uint)(param_2 >> 0xd) & 0x7ffff ^ param_3 >> 9) & 1) == 0))
  {
    uVar1 = CONCAT71((int7)(in_RAX >> 8),1);
    if ((*param_1 & 0xffffffffff8073c0) != (param_2 & 0xfffffffcff7fc03f)) {
                    // WARNING: Could not recover jumptable at 0x0001aadb. Too many branches
                    // WARNING: Treating indirect jump as call
      uVar1 = (**(code **)(*(long *)this + 0xb50))();
      return uVar1;
    }
  }
  else {
    uVar1 = 0;
  }
  return uVar1;
}



// IOAccelGLContext2::set_surface(IOAccelGLContextSetSurfaceData*)

undefined8 __thiscall IOAccelGLContext2::set_surface(IOAccelGLContext2 *this,ulong *param_1)

{
  int iVar1;
  IOGraphicsAccelerator2 *pIVar2;
  ulong uVar3;
  IOAccelSurface *this_00;
  IOAccelSurface *pIVar4;
  ulong uVar5;
  undefined8 uVar6;
  long *plVar7;
  IOAccelLegacyDisplayMachine *pIVar8;
  uint uVar9;
  bool bVar10;
  uint uVar11;
  ulong uVar12;
  uint uVar13;
  uint uVar14;
  
  uVar12 = *param_1;
  if ((uVar12 & 0x7f803f) != 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Context mode contains surface mode bits\n",
                      "IOReturn IOAccelGLContext2::set_surface(sIOAccelGLContextSetSurfaceData *)");
    return 0xe00002c2;
  }
  iVar1 = (int)param_1[1];
  uVar13 = (uint)param_1[2];
  uVar14 = *(uint *)((long)param_1 + 0x14);
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  _OSIncrementAtomic(pIVar2 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar2 + 0x88));
  _OSDecrementAtomic(pIVar2 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar2);
  this_00 = (IOAccelSurface *)0x0;
  (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
  if (iVar1 != 0) {
    this_00 = (IOAccelSurface *)
              IOAccelSurfaceList::findSurfaceForID
                        ((IOAccelSurfaceList *)(*(long *)(this + 0x5a8) + 0xaa8),iVar1);
    if (this_00 == (IOAccelSurface *)0x0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Invalid surface ID = %u\n",
                        "IOReturn IOAccelGLContext2::set_surface(sIOAccelGLContextSetSurfaceData *)"
                        ,iVar1);
LAB_0001ad92:
      pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
      (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar2);
      _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
      return 0xe00002c2;
    }
    uVar3 = *(ulong *)(this_00 + 0x11b0);
    if ((uVar3 & 0x700000) == 0) {
      if (uVar13 != 0 || uVar14 != 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Invalid face = %u or level = %u\n",
                          "IOReturn IOAccelGLContext2::set_surface(sIOAccelGLContextSetSurfaceData *)"
                          ,uVar13,uVar14);
        goto LAB_0001ad92;
      }
    }
    else {
      if (((uint)uVar3 & 0x700000) == 0x300000) {
        if (5 < uVar13) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Invalid face = %u\n",
                            "IOReturn IOAccelGLContext2::set_surface(sIOAccelGLContextSetSurfaceData *)"
                            ,uVar13);
          goto LAB_0001ae01;
        }
      }
      else if (uVar13 != 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Invalid face = %u\n",
                          "IOReturn IOAccelGLContext2::set_surface(sIOAccelGLContextSetSurfaceData *)"
                          ,uVar13);
        goto LAB_0001ad92;
      }
      if (((uint)(uVar3 >> 0x10) & 0xf) < uVar14) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Invalid level = %u\n",
                          "IOReturn IOAccelGLContext2::set_surface(sIOAccelGLContextSetSurfaceData *)"
                          ,uVar14);
LAB_0001ae01:
        IOGraphicsAccelerator2::acceleratorUnlock(*(IOGraphicsAccelerator2 **)(this + 0x5a8));
        return 0xe00002c2;
      }
    }
  }
  plVar7 = *(long **)(this + 0x5c0);
  if (plVar7 != (long *)0x0) {
    (**(code **)(*plVar7 + 0xa00))(plVar7,this);
    if (*(IOAccelSurface **)(this + 0x5c0) != this_00) {
      (**(code **)(*(long *)*(IOAccelSurface **)(this + 0x5c0) + 0x9e0))();
      if (*(IOAccelLegacySurface **)(this + 0x5c8) != (IOAccelLegacySurface *)0x0) {
        IOAccelLegacySurface::pick_present_type(*(IOAccelLegacySurface **)(this + 0x5c8));
      }
    }
  }
  if (this_00 == (IOAccelSurface *)0x0) {
    if (*(long **)(this + 0x10e0) != (long *)0x0) {
      (**(code **)(**(long **)(this + 0x10e0) + 0x28))();
      *(undefined8 *)(this + 0x10e0) = 0;
    }
    uVar13 = 0;
    *(undefined8 *)(this + 0x5c0) = 0;
    *(undefined8 *)(this + 0x5c8) = 0;
    uVar14 = 0;
    uVar6 = 0;
    goto LAB_0001b0fb;
  }
  if ((*(ulong *)(this_00 + 0x11b0) & 0xc00) != 0) {
    if (((uint)*(ulong *)(this_00 + 0x11b0) >> 0xb & 1) == 0) {
      uVar12 = uVar12 & 0xfffffffffffff3ff | 0x400;
    }
    else {
      uVar12 = uVar12 & 0xfffffffffffff3ff | 0x800;
    }
  }
  if (*(long *)(this + 0x5c0) == 0) {
    pIVar4 = (IOAccelSurface *)0x0;
  }
  else {
    (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
              (*(long **)(*(long *)(this + 0x5a8) + 0x380),&DAT_00001128 + *(long *)(this + 0x5c0),
               this_00 + 0x1128);
    pIVar4 = *(IOAccelSurface **)(this + 0x5c0);
  }
  if (this_00 != pIVar4) {
    (**(code **)(*(long *)this_00 + 0x9e8))(this_00);
  }
  uVar5 = IOAccelSurface::set_compatible_surface_mode(this_00,(long *)this,uVar12);
  uVar3 = *(ulong *)(this_00 + 0x11b0);
  uVar11 = (uint)uVar12;
  if ((uVar3 & 0x700000) == 0) {
    if (((uVar13 == 0 && uVar14 == 0) & (byte)uVar5) != 1) goto LAB_0001b090;
  }
  else {
    bVar10 = uVar13 == 0;
    if (((uint)uVar3 & 0x700000) == 0x300000) {
      bVar10 = uVar13 < 6;
    }
    if ((byte)(uVar14 <= ((uint)(uVar3 >> 0x10) & 0xf) & bVar10 & (byte)uVar5) == 0) {
LAB_0001b090:
      if (*(IOAccelSurface **)(this + 0x5c0) == this_00) {
        (**(code **)(*(long *)this_00 + 0x9e0))(this_00);
        (**(code **)(**(long **)(this + 0x5c0) + 0x9d8))();
        if (((*(IOAccelLegacySurface **)(this + 0x5c8) != (IOAccelLegacySurface *)0x0) &&
            (IOAccelLegacySurface::pick_present_type(*(IOAccelLegacySurface **)(this + 0x5c8)),
            (*(byte *)((long)&DAT_000011b0 + *(long *)(this + 0x5c8) + 1) & 0x80) != 0)) &&
           (pIVar8 = (IOAccelLegacyDisplayMachine *)
                     OSMetaClassBase::safeMetaCast
                               (*(OSMetaClassBase **)(this + 0x10c0),
                                (OSMetaClass *)&IOAccelLegacyDisplayMachine::gMetaClass),
           pIVar8 != (IOAccelLegacyDisplayMachine *)0x0)) {
          IOAccelLegacyDisplayMachine::setup_fullscreen(pIVar8,*(long *)(this + 0x5c8));
        }
      }
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Bad match mode = 0x%X\n",
                        "IOReturn IOAccelGLContext2::set_surface(sIOAccelGLContextSetSurfaceData *)"
                        ,uVar12 & 0xffffffff);
      if (*(long **)(this + 0x10e0) != (long *)0x0) {
        (**(code **)(**(long **)(this + 0x10e0) + 0x28))();
        *(undefined8 *)(this + 0x10e0) = 0;
      }
      *(undefined8 *)(this + 0x5c0) = 0;
      *(undefined8 *)(this + 0x5c8) = 0;
      uVar6 = 0xe00002c2;
      goto LAB_0001b0fb;
    }
  }
  *(undefined4 *)(this + 0x10b8) = 0;
  this[0x10b4] = (IOAccelGLContext2)((byte)(uVar12 >> 0x20) & 1);
  this[0x10c8] = (IOAccelGLContext2)((byte)(uVar12 >> 0x17) & 1);
  this[0x10c9] = (IOAccelGLContext2)((byte)(uVar12 >> 0x21) & 1);
  uVar9 = uVar11 & 0x1000 |
          ((uint)(uVar12 >> 0xb) & 1 | (uint)(uVar12 >> 9) & 2) + (uVar11 & 0x40) * 4;
  if ((uVar12 & 0x1c40) != 0) {
    *(uint *)(this + 0x10b8) = uVar9;
  }
  if ((uVar12 & 0x300) != 0) {
    uVar9 = (uint)(uVar12 >> 4) & 0x200 | uVar9;
    *(uint *)(this + 0x10b8) = uVar9 | 0x40;
    if ((0x1ff < (uint)(uVar12 & 0x300)) &&
       (*(uint *)(this + 0x10b8) = uVar9 | 0xc0, (uVar11 >> 0xd & 1) != 0)) {
      *(uint *)(this + 0x10b8) = uVar9 | 0x4c0;
    }
  }
  (**(code **)(*(long *)this + 0xb60))(this,uVar12);
  if (*(long **)(this + 0x10e0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x10e0) + 0x28))();
    *(undefined8 *)(this + 0x10e0) = 0;
  }
  (**(code **)(*(long *)this_00 + 0x9f8))(this_00,this);
  *(IOAccelSurface **)(this + 0x5c0) = this_00;
  uVar6 = OSMetaClassBase::safeMetaCast
                    ((OSMetaClassBase *)this_00,(OSMetaClass *)&IOAccelLegacySurface::gMetaClass);
  *(undefined8 *)(this + 0x5c8) = uVar6;
  (**(code **)(**(long **)(this + 0x5c0) + 0x9e0))();
  (**(code **)(**(long **)(this + 0x5c0) + 0x9d8))();
  if (*(IOAccelLegacySurface **)(this + 0x5c8) != (IOAccelLegacySurface *)0x0) {
    IOAccelLegacySurface::pick_present_type(*(IOAccelLegacySurface **)(this + 0x5c8));
  }
  plVar7 = IOAccelSurface::get_drawable
                     (this_00,*(IOAccelShared2 **)(this + 0x5a0),*(uint *)(this + 0x10b8),
                      *(uint *)(this + 0x10cc),*(uint *)(this + 0x10d0));
  *(long **)(this + 0x10e0) = plVar7;
  uVar6 = 0;
  if (((*(long *)(this + 0x5c8) != 0) &&
      ((*(byte *)((long)&DAT_000011b0 + *(long *)(this + 0x5c8) + 1) & 0x80) != 0)) &&
     (pIVar8 = (IOAccelLegacyDisplayMachine *)
               OSMetaClassBase::safeMetaCast
                         (*(OSMetaClassBase **)(this + 0x10c0),
                          (OSMetaClass *)&IOAccelLegacyDisplayMachine::gMetaClass),
     pIVar8 != (IOAccelLegacyDisplayMachine *)0x0)) {
    IOAccelLegacyDisplayMachine::setup_fullscreen(pIVar8,*(long *)(this + 0x5c8));
    uVar6 = 0;
  }
LAB_0001b0fb:
  *(uint *)(this + 0x10cc) = uVar13;
  *(uint *)(this + 0x10d0) = uVar14;
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar2);
  _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
  return uVar6;
}



// IOAccelGLContext2::set_swap_rect(int, int, int, int)

undefined8 __thiscall
IOAccelGLContext2::set_swap_rect
          (IOAccelGLContext2 *this,undefined2 param_1,undefined2 param_2,undefined2 param_3,
          undefined2 param_4)

{
  *(undefined2 *)(this + 0x10a8) = param_1;
  *(undefined2 *)(this + 0x10aa) = param_2;
  *(undefined2 *)(this + 0x10ac) = param_3;
  *(undefined2 *)(this + 0x10ae) = param_4;
  return 0;
}



// IOAccelGLContext2::set_swap_interval(int, int)

undefined8 __thiscall
IOAccelGLContext2::set_swap_interval(IOAccelGLContext2 *this,undefined2 param_1,undefined2 param_2)

{
  *(undefined2 *)(this + 0x10b0) = param_1;
  *(undefined2 *)(this + 0x10b2) = param_2;
  return 0;
}



// IOAccelGLContext2::set_surface_volatile_state(unsigned int)

undefined8 __thiscall
IOAccelGLContext2::set_surface_volatile_state(IOAccelGLContext2 *this,int param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (*(IOAccelSurface **)(this + 0x5c0) != (IOAccelSurface *)0x0) {
    IOAccelSurface::set_volatile_state(*(IOAccelSurface **)(this + 0x5c0),param_1);
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return 0;
}



// IOAccelGLContext2::get_config(unsigned int*)

undefined8 __thiscall IOAccelGLContext2::get_config(IOAccelGLContext2 *this,uint *param_1)

{
  undefined4 uVar1;
  undefined8 uVar2;
  IOGraphicsAccelerator2 *pIVar3;
  
  pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  _OSIncrementAtomic(pIVar3 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar3 + 0x88));
  _OSDecrementAtomic(pIVar3 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar3);
  uVar2 = 0;
  (**(code **)(*(long *)pIVar3 + 0x850))(pIVar3,"",0);
  if ((*(long *)(this + 0x5c0) != 0) &&
     ((*(long *)(this + 0x5c8) == 0 || (0xff < *(uint *)(&DAT_00001168 + *(long *)(this + 0x5c8)))))
     ) {
    uVar1 = IOGraphicsAccelerator2::acceleratorWaitEnabled
                      (*(IOGraphicsAccelerator2 **)(this + 0x5a8));
    if ((char)uVar1 == '\0') {
      pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
      uVar2 = 0xe00002c0;
      goto LAB_0001b34b;
    }
  }
  pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  *param_1 = (uint)*(ushort *)(pIVar3 + 0xc90);
LAB_0001b34b:
  (**(code **)(*(long *)pIVar3 + 0x858))(pIVar3,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar3);
  _IOLockUnlock(*(undefined8 *)(pIVar3 + 0x88));
  return uVar2;
}



// IOAccelGLContext2::get_status(unsigned int*)

undefined8 __thiscall IOAccelGLContext2::get_status(IOAccelGLContext2 *this,undefined4 *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined4 uVar2;
  long lVar3;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  lVar3 = *(long *)(this + 0x5c0);
  if (lVar3 != 0) {
    if ((*(long *)(this + 0x5c8) == 0) ||
       (0xff < *(uint *)(&DAT_00001168 + *(long *)(this + 0x5c8)))) {
      uVar2 = IOGraphicsAccelerator2::acceleratorWaitEnabled
                        (*(IOGraphicsAccelerator2 **)(this + 0x5a8));
      if ((char)uVar2 == '\0') {
        *param_1 = 0;
        pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
        (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
        IOGraphicsAccelerator2::unlock_busy(pIVar1);
        _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
        return 0xe00002c0;
      }
      lVar3 = *(long *)(this + 0x5c0);
      if (lVar3 == 0) goto LAB_0001b429;
    }
    if ((&DAT_0000118c)[lVar3] == '\0') {
      (**(code **)(*(long *)this + 0xb68))(this,*(undefined8 *)(this + 0x10e0),param_1);
      goto LAB_0001b430;
    }
  }
LAB_0001b429:
  *param_1 = 0;
LAB_0001b430:
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return 0;
}



// IOAccelGLContext2::get_surface_size(unsigned int*, unsigned int*, unsigned int*, unsigned int*)

undefined8 __thiscall
IOAccelGLContext2::get_surface_size
          (IOAccelGLContext2 *this,uint *param_1,uint *param_2,uint *param_3,uint *param_4)

{
  short sVar1;
  long lVar2;
  undefined *puVar3;
  undefined8 uVar4;
  int iVar5;
  uint uVar6;
  
  lVar2 = *(long *)(this + 0x5c0);
  if (lVar2 == 0) {
    uVar4 = 0xe00002bc;
  }
  else {
    sVar1 = *(short *)(&DAT_000011bc + lVar2);
    if ((*(short *)(&DAT_000011b8 + lVar2) == sVar1) &&
       (*(short *)(&DAT_000011ba + lVar2) == *(short *)(&DAT_000011be + lVar2))) {
      puVar3 = &DAT_000011be;
      *param_1 = (int)sVar1;
    }
    else {
      *param_1 = (int)*(short *)(&DAT_000011b8 + lVar2);
      puVar3 = &DAT_000011ba;
    }
    uVar6 = (uint)*(short *)(puVar3 + lVar2);
    *param_2 = uVar6;
    if (0 < *(int *)(this + 0x10d0)) {
      iVar5 = *(int *)(this + 0x10d0) + 1;
      do {
        if (1 < *param_1) {
          *param_1 = *param_1 >> 1;
          uVar6 = *param_2;
        }
        if (1 < uVar6) {
          uVar6 = uVar6 >> 1;
          *param_2 = uVar6;
        }
        iVar5 = iVar5 + -1;
      } while (1 < iVar5);
    }
    *param_3 = (int)sVar1;
    uVar6 = (uint)*(short *)(&DAT_000011be + lVar2);
    *param_4 = uVar6;
    uVar4 = 0;
    if (0 < *(int *)(this + 0x10d0)) {
      iVar5 = *(int *)(this + 0x10d0) + 1;
      do {
        if (1 < *param_3) {
          *param_3 = *param_3 >> 1;
          uVar6 = *param_4;
        }
        if (1 < uVar6) {
          uVar6 = uVar6 >> 1;
          *param_4 = uVar6;
        }
        iVar5 = iVar5 + -1;
      } while (1 < iVar5);
    }
  }
  return uVar4;
}



// IOAccelGLContext2::get_surface_info(unsigned int, unsigned int*, unsigned int*, unsigned int*)

undefined8 __thiscall
IOAccelGLContext2::get_surface_info
          (IOAccelGLContext2 *this,int param_1,uint *param_2,int *param_3,int *param_4)

{
  uint uVar1;
  IOGraphicsAccelerator2 *pIVar2;
  undefined *puVar3;
  long lVar4;
  uint uVar5;
  int iVar6;
  undefined8 uVar7;
  
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  _OSIncrementAtomic(pIVar2 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar2 + 0x88));
  _OSDecrementAtomic(pIVar2 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar2);
  iVar6 = 0;
  (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
  if (param_1 != 0) {
    lVar4 = IOAccelSurfaceList::findSurfaceForID
                      ((IOAccelSurfaceList *)(*(long *)(this + 0x5a8) + 0xaa8),param_1);
    if (lVar4 != 0) {
      uVar1 = *(uint *)((long)&DAT_000011b0 + lVar4);
      *param_2 = uVar1;
      uVar5 = 0x200;
      if (((*(uint *)((long)&DAT_00001190 + lVar4) & 0x80) != 0) ||
         (uVar5 = 0x100, (*(uint *)((long)&DAT_00001190 + lVar4) & 0x40) != 0)) {
        *param_2 = uVar5 | uVar1;
      }
      if ((*(short *)(&DAT_000011b8 + lVar4) == *(short *)(&DAT_000011bc + lVar4)) &&
         (*(short *)(&DAT_000011ba + lVar4) == *(short *)(&DAT_000011be + lVar4))) {
        puVar3 = &DAT_000011be;
        *param_3 = (int)*(short *)(&DAT_000011bc + lVar4);
      }
      else {
        *param_3 = (int)*(short *)(&DAT_000011b8 + lVar4);
        puVar3 = &DAT_000011ba;
      }
      iVar6 = (int)*(short *)(puVar3 + lVar4);
      uVar7 = 0;
      goto LAB_0001b6ec;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Invalid surface ID = %u\n",
                      "IOReturn IOAccelGLContext2::get_surface_info(uint32_t, uint32_t *, uint32_t *, uint32_t *)"
                      ,param_1);
  }
  *param_2 = 0;
  *param_3 = 0;
  uVar7 = 0xe00002c2;
LAB_0001b6ec:
  *param_4 = iVar6;
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar2);
  _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
  return uVar7;
}



// IOAccelGLContext2::read_buffer(IOAccelGLContextReadBufferData*)

undefined8 __thiscall IOAccelGLContext2::read_buffer(IOAccelGLContext2 *this,long *param_1)

{
  int *piVar1;
  int iVar2;
  long *plVar3;
  uint uVar4;
  bool bVar5;
  undefined *puVar6;
  IOAccelGLContext2 *pIVar7;
  char cVar8;
  undefined4 uVar9;
  int iVar10;
  IOAccelLegacyDisplayMachine *this_00;
  long lVar11;
  ulong uVar12;
  IOAccelSysMemory *pIVar13;
  byte bVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  IOGraphicsAccelerator2 *pIVar19;
  uint uVar20;
  uint uVar21;
  undefined8 uVar22;
  ulong uVar23;
  ulong uVar24;
  IOAccelResource2 *pIVar25;
  ulong uVar26;
  undefined1 *local_a8;
  undefined1 *local_a0;
  undefined1 *local_98;
  undefined1 *local_90;
  undefined1 *local_88;
  undefined1 *local_80;
  undefined1 *local_78;
  undefined1 *local_70;
  long local_68;
  ulong local_60;
  IOAccelResource2 *local_58;
  ulong local_50;
  ulong local_48;
  IOAccelGLContext2 *local_40;
  IOAccelSysMemory *local_38;
  int iVar18;
  
  local_68 = *param_1;
  uVar22 = 0xe00002c2;
  if (local_68 == 0) {
    return 0xe00002c2;
  }
  if (*(int *)((long)param_1 + 0x1c) == 0) {
    return 0xe00002c2;
  }
  if (0x10 < *(uint *)(param_1 + 3)) {
    return 0xe00002c2;
  }
  local_50 = (ulong)*(uint *)(param_1 + 1);
  local_58 = (IOAccelResource2 *)(ulong)*(uint *)((long)param_1 + 0x14);
  uVar9 = 1;
  bVar5 = false;
  switch(*(uint *)(param_1 + 3)) {
  case 0:
    goto switchD_0001b798_caseD_0;
  case 1:
    uVar9 = 0;
    bVar5 = true;
    goto switchD_0001b798_caseD_0;
  case 2:
    uVar9 = 4;
    break;
  case 3:
    uVar9 = 3;
    break;
  default:
    goto switchD_0001b798_caseD_4;
  case 5:
    uVar9 = 6;
    break;
  case 6:
    uVar9 = 7;
    break;
  case 8:
    uVar9 = 9;
    break;
  case 9:
    uVar9 = 10;
    break;
  case 0x10:
    uVar9 = 8;
  }
  bVar5 = false;
switchD_0001b798_caseD_0:
  local_60 = CONCAT44(local_60._4_4_,uVar9);
  local_48 = CONCAT44(local_48._4_4_,*(undefined4 *)((long)param_1 + 0xc));
  local_38 = (IOAccelSysMemory *)CONCAT44(local_38._4_4_,(int)param_1[2]);
  pIVar19 = *(IOGraphicsAccelerator2 **)(this + 0x5a8);
  local_40 = this;
  _OSIncrementAtomic(pIVar19 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar19 + 0x88));
  _OSDecrementAtomic(pIVar19 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar19);
  pIVar7 = local_40;
  (**(code **)(*(long *)pIVar19 + 0x850))(pIVar19,"",0);
  lVar11 = *(long *)(pIVar7 + 0x5c0);
  if (lVar11 == 0) {
LAB_0001b894:
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: No surface or surface is disabled\n"
                      ,"IOReturn IOAccelGLContext2::read_buffer(sIOAccelGLContextReadBufferData *)")
    ;
    pIVar19 = *(IOGraphicsAccelerator2 **)(pIVar7 + 0x5a8);
    (**(code **)(*(long *)pIVar19 + 0x858))(pIVar19,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar19);
    _IOLockUnlock(*(undefined8 *)(pIVar19 + 0x88));
  }
  else {
    if ((*(long *)(pIVar7 + 0x5c8) == 0) ||
       (0xff < *(uint *)(&DAT_00001168 + *(long *)(pIVar7 + 0x5c8)))) {
      uVar9 = IOGraphicsAccelerator2::acceleratorWaitEnabled
                        (*(IOGraphicsAccelerator2 **)(pIVar7 + 0x5a8));
      if ((char)uVar9 == '\0') {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: %s device terminated\n",
                          "IOReturn IOAccelGLContext2::read_buffer(sIOAccelGLContextReadBufferData *)"
                          ,*(undefined8 *)(*(long *)(pIVar7 + 0x5a8) + 0xc88));
        pIVar19 = *(IOGraphicsAccelerator2 **)(pIVar7 + 0x5a8);
        (**(code **)(*(long *)pIVar19 + 0x858))(pIVar19,"",0);
        IOGraphicsAccelerator2::unlock_busy(pIVar19);
        _IOLockUnlock(*(undefined8 *)(pIVar19 + 0x88));
        return 0xe00002c0;
      }
      lVar11 = *(long *)(pIVar7 + 0x5c0);
      if (lVar11 == 0) goto LAB_0001b894;
    }
    if ((&DAT_0000118c)[lVar11] != '\0') goto LAB_0001b894;
    if ((((bVar5 && *(long *)(pIVar7 + 0x5c8) != 0) &&
         (uVar20 = *(uint *)(*(long *)(pIVar7 + 0x5c8) + 0x1390), uVar20 != 0xffff)) &&
        (this_00 = (IOAccelLegacyDisplayMachine *)
                   OSMetaClassBase::safeMetaCast
                             (*(OSMetaClassBase **)(pIVar7 + 0x10c0),
                              (OSMetaClass *)&IOAccelLegacyDisplayMachine::gMetaClass),
        this_00 != (IOAccelLegacyDisplayMachine *)0x0)) &&
       (((lVar11 = IOAccelLegacyDisplayMachine::getFullScreenSurface(this_00,uVar20), lVar11 != 0 &&
         (lVar11 != *(long *)(pIVar7 + 0x5c8))) &&
        (pIVar25 = *(IOAccelResource2 **)(&DAT_000011c0 + lVar11),
        pIVar25 != (IOAccelResource2 *)0x0)))) {
      lVar11 = *(long *)(pIVar7 + 0x5c0);
LAB_0001ba13:
      if ((*(short *)(&DAT_000011b8 + lVar11) == *(short *)(&DAT_000011bc + lVar11)) &&
         (*(short *)(&DAT_000011ba + lVar11) == *(short *)(&DAT_000011be + lVar11))) {
        puVar6 = &DAT_000011be;
      }
      else {
        puVar6 = &DAT_000011ba;
      }
      if ((*(ushort *)((long)&DAT_000011b0 + lVar11 + 2) & 0xf) < *(uint *)(pIVar7 + 0x10d0)) {
        return 0xe00002c2;
      }
      bVar14 = (byte)*(uint *)(pIVar7 + 0x10d0);
      iVar10 = (int)*(short *)(&DAT_000011b8 + lVar11) >> (bVar14 & 0x1f);
      iVar15 = (int)*(short *)(puVar6 + lVar11) >> (bVar14 & 0x1f);
      if (iVar10 == 0) {
        iVar10 = 1;
      }
      if (iVar15 == 0) {
        iVar15 = 1;
      }
      iVar16 = (int)local_50;
      uVar20 = (uint)local_38 + iVar16;
      if (uVar20 == 0 || SCARRY4((uint)local_38,iVar16) != (int)uVar20 < 0) {
LAB_0001bc2f:
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: failed. w = %d, h = %d, fSurface = %p\n\n",
                          "IOReturn IOAccelGLContext2::read_buffer(sIOAccelGLContextReadBufferData *)"
                          ,(ulong)local_38 & 0xffffffff,local_58,lVar11);
        pIVar19 = *(IOGraphicsAccelerator2 **)(pIVar7 + 0x5a8);
        (**(code **)(*(long *)pIVar19 + 0x858))(pIVar19,"",0);
        IOGraphicsAccelerator2::unlock_busy(pIVar19);
        _IOLockUnlock(*(undefined8 *)(pIVar19 + 0x88));
        return 0;
      }
      iVar18 = (int)local_58;
      iVar17 = iVar18 + (int)local_48;
      if (((iVar17 == 0 || SCARRY4(iVar18,(int)local_48) != iVar17 < 0) || (iVar10 <= iVar16)) ||
         (iVar15 <= (int)local_48)) goto LAB_0001bc2f;
      iVar2 = *(int *)((long)param_1 + 0x1c);
      uVar23 = (ulong)iVar2;
      if ((long)uVar23 < 0) {
        pIVar19 = *(IOGraphicsAccelerator2 **)(pIVar7 + 0x5a8);
        goto LAB_0001befe;
      }
      uVar24 = 0;
      uVar4 = (uint)local_38;
      if (iVar16 < 0) {
        uVar4 = uVar20;
      }
      local_50 = local_50 & 0xffffffff;
      if (iVar16 < 1) {
        local_50 = uVar24;
      }
      if ((int)local_48 < 0) {
        iVar18 = iVar17;
      }
      if (0 < (int)local_48) {
        uVar24 = local_48 & 0xffffffff;
      }
      if ((long)iVar10 < (long)((long)(int)uVar4 + local_50)) {
        uVar4 = iVar10 - (int)local_50;
      }
      if ((long)iVar15 < (long)(uVar24 + (long)iVar18)) {
        iVar18 = iVar15 - (uint)uVar24;
      }
      uVar26 = local_68 +
               (ulong)((iVar16 >> 0x1f & -(iVar16 * (uint)(byte)pIVar25[0xd8])) -
                      ((int)local_48 >> 0x1f & iVar2 * (int)local_48));
      iVar15 = (int)*(long *)PTR__page_size_0006b108;
      uVar20 = iVar15 - 1U & (uint)uVar26;
      uVar12 = -*(long *)PTR__page_size_0006b108;
      uVar21 = iVar15 + (iVar18 + -1) * iVar2 + -1 + (byte)pIVar25[0xd8] * uVar4 + uVar20 &
               (uint)uVar12;
      local_60 = uVar23;
      local_58 = pIVar25;
      if (0x40000000 < uVar21) {
        IOGraphicsAccelerator2::acceleratorUnlock(*(IOGraphicsAccelerator2 **)(local_40 + 0x5a8));
        return 0xe00002be;
      }
      local_38 = *(IOAccelSysMemory **)(local_40 + 0x5a8);
      local_48 = (ulong)uVar4;
      uVar22 = (**(code **)(*(long *)local_40 + 0x960))();
      pIVar13 = (IOAccelSysMemory *)
                IOAccelSysMemory::withClientBuffer
                          ((long *)local_38,uVar22,0,uVar26 & uVar12,(ulong)uVar21);
      if (pIVar13 == (IOAccelSysMemory *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Failed to create IOMemoryDescriptor\n",
                          "IOReturn IOAccelGLContext2::read_buffer(sIOAccelGLContextReadBufferData *)"
                         );
        uVar22 = 0xe00002be;
      }
      else {
        local_70 = &DAT_aaaaaaaaaaaaaaaa;
        local_78 = &DAT_aaaaaaaaaaaaaaaa;
        local_80 = &DAT_aaaaaaaaaaaaaaaa;
        local_88 = &DAT_aaaaaaaaaaaaaaaa;
        local_90 = &DAT_aaaaaaaaaaaaaaaa;
        local_98 = &DAT_aaaaaaaaaaaaaaaa;
        local_a0 = &DAT_aaaaaaaaaaaaaaaa;
        local_a8 = &DAT_aaaaaaaaaaaaaaaa;
        local_38 = pIVar13;
        (**(code **)(**(long **)(*(long *)(local_40 + 0x5a8) + 0x380) + 0x140))
                  (*(long **)(*(long *)(local_40 + 0x5a8) + 0x380),&local_a8);
        pIVar25 = local_58;
        uVar22 = IOAccelResource2::canQuickLockForCPUAccess(local_58,1);
        if ((char)uVar22 == '\0') {
          plVar3 = *(long **)(local_40 + 0x5c0);
          cVar8 = (**(code **)(*plVar3 + 0x960))
                            (plVar3,local_50,uVar24,local_48,iVar18,
                             *(undefined4 *)(local_40 + 0x10cc),*(undefined4 *)(local_40 + 0x10d0),
                             &local_a8,pIVar25,local_38,uVar20,local_60,
                             ((*(uint *)(plVar3 + 0x236) & 0x700000) == 0) * '\x02');
          pIVar7 = local_40;
          if (cVar8 == '\0') goto LAB_0001be66;
          (**(code **)(**(long **)(*(long *)(local_40 + 0x5a8) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(local_40 + 0x5a8) + 0x380),&local_a8,
                     (ulong)(byte)pIVar25[0x15] * 0x40 + *(long *)(pIVar25 + 0x38));
          IOGraphicsAccelerator2::acceleratorUnlock(*(IOGraphicsAccelerator2 **)(pIVar7 + 0x5a8));
          iVar15 = (**(code **)(**(long **)(*(long *)(pIVar7 + 0x5a8) + 0x380) + 0x178))
                             (*(long **)(*(long *)(pIVar7 + 0x5a8) + 0x380),&local_a8);
          lVar11 = *(long *)(pIVar7 + 0x5a8);
          IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar11 + 0x388) + 0x58),0x38);
          piVar1 = (int *)(lVar11 + 0x280);
          *piVar1 = *piVar1 + iVar15;
          IOGraphicsAccelerator2::acceleratorLock(*(IOGraphicsAccelerator2 **)(pIVar7 + 0x5a8));
          if ((*(byte *)(*(long *)(pIVar7 + 0x5a8) + 0xc90) & 0x80) != 0) {
            IOAccelSysMemory::flushProcessorCacheForIn(local_38);
          }
          local_38[0xc] = (IOAccelSysMemory)((byte)local_38[0xc] | 1);
          pIVar13 = local_38;
        }
        else {
LAB_0001be66:
          pIVar13 = local_38;
          IOAccelSurface::copyFromBufferWithCPU
                    (*(IOAccelSurface **)(local_40 + 0x5c0),(int)local_50,(uint)uVar24,(int)local_48
                     ,iVar18,(char)*(undefined4 *)(local_40 + 0x10cc),
                     (char)*(undefined4 *)(local_40 + 0x10d0),pIVar25,local_38,uVar20,local_60,
                     (uint)((*(uint *)(*(IOAccelSurface **)(local_40 + 0x5c0) + 0x11b0) & 0x700000)
                           == 0) * 2);
        }
        (**(code **)(*(long *)pIVar13 + 0x28))(pIVar13);
        uVar22 = 0;
      }
      pIVar19 = *(IOGraphicsAccelerator2 **)(local_40 + 0x5a8);
LAB_0001befe:
      IOGraphicsAccelerator2::acceleratorUnlock(pIVar19);
      return uVar22;
    }
    if ((*(uint *)(pIVar7 + 0x10b8) >> ((uint)local_60 & 0x1f) & 1) == 0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: No req_bits\n",
                        "IOReturn IOAccelGLContext2::read_buffer(sIOAccelGLContextReadBufferData *)"
                       );
    }
    else {
      lVar11 = *(long *)(pIVar7 + 0x5c0);
      pIVar25 = *(IOAccelResource2 **)(&DAT_000011c0 + (local_60 & 0xffffffff) * 8 + lVar11);
      if (pIVar25 == (IOAccelResource2 *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: No buffer\n",
                          "IOReturn IOAccelGLContext2::read_buffer(sIOAccelGLContextReadBufferData *)"
                         );
      }
      else {
        if (pIVar25[0xd8] != (IOAccelResource2)0x0) goto LAB_0001ba13;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: pixel bytes is 0\n",
                          "IOReturn IOAccelGLContext2::read_buffer(sIOAccelGLContextReadBufferData *)"
                         );
      }
    }
    IOGraphicsAccelerator2::acceleratorUnlock(*(IOGraphicsAccelerator2 **)(pIVar7 + 0x5a8));
  }
  uVar22 = 0xe00002cc;
switchD_0001b798_caseD_4:
  return uVar22;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLContext2::set_surface_get_config_status(IOAccelGLContextSetSurfaceData*,
// IOAccelGLContextGetConfigStatus*, unsigned long long, unsigned long long*)

ulong __cdecl
IOAccelGLContext2::set_surface_get_config_status
          (IOAccelGLContext2 *param_1,ulong *param_2,undefined8 *param_3)

{
  IOGraphicsAccelerator2 *pIVar1;
  uint uVar2;
  long lVar3;
  ulong uVar4;
  uintptr_t uVar5;
  undefined8 uVar6;
  long *plVar7;
  bool bVar8;
  undefined4 local_68;
  undefined2 local_64;
  undefined2 local_62;
  undefined2 local_60;
  undefined2 local_5e;
  undefined1 *local_5c;
  undefined1 *local_54;
  undefined1 *local_4c;
  undefined1 *local_44;
  uint local_3c;
  undefined8 *local_38;
  
  if (((int)param_2[1] != 0) && (*(int *)((long)param_2 + 0xc) != -1)) {
    pIVar1 = *(IOGraphicsAccelerator2 **)(param_1 + 0x5a8);
    local_38 = param_3;
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    lVar3 = IOAccelSurfaceList::findSurfaceForID
                      ((IOAccelSurfaceList *)(*(long *)(param_1 + 0x5a8) + 0xaa8),(int)param_2[1]);
    if (lVar3 == 0) {
      bVar8 = true;
      uVar4 = 0;
    }
    else {
      bVar8 = ((uint)*(undefined8 *)((long)&DAT_000011b0 + lVar3) & 0xf) ==
              (*(uint *)((long)param_2 + 0xc) & 0xf);
      uVar4 = 0xe00002bc;
      if (bVar8) {
        uVar4 = 0;
      }
    }
    pIVar1 = *(IOGraphicsAccelerator2 **)(param_1 + 0x5a8);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
    param_3 = local_38;
    if (!bVar8) {
      return uVar4;
    }
  }
  uVar4 = set_surface(param_1,param_2);
  if ((int)uVar4 == 0) {
    if (*(int *)((long)param_2 + 0x1c) != 0) {
      pIVar1 = *(IOGraphicsAccelerator2 **)(param_1 + 0x5a8);
      local_38 = param_3;
      _OSIncrementAtomic(pIVar1 + 0x90);
      _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
      _OSDecrementAtomic(pIVar1 + 0x90);
      IOGraphicsAccelerator2::lock_busy(pIVar1);
      (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
      uVar2 = (uint)param_2[4];
      if ((uVar2 & 1) == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: No surface option\n",
                          "IOReturn IOAccelGLContext2::set_surface_get_config_status(sIOAccelGLContextSetSurfaceData *, sIOAccelGLContextGetConfigStatus *, IOByteCount, IOByteCount *)"
                         );
      }
      else {
        local_44 = &DAT_aaaaaaaaaaaaaaaa;
        local_4c = &DAT_aaaaaaaaaaaaaaaa;
        local_54 = &DAT_aaaaaaaaaaaaaaaa;
        local_5c = &DAT_aaaaaaaaaaaaaaaa;
        local_68 = 0;
        local_64 = *(undefined2 *)((long)param_2 + 0x24);
        local_62 = (undefined2)param_2[5];
        plVar7 = *(long **)(param_1 + 0x5c0);
        local_60 = local_64;
        local_5e = local_62;
        if (plVar7 != (long *)0x0) {
          local_3c = uVar2 & 2 | uVar2 >> 2 & 1;
          do {
            if (*(char *)((long)plVar7 + 0xf1) == '\0') {
              uVar2 = (**(code **)(*plVar7 + 0x9f0))(plVar7,local_3c,&local_68);
              uVar4 = (ulong)uVar2;
              goto LAB_0001c255;
            }
            uVar5 = IORegistryEntry::getRegistryEntryID();
            _kernel_debug(0x85020075,uVar5,0,0,0,0);
            plVar7 = *(long **)(param_1 + 0x5a8);
            uVar6 = *(undefined8 *)(param_1 + 0x5c0);
            (**(code **)(*plVar7 + 0x858))(plVar7,"",0);
            _IOLockSleep_darwin14(plVar7[0x11],uVar6,0);
            (**(code **)(*plVar7 + 0x850))(plVar7,"",0);
            uVar5 = IORegistryEntry::getRegistryEntryID();
            _kernel_debug(0x85020076,uVar5,0,0,0,0);
            plVar7 = *(long **)(param_1 + 0x5c0);
          } while (plVar7 != (long *)0x0);
        }
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: No surface\n",
                          "IOReturn IOAccelGLContext2::set_surface_get_config_status(sIOAccelGLContextSetSurfaceData *, sIOAccelGLContextGetConfigStatus *, IOByteCount, IOByteCount *)"
                         );
      }
      uVar4 = 0xe00002c7;
LAB_0001c255:
      param_3 = local_38;
      pIVar1 = *(IOGraphicsAccelerator2 **)(param_1 + 0x5a8);
      (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar1);
      _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
      if ((int)uVar4 != 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s failed scale_surface\n\n",
                          "IOReturn IOAccelGLContext2::set_surface_get_config_status(sIOAccelGLContextSetSurfaceData *, sIOAccelGLContextGetConfigStatus *, IOByteCount, IOByteCount *)"
                         );
        return uVar4;
      }
    }
    set_surface_volatile_state(param_1,(int)param_2[3]);
    uVar4 = get_config(param_1,(uint *)(param_3 + 3));
    if ((int)uVar4 == 0) {
      uVar6 = (**(code **)(**(long **)(param_1 + 0x5a8) + 0x868))();
      param_3[4] = uVar6;
      uVar4 = get_surface_size(param_1,(uint *)(param_3 + 1),(uint *)((long)param_3 + 0xc),
                               (uint *)(param_3 + 2),(uint *)((long)param_3 + 0x14));
      if ((int)uVar4 == 0) {
        uVar4 = get_status(param_1,(undefined4 *)((long)param_3 + 0x1c));
        if ((int)uVar4 == 0) {
          uVar4 = 0;
          if (*(long *)(param_1 + 0x5c0) == 0) {
            uVar6 = 0;
          }
          else {
            uVar6 = *(undefined8 *)((long)&DAT_000011b0 + *(long *)(param_1 + 0x5c0));
          }
          *param_3 = uVar6;
        }
        else {
          uVar4 = uVar4 & 0xffffffff;
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s failed get_status\n\n",
                            "IOReturn IOAccelGLContext2::set_surface_get_config_status(sIOAccelGLContextSetSurfaceData *, sIOAccelGLContextGetConfigStatus *, IOByteCount, IOByteCount *)"
                           );
        }
      }
      else {
        uVar4 = uVar4 & 0xffffffff;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s failed get_surface_size\n\n",
                          "IOReturn IOAccelGLContext2::set_surface_get_config_status(sIOAccelGLContextSetSurfaceData *, sIOAccelGLContextGetConfigStatus *, IOByteCount, IOByteCount *)"
                         );
      }
    }
    else {
      uVar4 = uVar4 & 0xffffffff;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s failed get_config\n\n",
                        "IOReturn IOAccelGLContext2::set_surface_get_config_status(sIOAccelGLContextSetSurfaceData *, sIOAccelGLContextGetConfigStatus *, IOByteCount, IOByteCount *)"
                       );
    }
  }
  else {
    uVar4 = uVar4 & 0xffffffff;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s failed set_surface\n\n",
                      "IOReturn IOAccelGLContext2::set_surface_get_config_status(sIOAccelGLContextSetSurfaceData *, sIOAccelGLContextGetConfigStatus *, IOByteCount, IOByteCount *)"
                     );
  }
  return uVar4;
}



// IOAccelGLContext2::context_finish()

undefined8 __thiscall IOAccelGLContext2::context_finish(IOAccelGLContext2 *this)

{
  int *piVar1;
  long lVar2;
  int iVar3;
  undefined8 uVar4;
  
  iVar3 = (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x178))
                    (*(long **)(*(long *)(this + 0x5a8) + 0x380),this + 0x5d0);
  if (iVar3 == -1) {
    uVar4 = 0xe00002d6;
  }
  else {
    lVar2 = *(long *)(this + 0x5a8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar2 + 0x388) + 0x58),0x41);
    piVar1 = (int *)(lVar2 + 0x2a4);
    *piVar1 = *piVar1 + iVar3;
    uVar4 = 0;
  }
  return uVar4;
}



// IOAccelGLContext2::addVendorSurfaceRequiredBits(unsigned long long)

void IOAccelGLContext2::addVendorSurfaceRequiredBits(void)

{
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGLContext2::sleepForSwapCompleteNoLock(unsigned int)

void __cdecl
IOAccelGLContext2::sleepForSwapCompleteNoLock(long param_1,ulong param_2,undefined8 param_3)

{
  long *plVar1;
  code *UNRECOVERED_JUMPTABLE;
  
  plVar1 = *(long **)(*(long *)(param_1 + 0x5a8) + 0x380);
  UNRECOVERED_JUMPTABLE = *(code **)(*plVar1 + 0x178);
                    // WARNING: Could not recover jumptable at 0x0001c47b. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)
            (plVar1,&DAT_000010f0 + param_1 + (param_2 & 0xffffffff) * 0x40,param_3,
             UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelGLContext2::processSwap(eDoSwap)

uint __thiscall IOAccelGLContext2::processSwap(IOAccelGLContext2 *this,ulong param_1)

{
  IOAccelSurface *this_00;
  long *plVar1;
  undefined4 uVar2;
  uint uVar3;
  uint uVar4;
  ulong uVar5;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  undefined1 *local_28;
  
  this_00 = *(IOAccelSurface **)(this + 0x5c8);
  if (this_00 == (IOAccelSurface *)0x0) {
    uVar3 = 0;
    if (((param_1 & 1) != 0) && (((byte)this[0x10b8] & 1) != 0)) {
      if (this[0x10c8] == (IOAccelGLContext2)0x0) {
        IOAccelSurface::flip_buffers(*(IOAccelSurface **)(this + 0x5c0));
        if (this[0x10c9] != (IOAccelGLContext2)0x0) {
          uVar3 = 0;
          IOAccelResource2::setPurgeable
                    (*(IOAccelResource2 **)(&DAT_000011c8 + *(long *)(this + 0x5c0)),1,3,(uint *)0x0
                    );
        }
      }
      else {
        local_28 = &DAT_aaaaaaaaaaaaaaaa;
        local_30 = &DAT_aaaaaaaaaaaaaaaa;
        local_38 = &DAT_aaaaaaaaaaaaaaaa;
        local_40 = &DAT_aaaaaaaaaaaaaaaa;
        local_48 = &DAT_aaaaaaaaaaaaaaaa;
        local_50 = &DAT_aaaaaaaaaaaaaaaa;
        local_58 = &DAT_aaaaaaaaaaaaaaaa;
        local_60 = &DAT_aaaaaaaaaaaaaaaa;
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x140))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_60);
        plVar1 = *(long **)(this + 0x5c0);
        (**(code **)(*plVar1 + 0x970))(plVar1,&local_60,plVar1[0x239],plVar1[0x238]);
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_60,
                   (ulong)*(byte *)(*(long *)(&DAT_000011c8 + *(long *)(this + 0x5c0)) + 0x15) *
                   0x40 + *(long *)(*(long *)(&DAT_000011c8 + *(long *)(this + 0x5c0)) + 0x38));
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_60,
                   (ulong)*(byte *)(*(long *)(&DAT_000011c0 + *(long *)(this + 0x5c0)) + 0x15) *
                   0x40 + *(long *)(*(long *)(&DAT_000011c0 + *(long *)(this + 0x5c0)) + 0x38));
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_60,
                   (ulong)*(byte *)(*(long *)(&DAT_000011c0 + *(long *)(this + 0x5c0)) + 0x16) *
                   0x40 + *(long *)(*(long *)(&DAT_000011c0 + *(long *)(this + 0x5c0)) + 0x38));
        uVar3 = 0;
        (**(code **)(**(long **)(&DAT_000011c0 + *(long *)(this + 0x5c0)) + 0x168))
                  (*(long **)(&DAT_000011c0 + *(long *)(this + 0x5c0)),0,0);
      }
    }
  }
  else if ((this[0x10c8] == (IOAccelGLContext2)0x0) && (3 < *(int *)(this_00 + 5000))) {
    if (((param_1 & 2) == 0) || ((~*(uint *)(this + 0x10b8) & 3) != 0)) {
      uVar3 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Tried to swap single buffer\n",
                        "virtual uint32_t IOAccelGLContext2::processSwap(IOAccelSwapNotification)");
    }
    else {
      IOAccelSurface::flip_buffers(this_00);
      uVar5 = IOAccelLegacySurface::present_surface_with_flip
                        (*(IOAccelLegacySurface **)(this + 0x5c8),
                         (uint)(0 < *(short *)(this + 0x10b0)) << 3);
      uVar3 = (uint)uVar5;
    }
  }
  else {
    if (((param_1 & 1) != 0) &&
       ((((byte)this[0x10b8] & 1) != 0 && (((byte)this_00[0x11b1] & 0x80) == 0)))) {
      if (this[0x10c8] == (IOAccelGLContext2)0x0) {
        IOAccelSurface::flip_buffers(this_00);
        if (this[0x10c9] != (IOAccelGLContext2)0x0) {
          IOAccelResource2::setPurgeable
                    (*(IOAccelResource2 **)(&DAT_000011c8 + *(long *)(this + 0x5c8)),1,3,(uint *)0x0
                    );
        }
      }
      else {
        local_28 = &DAT_aaaaaaaaaaaaaaaa;
        local_30 = &DAT_aaaaaaaaaaaaaaaa;
        local_38 = &DAT_aaaaaaaaaaaaaaaa;
        local_40 = &DAT_aaaaaaaaaaaaaaaa;
        local_48 = &DAT_aaaaaaaaaaaaaaaa;
        local_50 = &DAT_aaaaaaaaaaaaaaaa;
        local_58 = &DAT_aaaaaaaaaaaaaaaa;
        local_60 = &DAT_aaaaaaaaaaaaaaaa;
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x140))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_60);
        plVar1 = *(long **)(this + 0x5c8);
        (**(code **)(*plVar1 + 0x970))(plVar1,&local_60,plVar1[0x239],plVar1[0x238]);
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_60,
                   (ulong)*(byte *)(*(long *)(&DAT_000011c8 + *(long *)(this + 0x5c8)) + 0x15) *
                   0x40 + *(long *)(*(long *)(&DAT_000011c8 + *(long *)(this + 0x5c8)) + 0x38));
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_60,
                   (ulong)*(byte *)(*(long *)(&DAT_000011c0 + *(long *)(this + 0x5c8)) + 0x15) *
                   0x40 + *(long *)(*(long *)(&DAT_000011c0 + *(long *)(this + 0x5c8)) + 0x38));
        (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x5a8) + 0x380),&local_60,
                   (ulong)*(byte *)(*(long *)(&DAT_000011c0 + *(long *)(this + 0x5c8)) + 0x16) *
                   0x40 + *(long *)(*(long *)(&DAT_000011c0 + *(long *)(this + 0x5c8)) + 0x38));
        (**(code **)(**(long **)(&DAT_000011c0 + *(long *)(this + 0x5c8)) + 0x168))
                  (*(long **)(&DAT_000011c0 + *(long *)(this + 0x5c8)),0,0);
      }
    }
    uVar3 = 0;
    if ((param_1 & 2) != 0) {
      uVar2 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x10c0))
      ;
      uVar3 = 0x18;
      if (*(short *)(this + 0x10b0) == 0) {
        uVar3 = 0;
      }
      uVar3 = IOAccelLegacySurface::present_surface_with_swap
                        (*(IOAccelLegacySurface **)(this + 0x5c8),~(-1 << ((byte)uVar2 & 0x1f)),
                         uVar3);
    }
  }
  (**(code **)(**(long **)(*(long *)(this + 0x5a8) + 0x380) + 0x1b0))
            (*(long **)(*(long *)(this + 0x5a8) + 0x380),&DAT_00001128 + *(long *)(this + 0x5c0),
             this + (ulong)*(uint *)(this + 0x11f0) * 0x40 + 0x10f0);
  if (*(short *)(this + 0x10b2) == 0) {
    uVar4 = *(int *)(this + 0x11f0) + 1U & 3;
  }
  else {
    uVar4 = 0;
    if (this[0x10b4] == (IOAccelGLContext2)0x0) {
      return uVar3;
    }
  }
  *(uint *)(this + 0x11f0) = uVar4;
  return uVar3;
}



// IOAccelGLContext2::_RESERVEDIOAccelGLContext0()

void IOAccelGLContext2::_RESERVEDIOAccelGLContext0(void)

{
  OSMetaClass::reservedCalled(0x821d8);
  return;
}



// IOAccelGLContext2::_RESERVEDIOAccelGLContext1()

void IOAccelGLContext2::_RESERVEDIOAccelGLContext1(void)

{
  OSMetaClass::reservedCalled(0x821d8);
  return;
}



// IOAccelGLContext2::_RESERVEDIOAccelGLContext2()

void IOAccelGLContext2::_RESERVEDIOAccelGLContext2(void)

{
  OSMetaClass::reservedCalled(0x821d8);
  return;
}



// IOAccelGLContext2::_RESERVEDIOAccelGLContext3()

void IOAccelGLContext2::_RESERVEDIOAccelGLContext3(void)

{
  OSMetaClass::reservedCalled(0x821d8);
  return;
}



// IOAccelGLContext2::_RESERVEDIOAccelGLContext4()

void IOAccelGLContext2::_RESERVEDIOAccelGLContext4(void)

{
  OSMetaClass::reservedCalled(0x821d8);
  return;
}



// IOAccelGLContext2::_RESERVEDIOAccelGLContext5()

void IOAccelGLContext2::_RESERVEDIOAccelGLContext5(void)

{
  OSMetaClass::reservedCalled(0x821d8);
  return;
}



// IOAccelGLContext2::MetaClass::~MetaClass()

void __thiscall IOAccelGLContext2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelContext2::getOwningTask() const

undefined8 __thiscall IOAccelContext2::getOwningTask(IOAccelContext2 *this)

{
  return *(undefined8 *)(this + 0x578);
}



// IOAccelContext2::getGPUTask() const

undefined8 __thiscall IOAccelContext2::getGPUTask(IOAccelContext2 *this)

{
  return *(undefined8 *)(this + 0x598);
}



// IOAccelContext2::getOwningTaskPid() const

undefined4 __thiscall IOAccelContext2::getOwningTaskPid(IOAccelContext2 *this)

{
  return *(undefined4 *)(this + 0x580);
}



// IOAccelSubmitter2::retireCommandBuffer(IOAccelEventFence*)

void IOAccelSubmitter2::retireCommandBuffer(void)

{
  return;
}



// IOAccelSubmitter2::setSubmissionError(unsigned int)

void IOAccelSubmitter2::setSubmissionError(void)

{
  return;
}



// IOAccelSubmitter2::isOpportunisticWorkload() const

undefined8 IOAccelSubmitter2::isOpportunisticWorkload(void)

{
  return 0;
}



// IOAccelContext2::postTokenSanityCheck(IOAccelCommandStreamInfo&)

void IOAccelContext2::postTokenSanityCheck(void)

{
  return;
}



// IOAccelContext2::getDataBufferPrivate(IOAccelResource2*, IOAccelResourcePrivate*, unsigned long
// long)

void IOAccelContext2::getDataBufferPrivate(void)

{
  return;
}



// IOAccelContext2::validateDataBuffer(unsigned long long, IOBufferMemoryDescriptor*,
// IOAccelResource2*)

undefined8 IOAccelContext2::validateDataBuffer(void)

{
  return 0;
}



// IOAccelContext2::invalidate()

void IOAccelContext2::invalidate(void)

{
  return;
}



// IOAccelContext2::getFrameDelimiter()

undefined8 IOAccelContext2::getFrameDelimiter(void)

{
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelGLContext_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelGLContext2::gMetaClass,"IOAccelGLContext2",
             (OSMetaClass *)&IOAccelContext2::gMetaClass,0x1238);
  _gMetaClass = &PTR__MetaClass_000750b0;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelGLContext2::gMetaClass);
  return;
}



// IOAccelGPURestartReport2::MetaClass::MetaClass()

void __thiscall IOAccelGPURestartReport2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelGPURestartReport2",(OSMetaClass *)PTR_gMetaClass_0006b070,
             0x88);
  *(undefined ***)this = &PTR__MetaClass_00075aa8;
  return;
}



// IOAccelGPURestartReport2::MetaClass::~MetaClass()

void __thiscall IOAccelGPURestartReport2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelGPURestartReport2::IOAccelGPURestartReport2(OSMetaClass const*)

void __thiscall
IOAccelGPURestartReport2::IOAccelGPURestartReport2
          (IOAccelGPURestartReport2 *this,OSMetaClass *param_1)

{
  IOService::IOService((IOService *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelGPURestartReport2_00075240;
  return;
}



// IOAccelGPURestartReport2::IOAccelGPURestartReport2(OSMetaClass const*)

void __thiscall
IOAccelGPURestartReport2::IOAccelGPURestartReport2
          (IOAccelGPURestartReport2 *this,OSMetaClass *param_1)

{
  IOService::IOService((IOService *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelGPURestartReport2_00075240;
  return;
}



// IOAccelGPURestartReport2::~IOAccelGPURestartReport2()

void __thiscall IOAccelGPURestartReport2::~IOAccelGPURestartReport2(IOAccelGPURestartReport2 *this)

{
  IOService::~IOService((IOService *)this);
  return;
}



// IOAccelGPURestartReport2::~IOAccelGPURestartReport2()

void __thiscall IOAccelGPURestartReport2::~IOAccelGPURestartReport2(IOAccelGPURestartReport2 *this)

{
  IOService::~IOService((IOService *)this);
  return;
}



// IOAccelGPURestartReport2::~IOAccelGPURestartReport2()

void __thiscall IOAccelGPURestartReport2::~IOAccelGPURestartReport2(IOAccelGPURestartReport2 *this)

{
  IOService::~IOService((IOService *)this);
  _OSObject_typed_operator_delete(&IOAccelGPURestartReport2_ktv,this,0x88);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGPURestartReport2::operator delete(void*, unsigned long)

void __cdecl IOAccelGPURestartReport2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelGPURestartReport2_ktv,param_1,param_2);
  return;
}



// IOAccelGPURestartReport2::getMetaClass() const

undefined1 * IOAccelGPURestartReport2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelGPURestartReport2::MetaClass::MetaClass()

void __thiscall IOAccelGPURestartReport2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelGPURestartReport2",(OSMetaClass *)PTR_gMetaClass_0006b070,
             0x88);
  *(undefined ***)this = &PTR__MetaClass_00075aa8;
  return;
}



// IOAccelGPURestartReport2::MetaClass::alloc() const

IOService * IOAccelGPURestartReport2::MetaClass::alloc(void)

{
  IOService *this;
  
  this = (IOService *)_OSObject_typed_operator_new(&IOAccelGPURestartReport2_ktv,0x88);
  IOService::IOService(this,(OSMetaClass *)&IOAccelGPURestartReport2::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelGPURestartReport2_00075240;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelGPURestartReport2::operator new(unsigned long)

void * __thiscall IOAccelGPURestartReport2::operator_new(IOAccelGPURestartReport2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelGPURestartReport2_ktv,this);
  return pvVar1;
}



// IOAccelGPURestartReport2::IOAccelGPURestartReport2()

void __thiscall IOAccelGPURestartReport2::IOAccelGPURestartReport2(IOAccelGPURestartReport2 *this)

{
  IOService::IOService((IOService *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelGPURestartReport2_00075240;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelGPURestartReport2::IOAccelGPURestartReport2()

void __thiscall IOAccelGPURestartReport2::IOAccelGPURestartReport2(IOAccelGPURestartReport2 *this)

{
  IOService::IOService((IOService *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelGPURestartReport2_00075240;
  OSMetaClass::instanceConstructed();
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelGPURestartReport2::newUserClient(task*, void*, unsigned int, IOUserClient**)

undefined8 __cdecl IOAccelGPURestartReport2::newUserClient(long *param_1)

{
  undefined8 *in_R8;
  
  *in_R8 = 0;
  (**(code **)(*param_1 + 0x600))(param_1,8);
  return 0xe00002c7;
}



// IOAccelGPURestartReport2::MetaClass::~MetaClass()

void __thiscall IOAccelGPURestartReport2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelGPURestartReport_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelGPURestartReport2::gMetaClass,"IOAccelGPURestartReport2",
             (OSMetaClass *)PTR_gMetaClass_0006b070,0x88);
  _gMetaClass = &PTR__MetaClass_00075aa8;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelGPURestartReport2::gMetaClass);
  return;
}



// IOAccelContextList::init()

void __thiscall IOAccelContextList::init(IOAccelContextList *this)

{
  *(undefined8 *)this = 0;
  *(undefined4 *)(this + 8) = 0;
  return;
}



// IOAccelContextList::getCount() const

undefined4 __thiscall IOAccelContextList::getCount(IOAccelContextList *this)

{
  return *(undefined4 *)(this + 8);
}



// IOAccelContextList::getCountWithPID(int) const

int __thiscall IOAccelContextList::getCountWithPID(IOAccelContextList *this,int param_1)

{
  int iVar1;
  int iVar2;
  long *plVar3;
  
  plVar3 = *(long **)this;
  if (plVar3 == (long *)0x0) {
    iVar2 = 0;
  }
  else {
    iVar2 = 0;
    do {
      iVar1 = (**(code **)(*plVar3 + 0x970))(plVar3);
      iVar2 = iVar2 + (uint)(iVar1 == param_1);
      plVar3 = (long *)plVar3[0xad];
    } while (plVar3 != (long *)0x0);
  }
  return iVar2;
}



// IOAccelContextList::addContext(IOAccelContext2*)

void __thiscall IOAccelContextList::addContext(IOAccelContextList *this,long param_1)

{
  *(undefined8 *)(param_1 + 0x568) = *(undefined8 *)this;
  *(long *)this = param_1;
  *(int *)(this + 8) = *(int *)(this + 8) + 1;
  return;
}



// IOAccelContextList::removeContext(IOAccelContext2*)

void __thiscall IOAccelContextList::removeContext(IOAccelContextList *this,long param_1)

{
  long lVar1;
  IOAccelContextList *pIVar2;
  long lVar3;
  
  lVar1 = *(long *)this;
  if (lVar1 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Internal error - no context list\n",
                      "void IOAccelContextList::removeContext(IOAccelContext2 *)");
  }
  else {
    pIVar2 = this;
    if (lVar1 != param_1) {
      do {
        lVar3 = lVar1;
        lVar1 = *(long *)(lVar3 + 0x568);
        if (lVar1 == 0) break;
      } while (lVar1 != param_1);
      if (lVar1 == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Internal error - deleting non-existant context\n",
                          "void IOAccelContextList::removeContext(IOAccelContext2 *)");
        return;
      }
      pIVar2 = (IOAccelContextList *)(lVar3 + 0x568);
    }
    *(undefined8 *)pIVar2 = *(undefined8 *)(param_1 + 0x568);
    *(int *)(this + 8) = *(int *)(this + 8) + -1;
    *(undefined8 *)(param_1 + 0x568) = 0;
  }
  return;
}



// IOAccelContextList::Iterator::Iterator(IOAccelContextList&)

void __thiscall IOAccelContextList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelContextList::Iterator::Iterator(IOAccelContextList&)

void __thiscall IOAccelContextList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelContextList::Iterator::getNextContext()

void __thiscall IOAccelContextList::Iterator::getNextContext(Iterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0x568);
  }
  return;
}



// IOAccelGLDrawableUserClientList::init()

void __thiscall IOAccelGLDrawableUserClientList::init(IOAccelGLDrawableUserClientList *this)

{
  *(undefined8 *)this = 0;
  *(undefined4 *)(this + 8) = 0;
  return;
}



// IOAccelGLDrawableUserClientList::getCount() const

undefined4 __thiscall
IOAccelGLDrawableUserClientList::getCount(IOAccelGLDrawableUserClientList *this)

{
  return *(undefined4 *)(this + 8);
}



// IOAccelGLDrawableUserClientList::getCountWithPID(int) const

int __thiscall
IOAccelGLDrawableUserClientList::getCountWithPID(IOAccelGLDrawableUserClientList *this,int param_1)

{
  int iVar1;
  long lVar2;
  
  iVar1 = 0;
  for (lVar2 = *(long *)this; lVar2 != 0; lVar2 = *(long *)(lVar2 + 0xd8)) {
    iVar1 = iVar1 + (uint)(*(int *)(lVar2 + 0xe8) == param_1);
  }
  return iVar1;
}



// IOAccelGLDrawableUserClientList::addGLDrawableUserClient(IOAccelGLDrawableUserClient*)

void __thiscall
IOAccelGLDrawableUserClientList::addGLDrawableUserClient
          (IOAccelGLDrawableUserClientList *this,long param_1)

{
  *(undefined8 *)(param_1 + 0xd8) = *(undefined8 *)this;
  *(long *)this = param_1;
  *(int *)(this + 8) = *(int *)(this + 8) + 1;
  return;
}



// IOAccelGLDrawableUserClientList::removeGLDrawableUserClient(IOAccelGLDrawableUserClient*)

void __thiscall
IOAccelGLDrawableUserClientList::removeGLDrawableUserClient
          (IOAccelGLDrawableUserClientList *this,long param_1)

{
  long lVar1;
  IOAccelGLDrawableUserClientList *pIVar2;
  long lVar3;
  
  lVar1 = *(long *)this;
  if (lVar1 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Internal error - no context list\n",
                      "void IOAccelGLDrawableUserClientList::removeGLDrawableUserClient(IOAccelGLDrawableUserClient *)"
                     );
  }
  else {
    pIVar2 = this;
    if (lVar1 != param_1) {
      do {
        lVar3 = lVar1;
        lVar1 = *(long *)(lVar3 + 0xd8);
        if (lVar1 == 0) break;
      } while (lVar1 != param_1);
      if (lVar1 == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Internal error - deleting non-existant context\n",
                          "void IOAccelGLDrawableUserClientList::removeGLDrawableUserClient(IOAccelGLDrawableUserClient *)"
                         );
        return;
      }
      pIVar2 = (IOAccelGLDrawableUserClientList *)(lVar3 + 0xd8);
    }
    *(undefined8 *)pIVar2 = *(undefined8 *)(param_1 + 0xd8);
    *(int *)(this + 8) = *(int *)(this + 8) + -1;
    *(undefined8 *)(param_1 + 0xd8) = 0;
  }
  return;
}



// IOAccelGLDrawableUserClientList::Iterator::Iterator(IOAccelGLDrawableUserClientList&)

void __thiscall
IOAccelGLDrawableUserClientList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelGLDrawableUserClientList::Iterator::Iterator(IOAccelGLDrawableUserClientList&)

void __thiscall
IOAccelGLDrawableUserClientList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelGLDrawableUserClientList::Iterator::getNextGLDrawableUserClient()

void __thiscall
IOAccelGLDrawableUserClientList::Iterator::getNextGLDrawableUserClient(Iterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0xd8);
  }
  return;
}



// IOAccelCommandQueueList::init()

void __thiscall IOAccelCommandQueueList::init(IOAccelCommandQueueList *this)

{
  *(undefined8 *)this = 0;
  *(undefined4 *)(this + 8) = 0;
  return;
}



// IOAccelCommandQueueList::getCount() const

undefined4 __thiscall IOAccelCommandQueueList::getCount(IOAccelCommandQueueList *this)

{
  return *(undefined4 *)(this + 8);
}



// IOAccelCommandQueueList::getCountWithPID(int) const

int __thiscall IOAccelCommandQueueList::getCountWithPID(IOAccelCommandQueueList *this,int param_1)

{
  int iVar1;
  int iVar2;
  long *plVar3;
  
  plVar3 = *(long **)this;
  if (plVar3 == (long *)0x0) {
    iVar2 = 0;
  }
  else {
    iVar2 = 0;
    do {
      iVar1 = (**(code **)(*plVar3 + 0x970))(plVar3);
      iVar2 = iVar2 + (uint)(iVar1 == param_1);
      plVar3 = (long *)plVar3[0xad];
    } while (plVar3 != (long *)0x0);
  }
  return iVar2;
}



// IOAccelCommandQueueList::addCommandQueue(IOAccelCommandQueue*)

void __thiscall IOAccelCommandQueueList::addCommandQueue(IOAccelCommandQueueList *this,long param_1)

{
  *(undefined8 *)(param_1 + 0x568) = *(undefined8 *)this;
  *(long *)this = param_1;
  *(int *)(this + 8) = *(int *)(this + 8) + 1;
  return;
}



// IOAccelCommandQueueList::removeCommandQueue(IOAccelCommandQueue*)

void __thiscall
IOAccelCommandQueueList::removeCommandQueue(IOAccelCommandQueueList *this,long param_1)

{
  long lVar1;
  IOAccelCommandQueueList *pIVar2;
  long lVar3;
  
  lVar1 = *(long *)this;
  if (lVar1 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Internal error - no context list\n",
                      "void IOAccelCommandQueueList::removeCommandQueue(IOAccelCommandQueue *)");
  }
  else {
    pIVar2 = this;
    if (lVar1 != param_1) {
      do {
        lVar3 = lVar1;
        lVar1 = *(long *)(lVar3 + 0x568);
        if (lVar1 == 0) break;
      } while (lVar1 != param_1);
      if (lVar1 == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Internal error - deleting non-existant context\n",
                          "void IOAccelCommandQueueList::removeCommandQueue(IOAccelCommandQueue *)")
        ;
        return;
      }
      pIVar2 = (IOAccelCommandQueueList *)(lVar3 + 0x568);
    }
    *(undefined8 *)pIVar2 = *(undefined8 *)(param_1 + 0x568);
    *(int *)(this + 8) = *(int *)(this + 8) + -1;
    *(undefined8 *)(param_1 + 0x568) = 0;
  }
  return;
}



// IOAccelCommandQueueList::Iterator::Iterator(IOAccelCommandQueueList&)

void __thiscall IOAccelCommandQueueList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelCommandQueueList::Iterator::Iterator(IOAccelCommandQueueList&)

void __thiscall IOAccelCommandQueueList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelCommandQueueList::Iterator::getNextCommandQueue()

void __thiscall IOAccelCommandQueueList::Iterator::getNextCommandQueue(Iterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0x568);
  }
  return;
}



// IOAccelDeviceList::init()

void __thiscall IOAccelDeviceList::init(IOAccelDeviceList *this)

{
  *(undefined8 *)this = 0;
  *(undefined4 *)(this + 8) = 0;
  return;
}



// IOAccelDeviceList::getCount() const

undefined4 __thiscall IOAccelDeviceList::getCount(IOAccelDeviceList *this)

{
  return *(undefined4 *)(this + 8);
}



// IOAccelDeviceList::getCountWithPID(int) const

int __thiscall IOAccelDeviceList::getCountWithPID(IOAccelDeviceList *this,int param_1)

{
  int iVar1;
  long lVar2;
  
  iVar1 = 0;
  for (lVar2 = *(long *)this; lVar2 != 0; lVar2 = *(long *)(lVar2 + 0xd8)) {
    iVar1 = iVar1 + (uint)(*(int *)(lVar2 + 0xf0) == param_1);
  }
  return iVar1;
}



// IOAccelDeviceList::addDevice(IOAccelDevice2*)

void __thiscall IOAccelDeviceList::addDevice(IOAccelDeviceList *this,long param_1)

{
  *(undefined8 *)(param_1 + 0xd8) = *(undefined8 *)this;
  *(long *)this = param_1;
  *(int *)(this + 8) = *(int *)(this + 8) + 1;
  return;
}



// IOAccelDeviceList::removeDevice(IOAccelDevice2*)

void __thiscall IOAccelDeviceList::removeDevice(IOAccelDeviceList *this,long param_1)

{
  long lVar1;
  IOAccelDeviceList *pIVar2;
  long lVar3;
  
  lVar1 = *(long *)this;
  if (lVar1 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Internal error - no device list\n",
                      "void IOAccelDeviceList::removeDevice(IOAccelDevice2 *)");
  }
  else {
    pIVar2 = this;
    if (lVar1 != param_1) {
      do {
        lVar3 = lVar1;
        lVar1 = *(long *)(lVar3 + 0xd8);
        if (lVar1 == 0) break;
      } while (lVar1 != param_1);
      if (lVar1 == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Internal error - deleting non-existant context\n",
                          "void IOAccelDeviceList::removeDevice(IOAccelDevice2 *)");
        return;
      }
      pIVar2 = (IOAccelDeviceList *)(lVar3 + 0xd8);
    }
    *(undefined8 *)pIVar2 = *(undefined8 *)(param_1 + 0xd8);
    *(int *)(this + 8) = *(int *)(this + 8) + -1;
    *(undefined8 *)(param_1 + 0xd8) = 0;
  }
  return;
}



// IOAccelDeviceList::Iterator::Iterator(IOAccelDeviceList&)

void __thiscall IOAccelDeviceList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelDeviceList::Iterator::Iterator(IOAccelDeviceList&)

void __thiscall IOAccelDeviceList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelDeviceList::Iterator::getNextDevice()

void __thiscall IOAccelDeviceList::Iterator::getNextDevice(Iterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0xd8);
  }
  return;
}



// IOAccelSharedList::init()

void __thiscall IOAccelSharedList::init(IOAccelSharedList *this)

{
  *(undefined8 *)this = 0;
  *(undefined4 *)(this + 8) = 0;
  return;
}



// IOAccelSharedList::getCount() const

undefined4 __thiscall IOAccelSharedList::getCount(IOAccelSharedList *this)

{
  return *(undefined4 *)(this + 8);
}



// IOAccelSharedList::addShared(IOAccelShared2*)

void __thiscall IOAccelSharedList::addShared(IOAccelSharedList *this,long param_1)

{
  *(undefined8 *)(param_1 + 0x10) = *(undefined8 *)this;
  *(long *)this = param_1;
  *(int *)(this + 8) = *(int *)(this + 8) + 1;
  return;
}



// IOAccelSharedList::removeShared(IOAccelShared2*)

void __thiscall IOAccelSharedList::removeShared(IOAccelSharedList *this,long param_1)

{
  long lVar1;
  IOAccelSharedList *pIVar2;
  long lVar3;
  
  lVar1 = *(long *)this;
  if (lVar1 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Internal error - no shared list\n",
                      "void IOAccelSharedList::removeShared(IOAccelShared2 *)");
  }
  else {
    pIVar2 = this;
    if (lVar1 != param_1) {
      do {
        lVar3 = lVar1;
        lVar1 = *(long *)(lVar3 + 0x10);
        if (lVar1 == 0) break;
      } while (lVar1 != param_1);
      if (lVar1 == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Internal error - deleting non-existant context\n",
                          "void IOAccelSharedList::removeShared(IOAccelShared2 *)");
        return;
      }
      pIVar2 = (IOAccelSharedList *)(lVar3 + 0x10);
    }
    *(undefined8 *)pIVar2 = *(undefined8 *)(param_1 + 0x10);
    *(int *)(this + 8) = *(int *)(this + 8) + -1;
    *(undefined8 *)(param_1 + 0x10) = 0;
  }
  return;
}



// IOAccelSharedList::Iterator::Iterator(IOAccelSharedList&)

void __thiscall IOAccelSharedList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelSharedList::Iterator::Iterator(IOAccelSharedList&)

void __thiscall IOAccelSharedList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelSharedList::Iterator::getNextShared()

void __thiscall IOAccelSharedList::Iterator::getNextShared(Iterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0x10);
  }
  return;
}



// IOAccelSharedUserClientList::init()

void __thiscall IOAccelSharedUserClientList::init(IOAccelSharedUserClientList *this)

{
  *(undefined8 *)this = 0;
  *(undefined4 *)(this + 8) = 0;
  return;
}



// IOAccelSharedUserClientList::getCount() const

undefined4 __thiscall IOAccelSharedUserClientList::getCount(IOAccelSharedUserClientList *this)

{
  return *(undefined4 *)(this + 8);
}



// IOAccelSharedUserClientList::getCountWithPID(int) const

int __thiscall
IOAccelSharedUserClientList::getCountWithPID(IOAccelSharedUserClientList *this,int param_1)

{
  int iVar1;
  long lVar2;
  
  iVar1 = 0;
  for (lVar2 = *(long *)this; lVar2 != 0; lVar2 = *(long *)(lVar2 + 0xd8)) {
    iVar1 = iVar1 + (uint)(*(int *)(lVar2 + 0xe8) == param_1);
  }
  return iVar1;
}



// IOAccelSharedUserClientList::addSharedUserClient(IOAccelSharedUserClient2*)

void __thiscall
IOAccelSharedUserClientList::addSharedUserClient(IOAccelSharedUserClientList *this,long param_1)

{
  *(undefined8 *)(param_1 + 0xd8) = *(undefined8 *)this;
  *(long *)this = param_1;
  *(int *)(this + 8) = *(int *)(this + 8) + 1;
  return;
}



// IOAccelSharedUserClientList::removeSharedUserClient(IOAccelSharedUserClient2*)

void __thiscall
IOAccelSharedUserClientList::removeSharedUserClient(IOAccelSharedUserClientList *this,long param_1)

{
  long lVar1;
  IOAccelSharedUserClientList *pIVar2;
  long lVar3;
  
  lVar1 = *(long *)this;
  if (lVar1 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Internal error - no shared list\n",
                      "void IOAccelSharedUserClientList::removeSharedUserClient(IOAccelSharedUserClient2 *)"
                     );
  }
  else {
    pIVar2 = this;
    if (lVar1 != param_1) {
      do {
        lVar3 = lVar1;
        lVar1 = *(long *)(lVar3 + 0xd8);
        if (lVar1 == 0) break;
      } while (lVar1 != param_1);
      if (lVar1 == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Internal error - deleting non-existant context\n",
                          "void IOAccelSharedUserClientList::removeSharedUserClient(IOAccelSharedUserClient2 *)"
                         );
        return;
      }
      pIVar2 = (IOAccelSharedUserClientList *)(lVar3 + 0xd8);
    }
    *(undefined8 *)pIVar2 = *(undefined8 *)(param_1 + 0xd8);
    *(int *)(this + 8) = *(int *)(this + 8) + -1;
    *(undefined8 *)(param_1 + 0xd8) = 0;
  }
  return;
}



// IOAccelSharedUserClientList::Iterator::Iterator(IOAccelSharedUserClientList&)

void __thiscall IOAccelSharedUserClientList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelSharedUserClientList::Iterator::Iterator(IOAccelSharedUserClientList&)

void __thiscall IOAccelSharedUserClientList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelSharedUserClientList::Iterator::getNextSharedUserClient()

void __thiscall IOAccelSharedUserClientList::Iterator::getNextSharedUserClient(Iterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0xd8);
  }
  return;
}



// IOAccelSurfaceList::init()

void __thiscall IOAccelSurfaceList::init(IOAccelSurfaceList *this)

{
  *(undefined8 *)this = 0;
  *(undefined8 *)(this + 8) = 0;
  *(undefined4 *)(this + 0x10) = 0;
  return;
}



// IOAccelSurfaceList::getCount() const

undefined4 __thiscall IOAccelSurfaceList::getCount(IOAccelSurfaceList *this)

{
  return *(undefined4 *)(this + 0x10);
}



// IOAccelSurfaceList::addSurface(IOAccelSurface*)

void __thiscall IOAccelSurfaceList::addSurface(IOAccelSurfaceList *this,long param_1)

{
  long lVar1;
  IOAccelSurfaceList *pIVar2;
  
  lVar1 = *(long *)this;
  *(undefined8 *)(param_1 + 0xe0) = 0;
  pIVar2 = (IOAccelSurfaceList *)(lVar1 + 0xe0);
  if (lVar1 == 0) {
    pIVar2 = this + 8;
  }
  *(long *)pIVar2 = param_1;
  *(long *)(param_1 + 0xd8) = lVar1;
  *(int *)(this + 0x10) = *(int *)(this + 0x10) + 1;
  *(long *)this = param_1;
  return;
}



// IOAccelSurfaceList::moveSurfaceToHead(IOAccelSurface*)

void __thiscall IOAccelSurfaceList::moveSurfaceToHead(IOAccelSurfaceList *this,long param_1)

{
  long lVar1;
  long lVar2;
  long lVar3;
  IOAccelSurfaceList *pIVar4;
  
  lVar1 = *(long *)this;
  if (lVar1 != param_1) {
    lVar2 = *(long *)(param_1 + 0xd8);
    lVar3 = *(long *)(param_1 + 0xe0);
    *(long *)(lVar3 + 0xd8) = lVar2;
    *(undefined8 *)(param_1 + 0xe0) = 0;
    *(long *)(param_1 + 0xd8) = lVar1;
    *(long *)(lVar1 + 0xe0) = param_1;
    *(long *)this = param_1;
    pIVar4 = this + 8;
    if (lVar2 != 0) {
      pIVar4 = (IOAccelSurfaceList *)(lVar2 + 0xe0);
    }
    *(long *)pIVar4 = lVar3;
  }
  return;
}



// IOAccelSurfaceList::removeSurface(IOAccelSurface*)

void __thiscall IOAccelSurfaceList::removeSurface(IOAccelSurfaceList *this,long param_1)

{
  long lVar1;
  long lVar2;
  
  if (*(long *)this == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Internal error - no surface list\n",
                      "void IOAccelSurfaceList::removeSurface(IOAccelSurface *)");
  }
  else {
    lVar1 = *(long *)(param_1 + 0xd8);
    lVar2 = *(long *)(param_1 + 0xe0);
    *(undefined8 *)(param_1 + 0xe0) = 0;
    *(undefined8 *)(param_1 + 0xd8) = 0;
    *(int *)(this + 0x10) = *(int *)(this + 0x10) + -1;
    if (lVar2 == 0) {
      *(long *)this = lVar1;
      if (lVar1 == 0) {
        *(undefined8 *)(this + 8) = 0;
      }
      else {
        *(undefined8 *)(lVar1 + 0xe0) = 0;
      }
    }
    else {
      *(long *)(lVar2 + 0xd8) = lVar1;
      if (lVar1 == 0) {
        *(long *)(this + 8) = lVar2;
      }
      else {
        *(long *)(lVar1 + 0xe0) = lVar2;
      }
    }
  }
  return;
}



// IOAccelSurfaceList::findSurfaceForID(unsigned int)

long __thiscall IOAccelSurfaceList::findSurfaceForID(IOAccelSurfaceList *this,int param_1)

{
  long lVar1;
  
  lVar1 = *(long *)this;
  while( true ) {
    if (lVar1 == 0) {
      return 0;
    }
    if (*(int *)(&DAT_00001168 + lVar1) == param_1) break;
    lVar1 = *(long *)(lVar1 + 0xd8);
  }
  return lVar1;
}



// IOAccelSurfaceList::Iterator::Iterator(IOAccelSurfaceList&)

void __thiscall IOAccelSurfaceList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelSurfaceList::Iterator::Iterator(IOAccelSurfaceList&)

void __thiscall IOAccelSurfaceList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelSurfaceList::Iterator::getNextSurface()

void __thiscall IOAccelSurfaceList::Iterator::getNextSurface(Iterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0xd8);
  }
  return;
}



// IOAccelSurfaceMTLList::init()

void __thiscall IOAccelSurfaceMTLList::init(IOAccelSurfaceMTLList *this)

{
  *(undefined8 *)this = 0;
  *(undefined8 *)(this + 8) = 0;
  *(undefined4 *)(this + 0x10) = 0;
  return;
}



// IOAccelSurfaceMTLList::getCount() const

undefined4 __thiscall IOAccelSurfaceMTLList::getCount(IOAccelSurfaceMTLList *this)

{
  return *(undefined4 *)(this + 0x10);
}



// IOAccelSurfaceMTLList::addSurface(IOAccelSurfaceMTL*)

void __thiscall IOAccelSurfaceMTLList::addSurface(IOAccelSurfaceMTLList *this,long param_1)

{
  long lVar1;
  IOAccelSurfaceMTLList *pIVar2;
  
  lVar1 = *(long *)this;
  *(undefined8 *)(param_1 + 0xe0) = 0;
  pIVar2 = (IOAccelSurfaceMTLList *)(lVar1 + 0xe0);
  if (lVar1 == 0) {
    pIVar2 = this + 8;
  }
  *(long *)pIVar2 = param_1;
  *(long *)(param_1 + 0xd8) = lVar1;
  *(int *)(this + 0x10) = *(int *)(this + 0x10) + 1;
  *(long *)this = param_1;
  return;
}



// IOAccelSurfaceMTLList::moveSurfaceToHead(IOAccelSurfaceMTL*)

void __thiscall IOAccelSurfaceMTLList::moveSurfaceToHead(IOAccelSurfaceMTLList *this,long param_1)

{
  long lVar1;
  long lVar2;
  long lVar3;
  IOAccelSurfaceMTLList *pIVar4;
  
  lVar1 = *(long *)this;
  if (lVar1 != param_1) {
    lVar2 = *(long *)(param_1 + 0xd8);
    lVar3 = *(long *)(param_1 + 0xe0);
    *(long *)(lVar3 + 0xd8) = lVar2;
    *(undefined8 *)(param_1 + 0xe0) = 0;
    *(long *)(param_1 + 0xd8) = lVar1;
    *(long *)(lVar1 + 0xe0) = param_1;
    *(long *)this = param_1;
    pIVar4 = this + 8;
    if (lVar2 != 0) {
      pIVar4 = (IOAccelSurfaceMTLList *)(lVar2 + 0xe0);
    }
    *(long *)pIVar4 = lVar3;
  }
  return;
}



// IOAccelSurfaceMTLList::removeSurface(IOAccelSurfaceMTL*)

void __thiscall IOAccelSurfaceMTLList::removeSurface(IOAccelSurfaceMTLList *this,long param_1)

{
  long lVar1;
  long lVar2;
  
  if (*(long *)this == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Internal error - no surface list\n",
                      "void IOAccelSurfaceMTLList::removeSurface(IOAccelSurfaceMTL *)");
  }
  else {
    lVar1 = *(long *)(param_1 + 0xd8);
    lVar2 = *(long *)(param_1 + 0xe0);
    *(undefined8 *)(param_1 + 0xe0) = 0;
    *(undefined8 *)(param_1 + 0xd8) = 0;
    *(int *)(this + 0x10) = *(int *)(this + 0x10) + -1;
    if (lVar2 == 0) {
      *(long *)this = lVar1;
      if (lVar1 == 0) {
        *(undefined8 *)(this + 8) = 0;
      }
      else {
        *(undefined8 *)(lVar1 + 0xe0) = 0;
      }
    }
    else {
      *(long *)(lVar2 + 0xd8) = lVar1;
      if (lVar1 == 0) {
        *(long *)(this + 8) = lVar2;
      }
      else {
        *(long *)(lVar1 + 0xe0) = lVar2;
      }
    }
  }
  return;
}



// IOAccelSurfaceMTLList::findSurfaceForID(unsigned int)

long __thiscall IOAccelSurfaceMTLList::findSurfaceForID(IOAccelSurfaceMTLList *this,int param_1)

{
  long lVar1;
  
  lVar1 = *(long *)this;
  while( true ) {
    if (lVar1 == 0) {
      return 0;
    }
    if (*(int *)(lVar1 + 0x128) == param_1) break;
    lVar1 = *(long *)(lVar1 + 0xd8);
  }
  return lVar1;
}



// IOAccelSurfaceMTLList::Iterator::Iterator(IOAccelSurfaceMTLList&)

void __thiscall IOAccelSurfaceMTLList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelSurfaceMTLList::Iterator::Iterator(IOAccelSurfaceMTLList&)

void __thiscall IOAccelSurfaceMTLList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelSurfaceMTLList::Iterator::getNextSurface()

void __thiscall IOAccelSurfaceMTLList::Iterator::getNextSurface(Iterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0xd8);
  }
  return;
}



// IOAccelResourceList::init()

void __thiscall IOAccelResourceList::init(IOAccelResourceList *this)

{
  *(undefined8 *)this = 0;
  *(undefined8 *)(this + 8) = 0;
  *(undefined4 *)(this + 0x10) = 0;
  return;
}



// IOAccelResourceList::getCount() const

undefined4 __thiscall IOAccelResourceList::getCount(IOAccelResourceList *this)

{
  return *(undefined4 *)(this + 0x10);
}



// IOAccelResourceList::addResource(IOAccelResource2*)

void __thiscall IOAccelResourceList::addResource(IOAccelResourceList *this,long param_1)

{
  long lVar1;
  IOAccelResourceList *pIVar2;
  
  lVar1 = *(long *)this;
  *(undefined8 *)(param_1 + 0x50) = 0;
  pIVar2 = (IOAccelResourceList *)(lVar1 + 0x50);
  if (lVar1 == 0) {
    pIVar2 = this + 8;
  }
  *(long *)pIVar2 = param_1;
  *(long *)(param_1 + 0x48) = lVar1;
  *(int *)(this + 0x10) = *(int *)(this + 0x10) + 1;
  *(long *)this = param_1;
  return;
}



// IOAccelResourceList::moveResourceToHead(IOAccelResource2*)

void __thiscall IOAccelResourceList::moveResourceToHead(IOAccelResourceList *this,long param_1)

{
  long lVar1;
  long lVar2;
  long lVar3;
  IOAccelResourceList *pIVar4;
  
  lVar1 = *(long *)this;
  if (lVar1 != param_1) {
    lVar2 = *(long *)(param_1 + 0x48);
    lVar3 = *(long *)(param_1 + 0x50);
    *(long *)(lVar3 + 0x48) = lVar2;
    *(undefined8 *)(param_1 + 0x50) = 0;
    *(long *)(param_1 + 0x48) = lVar1;
    *(long *)(lVar1 + 0x50) = param_1;
    *(long *)this = param_1;
    pIVar4 = this + 8;
    if (lVar2 != 0) {
      pIVar4 = (IOAccelResourceList *)(lVar2 + 0x50);
    }
    *(long *)pIVar4 = lVar3;
  }
  return;
}



// IOAccelResourceList::removeResource(IOAccelResource2*)

void __thiscall IOAccelResourceList::removeResource(IOAccelResourceList *this,long param_1)

{
  long lVar1;
  long lVar2;
  long lVar3;
  
  lVar1 = *(long *)this;
  if (lVar1 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Internal error - no loaded texture list\n",
                      "void IOAccelResourceList::removeResource(IOAccelResource2 *)");
  }
  else {
    lVar2 = *(long *)(param_1 + 0x48);
    lVar3 = *(long *)(param_1 + 0x50);
    *(undefined8 *)(param_1 + 0x50) = 0;
    *(undefined8 *)(param_1 + 0x48) = 0;
    *(int *)(this + 0x10) = *(int *)(this + 0x10) + -1;
    if (lVar3 == 0) {
      if (lVar1 == param_1) {
        *(long *)this = lVar2;
        if (lVar2 == 0) {
          if (*(long *)(this + 8) == param_1) {
            *(undefined8 *)(this + 8) = 0;
          }
          else {
            removeResource();
          }
        }
        else {
          *(undefined8 *)(lVar2 + 0x50) = 0;
        }
      }
      else {
        removeResource();
      }
    }
    else {
      *(long *)(lVar3 + 0x48) = lVar2;
      if (lVar2 == 0) {
        if (*(long *)(this + 8) == param_1) {
          *(long *)(this + 8) = lVar3;
        }
        else {
          removeResource();
        }
      }
      else {
        *(long *)(lVar2 + 0x50) = lVar3;
      }
    }
  }
  return;
}



// IOAccelResourceList::objectInList(IOAccelResource2*)

undefined8 __thiscall IOAccelResourceList::objectInList(IOAccelResourceList *this,long param_1)

{
  long lVar1;
  undefined7 uVar3;
  undefined8 uVar2;
  
  lVar1 = *(long *)(param_1 + 0x50);
  uVar3 = (undefined7)((ulong)lVar1 >> 8);
  if ((lVar1 == 0) && (*(long *)this == param_1)) {
    uVar2 = 1;
  }
  else if (*(long *)(param_1 + 0x48) == 0) {
    uVar2 = CONCAT71(uVar3,*(long *)(this + 8) == param_1);
  }
  else {
    uVar2 = CONCAT71(uVar3,lVar1 != 0);
  }
  return uVar2;
}



// IOAccelResourceList::assertListConsistency()

void IOAccelResourceList::assertListConsistency(void)

{
  return;
}



// IOAccelResourceList::Iterator::Iterator(IOAccelResourceList&)

void __thiscall IOAccelResourceList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelResourceList::Iterator::Iterator(IOAccelResourceList&)

void __thiscall IOAccelResourceList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelResourceList::Iterator::getNextResource()

void __thiscall IOAccelResourceList::Iterator::getNextResource(Iterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0x48);
  }
  return;
}



// IOAccelResourceList::ReverseIterator::ReverseIterator(IOAccelResourceList&)

void __thiscall
IOAccelResourceList::ReverseIterator::ReverseIterator(ReverseIterator *this,long param_1)

{
  *(undefined8 *)this = *(undefined8 *)(param_1 + 8);
  return;
}



// IOAccelResourceList::ReverseIterator::ReverseIterator(IOAccelResourceList&)

void __thiscall
IOAccelResourceList::ReverseIterator::ReverseIterator(ReverseIterator *this,long param_1)

{
  *(undefined8 *)this = *(undefined8 *)(param_1 + 8);
  return;
}



// IOAccelResourceList::ReverseIterator::getPrevResource()

void __thiscall IOAccelResourceList::ReverseIterator::getPrevResource(ReverseIterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0x50);
  }
  return;
}



// IOAccelSysMemoryList::init()

void __thiscall IOAccelSysMemoryList::init(IOAccelSysMemoryList *this)

{
  *(undefined8 *)this = 0;
  *(undefined8 *)(this + 8) = 0;
  *(undefined8 *)(this + 0x10) = 0;
  return;
}



// IOAccelSysMemoryList::getCount() const

undefined4 __thiscall IOAccelSysMemoryList::getCount(IOAccelSysMemoryList *this)

{
  return *(undefined4 *)(this + 0x10);
}



// IOAccelSysMemoryList::addMemory(IOAccelSysMemory*)

void __thiscall IOAccelSysMemoryList::addMemory(IOAccelSysMemoryList *this,long param_1)

{
  long lVar1;
  IOAccelSysMemoryList *pIVar2;
  
  lVar1 = *(long *)this;
  *(undefined8 *)(param_1 + 0xb8) = 0;
  pIVar2 = (IOAccelSysMemoryList *)(lVar1 + 0xb8);
  if (lVar1 == 0) {
    pIVar2 = this + 8;
  }
  *(long *)pIVar2 = param_1;
  *(long *)(param_1 + 0xb0) = lVar1;
  *(int *)(this + 0x10) = *(int *)(this + 0x10) + 1;
  *(long *)this = param_1;
  return;
}



// IOAccelSysMemoryList::moveMemoryToHead(IOAccelSysMemory*)

void IOAccelSysMemoryList::moveMemoryToHead(void)

{
  return;
}



// IOAccelSysMemoryList::moveMemoryToTail(IOAccelSysMemory*)

void __thiscall IOAccelSysMemoryList::moveMemoryToTail(IOAccelSysMemoryList *this,long param_1)

{
  long lVar1;
  long lVar2;
  long lVar3;
  IOAccelSysMemoryList *pIVar4;
  
  lVar1 = *(long *)(this + 8);
  if (lVar1 != param_1) {
    lVar2 = *(long *)(param_1 + 0xb0);
    lVar3 = *(long *)(param_1 + 0xb8);
    pIVar4 = (IOAccelSysMemoryList *)(lVar3 + 0xb0);
    if (lVar3 == 0) {
      pIVar4 = this;
    }
    *(long *)pIVar4 = lVar2;
    *(long *)(lVar2 + 0xb8) = lVar3;
    *(long *)(param_1 + 0xb8) = lVar1;
    *(undefined8 *)(param_1 + 0xb0) = 0;
    *(long *)(lVar1 + 0xb0) = param_1;
    *(long *)(this + 8) = param_1;
  }
  return;
}



// IOAccelSysMemoryList::removeMemory(IOAccelSysMemory*)

void __thiscall IOAccelSysMemoryList::removeMemory(IOAccelSysMemoryList *this,long param_1)

{
  long lVar1;
  long lVar2;
  
  if (*(long *)this == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Internal error - no loaded allocation list\n",
                      "void IOAccelSysMemoryList::removeMemory(IOAccelSysMemory *)");
  }
  else {
    lVar1 = *(long *)(param_1 + 0xb0);
    lVar2 = *(long *)(param_1 + 0xb8);
    *(undefined8 *)(param_1 + 0xb8) = 0;
    *(undefined8 *)(param_1 + 0xb0) = 0;
    if (lVar2 == 0) {
      *(long *)this = lVar1;
      if (lVar1 == 0) {
        *(undefined8 *)(this + 8) = 0;
      }
      else {
        *(undefined8 *)(lVar1 + 0xb8) = 0;
      }
    }
    else {
      *(long *)(lVar2 + 0xb0) = lVar1;
      if (lVar1 == 0) {
        *(long *)(this + 8) = lVar2;
      }
      else {
        *(long *)(lVar1 + 0xb8) = lVar2;
      }
    }
    *(int *)(this + 0x10) = *(int *)(this + 0x10) + -1;
  }
  return;
}



// IOAccelSysMemoryList::Iterator::Iterator(IOAccelSysMemoryList&)

void __thiscall IOAccelSysMemoryList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelSysMemoryList::Iterator::Iterator(IOAccelSysMemoryList&)

void __thiscall IOAccelSysMemoryList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelSysMemoryList::Iterator::getNextMemory()

void __thiscall IOAccelSysMemoryList::Iterator::getNextMemory(Iterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0xb0);
  }
  return;
}



// IOAccelSysMemoryList::ReverseIterator::ReverseIterator(IOAccelSysMemoryList&)

void __thiscall
IOAccelSysMemoryList::ReverseIterator::ReverseIterator(ReverseIterator *this,long param_1)

{
  *(undefined8 *)this = *(undefined8 *)(param_1 + 8);
  return;
}



// IOAccelSysMemoryList::ReverseIterator::ReverseIterator(IOAccelSysMemoryList&)

void __thiscall
IOAccelSysMemoryList::ReverseIterator::ReverseIterator(ReverseIterator *this,long param_1)

{
  *(undefined8 *)this = *(undefined8 *)(param_1 + 8);
  return;
}



// IOAccelSysMemoryList::ReverseIterator::getPrevMemory()

void __thiscall IOAccelSysMemoryList::ReverseIterator::getPrevMemory(ReverseIterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0xb8);
  }
  return;
}



// IOAccelSysMemoryList::sort()

void __thiscall IOAccelSysMemoryList::sort(IOAccelSysMemoryList *this)

{
  long lVar1;
  long lVar2;
  long lVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint *puVar7;
  ulong uVar8;
  ulong uVar9;
  ulong uVar10;
  long lVar11;
  uint *puVar12;
  long lVar13;
  IOAccelSysMemoryList *pIVar14;
  ulong uVar15;
  uint *puVar16;
  IOAccelMemory *this_00;
  
  puVar7 = (uint *)_IOMallocTypeVarImpl
                             (&sort()::kalloc_type_view_1122,(ulong)*(uint *)(this + 0x10) << 4);
  this_00 = *(IOAccelMemory **)(this + 8);
  iVar4 = -1;
  if (this_00 != (IOAccelMemory *)0x0) {
    uVar6 = 1;
    uVar10 = 0;
    puVar16 = puVar7;
    do {
      uVar8 = uVar10;
      uVar15 = (ulong)uVar6;
      uVar5 = IOAccelMemory::getLRUSeed(this_00);
      uVar10 = 0;
      if (uVar8 != 0) {
        uVar9 = 0;
        puVar12 = puVar7;
        do {
          uVar10 = uVar9;
          if (uVar5 < *puVar12) break;
          uVar9 = uVar9 + 1;
          puVar12 = puVar12 + 4;
          uVar10 = uVar8;
        } while (uVar8 != uVar9);
      }
      uVar9 = uVar8;
      if ((uVar10 & 0xffffffff) < uVar8) {
        puVar12 = puVar16;
        do {
          uVar9 = uVar9 - 1;
          *puVar12 = puVar12[-4];
          *(undefined8 *)(puVar12 + 2) = *(undefined8 *)(puVar12 + -2);
          puVar12 = puVar12 + -4;
        } while ((long)(int)uVar10 < (long)uVar9);
      }
      puVar7[(long)(int)uVar9 * 4] = uVar5;
      *(IOAccelMemory **)(puVar7 + (long)(int)uVar9 * 4 + 2) = this_00;
      this_00 = *(IOAccelMemory **)(this_00 + 0xb8);
      uVar6 = uVar6 + 1;
      puVar16 = puVar16 + 4;
      uVar10 = uVar8 + 1;
    } while (this_00 != (IOAccelMemory *)0x0);
    iVar4 = -1;
    if ((int)(uVar8 + 1) != 0) {
      lVar11 = 0;
      lVar13 = *(long *)(this + 8);
      do {
        lVar1 = *(long *)((long)puVar7 + lVar11 + 8);
        if (lVar13 != lVar1) {
          lVar2 = *(long *)(lVar1 + 0xb0);
          lVar3 = *(long *)(lVar1 + 0xb8);
          pIVar14 = (IOAccelSysMemoryList *)(lVar3 + 0xb0);
          if (lVar3 == 0) {
            pIVar14 = this;
          }
          *(long *)pIVar14 = lVar2;
          *(long *)(lVar2 + 0xb8) = lVar3;
          *(long *)(lVar1 + 0xb8) = lVar13;
          *(undefined8 *)(lVar1 + 0xb0) = 0;
          *(long *)(lVar13 + 0xb0) = lVar1;
          *(long *)(this + 8) = lVar1;
        }
        lVar11 = lVar11 + 0x10;
        lVar13 = lVar1;
      } while (uVar15 << 4 != lVar11);
      iVar4 = (int)uVar8;
    }
  }
  *(uint *)(this + 0x14) = puVar7[(long)iVar4 * 4];
  _IOFreeTypeVarImpl(&sort()::kalloc_type_view_1158,puVar7,(ulong)*(uint *)(this + 0x10) << 4);
  return;
}



// IOAccelSysMemoryList::OrderedReverseIterator::OrderedReverseIterator(IOAccelSysMemoryList&)

void __thiscall
IOAccelSysMemoryList::OrderedReverseIterator::OrderedReverseIterator
          (OrderedReverseIterator *this,long param_1)

{
  uint uVar1;
  IOAccelMemory *this_00;
  
  this_00 = *(IOAccelMemory **)(param_1 + 8);
  *(IOAccelMemory **)this = this_00;
  *(undefined4 *)(this + 8) = *(undefined4 *)(param_1 + 0x14);
  while( true ) {
    if (this_00 == (IOAccelMemory *)0x0) {
      return;
    }
    uVar1 = IOAccelMemory::getLRUSeed(this_00);
    if (uVar1 <= *(uint *)(this + 8)) break;
    this_00 = *(IOAccelMemory **)(*(long *)this + 0xb8);
    *(IOAccelMemory **)this = this_00;
  }
  return;
}



// IOAccelSysMemoryList::OrderedReverseIterator::OrderedReverseIterator(IOAccelSysMemoryList&)

void __thiscall
IOAccelSysMemoryList::OrderedReverseIterator::OrderedReverseIterator
          (OrderedReverseIterator *this,long param_1)

{
  OrderedReverseIterator(this,param_1);
  return;
}



// IOAccelSysMemoryList::OrderedReverseIterator::getPrevMemory()

long __thiscall
IOAccelSysMemoryList::OrderedReverseIterator::getPrevMemory(OrderedReverseIterator *this)

{
  long lVar1;
  uint uVar2;
  IOAccelMemory *this_00;
  
  lVar1 = *(long *)this;
  if (lVar1 != 0) {
    this_00 = *(IOAccelMemory **)(lVar1 + 0xb8);
    while (*(IOAccelMemory **)this = this_00, this_00 != (IOAccelMemory *)0x0) {
      uVar2 = IOAccelMemory::getLRUSeed(this_00);
      if (uVar2 <= *(uint *)(this + 8)) {
        return lVar1;
      }
      this_00 = *(IOAccelMemory **)(*(long *)this + 0xb8);
    }
  }
  return lVar1;
}



// IOAccelVidMemoryList::init()

void __thiscall IOAccelVidMemoryList::init(IOAccelVidMemoryList *this)

{
  *(undefined8 *)this = 0;
  *(undefined8 *)(this + 8) = 0;
  *(undefined4 *)(this + 0x10) = 0;
  return;
}



// IOAccelVidMemoryList::getCount() const

undefined4 __thiscall IOAccelVidMemoryList::getCount(IOAccelVidMemoryList *this)

{
  return *(undefined4 *)(this + 0x10);
}



// IOAccelVidMemoryList::addMemory(IOAccelVidMemory*)

void __thiscall IOAccelVidMemoryList::addMemory(IOAccelVidMemoryList *this,long param_1)

{
  long lVar1;
  IOAccelVidMemoryList *pIVar2;
  
  lVar1 = *(long *)this;
  *(undefined8 *)(param_1 + 0xb8) = 0;
  pIVar2 = (IOAccelVidMemoryList *)(lVar1 + 0xb8);
  if (lVar1 == 0) {
    pIVar2 = this + 8;
  }
  *(long *)pIVar2 = param_1;
  *(long *)(param_1 + 0xb0) = lVar1;
  *(int *)(this + 0x10) = *(int *)(this + 0x10) + 1;
  *(long *)this = param_1;
  return;
}



// IOAccelVidMemoryList::moveMemoryToHead(IOAccelVidMemory*)

void __thiscall IOAccelVidMemoryList::moveMemoryToHead(IOAccelVidMemoryList *this,long param_1)

{
  long lVar1;
  long lVar2;
  long lVar3;
  IOAccelVidMemoryList *pIVar4;
  
  lVar1 = *(long *)this;
  if (lVar1 != param_1) {
    lVar2 = *(long *)(param_1 + 0xb0);
    lVar3 = *(long *)(param_1 + 0xb8);
    *(long *)(lVar3 + 0xb0) = lVar2;
    *(undefined8 *)(param_1 + 0xb8) = 0;
    *(long *)(param_1 + 0xb0) = lVar1;
    *(long *)(lVar1 + 0xb8) = param_1;
    *(long *)this = param_1;
    pIVar4 = this + 8;
    if (lVar2 != 0) {
      pIVar4 = (IOAccelVidMemoryList *)(lVar2 + 0xb8);
    }
    *(long *)pIVar4 = lVar3;
  }
  return;
}



// IOAccelVidMemoryList::moveMemoryToTail(IOAccelVidMemory*)

void __thiscall IOAccelVidMemoryList::moveMemoryToTail(IOAccelVidMemoryList *this,long param_1)

{
  long lVar1;
  long lVar2;
  long lVar3;
  IOAccelVidMemoryList *pIVar4;
  
  lVar1 = *(long *)(this + 8);
  if (lVar1 != param_1) {
    lVar2 = *(long *)(param_1 + 0xb0);
    lVar3 = *(long *)(param_1 + 0xb8);
    pIVar4 = (IOAccelVidMemoryList *)(lVar3 + 0xb0);
    if (lVar3 == 0) {
      pIVar4 = this;
    }
    *(long *)pIVar4 = lVar2;
    *(long *)(lVar2 + 0xb8) = lVar3;
    *(long *)(param_1 + 0xb8) = lVar1;
    *(undefined8 *)(param_1 + 0xb0) = 0;
    *(long *)(lVar1 + 0xb0) = param_1;
    *(long *)(this + 8) = param_1;
  }
  return;
}



// IOAccelVidMemoryList::removeMemory(IOAccelVidMemory*)

void __thiscall IOAccelVidMemoryList::removeMemory(IOAccelVidMemoryList *this,long param_1)

{
  long lVar1;
  long lVar2;
  
  if (*(long *)this == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Internal error - no loaded allocation list\n",
                      "void IOAccelVidMemoryList::removeMemory(IOAccelVidMemory *)");
  }
  else {
    lVar1 = *(long *)(param_1 + 0xb0);
    lVar2 = *(long *)(param_1 + 0xb8);
    *(undefined8 *)(param_1 + 0xb8) = 0;
    *(undefined8 *)(param_1 + 0xb0) = 0;
    *(int *)(this + 0x10) = *(int *)(this + 0x10) + -1;
    if (lVar2 == 0) {
      *(long *)this = lVar1;
      if (lVar1 == 0) {
        *(undefined8 *)(this + 8) = 0;
      }
      else {
        *(undefined8 *)(lVar1 + 0xb8) = 0;
      }
    }
    else {
      *(long *)(lVar2 + 0xb0) = lVar1;
      if (lVar1 == 0) {
        *(long *)(this + 8) = lVar2;
      }
      else {
        *(long *)(lVar1 + 0xb8) = lVar2;
      }
    }
  }
  return;
}



// IOAccelVidMemoryList::Iterator::Iterator(IOAccelVidMemoryList&)

void __thiscall IOAccelVidMemoryList::Iterator::Iterator(Iterator *this,long *param_1)

{
  long *plVar1;
  
  plVar1 = (long *)*param_1;
  *(long **)this = plVar1;
  if (plVar1 != (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001dda0. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*plVar1 + 0x20))();
    return;
  }
  return;
}



// IOAccelVidMemoryList::Iterator::Iterator(IOAccelVidMemoryList&)

void __thiscall IOAccelVidMemoryList::Iterator::Iterator(Iterator *this,long *param_1)

{
  long *plVar1;
  
  plVar1 = (long *)*param_1;
  *(long **)this = plVar1;
  if (plVar1 != (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001ddbc. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*plVar1 + 0x20))();
    return;
  }
  return;
}



// IOAccelVidMemoryList::Iterator::~Iterator()

void __thiscall IOAccelVidMemoryList::Iterator::~Iterator(Iterator *this)

{
  if (*(long **)this != (long *)0x0) {
    (**(code **)(**(long **)this + 0x28))();
  }
  *(undefined8 *)this = 0;
  return;
}



// IOAccelVidMemoryList::Iterator::~Iterator()

void __thiscall IOAccelVidMemoryList::Iterator::~Iterator(Iterator *this)

{
  if (*(long **)this != (long *)0x0) {
    (**(code **)(**(long **)this + 0x28))();
  }
  *(undefined8 *)this = 0;
  return;
}



// IOAccelVidMemoryList::Iterator::getNextMemory()

long * __thiscall IOAccelVidMemoryList::Iterator::getNextMemory(Iterator *this)

{
  long *plVar1;
  int iVar2;
  long *plVar3;
  
  plVar1 = *(long **)this;
  if (plVar1 == (long *)0x0) {
    plVar3 = (long *)0x0;
  }
  else {
    plVar3 = (long *)plVar1[0x16];
    *(long **)this = plVar3;
    if (plVar3 != (long *)0x0) {
      (**(code **)(*plVar3 + 0x20))();
    }
    iVar2 = (**(code **)(*plVar1 + 0x18))(plVar1);
    plVar3 = plVar1;
    if (iVar2 < 2) {
      plVar3 = getNextMemory(this);
    }
    (**(code **)(*plVar1 + 0x28))(plVar1);
  }
  return plVar3;
}



// IOAccelVidMemoryList::ReverseIterator::ReverseIterator(IOAccelVidMemoryList&)

void __thiscall
IOAccelVidMemoryList::ReverseIterator::ReverseIterator(ReverseIterator *this,long param_1)

{
  long *plVar1;
  
  plVar1 = *(long **)(param_1 + 8);
  *(long **)this = plVar1;
  if (plVar1 != (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001de87. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*plVar1 + 0x20))();
    return;
  }
  return;
}



// IOAccelVidMemoryList::ReverseIterator::ReverseIterator(IOAccelVidMemoryList&)

void __thiscall
IOAccelVidMemoryList::ReverseIterator::ReverseIterator(ReverseIterator *this,long param_1)

{
  long *plVar1;
  
  plVar1 = *(long **)(param_1 + 8);
  *(long **)this = plVar1;
  if (plVar1 != (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001dea3. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*plVar1 + 0x20))();
    return;
  }
  return;
}



// IOAccelVidMemoryList::ReverseIterator::~ReverseIterator()

void __thiscall IOAccelVidMemoryList::ReverseIterator::~ReverseIterator(ReverseIterator *this)

{
  if (*(long **)this != (long *)0x0) {
    (**(code **)(**(long **)this + 0x28))();
  }
  *(undefined8 *)this = 0;
  return;
}



// IOAccelVidMemoryList::ReverseIterator::~ReverseIterator()

void __thiscall IOAccelVidMemoryList::ReverseIterator::~ReverseIterator(ReverseIterator *this)

{
  if (*(long **)this != (long *)0x0) {
    (**(code **)(**(long **)this + 0x28))();
  }
  *(undefined8 *)this = 0;
  return;
}



// IOAccelVidMemoryList::ReverseIterator::getPrevMemory()

long * __thiscall IOAccelVidMemoryList::ReverseIterator::getPrevMemory(ReverseIterator *this)

{
  long *plVar1;
  int iVar2;
  long *plVar3;
  
  plVar1 = *(long **)this;
  if (plVar1 == (long *)0x0) {
    plVar3 = (long *)0x0;
  }
  else {
    plVar3 = (long *)plVar1[0x17];
    *(long **)this = plVar3;
    if (plVar3 != (long *)0x0) {
      (**(code **)(*plVar3 + 0x20))();
    }
    iVar2 = (**(code **)(*plVar1 + 0x18))(plVar1);
    plVar3 = plVar1;
    if (iVar2 < 2) {
      plVar3 = getPrevMemory(this);
    }
    (**(code **)(*plVar1 + 0x28))(plVar1);
  }
  return plVar3;
}



// IOAccelMemoryMapList::init()

void __thiscall IOAccelMemoryMapList::init(IOAccelMemoryMapList *this)

{
  *(undefined8 *)this = 0;
  *(undefined8 *)(this + 8) = 0;
  *(undefined4 *)(this + 0x10) = 0;
  return;
}



// IOAccelMemoryMapList::getCount() const

undefined4 __thiscall IOAccelMemoryMapList::getCount(IOAccelMemoryMapList *this)

{
  return *(undefined4 *)(this + 0x10);
}



// IOAccelMemoryMapList::addMapping(IOAccelMemoryMap*)

void __thiscall IOAccelMemoryMapList::addMapping(IOAccelMemoryMapList *this,long param_1)

{
  long lVar1;
  IOAccelMemoryMapList *pIVar2;
  
  lVar1 = *(long *)this;
  *(undefined8 *)(param_1 + 0x28) = 0;
  pIVar2 = (IOAccelMemoryMapList *)(lVar1 + 0x28);
  if (lVar1 == 0) {
    pIVar2 = this + 8;
  }
  *(long *)pIVar2 = param_1;
  *(long *)(param_1 + 0x30) = lVar1;
  *(int *)(this + 0x10) = *(int *)(this + 0x10) + 1;
  *(long *)this = param_1;
  return;
}



// IOAccelMemoryMapList::moveMappingToHead(IOAccelMemoryMap*)

void __thiscall IOAccelMemoryMapList::moveMappingToHead(IOAccelMemoryMapList *this,long param_1)

{
  long lVar1;
  long lVar2;
  long lVar3;
  IOAccelMemoryMapList *pIVar4;
  
  lVar1 = *(long *)this;
  if (lVar1 != param_1) {
    lVar2 = *(long *)(param_1 + 0x28);
    lVar3 = *(long *)(param_1 + 0x30);
    *(long *)(lVar2 + 0x30) = lVar3;
    *(undefined8 *)(param_1 + 0x28) = 0;
    *(long *)(param_1 + 0x30) = lVar1;
    *(long *)(lVar1 + 0x28) = param_1;
    *(long *)this = param_1;
    pIVar4 = this + 8;
    if (lVar3 != 0) {
      pIVar4 = (IOAccelMemoryMapList *)(lVar3 + 0x28);
    }
    *(long *)pIVar4 = lVar2;
  }
  return;
}



// IOAccelMemoryMapList::removeMapping(IOAccelMemoryMap*)

void __thiscall IOAccelMemoryMapList::removeMapping(IOAccelMemoryMapList *this,long param_1)

{
  long lVar1;
  long lVar2;
  
  if (*(long *)this == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Internal error - no loaded allocation list\n",
                      "void IOAccelMemoryMapList::removeMapping(IOAccelMemoryMap *)");
  }
  else {
    lVar1 = *(long *)(param_1 + 0x28);
    lVar2 = *(long *)(param_1 + 0x30);
    *(undefined8 *)(param_1 + 0x28) = 0;
    *(undefined8 *)(param_1 + 0x30) = 0;
    *(int *)(this + 0x10) = *(int *)(this + 0x10) + -1;
    if (lVar1 == 0) {
      *(long *)this = lVar2;
      if (lVar2 == 0) {
        *(undefined8 *)(this + 8) = 0;
      }
      else {
        *(undefined8 *)(lVar2 + 0x28) = 0;
      }
    }
    else {
      *(long *)(lVar1 + 0x30) = lVar2;
      if (lVar2 == 0) {
        *(long *)(this + 8) = lVar1;
      }
      else {
        *(long *)(lVar2 + 0x28) = lVar1;
      }
    }
  }
  return;
}



// IOAccelMemoryMapList::Iterator::Iterator(IOAccelMemoryMapList&)

void __thiscall IOAccelMemoryMapList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelMemoryMapList::Iterator::Iterator(IOAccelMemoryMapList&)

void __thiscall IOAccelMemoryMapList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelMemoryMapList::Iterator::getNextMapping()

void __thiscall IOAccelMemoryMapList::Iterator::getNextMapping(Iterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0x30);
  }
  return;
}



// IOAccelMemoryMapList::ReverseIterator::ReverseIterator(IOAccelMemoryMapList&)

void __thiscall
IOAccelMemoryMapList::ReverseIterator::ReverseIterator(ReverseIterator *this,long param_1)

{
  *(undefined8 *)this = *(undefined8 *)(param_1 + 8);
  return;
}



// IOAccelMemoryMapList::ReverseIterator::ReverseIterator(IOAccelMemoryMapList&)

void __thiscall
IOAccelMemoryMapList::ReverseIterator::ReverseIterator(ReverseIterator *this,long param_1)

{
  *(undefined8 *)this = *(undefined8 *)(param_1 + 8);
  return;
}



// IOAccelMemoryMapList::ReverseIterator::getPrevMapping()

void __thiscall IOAccelMemoryMapList::ReverseIterator::getPrevMapping(ReverseIterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0x28);
  }
  return;
}



// IOAccelTaskList::init()

void __thiscall IOAccelTaskList::init(IOAccelTaskList *this)

{
  *(undefined8 *)this = 0;
  *(undefined4 *)(this + 8) = 0;
  return;
}



// IOAccelTaskList::getCount() const

undefined4 __thiscall IOAccelTaskList::getCount(IOAccelTaskList *this)

{
  return *(undefined4 *)(this + 8);
}



// IOAccelTaskList::addTask(IOAccelTask*)

void __thiscall IOAccelTaskList::addTask(IOAccelTaskList *this,long param_1)

{
  *(undefined8 *)(param_1 + 0x18) = *(undefined8 *)this;
  *(long *)this = param_1;
  *(int *)(this + 8) = *(int *)(this + 8) + 1;
  return;
}



// IOAccelTaskList::removeTask(IOAccelTask*)

void __thiscall IOAccelTaskList::removeTask(IOAccelTaskList *this,long param_1)

{
  long lVar1;
  IOAccelTaskList *pIVar2;
  long lVar3;
  
  lVar1 = *(long *)this;
  if (lVar1 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Internal error - no ring buffer list\n",
                      "void IOAccelTaskList::removeTask(IOAccelTask *)");
  }
  else {
    pIVar2 = this;
    if (lVar1 != param_1) {
      do {
        lVar3 = lVar1;
        lVar1 = *(long *)(lVar3 + 0x18);
        if (lVar1 == 0) break;
      } while (lVar1 != param_1);
      if (lVar1 == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Internal error - deleting non-existant ring buffer\n",
                          "void IOAccelTaskList::removeTask(IOAccelTask *)");
        return;
      }
      pIVar2 = (IOAccelTaskList *)(lVar3 + 0x18);
    }
    *(undefined8 *)pIVar2 = *(undefined8 *)(param_1 + 0x18);
    *(int *)(this + 8) = *(int *)(this + 8) + -1;
    *(undefined8 *)(param_1 + 0x18) = 0;
  }
  return;
}



// IOAccelTaskList::Iterator::Iterator(IOAccelTaskList&)

void __thiscall IOAccelTaskList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelTaskList::Iterator::Iterator(IOAccelTaskList&)

void __thiscall IOAccelTaskList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelTaskList::Iterator::getNextTask()

void __thiscall IOAccelTaskList::Iterator::getNextTask(Iterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0x18);
  }
  return;
}



// IOAccelChannelList::init()

void __thiscall IOAccelChannelList::init(IOAccelChannelList *this)

{
  *(undefined8 *)this = 0;
  *(undefined4 *)(this + 8) = 0;
  return;
}



// IOAccelChannelList::getCount() const

undefined4 __thiscall IOAccelChannelList::getCount(IOAccelChannelList *this)

{
  return *(undefined4 *)(this + 8);
}



// IOAccelChannelList::addChannel(IOAccelChannel2*)

void __thiscall IOAccelChannelList::addChannel(IOAccelChannelList *this,long param_1)

{
  *(undefined8 *)(param_1 + 0x10) = *(undefined8 *)this;
  *(long *)this = param_1;
  *(int *)(this + 8) = *(int *)(this + 8) + 1;
  return;
}



// IOAccelChannelList::removeChannel(IOAccelChannel2*)

void __thiscall IOAccelChannelList::removeChannel(IOAccelChannelList *this,long param_1)

{
  long lVar1;
  IOAccelChannelList *pIVar2;
  long lVar3;
  
  lVar1 = *(long *)this;
  if (lVar1 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Internal error - no ring buffer list\n",
                      "void IOAccelChannelList::removeChannel(IOAccelChannel2 *)");
  }
  else {
    pIVar2 = this;
    if (lVar1 != param_1) {
      do {
        lVar3 = lVar1;
        lVar1 = *(long *)(lVar3 + 0x10);
        if (lVar1 == 0) break;
      } while (lVar1 != param_1);
      if (lVar1 == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Internal error - deleting non-existant ring buffer\n",
                          "void IOAccelChannelList::removeChannel(IOAccelChannel2 *)");
        return;
      }
      pIVar2 = (IOAccelChannelList *)(lVar3 + 0x10);
    }
    *(undefined8 *)pIVar2 = *(undefined8 *)(param_1 + 0x10);
    *(int *)(this + 8) = *(int *)(this + 8) + -1;
    *(undefined8 *)(param_1 + 0x10) = 0;
  }
  return;
}



// IOAccelChannelList::Iterator::Iterator(IOAccelChannelList&)

void __thiscall IOAccelChannelList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelChannelList::Iterator::Iterator(IOAccelChannelList&)

void __thiscall IOAccelChannelList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelChannelList::Iterator::getNextChannel()

void __thiscall IOAccelChannelList::Iterator::getNextChannel(Iterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0x10);
  }
  return;
}



// IOAccelCommandBufferPoolList::init()

void __thiscall IOAccelCommandBufferPoolList::init(IOAccelCommandBufferPoolList *this)

{
  *(undefined8 *)this = 0;
  *(undefined4 *)(this + 8) = 0;
  return;
}



// IOAccelCommandBufferPoolList::getCount() const

undefined4 __thiscall IOAccelCommandBufferPoolList::getCount(IOAccelCommandBufferPoolList *this)

{
  return *(undefined4 *)(this + 8);
}



// IOAccelCommandBufferPoolList::addCommandPool(IOAccelCommandBufferPool2*)

void __thiscall
IOAccelCommandBufferPoolList::addCommandPool(IOAccelCommandBufferPoolList *this,long param_1)

{
  *(undefined8 *)(param_1 + 0x18) = *(undefined8 *)this;
  *(long *)this = param_1;
  *(int *)(this + 8) = *(int *)(this + 8) + 1;
  return;
}



// IOAccelCommandBufferPoolList::removeCommandPool(IOAccelCommandBufferPool2*)

void __thiscall
IOAccelCommandBufferPoolList::removeCommandPool(IOAccelCommandBufferPoolList *this,long param_1)

{
  long lVar1;
  IOAccelCommandBufferPoolList *pIVar2;
  long lVar3;
  
  lVar1 = *(long *)this;
  if (lVar1 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Internal error - no ring buffer list\n",
                      "void IOAccelCommandBufferPoolList::removeCommandPool(IOAccelCommandBufferPool2 *)"
                     );
  }
  else {
    pIVar2 = this;
    if (lVar1 != param_1) {
      do {
        lVar3 = lVar1;
        lVar1 = *(long *)(lVar3 + 0x18);
        if (lVar1 == 0) break;
      } while (lVar1 != param_1);
      if (lVar1 == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Internal error - deleting non-existant command pool\n",
                          "void IOAccelCommandBufferPoolList::removeCommandPool(IOAccelCommandBufferPool2 *)"
                         );
        return;
      }
      pIVar2 = (IOAccelCommandBufferPoolList *)(lVar3 + 0x18);
    }
    *(undefined8 *)pIVar2 = *(undefined8 *)(param_1 + 0x18);
    *(int *)(this + 8) = *(int *)(this + 8) + -1;
    *(undefined8 *)(param_1 + 0x18) = 0;
  }
  return;
}



// IOAccelCommandBufferPoolList::Iterator::Iterator(IOAccelCommandBufferPoolList&)

void __thiscall IOAccelCommandBufferPoolList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelCommandBufferPoolList::Iterator::Iterator(IOAccelCommandBufferPoolList&)

void __thiscall IOAccelCommandBufferPoolList::Iterator::Iterator(Iterator *this,undefined8 *param_1)

{
  *(undefined8 *)this = *param_1;
  return;
}



// IOAccelCommandBufferPoolList::Iterator::getNextCommandPool()

void __thiscall IOAccelCommandBufferPoolList::Iterator::getNextCommandPool(Iterator *this)

{
  if (*(long *)this != 0) {
    *(undefined8 *)this = *(undefined8 *)(*(long *)this + 0x18);
  }
  return;
}



// IOAccelBlockFencePort2::MetaClass::MetaClass()

void __thiscall IOAccelBlockFencePort2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelBlockFencePort2",(OSMetaClass *)PTR_gMetaClass_0006b068,
             0x50);
  *(undefined ***)this = &PTR__MetaClass_00075cd8;
  return;
}



// IOAccelBlockFencePort2::MetaClass::~MetaClass()

void __thiscall IOAccelBlockFencePort2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelBlockFencePort2::IOAccelBlockFencePort2(OSMetaClass const*)

void __thiscall
IOAccelBlockFencePort2::IOAccelBlockFencePort2(IOAccelBlockFencePort2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelBlockFencePort2_00075ba0;
  return;
}



// IOAccelBlockFencePort2::IOAccelBlockFencePort2(OSMetaClass const*)

void __thiscall
IOAccelBlockFencePort2::IOAccelBlockFencePort2(IOAccelBlockFencePort2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelBlockFencePort2_00075ba0;
  return;
}



// IOAccelBlockFencePort2::~IOAccelBlockFencePort2()

void __thiscall IOAccelBlockFencePort2::~IOAccelBlockFencePort2(IOAccelBlockFencePort2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelBlockFencePort2::~IOAccelBlockFencePort2()

void __thiscall IOAccelBlockFencePort2::~IOAccelBlockFencePort2(IOAccelBlockFencePort2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelBlockFencePort2::~IOAccelBlockFencePort2()

void __thiscall IOAccelBlockFencePort2::~IOAccelBlockFencePort2(IOAccelBlockFencePort2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelBlockFencePort2_ktv,this,0x50);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelBlockFencePort2::operator delete(void*, unsigned long)

void __cdecl IOAccelBlockFencePort2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelBlockFencePort2_ktv,param_1,param_2);
  return;
}



// IOAccelBlockFencePort2::getMetaClass() const

undefined1 * IOAccelBlockFencePort2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelBlockFencePort2::MetaClass::MetaClass()

void __thiscall IOAccelBlockFencePort2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelBlockFencePort2",(OSMetaClass *)PTR_gMetaClass_0006b068,
             0x50);
  *(undefined ***)this = &PTR__MetaClass_00075cd8;
  return;
}



// IOAccelBlockFencePort2::MetaClass::alloc() const

OSObject * IOAccelBlockFencePort2::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelBlockFencePort2_ktv,0x50);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelBlockFencePort2::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelBlockFencePort2_00075ba0;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelBlockFencePort2::operator new(unsigned long)

void * __thiscall IOAccelBlockFencePort2::operator_new(IOAccelBlockFencePort2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelBlockFencePort2_ktv,this);
  return pvVar1;
}



// IOAccelBlockFencePort2::IOAccelBlockFencePort2()

void __thiscall IOAccelBlockFencePort2::IOAccelBlockFencePort2(IOAccelBlockFencePort2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelBlockFencePort2_00075ba0;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelBlockFencePort2::IOAccelBlockFencePort2()

void __thiscall IOAccelBlockFencePort2::IOAccelBlockFencePort2(IOAccelBlockFencePort2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelBlockFencePort2_00075ba0;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelBlockFencePort2::initWithAsyncRef64(unsigned long long*)

undefined4 __thiscall
IOAccelBlockFencePort2::initWithAsyncRef64(IOAccelBlockFencePort2 *this,undefined8 *param_1)

{
  undefined4 uVar1;
  
  uVar1 = (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  if ((char)uVar1 != '\0') {
    IOUserClient::setAsyncReference64
              ((ulonglong *)(this + 0x10),(ipc_port *)*param_1,param_1[1],param_1[2]);
    this[0xc] = (IOAccelBlockFencePort2)0x1;
  }
  return uVar1;
}



// IOAccelBlockFencePort2::free()

void __thiscall IOAccelBlockFencePort2::free(IOAccelBlockFencePort2 *this)

{
  if (this[0xc] != (IOAccelBlockFencePort2)0x0) {
    IOUserClient::releaseAsyncReference64((ulonglong *)(this + 0x10));
  }
                    // WARNING: Could not recover jumptable at 0x0001e5e4. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelEventFence::MetaClass::MetaClass()

void __thiscall IOAccelEventFence::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelEventFence",(OSMetaClass *)PTR_gMetaClass_0006b068,200);
  *(undefined ***)this = &PTR__MetaClass_00075f10;
  return;
}



// IOAccelEventFence::MetaClass::~MetaClass()

void __thiscall IOAccelEventFence::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelEventFence::IOAccelEventFence(OSMetaClass const*)

void __thiscall IOAccelEventFence::IOAccelEventFence(IOAccelEventFence *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelEventFence_00075dd0;
  return;
}



// IOAccelEventFence::~IOAccelEventFence()

void __thiscall IOAccelEventFence::~IOAccelEventFence(IOAccelEventFence *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelEventFence::~IOAccelEventFence()

void __thiscall IOAccelEventFence::~IOAccelEventFence(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelEventFence::~IOAccelEventFence()

void __thiscall IOAccelEventFence::~IOAccelEventFence(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelEventFence::getMetaClass() const

undefined1 * IOAccelEventFence::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelEventFence::MetaClass::MetaClass()

void __thiscall IOAccelEventFence::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelEventFence",(OSMetaClass *)PTR_gMetaClass_0006b068,200);
  *(undefined ***)this = &PTR__MetaClass_00075f10;
  return;
}



// IOAccelEventFence::MetaClass::alloc() const

undefined8 IOAccelEventFence::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelEventFence::operator new(unsigned long)

void * __thiscall IOAccelEventFence::operator_new(IOAccelEventFence *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelEventFence_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelEventFence::operator delete(void*, unsigned long)

void __cdecl IOAccelEventFence::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelEventFence_ktv,param_1,param_2);
  return;
}



// IOAccelEventFence::init(IOGraphicsAccelerator2*, IOAccelSubmitter2*)

undefined4 __thiscall
IOAccelEventFence::init(IOAccelEventFence *this,long param_1,undefined8 param_2)

{
  undefined4 uVar1;
  
  uVar1 = (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  if ((char)uVar1 != '\0') {
    *(long *)(this + 0x10) = param_1;
    (**(code **)(**(long **)(param_1 + 0x380) + 0x140))(*(long **)(param_1 + 0x380),this + 0x28);
    (**(code **)(**(long **)(*(long *)(this + 0x10) + 0x380) + 0x140))
              (*(long **)(*(long *)(this + 0x10) + 0x380),this + 0x68);
    *(undefined8 *)(this + 0xb8) = param_2;
  }
  return uVar1;
}



// IOAccelEventFence::free()

void IOAccelEventFence::free(void)

{
                    // WARNING: Could not recover jumptable at 0x0001e748. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))();
  return;
}



// IOAccelBlockFence::MetaClass::MetaClass()

void __thiscall IOAccelBlockFence::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelBlockFence",(OSMetaClass *)&IOAccelEventFence::gMetaClass,
             0xe0);
  *(undefined ***)this = &PTR__MetaClass_00076158;
  return;
}



// IOAccelBlockFence::MetaClass::~MetaClass()

void __thiscall IOAccelBlockFence::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelBlockFence::IOAccelBlockFence(OSMetaClass const*)

void __thiscall IOAccelBlockFence::IOAccelBlockFence(IOAccelBlockFence *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelBlockFence_00076008;
  return;
}



// IOAccelBlockFence::IOAccelBlockFence(OSMetaClass const*)

void __thiscall IOAccelBlockFence::IOAccelBlockFence(IOAccelBlockFence *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelBlockFence_00076008;
  return;
}



// IOAccelBlockFence::~IOAccelBlockFence()

void __thiscall IOAccelBlockFence::~IOAccelBlockFence(IOAccelBlockFence *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelBlockFence::~IOAccelBlockFence()

void __thiscall IOAccelBlockFence::~IOAccelBlockFence(IOAccelBlockFence *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelBlockFence::~IOAccelBlockFence()

void __thiscall IOAccelBlockFence::~IOAccelBlockFence(IOAccelBlockFence *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelBlockFence_ktv,this,0xe0);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelBlockFence::operator delete(void*, unsigned long)

void __cdecl IOAccelBlockFence::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelBlockFence_ktv,param_1,param_2);
  return;
}



// IOAccelBlockFence::getMetaClass() const

undefined1 * IOAccelBlockFence::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelBlockFence::MetaClass::MetaClass()

void __thiscall IOAccelBlockFence::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelBlockFence",(OSMetaClass *)&IOAccelEventFence::gMetaClass,
             0xe0);
  *(undefined ***)this = &PTR__MetaClass_00076158;
  return;
}



// IOAccelBlockFence::MetaClass::alloc() const

OSObject * IOAccelBlockFence::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelBlockFence_ktv,0xe0);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelBlockFence::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelBlockFence_00076008;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelBlockFence::operator new(unsigned long)

void * __thiscall IOAccelBlockFence::operator_new(IOAccelBlockFence *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelBlockFence_ktv,this);
  return pvVar1;
}



// IOAccelBlockFence::IOAccelBlockFence()

void __thiscall IOAccelBlockFence::IOAccelBlockFence(IOAccelBlockFence *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelBlockFence_00076008;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelBlockFence::IOAccelBlockFence()

void __thiscall IOAccelBlockFence::IOAccelBlockFence(IOAccelBlockFence *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelBlockFence_00076008;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelBlockFence::init(IOGraphicsAccelerator2*, IOAccelSubmitter2*, IOAccelBlockFencePort2*,
// unsigned long long, unsigned long long)

undefined4 __thiscall
IOAccelBlockFence::init
          (IOAccelBlockFence *this,long param_1,undefined8 param_2,long *param_3,undefined8 param_4,
          undefined8 param_5)

{
  undefined4 uVar1;
  
  uVar1 = IOAccelEventFence::init((IOAccelEventFence *)this,param_1,param_2);
  if ((char)uVar1 != '\0') {
    *(long **)(this + 0xd8) = param_3;
    (**(code **)(*param_3 + 0x20))(param_3);
    *(undefined8 *)(this + 200) = param_4;
    *(undefined8 *)(this + 0xd0) = param_5;
  }
  return uVar1;
}



// IOAccelBlockFence::free()

void __thiscall IOAccelBlockFence::free(IOAccelBlockFence *this)

{
  (**(code **)(**(long **)(this + 0xd8) + 0x28))();
  *(undefined8 *)(this + 0xd8) = 0;
                    // WARNING: Could not recover jumptable at 0x0001e9a3. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelBlockFence::getHostTime(unsigned long long*, unsigned long long*)

void __thiscall
IOAccelBlockFence::getHostTime(IOAccelBlockFence *this,undefined8 *param_1,undefined8 *param_2)

{
  *param_1 = *(undefined8 *)(this + 0x18);
  *param_2 = *(undefined8 *)(this + 0x20);
  return;
}



// IOAccelBlockFence::notifyClient()

void __thiscall IOAccelBlockFence::notifyClient(IOAccelBlockFence *this)

{
  long *plVar1;
  undefined1 *local_68;
  undefined1 *local_60;
  ulonglong local_58;
  undefined8 local_50;
  undefined1 *local_48;
  ulong local_40;
  undefined1 *local_38;
  ulong local_30;
  ulong local_28;
  long local_20;
  
  local_20 = *(long *)PTR____stack_chk_guard_0006b0b0;
  local_60 = &DAT_aaaaaaaaaaaaaaaa;
  local_68 = &DAT_aaaaaaaaaaaaaaaa;
  (**(code **)(*(long *)this + 0x130))(this,&local_60,&local_68);
  if (local_68 == (undefined1 *)0x0) {
    local_60 = *(undefined1 **)(this + 0x18);
    local_68 = *(undefined1 **)(this + 0x20);
  }
  local_58 = *(ulonglong *)(this + 200);
  local_50 = *(undefined8 *)(this + 0xd0);
  local_40 = (ulong)local_60 >> 0x20;
  local_30 = (ulong)local_68 >> 0x20;
  local_28 = (ulong)*(uint *)(this + 0xc0);
  local_48 = local_60;
  local_38 = local_68;
  IOUserClient::sendAsyncResult64((ulonglong *)(*(long *)(this + 0xd8) + 0x10),0,&local_58,7);
  if (*(long *)(this + 0xb8) != 0) {
    plVar1 = *(long **)(*(long *)(this + 0xb8) + 0x560);
    (**(code **)(*plVar1 + 0x158))(plVar1,(long)local_68 - (long)local_60);
  }
  if (*(long *)PTR____stack_chk_guard_0006b0b0 != local_20) {
                    // WARNING: Subroutine does not return
    ___stack_chk_fail();
  }
  return;
}



// IOAccelSharedEventFence::MetaClass::MetaClass()

void __thiscall IOAccelSharedEventFence::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelSharedEventFence",
             (OSMetaClass *)&IOAccelEventFence::gMetaClass,0xd8);
  *(undefined ***)this = &PTR__MetaClass_00076390;
  return;
}



// IOAccelSharedEventFence::MetaClass::~MetaClass()

void __thiscall IOAccelSharedEventFence::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelSharedEventFence::IOAccelSharedEventFence(OSMetaClass const*)

void __thiscall
IOAccelSharedEventFence::IOAccelSharedEventFence(IOAccelSharedEventFence *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelSharedEventFence_00076250;
  return;
}



// IOAccelSharedEventFence::IOAccelSharedEventFence(OSMetaClass const*)

void __thiscall
IOAccelSharedEventFence::IOAccelSharedEventFence(IOAccelSharedEventFence *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelSharedEventFence_00076250;
  return;
}



// IOAccelSharedEventFence::~IOAccelSharedEventFence()

void __thiscall IOAccelSharedEventFence::~IOAccelSharedEventFence(IOAccelSharedEventFence *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelSharedEventFence::~IOAccelSharedEventFence()

void __thiscall IOAccelSharedEventFence::~IOAccelSharedEventFence(IOAccelSharedEventFence *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelSharedEventFence::~IOAccelSharedEventFence()

void __thiscall IOAccelSharedEventFence::~IOAccelSharedEventFence(IOAccelSharedEventFence *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelSharedEventFence_ktv,this,0xd8);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSharedEventFence::operator delete(void*, unsigned long)

void __cdecl IOAccelSharedEventFence::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelSharedEventFence_ktv,param_1,param_2);
  return;
}



// IOAccelSharedEventFence::getMetaClass() const

undefined8 * IOAccelSharedEventFence::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelSharedEventFence::MetaClass::MetaClass()

void __thiscall IOAccelSharedEventFence::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelSharedEventFence",
             (OSMetaClass *)&IOAccelEventFence::gMetaClass,0xd8);
  *(undefined ***)this = &PTR__MetaClass_00076390;
  return;
}



// IOAccelSharedEventFence::MetaClass::alloc() const

OSObject * IOAccelSharedEventFence::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelSharedEventFence_ktv,0xd8);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelSharedEventFence::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelSharedEventFence_00076250;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelSharedEventFence::operator new(unsigned long)

void * __thiscall IOAccelSharedEventFence::operator_new(IOAccelSharedEventFence *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelSharedEventFence_ktv,this);
  return pvVar1;
}



// IOAccelSharedEventFence::IOAccelSharedEventFence()

void __thiscall IOAccelSharedEventFence::IOAccelSharedEventFence(IOAccelSharedEventFence *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelSharedEventFence_00076250;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelSharedEventFence::IOAccelSharedEventFence()

void __thiscall IOAccelSharedEventFence::IOAccelSharedEventFence(IOAccelSharedEventFence *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelSharedEventFence_00076250;
  OSMetaClass::instanceConstructed();
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSharedEventFence::withSharedEvent(IOSurfaceSharedEvent*, unsigned long long,
// IOGraphicsAccelerator2*, IOAccelSubmitter2*)

IOAccelEventFence * __cdecl
IOAccelSharedEventFence::withSharedEvent
          (long *param_1,undefined8 param_2,long param_3,undefined8 param_4)

{
  undefined4 uVar1;
  IOAccelEventFence *this;
  
  this = (IOAccelEventFence *)(**(code **)(gMetaClass + 0x88))(&gMetaClass);
  if (this != (IOAccelEventFence *)0x0) {
    uVar1 = IOAccelEventFence::init(this,param_3,param_4);
    if ((char)uVar1 != '\0') {
      *(long **)(this + 200) = param_1;
      (**(code **)(*param_1 + 0x20))(param_1);
      *(undefined8 *)(this + 0xd0) = param_2;
      return this;
    }
    (**(code **)(*(long *)this + 0x28))(this);
  }
  return (IOAccelEventFence *)0x0;
}



// IOAccelSharedEventFence::initWithSharedEvent(IOSurfaceSharedEvent*, unsigned long long,
// IOGraphicsAccelerator2*, IOAccelSubmitter2*)

undefined4 __thiscall
IOAccelSharedEventFence::initWithSharedEvent
          (IOAccelSharedEventFence *this,long *param_1,undefined8 param_2,long param_3,
          undefined8 param_4)

{
  undefined4 uVar1;
  
  uVar1 = IOAccelEventFence::init((IOAccelEventFence *)this,param_3,param_4);
  if ((char)uVar1 != '\0') {
    *(long **)(this + 200) = param_1;
    (**(code **)(*param_1 + 0x20))(param_1);
    *(undefined8 *)(this + 0xd0) = param_2;
  }
  return uVar1;
}



// IOAccelSharedEventFence::free()

void __thiscall IOAccelSharedEventFence::free(IOAccelSharedEventFence *this)

{
  if (*(long **)(this + 200) != (long *)0x0) {
    (**(code **)(**(long **)(this + 200) + 0x28))();
  }
  *(undefined8 *)(this + 200) = 0;
                    // WARNING: Could not recover jumptable at 0x0001ed7a. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelSharedEventFence::notifyClient()

void __thiscall IOAccelSharedEventFence::notifyClient(IOAccelSharedEventFence *this)

{
  uintptr_t arg1;
  uintptr_t arg2;
  
  arg1 = IORegistryEntry::getRegistryEntryID();
  arg2 = IOSurfaceSharedEvent::getTraceID();
  _kernel_debug(0x850200d0,arg1,arg2,*(uintptr_t *)(this + 0xd0),0,0);
  IOSurfaceSharedEvent::signalCompleted(*(ulonglong *)(this + 200));
  return;
}



// IOAccelExternalEventFence::MetaClass::MetaClass()

void __thiscall IOAccelExternalEventFence::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelExternalEventFence",
             (OSMetaClass *)&IOAccelEventFence::gMetaClass,0xd0);
  *(undefined ***)this = &PTR__MetaClass_000765c8;
  return;
}



// IOAccelExternalEventFence::MetaClass::~MetaClass()

void __thiscall IOAccelExternalEventFence::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelExternalEventFence::IOAccelExternalEventFence(OSMetaClass const*)

void __thiscall
IOAccelExternalEventFence::IOAccelExternalEventFence
          (IOAccelExternalEventFence *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelExternalEventFence_00076488;
  return;
}



// IOAccelExternalEventFence::IOAccelExternalEventFence(OSMetaClass const*)

void __thiscall
IOAccelExternalEventFence::IOAccelExternalEventFence
          (IOAccelExternalEventFence *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelExternalEventFence_00076488;
  return;
}



// IOAccelExternalEventFence::~IOAccelExternalEventFence()

void __thiscall
IOAccelExternalEventFence::~IOAccelExternalEventFence(IOAccelExternalEventFence *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelExternalEventFence::~IOAccelExternalEventFence()

void __thiscall
IOAccelExternalEventFence::~IOAccelExternalEventFence(IOAccelExternalEventFence *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelExternalEventFence::~IOAccelExternalEventFence()

void __thiscall
IOAccelExternalEventFence::~IOAccelExternalEventFence(IOAccelExternalEventFence *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelExternalEventFence_ktv,this,0xd0);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelExternalEventFence::operator delete(void*, unsigned long)

void __cdecl IOAccelExternalEventFence::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelExternalEventFence_ktv,param_1,param_2);
  return;
}



// IOAccelExternalEventFence::getMetaClass() const

undefined8 * IOAccelExternalEventFence::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelExternalEventFence::MetaClass::MetaClass()

void __thiscall IOAccelExternalEventFence::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelExternalEventFence",
             (OSMetaClass *)&IOAccelEventFence::gMetaClass,0xd0);
  *(undefined ***)this = &PTR__MetaClass_000765c8;
  return;
}



// IOAccelExternalEventFence::MetaClass::alloc() const

OSObject * IOAccelExternalEventFence::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelExternalEventFence_ktv,0xd0);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelExternalEventFence::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelExternalEventFence_00076488;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelExternalEventFence::operator new(unsigned long)

void * __thiscall IOAccelExternalEventFence::operator_new(IOAccelExternalEventFence *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelExternalEventFence_ktv,this);
  return pvVar1;
}



// IOAccelExternalEventFence::IOAccelExternalEventFence()

void __thiscall
IOAccelExternalEventFence::IOAccelExternalEventFence(IOAccelExternalEventFence *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelExternalEventFence_00076488;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelExternalEventFence::IOAccelExternalEventFence()

void __thiscall
IOAccelExternalEventFence::IOAccelExternalEventFence(IOAccelExternalEventFence *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelExternalEventFence_00076488;
  OSMetaClass::instanceConstructed();
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelExternalEventFence::withExternalEvent(IOAccelExternalEvent*, IOGraphicsAccelerator2*)

IOAccelEventFence * __cdecl
IOAccelExternalEventFence::withExternalEvent(IOAccelEventFence *param_1,long param_2)

{
  undefined4 uVar1;
  IOAccelEventFence *this;
  long lVar2;
  IOAccelEventFence *pIVar3;
  
  this = (IOAccelEventFence *)(**(code **)(gMetaClass + 0x88))(&gMetaClass);
  if (this == (IOAccelEventFence *)0x0) {
    pIVar3 = (IOAccelEventFence *)0x0;
  }
  else {
    uVar1 = IOAccelEventFence::init(this,param_2,0);
    lVar2 = 5;
    if ((char)uVar1 == '\0') {
      pIVar3 = (IOAccelEventFence *)0x0;
    }
    else {
      *(IOAccelEventFence **)(this + 200) = param_1;
      lVar2 = 4;
      pIVar3 = this;
      this = param_1;
    }
    (**(code **)(*(long *)this + lVar2 * 8))(this);
  }
  return pIVar3;
}



// IOAccelExternalEventFence::initWithExternalEvent(IOAccelExternalEvent*, IOGraphicsAccelerator2*)

undefined4 __thiscall
IOAccelExternalEventFence::initWithExternalEvent
          (IOAccelExternalEventFence *this,long *param_1,long param_2)

{
  undefined4 uVar1;
  
  uVar1 = IOAccelEventFence::init((IOAccelEventFence *)this,param_2,0);
  if ((char)uVar1 != '\0') {
    *(long **)(this + 200) = param_1;
    (**(code **)(*param_1 + 0x20))(param_1);
  }
  return uVar1;
}



// IOAccelExternalEventFence::free()

void __thiscall IOAccelExternalEventFence::free(IOAccelExternalEventFence *this)

{
  if (*(long **)(this + 200) != (long *)0x0) {
    (**(code **)(**(long **)(this + 200) + 0x28))();
  }
  *(undefined8 *)(this + 200) = 0;
                    // WARNING: Could not recover jumptable at 0x0001f088. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelExternalEventFence::notifyClient()

void __thiscall IOAccelExternalEventFence::notifyClient(IOAccelExternalEventFence *this)

{
  IOAccelExternalEvent::decrement(*(IOAccelExternalEvent **)(this + 200));
  return;
}



// IOAccelContextEventFence::MetaClass::MetaClass()

void __thiscall IOAccelContextEventFence::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelContextEventFence",
             (OSMetaClass *)&IOAccelEventFence::gMetaClass,200);
  *(undefined ***)this = &PTR__MetaClass_00076800;
  return;
}



// IOAccelContextEventFence::MetaClass::~MetaClass()

void __thiscall IOAccelContextEventFence::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelContextEventFence::IOAccelContextEventFence(OSMetaClass const*)

void __thiscall
IOAccelContextEventFence::IOAccelContextEventFence
          (IOAccelContextEventFence *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelContextEventFence_000766c0;
  return;
}



// IOAccelContextEventFence::IOAccelContextEventFence(OSMetaClass const*)

void __thiscall
IOAccelContextEventFence::IOAccelContextEventFence
          (IOAccelContextEventFence *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelContextEventFence_000766c0;
  return;
}



// IOAccelContextEventFence::~IOAccelContextEventFence()

void __thiscall IOAccelContextEventFence::~IOAccelContextEventFence(IOAccelContextEventFence *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelContextEventFence::~IOAccelContextEventFence()

void __thiscall IOAccelContextEventFence::~IOAccelContextEventFence(IOAccelContextEventFence *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelContextEventFence::~IOAccelContextEventFence()

void __thiscall IOAccelContextEventFence::~IOAccelContextEventFence(IOAccelContextEventFence *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelContextEventFence_ktv,this,200);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelContextEventFence::operator delete(void*, unsigned long)

void __cdecl IOAccelContextEventFence::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelContextEventFence_ktv,param_1,param_2);
  return;
}



// IOAccelContextEventFence::getMetaClass() const

undefined1 * IOAccelContextEventFence::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelContextEventFence::MetaClass::MetaClass()

void __thiscall IOAccelContextEventFence::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelContextEventFence",
             (OSMetaClass *)&IOAccelEventFence::gMetaClass,200);
  *(undefined ***)this = &PTR__MetaClass_00076800;
  return;
}



// IOAccelContextEventFence::MetaClass::alloc() const

OSObject * IOAccelContextEventFence::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelContextEventFence_ktv,200);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelContextEventFence::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelContextEventFence_000766c0;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelContextEventFence::operator new(unsigned long)

void * __thiscall IOAccelContextEventFence::operator_new(IOAccelContextEventFence *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelContextEventFence_ktv,this);
  return pvVar1;
}



// IOAccelContextEventFence::IOAccelContextEventFence()

void __thiscall IOAccelContextEventFence::IOAccelContextEventFence(IOAccelContextEventFence *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelContextEventFence_000766c0;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelContextEventFence::IOAccelContextEventFence()

void __thiscall IOAccelContextEventFence::IOAccelContextEventFence(IOAccelContextEventFence *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelContextEventFence_000766c0;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelContextEventFence::notifyClient()

void __thiscall IOAccelContextEventFence::notifyClient(IOAccelContextEventFence *this)

{
  long *plVar1;
  
  if (*(long *)(this + 0xb8) != 0) {
    plVar1 = *(long **)(*(long *)(this + 0xb8) + 0x560);
                    // WARNING: Could not recover jumptable at 0x0001f296. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*plVar1 + 0x158))(plVar1,*(long *)(this + 0x20) - *(long *)(this + 0x18));
    return;
  }
  return;
}



// IOAccelFenceMachine::MetaClass::MetaClass()

void __thiscall IOAccelFenceMachine::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelFenceMachine",(OSMetaClass *)PTR_gMetaClass_0006b068,0x90);
  *(undefined ***)this = &PTR__MetaClass_00076a28;
  return;
}



// IOAccelFenceMachine::MetaClass::~MetaClass()

void __thiscall IOAccelFenceMachine::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelFenceMachine::IOAccelFenceMachine(OSMetaClass const*)

void __thiscall
IOAccelFenceMachine::IOAccelFenceMachine(IOAccelFenceMachine *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelFenceMachine_000768f8;
  return;
}



// IOAccelFenceMachine::IOAccelFenceMachine(OSMetaClass const*)

void __thiscall
IOAccelFenceMachine::IOAccelFenceMachine(IOAccelFenceMachine *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelFenceMachine_000768f8;
  return;
}



// IOAccelFenceMachine::~IOAccelFenceMachine()

void __thiscall IOAccelFenceMachine::~IOAccelFenceMachine(IOAccelFenceMachine *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelFenceMachine::~IOAccelFenceMachine()

void __thiscall IOAccelFenceMachine::~IOAccelFenceMachine(IOAccelFenceMachine *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelFenceMachine::~IOAccelFenceMachine()

void __thiscall IOAccelFenceMachine::~IOAccelFenceMachine(IOAccelFenceMachine *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelFenceMachine_ktv,this,0x90);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelFenceMachine::operator delete(void*, unsigned long)

void __cdecl IOAccelFenceMachine::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelFenceMachine_ktv,param_1,param_2);
  return;
}



// IOAccelFenceMachine::getMetaClass() const

undefined1 * IOAccelFenceMachine::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelFenceMachine::MetaClass::MetaClass()

void __thiscall IOAccelFenceMachine::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelFenceMachine",(OSMetaClass *)PTR_gMetaClass_0006b068,0x90);
  *(undefined ***)this = &PTR__MetaClass_00076a28;
  return;
}



// IOAccelFenceMachine::MetaClass::alloc() const

OSObject * IOAccelFenceMachine::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelFenceMachine_ktv,0x90);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelFenceMachine::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelFenceMachine_000768f8;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelFenceMachine::operator new(unsigned long)

void * __thiscall IOAccelFenceMachine::operator_new(IOAccelFenceMachine *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelFenceMachine_ktv,this);
  return pvVar1;
}



// IOAccelFenceMachine::IOAccelFenceMachine()

void __thiscall IOAccelFenceMachine::IOAccelFenceMachine(IOAccelFenceMachine *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelFenceMachine_000768f8;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelFenceMachine::IOAccelFenceMachine()

void __thiscall IOAccelFenceMachine::IOAccelFenceMachine(IOAccelFenceMachine *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelFenceMachine_000768f8;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelFenceMachine::init(IOGraphicsAccelerator2*)

ulong __thiscall IOAccelFenceMachine::init(IOAccelFenceMachine *this,long param_1)

{
  char cVar1;
  long lVar2;
  ulong uVar3;
  
  cVar1 = (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  if (cVar1 == '\0') {
    uVar3 = 0;
  }
  else {
    *(long *)(this + 0x10) = param_1;
    *(undefined8 *)(this + 0x18) = *(undefined8 *)(param_1 + 0x380);
    *(undefined8 *)(this + 0x40) = 0;
    *(IOAccelFenceMachine **)(this + 0x48) = this + 0x40;
    *(undefined8 *)(this + 0x50) = 0;
    *(IOAccelFenceMachine **)(this + 0x58) = this + 0x50;
    *(undefined8 *)(this + 0x60) = 0;
    *(IOAccelFenceMachine **)(this + 0x68) = this + 0x60;
    *(undefined8 *)(this + 0x70) = 0;
    *(IOAccelFenceMachine **)(this + 0x78) = this + 0x70;
    *(undefined4 *)(this + 0x80) = 0;
    lVar2 = IOWorkLoop::workLoop();
    *(long *)(this + 0x20) = lVar2;
    if (lVar2 == 0) {
      uVar3 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: workloop alloc fail\n",
                        "bool IOAccelFenceMachine::init(IOGraphicsAccelerator2 *)");
    }
    else {
      lVar2 = _IOLockAlloc();
      *(long *)(this + 0x28) = lVar2;
      if (lVar2 == 0) {
        uVar3 = 0;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: fFenceLock alloc fail\n",
                          "bool IOAccelFenceMachine::init(IOGraphicsAccelerator2 *)");
      }
      else {
        lVar2 = IOInterruptEventSource::interruptEventSource
                          ((OSObject *)this,eventfence_notifier,(IOService *)0x0,0);
        *(long *)(this + 0x30) = lVar2;
        if (lVar2 == 0) {
          uVar3 = 0;
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: Failed to create block fence notification interrupt!\n",
                            "bool IOAccelFenceMachine::init(IOGraphicsAccelerator2 *)");
        }
        else {
          (**(code **)(**(long **)(this + 0x20) + 0x140))(*(long **)(this + 0x20),lVar2);
          (**(code **)(**(long **)(this + 0x30) + 0x150))();
          lVar2 = IOTimerEventSource::timerEventSource((OSObject *)this,fence_timeout);
          *(long *)(this + 0x38) = lVar2;
          if (lVar2 == 0) {
            uVar3 = 0;
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                              "%s: Failed to create block fence notification timeout!\n",
                              "bool IOAccelFenceMachine::init(IOGraphicsAccelerator2 *)");
          }
          else {
            (**(code **)(**(long **)(this + 0x20) + 0x140))(*(long **)(this + 0x20),lVar2);
            (**(code **)(**(long **)(this + 0x38) + 0x150))();
            *(undefined4 *)(this + 0x84) = 100;
            uVar3 = CONCAT71((int7)((ulong)this >> 8),1);
          }
        }
      }
    }
  }
  return uVar3 & 0xffffffff;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelFenceMachine::eventfence_notifier(IOInterruptEventSource*, int)

void __cdecl IOAccelFenceMachine::eventfence_notifier(IOAccelFenceMachine *param_1)

{
  long lVar1;
  long lVar2;
  long lVar3;
  ulong uVar4;
  ulong uVar5;
  long *plVar6;
  char *pcVar7;
  byte bVar8;
  
  _IOLockLock(*(undefined8 *)(param_1 + 0x28));
  if (*(int *)(param_1 + 0x80) != 0) {
    (**(code **)(**(long **)(param_1 + 0x38) + 0x218))();
    bVar8 = 0;
    lVar3 = *(long *)(param_1 + 0x40);
    while (lVar3 != 0) {
      lVar1 = *(long *)(lVar3 + 0x538);
      uVar4 = process_eventfences(param_1,(long *)(lVar3 + 0x528),'\0');
      if (*(long *)(lVar3 + 0x528) == 0) {
        lVar2 = *(long *)(lVar3 + 0x538);
        if (lVar2 == 0) {
          plVar6 = *(long **)(lVar3 + 0x540);
          if (*plVar6 != lVar3) {
LAB_0001f78e:
            pcVar7 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_0001f79e:
                    // WARNING: Subroutine does not return
            _panic(pcVar7,lVar3,0x308,"IOAccelBlockFence.cpp",0x308);
          }
          *(long **)(param_1 + 0x48) = plVar6;
        }
        else {
          if (*(long **)(lVar2 + 0x540) != (long *)(lVar3 + 0x538)) {
            pcVar7 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
            goto LAB_0001f79e;
          }
          if (**(long **)(lVar3 + 0x540) != lVar3) goto LAB_0001f78e;
          *(long **)(lVar2 + 0x540) = *(long **)(lVar3 + 0x540);
          plVar6 = *(long **)(lVar3 + 0x540);
        }
        *plVar6 = lVar2;
      }
      bVar8 = bVar8 | (byte)uVar4;
      lVar3 = lVar1;
    }
    uVar4 = process_eventfences(param_1,(long *)(param_1 + 0x50),'\0');
    uVar5 = process_eventfences(param_1,(long *)(param_1 + 0x70),'\x01');
    if (*(int *)(param_1 + 0x80) != 0) {
      (**(code **)(**(long **)(param_1 + 0x38) + 0x1d0))
                (*(long **)(param_1 + 0x38),*(undefined4 *)(param_1 + 0x84));
    }
    if ((((byte)uVar5 | (byte)uVar4 | bVar8) & 1) != 0) {
      if (*(int *)(param_1 + 0x88) != 0) {
        _IOLockWakeup_darwin14(*(undefined8 *)(param_1 + 0x28),param_1,0);
      }
      _IOLockUnlock(*(undefined8 *)(param_1 + 0x28));
      IOGraphicsAccelerator2::kickFenceCollector(*(IOGraphicsAccelerator2 **)(param_1 + 0x10));
      return;
    }
  }
  _IOLockUnlock(*(undefined8 *)(param_1 + 0x28));
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelFenceMachine::fence_timeout(IOTimerEventSource*)

void __cdecl IOAccelFenceMachine::fence_timeout(long param_1)

{
                    // WARNING: Could not recover jumptable at 0x0001f7d3. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(param_1 + 0x30) + 0x1d8))(*(long **)(param_1 + 0x30),0,0,0);
  return;
}



// IOAccelFenceMachine::free()

void __thiscall IOAccelFenceMachine::free(IOAccelFenceMachine *this)

{
  long *plVar1;
  long *plVar2;
  long *plVar3;
  long *plVar4;
  undefined8 *puVar5;
  undefined8 uVar6;
  long *plVar7;
  char *pcVar8;
  undefined8 uVar9;
  
  plVar1 = *(long **)(this + 0x40);
  while (plVar7 = plVar1, plVar7 != (long *)0x0) {
    plVar1 = (long *)plVar7[0xa7];
    if (plVar1 == (long *)0x0) {
      plVar3 = (long *)plVar7[0xa8];
      if ((long *)*plVar3 != plVar7) {
LAB_0001f9e2:
        pcVar8 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
        goto LAB_0001fa0d;
      }
      *(long **)(this + 0x48) = plVar3;
    }
    else {
      if ((long *)plVar1[0xa8] != plVar7 + 0xa7) {
        pcVar8 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
LAB_0001fa0d:
        uVar6 = 0x1bd;
        uVar9 = 0x1bd;
        goto LAB_0001f9d2;
      }
      if (*(long **)plVar7[0xa8] != plVar7) goto LAB_0001f9e2;
      plVar1[0xa8] = (long)plVar7[0xa8];
      plVar3 = (long *)plVar7[0xa8];
    }
    *plVar3 = (long)plVar1;
    plVar3 = (long *)plVar7[0xa5];
    while (plVar3 != (long *)0x0) {
      plVar2 = (long *)plVar3[0x15];
      if (plVar2 == (long *)0x0) {
        plVar4 = (long *)plVar3[0x16];
        if ((long *)*plVar4 != plVar3) {
LAB_0001f9b0:
          pcVar8 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
          goto LAB_0001f9c0;
        }
        plVar7[0xa6] = (long)plVar4;
      }
      else {
        if ((long *)plVar2[0x16] != plVar3 + 0x15) {
          pcVar8 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
LAB_0001f9c0:
          uVar6 = 0x1c1;
          uVar9 = 0x1c1;
          plVar7 = plVar3;
          goto LAB_0001f9d2;
        }
        if (*(long **)plVar3[0x16] != plVar3) goto LAB_0001f9b0;
        plVar2[0x16] = (long)plVar3[0x16];
        plVar4 = (long *)plVar3[0x16];
      }
      *plVar4 = (long)plVar2;
      (**(code **)(*plVar3 + 0x28))(plVar3);
      *(int *)(this + 0x80) = *(int *)(this + 0x80) + -1;
      plVar3 = plVar2;
    }
  }
  plVar7 = *(long **)(this + 0x50);
  do {
    if (plVar7 == (long *)0x0) {
      if (*(_func_int **)(this + 0x20) != (_func_int *)0x0) {
        IOWorkLoop::runActionBlock(*(_func_int **)(this + 0x20));
        (**(code **)(**(long **)(this + 0x20) + 0x28))();
        *(undefined8 *)(this + 0x20) = 0;
      }
      _IOLockFree(*(undefined8 *)(this + 0x28));
      return;
    }
    plVar1 = (long *)plVar7[0x15];
    if (plVar1 == (long *)0x0) {
      puVar5 = (undefined8 *)plVar7[0x16];
      if ((long *)*puVar5 != plVar7) {
LAB_0001f9d9:
        pcVar8 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_0001f9f2:
        uVar6 = 0x1cd;
        uVar9 = 0x1cd;
LAB_0001f9d2:
                    // WARNING: Subroutine does not return
        _panic(pcVar8,plVar7,uVar6,"IOAccelBlockFence.cpp",uVar9);
      }
      *(undefined8 **)(this + 0x58) = puVar5;
    }
    else {
      if ((long *)plVar1[0x16] != plVar7 + 0x15) {
        pcVar8 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
        goto LAB_0001f9f2;
      }
      if (*(long **)plVar7[0x16] != plVar7) goto LAB_0001f9d9;
      plVar1[0x16] = (long)plVar7[0x16];
      puVar5 = (undefined8 *)plVar7[0x16];
    }
    *puVar5 = plVar1;
    (**(code **)(*plVar7 + 0x28))(plVar7);
    *(int *)(this + 0x80) = *(int *)(this + 0x80) + -1;
    plVar7 = plVar1;
  } while( true );
}



undefined8 ____ZN19IOAccelFenceMachine4freeEv_block_invoke(long param_1)

{
  long lVar1;
  
  lVar1 = *(long *)(param_1 + 0x20);
  if (*(long **)(lVar1 + 0x30) != (long *)0x0) {
    (**(code **)(**(long **)(lVar1 + 0x30) + 0x158))();
    (**(code **)(**(long **)(lVar1 + 0x20) + 0x148))
              (*(long **)(lVar1 + 0x20),*(undefined8 *)(lVar1 + 0x30));
    (**(code **)(**(long **)(lVar1 + 0x30) + 0x28))();
    *(undefined8 *)(lVar1 + 0x30) = 0;
  }
  if (*(long **)(lVar1 + 0x38) != (long *)0x0) {
    (**(code **)(**(long **)(lVar1 + 0x38) + 0x158))();
    (**(code **)(**(long **)(lVar1 + 0x38) + 0x218))();
    (**(code **)(**(long **)(lVar1 + 0x20) + 0x148))
              (*(long **)(lVar1 + 0x20),*(undefined8 *)(lVar1 + 0x38));
    (**(code **)(**(long **)(lVar1 + 0x38) + 0x28))();
    *(undefined8 *)(lVar1 + 0x38) = 0;
  }
  return 0;
}



// IOAccelFenceMachine::addEventFence(IOAccelSubmitter2*, IOAccelEventFence*)

void __thiscall
IOAccelFenceMachine::addEventFence(IOAccelFenceMachine *this,long param_1,long param_2)

{
  int iVar1;
  long *plVar2;
  char cVar3;
  uint64_t uVar4;
  
  _IOLockLock(*(undefined8 *)(this + 0x28));
  if (param_1 == 0) {
    *(undefined8 *)(param_2 + 0xa8) = 0;
    plVar2 = *(long **)(this + 0x78);
    *(long **)(param_2 + 0xb0) = plVar2;
    *plVar2 = param_2;
    *(long *)(this + 0x78) = param_2 + 0xa8;
  }
  else {
    if (*(long *)(param_1 + 0x528) == 0) {
      *(undefined8 *)(param_1 + 0x538) = 0;
      plVar2 = *(long **)(this + 0x48);
      *(long **)(param_1 + 0x540) = plVar2;
      *plVar2 = param_1;
      *(long *)(this + 0x48) = param_1 + 0x538;
    }
    *(undefined8 *)(param_2 + 0xa8) = 0;
    plVar2 = *(long **)(param_1 + 0x530);
    *(long **)(param_2 + 0xb0) = plVar2;
    *plVar2 = param_2;
    *(long *)(param_1 + 0x530) = param_2 + 0xa8;
  }
  iVar1 = *(int *)(this + 0x80);
  *(int *)(this + 0x80) = iVar1 + 1;
  if (iVar1 == 0) {
    (**(code **)(**(long **)(this + 0x38) + 0x1d0))
              (*(long **)(this + 0x38),*(undefined4 *)(this + 0x84));
  }
  _IOLockUnlock(*(undefined8 *)(this + 0x28));
  cVar3 = (**(code **)(**(long **)(this + 0x18) + 0x180))(*(long **)(this + 0x18),param_2 + 0x28);
  if (cVar3 == '\0') {
    uVar4 = 0;
  }
  else {
    uVar4 = _mach_absolute_time();
  }
  *(uint64_t *)(param_2 + 0x18) = uVar4;
  cVar3 = (**(code **)(**(long **)(this + 0x18) + 0x180))(*(long **)(this + 0x18),param_2 + 0x68);
  if (cVar3 != '\0') {
                    // WARNING: Could not recover jumptable at 0x0001fbd4. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0x30) + 0x1d8))(*(long **)(this + 0x30),0,0,0);
    return;
  }
  return;
}



// IOAccelFenceMachine::has_event_signal(IOAccelSubmitter2*, IOSurfaceSharedEvent*)

undefined8 __thiscall
IOAccelFenceMachine::has_event_signal(undefined8 param_1_00,long param_2,long param_3)

{
  OSMetaClassBase *pOVar1;
  long lVar2;
  
  pOVar1 = *(OSMetaClassBase **)(param_2 + 0x528);
  while( true ) {
    if (pOVar1 == (OSMetaClassBase *)0x0) {
      return 0;
    }
    lVar2 = OSMetaClassBase::safeMetaCast
                      (pOVar1,(OSMetaClass *)&IOAccelSharedEventFence::gMetaClass);
    if (((lVar2 != 0) && (*(long *)(lVar2 + 0xb8) != 0)) && (*(long *)(lVar2 + 200) == param_3))
    break;
    pOVar1 = *(OSMetaClassBase **)(pOVar1 + 0xa8);
  }
  return CONCAT71((int7)((ulong)lVar2 >> 8),1);
}



// IOAccelFenceMachine::hasEventSignal(IOAccelSubmitter2*, IOSurfaceSharedEvent*)

ulong __thiscall
IOAccelFenceMachine::hasEventSignal(IOAccelFenceMachine *this,long param_1,long param_2)

{
  ulong uVar1;
  undefined8 uVar2;
  
  uVar2 = *(undefined8 *)(this + 0x28);
  _IOLockLock();
  uVar1 = has_event_signal(uVar2,param_1,param_2);
  _IOLockUnlock(*(undefined8 *)(this + 0x28));
  return uVar1 & 0xffffffff;
}



// IOAccelFenceMachine::waitEventSignal(IOAccelSubmitter2*, IOSurfaceSharedEvent*)

ulong __thiscall
IOAccelFenceMachine::waitEventSignal(IOAccelFenceMachine *this,long param_1,long param_2)

{
  int iVar1;
  ulong uVar2;
  undefined8 uVar3;
  
  _clock_interval_to_deadline(5,1000000000);
  uVar3 = *(undefined8 *)(this + 0x28);
  _IOLockLock();
  do {
    uVar2 = has_event_signal(uVar3,param_1,param_2);
    if ((char)uVar2 == '\0') break;
    *(int *)(this + 0x88) = *(int *)(this + 0x88) + 1;
    uVar3 = *(undefined8 *)(this + 0x28);
    iVar1 = _IOLockSleepDeadline_darwin14(uVar3,this,&DAT_aaaaaaaaaaaaaaaa,0);
    *(int *)(this + 0x88) = *(int *)(this + 0x88) + -1;
  } while (iVar1 != 1);
  _IOLockUnlock(*(undefined8 *)(this + 0x28));
  return uVar2 & 0xffffffff ^ 1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelFenceMachine::notify_fences()

void __cdecl IOAccelFenceMachine::notify_fences(IOAccelFenceMachine *param_1)

{
  eventfence_notifier(param_1);
  return;
}



// IOAccelFenceMachine::process_eventfences(EventFencesListHead*, bool)

ulong __thiscall
IOAccelFenceMachine::process_eventfences(IOAccelFenceMachine *this,long *param_1,char param_2)

{
  long *plVar1;
  long *plVar2;
  long lVar3;
  undefined8 *puVar4;
  char cVar5;
  uint64_t uVar6;
  long *plVar7;
  long *plVar8;
  char *pcVar9;
  ulong uVar10;
  
  if ((long *)*param_1 == (long *)0x0) {
    uVar10 = 0;
  }
  else {
    uVar10 = 0;
    plVar8 = (long *)*param_1;
    do {
      plVar2 = (long *)plVar8[0x15];
      if ((plVar8[3] == 0) &&
         (cVar5 = (**(code **)(**(long **)(this + 0x18) + 0x180))
                            (*(long **)(this + 0x18),plVar8 + 5), cVar5 != '\0')) {
        uVar6 = _mach_absolute_time();
        plVar8[3] = uVar6;
      }
      cVar5 = (**(code **)(**(long **)(this + 0x18) + 0x180))(*(long **)(this + 0x18),plVar8 + 0xd);
      if (cVar5 == '\0') {
        if (param_2 == '\0') break;
      }
      else {
        plVar1 = plVar8 + 0x15;
        uVar6 = _mach_absolute_time();
        plVar8[4] = uVar6;
        lVar3 = plVar8[0x15];
        if (lVar3 == 0) {
          plVar7 = (long *)plVar8[0x16];
          if ((long *)*plVar7 != plVar8) {
LAB_0001fe78:
            pcVar9 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_0001fe88:
                    // WARNING: Subroutine does not return
            _panic(pcVar9,plVar8,0x2d1,"IOAccelBlockFence.cpp",0x2d1);
          }
          param_1[1] = (long)plVar7;
        }
        else {
          if (*(long **)(lVar3 + 0xb0) != plVar1) {
            pcVar9 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
            goto LAB_0001fe88;
          }
          if (*(long **)plVar8[0x16] != plVar8) goto LAB_0001fe78;
          *(long **)(lVar3 + 0xb0) = (long *)plVar8[0x16];
          plVar7 = (long *)plVar8[0x16];
        }
        *plVar7 = lVar3;
        plVar8[0x15] = 0;
        puVar4 = *(undefined8 **)(this + 0x68);
        plVar8[0x16] = (long)puVar4;
        *puVar4 = plVar8;
        *(long **)(this + 0x68) = plVar1;
        *(int *)(this + 0x80) = *(int *)(this + 0x80) + -1;
        plVar7 = (long *)plVar8[0x17];
        if (plVar7 != (long *)0x0) {
          (**(code **)(*plVar7 + 0x980))(plVar7,plVar8);
        }
        (**(code **)(*plVar8 + 0x120))(plVar8);
        plVar8[0x17] = 0;
        uVar10 = CONCAT71((int7)((ulong)plVar1 >> 8),1);
      }
      plVar8 = plVar2;
    } while (plVar2 != (long *)0x0);
  }
  return uVar10 & 0xffffff01;
}



// IOAccelFenceMachine::getCompletedEventFences(EventFencesListHead*)

void __thiscall IOAccelFenceMachine::getCompletedEventFences(IOAccelFenceMachine *this,long param_1)

{
  _IOLockLock(*(undefined8 *)(this + 0x28));
  if (*(long *)(this + 0x60) != 0) {
    **(long **)(param_1 + 8) = *(long *)(this + 0x60);
    *(undefined8 *)(*(long *)(this + 0x60) + 0xb0) = *(undefined8 *)(param_1 + 8);
    *(undefined8 *)(param_1 + 8) = *(undefined8 *)(this + 0x68);
    *(undefined8 *)(this + 0x60) = 0;
    *(IOAccelFenceMachine **)(this + 0x68) = this + 0x60;
  }
  _IOLockUnlock(*(undefined8 *)(this + 0x28));
  return;
}



// IOAccelFenceMachine::cancelBlockFenceCallback(IOAccelSubmitter2*)

void __thiscall
IOAccelFenceMachine::cancelBlockFenceCallback(IOAccelFenceMachine *this,long param_1)

{
  long lVar1;
  long lVar2;
  long *plVar3;
  char *pcVar4;
  
  _IOLockLock(*(undefined8 *)(this + 0x28));
  lVar2 = *(long *)(param_1 + 0x528);
  if (lVar2 == 0) goto LAB_0001ffd3;
  lVar1 = *(long *)(param_1 + 0x538);
  if (lVar1 == 0) {
    plVar3 = *(long **)(param_1 + 0x540);
    if (*plVar3 != param_1) {
LAB_0001ffe0:
      pcVar4 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_0001fff0:
                    // WARNING: Subroutine does not return
      _panic(pcVar4,param_1,0x332,"IOAccelBlockFence.cpp",0x332);
    }
    *(long **)(this + 0x48) = plVar3;
  }
  else {
    if (*(long *)(lVar1 + 0x540) != param_1 + 0x538) {
      pcVar4 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
      goto LAB_0001fff0;
    }
    if (**(long **)(param_1 + 0x540) != param_1) goto LAB_0001ffe0;
    *(long **)(lVar1 + 0x540) = *(long **)(param_1 + 0x540);
    plVar3 = *(long **)(param_1 + 0x540);
  }
  *plVar3 = lVar1;
  lVar1 = *(long *)(param_1 + 0x528);
  if (lVar1 != 0) {
    **(long **)(this + 0x58) = lVar1;
    *(undefined8 *)(*(long *)(param_1 + 0x528) + 0xb0) = *(undefined8 *)(this + 0x58);
    *(undefined8 *)(this + 0x58) = *(undefined8 *)(param_1 + 0x530);
    *(undefined8 *)(param_1 + 0x528) = 0;
    *(long **)(param_1 + 0x530) = (long *)(param_1 + 0x528);
  }
  do {
    *(undefined8 *)(lVar2 + 0xb8) = 0;
    lVar2 = *(long *)(lVar2 + 0xa8);
  } while (lVar2 != 0);
LAB_0001ffd3:
  _IOLockUnlock(*(undefined8 *)(this + 0x28));
  return;
}



// IOAccelFenceMachine::sendBlockFenceNotification(unsigned long long*, unsigned long long, unsigned
// long long, unsigned int, unsigned long long, unsigned long long)

void __thiscall
IOAccelFenceMachine::sendBlockFenceNotification
          (undefined8 param_1_00,ulonglong *param_2,ulonglong param_3,undefined8 param_4,
          uint param_5,ulong param_6,ulong param_7)

{
  ulonglong local_48;
  undefined8 local_40;
  ulong local_38;
  ulong local_30;
  ulong local_28;
  ulong local_20;
  ulong local_18;
  long local_10;
  
  local_10 = *(long *)PTR____stack_chk_guard_0006b0b0;
  local_30 = param_6 >> 0x20;
  local_28 = param_7;
  local_20 = param_7 >> 0x20;
  local_18 = (ulong)param_5;
  local_48 = param_3;
  local_40 = param_4;
  local_38 = param_6;
  IOUserClient::sendAsyncResult64(param_2,0,&local_48,7);
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_10) {
    return;
  }
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// IOAccelFenceMachine::guiltyForHardwareReset(IOAccelCommandQueue*, unsigned int)

void __thiscall
IOAccelFenceMachine::guiltyForHardwareReset
          (IOAccelFenceMachine *this,long param_1,undefined4 param_2)

{
  char cVar1;
  long lVar2;
  
  _IOLockLock(*(undefined8 *)(this + 0x28));
  lVar2 = *(long *)(param_1 + 0x528);
  do {
    if (lVar2 == 0) {
LAB_000200d2:
      _IOLockUnlock(*(undefined8 *)(this + 0x28));
      return;
    }
    cVar1 = (**(code **)(**(long **)(*(long *)(this + 0x10) + 0x380) + 400))
                      (*(long **)(*(long *)(this + 0x10) + 0x380),lVar2 + 0x68);
    if (cVar1 == '\0') {
      *(undefined4 *)(lVar2 + 0xc0) = param_2;
      goto LAB_000200d2;
    }
    lVar2 = *(long *)(lVar2 + 0xa8);
  } while( true );
}



// IOAccelFenceMachine::setErrorOnEventFenceWithID(IOAccelSubmitter2*, unsigned long long, unsigned
// int)

void __thiscall
IOAccelFenceMachine::setErrorOnEventFenceWithID
          (IOAccelFenceMachine *this,long param_1,long param_2,undefined4 param_3)

{
  IOAccelFenceMachine *pIVar1;
  long lVar2;
  
  _IOLockLock(*(undefined8 *)(this + 0x28));
  pIVar1 = (IOAccelFenceMachine *)(param_1 + 0x528);
  if (param_1 == 0) {
    pIVar1 = this + 0x50;
  }
  lVar2 = *(long *)pIVar1;
  do {
    if (lVar2 == 0) {
LAB_0002013f:
      _IOLockUnlock(*(undefined8 *)(this + 0x28));
      return;
    }
    if (lVar2 == param_2) {
      if (*(int *)(lVar2 + 0xc0) == 0) {
        *(undefined4 *)(lVar2 + 0xc0) = param_3;
      }
      goto LAB_0002013f;
    }
    lVar2 = *(long *)(lVar2 + 0xa8);
  } while( true );
}



// IOAccelBlockFencePort2::MetaClass::~MetaClass()

void __thiscall IOAccelBlockFencePort2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelEventFence::MetaClass::~MetaClass()

void __thiscall IOAccelEventFence::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelBlockFence::MetaClass::~MetaClass()

void __thiscall IOAccelBlockFence::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelSharedEventFence::MetaClass::~MetaClass()

void __thiscall IOAccelSharedEventFence::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelExternalEventFence::MetaClass::~MetaClass()

void __thiscall IOAccelExternalEventFence::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelContextEventFence::MetaClass::~MetaClass()

void __thiscall IOAccelContextEventFence::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelFenceMachine::MetaClass::~MetaClass()

void __thiscall IOAccelFenceMachine::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelBlockFence_cpp(void)

{
  undefined *puVar1;
  
  puVar1 = PTR_gMetaClass_0006b068;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelBlockFencePort2::gMetaClass,"IOAccelBlockFencePort2",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x50);
  _gMetaClass = &PTR__MetaClass_00075cd8;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelEventFence::gMetaClass,"IOAccelEventFence",(OSMetaClass *)puVar1
             ,200);
  _gMetaClass = &PTR__MetaClass_00075f10;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelBlockFence::gMetaClass,"IOAccelBlockFence",
             (OSMetaClass *)&IOAccelEventFence::gMetaClass,0xe0);
  _gMetaClass = &PTR__MetaClass_00076158;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelSharedEventFence::gMetaClass,"IOAccelSharedEventFence",
             (OSMetaClass *)&IOAccelEventFence::gMetaClass,0xd8);
  IOAccelSharedEventFence::gMetaClass = &PTR__MetaClass_00076390;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelExternalEventFence::gMetaClass,"IOAccelExternalEventFence",
             (OSMetaClass *)&IOAccelEventFence::gMetaClass,0xd0);
  IOAccelExternalEventFence::gMetaClass = &PTR__MetaClass_000765c8;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelContextEventFence::gMetaClass,"IOAccelContextEventFence",
             (OSMetaClass *)&IOAccelEventFence::gMetaClass,200);
  _gMetaClass = &PTR__MetaClass_00076800;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelFenceMachine::gMetaClass,"IOAccelFenceMachine",
             (OSMetaClass *)puVar1,0x90);
  _gMetaClass = &PTR__MetaClass_00076a28;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelFenceMachine::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelContextEventFence::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelExternalEventFence::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelSharedEventFence::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelBlockFence::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelEventFence::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelBlockFencePort2::gMetaClass);
  return;
}



// IOAccelMemoryAllocator2::MetaClass::MetaClass()

void __thiscall IOAccelMemoryAllocator2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelMemoryAllocator2",(OSMetaClass *)PTR_gMetaClass_0006b068,
             0x78);
  *(undefined ***)this = &PTR__MetaClass_00076ca0;
  return;
}



// IOAccelMemoryAllocator2::MetaClass::~MetaClass()

void __thiscall IOAccelMemoryAllocator2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelMemoryAllocator2::IOAccelMemoryAllocator2(OSMetaClass const*)

void __thiscall
IOAccelMemoryAllocator2::IOAccelMemoryAllocator2(IOAccelMemoryAllocator2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelMemoryAllocator2_00076b40;
  return;
}



// IOAccelMemoryAllocator2::IOAccelMemoryAllocator2(OSMetaClass const*)

void __thiscall
IOAccelMemoryAllocator2::IOAccelMemoryAllocator2(IOAccelMemoryAllocator2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelMemoryAllocator2_00076b40;
  return;
}



// IOAccelMemoryAllocator2::~IOAccelMemoryAllocator2()

void __thiscall IOAccelMemoryAllocator2::~IOAccelMemoryAllocator2(IOAccelMemoryAllocator2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelMemoryAllocator2::~IOAccelMemoryAllocator2()

void __thiscall IOAccelMemoryAllocator2::~IOAccelMemoryAllocator2(IOAccelMemoryAllocator2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelMemoryAllocator2::~IOAccelMemoryAllocator2()

void __thiscall IOAccelMemoryAllocator2::~IOAccelMemoryAllocator2(IOAccelMemoryAllocator2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelMemoryAllocator2_ktv,this,0x78);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelMemoryAllocator2::operator delete(void*, unsigned long)

void __cdecl IOAccelMemoryAllocator2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelMemoryAllocator2_ktv,param_1,param_2);
  return;
}



// IOAccelMemoryAllocator2::getMetaClass() const

undefined1 * IOAccelMemoryAllocator2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelMemoryAllocator2::MetaClass::MetaClass()

void __thiscall IOAccelMemoryAllocator2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelMemoryAllocator2",(OSMetaClass *)PTR_gMetaClass_0006b068,
             0x78);
  *(undefined ***)this = &PTR__MetaClass_00076ca0;
  return;
}



// IOAccelMemoryAllocator2::MetaClass::alloc() const

OSObject * IOAccelMemoryAllocator2::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelMemoryAllocator2_ktv,0x78);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelMemoryAllocator2::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelMemoryAllocator2_00076b40;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelMemoryAllocator2::operator new(unsigned long)

void * __thiscall IOAccelMemoryAllocator2::operator_new(IOAccelMemoryAllocator2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelMemoryAllocator2_ktv,this);
  return pvVar1;
}



// IOAccelMemoryAllocator2::IOAccelMemoryAllocator2()

void __thiscall IOAccelMemoryAllocator2::IOAccelMemoryAllocator2(IOAccelMemoryAllocator2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelMemoryAllocator2_00076b40;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelMemoryAllocator2::IOAccelMemoryAllocator2()

void __thiscall IOAccelMemoryAllocator2::IOAccelMemoryAllocator2(IOAccelMemoryAllocator2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelMemoryAllocator2_00076b40;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelMemoryAllocator2::init()

undefined4 __thiscall IOAccelMemoryAllocator2::init(IOAccelMemoryAllocator2 *this)

{
  undefined8 *puVar1;
  undefined4 uVar2;
  
  uVar2 = (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  if ((char)uVar2 != '\0') {
    puVar1 = *(undefined8 **)(this + 0x70);
    while (puVar1 != (undefined8 *)0x0) {
      puVar1 = (undefined8 *)*puVar1;
      *(undefined8 *)(this + 0x70) = 0;
      _IOFreeTypeImpl(&init()::kalloc_type_view_66);
      *(undefined8 **)(this + 0x70) = puVar1;
    }
    *(undefined8 *)(this + 0x50) = 0;
  }
  return uVar2;
}



// IOAccelMemoryAllocator2::init_pool(unsigned long long)

undefined8 __thiscall
IOAccelMemoryAllocator2::init_pool(IOAccelMemoryAllocator2 *this,undefined8 param_1)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  char cVar3;
  undefined8 *puVar4;
  undefined8 uVar5;
  long lVar6;
  
  cVar3 = (**(code **)(*(long *)this + 0x88))();
  if (cVar3 == '\0') {
LAB_000206c4:
    uVar5 = 0;
  }
  else {
    *(undefined8 *)(this + 0x58) = 0;
    *(undefined8 *)(this + 0x68) = 0;
    *(undefined8 *)(this + 0x50) = param_1;
    puVar4 = *(undefined8 **)(this + 0x70);
    if (puVar4 == (undefined8 *)0x0) {
      puVar4 = (undefined8 *)_IOMallocTypeImpl(&init_pool(unsigned_long_long)::kalloc_type_view_90);
      *(undefined8 **)(this + 0x70) = puVar4;
      if (puVar4 == (undefined8 *)0x0) goto LAB_000206c4;
      *puVar4 = 0;
    }
    puVar1 = puVar4 + 1;
    *(undefined8 **)(this + 0x58) = puVar1;
    puVar4[5] = 0;
    *(undefined4 *)(puVar4 + 6) = 0x80000000;
    puVar4[1] = puVar4 + 7;
    puVar4[2] = 0;
    *(undefined8 **)(this + 0x60) = puVar1;
    puVar4[0xb] = 0;
    *(undefined4 *)(puVar4 + 0xc) = 0;
    puVar2 = puVar4 + 0xd;
    puVar4[7] = puVar2;
    puVar4[8] = puVar1;
    puVar4[9] = 0;
    puVar4[10] = 0;
    puVar4[0x11] = 0;
    *(undefined4 *)(puVar4 + 0x12) = 0x80000000;
    puVar4[0xd] = puVar4 + 0x13;
    puVar4[0xe] = puVar4 + 7;
    puVar4[0xf] = puVar1;
    puVar4[0x10] = puVar1;
    puVar4[3] = puVar2;
    puVar4[4] = puVar2;
    puVar4[0x17] = param_1;
    *(undefined4 *)(puVar4 + 0x18) = 0;
    puVar4[0x13] = 0;
    puVar4[0x14] = puVar2;
    puVar4[0x15] = 0;
    puVar4[0x16] = 0;
    *(undefined8 **)(this + 0x68) = puVar4 + 0x19;
    puVar4[0x1d] = 0;
    *(undefined4 *)(puVar4 + 0x1e) = 0;
    puVar4[0x1a] = 0;
    lVar6 = 0;
    do {
      *(long *)((long)puVar4 + lVar6 + 200) = (long)puVar4 + lVar6 + 0xf8;
      *(undefined8 *)((long)puVar4 + lVar6 + 0xd8) = 0;
      *(undefined8 *)((long)puVar4 + lVar6 + 0xe0) = 0;
      *(undefined8 *)((long)puVar4 + lVar6 + 0x118) = 0;
      *(undefined4 *)((long)puVar4 + lVar6 + 0x120) = 0;
      *(undefined8 *)((long)puVar4 + lVar6 + 0x100) = 0;
      lVar6 = lVar6 + 0x30;
    } while (lVar6 != 0x510);
    puVar4[0xbb] = 0;
    uVar5 = CONCAT71((int7)((ulong)puVar4 >> 8),1);
  }
  return uVar5;
}



// IOAccelMemoryAllocator2::init_pool(unsigned long long, unsigned long long)

undefined8 __thiscall
IOAccelMemoryAllocator2::init_pool(IOAccelMemoryAllocator2 *this,ulong param_1,long param_2)

{
  undefined8 uVar1;
  
  uVar1 = init_pool(this,param_1 + param_2);
  if ((char)uVar1 != '\0') {
    uVar1 = reserve(this,(long *)0x0,0,param_1);
    if ((char)uVar1 != '\0') {
      return CONCAT71((int7)((ulong)uVar1 >> 8),1);
    }
    (**(code **)(*(long *)this + 0x90))(this);
  }
  return 0;
}



// IOAccelMemoryAllocator2::reserve(GLKMemoryElement*, unsigned long long, unsigned long long)

undefined8 __thiscall
IOAccelMemoryAllocator2::reserve
          (IOAccelMemoryAllocator2 *this,long *param_1,ulong param_2,ulong param_3)

{
  ulong uVar1;
  long lVar2;
  long lVar3;
  bool bVar4;
  undefined8 *puVar5;
  long *plVar6;
  long *plVar7;
  
  if (param_3 <= *(ulong *)(this + 0x50)) {
    if (param_1 == (long *)0x0) {
      param_1 = *(long **)(this + 0x68);
      lVar2 = *param_1;
      *(long *)(this + 0x68) = lVar2;
      if ((lVar2 == 0) && (bVar4 = growStack(this), !bVar4)) {
        param_1 = (long *)0x0;
      }
    }
    plVar6 = *(long **)(this + 0x60);
    plVar7 = (long *)plVar6[2];
    if (plVar7 != plVar6) {
      uVar1 = param_3 + param_2;
      do {
        if (((ulong)plVar7[4] <= param_2) && (lVar2 = *plVar7, uVar1 <= *(ulong *)(lVar2 + 0x20))) {
          puVar5 = (undefined8 *)plVar7[1];
          param_1[4] = param_2;
          *(undefined4 *)(param_1 + 5) = 0;
          param_1[2] = 0;
          param_1[3] = 0;
          if (plVar7[4] == param_2) {
            if (uVar1 == *(ulong *)(lVar2 + 0x20)) {
              *param_1 = lVar2;
              param_1[1] = (long)puVar5;
              *(long **)(lVar2 + 8) = param_1;
              *puVar5 = param_1;
              lVar2 = plVar7[3];
              *(long *)(lVar2 + 0x10) = plVar7[2];
              *(long *)(plVar7[2] + 0x18) = lVar2;
              puVar5 = (undefined8 *)0x0;
              plVar7[3] = 0;
              plVar7[2] = 0;
              *plVar7 = *(long *)(this + 0x68);
              plVar7[1] = 0;
              plVar7[4] = 0;
              *(undefined4 *)(plVar7 + 5) = 0;
              *(long **)(this + 0x68) = plVar7;
            }
            else {
              *param_1 = (long)plVar7;
              param_1[1] = (long)puVar5;
              plVar7[1] = (long)param_1;
              *puVar5 = param_1;
              plVar7[4] = uVar1;
            }
          }
          else if (uVar1 == *(ulong *)(lVar2 + 0x20)) {
            *param_1 = lVar2;
            param_1[1] = (long)plVar7;
            *(long **)(lVar2 + 8) = param_1;
            *plVar7 = (long)param_1;
          }
          else {
            plVar6 = *(long **)(this + 0x68);
            lVar3 = *plVar6;
            *(long *)(this + 0x68) = lVar3;
            if ((lVar3 == 0) && (bVar4 = growStack(this), !bVar4)) {
              plVar6 = (long *)0x0;
            }
            *(long **)(lVar2 + 8) = plVar6;
            *plVar6 = lVar2;
            plVar6[1] = (long)param_1;
            *param_1 = (long)plVar6;
            param_1[1] = (long)plVar7;
            *plVar7 = (long)param_1;
            plVar6[4] = uVar1;
            *(undefined4 *)(plVar6 + 5) = 0x80000000;
            plVar6[3] = (long)plVar7;
            plVar6[2] = plVar7[2];
            puVar5 = (undefined8 *)plVar7[2];
            puVar5[3] = plVar6;
            plVar7[2] = (long)plVar6;
          }
          *(ulong *)(this + 0x50) = *(long *)(this + 0x50) - param_3;
          return CONCAT71((int7)((ulong)puVar5 >> 8),1);
        }
        plVar7 = (long *)plVar7[2];
      } while (plVar7 != plVar6);
    }
  }
  return 0;
}



// IOAccelMemoryAllocator2::init_pool(unsigned long long, unsigned long long, unsigned long long)

undefined8 __thiscall
IOAccelMemoryAllocator2::init_pool
          (IOAccelMemoryAllocator2 *this,undefined8 param_1,ulong param_2,ulong param_3)

{
  undefined8 uVar1;
  
  uVar1 = init_pool(this,param_1);
  if ((char)uVar1 != '\0') {
    uVar1 = reserve(this,(long *)0x0,param_2,param_3);
    if ((char)uVar1 != '\0') {
      return CONCAT71((int7)((ulong)uVar1 >> 8),1);
    }
    (**(code **)(*(long *)this + 0x90))(this);
  }
  return 0;
}



// IOAccelMemoryAllocator2::free()

void __thiscall IOAccelMemoryAllocator2::free(IOAccelMemoryAllocator2 *this)

{
  undefined8 *puVar1;
  
  puVar1 = *(undefined8 **)(this + 0x70);
  while (puVar1 != (undefined8 *)0x0) {
    puVar1 = (undefined8 *)*puVar1;
    *(undefined8 *)(this + 0x70) = 0;
    _IOFreeTypeImpl(&free()::kalloc_type_view_199);
    *(undefined8 **)(this + 0x70) = puVar1;
  }
                    // WARNING: Could not recover jumptable at 0x00020958. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelMemoryAllocator2::growStack()

bool __thiscall IOAccelMemoryAllocator2::growStack(IOAccelMemoryAllocator2 *this)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  long lVar3;
  
  puVar1 = (undefined8 *)_IOMallocTypeImpl(&growStack()::kalloc_type_view_213);
  if (puVar1 != (undefined8 *)0x0) {
    *puVar1 = *(undefined8 *)(this + 0x70);
    *(undefined8 **)(this + 0x70) = puVar1;
    *(undefined8 **)(this + 0x68) = puVar1 + 1;
    puVar1[5] = 0;
    *(undefined4 *)(puVar1 + 6) = 0;
    puVar1[2] = 0;
    puVar2 = puVar1 + 7;
    lVar3 = 0x5d0;
    do {
      puVar2[-6] = puVar2;
      puVar2[-4] = 0;
      puVar2[-3] = 0;
      puVar2[4] = 0;
      *(undefined4 *)(puVar2 + 5) = 0;
      puVar2[1] = 0;
      puVar2 = puVar2 + 6;
      lVar3 = lVar3 + -0x30;
    } while (lVar3 != 0);
    puVar1[0xbb] = 0;
  }
  return puVar1 != (undefined8 *)0x0;
}



// IOAccelMemoryAllocator2::popFromStack()

long * __thiscall IOAccelMemoryAllocator2::popFromStack(IOAccelMemoryAllocator2 *this)

{
  long lVar1;
  bool bVar2;
  long *plVar3;
  
  plVar3 = *(long **)(this + 0x68);
  lVar1 = *plVar3;
  *(long *)(this + 0x68) = lVar1;
  if (lVar1 == 0) {
    bVar2 = growStack(this);
    if (!bVar2) {
      plVar3 = (long *)0x0;
    }
  }
  return plVar3;
}



// IOAccelMemoryAllocator2::pushIntoStack(GLKMemoryElement*)

void __thiscall
IOAccelMemoryAllocator2::pushIntoStack(IOAccelMemoryAllocator2 *this,undefined8 *param_1)

{
  *param_1 = *(undefined8 *)(this + 0x68);
  param_1[1] = 0;
  param_1[4] = 0;
  *(undefined4 *)(param_1 + 5) = 0;
  *(undefined8 **)(this + 0x68) = param_1;
  return;
}



// IOAccelMemoryAllocator2::allocPages(GLKMemoryElement*, unsigned long long, unsigned long long,
// bool, unsigned int)

void __thiscall
IOAccelMemoryAllocator2::allocPages
          (IOAccelMemoryAllocator2 *this,long *param_1,ulong param_2,long param_3,char param_4,
          int param_5)

{
  allocPages(this,param_1,param_2,param_3,0,-1,param_4,param_5);
  return;
}



// IOAccelMemoryAllocator2::allocPages(GLKMemoryElement*, unsigned long long, unsigned long long,
// unsigned long long, unsigned long long, bool, unsigned int)

ulong __thiscall
IOAccelMemoryAllocator2::allocPages
          (IOAccelMemoryAllocator2 *this,long *param_1,ulong param_2,long param_3,ulong param_4,
          long param_5,char param_6,int param_7)

{
  long lVar1;
  long *plVar2;
  undefined8 *puVar3;
  long lVar4;
  bool bVar5;
  long *plVar6;
  long *plVar7;
  ulong uVar8;
  ulong uVar9;
  uint uVar10;
  ulong uVar11;
  ulong uVar12;
  long *plVar13;
  long *plVar14;
  ulong local_40;
  
  uVar9 = 0;
  uVar11 = 0;
  if (param_3 != 0) {
    uVar11 = param_3 - 1;
  }
  if (param_2 <= *(ulong *)(this + 0x50)) {
    plVar7 = (long *)(*(long **)(this + 0x60))[2];
    if (plVar7 != *(long **)(this + 0x60)) {
      plVar6 = (long *)0x0;
      plVar14 = param_1;
      local_40 = param_2;
      do {
        lVar1 = *plVar7;
        plVar2 = (long *)plVar7[2];
        uVar9 = *(ulong *)(lVar1 + 0x20);
        plVar13 = plVar14;
        if (param_4 < uVar9) {
          uVar8 = plVar7[4] + uVar11 & ~uVar11;
          if ((ulong)plVar7[4] < param_4) {
            uVar8 = param_4;
          }
          uVar12 = uVar8 + local_40;
          if (uVar9 < uVar12) {
            if ((param_6 != '\0') ||
               (uVar10 = (int)uVar9 - (int)uVar8 & -param_7, local_40 = param_2, uVar10 == 0))
            goto LAB_00020cf6;
            uVar12 = uVar10 + uVar8;
            local_40 = (ulong)uVar10;
          }
          if ((param_5 != -1) && (param_5 + param_4 < uVar12)) break;
          puVar3 = (undefined8 *)plVar7[1];
          plVar14[4] = uVar8;
          *(uint *)(plVar14 + 5) = (uint)uVar11 & 0xffff;
          plVar14[2] = 0;
          plVar14[3] = 0;
          if (plVar6 != (long *)0x0) {
            plVar6[2] = (long)plVar14;
            plVar14[3] = (long)plVar6;
          }
          if (uVar8 == plVar7[4]) {
            if (uVar12 == *(ulong *)(lVar1 + 0x20)) {
              *plVar14 = lVar1;
              plVar14[1] = (long)puVar3;
              *(long **)(lVar1 + 8) = plVar14;
              *puVar3 = plVar14;
              lVar1 = plVar7[3];
              *(long *)(lVar1 + 0x10) = plVar7[2];
              *(long *)(plVar7[2] + 0x18) = lVar1;
              plVar7[3] = 0;
              plVar7[2] = 0;
              *plVar7 = *(long *)(this + 0x68);
              plVar7[1] = 0;
              plVar7[4] = 0;
              *(undefined4 *)(plVar7 + 5) = 0;
              *(long **)(this + 0x68) = plVar7;
            }
            else {
              *plVar14 = (long)plVar7;
              plVar14[1] = (long)puVar3;
              plVar7[1] = (long)plVar14;
              *puVar3 = plVar14;
              plVar7[4] = uVar12;
            }
          }
          else if (uVar12 == *(ulong *)(lVar1 + 0x20)) {
            *plVar14 = lVar1;
            plVar14[1] = (long)plVar7;
            *(long **)(lVar1 + 8) = plVar14;
            *plVar7 = (long)plVar14;
          }
          else {
            plVar6 = *(long **)(this + 0x68);
            lVar4 = *plVar6;
            *(long *)(this + 0x68) = lVar4;
            if ((lVar4 == 0) && (bVar5 = growStack(this), !bVar5)) {
              plVar6 = (long *)0x0;
            }
            *(long **)(lVar1 + 8) = plVar6;
            *plVar6 = lVar1;
            plVar6[1] = (long)plVar14;
            *plVar14 = (long)plVar6;
            plVar14[1] = (long)plVar7;
            *plVar7 = (long)plVar14;
            plVar6[4] = uVar12;
            *(undefined4 *)(plVar6 + 5) = 0x80000000;
            plVar6[3] = (long)plVar7;
            plVar6[2] = plVar7[2];
            *(long **)(plVar7[2] + 0x18) = plVar6;
            plVar7[2] = (long)plVar6;
          }
          *(ulong *)(this + 0x50) = *(long *)(this + 0x50) - local_40;
          param_2 = param_2 - local_40;
          if (param_2 == 0) {
            uVar9 = CONCAT71((int7)((ulong)plVar7 >> 8),1);
            goto LAB_00020d37;
          }
          plVar13 = *(long **)(this + 0x68);
          lVar1 = *plVar13;
          *(long *)(this + 0x68) = lVar1;
          plVar6 = plVar14;
          local_40 = param_2;
          if ((lVar1 == 0) && (bVar5 = growStack(this), !bVar5)) {
            plVar13 = (long *)0x0;
          }
        }
LAB_00020cf6:
        plVar7 = plVar2;
        plVar14 = plVar13;
      } while (plVar2 != *(long **)(this + 0x60));
      if (plVar13 != param_1) {
        *plVar13 = *(long *)(this + 0x68);
        uVar9 = 0;
        plVar13[1] = 0;
        plVar13[4] = 0;
        *(undefined4 *)(plVar13 + 5) = 0;
        *(long **)(this + 0x68) = plVar13;
        dealloc(this,param_1);
        goto LAB_00020d37;
      }
    }
    uVar9 = 0;
  }
LAB_00020d37:
  return uVar9 & 0xffffffff;
}



// IOAccelMemoryAllocator2::dealloc(GLKMemoryElement*)

undefined8 __thiscall
IOAccelMemoryAllocator2::dealloc(IOAccelMemoryAllocator2 *this,undefined8 *param_1)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  undefined8 in_RAX;
  
  puVar1 = param_1;
  while (puVar2 = puVar1, puVar2 != (undefined8 *)0x0) {
    puVar1 = (undefined8 *)puVar2[2];
    puVar2[3] = 0;
    puVar2[2] = 0;
    in_RAX = deallocOne(this,puVar2);
    if (puVar2 != param_1) {
      in_RAX = *(undefined8 *)(this + 0x68);
      *puVar2 = in_RAX;
      puVar2[1] = 0;
      puVar2[4] = 0;
      *(undefined4 *)(puVar2 + 5) = 0;
      *(undefined8 **)(this + 0x68) = puVar2;
    }
  }
  return CONCAT71((int7)((ulong)in_RAX >> 8),1);
}



// IOAccelMemoryAllocator2::deallocOne(GLKMemoryElement*)

undefined8 __thiscall
IOAccelMemoryAllocator2::deallocOne(IOAccelMemoryAllocator2 *this,undefined8 *param_1)

{
  uint uVar1;
  ulong uVar2;
  long lVar3;
  bool bVar4;
  undefined7 extraout_var;
  long *plVar6;
  long *plVar7;
  ulong *puVar8;
  ulong uVar5;
  
  uVar2 = param_1[4];
  plVar6 = (long *)*param_1;
  plVar7 = (long *)param_1[1];
  lVar3 = plVar6[4];
  param_1[1] = 0;
  *param_1 = 0;
  param_1[4] = 0;
  *(undefined4 *)(param_1 + 5) = 0;
  uVar1 = *(uint *)(plVar6 + 5);
  uVar5 = (ulong)uVar1;
  if ((int)(uVar1 & *(uint *)(plVar7 + 5)) < 0) {
    *plVar7 = *plVar6;
    *(long **)(*plVar6 + 8) = plVar7;
    plVar7[2] = plVar6[2];
    *(long **)(plVar6[2] + 0x18) = plVar7;
    uVar5 = 0;
    plVar6[2] = 0;
    plVar6[3] = 0;
    *plVar6 = *(undefined8 *)(this + 0x68);
    plVar6[1] = 0;
    plVar6[4] = 0;
    *(undefined4 *)(plVar6 + 5) = 0;
    *(long **)(this + 0x68) = plVar6;
  }
  else if ((int)*(uint *)(plVar7 + 5) < 0) {
    *plVar7 = (long)plVar6;
    plVar6[1] = (long)plVar7;
  }
  else if ((int)uVar1 < 0) {
    *plVar7 = (long)plVar6;
    plVar6[1] = (long)plVar7;
    plVar6[4] = uVar2;
  }
  else {
    puVar8 = *(ulong **)(this + 0x68);
    uVar5 = *puVar8;
    *(ulong *)(this + 0x68) = uVar5;
    if (uVar5 == 0) {
      bVar4 = growStack(this);
      uVar5 = CONCAT71(extraout_var,bVar4);
      if (!bVar4) {
        puVar8 = (ulong *)0x0;
      }
    }
    *plVar7 = (long)puVar8;
    plVar6[1] = (long)puVar8;
    *puVar8 = (ulong)plVar6;
    puVar8[1] = (ulong)plVar7;
    puVar8[4] = uVar2;
    *(undefined4 *)(puVar8 + 5) = 0x80000000;
    do {
      plVar7 = (long *)plVar7[1];
    } while (-1 < (int)plVar7[5]);
    do {
      plVar6 = (long *)*plVar6;
      if (plVar6 == (long *)0x0) {
        plVar6 = *(long **)(this + 0x60);
        break;
      }
    } while (-1 < (int)plVar6[5]);
    puVar8[3] = (ulong)plVar7;
    puVar8[2] = (ulong)plVar6;
    plVar7[2] = (long)puVar8;
    plVar6[3] = (long)puVar8;
  }
  *(ulong *)(this + 0x50) = *(long *)(this + 0x50) + (lVar3 - uVar2);
  return CONCAT71((int7)(uVar5 >> 8),1);
}



// IOAccelMemoryAllocator2::total_free()

undefined8 __thiscall IOAccelMemoryAllocator2::total_free(IOAccelMemoryAllocator2 *this)

{
  return *(undefined8 *)(this + 0x50);
}



// IOAccelMemoryAllocator2::log()

void __thiscall IOAccelMemoryAllocator2::log(IOAccelMemoryAllocator2 *this)

{
  undefined *puVar1;
  long lVar2;
  int iVar3;
  char *pcVar4;
  long *plVar5;
  
  puVar1 = PTR___os_log_default_0006b0b8;
  plVar5 = *(long **)(this + 0x58);
  if (plVar5 != (long *)0x0) {
    lVar2 = *plVar5;
    if (lVar2 == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = 0;
      do {
        pcVar4 = "free";
        if (-1 < (int)plVar5[5]) {
          pcVar4 = "used";
        }
        __os_log_internal(0,puVar1,0x11,
                          "IOAccelMemoryAllocator::log: %s[%d]: {offset, size} = {%llu, %llu}\n",
                          pcVar4,iVar3,plVar5[4],*(long *)(lVar2 + 0x20) - plVar5[4]);
        iVar3 = iVar3 + 1;
        plVar5 = (long *)*plVar5;
        lVar2 = *plVar5;
      } while (lVar2 != 0);
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "IOAccelMemoryAllocator::log: term[%d]: {offset, size} = {%u, 0}\n",iVar3,
                      (int)plVar5[4]);
  }
  return;
}



// IOAccelMemoryAllocator2::logMax()

void __thiscall IOAccelMemoryAllocator2::logMax(IOAccelMemoryAllocator2 *this)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  ulong uVar3;
  
  if (*(undefined8 **)(this + 0x58) != (undefined8 *)0x0) {
    puVar1 = *(undefined8 **)**(undefined8 **)(this + 0x58);
    uVar3 = 0;
    for (puVar2 = (undefined8 *)*puVar1; puVar2 != (undefined8 *)0x0; puVar2 = (undefined8 *)*puVar2
        ) {
      if ((*(int *)(puVar1 + 5) < 0) && (uVar3 < (ulong)(puVar2[4] - puVar1[4]))) {
        uVar3 = puVar2[4] - puVar1[4];
      }
      puVar1 = puVar2;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "IOAccelMemoryAllocator::logMax: max free element size = %u\n");
  }
  return;
}



// IOAccelMemoryAllocator2::_RESERVEDIOAccelMemoryAllocator0()

void IOAccelMemoryAllocator2::_RESERVEDIOAccelMemoryAllocator0(void)

{
  OSMetaClass::reservedCalled(0x82340);
  return;
}



// IOAccelMemoryAllocator2::_RESERVEDIOAccelMemoryAllocator1()

void IOAccelMemoryAllocator2::_RESERVEDIOAccelMemoryAllocator1(void)

{
  OSMetaClass::reservedCalled(0x82340);
  return;
}



// IOAccelMemoryAllocator2::_RESERVEDIOAccelMemoryAllocator2()

void IOAccelMemoryAllocator2::_RESERVEDIOAccelMemoryAllocator2(void)

{
  OSMetaClass::reservedCalled(0x82340);
  return;
}



// IOAccelMemoryAllocator2::_RESERVEDIOAccelMemoryAllocator3()

void IOAccelMemoryAllocator2::_RESERVEDIOAccelMemoryAllocator3(void)

{
  OSMetaClass::reservedCalled(0x82340);
  return;
}



// IOAccelMemoryAllocator2::_RESERVEDIOAccelMemoryAllocator4()

void IOAccelMemoryAllocator2::_RESERVEDIOAccelMemoryAllocator4(void)

{
  OSMetaClass::reservedCalled(0x82340);
  return;
}



// IOAccelMemoryAllocator2::_RESERVEDIOAccelMemoryAllocator5()

void IOAccelMemoryAllocator2::_RESERVEDIOAccelMemoryAllocator5(void)

{
  OSMetaClass::reservedCalled(0x82340);
  return;
}



// IOAccelMemoryAllocator2::MetaClass::~MetaClass()

void __thiscall IOAccelMemoryAllocator2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelMemoryAllocator_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelMemoryAllocator2::gMetaClass,"IOAccelMemoryAllocator2",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x78);
  _gMetaClass = &PTR__MetaClass_00076ca0;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelMemoryAllocator2::gMetaClass);
  return;
}



// IOAccelKernelMappedMemory::MetaClass::MetaClass()

void __thiscall IOAccelKernelMappedMemory::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelKernelMappedMemory",(OSMetaClass *)PTR_gMetaClass_0006b068,
             0x40);
  *(undefined ***)this = &PTR__MetaClass_00076ee0;
  return;
}



// IOAccelKernelMappedMemory::MetaClass::~MetaClass()

void __thiscall IOAccelKernelMappedMemory::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelKernelMappedMemory::IOAccelKernelMappedMemory(OSMetaClass const*)

void __thiscall
IOAccelKernelMappedMemory::IOAccelKernelMappedMemory
          (IOAccelKernelMappedMemory *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelKernelMappedMemory_00076d98;
  return;
}



// IOAccelKernelMappedMemory::IOAccelKernelMappedMemory(OSMetaClass const*)

void __thiscall
IOAccelKernelMappedMemory::IOAccelKernelMappedMemory
          (IOAccelKernelMappedMemory *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelKernelMappedMemory_00076d98;
  return;
}



// IOAccelKernelMappedMemory::~IOAccelKernelMappedMemory()

void __thiscall
IOAccelKernelMappedMemory::~IOAccelKernelMappedMemory(IOAccelKernelMappedMemory *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelKernelMappedMemory::~IOAccelKernelMappedMemory()

void __thiscall
IOAccelKernelMappedMemory::~IOAccelKernelMappedMemory(IOAccelKernelMappedMemory *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelKernelMappedMemory::~IOAccelKernelMappedMemory()

void __thiscall
IOAccelKernelMappedMemory::~IOAccelKernelMappedMemory(IOAccelKernelMappedMemory *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelKernelMappedMemory_ktv,this,0x40);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelKernelMappedMemory::operator delete(void*, unsigned long)

void __cdecl IOAccelKernelMappedMemory::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelKernelMappedMemory_ktv,param_1,param_2);
  return;
}



// IOAccelKernelMappedMemory::getMetaClass() const

undefined1 * IOAccelKernelMappedMemory::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelKernelMappedMemory::MetaClass::MetaClass()

void __thiscall IOAccelKernelMappedMemory::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelKernelMappedMemory",(OSMetaClass *)PTR_gMetaClass_0006b068,
             0x40);
  *(undefined ***)this = &PTR__MetaClass_00076ee0;
  return;
}



// IOAccelKernelMappedMemory::MetaClass::alloc() const

OSObject * IOAccelKernelMappedMemory::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelKernelMappedMemory_ktv,0x40);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelKernelMappedMemory::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelKernelMappedMemory_00076d98;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelKernelMappedMemory::operator new(unsigned long)

void * __thiscall IOAccelKernelMappedMemory::operator_new(IOAccelKernelMappedMemory *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelKernelMappedMemory_ktv,this);
  return pvVar1;
}



// IOAccelKernelMappedMemory::IOAccelKernelMappedMemory()

void __thiscall
IOAccelKernelMappedMemory::IOAccelKernelMappedMemory(IOAccelKernelMappedMemory *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelKernelMappedMemory_00076d98;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelKernelMappedMemory::IOAccelKernelMappedMemory()

void __thiscall
IOAccelKernelMappedMemory::IOAccelKernelMappedMemory(IOAccelKernelMappedMemory *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelKernelMappedMemory_00076d98;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelKernelMappedMemory::init(IOGraphicsAccelerator2*, IOMemoryDescriptor*)

undefined8 __thiscall
IOAccelKernelMappedMemory::init(IOAccelKernelMappedMemory *this,long param_1,long *param_2)

{
  char cVar1;
  undefined8 uVar2;
  
  cVar1 = (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  if (cVar1 == '\0') {
    uVar2 = 0;
  }
  else {
    uVar2 = 0;
    if ((param_1 != 0) && (param_2 != (long *)0x0)) {
      *(long *)(this + 0x20) = param_1;
      uVar2 = (**(code **)(*param_2 + 0x20))(param_2);
      *(long **)(this + 0x28) = param_2;
      *(undefined8 *)(this + 0x30) = 0;
      *(undefined4 *)(this + 0x38) = 0;
      uVar2 = CONCAT71((int7)((ulong)uVar2 >> 8),1);
    }
  }
  return uVar2;
}



// IOAccelKernelMappedMemory::free()

void __thiscall IOAccelKernelMappedMemory::free(IOAccelKernelMappedMemory *this)

{
  unmap(this);
  if (*(long **)(this + 0x28) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x28) + 0x28))();
  }
                    // WARNING: Could not recover jumptable at 0x00021369. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelKernelMappedMemory::unmap()

bool __thiscall IOAccelKernelMappedMemory::unmap(IOAccelKernelMappedMemory *this)

{
  long *plVar1;
  
  plVar1 = *(long **)(this + 0x30);
  if (plVar1 != (long *)0x0) {
    (**(code **)(*plVar1 + 0x28))(plVar1);
    *(undefined8 *)(this + 0x30) = 0;
    IOGraphicsAccelerator2::remove_kernel_mapped_memory
              (*(IOGraphicsAccelerator2 **)(this + 0x20),(long *)this);
  }
  return plVar1 != (long *)0x0;
}



// IOAccelKernelMappedMemory::getLength() const

void __thiscall IOAccelKernelMappedMemory::getLength(IOAccelKernelMappedMemory *this)

{
                    // WARNING: Could not recover jumptable at 0x000213b8. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0x28) + 0x1c8))();
  return;
}



// IOAccelKernelMappedMemory::getKernelData()

undefined8 __thiscall IOAccelKernelMappedMemory::getKernelData(IOAccelKernelMappedMemory *this)

{
  int iVar1;
  undefined8 uVar2;
  long lVar3;
  ulong uVar4;
  long *plVar5;
  IOGraphicsAccelerator2 *this_00;
  
  plVar5 = *(long **)(this + 0x30);
  if (plVar5 != (long *)0x0) goto LAB_000213d0;
  lVar3 = (**(code **)(*(long *)this + 0x128))(this);
  this_00 = *(IOGraphicsAccelerator2 **)(this + 0x20);
  if ((ulong)*(uint *)(this_00 + 0xa00) + lVar3 < (ulong)*(uint *)(this_00 + 0xa04)) {
    uVar4 = map(this);
    if ((char)uVar4 == '\0') {
      this_00 = *(IOGraphicsAccelerator2 **)(this + 0x20);
      goto LAB_00021433;
    }
  }
  else {
LAB_00021433:
    uVar4 = IOGraphicsAccelerator2::freeToMapKernelMemory(this_00,this);
    if ((char)uVar4 == '\0') {
      (**(code **)(*(long *)this + 0x128))(this);
      uVar2 = (**(code **)(*(long *)this + 0x128))(this);
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: fail. request=%llu, current=%d, max=%d\n",
                        "virtual void *IOAccelKernelMappedMemory::getKernelData()",uVar2,
                        *(undefined4 *)(*(long *)(this + 0x20) + 0xa00),
                        *(undefined4 *)(*(long *)(this + 0x20) + 0xa04));
      return 0;
    }
  }
  plVar5 = *(long **)(this + 0x30);
  if (plVar5 == (long *)0x0) {
    return 0;
  }
LAB_000213d0:
  iVar1 = *(int *)(*(long *)(this + 0x20) + 0x9f8);
  *(int *)(*(long *)(this + 0x20) + 0x9f8) = iVar1 + 1;
  *(int *)(this + 0x3c) = iVar1;
  *(int *)(this + 0x38) = *(int *)(this + 0x38) + 1;
  uVar2 = (**(code **)(*plVar5 + 0x118))();
  return uVar2;
}



// IOAccelKernelMappedMemory::map()

ulong __thiscall IOAccelKernelMappedMemory::map(IOAccelKernelMappedMemory *this)

{
  long lVar1;
  undefined8 unaff_RBX;
  ulong uVar2;
  
  uVar2 = CONCAT71((int7)((ulong)unaff_RBX >> 8),1);
  if (*(long *)(this + 0x30) == 0) {
    lVar1 = (**(code **)(**(long **)(this + 0x28) + 0x200))(*(long **)(this + 0x28),0);
    *(long *)(this + 0x30) = lVar1;
    if (lVar1 == 0) {
      uVar2 = 0;
    }
    else {
      IOGraphicsAccelerator2::insert_kernel_mapped_memory
                (*(IOGraphicsAccelerator2 **)(this + 0x20),(long *)this);
    }
  }
  return uVar2 & 0xffffffff;
}



// IOAccelKernelMappedMemory::releaseKernelData()

void __thiscall IOAccelKernelMappedMemory::releaseKernelData(IOAccelKernelMappedMemory *this)

{
  *(int *)(this + 0x38) = *(int *)(this + 0x38) + -1;
  return;
}



// IOAccelDeviceShmem::MetaClass::MetaClass()

void __thiscall IOAccelDeviceShmem::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDeviceShmem",
             (OSMetaClass *)&IOAccelKernelMappedMemory::gMetaClass,0x78);
  *(undefined ***)this = &PTR__MetaClass_00077130;
  return;
}



// IOAccelDeviceShmem::MetaClass::~MetaClass()

void __thiscall IOAccelDeviceShmem::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelDeviceShmem::IOAccelDeviceShmem(OSMetaClass const*)

void __thiscall
IOAccelDeviceShmem::IOAccelDeviceShmem(IOAccelDeviceShmem *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDeviceShmem_00076fd8;
  return;
}



// IOAccelDeviceShmem::IOAccelDeviceShmem(OSMetaClass const*)

void __thiscall
IOAccelDeviceShmem::IOAccelDeviceShmem(IOAccelDeviceShmem *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDeviceShmem_00076fd8;
  return;
}



// IOAccelDeviceShmem::~IOAccelDeviceShmem()

void __thiscall IOAccelDeviceShmem::~IOAccelDeviceShmem(IOAccelDeviceShmem *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelDeviceShmem::~IOAccelDeviceShmem()

void __thiscall IOAccelDeviceShmem::~IOAccelDeviceShmem(IOAccelDeviceShmem *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelDeviceShmem::~IOAccelDeviceShmem()

void __thiscall IOAccelDeviceShmem::~IOAccelDeviceShmem(IOAccelDeviceShmem *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelDeviceShmem_ktv,this,0x78);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDeviceShmem::operator delete(void*, unsigned long)

void __cdecl IOAccelDeviceShmem::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelDeviceShmem_ktv,param_1,param_2);
  return;
}



// IOAccelDeviceShmem::getMetaClass() const

undefined1 * IOAccelDeviceShmem::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelDeviceShmem::MetaClass::MetaClass()

void __thiscall IOAccelDeviceShmem::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDeviceShmem",
             (OSMetaClass *)&IOAccelKernelMappedMemory::gMetaClass,0x78);
  *(undefined ***)this = &PTR__MetaClass_00077130;
  return;
}



// IOAccelDeviceShmem::MetaClass::alloc() const

OSObject * IOAccelDeviceShmem::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelDeviceShmem_ktv,0x78);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelDeviceShmem::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDeviceShmem_00076fd8;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelDeviceShmem::operator new(unsigned long)

void * __thiscall IOAccelDeviceShmem::operator_new(IOAccelDeviceShmem *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelDeviceShmem_ktv,this);
  return pvVar1;
}



// IOAccelDeviceShmem::IOAccelDeviceShmem()

void __thiscall IOAccelDeviceShmem::IOAccelDeviceShmem(IOAccelDeviceShmem *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDeviceShmem_00076fd8;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDeviceShmem::IOAccelDeviceShmem()

void __thiscall IOAccelDeviceShmem::IOAccelDeviceShmem(IOAccelDeviceShmem *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDeviceShmem_00076fd8;
  OSMetaClass::instanceConstructed();
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDeviceShmem::deviceShmemWithTask(IOGraphicsAccelerator2*, task*, IOAccelNamespace*,
// unsigned long)

OSObject * __cdecl
IOAccelDeviceShmem::deviceShmemWithTask(long param_1,task *param_2,long *param_3,ulong param_4)

{
  OSObject *this;
  undefined8 uVar1;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelDeviceShmem_ktv,0x78);
  OSObject::OSObject(this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDeviceShmem_00076fd8;
  OSMetaClass::instanceConstructed();
  uVar1 = init((IOAccelDeviceShmem *)this,param_1,param_2,param_3,param_4);
  if ((char)uVar1 == '\0') {
    (**(code **)(*(long *)this + 0x28))(this);
    this = (OSObject *)0x0;
  }
  return this;
}



// IOAccelDeviceShmem::init(IOGraphicsAccelerator2*, task*, IOAccelNamespace*, unsigned long)

undefined8 __thiscall
IOAccelDeviceShmem::init
          (IOAccelDeviceShmem *this,long param_1,task *param_2,long *param_3,ulong param_4)

{
  long *plVar1;
  char cVar2;
  task *ptVar3;
  long lVar4;
  ulong uVar5;
  undefined8 uVar6;
  
  *(long **)(this + 0x48) = param_3;
  (**(code **)(*param_3 + 0x20))(param_3);
  ptVar3 = (task *)IOBufferMemoryDescriptor::inTaskWithOptions(param_2,0x10060,param_4,1,0,100);
  *(task **)(this + 0x50) = ptVar3;
  uVar6 = 0;
  if (ptVar3 != (task *)0x0) {
    IOMemoryDescriptor::setOwnership(ptVar3,(int)param_2,4);
    plVar1 = *(long **)(this + 0x50);
    cVar2 = (**(code **)(PTR_vtable_0006b0a0 + 0x98))(this);
    uVar6 = 0;
    if (cVar2 != '\0') {
      uVar6 = 0;
      if ((param_1 != 0) && (uVar6 = 0, plVar1 != (long *)0x0)) {
        *(long *)(this + 0x20) = param_1;
        (**(code **)(*plVar1 + 0x20))(plVar1);
        *(long **)(this + 0x28) = plVar1;
        *(undefined8 *)(this + 0x30) = 0;
        *(undefined4 *)(this + 0x38) = 0;
        uVar6 = 0;
        lVar4 = IOMemoryDescriptor::createMappingInTask
                          (*(task **)(this + 0x50),(ulonglong)param_2,0,1,0);
        *(long *)(this + 0x58) = lVar4;
        if (lVar4 != 0) {
          uVar5 = IOAccelNamespace::allocId
                            (*(IOAccelNamespace **)(this + 0x48),this,(uint *)(this + 0x40));
          if ((char)uVar5 == '\0') {
            uVar6 = 0;
          }
          else {
            uVar6 = (**(code **)(**(long **)(this + 0x28) + 0x1c8))();
            *(undefined8 *)(this + 0x68) = uVar6;
            uVar6 = 1;
          }
        }
      }
    }
  }
  return uVar6;
}



// IOAccelDeviceShmem::free()

void __thiscall IOAccelDeviceShmem::free(IOAccelDeviceShmem *this)

{
  if (*(uint *)(this + 0x40) != 0) {
    IOAccelNamespace::freeId(*(IOAccelNamespace **)(this + 0x48),*(uint *)(this + 0x40));
  }
  if (*(long **)(this + 0x48) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x48) + 0x28))();
  }
  if (*(long **)(this + 0x58) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x58) + 0x28))();
  }
  if (*(long **)(this + 0x50) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x50) + 0x28))();
  }
  IOAccelKernelMappedMemory::free((IOAccelKernelMappedMemory *)this);
  return;
}



// IOAccelDeviceShmem::getKernelData()

long __thiscall IOAccelDeviceShmem::getKernelData(IOAccelDeviceShmem *this)

{
  long lVar1;
  
  lVar1 = IOAccelKernelMappedMemory::getKernelData((IOAccelKernelMappedMemory *)this);
  return lVar1 + *(long *)(this + 0x60);
}



// IOAccelDeviceShmem::setKernelDataRange(unsigned long, unsigned long)

void __thiscall
IOAccelDeviceShmem::setKernelDataRange
          (IOAccelDeviceShmem *this,undefined8 param_1,undefined8 param_2)

{
  *(undefined8 *)(this + 0x60) = param_1;
  *(undefined8 *)(this + 0x68) = param_2;
  return;
}



// IOAccelDeviceShmem::resetKernelDataRange()

void __thiscall IOAccelDeviceShmem::resetKernelDataRange(IOAccelDeviceShmem *this)

{
  undefined8 uVar1;
  
  *(undefined8 *)(this + 0x60) = 0;
  uVar1 = (**(code **)(**(long **)(this + 0x28) + 0x1c8))();
  *(undefined8 *)(this + 0x68) = uVar1;
  return;
}



// IOAccelDeviceShmem::getLength() const

undefined8 __thiscall IOAccelDeviceShmem::getLength(IOAccelDeviceShmem *this)

{
  return *(undefined8 *)(this + 0x68);
}



// IOAccelDeviceShmem::getShmemData()

void __thiscall IOAccelDeviceShmem::getShmemData(IOAccelDeviceShmem *this)

{
  IOAccelKernelMappedMemory::getKernelData((IOAccelKernelMappedMemory *)this);
  return;
}



// IOAccelDeviceShmem::getShmemLength() const

void __thiscall IOAccelDeviceShmem::getShmemLength(IOAccelDeviceShmem *this)

{
                    // WARNING: Could not recover jumptable at 0x00021930. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0x28) + 0x1c8))();
  return;
}



// IOAccelDeviceShmem::getClientData()

void __thiscall IOAccelDeviceShmem::getClientData(IOAccelDeviceShmem *this)

{
                    // WARNING: Could not recover jumptable at 0x00021942. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0x58) + 0x118))();
  return;
}



// IOAccelDeviceShmem::getShmemId()

undefined4 __thiscall IOAccelDeviceShmem::getShmemId(IOAccelDeviceShmem *this)

{
  return *(undefined4 *)(this + 0x40);
}



// IOAccelDeviceShmem::describeAllocation(int, IOAccelAllocationInfo*)

void __thiscall
IOAccelDeviceShmem::describeAllocation(IOAccelDeviceShmem *this,int param_1,long param_2)

{
  ulonglong *puVar1;
  
  puVar1 = *(ulonglong **)(this + 0x50);
  (**(code **)(**(long **)(this + 0x58) + 0x118))();
  IOAccelAllocationInfo::declareDeviceShmem(param_2,param_1,puVar1);
  return;
}



// IOAccelKernelMappedMemory::MetaClass::~MetaClass()

void __thiscall IOAccelKernelMappedMemory::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelDeviceShmem::MetaClass::~MetaClass()

void __thiscall IOAccelDeviceShmem::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelDeviceShmem_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelKernelMappedMemory::gMetaClass,"IOAccelKernelMappedMemory",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x40);
  _gMetaClass = &PTR__MetaClass_00076ee0;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelDeviceShmem::gMetaClass,"IOAccelDeviceShmem",
             (OSMetaClass *)&IOAccelKernelMappedMemory::gMetaClass,0x78);
  _gMetaClass = &PTR__MetaClass_00077130;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelDeviceShmem::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelKernelMappedMemory::gMetaClass);
  return;
}



// IOAccelTraceStreamConnection::MetaClass::MetaClass()

void __thiscall IOAccelTraceStreamConnection::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelTraceStreamConnection",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x40);
  *(undefined ***)this = &PTR__MetaClass_00077360;
  return;
}



// IOAccelTraceStreamConnection::MetaClass::~MetaClass()

void __thiscall IOAccelTraceStreamConnection::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelTraceStreamConnection::IOAccelTraceStreamConnection(OSMetaClass const*)

void __thiscall
IOAccelTraceStreamConnection::IOAccelTraceStreamConnection
          (IOAccelTraceStreamConnection *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelTraceStreamConnection_00077228;
  return;
}



// IOAccelTraceStreamConnection::IOAccelTraceStreamConnection(OSMetaClass const*)

void __thiscall
IOAccelTraceStreamConnection::IOAccelTraceStreamConnection
          (IOAccelTraceStreamConnection *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelTraceStreamConnection_00077228;
  return;
}



// IOAccelTraceStreamConnection::~IOAccelTraceStreamConnection()

void __thiscall
IOAccelTraceStreamConnection::~IOAccelTraceStreamConnection(IOAccelTraceStreamConnection *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelTraceStreamConnection::~IOAccelTraceStreamConnection()

void __thiscall
IOAccelTraceStreamConnection::~IOAccelTraceStreamConnection(IOAccelTraceStreamConnection *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelTraceStreamConnection::~IOAccelTraceStreamConnection()

void __thiscall
IOAccelTraceStreamConnection::~IOAccelTraceStreamConnection(IOAccelTraceStreamConnection *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelTraceStreamConnection_ktv,this,0x40);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelTraceStreamConnection::operator delete(void*, unsigned long)

void __cdecl IOAccelTraceStreamConnection::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelTraceStreamConnection_ktv,param_1,param_2);
  return;
}



// IOAccelTraceStreamConnection::getMetaClass() const

undefined8 * IOAccelTraceStreamConnection::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelTraceStreamConnection::MetaClass::MetaClass()

void __thiscall IOAccelTraceStreamConnection::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelTraceStreamConnection",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x40);
  *(undefined ***)this = &PTR__MetaClass_00077360;
  return;
}



// IOAccelTraceStreamConnection::MetaClass::alloc() const

OSObject * IOAccelTraceStreamConnection::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelTraceStreamConnection_ktv,0x40);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelTraceStreamConnection::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelTraceStreamConnection_00077228;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelTraceStreamConnection::operator new(unsigned long)

void * __thiscall IOAccelTraceStreamConnection::operator_new(IOAccelTraceStreamConnection *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelTraceStreamConnection_ktv,this);
  return pvVar1;
}



// IOAccelTraceStreamConnection::IOAccelTraceStreamConnection()

void __thiscall
IOAccelTraceStreamConnection::IOAccelTraceStreamConnection(IOAccelTraceStreamConnection *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelTraceStreamConnection_00077228;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelTraceStreamConnection::IOAccelTraceStreamConnection()

void __thiscall
IOAccelTraceStreamConnection::IOAccelTraceStreamConnection(IOAccelTraceStreamConnection *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelTraceStreamConnection_00077228;
  OSMetaClass::instanceConstructed();
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelTraceStreamConnection::withName(char const*)

long * __cdecl IOAccelTraceStreamConnection::withName(char *param_1)

{
  long lVar1;
  long *plVar2;
  char cVar3;
  int iVar4;
  long *plVar5;
  long *plVar6;
  char *pcVar7;
  
  cVar3 = _OSCompareAndSwapPtr(0,1,&gTraceStreamLock);
  if (cVar3 == '\0') {
    while (gTraceStreamLock == 1) {
      _thread_block(0);
    }
  }
  else {
    gTraceStreamLock = _IOLockAlloc();
  }
  _IOLockLock(gTraceStreamLock);
  plVar6 = gTraceStreamList;
  if (gTraceStreamInit != '\x01') {
    gTraceStreamList = (long *)0x0;
    DAT_000828e0 = (long *)&gTraceStreamList;
    gTraceStreamInit = '\x01';
    plVar6 = (long *)0x0;
  }
  do {
    plVar5 = plVar6;
    if (plVar5 == (long *)0x0) {
      plVar5 = (long *)(**(code **)(gMetaClass + 0x88))(&gMetaClass);
      if (plVar5 != (long *)0x0) {
        cVar3 = (**(code **)(*plVar5 + 0x118))(plVar5,param_1);
        if (cVar3 != '\0') goto LAB_00021d0b;
        (**(code **)(*plVar5 + 0x28))(plVar5);
      }
      plVar5 = (long *)0x0;
      goto LAB_00021d0b;
    }
    plVar6 = (long *)plVar5[4];
    iVar4 = _strncmp((char *)((long)plVar5 + 0x34),param_1,8);
  } while (iVar4 != 0);
  if ((plVar6 == (long *)0x0) || ((long *)plVar6[5] == plVar5 + 4)) {
    plVar6 = (long *)plVar5[5];
    if ((long *)*plVar6 == plVar5) {
      lVar1 = plVar5[4];
      plVar2 = plVar6;
      if (lVar1 != 0) {
        *(long **)(lVar1 + 0x28) = plVar6;
        plVar6 = (long *)plVar5[5];
        plVar2 = DAT_000828e0;
      }
      DAT_000828e0 = plVar2;
      *plVar6 = lVar1;
LAB_00021d0b:
      _IOLockUnlock(gTraceStreamLock);
      return plVar5;
    }
    pcVar7 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
  }
  else {
    pcVar7 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
  }
                    // WARNING: Subroutine does not return
  _panic(pcVar7,plVar5,0x4d,"IOAccelTraceStream.cpp",0x4d);
}



// IOAccelTraceStreamConnection::initWithName(char const*)

void __thiscall
IOAccelTraceStreamConnection::initWithName(IOAccelTraceStreamConnection *this,char *param_1)

{
  undefined8 uVar1;
  
  (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  uVar1 = _IOLockAlloc();
  *(undefined8 *)(this + 0x10) = uVar1;
  _strlcpy((char *)(this + 0x34),param_1,8);
  *(undefined4 *)(this + 0x30) = 0;
  registerCallback(this);
  return;
}



// IOAccelTraceStreamConnection::registerCallback()

undefined8 __thiscall
IOAccelTraceStreamConnection::registerCallback(IOAccelTraceStreamConnection *this)

{
  kd_callback_t callback;
  int iVar1;
  undefined4 extraout_var;
  char local_28 [8];
  long local_20;
  
  local_20 = *(long *)PTR____stack_chk_guard_0006b0b0;
  local_28 = (char  [8])&DAT_aaaaaaaaaaaaaaaa;
  _strlcpy(local_28,(char *)(this + 0x34),8);
  callback.context = this;
  callback.func = kTraceDebugCallback;
  callback.iop_name[0] = local_28[0];
  callback.iop_name[1] = local_28[1];
  callback.iop_name[2] = local_28[2];
  callback.iop_name[3] = local_28[3];
  callback.iop_name[4] = local_28[4];
  callback.iop_name[5] = local_28[5];
  callback.iop_name[6] = local_28[6];
  callback.iop_name[7] = local_28[7];
  iVar1 = _kernel_debug_register_callback(callback);
  *(int *)(this + 0x30) = iVar1;
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_20) {
    return CONCAT71((int7)(CONCAT44(extraout_var,iVar1) >> 8),iVar1 != 0);
  }
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// IOAccelTraceStreamConnection::flush()

void __thiscall IOAccelTraceStreamConnection::flush(IOAccelTraceStreamConnection *this)

{
  int iVar1;
  
  iVar1 = _IOLockTryLock(*(undefined8 *)(this + 0x10));
  if (iVar1 != 0) {
    if (*(long **)(this + 0x18) != (long *)0x0) {
      (**(code **)(**(long **)(this + 0x18) + 0x118))();
    }
    _IOLockUnlock(*(undefined8 *)(this + 0x10));
    return;
  }
  return;
}



// IOAccelTraceStreamConnection::free()

void IOAccelTraceStreamConnection::free(void)

{
  return;
}



// IOAccelTraceStreamConnection::orphan()

void __thiscall IOAccelTraceStreamConnection::orphan(IOAccelTraceStreamConnection *this)

{
  _IOLockLock(*(undefined8 *)(this + 0x10));
  *(undefined8 *)(this + 0x18) = 0;
  _IOLockUnlock(*(undefined8 *)(this + 0x10));
  _IOLockLock(gTraceStreamLock);
  *(undefined8 *)(this + 0x20) = 0;
  *(IOAccelTraceStreamConnection **)(this + 0x28) = DAT_000828e0;
  *(IOAccelTraceStreamConnection **)DAT_000828e0 = this;
  DAT_000828e0 = this + 0x20;
  _IOLockUnlock(gTraceStreamLock);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// kTraceDebugCallback(void*, kd_callback_type, void*)

void __cdecl kTraceDebugCallback(OSMetaClassBase *param_1,int param_2)

{
  IOAccelTraceStreamConnection *this;
  
  this = (IOAccelTraceStreamConnection *)
         OSMetaClassBase::safeMetaCast
                   (param_1,(OSMetaClass *)&IOAccelTraceStreamConnection::gMetaClass);
  if ((param_2 == 2) && (this != (IOAccelTraceStreamConnection *)0x0)) {
    IOAccelTraceStreamConnection::flush(this);
    return;
  }
  return;
}



// IOAccelTraceStream2::MetaClass::MetaClass()

void __thiscall IOAccelTraceStream2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelTraceStream2",(OSMetaClass *)PTR_gMetaClass_0006b068,0x60);
  *(undefined ***)this = &PTR__MetaClass_000775d8;
  return;
}



// IOAccelTraceStream2::MetaClass::~MetaClass()

void __thiscall IOAccelTraceStream2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelTraceStream2::IOAccelTraceStream2(OSMetaClass const*)

void __thiscall
IOAccelTraceStream2::IOAccelTraceStream2(IOAccelTraceStream2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelTraceStream2_00077458;
  return;
}



// IOAccelTraceStream2::~IOAccelTraceStream2()

void __thiscall IOAccelTraceStream2::~IOAccelTraceStream2(IOAccelTraceStream2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelTraceStream2::~IOAccelTraceStream2()

void __thiscall IOAccelTraceStream2::~IOAccelTraceStream2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelTraceStream2::~IOAccelTraceStream2()

void __thiscall IOAccelTraceStream2::~IOAccelTraceStream2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelTraceStream2::getMetaClass() const

undefined1 * IOAccelTraceStream2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelTraceStream2::MetaClass::MetaClass()

void __thiscall IOAccelTraceStream2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelTraceStream2",(OSMetaClass *)PTR_gMetaClass_0006b068,0x60);
  *(undefined ***)this = &PTR__MetaClass_000775d8;
  return;
}



// IOAccelTraceStream2::MetaClass::alloc() const

undefined8 IOAccelTraceStream2::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelTraceStream2::operator new(unsigned long)

void * __thiscall IOAccelTraceStream2::operator_new(IOAccelTraceStream2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelTraceStream2_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelTraceStream2::operator delete(void*, unsigned long)

void __cdecl IOAccelTraceStream2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelTraceStream2_ktv,param_1,param_2);
  return;
}



// IOAccelTraceStream2::init()

void __thiscall IOAccelTraceStream2::init(IOAccelTraceStream2 *this)

{
  (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  *(undefined4 *)(this + 0x18) = 0;
  registerCallback(this);
  return;
}



// IOAccelTraceStream2::registerCallback()

bool __thiscall IOAccelTraceStream2::registerCallback(IOAccelTraceStream2 *this)

{
  char *pcVar1;
  long *plVar2;
  
  pcVar1 = (char *)(**(code **)(*(long *)this + 0x120))();
  plVar2 = IOAccelTraceStreamConnection::withName(pcVar1);
  *(long **)(this + 0x10) = plVar2;
  if (plVar2 != (long *)0x0) {
    *(int *)(this + 0x18) = (int)plVar2[6];
  }
  return plVar2 != (long *)0x0;
}



// IOAccelTraceStream2::free()

void __thiscall IOAccelTraceStream2::free(IOAccelTraceStream2 *this)

{
  IOAccelTraceStreamConnection::orphan(*(IOAccelTraceStreamConnection **)(this + 0x10));
  *(undefined8 *)(this + 0x10) = 0;
                    // WARNING: Could not recover jumptable at 0x0002206e. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelTraceStream2::enter(unsigned int, unsigned long long, unsigned long, unsigned long,
// unsigned long, unsigned long, unsigned long)

void __thiscall
IOAccelTraceStream2::enter
          (IOAccelTraceStream2 *this,uint32_t param_1,ulong param_2,uintptr_t param_3,
          uintptr_t param_4,uintptr_t param_5,uintptr_t param_6,uintptr_t param_7)

{
  if (___ktrace_kernel_enabled != 0) {
    if (param_2 < ___ktrace_end_of_last_flush) {
      param_2 = ___ktrace_end_of_last_flush;
    }
    _kernel_debug_enter(*(uint32_t *)(this + 0x18),param_1,param_2,param_3,param_4,param_5,param_6,
                        param_7);
    return;
  }
  return;
}



// IOAccelTraceStream2::_RESERVEDIOAccelTraceStream0()

void IOAccelTraceStream2::_RESERVEDIOAccelTraceStream0(void)

{
  OSMetaClass::reservedCalled(0x823e0);
  return;
}



// IOAccelTraceStream2::_RESERVEDIOAccelTraceStream1()

void IOAccelTraceStream2::_RESERVEDIOAccelTraceStream1(void)

{
  OSMetaClass::reservedCalled(0x823e0);
  return;
}



// IOAccelTraceStream2::_RESERVEDIOAccelTraceStream2()

void IOAccelTraceStream2::_RESERVEDIOAccelTraceStream2(void)

{
  OSMetaClass::reservedCalled(0x823e0);
  return;
}



// IOAccelTraceStream2::_RESERVEDIOAccelTraceStream3()

void IOAccelTraceStream2::_RESERVEDIOAccelTraceStream3(void)

{
  OSMetaClass::reservedCalled(0x823e0);
  return;
}



// IOAccelTraceStream2::_RESERVEDIOAccelTraceStream4()

void IOAccelTraceStream2::_RESERVEDIOAccelTraceStream4(void)

{
  OSMetaClass::reservedCalled(0x823e0);
  return;
}



// IOAccelTraceStream2::_RESERVEDIOAccelTraceStream5()

void IOAccelTraceStream2::_RESERVEDIOAccelTraceStream5(void)

{
  OSMetaClass::reservedCalled(0x823e0);
  return;
}



// IOAccelTraceStream2::_RESERVEDIOAccelTraceStream6()

void IOAccelTraceStream2::_RESERVEDIOAccelTraceStream6(void)

{
  OSMetaClass::reservedCalled(0x823e0);
  return;
}



// IOAccelTraceStream2::_RESERVEDIOAccelTraceStream7()

void IOAccelTraceStream2::_RESERVEDIOAccelTraceStream7(void)

{
  OSMetaClass::reservedCalled(0x823e0);
  return;
}



// IOAccelTraceStreamConnection::MetaClass::~MetaClass()

void __thiscall IOAccelTraceStreamConnection::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelTraceStream2::MetaClass::~MetaClass()

void __thiscall IOAccelTraceStream2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelTraceStream_cpp(void)

{
  undefined *puVar1;
  
  puVar1 = PTR_gMetaClass_0006b068;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelTraceStreamConnection::gMetaClass,"IOAccelTraceStreamConnection"
             ,(OSMetaClass *)PTR_gMetaClass_0006b068,0x40);
  IOAccelTraceStreamConnection::gMetaClass = &PTR__MetaClass_00077360;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelTraceStream2::gMetaClass,"IOAccelTraceStream2",
             (OSMetaClass *)puVar1,0x60);
  _gMetaClass = &PTR__MetaClass_000775d8;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelTraceStream2::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelTraceStreamConnection::gMetaClass);
  return;
}



// IOAccelResource2::MetaClass::MetaClass()

void __thiscall IOAccelResource2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelResource2",(OSMetaClass *)PTR_gMetaClass_0006b068,0x180);
  *(undefined ***)this = &PTR__MetaClass_00077960;
  return;
}



// IOAccelResource2::MetaClass::~MetaClass()

void __thiscall IOAccelResource2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelResource2::IOAccelResource2(OSMetaClass const*)

void __thiscall IOAccelResource2::IOAccelResource2(IOAccelResource2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelResource2_000776d0;
  return;
}



// IOAccelResource2::~IOAccelResource2()

void __thiscall IOAccelResource2::~IOAccelResource2(IOAccelResource2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelResource2::~IOAccelResource2()

void __thiscall IOAccelResource2::~IOAccelResource2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelResource2::~IOAccelResource2()

void __thiscall IOAccelResource2::~IOAccelResource2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelResource2::getMetaClass() const

undefined1 * IOAccelResource2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelResource2::MetaClass::MetaClass()

void __thiscall IOAccelResource2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelResource2",(OSMetaClass *)PTR_gMetaClass_0006b068,0x180);
  *(undefined ***)this = &PTR__MetaClass_00077960;
  return;
}



// IOAccelResource2::MetaClass::alloc() const

undefined8 IOAccelResource2::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelResource2::operator new(unsigned long)

void * __thiscall IOAccelResource2::operator_new(IOAccelResource2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelResource2_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::operator delete(void*, unsigned long)

void __cdecl IOAccelResource2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelResource2_ktv,param_1,param_2);
  return;
}



// IOAccelResource2::init(IOGraphicsAccelerator2*, IOAccelShared2*, unsigned int)

ulong __thiscall
IOAccelResource2::init(IOAccelResource2 *this,long param_2,long param_3,IOAccelResource2 param_4)

{
  uint uVar1;
  long *plVar2;
  ulonglong uVar3;
  uint uVar4;
  undefined8 uVar5;
  ulong uVar6;
  long lVar7;
  uint local_2c;
  
  (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  uVar5 = _OSAddAtomic64(1,&___globalObjectIDCounter);
  *(undefined8 *)(this + 0x110) = uVar5;
  local_2c = 0;
  *(long *)(this + 0x18) = param_2;
  *(undefined8 *)(this + 0x98) = 0xffffffff00000000;
  *(undefined4 *)(this + 0xa0) = 0;
  *(undefined8 *)(this + 0x28) = 0x100000000;
  *(undefined8 *)(this + 0x58) = 0;
  *(undefined8 *)(this + 0x178) = 0;
  *(undefined2 *)(this + 0xac) = 0x101;
  this[0xae] = (IOAccelResource2)0x0;
  *(undefined4 *)(this + 0xb0) = 0;
  *(undefined8 *)(this + 0xb8) = 0;
  *(undefined8 *)(this + 0xc0) = 0;
  *(undefined8 *)(this + 200) = 0;
  *(undefined8 *)(this + 0xd0) = 0;
  *(undefined2 *)(this + 0xd8) = 0;
  *(undefined8 *)(this + 0x170) = 0;
  uVar1 = *(uint *)(this + 0xc);
  uVar4 = uVar1 | 0x100;
  *(uint *)(this + 0xc) = uVar4;
  if ((*(byte *)(param_2 + 0xc9c) & 4) == 0) {
    uVar4 = uVar1 | 0x8000100;
    *(uint *)(this + 0xc) = uVar4;
  }
  if ((*(byte *)(param_2 + 0xc92) & 0x20) == 0) {
    *(uint *)(this + 0xc) = uVar4 | 0x10000;
  }
  *(undefined8 *)(this + 0x88) = 0;
  *(undefined8 *)(this + 0x80) = 0;
  *(undefined8 *)(this + 0x40) = 0;
  *(undefined4 *)(this + 0x108) = 0;
  *(undefined8 *)(this + 0x60) = 0;
  *(undefined8 *)(this + 0x38) = 0;
  *(undefined8 *)(this + 0x30) = 0;
  if (param_3 == 0) {
    *(undefined8 *)(this + 0x68) = 0;
  }
  else {
    plVar2 = *(long **)(param_3 + 0x20);
    *(long **)(this + 0x68) = plVar2;
    (**(code **)(*plVar2 + 0x20))();
  }
  this[0x14] = param_4;
  *(undefined8 *)(this + 0x48) = 0;
  *(undefined8 *)(this + 0x50) = 0;
  *(undefined8 *)(this + 0xe0) = 0;
  *(undefined8 *)(this + 0xe8) = 0;
  *(undefined8 *)(this + 0xf0) = 0;
  *(undefined8 *)(this + 0xf8) = 0;
  *(undefined8 *)(this + 0x100) = 0;
  *(undefined2 *)(this + 0xb4) = 0;
  switch((byte)param_4 & 0xf) {
  case 0:
    if (((byte)param_4 & 0x40) != 0) goto switchD_00022459_caseD_1;
    *(undefined2 *)(this + 0x15) = 0x100;
    break;
  case 1:
  case 4:
  case 10:
switchD_00022459_caseD_1:
    *(undefined2 *)(this + 0x15) = 0x302;
    break;
  case 2:
    *(undefined2 *)(this + 0x15) = 0xffff;
  }
  if (*(IOAccelNamespace **)(this + 0x68) == (IOAccelNamespace *)0x0) {
    uVar6 = IOAccelNamespace::allocId
                      (*(IOAccelNamespace **)(*(long *)(this + 0x18) + 0xc80),this,&local_2c);
    if ((char)uVar6 != '\0') {
      lVar7 = (**(code **)(**(long **)(this + 0x18) + 0x890))();
      *(long *)(this + 0x38) = lVar7;
      if (lVar7 != 0) {
        lVar7 = (**(code **)(**(long **)(this + 0x18) + 0x898))();
        *(long *)(this + 0x30) = lVar7;
        if (lVar7 != 0) goto LAB_0002250e;
      }
    }
  }
  else {
    uVar6 = IOAccelNamespace::allocId(*(IOAccelNamespace **)(this + 0x68),this,&local_2c);
    if ((char)uVar6 == '\0') {
      uVar6 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Couldn\'t allocate object_handle\n\n",
                        "virtual bool IOAccelResource2::init(IOGraphicsAccelerator2 *, IOAccelShared2 *, uint32_t)"
                       );
      goto LAB_000225aa;
    }
    uVar6 = IOAccelSharedNamespace2::mapClientSharedForId
                      (*(IOAccelSharedNamespace2 **)(this + 0x68),local_2c,(long *)(this + 0x38),
                       (long *)(this + 0x30));
    if ((char)uVar6 != '\0') {
      lVar7 = *(long *)(this + 0x30);
LAB_0002250e:
      (**(code **)(*(long *)this + 0x148))(this,*(undefined8 *)(this + 0x38),lVar7);
      *(uint *)(*(long *)(this + 0x38) + 0x100) = local_2c;
      lVar7 = *(long *)(this + 0x18);
      uVar3 = *(ulonglong *)(*(long *)(lVar7 + 0x388) + 0x58);
      if (this[0x14] == (IOAccelResource2)0xa) {
        IOSimpleReporter::incrementValue(uVar3,0x29);
        *(int *)(lVar7 + 0x244) = *(int *)(lVar7 + 0x244) + 1;
      }
      else {
        IOSimpleReporter::incrementValue(uVar3,0x11);
        *(int *)(lVar7 + 0x1e4) = *(int *)(lVar7 + 0x1e4) + 1;
      }
      uVar6 = CONCAT71((int7)((ulong)lVar7 >> 8),1);
      goto LAB_000225aa;
    }
    IOAccelNamespace::freeId(*(IOAccelNamespace **)(this + 0x68),local_2c);
  }
  uVar6 = 0;
LAB_000225aa:
  return uVar6 & 0xffffffff;
}



// IOAccelResource2::initClientShared(IOAccelClientSharedRO*, IOAccelClientSharedRW*)

void __thiscall IOAccelResource2::initClientShared(IOAccelResource2 *this,long param_1,long param_2)

{
  long lVar1;
  
  lVar1 = 0;
  do {
    (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x140))
              (*(long **)(*(long *)(this + 0x18) + 0x380),param_1 + lVar1);
    lVar1 = lVar1 + 0x40;
  } while (lVar1 != 0x100);
  lVar1 = -6;
  do {
    *(undefined2 *)(param_2 + 0xc + lVar1 * 2) = 0;
    *(undefined2 *)(param_2 + 0x18 + lVar1 * 2) = 0;
    lVar1 = lVar1 + 1;
  } while (lVar1 != 0);
  *(undefined4 *)(param_2 + 0x18) = 0;
  *(undefined2 *)(param_2 + 0x1c) = 0;
  *(uint *)(param_1 + 0x104) = (uint)(byte)this[0x14];
  return;
}



// IOAccelResource2::termClientShared(IOAccelClientSharedRO*, IOAccelClientSharedRW*)

void IOAccelResource2::termClientShared(void)

{
  return;
}



// IOAccelResource2::free()

void __thiscall IOAccelResource2::free(IOAccelResource2 *this)

{
  byte *pbVar1;
  IOAccelResource2 IVar2;
  uintptr_t arg1;
  long *plVar3;
  IOAccelSurface *this_00;
  long *plVar4;
  long lVar5;
  ulonglong uVar6;
  uint uVar7;
  uintptr_t arg2;
  char *pcVar8;
  int *piVar9;
  IOAccelResource2 *pIVar10;
  
  arg1 = *(uintptr_t *)(this + 0x110);
  arg2 = IORegistryEntry::getRegistryEntryID();
  _kernel_debug(0x85020040,arg1,arg2,0,0,0);
  uVar7 = *(uint *)(this + 0xc);
  if ((uVar7 & 2) != 0) {
    free();
    return;
  }
  if (*(long **)(this + 0x170) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x170) + 0x28))();
    *(undefined8 *)(this + 0x170) = 0;
    uVar7 = *(uint *)(this + 0xc);
  }
  if ((uVar7 & 4) != 0) {
    IOAccelResourceList::removeResource
              ((IOAccelResourceList *)(*(long *)(this + 0x18) + 0xb00),(long)this);
  }
  if (*(long *)(this + 0x178) != 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: still locked by kernel. memory might leak\n",
                      "virtual void IOAccelResource2::free()");
  }
  if (*(long *)(this + 0x58) != 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: still locked by user process. application might crash\n",
                      "virtual void IOAccelResource2::free()");
    (**(code **)(**(long **)(this + 0x58) + 0x28))();
    *(undefined8 *)(this + 0x58) = 0;
    (**(code **)(*(long *)this + 0x200))(this);
    (**(code **)(**(long **)(this + 0x88) + 0x150))();
  }
  if (*(IOAccelMemoryMap **)(this + 0x40) != (IOAccelMemoryMap *)0x0) {
    IOAccelMemoryMap::remove_resource(*(IOAccelMemoryMap **)(this + 0x40),(long)this);
    (**(code **)(**(long **)(this + 0x40) + 0x28))();
    *(undefined8 *)(this + 0x40) = 0;
    *(undefined8 *)(this + 0x70) = 0;
    *(undefined8 *)(this + 0x20) = 0;
    this[0xe] = (IOAccelResource2)((byte)this[0xe] & 0xef);
  }
  IVar2 = this[0x14];
  if (((byte)IVar2 & 0xf) == 0) {
    plVar3 = *(long **)(this + 0x88);
    if (plVar3 != (long *)0x0) {
      plVar3[7] = 0;
      (**(code **)(*plVar3 + 0x28))();
      *(undefined8 *)(this + 0x88) = 0;
    }
    if (*(long *)(this + 0x80) != 0) {
      pbVar1 = (byte *)(*(long *)(this + 0x80) + 0xc);
      *pbVar1 = *pbVar1 | 1;
      plVar3 = *(long **)(this + 0x80);
      plVar3[7] = 0;
      (**(code **)(*plVar3 + 0x28))();
      *(undefined8 *)(this + 0x80) = 0;
    }
    goto LAB_00022945;
  }
  if ((byte)IVar2 < 10) {
    if (IVar2 == (IOAccelResource2)0x1) {
      this_00 = *(IOAccelSurface **)(this + 0xf0);
      if (this_00 != (IOAccelSurface *)0x0) {
        IOAccelSurface::remove_texture(this_00,(long)this);
        if (((byte)this[0xc] & 8) == 0) {
          (**(code **)(*(long *)this_00 + 0x9e8))(this_00);
          (**(code **)(*(long *)this_00 + 0x9e0))(this_00);
        }
      }
    }
    else if (IVar2 == (IOAccelResource2)0x4) {
      (**(code **)(**(long **)(this + 0xe8) + 0x28))();
      *(undefined8 *)(this + 0xe8) = 0;
    }
    goto LAB_00022945;
  }
  if (IVar2 != (IOAccelResource2)0x82) {
    if ((IVar2 == (IOAccelResource2)0xa) &&
       (plVar3 = *(long **)(this + 0x88), plVar3 != (long *)0x0)) {
      plVar3[7] = 0;
      (**(code **)(*plVar3 + 0x28))();
      *(undefined8 *)(this + 0x88) = 0;
    }
    goto LAB_00022945;
  }
  plVar3 = *(long **)(this + 0xe0);
  if (plVar3 == (long *)0x0) goto LAB_00022945;
  plVar4 = (long *)plVar3[0x1c];
  lVar5 = *(long *)(this + 0xe8);
  if (lVar5 == 0) {
    if ((IOAccelResource2 *)**(long **)(this + 0xf0) != this) {
LAB_00022a8a:
      pcVar8 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_00022a9a:
                    // WARNING: Subroutine does not return
      _panic(pcVar8,this,0x14d,"IOAccelResource.cpp",0x14d);
    }
    plVar3[0x1e] = (long)*(long **)(this + 0xf0);
  }
  else {
    if (*(IOAccelResource2 **)(lVar5 + 0xf0) != this + 0xe8) {
      pcVar8 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
      goto LAB_00022a9a;
    }
    if ((IOAccelResource2 *)**(long **)(this + 0xf0) != this) goto LAB_00022a8a;
    *(long **)(lVar5 + 0xf0) = *(long **)(this + 0xf0);
  }
  **(undefined8 **)(this + 0xf0) = *(undefined8 *)(this + 0xe8);
  (**(code **)(*plVar4 + 0x28))();
  (**(code **)(*plVar3 + 0x28))(plVar3);
LAB_00022945:
  if (((byte)this[0xf] & 4) != 0) {
    IOGraphicsAccelerator2::audit_freed_resource
              (*(IOGraphicsAccelerator2 **)(this + 0x18),(long)this);
  }
  if (*(long *)(this + 0x90) != 0) {
    *(undefined8 *)(this + 0x90) = 0;
    _IOFreeTypeImpl(&free()::kalloc_type_view_377);
  }
  if ((*(long *)(this + 0x38) != 0) && (*(long *)(this + 0x30) != 0)) {
    (**(code **)(*(long *)this + 0x150))(this);
    uVar7 = *(uint *)(*(long *)(this + 0x38) + 0x100);
    if (*(IOAccelSharedNamespace2 **)(this + 0x68) == (IOAccelSharedNamespace2 *)0x0) {
      pIVar10 = (IOAccelResource2 *)(*(long *)(this + 0x18) + 0xc80);
    }
    else {
      pIVar10 = this + 0x68;
      IOAccelSharedNamespace2::unmapClientSharedForId
                (*(IOAccelSharedNamespace2 **)(this + 0x68),uVar7);
      *(undefined8 *)(this + 0x38) = 0;
      *(undefined8 *)(this + 0x30) = 0;
    }
    IOAccelNamespace::freeId(*(IOAccelNamespace **)pIVar10,uVar7);
  }
  if (*(long **)(this + 0x68) == (long *)0x0) {
    if (*(long *)(this + 0x38) != 0) {
      (**(code **)(**(long **)(this + 0x18) + 0x8a0))();
      *(undefined8 *)(this + 0x38) = 0;
    }
    if (*(long *)(this + 0x30) != 0) {
      (**(code **)(**(long **)(this + 0x18) + 0x8a8))();
      *(undefined8 *)(this + 0x30) = 0;
    }
  }
  else {
    (**(code **)(**(long **)(this + 0x68) + 0x28))();
  }
  lVar5 = *(long *)(this + 0x18);
  uVar6 = *(ulonglong *)(*(long *)(lVar5 + 0x388) + 0x58);
  if (this[0x14] == (IOAccelResource2)0xa) {
    IOSimpleReporter::incrementValue(uVar6,0x29);
    piVar9 = (int *)(lVar5 + 0x244);
  }
  else {
    IOSimpleReporter::incrementValue(uVar6,0x11);
    piVar9 = (int *)(lVar5 + 0x1e4);
  }
  *piVar9 = *piVar9 + -1;
                    // WARNING: Could not recover jumptable at 0x00022a84. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelResource2::unmap()

void __thiscall IOAccelResource2::unmap(IOAccelResource2 *this)

{
  IOAccelMemoryMap::remove_resource(*(IOAccelMemoryMap **)(this + 0x40),(long)this);
  (**(code **)(**(long **)(this + 0x40) + 0x28))();
  *(undefined8 *)(this + 0x40) = 0;
  *(undefined8 *)(this + 0x70) = 0;
  *(undefined8 *)(this + 0x20) = 0;
  this[0xe] = (IOAccelResource2)((byte)this[0xe] & 0xef);
  return;
}



// IOAccelResource2::sharedRelease(IOAccelShared2*)

void __thiscall IOAccelResource2::sharedRelease(IOAccelResource2 *this,IOAccelShared2 *param_1)

{
  uint uVar1;
  undefined8 uVar2;
  long lVar3;
  IOAccelResource2 *local_28;
  
  uVar1 = *(uint *)(*(long *)(this + 0x38) + 0x100);
  local_28 = (IOAccelResource2 *)&DAT_aaaaaaaaaaaaaaaa;
  uVar2 = IOAccelNamespace::lookupId(*(IOAccelNamespace **)(this + 0x68),uVar1,(long *)&local_28);
  if (((char)uVar2 != '\0') && (local_28 == this)) {
    IOAccelNamespace::invalidateId(*(IOAccelNamespace **)(this + 0x68),(long)this,uVar1);
    this[0xc] = (IOAccelResource2)((byte)this[0xc] & 0xfd);
    lVar3 = getResidentSize(this);
    IOAccelShared2::decrement_allocated_size(param_1,lVar3);
    IOAccelResourceList::removeResource((IOAccelResourceList *)(param_1 + 0xa0),(long)this);
    if (*(long **)(this + 0x168) != (long *)0x0) {
      (**(code **)(**(long **)(this + 0x168) + 0x28))();
      *(undefined8 *)(this + 0x168) = 0;
    }
    if ((((byte)this[0x14] & 0xf) == 0) && (*(long **)(this + 0x60) != (long *)0x0)) {
      (**(code **)(**(long **)(this + 0x60) + 0x28))();
      *(undefined8 *)(this + 0x60) = 0;
    }
    (**(code **)(*(long *)this + 0x28))(this);
  }
  return;
}



// IOAccelResource2::getResidentSize()

undefined8 __thiscall IOAccelResource2::getResidentSize(IOAccelResource2 *this)

{
  IOAccelResource2 IVar1;
  undefined8 uVar2;
  IOAccelResource2 *pIVar3;
  
  for (; IVar1 = this[0x14], IVar1 == (IOAccelResource2)0x82;
      this = *(IOAccelResource2 **)(this + 0xe0)) {
  }
  if (((byte)IVar1 & 0xf) == 0) {
    if (((byte)IVar1 & 0x40) == 0) {
LAB_00022be9:
      pIVar3 = this + 0xd0;
    }
    else {
LAB_00022c12:
      pIVar3 = this + 200;
    }
LAB_00022c2e:
    uVar2 = *(undefined8 *)pIVar3;
  }
  else {
    if (IVar1 == (IOAccelResource2)0x1) {
      if ((*(long *)(this + 0xf0) != 0) &&
         (this = *(IOAccelResource2 **)
                  (&DAT_000011c0 + (long)*(int *)(this + 0x100) * 8 + *(long *)(this + 0xf0)),
         this != (IOAccelResource2 *)0x0)) goto LAB_00022c12;
    }
    else {
      if (IVar1 == (IOAccelResource2)0x4) {
        pIVar3 = (IOAccelResource2 *)(*(long *)(this + 0xe8) + 200);
        goto LAB_00022c2e;
      }
      if (IVar1 == (IOAccelResource2)0xa) goto LAB_00022be9;
    }
    uVar2 = 0;
  }
  return uVar2;
}



// IOAccelResource2::databuffer_release(IOAccelShared2*)

void __thiscall IOAccelResource2::databuffer_release(IOAccelResource2 *this,IOAccelShared2 *param_1)

{
  uint uVar1;
  undefined8 uVar2;
  long lVar3;
  IOAccelResource2 *local_28;
  
  uVar1 = *(uint *)(*(long *)(this + 0x38) + 0x100);
  local_28 = (IOAccelResource2 *)&DAT_aaaaaaaaaaaaaaaa;
  if (*(long **)(this + 0x60) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x60) + 0x28))();
    *(undefined8 *)(this + 0x60) = 0;
  }
  uVar2 = IOAccelNamespace::lookupId(*(IOAccelNamespace **)(this + 0x68),uVar1,(long *)&local_28);
  if (((char)uVar2 != '\0') && (local_28 == this)) {
    IOAccelNamespace::invalidateId(*(IOAccelNamespace **)(this + 0x68),(long)this,uVar1);
    this[0xc] = (IOAccelResource2)((byte)this[0xc] & 0xfd);
    lVar3 = getResidentSize(this);
    IOAccelShared2::decrement_allocated_size(param_1,lVar3);
    IOAccelResourceList::removeResource((IOAccelResourceList *)(param_1 + 0xa0),(long)this);
    (**(code **)(*(long *)this + 0x28))(this);
  }
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::newResourceWithClientBuffer(IOGraphicsAccelerator2*, IOAccelShared2*,
// eIOAccelResType, unsigned long long, unsigned long long, unsigned long long, unsigned long long,
// unsigned long long*)

IOAccelResource2 * __cdecl
IOAccelResource2::newResourceWithClientBuffer
          (long *param_1,IOAccelShared2 *param_2,ulong param_3,long param_4,long param_5,
          ulong param_6,undefined8 param_7,undefined8 *param_8)

{
  undefined8 uVar1;
  uintptr_t arg2;
  uint uVar2;
  IOAccelShared2 *pIVar3;
  IOAccelResource2 *this;
  IOAccelSysMemory *pIVar4;
  long lVar5;
  uintptr_t arg1;
  ulong uVar6;
  ulong uVar7;
  uintptr_t arg1_00;
  
  if (((param_4 == 0) || (param_5 == 0)) || (param_6 == 0)) {
    this = (IOAccelResource2 *)0x0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: invalid arguments\n",
                      "static IOAccelResource2 *IOAccelResource2::newResourceWithClientBuffer(IOGraphicsAccelerator2 *, IOAccelShared2 *, enum eIOAccelResType, IOByteCount, mach_vm_address_t, mach_vm_address_t, IOByteCount, mach_vm_address_t *)"
                     );
  }
  else {
    pIVar3 = (IOAccelShared2 *)PTR__kernel_task_0006b100;
    if (param_2 != (IOAccelShared2 *)0x0) {
      pIVar3 = param_2 + 0x80;
    }
    uVar1 = *(undefined8 *)pIVar3;
    this = (IOAccelResource2 *)(**(code **)(*param_1 + 0x8d0))(param_1,param_2);
    if (this == (IOAccelResource2 *)0x0) {
      this = (IOAccelResource2 *)0x0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: createResource failed\n",
                        "static IOAccelResource2 *IOAccelResource2::newResourceWithClientBuffer(IOGraphicsAccelerator2 *, IOAccelShared2 *, enum eIOAccelResType, IOByteCount, mach_vm_address_t, mach_vm_address_t, IOByteCount, mach_vm_address_t *)"
                       );
    }
    else {
      lVar5 = *(long *)PTR__page_size_0006b108;
      uVar6 = -lVar5 & param_6;
      uVar7 = ((ulong)((uint)param_6 & (int)lVar5 - 1U) + param_4 + lVar5) - 1 & -lVar5;
      if (param_2 == (IOAccelShared2 *)0x0) {
        pIVar4 = (IOAccelSysMemory *)IOAccelSysMemory::withClientBuffer(param_1,uVar1,0,uVar6,uVar7)
        ;
      }
      else {
        pIVar4 = IOAccelShared2::memory_with_client_buffer(param_2,uVar6,uVar7);
      }
      *(IOAccelSysMemory **)(this + 0x80) = pIVar4;
      if (pIVar4 == (IOAccelSysMemory *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: fSysMemory is NULL.\n",
                          "static IOAccelResource2 *IOAccelResource2::newResourceWithClientBuffer(IOGraphicsAccelerator2 *, IOAccelShared2 *, enum eIOAccelResType, IOByteCount, mach_vm_address_t, mach_vm_address_t, IOByteCount, mach_vm_address_t *)"
                         );
        (**(code **)(*(long *)this + 0x28))(this);
        this = (IOAccelResource2 *)0x0;
      }
      else {
        pIVar4[0xc] = (IOAccelSysMemory)((byte)pIVar4[0xc] | 1);
        *(undefined8 *)(this + 0x60) = 0;
        *(ulong *)(this + 0xf8) = param_5 - uVar6;
        *(undefined8 *)(this + 200) = param_7;
        *(ulong *)(this + 0xd0) = uVar7;
        if (param_2 == (IOAccelShared2 *)0x0) {
          *(uint *)(this + 0xc) = *(uint *)(this + 0xc) | 4;
          IOAccelResourceList::addResource((IOAccelResourceList *)(param_1 + 0x160),(long)this);
        }
        else {
          *(uint *)(this + 0xc) = *(uint *)(this + 0xc) | 2;
          IOAccelResourceList::addResource((IOAccelResourceList *)(param_2 + 0xa0),(long)this);
          lVar5 = getResidentSize(this);
          IOAccelShared2::increment_allocated_size(param_2,lVar5);
        }
        if (param_8 != (undefined8 *)0x0) {
          *param_8 = 0;
        }
        if (param_2 == (IOAccelShared2 *)0x0) {
          arg1 = 0;
        }
        else {
          arg1 = *(uintptr_t *)(param_2 + 0x30);
        }
        arg2 = *(uintptr_t *)(this + 0x110);
        uVar2 = IORegistryEntry::getRegistryEntryID();
        arg1_00 = 0;
        _kernel_debug(0x8502001c,arg1,arg2,(ulong)uVar2 | param_3 << 0x20,
                      *(uintptr_t *)(this + (ulong)((param_3 & 0x40) == 0) * 8 + 200),0);
        if (param_2 != (IOAccelShared2 *)0x0) {
          arg1_00 = *(uintptr_t *)(param_2 + 0x30);
        }
        _kernel_debug(0x850200e0,arg1_00,*(uintptr_t *)(this + 0x110),*(uintptr_t *)(this + 0xd0),
                      *(uintptr_t *)(this + 200),0);
      }
    }
  }
  return this;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::newResourceWithOptions(IOGraphicsAccelerator2*, IOAccelShared2*,
// eIOAccelResType, unsigned long long, unsigned int, unsigned long long, unsigned long long*)

void __cdecl
IOAccelResource2::newResourceWithOptions
          (IOGraphicsAccelerator2 *param_1,IOAccelShared2 *param_2,ulong param_3,long param_4,
          uint param_5,undefined8 param_6,long *param_7)

{
  newResourceWithOptions(param_1,param_2,param_3,0,param_4,param_5,param_6,param_7,0);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::newResourceWithOptions(IOGraphicsAccelerator2*, IOAccelShared2*,
// eIOAccelResType, unsigned long long, unsigned long long, unsigned int, unsigned long long,
// unsigned long long*, IOAccelNewResourceArgs*)

IOAccelResource2 * __cdecl
IOAccelResource2::newResourceWithOptions
          (IOGraphicsAccelerator2 *param_1,IOAccelShared2 *param_2,ulong param_3,long param_4,
          long param_5,uint param_6,undefined8 param_7,long *param_8,long param_9)

{
  IOAccelResource2 IVar1;
  ulonglong uVar2;
  long lVar3;
  uintptr_t arg2;
  char cVar4;
  uint uVar5;
  IOAccelResource2 *this;
  OSMetaClassBase *this_00;
  long *plVar6;
  uintptr_t arg1;
  long lVar7;
  IOAccelShared2 *pIVar8;
  ulong uVar9;
  ulong uVar10;
  uintptr_t arg1_00;
  ulong uVar11;
  byte bVar12;
  bool bVar13;
  
  if (param_5 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: invalid arguments\n",
                      "static IOAccelResource2 *IOAccelResource2::newResourceWithOptions(IOGraphicsAccelerator2 *, IOAccelShared2 *, enum eIOAccelResType, uint64_t, IOByteCount, IOOptionBits, IOByteCount, mach_vm_address_t *, IOAccelNewResourceArgs *)"
                     );
    return (IOAccelResource2 *)0x0;
  }
  pIVar8 = param_2 + 0x80;
  if (param_2 == (IOAccelShared2 *)0x0) {
    pIVar8 = (IOAccelShared2 *)PTR__kernel_task_0006b100;
  }
  uVar2 = *(ulonglong *)pIVar8;
  if (param_9 == 0) {
    lVar7 = 0;
  }
  else {
    uVar11 = *(ulong *)(param_9 + 0x30);
    lVar7 = 0;
    if ((uVar11 != 0) && (*(long *)(param_9 + 0x38) != 0)) {
      lVar3 = *(long *)PTR__page_size_0006b108;
      uVar10 = -lVar3;
      uVar9 = uVar11 & uVar10;
      lVar7 = uVar11 - uVar9;
      param_5 = *(long *)(param_9 + 0x38) + lVar7;
      *(ulong *)(param_9 + 0x30) = uVar9;
      *(ulong *)(param_9 + 0x38) = (lVar3 + param_5) - 1U & uVar10;
    }
  }
  lVar3 = *(long *)PTR__page_size_0006b108;
  this = (IOAccelResource2 *)(**(code **)(*(long *)param_1 + 0x8d0))(param_1,param_2);
  if (this == (IOAccelResource2 *)0x0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: createResource failed\n",
                      "static IOAccelResource2 *IOAccelResource2::newResourceWithOptions(IOGraphicsAccelerator2 *, IOAccelShared2 *, enum eIOAccelResType, uint64_t, IOByteCount, IOOptionBits, IOByteCount, mach_vm_address_t *, IOAccelNewResourceArgs *)"
                     );
    return (IOAccelResource2 *)0x0;
  }
  uVar11 = -lVar3 & (param_5 + lVar3) - 1U;
  bVar12 = (byte)(param_6 >> 0x10);
  if (((param_2 == (IOAccelShared2 *)0x0) || (param_4 != 0)) ||
     ((*(uint *)(param_1 + 0xc90) & 0x4000000) == 0)) {
    bVar13 = param_4 == 0;
    bVar12 = bVar12 & 1 & param_2 != (IOAccelShared2 *)0x0 & bVar13;
    this_00 = (OSMetaClassBase *)
              IOAccelSysMemory::withOptions(param_1,uVar2,(long)param_2,0,param_6,uVar11);
    if (this_00 == (OSMetaClassBase *)0x0) {
LAB_0002339c:
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: IOAccelSysMemory::withOptions failed\n",
                        "static IOAccelResource2 *IOAccelResource2::newResourceWithOptions(IOGraphicsAccelerator2 *, IOAccelShared2 *, enum eIOAccelResType, uint64_t, IOByteCount, IOOptionBits, IOByteCount, mach_vm_address_t *, IOAccelNewResourceArgs *)"
                       );
      goto LAB_000233c4;
    }
LAB_00023150:
    if (((byte)((IOAccelMemory *)this_00)[0xd] & 0x80) != 0) {
      this[0xe] = (IOAccelResource2)((byte)this[0xe] | 8);
    }
  }
  else {
    this_00 = (OSMetaClassBase *)
              (**(code **)(*(long *)(param_1 + 0xb60) + 0x10))(param_1 + 0xb60,param_2,0);
    if (this_00 == (OSMetaClassBase *)0x0) {
      bVar12 = bVar12 & 1;
      this_00 = (OSMetaClassBase *)
                IOAccelSysMemory::withOptions(param_1,uVar2,(long)param_2,0,param_6,uVar11);
      if (this_00 == (OSMetaClassBase *)0x0) goto LAB_0002339c;
      IOAccelMemory::setFlags((IOAccelMemory *)this_00,1);
      bVar13 = true;
      if ((((byte)param_1[0xc93] & 8) != 0) && (((byte)param_2[0x28] & 1) != 0)) {
        IOAccelMemory::setFlags((IOAccelMemory *)this_00,2);
      }
      goto LAB_00023150;
    }
    this[0xe] = (IOAccelResource2)((byte)this[0xe] | 8);
    bVar12 = bVar12 & 1;
    bVar13 = true;
  }
  *(OSMetaClassBase **)(this + 0x80) = this_00;
  this_00[0xc] = (OSMetaClassBase)((byte)this_00[0xc] | 1);
  if ((((param_3 & 0x40) == 0) && (param_2 != (IOAccelShared2 *)0x0)) &&
     (param_1[0xccd] != (IOGraphicsAccelerator2)0x0)) {
    cVar4 = (**(code **)(*(long *)this_00 + 0x148))(this_00);
    if ((cVar4 == '\0') &&
       (uVar9 = IOGraphicsAccelerator2::freeToPrepareMemory(param_1,this_00), (char)uVar9 == '\0'))
    {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to prepare\n",
                        "static IOAccelResource2 *IOAccelResource2::newResourceWithOptions(IOGraphicsAccelerator2 *, IOAccelShared2 *, enum eIOAccelResType, uint64_t, IOByteCount, IOOptionBits, IOByteCount, mach_vm_address_t *, IOAccelNewResourceArgs *)"
                       );
      return (IOAccelResource2 *)0x0;
    }
    (**(code **)(*(long *)this_00 + 0x150))(this_00);
  }
  if (bVar12 == 0) {
    plVar6 = (long *)0x0;
  }
  else {
    plVar6 = (long *)IOMemoryDescriptor::createMappingInTask
                               (*(task **)(*(long *)(this + 0x80) + 0xd0),
                                *(ulonglong *)(param_2 + 0x80),0,1,0);
    if (plVar6 == (long *)0x0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to create client map\n",
                        "static IOAccelResource2 *IOAccelResource2::newResourceWithOptions(IOGraphicsAccelerator2 *, IOAccelShared2 *, enum eIOAccelResType, uint64_t, IOByteCount, IOOptionBits, IOByteCount, mach_vm_address_t *, IOAccelNewResourceArgs *)"
                       );
LAB_000233c4:
      (**(code **)(*(long *)this + 0x28))(this);
      return (IOAccelResource2 *)0x0;
    }
  }
  *(long *)(this + 0x158) = param_4;
  if (!bVar13) {
    this[0xf] = (IOAccelResource2)((byte)this[0xf] | 0x80);
  }
  *(long *)(this + 0xf8) = lVar7;
  *(long **)(this + 0x60) = plVar6;
  *(undefined8 *)(this + 200) = param_7;
  *(ulong *)(this + 0xd0) = uVar11;
  if (param_2 == (IOAccelShared2 *)0x0) {
    *(uint *)(this + 0xc) = *(uint *)(this + 0xc) | 4;
    IOAccelResourceList::addResource((IOAccelResourceList *)(param_1 + 0xb00),(long)this);
  }
  else {
    *(uint *)(this + 0xc) = *(uint *)(this + 0xc) | 2;
    IOAccelResourceList::addResource((IOAccelResourceList *)(param_2 + 0xa0),(long)this);
    lVar7 = getResidentSize(this);
    IOAccelShared2::increment_allocated_size(param_2,lVar7);
  }
  if (param_8 == (long *)0x0) goto LAB_00023417;
  if (plVar6 == (long *)0x0) {
    lVar7 = 0;
  }
  else {
    lVar7 = (**(code **)(*plVar6 + 0x118))(plVar6);
    IVar1 = this[0x14];
    if (IVar1 == (IOAccelResource2)0x0) {
LAB_00023318:
      uVar11 = *(ulong *)(this + 0xf8);
    }
    else if (IVar1 == (IOAccelResource2)0x82) {
      uVar11 = (ulong)*(uint *)(this + 0xfc);
    }
    else {
      if (IVar1 == (IOAccelResource2)0x80) goto LAB_00023318;
      uVar11 = 0;
    }
    lVar7 = uVar11 + lVar7;
  }
  *param_8 = lVar7;
LAB_00023417:
  if (param_2 == (IOAccelShared2 *)0x0) {
    arg1 = 0;
  }
  else {
    arg1 = *(uintptr_t *)(param_2 + 0x30);
  }
  arg2 = *(uintptr_t *)(this + 0x110);
  uVar5 = IORegistryEntry::getRegistryEntryID();
  arg1_00 = 0;
  _kernel_debug(0x8502001c,arg1,arg2,(ulong)uVar5 | param_3 << 0x20,
                *(uintptr_t *)(this + (ulong)((param_3 & 0x40) == 0) * 8 + 200),0);
  if (param_2 != (IOAccelShared2 *)0x0) {
    arg1_00 = *(uintptr_t *)(param_2 + 0x30);
  }
  _kernel_debug(0x850200e0,arg1_00,*(uintptr_t *)(this + 0x110),*(uintptr_t *)(this + 0xd0),
                *(uintptr_t *)(this + 200),0);
  return this;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::newResourceWithParentResourceID(IOGraphicsAccelerator2*, IOAccelShared2*,
// eIOAccelResType, unsigned long long, unsigned long long, unsigned long long, unsigned long long,
// unsigned long long, unsigned long long*, unsigned int)

IOAccelResource2 * __cdecl
IOAccelResource2::newResourceWithParentResourceID
          (long *param_1,IOAccelShared2 *param_2,uint param_3,long param_4,long param_5,long param_6
          ,ulong param_7,undefined8 param_8,undefined8 *param_9,uint param_10)

{
  long *plVar1;
  uintptr_t uVar2;
  undefined4 uVar3;
  IOAccelResource2 *this;
  undefined8 uVar4;
  long lVar5;
  long lVar6;
  ulong uVar7;
  uintptr_t arg1;
  IOAccelResource2 *local_40;
  uintptr_t local_38;
  
  if (param_10 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: parent_resource_id is 0\n",
                      "static IOAccelResource2 *IOAccelResource2::newResourceWithParentResourceID(IOGraphicsAccelerator2 *, IOAccelShared2 *, enum eIOAccelResType, uint64_t, IOByteCount, mach_vm_address_t, mach_vm_address_t, IOByteCount, mach_vm_address_t *, uint32_t)"
                     );
    return (IOAccelResource2 *)0x0;
  }
  if ((param_3 & 0xffffffbf) == 0x80) {
    if (((param_5 == 0) || (param_6 == 0)) || (param_7 == 0)) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: invalid arguments\n",
                        "static IOAccelResource2 *IOAccelResource2::newResourceWithParentResourceID(IOGraphicsAccelerator2 *, IOAccelShared2 *, enum eIOAccelResType, uint64_t, IOByteCount, mach_vm_address_t, mach_vm_address_t, IOByteCount, mach_vm_address_t *, uint32_t)"
                       );
      return (IOAccelResource2 *)0x0;
    }
  }
  else {
    if ((param_3 & 0xffffffbf) != 0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: failing. parent_resource_id only works with standard texture. resType=0x%x.\n"
                        ,
                        "static IOAccelResource2 *IOAccelResource2::newResourceWithParentResourceID(IOGraphicsAccelerator2 *, IOAccelShared2 *, enum eIOAccelResType, uint64_t, IOByteCount, mach_vm_address_t, mach_vm_address_t, IOByteCount, mach_vm_address_t *, uint32_t)"
                        ,param_3);
      return (IOAccelResource2 *)0x0;
    }
    if (param_5 == 0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: invalid arguments\n",
                        "static IOAccelResource2 *IOAccelResource2::newResourceWithParentResourceID(IOGraphicsAccelerator2 *, IOAccelShared2 *, enum eIOAccelResType, uint64_t, IOByteCount, mach_vm_address_t, mach_vm_address_t, IOByteCount, mach_vm_address_t *, uint32_t)"
                       );
      return (IOAccelResource2 *)0x0;
    }
  }
  lVar6 = *(long *)PTR__page_size_0006b108;
  local_38 = param_4;
  this = (IOAccelResource2 *)(**(code **)(*param_1 + 0x8d0))(param_1,param_2,param_3);
  if (this == (IOAccelResource2 *)0x0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: createResource failed\n",
                      "static IOAccelResource2 *IOAccelResource2::newResourceWithParentResourceID(IOGraphicsAccelerator2 *, IOAccelShared2 *, enum eIOAccelResType, uint64_t, IOByteCount, mach_vm_address_t, mach_vm_address_t, IOByteCount, mach_vm_address_t *, uint32_t)"
                     );
    return (IOAccelResource2 *)0x0;
  }
  local_40 = (IOAccelResource2 *)0x0;
  if ((param_2 == (IOAccelShared2 *)0x0) ||
     (*(IOAccelNamespace **)(param_2 + 0x20) == (IOAccelNamespace *)0x0)) {
    if (((IOAccelNamespace *)param_1[400] != (IOAccelNamespace *)0x0) &&
       (uVar4 = IOAccelNamespace::lookupId
                          ((IOAccelNamespace *)param_1[400],param_10,(long *)&local_40),
       (char)uVar4 == '\0')) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: failed to lookup parent resource from accelerator.\n",
                        "static IOAccelResource2 *IOAccelResource2::newResourceWithParentResourceID(IOGraphicsAccelerator2 *, IOAccelShared2 *, enum eIOAccelResType, uint64_t, IOByteCount, mach_vm_address_t, mach_vm_address_t, IOByteCount, mach_vm_address_t *, uint32_t)"
                       );
      goto LAB_000237e1;
    }
  }
  else {
    uVar4 = IOAccelNamespace::lookupId
                      (*(IOAccelNamespace **)(param_2 + 0x20),param_10,(long *)&local_40);
    if ((char)uVar4 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: failed to lookup parent resource from shared.\n",
                        "static IOAccelResource2 *IOAccelResource2::newResourceWithParentResourceID(IOGraphicsAccelerator2 *, IOAccelShared2 *, enum eIOAccelResType, uint64_t, IOByteCount, mach_vm_address_t, mach_vm_address_t, IOByteCount, mach_vm_address_t *, uint32_t)"
                       );
      goto LAB_000237e1;
    }
  }
  lVar5 = getProtectionOptions(local_40);
  uVar2 = local_38;
  if (lVar5 == local_38) {
    if ((((byte)local_40[0x14] & 0x7f) == 0) &&
       (plVar1 = *(long **)(local_40 + 0x80), plVar1 != (long *)0x0)) {
      uVar7 = -lVar6;
      *(long **)(this + 0x80) = plVar1;
      (**(code **)(*plVar1 + 0x20))();
      *(uintptr_t *)(this + 0x158) = uVar2;
      if (uVar2 != 0) {
        this[0xf] = (IOAccelResource2)((byte)this[0xf] | 0x80);
      }
      *(undefined8 *)(this + 0x60) = 0;
      *(ulong *)(this + 0xf8) = param_6 - (param_7 & uVar7);
      *(undefined8 *)(this + 200) = param_8;
      *(ulong *)(this + 0xd0) = uVar7 & (param_5 + lVar6) - 1U;
      if (param_2 == (IOAccelShared2 *)0x0) {
        *(uint *)(this + 0xc) = *(uint *)(this + 0xc) | 4;
        IOAccelResourceList::addResource((IOAccelResourceList *)(param_1 + 0x160),(long)this);
      }
      else {
        *(uint *)(this + 0xc) = *(uint *)(this + 0xc) | 2;
        IOAccelResourceList::addResource((IOAccelResourceList *)(param_2 + 0xa0),(long)this);
        lVar6 = getResidentSize(this);
        IOAccelShared2::increment_allocated_size(param_2,lVar6);
      }
      if (param_9 != (undefined8 *)0x0) {
        *param_9 = 0;
      }
      if (param_2 == (IOAccelShared2 *)0x0) {
        local_38 = 0;
      }
      else {
        local_38 = *(uintptr_t *)(param_2 + 0x30);
      }
      uVar2 = *(uintptr_t *)(this + 0x110);
      uVar3 = IORegistryEntry::getRegistryEntryID();
      arg1 = 0;
      _kernel_debug(0x8502001c,local_38,uVar2,CONCAT44(param_3,uVar3),
                    *(uintptr_t *)(this + (ulong)((param_3 & 0x40) == 0) * 8 + 200),0);
      if (param_2 != (IOAccelShared2 *)0x0) {
        arg1 = *(uintptr_t *)(param_2 + 0x30);
      }
      _kernel_debug(0x850200e0,arg1,*(uintptr_t *)(this + 0x110),*(uintptr_t *)(this + 0xd0),
                    *(uintptr_t *)(this + 200),0);
      return this;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: parent resource type mismatch.\n",
                      "static IOAccelResource2 *IOAccelResource2::newResourceWithParentResourceID(IOGraphicsAccelerator2 *, IOAccelShared2 *, enum eIOAccelResType, uint64_t, IOByteCount, mach_vm_address_t, mach_vm_address_t, IOByteCount, mach_vm_address_t *, uint32_t)"
                     );
  }
LAB_000237e1:
  (**(code **)(*(long *)this + 0x28))(this);
  return (IOAccelResource2 *)0x0;
}



// IOAccelResource2::getProtectionOptions() const

undefined8 __thiscall IOAccelResource2::getProtectionOptions(IOAccelResource2 *this)

{
  undefined8 uVar1;
  
  for (; this[0x14] == (IOAccelResource2)0x82; this = *(IOAccelResource2 **)(this + 0xe0)) {
  }
  if ((((byte)this[0x14] & 0xf) == 0) && (*(long *)(this + 0xe0) != 0)) {
    uVar1 = IOSurface::getProtectionOptions();
    return uVar1;
  }
  return *(undefined8 *)(this + 0x158);
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::newResourceWithIOSurfaceDeviceCache(IOGraphicsAccelerator2*,
// IOSurfaceDeviceCache*)

long * __cdecl
IOAccelResource2::newResourceWithIOSurfaceDeviceCache(IOGraphicsAccelerator2 *param_1,long param_2)

{
  undefined1 uVar1;
  uintptr_t arg2;
  char cVar2;
  undefined4 uVar3;
  long *plVar4;
  long *plVar5;
  OSMetaClassBase *pOVar6;
  long lVar7;
  ulong uVar8;
  
  uVar3 = (**(code **)(*(long *)param_1 + 0x900))();
  plVar4 = (long *)(**(code **)(*(long *)param_1 + 0x8d0))(param_1,0,uVar3);
  if (plVar4 == (long *)0x0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: allocIOAccelResource failed to alloc texture object\n",
                      "static IOAccelResource2 *IOAccelResource2::newResourceWithIOSurfaceDeviceCache(IOGraphicsAccelerator2 *, IOSurfaceDeviceCache *)"
                     );
    return (long *)0x0;
  }
  plVar5 = (long *)IOSurface::getMemoryDescriptor();
  pOVar6 = (OSMetaClassBase *)IOAccelSysMemory::withMemoryDescriptor((long *)param_1,0,plVar5);
  if (pOVar6 == (OSMetaClassBase *)0x0) {
LAB_00023b12:
    (**(code **)(*plVar4 + 0x28))(plVar4);
    plVar4 = (long *)0x0;
  }
  else {
    plVar4[0x10] = (long)pOVar6;
    lVar7 = (**(code **)(*(long *)pOVar6 + 0x120))(pOVar6);
    plVar4[0x1a] = lVar7;
    *(byte *)((long)plVar4 + 0xe) = *(byte *)((long)plVar4 + 0xe) | 0x20;
    cVar2 = IOSurface::isDisplayable();
    if (cVar2 != '\0') {
      *(byte *)((long)plVar4 + 0xe) = *(byte *)((long)plVar4 + 0xe) & 0xfe;
    }
    pOVar6[0xc] = (OSMetaClassBase)((byte)pOVar6[0xc] | 1);
    if ((param_1[0xccd] != (IOGraphicsAccelerator2)0x0) &&
       ((*(byte *)((long)plVar4 + 0x14) & 0x40) == 0)) {
      cVar2 = (**(code **)(*(long *)pOVar6 + 0x148))(pOVar6);
      if ((cVar2 == '\0') &&
         (uVar8 = IOGraphicsAccelerator2::freeToPrepareMemory(param_1,pOVar6), (char)uVar8 == '\0'))
      {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to prepare\n",
                          "static IOAccelResource2 *IOAccelResource2::newResourceWithIOSurfaceDeviceCache(IOGraphicsAccelerator2 *, IOSurfaceDeviceCache *)"
                         );
        goto LAB_00023b12;
      }
      (**(code **)(*(long *)pOVar6 + 0x150))(pOVar6);
    }
    plVar4[0x1c] = param_2;
    plVar4[0x1d] = 0;
    plVar4[0x1e] = (long)(plVar4 + 0x1d);
    plVar4[0x1f] = 0;
    if (*(char *)((long)plVar4 + 0x14) == -0x40) {
      (**(code **)(*plVar4 + 0x1f0))(plVar4,plVar4 + 0x19,plVar4 + 0x17);
    }
    *(byte *)((long)plVar4 + 0xc) = *(byte *)((long)plVar4 + 0xc) | 4;
    IOAccelResourceList::addResource((IOAccelResourceList *)(param_1 + 0xb00),(long)plVar4);
    lVar7 = IOSurface::getProtectionOptions();
    plVar4[0x2b] = lVar7;
    if (lVar7 != 0) {
      *(byte *)((long)plVar4 + 0xf) = *(byte *)((long)plVar4 + 0xf) | 0x80;
    }
    lVar7 = plVar4[0x19];
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(param_1 + 0x388) + 0x58),9);
    *(int *)(param_1 + 0x1c4) = *(int *)(param_1 + 0x1c4) + (int)lVar7;
    arg2 = plVar4[0x22];
    uVar1 = *(undefined1 *)((long)plVar4 + 0x14);
    uVar3 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x8502001c,0,arg2,(ulong)CONCAT14(uVar1,uVar3),
                  plVar4[(ulong)((*(byte *)((long)plVar4 + 0x14) & 0x40) == 0) + 0x19],0);
    _kernel_debug(0x850200e0,0,plVar4[0x22],plVar4[0x1a],plVar4[0x19],0);
  }
  return plVar4;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::newResourceWithIOSurface(IOGraphicsAccelerator2*, IOAccelShared2*, IOSurface*,
// unsigned int, unsigned int)

IOAccelResource2 * __cdecl
IOAccelResource2::newResourceWithIOSurface
          (IOGraphicsAccelerator2 *param_1,IOAccelShared2 *param_2,void *param_3,undefined4 param_4)

{
  IOAccelResource2 IVar1;
  uintptr_t arg2;
  int iVar2;
  int iVar3;
  uint uVar4;
  long lVar5;
  long *plVar6;
  IOAccelResource2 *this;
  uintptr_t arg1;
  
  lVar5 = IOSurface::getProtectionOptions();
  if ((lVar5 == 0) || (((byte)param_2[0x28] & 2) != 0)) {
    plVar6 = IOGraphicsAccelerator2::deviceCacheForIOSurface(param_1,param_3);
    if (plVar6 == (long *)0x0) {
      this = (IOAccelResource2 *)0x0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to create a device cache\n"
                        ,
                        "static IOAccelResource2 *IOAccelResource2::newResourceWithIOSurface(IOGraphicsAccelerator2 *, IOAccelShared2 *, IOSurface *, uint32_t, uint32_t)"
                       );
    }
    else {
      this = (IOAccelResource2 *)(**(code **)(*(long *)param_1 + 0x8d0))(param_1,param_2,0x82);
      if (this == (IOAccelResource2 *)0x0) {
        this = (IOAccelResource2 *)0x0;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: allocIOAccelResource failed to alloc texture object\n",
                          "static IOAccelResource2 *IOAccelResource2::newResourceWithIOSurface(IOGraphicsAccelerator2 *, IOAccelShared2 *, IOSurface *, uint32_t, uint32_t)"
                         );
        (**(code **)(*plVar6 + 0x28))(plVar6);
      }
      else {
        plVar6 = (long *)plVar6[4];
        IVar1 = *(IOAccelResource2 *)((long)plVar6 + 0x15);
        this[0x15] = IVar1;
        this[0x16] = *(IOAccelResource2 *)((long)plVar6 + 0x16);
        if ((*(byte *)((long)plVar6 + 0x14) & 0x7f) == 0) {
          (**(code **)(**(long **)(param_1 + 0x380) + 0x1b0))
                    (*(long **)(param_1 + 0x380),
                     (ulong)*(byte *)((long)plVar6 + 0x15) * 0x40 + plVar6[7],
                     (ulong)(byte)IVar1 * 0x40 + *(long *)(this + 0x38));
          (**(code **)(**(long **)(param_1 + 0x380) + 0x1b0))
                    (*(long **)(param_1 + 0x380),
                     (ulong)*(byte *)((long)plVar6 + 0x16) * 0x40 + plVar6[7],
                     (ulong)(byte)this[0x16] * 0x40 + *(long *)(this + 0x38));
        }
        *(uint *)(this + 0xc) =
             *(uint *)(this + 0xc) & 0x7fffffff | *(uint *)((long)plVar6 + 0xc) & 0x80000000;
        *(long *)(this + 0x158) = plVar6[0x2b];
        *(long **)(this + 0xe0) = plVar6;
        *(undefined4 *)(this + 0xf8) = param_4;
        iVar2 = IOSurface::getClientAlignedOffset();
        iVar3 = IOSurface::getPlaneOffset((uint)param_3);
        *(int *)(this + 0xfc) = iVar3 + iVar2;
        (**(code **)(*plVar6 + 0x20))(plVar6);
        this[0xc] = (IOAccelResource2)((byte)this[0xc] | 2);
        IOAccelResourceList::addResource((IOAccelResourceList *)(param_2 + 0xa0),(long)this);
        lVar5 = getResidentSize(this);
        IOAccelShared2::increment_allocated_size(param_2,lVar5);
        *(undefined8 *)(this + 0xe8) = 0;
        *(long *)(this + 0xf0) = plVar6[0x1e];
        *(IOAccelResource2 **)plVar6[0x1e] = this;
        plVar6[0x1e] = (long)(this + 0xe8);
        if (param_2 == (IOAccelShared2 *)0x0) {
          arg1 = 0;
        }
        else {
          arg1 = *(uintptr_t *)(param_2 + 0x30);
        }
        arg2 = *(uintptr_t *)(this + 0x110);
        uVar4 = IORegistryEntry::getRegistryEntryID();
        _kernel_debug(0x8502001c,arg1,arg2,(ulong)uVar4 | 0x8200000000,0,0);
        _kernel_debug(0x850200e0,0,*(uintptr_t *)(this + 0x110),0,0,0);
      }
    }
  }
  else {
    this = (IOAccelResource2 *)0x0;
  }
  return this;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::newResourceWithSurface(IOGraphicsAccelerator2*, IOAccelShared2*, unsigned int,
// eIOAccelGLBufferType)

IOAccelResource2 * __cdecl
IOAccelResource2::newResourceWithSurface
          (long *param_1,IOAccelShared2 *param_2,int param_3,int param_4)

{
  IOAccelSurface *this;
  undefined8 uVar1;
  IOAccelResource2 *pIVar2;
  
  this = (IOAccelSurface *)
         IOAccelSurfaceList::findSurfaceForID((IOAccelSurfaceList *)(param_1 + 0x155),param_3);
  if (this == (IOAccelSurface *)0x0) {
    pIVar2 = (IOAccelResource2 *)0x0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: surface ID 0x%X not found\n",
                      "static IOAccelResource2 *IOAccelResource2::newResourceWithSurface(IOGraphicsAccelerator2 *, IOAccelShared2 *, uint32_t, eIOAccelGLBufferType)"
                      ,param_3);
  }
  else {
    uVar1 = IOAccelSurface::convertGLIndexToBufferIndex(this,param_4);
    if ((int)uVar1 == 0xffff) {
      pIVar2 = (IOAccelResource2 *)0x0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: invalid surface buffer index %d\n"
                        ,
                        "static IOAccelResource2 *IOAccelResource2::newResourceWithSurface(IOGraphicsAccelerator2 *, IOAccelShared2 *, uint32_t, eIOAccelGLBufferType)"
                        ,param_4);
    }
    else {
      pIVar2 = newResourceWithSurface(param_1,param_2,this,(int)uVar1);
      if (pIVar2 == (IOAccelResource2 *)0x0) {
        pIVar2 = (IOAccelResource2 *)0x0;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: allocIOAccelResource failed to alloc texture object\n",
                          "static IOAccelResource2 *IOAccelResource2::newResourceWithSurface(IOGraphicsAccelerator2 *, IOAccelShared2 *, uint32_t, eIOAccelGLBufferType)"
                         );
      }
      else if (*(int *)(pIVar2 + 0x100) != 0xffff) {
        pIVar2[0xc] = (IOAccelResource2)((byte)pIVar2[0xc] & 0xf7);
        (**(code **)(*(long *)this + 0x9e8))(this);
        (**(code **)(*(long *)this + 0x9e0))(this);
        (**(code **)(*(long *)this + 0x9d8))(this);
      }
    }
  }
  return pIVar2;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::newResourceWithSurface(IOGraphicsAccelerator2*, IOAccelShared2*,
// IOAccelSurface*, unsigned int)

IOAccelResource2 * __cdecl
IOAccelResource2::newResourceWithSurface
          (long *param_1,IOAccelShared2 *param_2,IOAccelSurface *param_3,int param_4)

{
  IOAccelNamespace *this;
  uintptr_t uVar1;
  char cVar2;
  uint uVar3;
  IOAccelResource2 *pIVar4;
  undefined8 uVar5;
  long lVar6;
  uintptr_t uVar7;
  undefined1 *local_40;
  int local_38;
  uint local_34;
  
  if ((param_2 != (IOAccelShared2 *)0x0) &&
     (pIVar4 = (IOAccelResource2 *)
               IOAccelSurface::get_surfaceref_texture(param_3,(long)param_2,param_4),
     pIVar4 != (IOAccelResource2 *)0x0)) {
    this = *(IOAccelNamespace **)(pIVar4 + 0x68);
    if (this == (IOAccelNamespace *)0x0) {
      return pIVar4;
    }
    local_34 = *(uint *)(*(long *)(pIVar4 + 0x38) + 0x100);
    local_40 = &DAT_aaaaaaaaaaaaaaaa;
    local_38 = param_4;
    uVar5 = IOAccelNamespace::lookupId(this,local_34,(long *)&local_40);
    if ((char)uVar5 != '\0') {
      return pIVar4;
    }
    cVar2 = IOAccelNamespace::resurrectId(this,local_34,(long)pIVar4);
    if (cVar2 != '\0') {
      pIVar4[0xc] = (IOAccelResource2)((byte)pIVar4[0xc] | 2);
      IOAccelResourceList::addResource((IOAccelResourceList *)(param_2 + 0xa0),(long)pIVar4);
      lVar6 = getResidentSize(pIVar4);
      IOAccelShared2::increment_allocated_size(param_2,lVar6);
      (**(code **)(*(long *)pIVar4 + 0x20))(pIVar4);
      return pIVar4;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Couldn\'t resurrect object_handle\n\n");
    param_4 = local_38;
  }
  pIVar4 = (IOAccelResource2 *)(**(code **)(*param_1 + 0x8d0))(param_1,param_2,1);
  if (pIVar4 == (IOAccelResource2 *)0x0) {
    pIVar4 = (IOAccelResource2 *)0x0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: allocIOAccelResource failed to alloc texture object\n",
                      "static IOAccelResource2 *IOAccelResource2::newResourceWithSurface(IOGraphicsAccelerator2 *, IOAccelShared2 *, IOAccelSurface *, uint32_t)"
                     );
  }
  else {
    *(IOAccelSurface **)(pIVar4 + 0xf0) = param_3;
    *(int *)(pIVar4 + 0x100) = param_4;
    *(undefined4 *)(pIVar4 + 0x104) = *(undefined4 *)(param_3 + 0x1168);
    pIVar4[0xc] = (IOAccelResource2)((byte)pIVar4[0xc] | 2);
    IOAccelResourceList::addResource((IOAccelResourceList *)(param_2 + 0xa0),(long)pIVar4);
    lVar6 = getResidentSize(pIVar4);
    IOAccelShared2::increment_allocated_size(param_2,lVar6);
    IOAccelSurface::add_texture(param_3,(long)pIVar4);
    pIVar4[0xc] = (IOAccelResource2)((byte)pIVar4[0xc] | 8);
    if (param_2 == (IOAccelShared2 *)0x0) {
      uVar1 = *(uintptr_t *)(pIVar4 + 0x110);
      uVar3 = IORegistryEntry::getRegistryEntryID();
      uVar7 = 0;
      _kernel_debug(0x8502001c,0,uVar1,(ulong)uVar3 | 0x100000000,0,0);
    }
    else {
      uVar7 = *(uintptr_t *)(param_2 + 0x30);
      uVar1 = *(uintptr_t *)(pIVar4 + 0x110);
      uVar3 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x8502001c,uVar7,uVar1,(ulong)uVar3 | 0x100000000,0,0);
      uVar7 = *(uintptr_t *)(param_2 + 0x30);
    }
    _kernel_debug(0x850200e0,uVar7,*(uintptr_t *)(pIVar4 + 0x110),0,0,0);
  }
  return pIVar4;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::newResourceWithSurfaceBufferIndex(IOGraphicsAccelerator2*, IOAccelShared2*,
// unsigned int, unsigned int)

IOAccelResource2 * __cdecl
IOAccelResource2::newResourceWithSurfaceBufferIndex
          (long *param_1,IOAccelShared2 *param_2,int param_3,uint param_4)

{
  uintptr_t uVar1;
  uint uVar2;
  long lVar3;
  undefined8 uVar4;
  IOAccelResource2 *this;
  long lVar5;
  uintptr_t uVar6;
  long *local_38;
  
  lVar3 = IOAccelSurfaceList::findSurfaceForID((IOAccelSurfaceList *)(param_1 + 0x155),param_3);
  if (lVar3 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: surface ID 0x%X not found\n",
                      "static IOAccelResource2 *IOAccelResource2::newResourceWithSurfaceBufferIndex(IOGraphicsAccelerator2 *, IOAccelShared2 *, uint32_t, uint32_t)"
                      ,param_3);
  }
  else {
    local_38 = (long *)&DAT_aaaaaaaaaaaaaaaa;
    uVar4 = IOAccelNamespace::lookupId((IOAccelNamespace *)param_1[400],param_4,(long *)&local_38);
    if ((char)uVar4 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: surface ID 0x%X not found\n",
                        "static IOAccelResource2 *IOAccelResource2::newResourceWithSurfaceBufferIndex(IOGraphicsAccelerator2 *, IOAccelShared2 *, uint32_t, uint32_t)"
                        ,param_3);
    }
    else {
      lVar5 = 0;
      do {
        if (*(long **)(&DAT_000011c0 + lVar5 * 8 + lVar3) == local_38) {
          this = (IOAccelResource2 *)(**(code **)(*param_1 + 0x8d0))(param_1,param_2,4);
          if (this != (IOAccelResource2 *)0x0) {
            *(uint *)(this + 0xe0) = *(uint *)((long)&DAT_000011b0 + lVar3) & 0xf;
            *(long **)(this + 0xe8) = local_38;
            (**(code **)(*local_38 + 0x20))();
            this[0xc] = (IOAccelResource2)((byte)this[0xc] | 2);
            IOAccelResourceList::addResource((IOAccelResourceList *)(param_2 + 0xa0),(long)this);
            lVar3 = getResidentSize(this);
            IOAccelShared2::increment_allocated_size(param_2,lVar3);
            if (param_2 == (IOAccelShared2 *)0x0) {
              uVar1 = *(uintptr_t *)(this + 0x110);
              uVar2 = IORegistryEntry::getRegistryEntryID();
              uVar6 = 0;
              _kernel_debug(0x8502001c,0,uVar1,(ulong)uVar2 | 0x400000000,0,0);
            }
            else {
              uVar6 = *(uintptr_t *)(param_2 + 0x30);
              uVar1 = *(uintptr_t *)(this + 0x110);
              uVar2 = IORegistryEntry::getRegistryEntryID();
              _kernel_debug(0x8502001c,uVar6,uVar1,(ulong)uVar2 | 0x400000000,0,0);
              uVar6 = *(uintptr_t *)(param_2 + 0x30);
            }
            _kernel_debug(0x850200e0,uVar6,*(uintptr_t *)(this + 0x110),0,0,0);
            return this;
          }
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: allocIOAccelResource failed to alloc texture object\n",
                            "static IOAccelResource2 *IOAccelResource2::newResourceWithSurfaceBufferIndex(IOGraphicsAccelerator2 *, IOAccelShared2 *, uint32_t, uint32_t)"
                           );
          return (IOAccelResource2 *)0x0;
        }
        lVar5 = lVar5 + 1;
      } while (lVar5 != 0x20);
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: can not find buffer 0x%x in the surface 0x%x\n",
                        "static IOAccelResource2 *IOAccelResource2::newResourceWithSurfaceBufferIndex(IOGraphicsAccelerator2 *, IOAccelShared2 *, uint32_t, uint32_t)"
                        ,param_4,param_3);
    }
  }
  return (IOAccelResource2 *)0x0;
}



// IOAccelResource2::getResourceInfo(IOAccelGetResourceInfoReturnData*, unsigned int*)

bool __thiscall
IOAccelResource2::getResourceInfo(IOAccelResource2 *this,uint *param_1,undefined4 *param_2)

{
  IOAccelResource2 IVar1;
  IOAccelResource2 *pIVar2;
  
  IVar1 = this[0x14];
  if (IVar1 == (IOAccelResource2)0x4) {
    pIVar2 = getStorageResource(this);
    *param_1 = (uint)*(ushort *)(pIVar2 + 0xb0);
    *(undefined2 *)(param_1 + 1) = *(undefined2 *)(pIVar2 + 0xb2);
    *(undefined2 *)((long)param_1 + 6) = *(undefined2 *)(pIVar2 + 0xb4);
    *(undefined8 *)(param_1 + 2) = *(undefined8 *)(pIVar2 + 200);
    *(undefined8 *)(param_1 + 4) = *(undefined8 *)(pIVar2 + 0xb8);
    *(undefined8 *)(param_1 + 6) = *(undefined8 *)(pIVar2 + 0xc0);
    *(IOAccelResource2 *)(param_1 + 8) = pIVar2[0xac];
    *(IOAccelResource2 *)((long)param_1 + 0x21) = pIVar2[0xad];
    *(IOAccelResource2 *)((long)param_1 + 0x22) = pIVar2[0xae];
    *(IOAccelResource2 *)((long)param_1 + 0x23) = pIVar2[0xd8];
    *(IOAccelResource2 *)(param_1 + 9) = this[0xe0];
    *param_2 = 0x30;
  }
  return IVar1 == (IOAccelResource2)0x4;
}



// IOAccelResource2::getStorageResource()

IOAccelResource2 * __thiscall IOAccelResource2::getStorageResource(IOAccelResource2 *this)

{
  IOAccelResource2 IVar1;
  IOAccelSurface *this_00;
  
  IVar1 = this[0x14];
  if (((((byte)IVar1 & 0xf) != 0) && (IVar1 != (IOAccelResource2)0xa)) &&
     (IVar1 != (IOAccelResource2)0x3)) {
    if (IVar1 == (IOAccelResource2)0x1) {
      this_00 = *(IOAccelSurface **)(this + 0xf0);
      if (this_00 == (IOAccelSurface *)0x0) {
        this_00 = (IOAccelSurface *)
                  IOAccelSurfaceList::findSurfaceForID
                            ((IOAccelSurfaceList *)(*(long *)(this + 0x18) + 0xaa8),
                             *(int *)(this + 0x104));
        *(IOAccelSurface **)(this + 0xf0) = this_00;
        if (this_00 == (IOAccelSurface *)0x0) {
          return (IOAccelResource2 *)0x0;
        }
        IOAccelSurface::add_texture(this_00,(long)this);
      }
      this = *(IOAccelResource2 **)
              (this_00 + (long)(&DAT_000011c0 + (long)*(int *)(this + 0x100) * 8));
    }
    else if (IVar1 == (IOAccelResource2)0x4) {
      this = *(IOAccelResource2 **)(this + 0xe8);
    }
    else if (IVar1 == (IOAccelResource2)0x82) {
      this = *(IOAccelResource2 **)(this + 0xe0);
    }
    else {
      this = (IOAccelResource2 *)0x0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: bad resType 0x%x\n",
                        "IOAccelResource2 *IOAccelResource2::getStorageResource()");
    }
  }
  return this;
}



// IOAccelResource2::initSurfaceBuffer(IOAccelSurface*, unsigned int, unsigned int, unsigned int,
// unsigned int, unsigned int)

ulong __thiscall
IOAccelResource2::initSurfaceBuffer
          (IOAccelResource2 *this,long param_1,undefined2 param_2,undefined2 param_4_00,uint param_4
          ,uint param_5,undefined2 param_6)

{
  undefined8 uVar1;
  char cVar2;
  undefined8 unaff_RBX;
  ulong uVar3;
  
  this[0xf] = (IOAccelResource2)((byte)this[0xf] | 4);
  *(undefined2 *)(this + 0xb0) = param_2;
  *(undefined2 *)(this + 0xb2) = param_4_00;
  *(undefined2 *)(this + 0xb4) = 1;
  uVar1 = *(undefined8 *)((long)&DAT_000011b0 + param_1);
  this[0xac] = (IOAccelResource2)((((uint)uVar1 & 0x700000) == 0x300000) * '\x05' + '\x01');
  this[0xad] = (IOAccelResource2)(((byte)((ulong)uVar1 >> 0x10) & 0xf) + 1);
  *(undefined2 *)(this + 0xd8) = param_6;
  *(ulong *)(this + 200) = (ulong)param_4;
  *(ulong *)(this + 0xb8) = (ulong)param_5;
  *(ulong *)(this + 0xd0) = (ulong)param_4;
  *(ulong *)(this + 0xc0) = (ulong)param_5;
  if (param_4 == 0) {
    uVar3 = 0;
  }
  else {
    cVar2 = (**(code **)(*(long *)this + 0x120))(this,0);
    uVar3 = CONCAT71((int7)((ulong)unaff_RBX >> 8),1);
    if (cVar2 == '\0') {
      uVar3 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: fail to allocate fVidMemory\n",
                        "virtual bool IOAccelResource2::initSurfaceBuffer(IOAccelSurface *, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t)"
                       );
    }
  }
  return uVar3 & 0xffffffff;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::newResourceWithRemoteStorage(IOGraphicsAccelerator2*, IOAccelShared2*, unsigned
// int, unsigned int)

IOAccelResource2 * __cdecl
IOAccelResource2::newResourceWithRemoteStorage
          (long *param_1,IOAccelShared2 *param_2,uint param_3,uint param_4)

{
  uint uVar1;
  char cVar2;
  ulong uVar3;
  IOAccelShared2 *this;
  IOAccelResource2 *this_00;
  long lVar4;
  long *plVar5;
  IOAccelResource2 *local_38;
  
  if ((param_2 != (IOAccelShared2 *)0x0) &&
     (uVar3 = IOAccelShared2::lockPeer(param_2,param_3), (int)uVar3 == 0)) {
    this = (IOAccelShared2 *)IOAccelShared2::getLockedPeer(param_2,param_3);
    if (this == (IOAccelShared2 *)0x0) {
      newResourceWithRemoteStorage();
      return (IOAccelResource2 *)0x0;
    }
    local_38 = (IOAccelResource2 *)0x0;
    cVar2 = IOAccelShared2::lookupResource(this,param_4,(long *)&local_38);
    if ((((cVar2 != '\0') &&
         (local_38 = getStorageResource(local_38), local_38 != (IOAccelResource2 *)0x0)) &&
        ((plVar5 = *(long **)(local_38 + 0x88), plVar5 != (long *)0x0 ||
         (plVar5 = *(long **)(local_38 + 0x80), plVar5 != (long *)0x0)))) &&
       (this_00 = (IOAccelResource2 *)(**(code **)(*param_1 + 0x8d0))(param_1,param_2,3),
       this_00 != (IOAccelResource2 *)0x0)) {
      uVar1 = *(uint *)(this_00 + 0xc);
      *(uint *)(this_00 + 0xc) = uVar1 | 2;
      *(uint *)(this_00 + 0xc) = uVar1 & 0x7fffffff | 2 | *(uint *)(local_38 + 0xc) & 0x80000000;
      *(undefined8 *)(this_00 + 0x158) = *(undefined8 *)(local_38 + 0x158);
      *(uint *)(this_00 + 0xe8) = param_3;
      *(uint *)(this_00 + 0xec) = param_4;
      (**(code **)(*plVar5 + 0x120))();
      lVar4 = IOAccelRemoteMemory::withPeerIDs(param_1);
      *(long *)(this_00 + 0xe0) = lVar4;
      if (lVar4 != 0) {
        IOAccelShared2::unlockPeer(param_2,param_3);
        IOAccelResourceList::addResource((IOAccelResourceList *)(param_2 + 0xa0),(long)this_00);
        lVar4 = getResidentSize(this_00);
        IOAccelShared2::increment_allocated_size(param_2,lVar4);
        return this_00;
      }
      (**(code **)(*(long *)this_00 + 0x28))(this_00);
    }
    IOAccelShared2::unlockPeer(param_2,param_3);
  }
  return (IOAccelResource2 *)0x0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::newDataBufferResource(IOGraphicsAccelerator2*, IOAccelShared2*, unsigned long
// long, bool, unsigned int, unsigned int, unsigned int)

IOAccelResource2 * __cdecl
IOAccelResource2::newDataBufferResource
          (long *param_1,IOAccelShared2 *param_2,undefined8 param_3,undefined8 param_4,
          undefined4 param_5,undefined4 param_6)

{
  IOAccelResource2 *this;
  long lVar1;
  
  this = (IOAccelResource2 *)(**(code **)(*param_1 + 0x8d0))(param_1,param_2,10);
  if (this == (IOAccelResource2 *)0x0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: new_databuf_texture failed to alloc a data buffer object\n",
                      "static IOAccelResource2 *IOAccelResource2::newDataBufferResource(IOGraphicsAccelerator2 *, IOAccelShared2 *, IOByteCount, bool, uint32_t, uint32_t, IOOptionBits)"
                     );
  }
  else {
    *(undefined8 *)(this + 200) = param_3;
    *(undefined8 *)(this + 0xd0) = 0;
    *(undefined4 *)(this + 0xf0) = param_5;
    *(undefined4 *)(this + 0xf4) = param_6;
    if (param_2 == (IOAccelShared2 *)0x0) {
      *(uint *)(this + 0xc) = *(uint *)(this + 0xc) | 4;
      IOAccelResourceList::addResource((IOAccelResourceList *)(param_1 + 0x160),(long)this);
    }
    else {
      *(uint *)(this + 0xc) = *(uint *)(this + 0xc) | 2;
      IOAccelResourceList::addResource((IOAccelResourceList *)(param_2 + 0xa0),(long)this);
      lVar1 = getResidentSize(this);
      IOAccelShared2::increment_allocated_size(param_2,lVar1);
    }
  }
  return this;
}



// IOAccelResource2::allocDataBufferMemory(IOAccelShared2*, bool, unsigned int)

ulong __thiscall
IOAccelResource2::allocDataBufferMemory
          (IOAccelResource2 *this,long param_1,int param_3_00,uint param_3)

{
  undefined8 uVar1;
  long lVar2;
  long lVar3;
  IOAccelMemory *pIVar4;
  ulong uVar5;
  
  if ((param_3_00 != 0) && ((*(byte *)(*(long *)(this + 0x18) + 0xc78) & 2) != 0)) {
    uVar1 = (**(code **)(*(long *)this + 0x1d8))(this);
    lVar2 = (**(code **)(**(long **)(this + 0x18) + 0x8c0))
                      (*(long **)(this + 0x18),param_1,this,*(undefined8 *)(this + 200),uVar1);
    if (lVar2 != 0) {
      lVar3 = lock_vidmem(this,*(ulonglong *)(param_1 + 0x80),(ulong)(param_3 & 0xf00 | 1));
      if (lVar3 != 0) {
        *(undefined8 *)(this + 0x60) = *(undefined8 *)(this + 0x58);
        *(long *)(this + 0x88) = lVar2;
      }
    }
  }
  pIVar4 = *(IOAccelMemory **)(this + 0x88);
  if (pIVar4 == (IOAccelMemory *)0x0) {
    pIVar4 = IOAccelSysMemory::withOptions
                       (*(IOGraphicsAccelerator2 **)(this + 0x18),0,param_1,0,param_3,
                        *(ulong *)(this + 200));
    if (pIVar4 == (IOAccelMemory *)0x0) {
      uVar5 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Failed to allocate data buffer backing\n",
                        "virtual bool IOAccelResource2::allocDataBufferMemory(IOAccelShared2 *, bool, IOOptionBits)"
                       );
      goto LAB_000248bc;
    }
    pIVar4[0xc] = (IOAccelMemory)((byte)pIVar4[0xc] | 1);
    if (((byte)this[0xf4] & 1) == 0) {
      lVar2 = IOMemoryDescriptor::createMappingInTask
                        (*(task **)(pIVar4 + 0xd0),*(ulonglong *)(param_1 + 0x80),0,
                         (ulong)(param_3 & 0xf00 | 1),0);
      if (lVar2 == 0) {
        uVar5 = 0;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Failed to map data buffer\n",
                          "virtual bool IOAccelResource2::allocDataBufferMemory(IOAccelShared2 *, bool, IOOptionBits)"
                         );
        (**(code **)(*(long *)pIVar4 + 0x28))(pIVar4);
        goto LAB_000248bc;
      }
      *(long *)(this + 0x60) = lVar2;
      *(IOAccelMemory **)(this + 0x88) = pIVar4;
    }
    else {
      *(undefined8 *)(this + 0x60) = 0;
      pIVar4 = *(IOAccelMemory **)(this + 0x88);
    }
  }
  uVar5 = CONCAT71((int7)((ulong)this >> 8),pIVar4 != (IOAccelMemory *)0x0);
LAB_000248bc:
  return uVar5 & 0xffffffff;
}



// IOAccelResource2::lock_vidmem(task*, unsigned int)

long __thiscall
IOAccelResource2::lock_vidmem(IOAccelResource2 *this,ulonglong param_1,ulong param_2)

{
  ulonglong uVar1;
  bool bVar2;
  undefined *puVar3;
  char cVar4;
  task *ptVar5;
  long *plVar6;
  long lVar7;
  undefined1 *local_40;
  IOAccelResource2 *local_38;
  
  puVar3 = PTR__kernel_task_0006b100;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  if (*(ulonglong *)PTR__kernel_task_0006b100 == param_1) {
    plVar6 = *(long **)(this + 0x178);
    if (plVar6 != (long *)0x0) goto LAB_00024a20;
LAB_00024a42:
    local_38 = this + 0x178;
    bVar2 = true;
    if (*(long *)(this + 0x58) == 0) {
      cVar4 = (**(code **)(**(long **)(this + 0x88) + 0x148))();
      if (cVar4 == '\0') {
        return 0;
      }
      cVar4 = (**(code **)(*(long *)this + 0x1f8))(this);
      if (cVar4 == '\0') goto LAB_00024aea;
      bVar2 = false;
    }
  }
  else {
    plVar6 = *(long **)(this + 0x58);
    if (plVar6 != (long *)0x0) {
LAB_00024a20:
                    // WARNING: Could not recover jumptable at 0x00024a31. Too many branches
                    // WARNING: Treating indirect jump as call
      lVar7 = (**(code **)(*plVar6 + 0x118))();
      return lVar7;
    }
    local_38 = this + 0x178;
    bVar2 = true;
    if (*(long *)(this + 0x178) == 0) goto LAB_00024a42;
  }
  ptVar5 = (task *)(**(code **)(*(long *)this + 0x208))(this,&local_40);
  if (ptVar5 == (task *)0x0) {
LAB_00024ad9:
    if (bVar2) {
      return 0;
    }
  }
  else {
    uVar1 = *(ulonglong *)puVar3;
    plVar6 = (long *)IOMemoryDescriptor::createMappingInTask
                               (ptVar5,param_1,0,param_2 & 0xffffffff,(ulonglong)local_40);
    if (uVar1 == param_1) {
      *(long **)local_38 = plVar6;
    }
    else {
      *(long **)(this + 0x58) = plVar6;
    }
    if (plVar6 == (long *)0x0) goto LAB_00024ad9;
    lVar7 = (**(code **)(*plVar6 + 0x118))(plVar6);
    if ((bool)(bVar2 | lVar7 != 0)) {
      return lVar7;
    }
  }
  (**(code **)(*(long *)this + 0x200))(this);
LAB_00024aea:
  (**(code **)(**(long **)(this + 0x88) + 0x150))();
  return 0;
}



// IOAccelResource2::allocMemory(IOAccelShared2*)

ulong __thiscall IOAccelResource2::allocMemory(IOAccelResource2 *this,long param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  long lVar2;
  undefined8 uVar3;
  IOAccelMemory *this_00;
  uint uVar4;
  undefined8 unaff_R13;
  ulong uVar5;
  
  uVar5 = CONCAT71((int7)((ulong)unaff_R13 >> 8),1);
  if (((byte)this[0x14] & 0x40) == 0) goto LAB_00024d21;
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x18);
  if ((*(uint *)(pIVar1 + 0xc90) >> 0x15 & 1) == 0) {
    uVar3 = (**(code **)(*(long *)this + 0x1d8))(this);
    if ((param_1 != 0) && (lVar2 = *(long *)(this + 0x18), (*(byte *)(lVar2 + 0xc93) & 0x10) != 0))
    {
      this_00 = (IOAccelMemory *)
                (**(code **)(*(long *)(lVar2 + 0xbc8) + 0x10))
                          (lVar2 + 0xbc8,param_1,this,*(undefined8 *)(this + 200),uVar3);
      if (this_00 != (IOAccelMemory *)0x0) {
        this[0xe] = (IOAccelResource2)((byte)this[0xe] | 4);
        goto LAB_00024d1a;
      }
    }
    this_00 = (IOAccelMemory *)
              (**(code **)(**(long **)(this + 0x18) + 0x8c0))
                        (*(long **)(this + 0x18),param_1,this,*(undefined8 *)(this + 200),uVar3);
    if (this_00 == (IOAccelMemory *)0x0) {
      uVar5 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to allocate fVidMemory\n",
                        "virtual bool IOAccelResource2::allocMemory(IOAccelShared2 *)");
      goto LAB_00024d21;
    }
  }
  else {
    uVar5 = -*(long *)PTR__page_size_0006b108 &
            (*(long *)(this + 200) + *(long *)PTR__page_size_0006b108) - 1U;
    uVar4 = 0x33;
    if ((*(uint *)(this + 0xc) & 0x40000000) == 0) {
      uVar4 = 0x363;
    }
    if (((param_1 == 0) || ((*(uint *)(this + 0xc) & 0x40000000) != 0)) ||
       ((*(uint *)(pIVar1 + 0xc90) & 0x4000000) == 0)) {
      this_00 = IOAccelSysMemory::withOptions(pIVar1,0,param_1,this,uVar4,uVar5);
      if (this_00 == (IOAccelMemory *)0x0) {
LAB_00024d89:
        uVar5 = 0;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to allocate fVidMemory\n"
                          ,"virtual bool IOAccelResource2::allocMemory(IOAccelShared2 *)");
        goto LAB_00024d21;
      }
LAB_00024cba:
      if (((byte)this_00[0xd] & 0x80) != 0) {
        this[0xe] = (IOAccelResource2)((byte)this[0xe] | 4);
      }
      (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x18) + 0x380),this_00 + 0x108,
                 (ulong)(byte)this[0x16] * 0x40 + *(long *)(this + 0x38));
      (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x18) + 0x380),this_00 + 0x108,
                 (ulong)(byte)this[0x15] * 0x40 + *(long *)(this + 0x38));
    }
    else {
      this_00 = (IOAccelMemory *)
                (**(code **)(*(long *)(pIVar1 + 0xb60) + 0x10))(pIVar1 + 0xb60,param_1,this,uVar5);
      if (this_00 == (IOAccelMemory *)0x0) {
        this_00 = IOAccelSysMemory::withOptions
                            (*(IOGraphicsAccelerator2 **)(this + 0x18),0,param_1,this,uVar4,uVar5);
        if (this_00 == (IOAccelMemory *)0x0) goto LAB_00024d89;
        IOAccelMemory::setFlags(this_00,1);
        if ((*(byte *)(*(long *)(this + 0x18) + 0xc93) & 8) != 0) {
          IOAccelMemory::setFlags(this_00,2);
        }
        goto LAB_00024cba;
      }
      this[0xe] = (IOAccelResource2)((byte)this[0xe] | 4);
    }
    uVar5 = CONCAT71((int7)(uVar5 >> 8),1);
  }
LAB_00024d1a:
  *(IOAccelMemory **)(this + 0x88) = this_00;
LAB_00024d21:
  return uVar5 & 0xffffffff;
}



// IOAccelResource2::getClientSharedAddresses(unsigned long long*, unsigned long long*)

void __thiscall
IOAccelResource2::getClientSharedAddresses(IOAccelResource2 *this,long *param_1,long *param_2)

{
  IOAccelSharedNamespace2::getClientSharedAddressesForId
            (*(IOAccelSharedNamespace2 **)(this + 0x68),*(uint *)(*(long *)(this + 0x38) + 0x100),
             param_1,param_2);
  return;
}



// IOAccelResource2::getClientSharedROPrivate() const

long __thiscall IOAccelResource2::getClientSharedROPrivate(IOAccelResource2 *this)

{
  long lVar1;
  
  if (*(int *)(*(long *)(this + 0x18) + 0xce0) == 0) {
    lVar1 = 0;
  }
  else {
    lVar1 = *(long *)(this + 0x38) + 0x108;
  }
  return lVar1;
}



// IOAccelResource2::getClientSharedRWPrivate() const

long __thiscall IOAccelResource2::getClientSharedRWPrivate(IOAccelResource2 *this)

{
  long lVar1;
  
  if (*(int *)(*(long *)(this + 0x18) + 0xce4) == 0) {
    lVar1 = 0;
  }
  else {
    lVar1 = *(long *)(this + 0x30) + 0x20;
  }
  return lVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::initialize(IOAccelNewResourceArgs*, unsigned long long)

ulong __cdecl IOAccelResource2::initialize(long param_1,long param_2)

{
  long *plVar1;
  undefined1 uVar2;
  undefined2 uVar3;
  int iVar4;
  uint uVar5;
  undefined8 uVar6;
  ulong uVar7;
  uint uVar8;
  ulong uVar9;
  long local_20;
  
  if ((*(byte *)(*(long *)(param_1 + 0x18) + 0xc92) & 0x40) == 0) {
LAB_00024e53:
    if (param_2 != 0) goto LAB_00024e5c;
LAB_00025073:
    if (*(long *)(param_1 + 0xe0) != 0) {
      param_2 = *(long *)(*(long *)(param_1 + 0xe0) + 0x10);
      *(undefined1 *)(param_1 + 0xac) = 1;
      iVar4 = IOSurface::getPlaneCount();
      if (iVar4 == 0) {
        uVar2 = 1;
      }
      else {
        uVar2 = IOSurface::getPlaneCount();
      }
      *(undefined1 *)(param_1 + 0xad) = uVar2;
      *(undefined1 *)(param_1 + 0xae) = 0;
      uVar5 = (uint)param_2;
      uVar3 = IOSurface::getPlaneWidth(uVar5);
      *(undefined2 *)(param_1 + 0xb0) = uVar3;
      uVar3 = IOSurface::getPlaneHeight(uVar5);
      *(undefined2 *)(param_1 + 0xb2) = uVar3;
      *(undefined2 *)(param_1 + 0xb4) = 1;
      uVar3 = IOSurface::getPlaneElementWidth(uVar5);
      *(undefined2 *)(param_1 + 0xd8) = uVar3;
      uVar5 = IOSurface::getPlaneBytesPerRow(uVar5);
      *(ulong *)(param_1 + 0xc0) = (ulong)uVar5;
      *(byte *)(param_1 + 0xc) = *(byte *)(param_1 + 0xc) | 0x80;
      uVar5 = 3;
      goto LAB_00025113;
    }
  }
  else {
    if (param_2 == 0) {
      if (*(char *)(param_1 + 0x14) == '\n') goto LAB_00024e4c;
      goto LAB_00025073;
    }
    if (*(char *)(param_1 + 0x14) != '\x01') {
LAB_00024e4c:
      *(byte *)(param_1 + 0x108) = *(byte *)(param_1 + 0x108) | 4;
      goto LAB_00024e53;
    }
LAB_00024e5c:
    *(undefined1 *)(param_1 + 0xac) = *(undefined1 *)(param_2 + 0x20);
    *(undefined1 *)(param_1 + 0xad) = *(undefined1 *)(param_2 + 0x21);
    *(undefined1 *)(param_1 + 0xae) = *(undefined1 *)(param_2 + 0x22);
    *(undefined2 *)(param_1 + 0xb0) = *(undefined2 *)(param_2 + 8);
    *(undefined2 *)(param_1 + 0xb2) = *(undefined2 *)(param_2 + 10);
    *(undefined2 *)(param_1 + 0xb4) = *(undefined2 *)(param_2 + 0xc);
    *(undefined8 *)(param_1 + 0xb8) = *(undefined8 *)(param_2 + 0x10);
    *(ushort *)(param_1 + 0xd8) = (ushort)*(byte *)(param_2 + 0x23);
    *(undefined8 *)(param_1 + 0xc0) = *(undefined8 *)(param_2 + 0x18);
    uVar5 = *(uint *)(param_2 + 0x24);
    if ((uVar5 & 0x80) != 0) {
      *(byte *)(param_1 + 0xe) = *(byte *)(param_1 + 0xe) & 0xfe;
      uVar5 = *(uint *)(param_2 + 0x24);
    }
    if ((uVar5 >> 10 & 1) != 0) {
      *(byte *)(param_1 + 0xf) = *(byte *)(param_1 + 0xf) | 1;
      uVar5 = *(uint *)(param_2 + 0x24);
    }
    if ((uVar5 & 0x20) != 0) {
      *(byte *)(param_1 + 0xd) = *(byte *)(param_1 + 0xd) | 2;
      *(byte *)(param_1 + 0x108) = *(byte *)(param_1 + 0x108) | 2;
      uVar5 = *(uint *)(param_2 + 0x24);
    }
    if ((uVar5 & 0x10) != 0) {
      *(byte *)(param_1 + 0xd) = *(byte *)(param_1 + 0xd) | 1;
      *(byte *)(param_1 + 0x108) = *(byte *)(param_1 + 0x108) | 1;
      uVar5 = *(uint *)(param_2 + 0x24);
    }
    if ((uVar5 >> 0xc & 1) != 0) {
      *(byte *)(param_1 + 0xf) = *(byte *)(param_1 + 0xf) | 0x10;
      uVar6 = _IOMallocTypeImpl(&initialize(IOAccelNewResourceArgs*,unsigned_long_long)::
                                 kalloc_type_view_1909);
      *(undefined8 *)(param_1 + 0x90) = uVar6;
      plVar1 = *(long **)(*(long *)(param_1 + 0x18) + 0x380);
      (**(code **)(*plVar1 + 0x140))(plVar1,uVar6);
      plVar1 = *(long **)(*(long *)(param_1 + 0x18) + 0x380);
      (**(code **)(*plVar1 + 0x140))(plVar1,*(long *)(param_1 + 0x90) + 0x40);
      uVar5 = *(uint *)(param_2 + 0x24);
    }
    if ((uVar5 >> 0xe & 1) != 0) {
      *(byte *)(param_1 + 0xf) = *(byte *)(param_1 + 0xf) | 0x40;
      *(byte *)(param_1 + 0x108) = *(byte *)(param_1 + 0x108) | 0x44;
      if (*(uint *)(param_2 + 0x60) != 0) {
        local_20 = 0;
        if (((*(IOAccelNamespace **)(param_1 + 0x68) != (IOAccelNamespace *)0x0) &&
            (*(char *)(param_1 + 0x14) != '@')) &&
           (uVar6 = IOAccelNamespace::lookupId
                              (*(IOAccelNamespace **)(param_1 + 0x68),*(uint *)(param_2 + 0x60),
                               &local_20), (char)uVar6 != '\0')) {
          plVar1 = *(long **)(local_20 + 0x40);
          *(long **)(param_1 + 0x168) = plVar1;
          if (plVar1 != (long *)0x0) {
            (**(code **)(*plVar1 + 0x20))();
            *(undefined4 *)(param_1 + 0x164) = *(undefined4 *)(*(long *)(param_1 + 0x168) + 0x110);
            **(ushort **)(param_1 + 0x30) = **(ushort **)(param_1 + 0x30) | 1;
            if (*(long **)(param_1 + 0x80) != (long *)0x0) {
              (**(code **)(**(long **)(param_1 + 0x80) + 0x28))();
              *(undefined8 *)(param_1 + 0x80) = 0;
            }
            goto LAB_00025002;
          }
        }
        uVar9 = 0;
        goto LAB_00025149;
      }
    }
LAB_00025002:
    if ((*(byte *)(param_2 + 0x24) & 0x30) == 0) {
      *(byte *)(param_1 + 0xd) = *(byte *)(param_1 + 0xd) | 3;
      *(byte *)(param_1 + 0x108) = *(byte *)(param_1 + 0x108) | 3;
    }
    if (*(char *)(param_1 + 0x14) == -0x7e) {
      uVar8 = *(uint *)(param_1 + 0x108) & 0xfffffffc;
      *(uint *)(param_1 + 0x108) = uVar8;
      uVar5 = *(uint *)(*(long *)(param_1 + 0xe0) + 0x108);
      *(uint *)(param_1 + 0x108) = uVar5 & 3 | uVar8;
      if ((uVar5 & 1) != 0) {
        *(byte *)(param_1 + 0xd) = *(byte *)(param_1 + 0xd) | 1;
      }
      if ((uVar5 & 2) != 0) {
        *(byte *)(param_1 + 0xd) = *(byte *)(param_1 + 0xd) | 2;
      }
    }
    if ((*(long *)(param_2 + 0x30) != 0) && (uVar5 = 4, *(long *)(param_2 + 0x38) != 0)) {
LAB_00025113:
      *(uint *)(param_1 + 0x108) = *(uint *)(param_1 + 0x108) | uVar5;
    }
  }
  uVar9 = CONCAT71((int7)((ulong)param_2 >> 8),1);
  if (((*(char *)(param_1 + 0x14) == -0x80) && (*(long *)(param_1 + 0x80) != 0)) &&
     (uVar7 = (**(code **)(**(long **)(*(long *)(param_1 + 0x80) + 0xd0) + 0x1c0))(),
     (uVar7 & 1) == 0)) {
    *(byte *)(param_1 + 0x108) = *(byte *)(param_1 + 0x108) & 0xfd;
  }
LAB_00025149:
  return uVar9 & 0xffffffff;
}



// IOAccelResource2::removeFromChannel(IOAccelChannel2*)

void __thiscall IOAccelResource2::removeFromChannel(IOAccelResource2 *this,long *param_1)

{
  IOAccelResource2 *pIVar1;
  IOAccelResource2 IVar2;
  long lVar3;
  long *plVar4;
  
  if (((byte)this[0xe] & 0x10) == 0) {
    lVar3 = *(long *)(this + 0x40);
    if ((lVar3 != 0) && ((*(byte *)(lVar3 + 0x10) & 4) != 0)) {
      lVar3 = lVar3 + 0x38;
      goto LAB_00025182;
    }
  }
  else {
    lVar3 = *(long *)(this + 0x20);
LAB_00025182:
    (**(code **)(*param_1 + 0x140))(param_1,lVar3);
  }
  IVar2 = this[0x14];
  if ((IVar2 == (IOAccelResource2)0xa) || (((byte)IVar2 & 0xf) == 0)) {
    if ((((byte)this[0xf] & 0x10) == 0) || (((byte)this[0x98] & 2) != 0)) {
      (**(code **)(*param_1 + 0x140))
                (param_1,(ulong)(byte)this[0x15] * 0x40 + *(long *)(this + 0x38));
      if (((byte)this[0x98] & 1) != 0) {
        this[0xe] = (IOAccelResource2)((byte)this[0xe] | 0x80);
        (**(code **)(*param_1 + 0x140))
                  (param_1,(ulong)(byte)this[0x16] * 0x40 + *(long *)(this + 0x38));
      }
      if ((((byte)this[0xe] & 0x20) != 0) && (*(long *)(this + 0xe8) != 0)) {
        update_iosurface_textures_stamp(this,param_1);
      }
    }
    else {
      (**(code **)(*param_1 + 0x140))(param_1,*(undefined8 *)(this + 0x90));
      if (((byte)this[0x98] & 1) != 0) {
        (**(code **)(*param_1 + 0x140))(param_1,*(long *)(this + 0x90) + 0x40);
      }
    }
    goto LAB_0002528a;
  }
  if (IVar2 == (IOAccelResource2)0x1) {
    plVar4 = *(long **)(this + 0xf8);
LAB_00025270:
    if (plVar4 == (long *)0x0) goto LAB_0002528a;
  }
  else {
    if (IVar2 != (IOAccelResource2)0x4) {
      if (IVar2 != (IOAccelResource2)0x82) goto LAB_0002528a;
      plVar4 = *(long **)(this + 0xe0);
      goto LAB_00025270;
    }
    plVar4 = *(long **)(this + 0xe8);
  }
  (**(code **)(*plVar4 + 0x198))(plVar4,param_1);
LAB_0002528a:
  pIVar1 = this + 0xa0;
  *(int *)pIVar1 = *(int *)pIVar1 + -1;
  if (*(int *)pIVar1 == 0) {
    *(undefined8 *)(this + 0x98) = 0xffffffff00000000;
  }
  return;
}



// IOAccelResource2::update_iosurface_textures_stamp(IOAccelChannel2*)

void __thiscall
IOAccelResource2::update_iosurface_textures_stamp(IOAccelResource2 *this,long *param_1)

{
  long lVar1;
  
  for (lVar1 = *(long *)(this + 0xe8); lVar1 != 0; lVar1 = *(long *)(lVar1 + 0xe8)) {
    (**(code **)(*param_1 + 0x140))
              (param_1,(ulong)*(byte *)(lVar1 + 0x15) * 0x40 + *(long *)(lVar1 + 0x38));
    if (((byte)this[0x98] & 1) != 0) {
      (**(code **)(*param_1 + 0x140))
                (param_1,(ulong)*(byte *)(lVar1 + 0x16) * 0x40 + *(long *)(lVar1 + 0x38));
    }
  }
  return;
}



// IOAccelResource2::addToChannel(IOAccelChannel2*, unsigned int)

void __thiscall IOAccelResource2::addToChannel(IOAccelResource2 *this,long param_1,uint param_2)

{
  IOAccelResource2 *pIVar1;
  IOAccelResource2 IVar2;
  long lVar3;
  ushort uVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  long *plVar8;
  uintptr_t uVar9;
  
  iVar7 = *(int *)(this + 0xa0);
  *(int *)(this + 0xa0) = iVar7 + 1;
  if (iVar7 == 0) {
    *(uint *)(this + 0x98) = param_2;
    *(undefined4 *)(this + 0x9c) = *(undefined4 *)(param_1 + 0x20);
  }
  else {
    *(uint *)(this + 0x98) = *(uint *)(this + 0x98) | param_2;
  }
  IVar2 = this[0x14];
  if (IVar2 == (IOAccelResource2)0x1) {
    plVar8 = *(long **)(this + 0xf8);
    if (plVar8 == (long *)0x0) goto LAB_00025436;
  }
  else {
    if (IVar2 != (IOAccelResource2)0x4) {
      if (IVar2 == (IOAccelResource2)0x82) {
        (**(code **)(**(long **)(this + 0xe0) + 400))(*(long **)(this + 0xe0),param_1,param_2);
        uVar9 = *(uintptr_t *)(param_1 + 0x28);
        uVar5 = IOSurface::getSurfaceID();
        uVar6 = IOSurface::getPixelFormat();
        iVar7 = IOSurface::getWidth();
        uVar4 = IOSurface::getHeight();
        _kernel_debug((param_2 & 1) * 4 + 0x85020010,uVar9,(ulong)uVar5,(ulong)uVar6,
                      (ulong)((uint)uVar4 | iVar7 << 0x10),0);
      }
      goto LAB_00025436;
    }
    plVar8 = *(long **)(this + 0xe8);
  }
  (**(code **)(*plVar8 + 400))(plVar8,param_1,param_2);
LAB_00025436:
  if ((___ktrace_kernel_enabled != 0) && ((DAT_00082622 & 4) != 0)) {
    if (this[0x14] == (IOAccelResource2)0x82) {
      lVar3 = *(long *)(this + 0xe0);
      uVar5 = IOSurface::getSurfaceID();
      uVar6 = IOSurface::getWidth();
      uVar4 = IOSurface::getHeight();
      uVar9 = (ulong)uVar4 << 0x20 | ((ulong)uVar6 << 0x30) + (ulong)uVar5;
      pIVar1 = (IOAccelResource2 *)(lVar3 + (ulong)(*(long *)(lVar3 + 0x88) == 0) * 8);
    }
    else {
      pIVar1 = this + (ulong)(*(long *)(this + 0x88) == 0) * 8;
      uVar9 = (ulong)*(ushort *)(this + 0xb2) << 0x20 | (ulong)*(uint *)(this + 0xb0) << 0x30;
    }
    if (___ktrace_kernel_enabled != 0) {
      _kernel_debug((param_2 & 1) * 4 + 0x85120060,*(uintptr_t *)(param_1 + 0x28),
                    *(uintptr_t *)(this + 0x110),*(uintptr_t *)(pIVar1 + 200),uVar9,0);
      return;
    }
  }
  return;
}



// IOAccelResource2::supportsProtectionOptions(unsigned long long) const

undefined8 __thiscall
IOAccelResource2::supportsProtectionOptions(IOAccelResource2 *this,ulong param_1)

{
  ulong uVar1;
  
  uVar1 = getProtectionOptions(this);
  return CONCAT71((int7)(~uVar1 >> 8),(param_1 & ~uVar1) == 0);
}



// WARNING: Removing unreachable block (ram,0x000255e1)
// IOAccelResource2::dirtyLevel(unsigned int, unsigned int)

void __thiscall IOAccelResource2::dirtyLevel(IOAccelResource2 *this,uint param_1,undefined4 param_2)

{
  ushort *puVar1;
  IOAccelResource2 IVar2;
  undefined4 uVar3;
  long *plVar4;
  ulong uVar5;
  ushort uVar6;
  long *plVar7;
  IOAccelResource2 *pIVar8;
  byte bVar9;
  long lVar10;
  
  uVar5 = (ulong)param_1;
  IVar2 = this[0x14];
  if (IVar2 == (IOAccelResource2)0x82) {
    lVar10 = *(long *)(this + 0xe0);
    plVar4 = *(long **)(lVar10 + 0xe0);
    uVar3 = *(undefined4 *)(this + 0xf8);
    if (((*(char *)(lVar10 + 0x14) == -0x40) || (*(char *)(lVar10 + 0x14) == -0x80)) &&
       (plVar4 != (long *)0x0)) {
      plVar7 = (long *)IOSurface::getMemoryDescriptor();
      (**(code **)(*plVar7 + 0x120))(plVar7,1);
    }
    (**(code **)(*plVar4 + 0x130))(plVar4);
    bVar9 = (byte)uVar3;
    if ((*(byte *)(lVar10 + 0x14) & 0x40) == 0) {
      if ((*(uint *)(lVar10 + 0xc) >> 0xe & 1) == 0) {
        puVar1 = (ushort *)(*(long *)(lVar10 + 0x30) + uVar5 * 2);
        *puVar1 = *puVar1 | (ushort)(1L << (bVar9 & 0x3f));
      }
      (**(code **)(*plVar4 + 0x140))(plVar4,*(byte *)(*(long *)(this + 0x18) + 0xc90) >> 7);
      return;
    }
    if ((*(uint *)(lVar10 + 0xc) >> 0xf & 1) != 0) {
      return;
    }
    lVar10 = *(long *)(lVar10 + 0x30);
  }
  else {
    if (((byte)IVar2 & 0xf) != 0) {
      if (IVar2 == (IOAccelResource2)0x3) {
        if (*(IOAccelRemoteMemory **)(this + 0xe0) == (IOAccelRemoteMemory *)0x0) {
          return;
        }
        pIVar8 = (IOAccelResource2 *)
                 IOAccelRemoteMemory::getRemoteStorageResource
                           (*(IOAccelRemoteMemory **)(this + 0xe0));
        if (pIVar8 == (IOAccelResource2 *)0x0) {
          return;
        }
      }
      else {
        if (IVar2 == (IOAccelResource2)0xa) {
          *(undefined2 *)(*(long *)(this + 0x30) + 0xc) = 1;
          return;
        }
        pIVar8 = getStorageResource(this);
        if (pIVar8 == (IOAccelResource2 *)0x0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: wrong resType 0x%x\n",
                            "virtual void IOAccelResource2::dirtyLevel(uint32_t, uint32_t)",
                            this[0x14]);
          return;
        }
      }
                    // WARNING: Could not recover jumptable at 0x00025738. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*(long *)pIVar8 + 0x168))
                (pIVar8,uVar5,param_2,*(code **)(*(long *)pIVar8 + 0x168));
      return;
    }
    bVar9 = (byte)param_2;
    if (((byte)IVar2 & 0x40) == 0) {
      if ((*(uint *)(this + 0xc) >> 0xe & 1) != 0) {
        return;
      }
      puVar1 = (ushort *)(*(long *)(this + 0x30) + uVar5 * 2);
      *puVar1 = *puVar1 | (ushort)(1L << (bVar9 & 0x3f));
      return;
    }
    if ((*(uint *)(this + 0xc) >> 0xf & 1) != 0) {
      return;
    }
    lVar10 = *(long *)(this + 0x30);
  }
  puVar1 = (ushort *)(lVar10 + 0xc + uVar5 * 2);
  uVar6 = (ushort)(1L << (bVar9 & 0x3f));
  *puVar1 = *puVar1 | uVar6;
  puVar1 = (ushort *)(lVar10 + uVar5 * 2);
  *puVar1 = *puVar1 & ~uVar6;
  return;
}



// IOAccelResource2::setBackingMemory(IOAccelSysMemory*, unsigned int, int, bool)

undefined8 __thiscall
IOAccelResource2::setBackingMemory
          (IOAccelResource2 *this,undefined8 param_1,uint param_2,int param_3,int param_4)

{
  ushort *puVar1;
  undefined8 uVar2;
  
  *(undefined8 *)(this + 0x80) = param_1;
  *(long *)(this + 0xc0) = (long)param_3;
  *(ulong *)(this + 0xf8) = (ulong)param_2;
  if (param_4 != 0) {
    if ((*(byte *)(*(long *)(this + 0x18) + 0xc90) & 0x80) != 0) {
      this[0xc] = (IOAccelResource2)((byte)this[0xc] | 0x20);
    }
    puVar1 = *(ushort **)(this + 0x30);
    *puVar1 = *puVar1 | 1;
    *(byte *)(puVar1 + 6) = (byte)puVar1[6] & 0xfe;
    *(byte *)(puVar1 + 0xe) = (byte)puVar1[0xe] | 1;
  }
  *(uint *)(this + 0xc) = *(uint *)(this + 0xc) & 0xfffdff3f | 0xc0;
  uVar2 = (**(code **)(*(long *)this + 0x1d0))();
  return CONCAT71((int7)((ulong)uVar2 >> 8),1);
}



// IOAccelResource2::allocBackingMemory()

bool __thiscall IOAccelResource2::allocBackingMemory(IOAccelResource2 *this)

{
  int *piVar1;
  long lVar2;
  undefined8 uVar3;
  IOAccelMemory *pIVar4;
  
  pIVar4 = IOAccelSysMemory::withOptions
                     (*(IOGraphicsAccelerator2 **)(this + 0x18),0,0,0,0x10023,
                      *(ulong *)(this + 0xd0));
  *(IOAccelMemory **)(this + 0x80) = pIVar4;
  if (pIVar4 == (IOAccelMemory *)0x0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: backing allocation failed\n",
                      "bool IOAccelResource2::allocBackingMemory()");
  }
  else {
    lVar2 = *(long *)(this + 0x18);
    uVar3 = *(undefined8 *)(this + 0xd0);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar2 + 0x388) + 0x58),100);
    piVar1 = (int *)(lVar2 + 0x330);
    *piVar1 = *piVar1 + (int)uVar3;
    *(undefined8 *)(this + 0xf8) = 0;
    this[0xe] = (IOAccelResource2)((byte)this[0xe] | 2);
    (**(code **)(*(long *)this + 0x1d0))(this);
  }
  return pIVar4 != (IOAccelMemory *)0x0;
}



// IOAccelResource2::deleteBackingMemory()

void __thiscall IOAccelResource2::deleteBackingMemory(IOAccelResource2 *this)

{
  int *piVar1;
  IOAccelResource2 IVar2;
  long lVar3;
  undefined8 uVar4;
  long *plVar5;
  ulong uVar6;
  
  lVar3 = *(long *)(this + 0x18);
  uVar4 = *(undefined8 *)(this + 0xd0);
  IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar3 + 0x388) + 0x58),100);
  piVar1 = (int *)(lVar3 + 0x330);
  *piVar1 = *piVar1 - (int)uVar4;
  *(uint *)(*(long *)(this + 0x80) + 0xc) = *(uint *)(*(long *)(this + 0x80) + 0xc) | 1;
  plVar5 = *(long **)(this + 0x80);
  plVar5[7] = 0;
  (**(code **)(*plVar5 + 0x28))();
  *(undefined8 *)(this + 0x80) = 0;
  IVar2 = this[0xac];
  if ((ulong)(byte)IVar2 != 0) {
    lVar3 = *(long *)(this + 0x30);
    uVar6 = 0;
    do {
      *(undefined2 *)(lVar3 + uVar6 * 2) = 0;
      uVar6 = uVar6 + 1;
    } while ((byte)IVar2 != uVar6);
  }
                    // WARNING: Could not recover jumptable at 0x00025955. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x1d0))(this);
  return;
}



// IOAccelResource2::load()

void __thiscall IOAccelResource2::load(IOAccelResource2 *this)

{
  if ((*(long *)(this + 0x80) == 0) || (((byte)this[0xc] & 0x10) != 0)) {
    *(byte *)(*(long *)(this + 0x30) + 0x1c) = *(byte *)(*(long *)(this + 0x30) + 0x1c) & 0xfe;
  }
  else {
    (**(code **)(*(long *)this + 0x268))(this);
    if ((*(uint *)(this + 0xc) & 0x20024c00) == 0x20000) {
      setPurgeable(this,3,1,(uint *)0x0);
      return;
    }
  }
  return;
}



// IOAccelResource2::setPurgeable(unsigned int, unsigned int, unsigned int*)

void __thiscall
IOAccelResource2::setPurgeable(IOAccelResource2 *this,int param_1,int param_2,uint *param_3)

{
  long *plVar1;
  undefined8 *puVar2;
  ushort *puVar3;
  short *psVar4;
  long lVar5;
  ulong uVar6;
  int iVar7;
  undefined8 uVar8;
  ulong uVar9;
  ushort uVar10;
  ulong uVar11;
  uint uVar12;
  uint local_3c;
  uint local_38;
  byte local_31;
  
  local_3c = 2;
  local_38 = 2;
  uVar8 = purgeable(this);
  local_31 = (byte)uVar8;
  plVar1 = *(long **)(this + 0x80);
  uVar12 = 2;
  if (plVar1 != (long *)0x0) {
    iVar7 = (**(code **)(*plVar1 + 0x160))(plVar1,param_1,&local_3c);
    if ((iVar7 == 0) && ((param_1 == 4 || (local_3c == 4)))) {
      puVar2 = *(undefined8 **)(this + 0x30);
      *puVar2 = 0;
      *(undefined4 *)(puVar2 + 1) = 0;
      *(byte *)((long)puVar2 + 0x1c) = *(byte *)((long)puVar2 + 0x1c) & 0xfe;
    }
    uVar12 = local_3c;
    if (param_1 - 3U < 2) {
      this[0xd] = (IOAccelResource2)((byte)this[0xd] | 0x40);
    }
    else if (param_1 == 2) {
      this[0xd] = (IOAccelResource2)((byte)this[0xd] & 0xbf);
    }
  }
  plVar1 = *(long **)(this + 0x88);
  if (plVar1 != (long *)0x0) {
    iVar7 = (**(code **)(*plVar1 + 0x160))(plVar1,param_2,&local_38);
    if ((iVar7 == 0) && ((param_2 == 4 || (local_38 == 4)))) {
      uVar9 = (ulong)(byte)this[0xac];
      if (uVar9 == 0) {
LAB_00025adc:
        if ((*(byte *)(*(long *)(this + 0x18) + 0xc9c) & 4) == 0) {
          this[0xf] = (IOAccelResource2)((byte)this[0xf] | 8);
        }
        *(undefined8 *)(this + 0xa4) = 0;
        *(undefined8 *)(this + 0x138) = 0;
        *(undefined8 *)(this + 0x140) = 0;
        psVar4 = *(short **)(this + 0x30);
        psVar4[6] = 0;
        psVar4[7] = 0;
        psVar4[8] = 0;
        psVar4[9] = 0;
        psVar4[10] = 0;
        psVar4[0xb] = 0;
        if (((((psVar4[1] != 0 || *psVar4 != 0) || psVar4[2] != 0) || psVar4[3] != 0) ||
            psVar4[4] != 0) || psVar4[5] != 0) {
          *(byte *)(psVar4 + 0xe) = *(byte *)(psVar4 + 0xe) | 1;
        }
      }
      else {
        puVar3 = *(ushort **)(this + 0x30);
        if ((~*puVar3 & puVar3[6]) == 0) {
          uVar6 = 1;
          do {
            uVar11 = uVar6;
            if (uVar9 == uVar11) break;
            uVar6 = uVar11 + 1;
          } while ((~puVar3[uVar11] & puVar3[uVar11 + 6]) == 0);
          if (uVar9 <= uVar11) goto LAB_00025adc;
        }
        puVar3[0] = 0;
        puVar3[1] = 0;
        puVar3[2] = 0;
        puVar3[3] = 0;
        puVar3[4] = 0;
        puVar3[5] = 0;
        puVar3[6] = 0;
        puVar3[7] = 0;
        puVar3[8] = 0;
        puVar3[9] = 0;
        puVar3[10] = 0;
        puVar3[0xb] = 0;
        *(byte *)(puVar3 + 0xe) = (byte)puVar3[0xe] & 0xfe;
      }
    }
    uVar12 = local_38;
    if (param_2 - 3U < 2) {
      this[0xd] = (IOAccelResource2)((byte)this[0xd] | 0x80);
    }
    else if (param_2 == 2) {
      this[0xd] = (IOAccelResource2)((byte)this[0xd] & 0x7f);
    }
  }
  if (((*(long *)(this + 0x80) != 0) && (*(long *)(this + 0x88) != 0)) && (local_3c != local_38)) {
    if ((ulong)(byte)this[0xac] != 0) {
      uVar9 = 0;
      uVar10 = 0;
      do {
        uVar10 = uVar10 | *(ushort *)(*(long *)(this + 0x30) + 0xc + uVar9 * 2) |
                          *(ushort *)(*(long *)(this + 0x30) + uVar9 * 2);
        uVar9 = uVar9 + 1;
      } while ((byte)this[0xac] != uVar9);
      if (uVar10 != 0) {
        uVar12 = local_31 | 2;
        goto LAB_00025ba9;
      }
    }
    uVar12 = 4;
  }
LAB_00025ba9:
  if (param_3 != (uint *)0x0) {
    *param_3 = uVar12;
  }
  if (((byte)this[0xd] & 0x40) == 0) {
    lVar5 = *(long *)(this + 0x30);
    if (((*(byte *)(lVar5 + 0x1c) & 1) == 0) && ((ulong)(byte)this[0xac] != 0)) {
      uVar9 = 0;
      do {
        if ((~*(ushort *)(lVar5 + 0xc + uVar9 * 2) & *(ushort *)(lVar5 + uVar9 * 2)) != 0) {
          *(byte *)(lVar5 + 0x1c) = *(byte *)(lVar5 + 0x1c) | 1;
          return;
        }
        uVar9 = uVar9 + 1;
      } while ((byte)this[0xac] != uVar9);
    }
  }
  return;
}



// IOAccelResource2::unload()

void __thiscall IOAccelResource2::unload(IOAccelResource2 *this)

{
  long *plVar1;
  
  if (((byte)this[0xc] & 0x10) == 0) {
    if ((this[0x14] == (IOAccelResource2)0xc0) &&
       (plVar1 = *(long **)(this + 0xe0), plVar1 != (long *)0x0)) {
      (**(code **)(*plVar1 + 0x20))(plVar1);
    }
    else {
      plVar1 = (long *)0x0;
    }
    (**(code **)(*(long *)this + 0x260))(this,0x3f,0xffffffff);
    if (plVar1 != (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00025c57. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*plVar1 + 0x28))(plVar1);
      return;
    }
  }
  return;
}



// IOAccelResource2::try_unload()

ulong __thiscall IOAccelResource2::try_unload(IOAccelResource2 *this)

{
  uint uVar1;
  int iVar2;
  long lVar3;
  ulong uVar4;
  long *plVar5;
  long *plVar6;
  
  if (((byte)this[0xc] & 0x10) == 0) {
    uVar1 = *(uint *)(*(long *)(this + 0x88) + 0xc);
    if (((uVar1 & 4) == 0) && (lVar3 = *(long *)(this + 0x80), lVar3 != 0)) {
      if ((uVar1 & 2) == 0) {
        plVar5 = *(long **)(*(long *)(this + 0x88) + 0xd0);
        if (plVar5 != (long *)0x0) {
          iVar2 = (**(code **)(*plVar5 + 0x1f0))(plVar5,8);
          if (iVar2 == 0) {
            lVar3 = *(long *)(this + 0x80);
            goto LAB_00025cc4;
          }
        }
      }
      else {
        plVar5 = (long *)0x0;
LAB_00025cc4:
        if ((*(byte *)(lVar3 + 0xc) & 2) != 0) {
          plVar6 = (long *)0x0;
LAB_00025d14:
          (**(code **)(*(long *)this + 0x188))(this);
          if (plVar5 != (long *)0x0) {
            (**(code **)(*plVar5 + 0x1f8))(plVar5,0);
          }
          if (plVar6 != (long *)0x0) {
            (**(code **)(*plVar6 + 0x1f8))(plVar6,0);
          }
          lVar3 = *(long *)(this + 0x18);
          IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar3 + 0x388) + 0x58),99);
          *(int *)(lVar3 + 0x32c) = *(int *)(lVar3 + 0x32c) + 1;
          uVar4 = CONCAT71((int7)((ulong)lVar3 >> 8),1);
          goto LAB_00025d04;
        }
        plVar6 = *(long **)(lVar3 + 0xd0);
        if (plVar6 != (long *)0x0) {
          iVar2 = (**(code **)(*plVar6 + 0x1f0))(plVar6,8);
          if (iVar2 == 0) goto LAB_00025d14;
        }
        if (plVar5 != (long *)0x0) {
          uVar4 = 0;
          (**(code **)(*plVar5 + 0x1f8))(plVar5,0);
          goto LAB_00025d04;
        }
      }
    }
  }
  uVar4 = 0;
LAB_00025d04:
  return uVar4 & 0xffffffff;
}



// IOAccelResource2::zeroVidMemory(IOAccelEvent*, unsigned long long)

void IOAccelResource2::zeroVidMemory(void)

{
  return;
}



// IOAccelResource2::zero_vidmem()

void __thiscall IOAccelResource2::zero_vidmem(IOAccelResource2 *this)

{
  uintptr_t arg1;
  uintptr_t arg2;
  uintptr_t arg3;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  undefined1 *local_28;
  
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_58 = &DAT_aaaaaaaaaaaaaaaa;
  local_60 = &DAT_aaaaaaaaaaaaaaaa;
  if (___ktrace_kernel_enabled == 0) {
    arg2 = 0;
  }
  else {
    arg2 = _OSAddAtomic64(1,&___globalObjectIDCounter);
    arg1 = *(uintptr_t *)(this + 0x110);
    arg3 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85020078,arg1,arg2,arg3,0,0);
  }
  (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x140))
            (*(long **)(*(long *)(this + 0x18) + 0x380),&local_60);
  (**(code **)(*(long *)this + 0x220))(this,&local_60,arg2);
  (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1b8))
            (*(long **)(*(long *)(this + 0x18) + 0x380),&local_60,*(long *)(this + 0x38) + 0x80);
  (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1b8))
            (*(long **)(*(long *)(this + 0x18) + 0x380),&local_60,*(long *)(this + 0x38) + 0xc0);
  this[0xf] = (IOAccelResource2)((byte)this[0xf] & 0xf7);
  return;
}



// IOAccelResource2::pageonIfNeeded()

void __thiscall IOAccelResource2::pageonIfNeeded(IOAccelResource2 *this)

{
  ushort *puVar1;
  IOAccelResource2 IVar2;
  uintptr_t arg1;
  long lVar3;
  ulonglong uVar4;
  char cVar5;
  uint uVar6;
  int iVar7;
  uintptr_t arg3;
  uintptr_t arg2;
  uintptr_t arg4;
  ulong uVar8;
  undefined8 extraout_RDX;
  long lVar9;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_58 = &DAT_aaaaaaaaaaaaaaaa;
  local_60 = &DAT_aaaaaaaaaaaaaaaa;
  local_68 = &DAT_aaaaaaaaaaaaaaaa;
  if (((byte)this[0xd] & 0x40) != 0) {
    setPurgeable(this,2,1,(uint *)0x0);
  }
  IVar2 = this[0xac];
  if (IVar2 == (IOAccelResource2)0x0) {
    uVar8 = 0;
LAB_00025eff:
    if ((uint)uVar8 != (uint)(byte)IVar2) {
      if (*(IOAccelSysMemory **)(this + 0x80) == (IOAccelSysMemory *)0x0) {
        if (((*(long **)(this + 0x168) != (long *)0x0) &&
            (cVar5 = (**(code **)(**(long **)(this + 0x168) + 0x138))(), cVar5 == '\0')) &&
           (uVar8 = IOGraphicsAccelerator2::freeToPrepareMapping
                              (*(IOGraphicsAccelerator2 **)(this + 0x18),*(long **)(this + 0x168),
                               extraout_RDX), (char)uVar8 == '\0')) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: fGPUPageTableSourceMap failed to prepare.\n",
                            "virtual void IOAccelResource2::pageonIfNeeded()");
          return;
        }
      }
      else {
        uVar6 = *(uint *)(*(long *)(this + 0x18) + 0xc90) & 0x80;
        if ((*(long *)(this + 0xe0) == 0) || (uVar6 == 0)) {
          if ((*(uint *)(this + 0xc) & 0x20) != 0 || uVar6 != 0) {
            IOAccelSysMemory::flushProcessorCacheForOut(*(IOAccelSysMemory **)(this + 0x80));
            this[0xc] = (IOAccelResource2)((byte)this[0xc] & 0xdf);
          }
        }
        else {
          IOSurface::flushProcessorCaches();
        }
      }
      (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x140))
                (*(long **)(*(long *)(this + 0x18) + 0x380),&local_68);
      if (___ktrace_kernel_enabled == 0) {
        arg3 = 0;
      }
      else {
        arg3 = _OSAddAtomic64(1,&___globalObjectIDCounter);
      }
      arg1 = *(uintptr_t *)(this + 0x110);
      arg2 = (**(code **)(**(long **)(this + 0x88) + 0x120))();
      arg4 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x85020030,arg1,arg2,arg3,arg4,0);
      (**(code **)(*(long *)this + 0x1b8))(this,&local_68,(byte)this[0xc] >> 7,arg3);
      (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x18) + 0x380),&local_68,*(undefined8 *)(this + 0x38));
      (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x18) + 0x380),&local_68,*(long *)(this + 0x38) + 0x80)
      ;
      (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x18) + 0x380),&local_68,*(long *)(this + 0x38) + 0xc0)
      ;
      if ((this[0x14] == (IOAccelResource2)0xc0) && (lVar9 = *(long *)(this + 0xe8), lVar9 != 0)) {
        do {
          (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x18) + 0x380),&local_68,
                     *(undefined8 *)(lVar9 + 0x38));
          lVar9 = *(long *)(lVar9 + 0xe8);
        } while (lVar9 != 0);
      }
      IVar2 = this[0xac];
      lVar9 = *(long *)(this + 0x30);
      if ((ulong)(byte)IVar2 != 0) {
        uVar8 = 0;
        do {
          puVar1 = (ushort *)(lVar9 + 0xc + uVar8 * 2);
          *puVar1 = *puVar1 | *(ushort *)(lVar9 + uVar8 * 2);
          uVar8 = uVar8 + 1;
        } while ((byte)IVar2 != uVar8);
      }
      *(byte *)(lVar9 + 0x1c) = *(byte *)(lVar9 + 0x1c) & 0xfe;
      if (*(long **)(this + 0x168) != (long *)0x0) {
        (**(code **)(**(long **)(this + 0x168) + 0x140))();
      }
      if (this[0x14] != (IOAccelResource2)0x40) {
        if (this[0x14] != (IOAccelResource2)0xc0) {
          return;
        }
        lVar9 = *(long *)(this + 0xe0);
        lVar3 = *(long *)(this + 0x18);
        iVar7 = (**(code **)(**(long **)(this + 0x88) + 0x120))();
        uVar4 = *(ulonglong *)(*(long *)(lVar3 + 0x388) + 0x58);
        if (lVar9 != 0) {
          IOSimpleReporter::incrementValue(uVar4,0x19);
          *(int *)(lVar3 + 0x204) = *(int *)(lVar3 + 0x204) + iVar7;
          return;
        }
        IOSimpleReporter::incrementValue(uVar4,0x17);
        *(int *)(lVar3 + 0x1fc) = *(int *)(lVar3 + 0x1fc) + iVar7;
        return;
      }
      uVar6 = *(uint *)(this + 0xc);
      lVar9 = *(long *)(this + 0x18);
      iVar7 = (**(code **)(**(long **)(this + 0x88) + 0x120))();
      uVar4 = *(ulonglong *)(*(long *)(lVar9 + 0x388) + 0x58);
      if ((uVar6 >> 0x1a & 1) == 0) {
        IOSimpleReporter::incrementValue(uVar4,0x16);
        *(int *)(lVar9 + 0x1f8) = *(int *)(lVar9 + 0x1f8) + iVar7;
        return;
      }
      IOSimpleReporter::incrementValue(uVar4,0x18);
      *(int *)(lVar9 + 0x200) = *(int *)(lVar9 + 0x200) + iVar7;
      return;
    }
  }
  else {
    uVar8 = 0;
    do {
      if ((~*(ushort *)(*(long *)(this + 0x30) + 0xc + uVar8 * 2) &
          *(ushort *)(*(long *)(this + 0x30) + uVar8 * 2)) != 0) goto LAB_00025eff;
      uVar8 = uVar8 + 1;
    } while ((uint)(byte)IVar2 != uVar8);
  }
  *(byte *)(*(long *)(this + 0x30) + 0x1c) = *(byte *)(*(long *)(this + 0x30) + 0x1c) & 0xfe;
  return;
}



// IOAccelResource2::gartEvent()

long __thiscall IOAccelResource2::gartEvent(IOAccelResource2 *this)

{
  char *pcVar1;
  long lVar2;
  
  if (((byte)this[0x14] & 0xf) == 10) {
    lVar2 = *(long *)(this + 0x38) + 0x80;
  }
  else if (((byte)this[0x14] & 0xf) == 0) {
    lVar2 = *(long *)(this + 0x38);
  }
  else {
    pcVar1 = objTypeName(this);
    lVar2 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Bogus texture of type %s on GART list\n\n",
                      "virtual sIOAccelEvent *IOAccelResource2::gartEvent()",pcVar1);
  }
  return lVar2;
}



// IOAccelResource2::objTypeName() const

char * __thiscall IOAccelResource2::objTypeName(IOAccelResource2 *this)

{
  IOAccelResource2 IVar1;
  long lVar2;
  char *pcVar3;
  char *pcVar4;
  
  IVar1 = this[0x14];
  if ((byte)IVar1 < 0x40) {
    if ((byte)IVar1 < 4) {
      if (IVar1 == (IOAccelResource2)0x0) {
        return "AGP";
      }
      if (IVar1 == (IOAccelResource2)0x1) {
        return "Surface";
      }
    }
    else {
      if (IVar1 == (IOAccelResource2)0x4) {
        return "SurfaceBuffer";
      }
      if (IVar1 == (IOAccelResource2)0xa) {
        return "Data";
      }
    }
  }
  else if ((byte)IVar1 < 0x82) {
    if (IVar1 == (IOAccelResource2)0x40) {
      return "Standard";
    }
    if (IVar1 == (IOAccelResource2)0x80) {
      lVar2 = *(long *)(this + 0xe0);
      pcVar4 = "SysMemShared";
      pcVar3 = "SysMemShared(IOSurface)";
LAB_000262e7:
      if (lVar2 != 0) {
        return pcVar3;
      }
      return pcVar4;
    }
  }
  else {
    if (IVar1 == (IOAccelResource2)0x82) {
      return "IOSurface";
    }
    if (IVar1 == (IOAccelResource2)0xc0) {
      lVar2 = *(long *)(this + 0xe0);
      pcVar4 = "VidMemShared";
      pcVar3 = "VidMemShared(IOSurface)";
      goto LAB_000262e7;
    }
  }
  return "Unknown";
}



// IOAccelResource2::requirePageoff() const

ulong __thiscall IOAccelResource2::requirePageoff(IOAccelResource2 *this)

{
  IOAccelResource2 IVar1;
  uint uVar2;
  ulong uVar3;
  ulong uVar4;
  long lVar5;
  bool bVar6;
  
  IVar1 = this[0x14];
  if ((byte)IVar1 < 0x80) {
    if (IVar1 == (IOAccelResource2)0x0) {
      return 0;
    }
    if (IVar1 == (IOAccelResource2)0x4) {
      return 0;
    }
  }
  else {
    if (IVar1 == (IOAccelResource2)0x80) {
      return 0;
    }
    if (IVar1 == (IOAccelResource2)0x82) {
      return 0;
    }
  }
  uVar2 = *(uint *)(this + 0xc);
  uVar3 = (ulong)uVar2;
  if ((uVar2 >> 0xf & 1) == 0) {
    uVar4 = (ulong)(byte)this[0xac];
    if ((uVar2 >> 0xe & 1) == 0) {
      if (uVar4 != 0) {
        lVar5 = 0;
        do {
          uVar2 = ~(uint)*(ushort *)(*(long *)(this + 0x30) + lVar5 * 2);
          bVar6 = (*(ushort *)(*(long *)(this + 0x30) + 0xc + lVar5 * 2) & uVar2) != 0;
          uVar3 = (ulong)CONCAT31((int3)(uVar2 >> 8),bVar6);
          if (bVar6) {
            return uVar3;
          }
          bVar6 = uVar4 - 1 != lVar5;
          lVar5 = lVar5 + 1;
        } while (bVar6);
        return uVar3;
      }
    }
    else if (uVar4 != 0) {
      lVar5 = 0;
      do {
        bVar6 = *(short *)(*(long *)(this + 0x30) + 0xc + lVar5 * 2) != 0;
        uVar3 = CONCAT71((int7)(uVar3 >> 8),bVar6);
        if (bVar6) {
          return uVar3;
        }
        bVar6 = uVar4 - 1 != lVar5;
        lVar5 = lVar5 + 1;
      } while (bVar6);
      return uVar3;
    }
  }
  return 0;
}



// IOAccelResource2::requirePageon() const

bool __thiscall IOAccelResource2::requirePageon(IOAccelResource2 *this)

{
  ushort *puVar1;
  ulong uVar2;
  ulong uVar3;
  ulong uVar4;
  bool bVar5;
  
  uVar3 = (ulong)(byte)this[0xac];
  if (uVar3 == 0) {
    bVar5 = false;
  }
  else {
    puVar1 = *(ushort **)(this + 0x30);
    bVar5 = true;
    if ((*puVar1 & ~puVar1[6]) == 0) {
      uVar2 = 1;
      do {
        uVar4 = uVar2;
        if (uVar3 == uVar4) break;
        uVar2 = uVar4 + 1;
      } while ((puVar1[uVar4] & ~puVar1[uVar4 + 6]) == 0);
      bVar5 = uVar4 < uVar3;
    }
  }
  return bVar5;
}



// IOAccelResource2::hasDirtyVidMem() const

bool __thiscall IOAccelResource2::hasDirtyVidMem(IOAccelResource2 *this)

{
  ushort *puVar1;
  ulong uVar2;
  ulong uVar3;
  ulong uVar4;
  bool bVar5;
  
  uVar3 = (ulong)(byte)this[0xac];
  if (uVar3 == 0) {
    bVar5 = false;
  }
  else {
    puVar1 = *(ushort **)(this + 0x30);
    bVar5 = true;
    if ((~*puVar1 & puVar1[6]) == 0) {
      uVar2 = 1;
      do {
        uVar4 = uVar2;
        if (uVar3 == uVar4) break;
        uVar2 = uVar4 + 1;
      } while ((~puVar1[uVar4] & puVar1[uVar4 + 6]) == 0);
      bVar5 = uVar4 < uVar3;
    }
  }
  return bVar5;
}



// IOAccelResource2::pageoffIfNeeded(unsigned int, unsigned int)

void __thiscall
IOAccelResource2::pageoffIfNeeded(IOAccelResource2 *this,uint param_1,ushort param_2)

{
  ushort *puVar1;
  undefined8 *puVar2;
  uintptr_t arg1;
  undefined8 uVar3;
  ulonglong uVar4;
  bool bVar5;
  IOAccelResource2 IVar6;
  int iVar7;
  long *plVar8;
  IOAccelMemory *pIVar9;
  uintptr_t arg3;
  uintptr_t arg2;
  uintptr_t arg4;
  long lVar10;
  uint uVar11;
  short sVar12;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  int local_30;
  byte local_29;
  
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_58 = &DAT_aaaaaaaaaaaaaaaa;
  local_60 = &DAT_aaaaaaaaaaaaaaaa;
  local_68 = &DAT_aaaaaaaaaaaaaaaa;
  local_70 = &DAT_aaaaaaaaaaaaaaaa;
  local_29 = 0;
  IVar6 = this[0x14];
  if ((byte)IVar6 < 0x80) {
    if (IVar6 == (IOAccelResource2)0x0) {
      return;
    }
    if (IVar6 == (IOAccelResource2)0x4) {
      return;
    }
  }
  else {
    if (IVar6 == (IOAccelResource2)0x80) {
      return;
    }
    if (IVar6 == (IOAccelResource2)0x82) {
      return;
    }
  }
  if (*(long *)(this + 0x88) == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Requested pageoff of texture without fVidMemory.  Perhaps there was a previous allocation failure?\n"
                      ,"virtual void IOAccelResource2::pageoffIfNeeded(uint32_t, uint32_t)");
    return;
  }
  if ((*(uint *)(*(long *)(this + 0x88) + 0xc) & 6) == 4) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Requested pageoff for texture not in vram!\n\n",
                      "virtual void IOAccelResource2::pageoffIfNeeded(uint32_t, uint32_t)");
    return;
  }
  if ((*(uint *)(this + 0xc) >> 0xf & 1) != 0) {
    return;
  }
  if (((byte)IVar6 | 0x80) == 0xc0) {
    if ((*(uint *)(this + 0xc) >> 0xe & 1) != 0) {
      setPurgeable(this,2,1,(uint *)0x0);
    }
    if ((*(long *)(this + 0x80) == 0) && (bVar5 = allocBackingMemory(this), !bVar5)) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: allocBackingMemory failed\n",
                        "virtual void IOAccelResource2::pageoffIfNeeded(uint32_t, uint32_t)");
      return;
    }
  }
  IVar6 = this[0xac];
  if (IVar6 == (IOAccelResource2)0x0) {
    uVar11 = 0;
  }
  else {
    uVar11 = 0;
    do {
      if ((((uint)(1L << ((byte)uVar11 & 0x3f)) & param_1) != 0) &&
         ((~*(ushort *)(*(long *)(this + 0x30) + (long)(int)uVar11 * 2) & param_2 &
          *(ushort *)(*(long *)(this + 0x30) + 0xc + (long)(int)uVar11 * 2)) != 0)) break;
      uVar11 = (uint)(short)((short)uVar11 + 1);
    } while ((int)uVar11 < (int)(uint)(byte)IVar6);
  }
  if (uVar11 == (byte)IVar6) {
    return;
  }
  IVar6 = this[0x14];
  if (((byte)IVar6 | 0x40) == 0xc0) {
    if (*(long *)(this + 0xe0) != 0) {
      plVar8 = (long *)IOSurface::getMemoryDescriptor();
      local_30 = -0x55555556;
      iVar7 = (**(code **)(*plVar8 + 0x120))(plVar8,1);
      if ((iVar7 == 0) && (local_30 != 2)) {
        puVar2 = *(undefined8 **)(this + 0x30);
        *puVar2 = 0;
        *(undefined4 *)(puVar2 + 1) = 0;
        *(byte *)((long)puVar2 + 0x1c) = *(byte *)((long)puVar2 + 0x1c) & 0xfe;
        invalidateVidMem(this);
        *(undefined4 *)(*(long *)(this + 0xe0) + 0x50) = 0;
        return;
      }
      IVar6 = this[0x14];
      goto LAB_00026690;
    }
  }
  else {
LAB_00026690:
    if (IVar6 == (IOAccelResource2)0xa) {
      if ((*(byte *)(*(long *)(this + 0x88) + 0xc) & 4) == 0) {
        return;
      }
      pIVar9 = IOAccelSysMemory::withOptions
                         (*(IOGraphicsAccelerator2 **)(this + 0x18),
                          *(undefined8 *)(*(long *)(this + 0x68) + 0x38),0,0,0x10423,
                          *(ulong *)(this + 200));
      if (pIVar9 == (IOAccelMemory *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: IOBMD failed to alloc a data buffer\n",
                          "virtual void IOAccelResource2::pageoffIfNeeded(uint32_t, uint32_t)");
        return;
      }
      pIVar9[0xc] = (IOAccelMemory)((byte)pIVar9[0xc] | 1);
      *(IOAccelMemory **)(this + 0x80) = pIVar9;
      **(undefined2 **)(this + 0x30) = 0;
    }
  }
  lVar10 = *(long *)(this + 0x18);
  if ((*(byte *)(lVar10 + 0xc90) & 0x80) != 0) {
    IOAccelSysMemory::flushProcessorCacheForIn(*(IOAccelSysMemory **)(this + 0x80));
    lVar10 = *(long *)(this + 0x18);
  }
  if (*(int *)(lVar10 + 0xdc8) != 0) {
    return;
  }
  if (___ktrace_kernel_enabled == 0) {
    arg3 = 0;
  }
  else {
    arg3 = _OSAddAtomic64(1,&___globalObjectIDCounter);
  }
  arg1 = *(uintptr_t *)(this + 0x110);
  arg2 = (**(code **)(**(long **)(this + 0x88) + 0x120))();
  arg4 = IORegistryEntry::getRegistryEntryID();
  _kernel_debug(0x85020034,arg1,arg2,arg3,arg4,0);
  if (*(long *)(this + 0x90) != 0) {
    (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1b8))
              (*(long **)(*(long *)(this + 0x18) + 0x380),*(long *)(this + 0x90),
               *(long *)(this + 0x38) + 0x80);
    (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1b8))
              (*(long **)(*(long *)(this + 0x18) + 0x380),*(long *)(this + 0x90) + 0x40,
               *(long *)(this + 0x38) + 0xc0);
  }
  (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x140))
            (*(long **)(*(long *)(this + 0x18) + 0x380),&local_70);
  if (this[0x14] == (IOAccelResource2)0xa) {
    plVar8 = *(long **)(this + 0x60);
    if (plVar8 != (long *)0x0) {
      (**(code **)(*plVar8 + 0x158))(plVar8,0,0x400,0);
    }
    if (*(char *)(*(long *)(this + 0x18) + 0xccc) != '\0') {
      pageoffWithCPU(this);
      local_29 = 1;
      goto LAB_00026881;
    }
    lVar10 = *(long *)this;
    uVar11 = 1;
  }
  else {
    uVar11 = (*(uint *)(this + 0xc) & 0x40) >> 6;
    lVar10 = *(long *)this;
  }
  (**(code **)(lVar10 + 0x1c8))(this,&local_70,uVar11,&local_29,arg3);
LAB_00026881:
  *(uint *)(this + 0xc) = *(uint *)(this + 0xc) & 0xffffff7f | (uint)local_29 << 7;
  (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1b8))
            (*(long **)(*(long *)(this + 0x18) + 0x380),&local_70,*(long *)(this + 0x38) + 0x80);
  (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1b8))
            (*(long **)(*(long *)(this + 0x18) + 0x380),&local_70,*(undefined8 *)(this + 0x38));
  (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1b8))
            (*(long **)(*(long *)(this + 0x18) + 0x380),&local_70,*(long *)(this + 0x38) + 0x40);
  IVar6 = this[0x14];
  if (IVar6 == (IOAccelResource2)0xc0) {
    plVar8 = *(long **)(this + 0xe0);
    if (plVar8 != (long *)0x0) {
      (**(code **)(*plVar8 + 0x140))(plVar8,*(byte *)(*(long *)(this + 0x18) + 0xc90) >> 7);
    }
    lVar10 = *(long *)(this + 0xe8);
    if (lVar10 != 0) {
      do {
        (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x18) + 0x380),&local_70,
                   *(undefined8 *)(lVar10 + 0x38));
        (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x18) + 0x380),&local_70,
                   *(long *)(lVar10 + 0x38) + 0x40);
        lVar10 = *(long *)(lVar10 + 0xe8);
      } while (lVar10 != 0);
    }
    IVar6 = this[0x14];
  }
  if (IVar6 == (IOAccelResource2)0xa) {
    if (*(long *)(this + 0x60) != 0) {
      uVar3 = *(undefined8 *)(*(long *)(this + 0x80) + 0xd0);
      (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x188))
                (*(long **)(*(long *)(this + 0x18) + 0x380),*(long *)(this + 0x38) + 0x80);
      (**(code **)(**(long **)(this + 0x60) + 0x158))(*(long **)(this + 0x60),uVar3,0x400,0);
    }
    if (*(long *)(this + 0x40) != 0) {
      unmap(this);
    }
    plVar8 = *(long **)(this + 0x88);
    plVar8[7] = 0;
    (**(code **)(*plVar8 + 0x28))();
    *(undefined8 *)(this + 0x88) = *(undefined8 *)(this + 0x80);
    *(undefined8 *)(this + 0x80) = 0;
  }
  else {
    IVar6 = this[0xac];
    if (IVar6 != (IOAccelResource2)0x0) {
      lVar10 = *(long *)(this + 0x30);
      sVar12 = 0;
      do {
        puVar1 = (ushort *)(lVar10 + (long)sVar12 * 2);
        *puVar1 = *puVar1 | *(ushort *)(lVar10 + 0xc + (long)sVar12 * 2);
        sVar12 = sVar12 + 1;
      } while (sVar12 < (short)(ushort)(byte)IVar6);
    }
  }
  lVar10 = *(long *)(this + 0x18);
  if ((*(uint *)(lVar10 + 0xc78) & 0x20) == 0) {
    if ((*(uint *)(lVar10 + 0xc78) & 0x40) == 0) {
      if (*(long *)(this + 0xe0) == 0) {
        uVar11 = *(uint *)(this + 0xc);
        iVar7 = (**(code **)(**(long **)(this + 0x88) + 0x120))();
        uVar4 = *(ulonglong *)(*(long *)(lVar10 + 0x388) + 0x58);
        if ((uVar11 >> 0x1a & 1) == 0) {
          IOSimpleReporter::incrementValue(uVar4,0x1f);
          *(int *)(lVar10 + 0x21c) = *(int *)(lVar10 + 0x21c) + iVar7;
        }
        else {
          IOSimpleReporter::incrementValue(uVar4,0x1e);
          *(int *)(lVar10 + 0x218) = *(int *)(lVar10 + 0x218) + iVar7;
        }
      }
      else {
        iVar7 = (**(code **)(**(long **)(this + 0x88) + 0x120))();
        IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar10 + 0x388) + 0x58),0x1d);
        *(int *)(lVar10 + 0x214) = *(int *)(lVar10 + 0x214) + iVar7;
      }
    }
    else {
      iVar7 = (**(code **)(**(long **)(this + 0x88) + 0x120))();
      IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar10 + 0x388) + 0x58),0x20);
      *(int *)(lVar10 + 0x220) = *(int *)(lVar10 + 0x220) + iVar7;
    }
  }
  else if (*(long *)(this + 0xe0) == 0) {
    uVar11 = *(uint *)(this + 0xc);
    iVar7 = (**(code **)(**(long **)(this + 0x88) + 0x120))();
    uVar4 = *(ulonglong *)(*(long *)(lVar10 + 0x388) + 0x58);
    if ((uVar11 >> 0x1a & 1) == 0) {
      IOSimpleReporter::incrementValue(uVar4,0x1c);
      *(int *)(lVar10 + 0x210) = *(int *)(lVar10 + 0x210) + iVar7;
    }
    else {
      IOSimpleReporter::incrementValue(uVar4,0x1b);
      *(int *)(lVar10 + 0x20c) = *(int *)(lVar10 + 0x20c) + iVar7;
    }
  }
  else {
    iVar7 = (**(code **)(**(long **)(this + 0x88) + 0x120))();
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar10 + 0x388) + 0x58),0x1a);
    *(int *)(lVar10 + 0x208) = *(int *)(lVar10 + 0x208) + iVar7;
  }
  return;
}



// IOAccelResource2::invalidateVidMem()

void __thiscall IOAccelResource2::invalidateVidMem(IOAccelResource2 *this)

{
  short *psVar1;
  
  if ((*(byte *)(*(long *)(this + 0x18) + 0xc9c) & 4) == 0) {
    this[0xf] = (IOAccelResource2)((byte)this[0xf] | 8);
  }
  *(undefined8 *)(this + 0xa4) = 0;
  *(undefined8 *)(this + 0x138) = 0;
  *(undefined8 *)(this + 0x140) = 0;
  psVar1 = *(short **)(this + 0x30);
  psVar1[6] = 0;
  psVar1[7] = 0;
  psVar1[8] = 0;
  psVar1[9] = 0;
  psVar1[10] = 0;
  psVar1[0xb] = 0;
  if (((((psVar1[1] != 0 || *psVar1 != 0) || psVar1[2] != 0) || psVar1[3] != 0) || psVar1[4] != 0)
      || psVar1[5] != 0) {
    *(byte *)(psVar1 + 0xe) = *(byte *)(psVar1 + 0xe) | 1;
  }
  return;
}



// IOAccelResource2::pageoffWithCPU()

void __thiscall IOAccelResource2::pageoffWithCPU(IOAccelResource2 *this)

{
  undefined *puVar1;
  long lVar2;
  long lVar3;
  ulong uVar4;
  ulong uVar5;
  
  puVar1 = PTR__kernel_task_0006b100;
  lVar2 = IOAccelSysMemory::lockForCPUAccess
                    (*(IOAccelSysMemory **)(this + 0x80),*(ulonglong *)PTR__kernel_task_0006b100,
                     0x401);
  if (lVar2 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to lock fSysMemory\n",
                      "void IOAccelResource2::pageoffWithCPU()");
    return;
  }
  lVar3 = lock_vidmem(this,*(ulonglong *)puVar1,0x401);
  if (lVar3 != 0) {
    uVar4 = *(ulong *)(this + 200) >> 2 & 0xffffffff;
    if (uVar4 != 0) {
      uVar5 = 0;
      do {
        *(undefined4 *)(lVar3 + uVar5 * 4) = *(undefined4 *)(lVar2 + uVar5 * 4);
        uVar5 = uVar5 + 1;
      } while (uVar4 != uVar5);
    }
    IOAccelSysMemory::flushProcessorCacheForOut(*(IOAccelSysMemory **)(this + 0x80));
    IOAccelSysMemory::unlockForCPUAccess(*(IOAccelSysMemory **)(this + 0x80),*(long *)puVar1);
    unlock_vidmem(this,*(long *)puVar1);
    return;
  }
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to lock fSysMemory\n",
                    "void IOAccelResource2::pageoffWithCPU()");
  IOAccelSysMemory::unlockForCPUAccess(*(IOAccelSysMemory **)(this + 0x80),*(long *)puVar1);
  return;
}



// IOAccelResource2::pageonWithCPU()

void __thiscall IOAccelResource2::pageonWithCPU(IOAccelResource2 *this)

{
  ulong uVar1;
  undefined *puVar2;
  long lVar3;
  long lVar4;
  ulong uVar5;
  
  puVar2 = PTR__kernel_task_0006b100;
  lVar3 = IOAccelSysMemory::lockForCPUAccess
                    (*(IOAccelSysMemory **)(this + 0x80),*(ulonglong *)PTR__kernel_task_0006b100,
                     0x401);
  if (lVar3 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to lock fSysMemory\n",
                      "void IOAccelResource2::pageonWithCPU()");
    return;
  }
  lVar4 = lock_vidmem(this,*(ulonglong *)puVar2,0x401);
  if (lVar4 != 0) {
    uVar1 = *(ulong *)(this + 200);
    if (3 < uVar1) {
      uVar5 = 0;
      do {
        *(undefined4 *)(lVar4 + uVar5 * 4) = *(undefined4 *)(lVar3 + uVar5 * 4);
        uVar5 = uVar5 + 1;
      } while (uVar1 >> 2 != uVar5);
    }
    IOAccelSysMemory::unlockForCPUAccess(*(IOAccelSysMemory **)(this + 0x80),*(long *)puVar2);
    unlock_vidmem(this,*(long *)puVar2);
    return;
  }
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to lock fSysMemory\n",
                    "void IOAccelResource2::pageonWithCPU()");
  IOAccelSysMemory::unlockForCPUAccess(*(IOAccelSysMemory **)(this + 0x80),*(long *)puVar2);
  return;
}



// IOAccelResource2::unlock_vidmem(task*)

void __thiscall IOAccelResource2::unlock_vidmem(IOAccelResource2 *this,long param_1)

{
  long *plVar1;
  IOAccelResource2 *pIVar2;
  
  if (*(long *)PTR__kernel_task_0006b100 == param_1) {
    plVar1 = *(long **)(this + 0x178);
    if (plVar1 == (long *)0x0) goto LAB_00026e65;
    pIVar2 = this + 0x178;
  }
  else {
    plVar1 = *(long **)(this + 0x58);
    if (plVar1 == (long *)0x0) goto LAB_00026e65;
    pIVar2 = this + 0x58;
  }
  (**(code **)(*plVar1 + 0x28))();
  *(undefined8 *)pIVar2 = 0;
LAB_00026e65:
  if ((*(long *)(this + 0x58) == 0) && (*(long *)(this + 0x178) == 0)) {
    (**(code **)(*(long *)this + 0x200))(this);
                    // WARNING: Could not recover jumptable at 0x00026e95. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0x88) + 0x150))();
    return;
  }
  return;
}



// IOAccelResource2::purgeable()

undefined8 __thiscall IOAccelResource2::purgeable(IOAccelResource2 *this)

{
  long lVar1;
  undefined7 uVar2;
  
  lVar1 = *(long *)(this + 0x80);
  uVar2 = (undefined7)((ulong)lVar1 >> 8);
  if (*(long *)(this + 0x88) == 0) {
    if ((lVar1 != 0) && (((byte)this[0xd] & 0x40) != 0)) {
      return CONCAT71(uVar2,1);
    }
  }
  else if (lVar1 == 0) {
    if ((*(uint *)(this + 0xc) >> 0xf & 1) != 0) {
      return 1;
    }
  }
  else if ((~*(uint *)(this + 0xc) & 0xc000) == 0) {
    return CONCAT71(uVar2,1);
  }
  return 0;
}



// IOAccelResource2::isPurgeable()

undefined8 __thiscall IOAccelResource2::isPurgeable(IOAccelResource2 *this)

{
  uint uVar1;
  uint *puVar2;
  ushort *puVar3;
  
  uVar1 = *(uint *)(this + 0xc);
  if ((uVar1 & 0xc000) != 0) {
    if ((uVar1 & 0xc000) == 0xc000) {
      return 0xc001;
    }
    if (((uVar1 >> 0xf & 1) != 0) && (*(long *)(this + 0x88) != 0)) {
      puVar2 = *(uint **)(this + 0x30);
      if ((~*puVar2 & puVar2[3] & 1) != 0) {
        return CONCAT71((int7)((ulong)puVar2 >> 8),1);
      }
    }
    if (((uVar1 >> 0xe & 1) != 0) && (*(long *)(this + 0x80) != 0)) {
      puVar3 = *(ushort **)(this + 0x30);
      if ((~(ushort)*(undefined4 *)(puVar3 + 6) & *puVar3 & 1) != 0) {
        return CONCAT71((int7)((ulong)puVar3 >> 8),1);
      }
    }
  }
  return 0;
}



// IOAccelResource2::isResourcePurgeable()

undefined8 IOAccelResource2::isResourcePurgeable(void)

{
  return 0;
}



// IOAccelResource2::unpurge(bool)

undefined8 __thiscall IOAccelResource2::unpurge(IOAccelResource2 *this,uint param_1)

{
  IOAccelResource2 IVar1;
  short *psVar2;
  long lVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  ulong in_RAX;
  undefined8 uVar7;
  ulong uVar8;
  bool bVar9;
  undefined8 local_38;
  
  local_38 = in_RAX & 0xffffffff00000000;
  if (*(long *)(this + 0x88) != 0) {
    local_38 = (ulong)param_1 << 0x20;
    iVar6 = *(int *)(*(long *)(this + 0xe0) + 0x50);
    iVar4 = IOSurface::getLockSeed();
    bVar9 = iVar6 == iVar4;
    iVar5 = (**(code **)(**(long **)(this + 0x88) + 0x160))(*(long **)(this + 0x88),2,&local_38);
    if (((int)local_38 == 4 && iVar5 == 0) || (iVar6 != iVar4)) {
      if ((*(byte *)(*(long *)(this + 0x18) + 0xc9c) & 4) == 0) {
        this[0xf] = (IOAccelResource2)((byte)this[0xf] | 8);
      }
      *(undefined8 *)(this + 0xa4) = 0;
      *(undefined8 *)(this + 0x138) = 0;
      *(undefined8 *)(this + 0x140) = 0;
      psVar2 = *(short **)(this + 0x30);
      psVar2[6] = 0;
      psVar2[7] = 0;
      psVar2[8] = 0;
      psVar2[9] = 0;
      psVar2[10] = 0;
      psVar2[0xb] = 0;
      if (((((psVar2[1] != 0 || *psVar2 != 0) || psVar2[2] != 0) || psVar2[3] != 0) ||
          psVar2[4] != 0) || psVar2[5] != 0) {
        *(byte *)(psVar2 + 0xe) = *(byte *)(psVar2 + 0xe) | 1;
      }
    }
    this[0xd] = (IOAccelResource2)((byte)this[0xd] & 0x7f);
    IVar1 = this[0xac];
    if ((ulong)(byte)IVar1 != 0) {
      lVar3 = *(long *)(this + 0x30);
      uVar8 = 0;
      do {
        *(undefined2 *)(lVar3 + uVar8 * 2) = 0;
        if (*(short *)(lVar3 + 0xc + uVar8 * 2) == 0) {
          bVar9 = false;
        }
        uVar8 = uVar8 + 1;
      } while ((byte)IVar1 != uVar8);
    }
    if ((bVar9) && (local_38._4_1_ != '\0')) {
      uVar7 = (**(code **)(*(long *)this + 0x260))(this,0x3f,0xffffffff);
      return CONCAT71((int7)((ulong)uVar7 >> 8),1);
    }
    if (bVar9) {
      return 1;
    }
  }
  iVar6 = IOSurface::getLockSeed();
  *(int *)(*(long *)(this + 0xe0) + 0x50) = iVar6 + -1;
  return 0;
}



// IOAccelResource2::testIOSurfacePurgeable()

bool __thiscall IOAccelResource2::testIOSurfacePurgeable(IOAccelResource2 *this)

{
  int iVar1;
  bool bVar2;
  uint in_EAX;
  int iVar3;
  int iVar4;
  ulong uVar5;
  undefined8 uStack_28;
  
  uStack_28 = (ulong)in_EAX;
  if (*(long *)(this + 0x88) == 0) {
    bVar2 = false;
  }
  else {
    iVar1 = *(int *)(*(long *)(this + 0xe0) + 0x50);
    iVar3 = IOSurface::getLockSeed();
    iVar4 = (**(code **)(**(long **)(this + 0x88) + 0x160))
                      (*(long **)(this + 0x88),1,(long)&uStack_28 + 4);
    bVar2 = (uStack_28._4_4_ != 4 || iVar4 != 0) && iVar1 == iVar3;
    if ((ulong)(byte)this[0xac] != 0) {
      uVar5 = 0;
      do {
        if (*(short *)(*(long *)(this + 0x30) + 0xc + uVar5 * 2) == 0) {
          bVar2 = false;
        }
        uVar5 = uVar5 + 1;
      } while ((byte)this[0xac] != uVar5);
    }
  }
  return bVar2;
}



// IOAccelResource2::setPurgeableIOSurface(unsigned int)

void __thiscall IOAccelResource2::setPurgeableIOSurface(IOAccelResource2 *this,int param_1)

{
  short *psVar1;
  int iVar2;
  ulong uVar3;
  long *plVar4;
  byte bVar5;
  undefined1 local_24 [4];
  
  plVar4 = *(long **)(this + 0x88);
  if (plVar4 == (long *)0x0) {
    return;
  }
  if (param_1 == 4) {
    uVar3 = IOAccelDisplayMachine::is_current_display_resource
                      (*(IOAccelDisplayMachine **)(*(long *)(this + 0x18) + 0x378),(long)this);
    plVar4 = *(long **)(this + 0x88);
    if ((char)uVar3 == '\0') {
      if ((*(byte *)((long)plVar4 + 0xc) & 4) != 0) {
        this[0xd] = (IOAccelResource2)((byte)this[0xd] & 0x7f);
        iVar2 = IOSurface::getLockSeed();
        *(int *)(*(long *)(this + 0xe0) + 0x50) = iVar2 + -1;
        if ((*(byte *)(*(long *)(this + 0x18) + 0xc9c) & 4) == 0) {
          this[0xf] = (IOAccelResource2)((byte)this[0xf] | 8);
        }
        *(undefined8 *)(this + 0xa4) = 0;
        *(undefined8 *)(this + 0x138) = 0;
        *(undefined8 *)(this + 0x140) = 0;
        psVar1 = *(short **)(this + 0x30);
        psVar1[6] = 0;
        psVar1[7] = 0;
        psVar1[8] = 0;
        psVar1[9] = 0;
        psVar1[10] = 0;
        psVar1[0xb] = 0;
        if (((((psVar1[1] == 0 && *psVar1 == 0) && psVar1[2] == 0) && psVar1[3] == 0) &&
            psVar1[4] == 0) && psVar1[5] == 0) {
          return;
        }
        *(byte *)(psVar1 + 0xe) = *(byte *)(psVar1 + 0xe) | 1;
        return;
      }
      param_1 = 4;
      bVar5 = 1;
      goto LAB_00027197;
    }
    param_1 = 3;
  }
  bVar5 = 0;
LAB_00027197:
  iVar2 = (**(code **)(*plVar4 + 0x160))(plVar4,param_1,local_24);
  if (iVar2 == 0) {
    if (!(bool)(~bVar5 & 1)) {
      if ((*(byte *)(*(long *)(this + 0x18) + 0xc9c) & 4) == 0) {
        this[0xf] = (IOAccelResource2)((byte)this[0xf] | 8);
      }
      *(undefined8 *)(this + 0xa4) = 0;
      *(undefined8 *)(this + 0x138) = 0;
      *(undefined8 *)(this + 0x140) = 0;
      psVar1 = *(short **)(this + 0x30);
      psVar1[6] = 0;
      psVar1[7] = 0;
      psVar1[8] = 0;
      psVar1[9] = 0;
      psVar1[10] = 0;
      psVar1[0xb] = 0;
      if (((((psVar1[1] != 0 || *psVar1 != 0) || psVar1[2] != 0) || psVar1[3] != 0) ||
          psVar1[4] != 0) || psVar1[5] != 0) {
        *(byte *)(psVar1 + 0xe) = *(byte *)(psVar1 + 0xe) | 1;
      }
      iVar2 = IOSurface::getLockSeed();
      *(int *)(*(long *)(this + 0xe0) + 0x50) = iVar2 + -1;
    }
    *(uint *)(this + 0xc) = *(uint *)(this + 0xc) & 0xffff7fff | (uint)(param_1 == 3) << 0xf;
  }
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::clientRelease(IOAccelShared2*)

void __cdecl IOAccelResource2::clientRelease(long *param_1)

{
  int *piVar1;
  int iVar2;
  
  LOCK();
  piVar1 = (int *)(param_1[6] + 0x18);
  iVar2 = *piVar1;
  *piVar1 = *piVar1 + -1;
  UNLOCK();
  if (iVar2 == 1) {
                    // WARNING: Could not recover jumptable at 0x00027306. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*param_1 + 0x160))();
    return;
  }
  return;
}



// IOAccelResource2::canQuickLockForCPUAccess(eLockType) const

undefined8 __thiscall IOAccelResource2::canQuickLockForCPUAccess(IOAccelResource2 *this,int param_1)

{
  undefined8 uVar1;
  long lVar2;
  long *plVar3;
  
  if (((**(byte **)(this + 0x30) & 1) != 0) && (((byte)this[0xc] & 0x80) != 0)) {
    if (param_1 == 1) {
      plVar3 = *(long **)(*(long *)(this + 0x18) + 0x380);
      lVar2 = *(long *)(this + 0x38) + 0x40;
    }
    else {
      if (param_1 != 2) {
        return 0;
      }
      lVar2 = *(long *)(this + 0x38);
      plVar3 = *(long **)(*(long *)(this + 0x18) + 0x380);
    }
    uVar1 = (**(code **)(*plVar3 + 400))(plVar3,lVar2);
    if ((char)uVar1 != '\0') {
      return CONCAT71((int7)((ulong)uVar1 >> 8),1);
    }
  }
  return 0;
}



// IOAccelResource2::pageoffInLinear()

void __thiscall IOAccelResource2::pageoffInLinear(IOAccelResource2 *this)

{
  uint uVar1;
  ushort *puVar2;
  uint *puVar3;
  
  puVar3 = *(uint **)(this + 0x30);
  if (((((((ushort)puVar3[3] | (ushort)*puVar3) & 1) != 0) && (*(long *)(this + 0x88) != 0)) &&
      (*(long *)(this + 200) != 0)) && (uVar1 = *(uint *)(this + 0xc), (uVar1 >> 0xf & 1) == 0)) {
    *(uint *)(this + 0xc) = uVar1 & 0xfffdffbf | 0x40;
    if ((uVar1 >> 0xe & 1) != 0) {
      setPurgeable(this,2,1,(uint *)0x0);
      puVar3 = *(uint **)(this + 0x30);
    }
    if (((~puVar3[3] & *puVar3 & 1) != 0) && ((*(uint *)(this + 0xc) & 0x80) == 0)) {
      if ((*(uint *)(this + 0xc) >> 0x1b & 1) != 0) {
        zero_vidmem(this);
      }
      (**(code **)(*(long *)this + 0x268))(this);
    }
    if (((byte)this[0xc] & 0x80) == 0) {
      puVar2 = *(ushort **)(this + 0x30);
      if ((puVar2[6] & *puVar2 & 1) != 0) {
        *puVar2 = *puVar2 & 0xfffe;
        (**(code **)(*(long *)this + 0x1d0))(this);
      }
    }
    if ((~(ushort)**(undefined4 **)(this + 0x30) & *(ushort *)(*(undefined4 **)(this + 0x30) + 3) &
        1) != 0) {
      (**(code **)(*(long *)this + 0x260))(this,1,1);
    }
    *(uint *)(this + 0xc) = uVar1 & 0x20040 | *(uint *)(this + 0xc) & 0xfffdffbf;
  }
  return;
}



// IOAccelResource2::lockForCPUAccess(task*, eLockType, unsigned int, bool, unsigned char, unsigned
// char, int*)

long __thiscall
IOAccelResource2::lockForCPUAccess
          (IOAccelResource2 *this,ulonglong param_1,int param_2,uint param_3,char param_4,
          undefined1 param_5,undefined1 param_6,undefined8 param_7)

{
  int *piVar1;
  long *plVar2;
  byte *pbVar3;
  long lVar4;
  bool bVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  long lVar9;
  undefined8 *puVar10;
  uint uVar11;
  IOAccelResource2 *pIVar12;
  
  if (param_2 == 2) {
    if (((byte)this[0xd] & 8) != 0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: already write locked.\n",
                        "mach_vm_address_t IOAccelResource2::lockForCPUAccess(task_t, enum eLockType, IOOptionBits, bool, uint8_t, uint8_t, int32_t *)"
                       );
      return 0;
    }
    if ((((*(ushort **)(this + 0x30))[6] | **(ushort **)(this + 0x30)) & 1) != 0) goto LAB_000275c6;
    if ((*(long *)(this + 0x80) == 0) && (bVar5 = allocBackingMemory(this), !bVar5)) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: allocBackingMemory failed\n",
                        "mach_vm_address_t IOAccelResource2::lockForCPUAccess(task_t, enum eLockType, IOOptionBits, bool, uint8_t, uint8_t, int32_t *)"
                       );
      return 0;
    }
    if (((byte)this[0xd] & 0x40) != 0) {
      setPurgeable(this,2,1,(uint *)0x0);
    }
    lVar9 = IOAccelSysMemory::lockForCPUAccess
                      (*(IOAccelSysMemory **)(this + 0x80),param_1,(ulong)param_3);
    if (lVar9 == 0) goto LAB_000275c6;
LAB_00027864:
    iVar6 = (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x188))
                      (*(long **)(*(long *)(this + 0x18) + 0x380),*(undefined8 *)(this + 0x38));
    lVar4 = *(long *)(this + 0x18);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar4 + 0x388) + 0x58),0x3d);
    piVar1 = (int *)(lVar4 + 0x294);
    *piVar1 = *piVar1 + iVar6;
    this[0xd] = (IOAccelResource2)((byte)this[0xd] | 8);
  }
  else {
    if (param_2 == 1) {
      if (*(ulonglong *)PTR__kernel_task_0006b100 == param_1) {
        if ((*(uint *)(this + 0xc) >> 0x1d & 1) != 0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: already read locked by kernel task.\n",
                            "mach_vm_address_t IOAccelResource2::lockForCPUAccess(task_t, enum eLockType, IOOptionBits, bool, uint8_t, uint8_t, int32_t *)"
                           );
          return 0;
        }
      }
      else if ((*(uint *)(this + 0xc) >> 10 & 1) != 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: already read locked user task.\n",
                          "mach_vm_address_t IOAccelResource2::lockForCPUAccess(task_t, enum eLockType, IOOptionBits, bool, uint8_t, uint8_t, int32_t *)"
                         );
        return 0;
      }
    }
    if ((((*(ushort **)(this + 0x30))[6] | **(ushort **)(this + 0x30)) & 1) == 0) {
      return 0;
    }
LAB_000275c6:
    pIVar12 = this + 0x30;
    if (((byte)this[0xd] & 0x40) != 0) {
      setPurgeable(this,2,1,(uint *)0x0);
    }
    if ((((**(byte **)pIVar12 & 1) == 0) || (((byte)this[0xc] & 0x80) == 0)) ||
       (lVar9 = IOAccelSysMemory::lockForCPUAccess
                          (*(IOAccelSysMemory **)(this + 0x80),param_1,(ulong)param_3), lVar9 == 0))
    {
      if (((param_4 == '\0') && ((*(byte *)(*(long *)pIVar12 + 0xc) & 1) != 0)) &&
         (lVar9 = lock_vidmem(this,param_1,(ulong)param_3), lVar9 != 0)) {
LAB_00027750:
        plVar2 = *(long **)(*(long *)(this + 0x18) + 0x380);
        if (param_2 == 2) {
          iVar6 = (**(code **)(*plVar2 + 0x188))(plVar2,*(long *)(this + 0x38) + 0x80);
          lVar4 = *(long *)(this + 0x18);
          IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar4 + 0x388) + 0x58),0x3d);
          piVar1 = (int *)(lVar4 + 0x294);
          *piVar1 = *piVar1 + iVar6;
          uVar7 = *(uint *)(this + 0xc) | 0x800;
        }
        else {
          iVar6 = (**(code **)(*plVar2 + 0x188))(plVar2,*(long *)(this + 0x38) + 0xc0);
          lVar4 = *(long *)(this + 0x18);
          IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar4 + 0x388) + 0x58),0x3c);
          piVar1 = (int *)(lVar4 + 0x290);
          *piVar1 = *piVar1 + iVar6;
          if (*(ulonglong *)PTR__kernel_task_0006b100 == param_1) {
            uVar7 = *(uint *)(this + 0xc) | 0x20000000;
          }
          else {
            uVar7 = *(uint *)(this + 0xc) | 0x400;
          }
        }
        *(uint *)(this + 0xc) = uVar7;
        puVar10 = (undefined8 *)(*(long *)this + 0x1e0);
        iVar6 = 0;
        goto LAB_000279ed;
      }
      if (((~(*(uint **)pIVar12)[3] & **(uint **)pIVar12 & 1) != 0) &&
         (uVar7 = *(uint *)(this + 0xc), (uVar7 & 0x80) == 0)) {
        *(uint *)(this + 0xc) = uVar7 & 0xfffdffff;
        if ((uVar7 >> 0x1b & 1) != 0) {
          zero_vidmem(this);
        }
        (**(code **)(*(long *)this + 0x268))(this);
        *(uint *)(this + 0xc) = *(uint *)(this + 0xc) & 0xfffdffff | uVar7 & 0x20000;
        if (param_4 == '\0') {
          if ((*(byte *)(*(long *)pIVar12 + 0xc) & 1) == 0) {
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                              "%s: after pageon, vram data still invalid\n",
                              "mach_vm_address_t IOAccelResource2::lockForCPUAccess(task_t, enum eLockType, IOOptionBits, bool, uint8_t, uint8_t, int32_t *)"
                             );
          }
          else {
            lVar9 = lock_vidmem(this,param_1,(ulong)param_3);
            if (lVar9 != 0) goto LAB_00027750;
          }
        }
      }
      pbVar3 = *(byte **)pIVar12;
      if ((pbVar3[0xc] & 1) == 0) {
        return 0;
      }
      uVar7 = *(uint *)(this + 0xc);
      uVar8 = uVar7;
      if ((uVar7 & 0x80) == 0) {
        *pbVar3 = *pbVar3 & 0xfe;
        uVar8 = *(uint *)(this + 0xc);
      }
      *(uint *)(this + 0xc) = uVar8 | 0x40;
      if ((uVar7 >> 6 & 1) == 0) {
        (**(code **)(*(long *)this + 0x1d0))(this);
      }
      (**(code **)(*(long *)this + 0x260))(this,1,1);
      uVar8 = *(uint *)(this + 0xc);
      *(uint *)(this + 0xc) = uVar8 & 0xffffffbf | (uVar7 >> 6 & 1) << 6;
      if (((**(byte **)(this + 0x30) & 1) == 0) || ((uVar8 & 0x80) == 0)) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: after pageoff, sys memory data still invalid or non-linear\n",
                          "mach_vm_address_t IOAccelResource2::lockForCPUAccess(task_t, enum eLockType, IOOptionBits, bool, uint8_t, uint8_t, int32_t *)"
                         );
        return 0;
      }
      lVar9 = IOAccelSysMemory::lockForCPUAccess
                        (*(IOAccelSysMemory **)(this + 0x80),param_1,(ulong)param_3);
      if (lVar9 == 0) {
        return 0;
      }
    }
    if (param_2 == 2) goto LAB_00027864;
    iVar6 = (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x188))
                      (*(long **)(*(long *)(this + 0x18) + 0x380),*(long *)(this + 0x38) + 0x40);
    lVar4 = *(long *)(this + 0x18);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar4 + 0x388) + 0x58),0x3c);
    piVar1 = (int *)(lVar4 + 0x290);
    *piVar1 = *piVar1 + iVar6;
    uVar7 = 0x400;
    if (*(ulonglong *)PTR__kernel_task_0006b100 == param_1) {
      uVar7 = 0x20000000;
    }
    *(uint *)(this + 0xc) = *(uint *)(this + 0xc) | uVar7;
    if ((*(byte *)(*(long *)(this + 0x18) + 0xc90) & 0x80) != 0) {
      IOAccelSysMemory::flushProcessorCacheForIn(*(IOAccelSysMemory **)(this + 0x80));
    }
  }
  lVar9 = lVar9 + *(long *)(this + 0xf8);
  if (*(long *)(this + 0x88) == 0) {
    puVar10 = (undefined8 *)(*(long *)this + 0x1e0);
  }
  else {
    puVar10 = (undefined8 *)(*(long *)this + 0x1e8);
  }
  iVar6 = 1;
LAB_000279ed:
  uVar7 = (*(code *)*puVar10)(this,param_5,param_6,param_7);
  if (*(ulonglong *)PTR__kernel_task_0006b100 == param_1) {
    uVar11 = iVar6 << 0xd;
    uVar8 = *(uint *)(this + 0xc) & 0xffffdfff;
  }
  else {
    uVar11 = iVar6 << 0xc;
    uVar8 = *(uint *)(this + 0xc) & 0xffffefff;
  }
  *(uint *)(this + 0xc) = uVar8 | uVar11;
  return (ulong)uVar7 + lVar9;
}



// IOAccelResource2::unlockForCPUAccess(task*, eLockType)

void __thiscall
IOAccelResource2::unlockForCPUAccess(IOAccelResource2 *this,long param_1,int param_2)

{
  long lVar1;
  byte *pbVar2;
  uint uVar3;
  uint uVar4;
  char *pcVar5;
  
  lVar1 = *(long *)PTR__kernel_task_0006b100;
  uVar4 = *(uint *)(this + 0xc);
  uVar3 = uVar4 & 0x1000;
  if (lVar1 == param_1) {
    uVar3 = uVar4 >> 0xd & 1;
  }
  if (param_2 == 1) {
    if (lVar1 == param_1) {
      if ((uVar4 >> 0x1d & 1) == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: resource is not read locked by kernel task\n",
                          "void IOAccelResource2::unlockForCPUAccess(task_t, enum eLockType)");
        return;
      }
      uVar4 = uVar4 & 0xdfffffff;
    }
    else {
      if ((uVar4 >> 10 & 1) == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: resource is not read locked by usr task\n",
                          "void IOAccelResource2::unlockForCPUAccess(task_t, enum eLockType)");
        return;
      }
      uVar4 = uVar4 & 0xfffffbff;
    }
  }
  else {
    if (param_2 != 2) goto LAB_00027b79;
    if ((uVar4 >> 0xb & 1) == 0) {
      pcVar5 = "user";
      if (lVar1 == param_1) {
        pcVar5 = "kernel";
      }
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: resource is not write locked by %s task\n",
                        "void IOAccelResource2::unlockForCPUAccess(task_t, enum eLockType)",pcVar5);
      return;
    }
    pbVar2 = *(byte **)(this + 0x30);
    if (uVar3 == 0) {
      pbVar2[0xc] = pbVar2[0xc] | 1;
      *pbVar2 = *pbVar2 & 0xfe;
    }
    else {
      *pbVar2 = *pbVar2 | 1;
      pbVar2[0xc] = pbVar2[0xc] & 0xfe;
      this[0xc] = (IOAccelResource2)((byte)this[0xc] | 0x80);
      pbVar2[0x1c] = pbVar2[0x1c] | 1;
      if ((*(byte *)(*(long *)(this + 0x18) + 0xc90) & 0x80) != 0) {
        this[0xc] = (IOAccelResource2)((byte)this[0xc] | 0x20);
      }
    }
    uVar4 = *(uint *)(this + 0xc) & 0xfffff7ff;
  }
  *(uint *)(this + 0xc) = uVar4;
LAB_00027b79:
  if (uVar3 == 0) {
    unlock_vidmem(this,param_1);
    return;
  }
  IOAccelSysMemory::unlockForCPUAccess(*(IOAccelSysMemory **)(this + 0x80),param_1);
  return;
}



// IOAccelResource2::copyResourcePrivate(IOAccelResourcePrivate*)

void IOAccelResource2::copyResourcePrivate(void)

{
  return;
}



// IOAccelResource2::testAllEvents()

ulong __thiscall IOAccelResource2::testAllEvents(IOAccelResource2 *this)

{
  byte bVar1;
  undefined8 uVar2;
  ulong uVar3;
  undefined8 unaff_RBX;
  undefined7 uVar4;
  long lVar5;
  byte bVar6;
  
  bVar6 = 1;
  while( true ) {
    lVar5 = 0;
    unaff_RBX = CONCAT71((int7)((ulong)unaff_RBX >> 8),1);
    do {
      bVar1 = (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 400))
                        (*(long **)(*(long *)(this + 0x18) + 0x380),*(long *)(this + 0x38) + lVar5);
      uVar4 = (undefined7)((ulong)unaff_RBX >> 8);
      bVar1 = (byte)unaff_RBX & bVar1;
      unaff_RBX = CONCAT71(uVar4,bVar1);
      lVar5 = lVar5 + 0x40;
    } while (lVar5 != 0x100);
    if (*(IOAccelMemory **)(this + 0x80) != (IOAccelMemory *)0x0) {
      uVar2 = IOAccelMemory::testAllEvent(*(IOAccelMemory **)(this + 0x80));
      unaff_RBX = CONCAT71(uVar4,bVar1 & (byte)uVar2);
    }
    if (this[0x14] != (IOAccelResource2)0x82) break;
    this = *(IOAccelResource2 **)(this + 0xe0);
    if (this == (IOAccelResource2 *)0x0) goto LAB_00027c21;
    bVar6 = bVar6 & (byte)unaff_RBX;
  }
  if (this[0x14] == (IOAccelResource2)0x4) {
    uVar3 = testAllEvents(*(IOAccelResource2 **)(this + 0xe8));
    bVar6 = (byte)uVar3 & bVar6;
  }
LAB_00027c21:
  return CONCAT71((int7)((ulong)unaff_RBX >> 8),(byte)unaff_RBX & bVar6) & 0xffffffff;
}



// IOAccelResource2::update_iosurface_valid_bits()

void __thiscall IOAccelResource2::update_iosurface_valid_bits(IOAccelResource2 *this)

{
  IOAccelResource2 IVar1;
  long *plVar2;
  long lVar3;
  char cVar4;
  short sVar5;
  
  plVar2 = *(long **)(this + 0xe0);
  cVar4 = (**(code **)(*plVar2 + 0x150))(plVar2);
  if (cVar4 != '\0') {
    cVar4 = (**(code **)(*plVar2 + 0x138))(plVar2);
    if (cVar4 != '\0') {
      IVar1 = this[0xac];
      lVar3 = *(long *)(this + 0x30);
      if (IVar1 != (IOAccelResource2)0x0) {
        sVar5 = 0;
        do {
          *(undefined2 *)(lVar3 + (long)sVar5 * 2) = 0xffff;
          *(undefined2 *)(lVar3 + 0xc + (long)sVar5 * 2) = 0;
          sVar5 = sVar5 + 1;
        } while (sVar5 < (short)(ushort)(byte)IVar1);
      }
      *(byte *)(lVar3 + 0x1c) = *(byte *)(lVar3 + 0x1c) | 1;
    }
  }
  return;
}



// IOAccelResource2::checkDirty()

ulong __thiscall IOAccelResource2::checkDirty(IOAccelResource2 *this)

{
  ushort *puVar1;
  byte *pbVar2;
  IOAccelResource2 IVar3;
  int iVar4;
  IOAccelResource2 *this_00;
  IOAccelSurface *this_01;
  long lVar5;
  undefined8 unaff_RBX;
  ulong uVar6;
  undefined7 uVar7;
  
  uVar7 = (undefined7)((ulong)unaff_RBX >> 8);
  uVar6 = CONCAT71(uVar7,1);
  if ((*(long *)(this + 0x40) == 0) || ((~*(uint *)(*(long *)(this + 0x40) + 0x10) & 5) != 0))
  goto LAB_00027dc9;
  IVar3 = this[0x14];
  if (((byte)IVar3 & 0xf) == 0) {
    if (((byte)IVar3 & 0x40) != 0) {
      if ((*(long *)(this + 0x168) != 0) &&
         (iVar4 = *(int *)(*(long *)(this + 0x168) + 0x110), iVar4 != *(int *)(this + 0x164))) {
        lVar5 = *(long *)(this + 0x30);
        puVar1 = (ushort *)(lVar5 + 0xc);
        *puVar1 = *puVar1 & 0xfffe;
        pbVar2 = (byte *)(lVar5 + 0x1c);
        *pbVar2 = *pbVar2 | 1;
        *(int *)(this + 0x164) = iVar4;
      }
      uVar6 = CONCAT71(uVar7,(*(uint *)(this + 0xc) >> 0x1b & 1) != 0 ||
                             *(char *)(*(long *)(this + 0x30) + 0x1c) != '\0');
      goto LAB_00027dc9;
    }
    *(byte *)(*(long *)(this + 0x30) + 0x1c) = *(byte *)(*(long *)(this + 0x30) + 0x1c) & 0xfe;
  }
  else {
    if (IVar3 == (IOAccelResource2)0x82) {
      this_00 = *(IOAccelResource2 **)(this + 0xe0);
      if (this_00 == (IOAccelResource2 *)0x0) goto LAB_00027dc7;
      update_iosurface_valid_bits(this_00);
      if (*(char *)(*(long *)(this_00 + 0x30) + 0x1c) != '\0') goto LAB_00027dc9;
      IVar3 = this_00[0xf];
    }
    else {
      if (IVar3 == (IOAccelResource2)0x4) {
        lVar5 = *(long *)(this + 0xe8);
      }
      else {
        if (IVar3 != (IOAccelResource2)0x1) goto LAB_00027dc7;
        this_01 = *(IOAccelSurface **)(this + 0xf0);
        if (this_01 == (IOAccelSurface *)0x0) {
          this_01 = (IOAccelSurface *)
                    IOAccelSurfaceList::findSurfaceForID
                              ((IOAccelSurfaceList *)(*(long *)(this + 0x18) + 0xaa8),
                               *(int *)(this + 0x104));
          *(IOAccelSurface **)(this + 0xf0) = this_01;
          if (this_01 == (IOAccelSurface *)0x0) goto LAB_00027dc7;
          IOAccelSurface::add_texture(this_01,(long)this);
        }
        lVar5 = *(long *)(this_01 + (long)(&DAT_000011c0 + (long)*(int *)(this + 0x100) * 8));
      }
      if (*(char *)(*(long *)(lVar5 + 0x30) + 0x1c) != '\0') goto LAB_00027dc9;
      IVar3 = *(IOAccelResource2 *)(lVar5 + 0xf);
    }
    if (((byte)IVar3 & 8) != 0) goto LAB_00027dc9;
  }
LAB_00027dc7:
  uVar6 = 0;
LAB_00027dc9:
  return uVar6 & 0xffffffff;
}



// IOAccelResource2::mapAtAddressLength(unsigned long long, unsigned long long)

ulong __thiscall
IOAccelResource2::mapAtAddressLength(IOAccelResource2 *this,undefined8 param_1,undefined8 param_2)

{
  IOAccelResource2 IVar1;
  IOAccelMemoryMap *this_00;
  ulong uVar2;
  long *plVar3;
  
  IVar1 = this[0x14];
  if ((((byte)IVar1 & 0xf) == 0) || (IVar1 == (IOAccelResource2)0xa)) {
    plVar3 = *(long **)(this + 0x88);
    if ((plVar3 == (long *)0x0) && (plVar3 = *(long **)(this + 0x80), plVar3 == (long *)0x0)) {
      uVar2 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: no memory. resType=0x%x\n",
                        "bool IOAccelResource2::mapAtAddressLength(uint64_t, uint64_t)",IVar1);
    }
    else {
      this_00 = (IOAccelMemoryMap *)
                (**(code **)(*plVar3 + 0x140))
                          (plVar3,*(undefined8 *)(*(long *)(this + 0x68) + 0x48),
                           *(undefined4 *)(this + 0x108),param_1,param_2);
      if (this_00 == (IOAccelMemoryMap *)0x0) {
        uVar2 = 0;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: failed to create mapping. resType=0x%x\n",
                          "bool IOAccelResource2::mapAtAddressLength(uint64_t, uint64_t)",this[0x14]
                         );
      }
      else {
        *(IOAccelMemoryMap **)(this + 0x40) = this_00;
        IOAccelMemoryMap::add_resource(this_00,this);
        *(long **)(this + 0x70) = plVar3;
        *(IOAccelMemoryMap **)(this + 0x20) = this_00 + 0x38;
        uVar2 = CONCAT71((int7)((ulong)this >> 8),1);
      }
    }
  }
  else {
    uVar2 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Unkown resource type. resType=0x%x\n",
                      "bool IOAccelResource2::mapAtAddressLength(uint64_t, uint64_t)",IVar1);
  }
  return uVar2 & 0xffffffff;
}



// IOAccelResource2::map()

ulong __thiscall IOAccelResource2::map(IOAccelResource2 *this)

{
  IOAccelResource2 IVar1;
  undefined8 uVar2;
  undefined8 *puVar3;
  IOAccelSurface *this_00;
  IOAccelMemoryMap *this_01;
  ulong uVar4;
  long *plVar5;
  long *plVar6;
  IOAccelResource2 *pIVar7;
  
  if (*(long *)(this + 0x68) == 0) {
    puVar3 = (undefined8 *)(*(long *)(this + 0x18) + 0x150);
  }
  else {
    puVar3 = (undefined8 *)(*(long *)(this + 0x68) + 0x48);
  }
  if (*(long *)(this + 0x40) == 0) {
    uVar2 = *puVar3;
    IVar1 = this[0x14];
    if ((((byte)IVar1 & 0xf) == 0) || (IVar1 == (IOAccelResource2)0xa)) {
      plVar5 = *(long **)(this + 0x88);
      if (plVar5 == (long *)0x0) {
        pIVar7 = this + 0x80;
LAB_00028049:
        plVar5 = *(long **)pIVar7;
        if (plVar5 == (long *)0x0) {
LAB_00028137:
          uVar4 = 0;
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: no memory. resType=0x%x\n",
                            "bool IOAccelResource2::map()",this[0x14]);
          goto LAB_00028090;
        }
      }
    }
    else {
      if (3 < (byte)IVar1) {
        if (IVar1 == (IOAccelResource2)0x4) {
          plVar6 = *(long **)(this + 0xe8);
        }
        else {
          if (IVar1 != (IOAccelResource2)0x82) goto LAB_000280cc;
          plVar6 = *(long **)(this + 0xe0);
          if (plVar6 == (long *)0x0) goto LAB_00028137;
        }
        goto LAB_00028039;
      }
      if (IVar1 != (IOAccelResource2)0x1) {
        if (IVar1 == (IOAccelResource2)0x3) {
          pIVar7 = this + 0xe0;
          goto LAB_00028049;
        }
LAB_000280cc:
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Unkown resource type. resType=0x%x\n","bool IOAccelResource2::map()")
        ;
        goto LAB_0002808e;
      }
      this_00 = *(IOAccelSurface **)(this + 0xf0);
      if (this_00 == (IOAccelSurface *)0x0) {
        this_00 = (IOAccelSurface *)
                  IOAccelSurfaceList::findSurfaceForID
                            ((IOAccelSurfaceList *)(*(long *)(this + 0x18) + 0xaa8),
                             *(int *)(this + 0x104));
        *(IOAccelSurface **)(this + 0xf0) = this_00;
        if (this_00 == (IOAccelSurface *)0x0) {
          uVar4 = 0;
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: surfaceRef texture\'s IOAccelSurface has been deleted. sufaceId=0x%x\n"
                            ,"bool IOAccelResource2::map()",*(undefined4 *)(this + 0x104));
          goto LAB_00028090;
        }
        IOAccelSurface::add_texture(this_00,(long)this);
      }
      plVar6 = *(long **)(this + 0xf8);
      if (plVar6 == (long *)0x0) {
        plVar6 = *(long **)(this_00 + (long)(&DAT_000011c0 + (long)*(int *)(this + 0x100) * 8));
        if (plVar6 != (long *)0x0) {
          (**(code **)(*plVar6 + 0x20))(plVar6);
          *(long **)(this + 0xf8) = plVar6;
          goto LAB_00028039;
        }
        *(undefined8 *)(this + 0xf8) = 0;
        goto LAB_00028137;
      }
LAB_00028039:
      plVar5 = (long *)plVar6[0x11];
      if (plVar5 == (long *)0x0) {
        pIVar7 = (IOAccelResource2 *)(plVar6 + 0x10);
        goto LAB_00028049;
      }
    }
    this_01 = (IOAccelMemoryMap *)
              (**(code **)(*plVar5 + 0x138))(plVar5,uVar2,*(undefined4 *)(this + 0x108));
    if (this_01 == (IOAccelMemoryMap *)0x0) {
      uVar4 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: failed to create mapping. resType=0x%x\n",
                        "bool IOAccelResource2::map()",this[0x14]);
      goto LAB_00028090;
    }
    *(IOAccelMemoryMap **)(this + 0x40) = this_01;
    IOAccelMemoryMap::add_resource(this_01,this);
    *(long **)(this + 0x70) = plVar5;
    *(IOAccelMemoryMap **)(this + 0x20) = this_01 + 0x38;
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: resource already has a map\n",
                      "bool IOAccelResource2::map()");
  }
LAB_0002808e:
  uVar4 = CONCAT71((int7)((ulong)this >> 8),1);
LAB_00028090:
  return uVar4 & 0xffffffff;
}



// IOAccelResource2::setPrefetch(bool)

void IOAccelResource2::setPrefetch(void)

{
  return;
}



// IOAccelResource2::prepare()

ulong __thiscall IOAccelResource2::prepare(IOAccelResource2 *this)

{
  IOAccelResource2 IVar1;
  char cVar2;
  uintptr_t uVar3;
  ulong uVar4;
  undefined8 *puVar5;
  IOAccelResource2 *pIVar6;
  uintptr_t uVar7;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  long *plVar8;
  
  if (___ktrace_kernel_enabled != 0) {
    _kernel_debug(0x85120011,*(uintptr_t *)(this + 0x110),(ulong)(byte)this[0x14],
                  (ulong)*(ushort *)(this + 0xb0),(ulong)*(ushort *)(this + 0xb2),0);
    if (___ktrace_kernel_enabled != 0) {
      uVar7 = *(uintptr_t *)(this + 0x110);
      IVar1 = this[0x14];
      uVar3 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x85120041,uVar7,(ulong)(byte)IVar1,uVar3,0,0);
    }
  }
  if (*(int *)(this + 0x28) == 0) {
    if (((byte)this[0xe] & 0x10) == 0) {
      plVar8 = *(long **)(this + 0x40);
      if (plVar8 == (long *)0x0) {
        uVar4 = map(this);
        if ((char)uVar4 != '\0') {
          plVar8 = *(long **)(this + 0x40);
          goto LAB_00028222;
        }
        goto LAB_0002848a;
      }
LAB_00028222:
      if ((*(byte *)(plVar8 + 2) & 1) == 0) {
        cVar2 = (**(code **)(*plVar8 + 0x150))();
        if (cVar2 != '\0') goto LAB_0002826e;
        if (*(long *)(this + 0x68) == 0) {
          puVar5 = (undefined8 *)(*(long *)(this + 0x18) + 0x150);
        }
        else {
          puVar5 = (undefined8 *)(*(long *)(this + 0x68) + 0x48);
        }
        cVar2 = (**(code **)(*(long *)*puVar5 + 0x120))
                          ((long *)*puVar5,*(undefined8 *)(this + 0x40));
        if (cVar2 != '\0') goto LAB_0002826e;
        uVar4 = 0;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11);
        if (___ktrace_kernel_enabled == 0) goto LAB_000283a0;
LAB_0002854c:
        _kernel_debug(0x85120012,*(uintptr_t *)(this + 0x110),0,0,0,0);
LAB_0002856a:
        uVar4 = 0;
        if (___ktrace_kernel_enabled != 0) {
          uVar7 = *(uintptr_t *)(this + 0x110);
          IVar1 = this[0x14];
          uVar3 = IORegistryEntry::getRegistryEntryID();
          uVar4 = 0;
          _kernel_debug(0x85120042,uVar7,(ulong)(byte)IVar1,uVar3,0,0);
        }
        goto LAB_000283a0;
      }
LAB_0002826e:
      cVar2 = (**(code **)(**(long **)(this + 0x40) + 0x138))();
      if (cVar2 == '\0') {
        uVar4 = IOGraphicsAccelerator2::freeToPrepareMapping
                          (*(IOGraphicsAccelerator2 **)(this + 0x18),*(long **)(this + 0x40),
                           extraout_RDX);
        if ((char)uVar4 == '\0') {
          pIVar6 = getStorageResource(this);
          if ((((pIVar6 == (IOAccelResource2 *)0x0) || (*(long *)(pIVar6 + 0x88) == 0)) ||
              ((*(byte *)(*(long *)(pIVar6 + 0x88) + 0xc) & 4) == 0)) ||
             ((((byte)pIVar6[0xe] & 1) == 0 ||
              ((*(byte *)(*(long *)(this + 0x18) + 0xc79) & 2) != 0)))) {
            if (___ktrace_kernel_enabled != 0) {
              _kernel_debug(0x85120012,*(uintptr_t *)(this + 0x110),0,0,0,0);
            }
            (**(code **)(**(long **)(*(long *)(this + 0x40) + 0x18) + 0x120))();
            (**(code **)(**(long **)(*(long *)(this + 0x40) + 0x18) + 0x120))();
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                              "%s: failed to wire down system mapping, size=%lld.\n");
            goto LAB_0002856a;
          }
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11);
          cVar2 = (**(code **)(*(long *)pIVar6 + 0x1a0))(pIVar6);
          if (cVar2 == '\0') {
LAB_0002848a:
            if (___ktrace_kernel_enabled == 0) {
              uVar4 = 0;
              goto LAB_000283a0;
            }
            goto LAB_0002854c;
          }
          plVar8 = *(long **)(this + 0x40);
          if (plVar8 == (long *)0x0) {
            uVar4 = map(this);
            if ((char)uVar4 == '\0') goto LAB_0002848a;
            plVar8 = *(long **)(this + 0x40);
          }
          if ((*(byte *)(plVar8 + 2) & 1) == 0) {
            cVar2 = (**(code **)(*plVar8 + 0x150))();
            if (cVar2 == '\0') {
              if (*(long *)(this + 0x68) == 0) {
                puVar5 = (undefined8 *)(*(long *)(this + 0x18) + 0x150);
              }
              else {
                puVar5 = (undefined8 *)(*(long *)(this + 0x68) + 0x48);
              }
              cVar2 = (**(code **)(*(long *)*puVar5 + 0x120))
                                ((long *)*puVar5,*(undefined8 *)(this + 0x40));
              if (cVar2 == '\0') {
                if (___ktrace_kernel_enabled != 0) {
                  _kernel_debug(0x85120012,*(uintptr_t *)(this + 0x110),0,0,0,0);
                }
                __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                  "%s: failed to allocate GPU virtual address for mapping. resType=0x%x\n"
                                 );
                goto LAB_0002856a;
              }
            }
          }
          cVar2 = (**(code **)(**(long **)(this + 0x40) + 0x138))();
          if (cVar2 == '\0') {
            uVar4 = IOGraphicsAccelerator2::freeToPrepareMapping
                              (*(IOGraphicsAccelerator2 **)(this + 0x18),*(long **)(this + 0x40),
                               extraout_RDX_00);
            if ((char)uVar4 == '\0') {
              if (___ktrace_kernel_enabled != 0) {
                _kernel_debug(0x85120012,*(uintptr_t *)(this + 0x110),0,0,0,0);
              }
              __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                "%s: After fall back to system memory still failed to prepare.\n");
              goto LAB_0002856a;
            }
          }
        }
      }
      *(int *)(this + 0x28) = *(int *)(this + 0x28) + 1;
      (**(code **)(**(long **)(this + 0x40) + 0x140))();
      this[0xe] = (IOAccelResource2)((byte)this[0xe] | 0x10);
    }
    else {
      *(undefined4 *)(this + 0x28) = 1;
    }
  }
  else {
    *(int *)(this + 0x28) = *(int *)(this + 0x28) + 1;
  }
  pIVar6 = getStorageResource(this);
  if (pIVar6 == (IOAccelResource2 *)0x0) {
LAB_0002830a:
    if (pIVar6 != this) {
      *(byte *)(*(long *)(this + 0x30) + 0x1c) = *(byte *)(*(long *)(this + 0x30) + 0x1c) & 0xfe;
    }
  }
  else {
    if (*(long *)(pIVar6 + 0x88) == 0) {
      *(byte *)(*(long *)(pIVar6 + 0x30) + 0x1c) = *(byte *)(*(long *)(pIVar6 + 0x30) + 0x1c) & 0xfe
      ;
      goto LAB_0002830a;
    }
    if ((((byte)pIVar6[0x14] & 0xf) == 0) && (*(long *)(pIVar6 + 0xe0) != 0)) {
      update_iosurface_valid_bits(pIVar6);
    }
    if (((byte)pIVar6[0xf] & 8) != 0) {
      zero_vidmem(pIVar6);
    }
    if ((*(byte *)(*(long *)(pIVar6 + 0x30) + 0x1c) & 1) != 0) {
      (**(code **)(*(long *)pIVar6 + 0x180))(pIVar6);
    }
  }
  if ((*(byte *)(*(long *)(this + 0x70) + 0xc) & 4) == 0) {
    *(undefined4 *)(this + 0x10) = *(undefined4 *)(*(long *)(this + 0x18) + 0xa0);
  }
  else {
    IOAccelVidMemoryList::moveMemoryToHead
              ((IOAccelVidMemoryList *)(*(long *)(this + 0x18) + 0xb48),*(long *)(this + 0x70));
  }
  if (___ktrace_kernel_enabled != 0) {
    _kernel_debug(0x85120012,*(uintptr_t *)(this + 0x110),1,0,0,0);
    if (___ktrace_kernel_enabled != 0) {
      pIVar6 = *(IOAccelResource2 **)(this + 0x110);
      IVar1 = this[0x14];
      uVar7 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x85120042,(uintptr_t)pIVar6,(ulong)(byte)IVar1,uVar7,0,0);
    }
  }
  uVar4 = CONCAT71((int7)((ulong)pIVar6 >> 8),1);
LAB_000283a0:
  return uVar4 & 0xffffffff;
}



// IOAccelResource2::complete()

void __thiscall IOAccelResource2::complete(IOAccelResource2 *this)

{
  IOAccelResource2 *pIVar1;
  IOAccelResource2 IVar2;
  
  pIVar1 = this + 0x28;
  *(int *)pIVar1 = *(int *)pIVar1 + -1;
  if (*(int *)pIVar1 == 0) {
    IVar2 = this[0x14];
    if (IVar2 == (IOAccelResource2)0x1) {
      (**(code **)(**(long **)(this + 0xf8) + 0x28))();
      *(undefined8 *)(this + 0xf8) = 0;
      IOAccelMemoryMap::remove_resource(*(IOAccelMemoryMap **)(this + 0x40),(long)this);
      (**(code **)(**(long **)(this + 0x40) + 0x28))();
      *(undefined8 *)(this + 0x40) = 0;
      *(undefined8 *)(this + 0x70) = 0;
      *(undefined8 *)(this + 0x20) = 0;
      this[0xe] = (IOAccelResource2)((byte)this[0xe] & 0xef);
      IVar2 = this[0x14];
    }
    if (IVar2 == (IOAccelResource2)0x3) {
      (**(code **)(**(long **)(this + 0xe0) + 0x1e8))();
      this[0xe] = (IOAccelResource2)((byte)this[0xe] & 0xef);
    }
  }
  return;
}



// IOAccelResource2::prepareInTaskWithOption(IOAccelTask*, unsigned int)

long * __thiscall
IOAccelResource2::prepareInTaskWithOption(IOAccelResource2 *this,long *param_1,undefined4 param_2)

{
  char cVar1;
  long *plVar2;
  ulong uVar3;
  IOAccelResource2 *pIVar4;
  undefined8 uVar5;
  undefined8 extraout_RDX;
  
  do {
    plVar2 = *(long **)(this + 0x88);
    if (((plVar2 == (long *)0x0) && (plVar2 = *(long **)(this + 0x80), plVar2 == (long *)0x0)) ||
       (plVar2 = (long *)(**(code **)(*plVar2 + 0x138))(plVar2,param_1,param_2),
       plVar2 == (long *)0x0)) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to create mapping.\n",
                        "IOAccelMemoryMap *IOAccelResource2::prepareInTaskWithOption(IOAccelTask *, uint32_t)"
                       );
      return (long *)0x0;
    }
    if ((((*(byte *)(plVar2 + 2) & 1) == 0) &&
        (cVar1 = (**(code **)(*plVar2 + 0x150))(plVar2), cVar1 == '\0')) &&
       (cVar1 = (**(code **)(*param_1 + 0x120))(param_1,plVar2), cVar1 == '\0')) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: failed to allocate GPU virtual address for mapping %p.\n",
                        "IOAccelMemoryMap *IOAccelResource2::prepareInTaskWithOption(IOAccelTask *, uint32_t)"
                        ,plVar2);
LAB_0002887f:
      (**(code **)(*plVar2 + 0x28))(plVar2);
      return (long *)0x0;
    }
    cVar1 = (**(code **)(*plVar2 + 0x138))(plVar2);
    if (cVar1 != '\0') {
      return plVar2;
    }
    uVar3 = IOGraphicsAccelerator2::freeToPrepareMapping
                      (*(IOGraphicsAccelerator2 **)(this + 0x18),plVar2,extraout_RDX);
    if ((char)uVar3 != '\0') {
      return plVar2;
    }
    pIVar4 = getStorageResource(this);
    if (((pIVar4 == (IOAccelResource2 *)0x0) || (*(long *)(pIVar4 + 0x88) == 0)) ||
       (((*(byte *)(*(long *)(pIVar4 + 0x88) + 0xc) & 4) == 0 ||
        ((((byte)pIVar4[0xe] & 1) == 0 || ((*(byte *)(*(long *)(this + 0x18) + 0xc79) & 2) != 0)))))
       ) {
      (**(code **)(*(long *)plVar2[3] + 0x120))();
      uVar5 = (**(code **)(*(long *)plVar2[3] + 0x120))();
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: failed to wire down mapping, size=%lld.\n",
                        "IOAccelMemoryMap *IOAccelResource2::prepareInTaskWithOption(IOAccelTask *, uint32_t)"
                        ,uVar5);
      goto LAB_0002887f;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: failed to wire down VRAM mapping size=%llu. trying to fall back to system memory\n"
                      ,
                      "IOAccelMemoryMap *IOAccelResource2::prepareInTaskWithOption(IOAccelTask *, uint32_t)"
                      ,*(undefined8 *)(pIVar4 + 200));
    (**(code **)(*plVar2 + 0x28))(plVar2);
    cVar1 = (**(code **)(*(long *)pIVar4 + 0x1a0))(pIVar4);
    if (cVar1 == '\0') {
      return (long *)0x0;
    }
  } while( true );
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::prepareBackingInTaskWithOption(IOAccelTask*, unsigned int)

long * __cdecl IOAccelResource2::prepareBackingInTaskWithOption(long param_1,long *param_2)

{
  char cVar1;
  long *plVar2;
  ulong uVar3;
  undefined8 extraout_RDX;
  
  plVar2 = (long *)(**(code **)(**(long **)(param_1 + 0x80) + 0x138))();
  if (plVar2 == (long *)0x0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to create mapping.\n",
                      "IOAccelMemoryMap *IOAccelResource2::prepareBackingInTaskWithOption(IOAccelTask *, uint32_t)"
                     );
    return (long *)0x0;
  }
  if ((((*(byte *)(plVar2 + 2) & 1) == 0) &&
      (cVar1 = (**(code **)(*plVar2 + 0x150))(plVar2), cVar1 == '\0')) &&
     (cVar1 = (**(code **)(*param_2 + 0x120))(param_2,plVar2), cVar1 == '\0')) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: failed to allocate GPU virtual address for mapping %p.\n",
                      "IOAccelMemoryMap *IOAccelResource2::prepareBackingInTaskWithOption(IOAccelTask *, uint32_t)"
                      ,plVar2);
  }
  else {
    cVar1 = (**(code **)(*plVar2 + 0x138))(plVar2);
    if (cVar1 != '\0') {
      return plVar2;
    }
    uVar3 = IOGraphicsAccelerator2::freeToPrepareMapping
                      (*(IOGraphicsAccelerator2 **)(param_1 + 0x18),plVar2,extraout_RDX);
    if ((char)uVar3 != '\0') {
      return plVar2;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to wire down mapping %p.\n",
                      "IOAccelMemoryMap *IOAccelResource2::prepareBackingInTaskWithOption(IOAccelTask *, uint32_t)"
                      ,plVar2);
  }
  (**(code **)(*plVar2 + 0x28))(plVar2);
  return (long *)0x0;
}



// IOAccelResource2::allocFallbackMemory()

void __thiscall IOAccelResource2::allocFallbackMemory(IOAccelResource2 *this)

{
  IOAccelSysMemory::withOptions
            (*(IOGraphicsAccelerator2 **)(this + 0x18),0,*(long *)(*(long *)(this + 0x88) + 0x30),
             this,0x423,*(ulong *)(this + 200));
  return;
}



// IOAccelResource2::fallback()

ulong __thiscall IOAccelResource2::fallback(IOAccelResource2 *this,undefined8 param_1)

{
  long *plVar1;
  bool bVar2;
  long lVar3;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  long lVar4;
  ulong uVar5;
  
  lVar3 = (**(code **)(*(long *)this + 0x130))();
  if (lVar3 == 0) {
    uVar5 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: createFallbackMemory failed. res=%p\n",
                      "virtual bool IOAccelResource2::fallback()",this);
  }
  else {
    IOAccelMemory::finishAllEvent(*(IOAccelMemory **)(this + 0x88));
    IOAccelMemory::pruneOrphanedMappings(*(IOAccelMemory **)(this + 0x88),param_1,extraout_RDX);
    lVar4 = lVar3;
    bVar2 = IOAccelMemory::redirectActiveMappings(*(IOAccelMemory **)(this + 0x88),lVar3);
    if (bVar2) {
      IOAccelMemory::pruneOrphanedMappings(*(IOAccelMemory **)(this + 0x88),lVar4,extraout_RDX_00);
      plVar1 = *(long **)(this + 0x88);
      if ((IOAccelResource2 *)plVar1[7] == this) {
        plVar1[7] = 0;
      }
      (**(code **)(*plVar1 + 0x28))();
      *(long *)(this + 0x88) = lVar3;
      this[0xf] = (IOAccelResource2)((byte)this[0xf] | 2);
      uVar5 = CONCAT71((int7)((ulong)lVar3 >> 8),1);
    }
    else {
      uVar5 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: redirectActiveMappings failed. res=%p, memory=%p\n",
                        "virtual bool IOAccelResource2::fallback()",this,lVar3);
    }
  }
  return uVar5 & 0xffffffff;
}



// IOAccelResource2::getPhysicalOffset(unsigned long long, unsigned long long*)

undefined8 __thiscall
IOAccelResource2::getPhysicalOffset(IOAccelResource2 *this,undefined8 param_1,undefined8 *param_2)

{
  undefined8 uVar1;
  
  if ((((byte)this[0xe] & 0x10) == 0) || (*(long *)(this + 0x88) == 0)) {
    uVar1 = 0;
  }
  else {
    (**(code **)(*(long *)this + 0x170))(this);
    uVar1 = (**(code **)(**(long **)(this + 0x88) + 0x158))(*(long **)(this + 0x88),param_1);
    *param_2 = uVar1;
    uVar1 = (**(code **)(*(long *)this + 0x178))(this);
    uVar1 = CONCAT71((int7)((ulong)uVar1 >> 8),1);
  }
  return uVar1;
}



// IOAccelResource2::updateReadWriteBits(bool, bool)

void __thiscall
IOAccelResource2::updateReadWriteBits(IOAccelResource2 *this,int param_2_00,char param_2)

{
  bool bVar1;
  
  bVar1 = true;
  if ((param_2_00 != 0) && ((*(uint *)(this + 0xc) >> 8 & 1) == 0)) {
    *(uint *)(this + 0xc) = *(uint *)(this + 0xc) | 0x100;
    this[0x108] = (IOAccelResource2)((byte)this[0x108] | 1);
    bVar1 = false;
  }
  if ((param_2 == '\0') || ((*(uint *)(this + 0xc) >> 9 & 1) != 0)) {
    if (bVar1) {
      return;
    }
  }
  else {
    *(uint *)(this + 0xc) = *(uint *)(this + 0xc) | 0x200;
    this[0x108] = (IOAccelResource2)((byte)this[0x108] | 2);
  }
  if (*(IOAccelMemoryMap **)(this + 0x40) != (IOAccelMemoryMap *)0x0) {
    IOAccelMemoryMap::remove_resource(*(IOAccelMemoryMap **)(this + 0x40),(long)this);
    (**(code **)(**(long **)(this + 0x40) + 0x28))();
    *(undefined8 *)(this + 0x40) = 0;
    *(undefined8 *)(this + 0x70) = 0;
    *(undefined8 *)(this + 0x20) = 0;
    this[0xe] = (IOAccelResource2)((byte)this[0xe] & 0xef);
  }
  return;
}



// IOAccelResource2::getGPUTask() const

undefined8 __thiscall IOAccelResource2::getGPUTask(IOAccelResource2 *this)

{
  undefined8 *puVar1;
  
  if (*(long *)(this + 0x68) == 0) {
    puVar1 = (undefined8 *)(*(long *)(this + 0x18) + 0x150);
  }
  else {
    puVar1 = (undefined8 *)(*(long *)(this + 0x68) + 0x48);
  }
  return *puVar1;
}



// IOAccelResource2::get_surface_buffer_reqbit()

int __thiscall IOAccelResource2::get_surface_buffer_reqbit(IOAccelResource2 *this)

{
  int iVar1;
  
  iVar1 = 0;
  if (((byte)this[0xc] & 8) == 0) {
    iVar1 = 1 << ((byte)this[0x100] & 0x1f);
  }
  return iVar1;
}



// IOAccelResource2::describeAllocations(IOAccelAllocationInfo*)

void __thiscall
IOAccelResource2::describeAllocations(IOAccelResource2 *this,IOAccelAllocationInfo *param_1)

{
  IOAccelResource2 IVar1;
  long *plVar2;
  uint uVar3;
  IOAccelResource2 *pIVar4;
  ulonglong uVar5;
  int iVar6;
  
  if (((byte)this[0xc] & 0x10) != 0) {
    return;
  }
  if ((((byte)this[0x14] & 0xf) == 0) && (*(long *)(this + 0xe0) != 0)) {
    uVar3 = IOSurface::getSurfaceID();
    IOAccelAllocationInfo::addIOSurfaceID(param_1,*(ulong *)(this + 0x80),uVar3);
    if (*(ulong *)(this + 0x88) != 0) {
      IOAccelAllocationInfo::addIOSurfaceID(param_1,*(ulong *)(this + 0x88),uVar3);
    }
  }
  pIVar4 = getStorageResource(this);
  if (((pIVar4 != (IOAccelResource2 *)0x0) && (*(ulong *)(pIVar4 + 0x88) != 0)) &&
     (*(long *)(pIVar4 + 0x80) != 0)) {
    IOAccelAllocationInfo::setCacheCopy(param_1,*(ulong *)(pIVar4 + 0x88));
  }
  if (*(long *)(this + 0x68) == 0) {
    iVar6 = -1;
  }
  else {
    iVar6 = *(int *)(*(long *)(this + 0x68) + 0x40);
  }
  IVar1 = this[0x14];
  if (((IVar1 == (IOAccelResource2)0x1) || (IVar1 == (IOAccelResource2)0x82)) ||
     (IVar1 == (IOAccelResource2)0x4)) {
    if (pIVar4 == (IOAccelResource2 *)0x0) {
      return;
    }
    if (*(long *)(pIVar4 + 0x80) != 0) {
      IOAccelAllocationInfo::addResource();
      IOAccelAllocationInfo::addPID(param_1,*(ulong *)(pIVar4 + 0x80),iVar6);
    }
    if (*(long *)(pIVar4 + 0x88) == 0) {
      return;
    }
    IOAccelAllocationInfo::addResource();
    this = pIVar4;
    goto LAB_00028e40;
  }
  if ((*(long *)(this + 0x80) != 0) && (IOAccelAllocationInfo::addResource(), iVar6 != -1)) {
    IOAccelAllocationInfo::addPID(param_1,*(ulong *)(this + 0x80),iVar6);
    plVar2 = *(long **)(this + 0x80);
    if (*(long **)(this + 0x60) == (long *)0x0) {
      if ((*(byte *)((long)plVar2 + 0xc) & 0x40) == 0) goto LAB_00028e19;
      uVar5 = plVar2[0x19];
      (**(code **)(*plVar2 + 0x120))(plVar2);
    }
    else {
      uVar5 = (**(code **)(**(long **)(this + 0x60) + 0x118))();
      (**(code **)(**(long **)(this + 0x60) + 0x128))();
    }
    IOAccelAllocationInfo::addUserMapping(param_1,(ulong)plVar2,iVar6,uVar5);
  }
LAB_00028e19:
  if ((*(long *)(this + 0x88) == 0) || (IOAccelAllocationInfo::addResource(), iVar6 == -1)) {
    return;
  }
LAB_00028e40:
  IOAccelAllocationInfo::addPID(param_1,*(ulong *)(this + 0x88),iVar6);
  return;
}



// IOAccelResource2::describeAllocationsWithString(IOAccelAllocationInfo*, char const*)

void __thiscall
IOAccelResource2::describeAllocationsWithString
          (IOAccelResource2 *this,IOAccelAllocationInfo *param_1,char *param_2)

{
  if (*(ulong *)(this + 0x80) != 0) {
    IOAccelAllocationInfo::addString(param_1,*(ulong *)(this + 0x80),param_2);
  }
  if (*(ulong *)(this + 0x88) != 0) {
    IOAccelAllocationInfo::addString(param_1,*(ulong *)(this + 0x88),param_2);
    return;
  }
  return;
}



// IOAccelResource2::describeAllocationsWithPID(IOAccelAllocationInfo*, int)

void __thiscall
IOAccelResource2::describeAllocationsWithPID
          (IOAccelResource2 *this,IOAccelAllocationInfo *param_1,int param_2)

{
  if (*(ulong *)(this + 0x80) != 0) {
    IOAccelAllocationInfo::addPID(param_1,*(ulong *)(this + 0x80),param_2);
  }
  if (*(ulong *)(this + 0x88) != 0) {
    IOAccelAllocationInfo::addPID(param_1,*(ulong *)(this + 0x88),param_2);
    return;
  }
  return;
}



// IOAccelResource2::describeAllocationsWithSurface(IOAccelAllocationInfo*, unsigned int, char
// const*, unsigned int, unsigned int, char const*)

void __thiscall
IOAccelResource2::describeAllocationsWithSurface
          (IOAccelResource2 *this,IOAccelAllocationInfo *param_1,uint param_2,char *param_3,
          uint param_4,uint param_5,char *param_6)

{
  if (*(ulong *)(this + 0x80) != 0) {
    IOAccelAllocationInfo::addSurfaceDescription
              (param_1,*(ulong *)(this + 0x80),param_2,param_3,param_4,param_5,param_6);
  }
  if (*(ulong *)(this + 0x88) != 0) {
    IOAccelAllocationInfo::addSurfaceDescription
              (param_1,*(ulong *)(this + 0x88),param_2,param_3,param_4,param_5,param_6);
    return;
  }
  return;
}



// IOAccelResource2::retain() const

void __thiscall IOAccelResource2::retain(IOAccelResource2 *this)

{
  if (*(int *)(this + 0x2c) != -1) {
    *(int *)(this + 0x2c) = *(int *)(this + 0x2c) + 1;
    return;
  }
  retain();
  return;
}



// IOAccelResource2::release() const

void __thiscall IOAccelResource2::release(IOAccelResource2 *this)

{
  int iVar1;
  
  iVar1 = *(int *)(this + 0x2c);
  *(int *)(this + 0x2c) = iVar1 + -1;
  if (iVar1 == 1) {
                    // WARNING: Could not recover jumptable at 0x00028fca. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*(long *)this + 0x90))();
    return;
  }
  return;
}



// IOAccelResource2::dirtyFaceLevels(unsigned int, unsigned int)

void __thiscall
IOAccelResource2::dirtyFaceLevels(IOAccelResource2 *this,uint param_1,ushort param_2)

{
  ushort *puVar1;
  long lVar2;
  
  if (param_1 < 6) {
    lVar2 = *(long *)(this + 0x30);
    puVar1 = (ushort *)(lVar2 + (ulong)param_1 * 2);
    *puVar1 = *puVar1 | param_2;
    puVar1 = (ushort *)(lVar2 + 0xc + (ulong)param_1 * 2);
    *puVar1 = *puVar1 & ~param_2;
    *(byte *)(lVar2 + 0x1c) = *(byte *)(lVar2 + 0x1c) | 1;
  }
  return;
}



// IOAccelResource2::dirtyBufferRange(unsigned int, unsigned int)

void __thiscall
IOAccelResource2::dirtyBufferRange(IOAccelResource2 *this,undefined4 param_1,undefined4 param_2)

{
                    // WARNING: Could not recover jumptable at 0x00029005. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x230))(this,param_1,param_2);
  return;
}



// IOAccelResource2::dirtyBufferRange(unsigned long long, unsigned long long)

void __thiscall
IOAccelResource2::dirtyBufferRange(IOAccelResource2 *this,ulong param_1,long param_2)

{
  ushort *puVar1;
  ulong uVar2;
  ulong uVar3;
  ulong uVar4;
  
  puVar1 = *(ushort **)(this + 0x30);
  uVar2 = *(ulong *)(this + 0x138);
  uVar4 = param_1;
  if (uVar2 < param_1) {
    uVar4 = uVar2;
  }
  uVar3 = param_2 + param_1;
  if (param_2 + param_1 <= *(long *)(this + 0x140) + uVar2) {
    uVar3 = *(long *)(this + 0x140) + uVar2;
  }
  *(int *)(this + 0xa4) = (int)uVar4;
  *(int *)(this + 0xa8) = (int)(uVar3 - uVar4);
  *(ulong *)(this + 0x138) = uVar4;
  *(ulong *)(this + 0x140) = uVar3 - uVar4;
  *puVar1 = *puVar1 | 1;
  *(byte *)(puVar1 + 6) = (byte)puVar1[6] & 0xfe;
  *(byte *)(puVar1 + 0xe) = (byte)puVar1[0xe] | 1;
  return;
}



// IOAccelResource2::dirtyVendorCommand(unsigned int, unsigned long long)

void IOAccelResource2::dirtyVendorCommand(void)

{
  return;
}



// IOAccelResource2::scrubEvents()

void __thiscall IOAccelResource2::scrubEvents(IOAccelResource2 *this)

{
  IOAccelResource2 *pIVar1;
  long lVar2;
  
  pIVar1 = getStorageResource(this);
  if ((pIVar1 != (IOAccelResource2 *)0x0) && (pIVar1 != this)) {
    (**(code **)(*(long *)pIVar1 + 0x228))(pIVar1);
  }
  if (((byte)this[0xf] & 0x10) != 0) {
    (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x270))
              (*(long **)(*(long *)(this + 0x18) + 0x380),*(undefined8 *)(this + 0x90));
    (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x270))
              (*(long **)(*(long *)(this + 0x18) + 0x380),*(long *)(this + 0x90) + 0x40);
  }
  lVar2 = 0;
  do {
    (**(code **)(**(long **)(*(long *)(this + 0x18) + 0x380) + 0x270))
              (*(long **)(*(long *)(this + 0x18) + 0x380),*(long *)(this + 0x38) + lVar2);
    lVar2 = lVar2 + 0x40;
  } while (lVar2 != 0x100);
  if (*(IOAccelMemory **)(this + 0x80) != (IOAccelMemory *)0x0) {
    IOAccelMemory::scrubAllEvents(*(IOAccelMemory **)(this + 0x80));
  }
  if (*(IOAccelMemory **)(this + 0x88) != (IOAccelMemory *)0x0) {
    IOAccelMemory::scrubAllEvents(*(IOAccelMemory **)(this + 0x88));
    return;
  }
  return;
}



// IOAccelResource2::getKernelData()

undefined8 __thiscall IOAccelResource2::getKernelData(IOAccelResource2 *this)

{
  undefined8 uVar1;
  long lVar2;
  IOAccelKernelMappedMemory *this_00;
  long *plVar3;
  OSMetaClassBase *pOVar4;
  
  plVar3 = *(long **)(this + 0x170);
  if (plVar3 != (long *)0x0) {
LAB_00029139:
                    // WARNING: Could not recover jumptable at 0x00029146. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (**(code **)(*plVar3 + 0x118))();
    return uVar1;
  }
  pOVar4 = *(OSMetaClassBase **)(this + 0x88);
  if (pOVar4 == (OSMetaClassBase *)0x0) {
    pOVar4 = *(OSMetaClassBase **)(this + 0x80);
  }
  lVar2 = OSMetaClassBase::safeMetaCast(pOVar4,(OSMetaClass *)&IOAccelSysMemory::gMetaClass);
  if (lVar2 != 0) {
    this_00 = IOAccelKernelMappedMemory::operator_new
                        ((IOAccelKernelMappedMemory *)&segment_command_00000020.vmsize);
    IOAccelKernelMappedMemory::IOAccelKernelMappedMemory(this_00);
    *(IOAccelKernelMappedMemory **)(this + 0x170) = this_00;
    if (this_00 != (IOAccelKernelMappedMemory *)0x0) {
      uVar1 = IOAccelKernelMappedMemory::init
                        (this_00,*(long *)(this + 0x18),*(long **)(lVar2 + 0xd0));
      if ((char)uVar1 != '\0') {
        plVar3 = *(long **)(this + 0x170);
        goto LAB_00029139;
      }
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Failed to create fKernelMap for data buffer\n",
                        "void *IOAccelResource2::getKernelData()");
      (**(code **)(**(long **)(this + 0x170) + 0x28))();
      *(undefined8 *)(this + 0x170) = 0;
    }
  }
  return 0;
}



// IOAccelResource2::releaseKernelData()

void __thiscall IOAccelResource2::releaseKernelData(IOAccelResource2 *this)

{
  if (*(long **)(this + 0x170) != (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00029220. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0x170) + 0x120))();
    return;
  }
  return;
}



// IOAccelResource2::glkwarning_reading_garbage()

void __thiscall IOAccelResource2::glkwarning_reading_garbage(IOAccelResource2 *this)

{
  char *pcVar1;
  
  pcVar1 = "IOSurface";
  if (*(long *)(this + 0xe0) == 0) {
    pcVar1 = "";
  }
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                    "Reading garbage: texbuf:%p dim:[%dx%d] resType:0x%x %s\n\n",this,
                    *(undefined2 *)(this + 0xb0),*(undefined2 *)(this + 0xb2),this[0x14],pcVar1);
  return;
}



// IOAccelResource2::setOwnership(task*)

undefined8 __thiscall IOAccelResource2::setOwnership(IOAccelResource2 *this,int param_1)

{
  IOAccelResource2 IVar1;
  undefined8 uVar2;
  
  IVar1 = this[0x14];
  if ((byte)IVar1 < 0x40) {
    if ((IVar1 != (IOAccelResource2)0x0) && (IVar1 != (IOAccelResource2)0xa)) {
      return 0xe00002c2;
    }
  }
  else if (((IVar1 != (IOAccelResource2)0x40) && (IVar1 != (IOAccelResource2)0xc0)) &&
          (IVar1 != (IOAccelResource2)0x80)) {
    return 0xe00002c2;
  }
  if (*(long *)(this + 0x80) == 0) {
    return 0xe00002c2;
  }
  uVar2 = IOMemoryDescriptor::setOwnership(*(task **)(*(long *)(this + 0x80) + 0xd0),param_1,4);
  return uVar2;
}



// IOAccelResource2::_RESERVEDIOAccelResource2()

void IOAccelResource2::_RESERVEDIOAccelResource2(void)

{
  OSMetaClass::reservedCalled(0x82408);
  return;
}



// IOAccelResource2::_RESERVEDIOAccelResource3()

void IOAccelResource2::_RESERVEDIOAccelResource3(void)

{
  OSMetaClass::reservedCalled(0x82408);
  return;
}



// IOAccelResource2::_RESERVEDIOAccelResource4()

void IOAccelResource2::_RESERVEDIOAccelResource4(void)

{
  OSMetaClass::reservedCalled(0x82408);
  return;
}



// IOAccelResource2::_RESERVEDIOAccelResource5()

void IOAccelResource2::_RESERVEDIOAccelResource5(void)

{
  OSMetaClass::reservedCalled(0x82408);
  return;
}



// IOAccelResource2::getRetainCount() const

undefined4 __thiscall IOAccelResource2::getRetainCount(IOAccelResource2 *this)

{
  return *(undefined4 *)(this + 0x2c);
}



// IOAccelResource2::pageon(IOAccelEvent*, bool)

void IOAccelResource2::pageon(void)

{
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::pageon(IOAccelEvent*, bool, unsigned long long)

void __cdecl IOAccelResource2::pageon(long *param_1)

{
                    // WARNING: Could not recover jumptable at 0x0002935f. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*param_1 + 0x1b0))();
  return;
}



// IOAccelResource2::pageoff(IOAccelEvent*, bool, bool*)

void IOAccelResource2::pageoff(void)

{
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelResource2::pageoff(IOAccelEvent*, bool, bool*, unsigned long long)

void __cdecl IOAccelResource2::pageoff(long *param_1)

{
                    // WARNING: Could not recover jumptable at 0x00029377. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*param_1 + 0x1c0))();
  return;
}



// IOAccelResource2::getMemoryAllocParameter()

undefined8 IOAccelResource2::getMemoryAllocParameter(void)

{
  return 0;
}



// IOAccelResource2::MetaClass::~MetaClass()

void __thiscall IOAccelResource2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelResource_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelResource2::gMetaClass,"IOAccelResource2",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x180);
  _gMetaClass = &PTR__MetaClass_00077960;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelResource2::gMetaClass);
  return;
}



// IOAccelRemoteMemory::MetaClass::MetaClass()

void __thiscall IOAccelRemoteMemory::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelRemoteMemory",(OSMetaClass *)&IOAccelMemory::gMetaClass,
             0xd0);
  *(undefined ***)this = &PTR__MetaClass_00077c80;
  return;
}



// IOAccelRemoteMemory::MetaClass::~MetaClass()

void __thiscall IOAccelRemoteMemory::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelRemoteMemory::IOAccelRemoteMemory(OSMetaClass const*)

void __thiscall
IOAccelRemoteMemory::IOAccelRemoteMemory(IOAccelRemoteMemory *this,OSMetaClass *param_1)

{
  IOAccelMemory::IOAccelMemory((IOAccelMemory *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelRemoteMemory_00077a58;
  return;
}



// IOAccelRemoteMemory::IOAccelRemoteMemory(OSMetaClass const*)

void __thiscall
IOAccelRemoteMemory::IOAccelRemoteMemory(IOAccelRemoteMemory *this,OSMetaClass *param_1)

{
  IOAccelMemory::IOAccelMemory((IOAccelMemory *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelRemoteMemory_00077a58;
  return;
}



// IOAccelRemoteMemory::~IOAccelRemoteMemory()

void __thiscall IOAccelRemoteMemory::~IOAccelRemoteMemory(IOAccelRemoteMemory *this)

{
  IOAccelMemory::~IOAccelMemory((IOAccelMemory *)this);
  return;
}



// IOAccelRemoteMemory::~IOAccelRemoteMemory()

void __thiscall IOAccelRemoteMemory::~IOAccelRemoteMemory(IOAccelRemoteMemory *this)

{
  IOAccelMemory::~IOAccelMemory((IOAccelMemory *)this);
  return;
}



// IOAccelRemoteMemory::~IOAccelRemoteMemory()

void __thiscall IOAccelRemoteMemory::~IOAccelRemoteMemory(IOAccelRemoteMemory *this)

{
  IOAccelMemory::~IOAccelMemory((IOAccelMemory *)this);
  _OSObject_typed_operator_delete(&IOAccelRemoteMemory_ktv,this,0xd0);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelRemoteMemory::operator delete(void*, unsigned long)

void __cdecl IOAccelRemoteMemory::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelRemoteMemory_ktv,param_1,param_2);
  return;
}



// IOAccelRemoteMemory::getMetaClass() const

undefined1 * IOAccelRemoteMemory::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelRemoteMemory::MetaClass::MetaClass()

void __thiscall IOAccelRemoteMemory::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelRemoteMemory",(OSMetaClass *)&IOAccelMemory::gMetaClass,
             0xd0);
  *(undefined ***)this = &PTR__MetaClass_00077c80;
  return;
}



// IOAccelRemoteMemory::MetaClass::alloc() const

IOAccelMemory * IOAccelRemoteMemory::MetaClass::alloc(void)

{
  IOAccelMemory *this;
  
  this = (IOAccelMemory *)_OSObject_typed_operator_new(&IOAccelRemoteMemory_ktv,0xd0);
  IOAccelMemory::IOAccelMemory(this,(OSMetaClass *)&IOAccelRemoteMemory::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelRemoteMemory_00077a58;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelRemoteMemory::operator new(unsigned long)

void * __thiscall IOAccelRemoteMemory::operator_new(IOAccelRemoteMemory *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelRemoteMemory_ktv,this);
  return pvVar1;
}



// IOAccelRemoteMemory::IOAccelRemoteMemory()

void __thiscall IOAccelRemoteMemory::IOAccelRemoteMemory(IOAccelRemoteMemory *this)

{
  IOAccelMemory::IOAccelMemory((IOAccelMemory *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelRemoteMemory_00077a58;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelRemoteMemory::IOAccelRemoteMemory()

void __thiscall IOAccelRemoteMemory::IOAccelRemoteMemory(IOAccelRemoteMemory *this)

{
  IOAccelMemory::IOAccelMemory((IOAccelMemory *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelRemoteMemory_00077a58;
  OSMetaClass::instanceConstructed();
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelRemoteMemory::withPeerIDs(IOGraphicsAccelerator2*, IOAccelShared2*, unsigned long long,
// unsigned int, unsigned int)

void __cdecl IOAccelRemoteMemory::withPeerIDs(long *param_1)

{
                    // WARNING: Could not recover jumptable at 0x000295ab. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*param_1 + 0xaa0))();
  return;
}



// IOAccelRemoteMemory::init(IOGraphicsAccelerator2*, IOAccelShared2*, unsigned long long, unsigned
// int, unsigned int)

undefined8 __thiscall
IOAccelRemoteMemory::init
          (IOAccelRemoteMemory *this,undefined8 param_1,undefined8 param_2,undefined8 param_3,
          undefined4 param_4,undefined4 param_5)

{
  undefined7 extraout_var;
  
  IOAccelMemory::init((IOAccelMemory *)this,param_1);
  *(undefined8 *)(this + 0x30) = param_2;
  this[0xe] = (IOAccelRemoteMemory)((byte)this[0xe] | 1);
  *(undefined8 *)(this + 0x40) = param_3;
  *(undefined4 *)(this + 0xb0) = param_4;
  *(undefined4 *)(this + 0xb4) = param_5;
  return CONCAT71(extraout_var,1);
}



// IOAccelRemoteMemory::getDirtySize() const

undefined8 IOAccelRemoteMemory::getDirtySize(void)

{
  return 0;
}



// IOAccelRemoteMemory::getResidentSize() const

undefined8 IOAccelRemoteMemory::getResidentSize(void)

{
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelRemoteMemory::getPhysicalSegment(unsigned long long, unsigned long long*)

undefined8 __cdecl IOAccelRemoteMemory::getPhysicalSegment(long param_1)

{
  undefined8 uVar1;
  
  if (*(long **)(param_1 + 0xc0) != (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0002962f. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (**(code **)(**(long **)(param_1 + 0xc0) + 0x158))();
    return uVar1;
  }
  getPhysicalSegment();
  return 0;
}



// IOAccelRemoteMemory::setPurgeable(unsigned int, unsigned int*)

undefined8 __thiscall
IOAccelRemoteMemory::setPurgeable
          (IOAccelRemoteMemory *this,undefined8 param_2_00,undefined4 *param_2)

{
  *param_2 = 2;
  return 0;
}



// IOAccelRemoteMemory::setTag(unsigned int)

void IOAccelRemoteMemory::setTag(void)

{
  return;
}



// IOAccelRemoteMemory::getTag()

undefined8 IOAccelRemoteMemory::getTag(void)

{
  return 0;
}



// IOAccelRemoteMemory::matchForReuse(void*, unsigned long long)

undefined8 IOAccelRemoteMemory::matchForReuse(void)

{
  return 0;
}



// IOAccelRemoteMemory::getRemoteStorageResource() const

undefined8 __thiscall IOAccelRemoteMemory::getRemoteStorageResource(IOAccelRemoteMemory *this)

{
  return *(undefined8 *)(this + 0xb8);
}



// IOAccelRemoteMemory::getRemoteMemory() const

undefined8 __thiscall IOAccelRemoteMemory::getRemoteMemory(IOAccelRemoteMemory *this)

{
  return *(undefined8 *)(this + 0xc0);
}



// IOAccelRemoteMemory::prepare()

ulong __thiscall IOAccelRemoteMemory::prepare(IOAccelRemoteMemory *this)

{
  char cVar1;
  int iVar2;
  undefined8 uVar3;
  IOAccelShared2 *this_00;
  IOAccelMemory *this_01;
  long lVar4;
  undefined8 unaff_R14;
  ulong uVar5;
  IOAccelResource2 *local_20;
  
  iVar2 = IOAccelMemory::getPrepareCount((IOAccelMemory *)this);
  if (iVar2 == 0) {
    this_00 = (IOAccelShared2 *)
              IOAccelShared2::getLockedPeer
                        (*(IOAccelShared2 **)(this + 0x30),*(uint *)(this + 0xb0));
    if (this_00 == (IOAccelShared2 *)0x0) {
      uVar5 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "IOAccelRemoteMemory::prepare() unable to lock remote peer shared index %d\n\n"
                        ,*(undefined4 *)(this + 0xb0));
      goto LAB_000298a4;
    }
    local_20 = (IOAccelResource2 *)&DAT_aaaaaaaaaaaaaaaa;
    cVar1 = IOAccelShared2::lookupResource(this_00,*(uint *)(this + 0xb4),(long *)&local_20);
    if (cVar1 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "IOAccelRemoteMemory::prepare() unable to look up remote storage resource id %08x\n\n"
                        ,*(undefined4 *)(this + 0xb4));
    }
    else {
      local_20 = IOAccelResource2::getStorageResource(local_20);
      if (local_20 == (IOAccelResource2 *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "IOAccelRemoteMemory::prepare() unable to get remote storage resource\'s storage resource\n\n"
                         );
      }
      else {
        cVar1 = (**(code **)(*(long *)this + 0x1f0))(this,local_20);
        if (cVar1 == '\0') {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "IOAccelRemoteMemory::prepare() failed call to prepareRemoteStorageResource()\n\n"
                           );
        }
        else {
          this_01 = (IOAccelMemory *)(**(code **)(*(long *)this + 0x200))(this,local_20);
          if (this_01 != (IOAccelMemory *)0x0) {
            *(IOAccelResource2 **)(this + 0xb8) = local_20;
            *(IOAccelMemory **)(this + 0xc0) = this_01;
            if (((byte)this[0xc] & 2) != 0) {
              lVar4 = IOAccelMemory::getWireSerial(this_01);
              if (lVar4 != *(long *)(this + 200)) {
                (**(code **)(*(long *)this + 0x1b8))(this);
              }
            }
            goto LAB_00029691;
          }
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "IOAccelRemoteMemory::prepare() prepareRemoteMemory failed\n\n");
          (**(code **)(*(long *)this + 0x1f8))(this,local_20);
        }
      }
    }
    uVar5 = 0;
  }
  else {
LAB_00029691:
    uVar3 = IOAccelMemory::prepare((IOAccelMemory *)this);
    uVar5 = CONCAT71((int7)((ulong)unaff_R14 >> 8),1);
    if ((char)uVar3 == '\0') {
      uVar5 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "IOAccelRemoteMemory::prepare() super::prepare() failed\n\n");
      (**(code **)(*(long *)this + 0x208))(this,*(undefined8 *)(this + 0xc0));
      *(undefined8 *)(this + 0xc0) = 0;
      (**(code **)(*(long *)this + 0x1f8))(this,*(undefined8 *)(this + 0xb8));
      *(undefined8 *)(this + 0xb8) = 0;
    }
  }
LAB_000298a4:
  return uVar5 & 0xffffffff;
}



// IOAccelRemoteMemory::complete()

void IOAccelRemoteMemory::complete(void)

{
  IOAccelMemory *in_RDI;
  
  IOAccelMemory::complete(in_RDI);
  return;
}



// IOAccelRemoteMemory::prepareRemoteStorageResource(IOAccelResource2*)

void __thiscall
IOAccelRemoteMemory::prepareRemoteStorageResource(undefined8 param_1_00,long *param_2)

{
                    // WARNING: Could not recover jumptable at 0x000298cd. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*param_2 + 0x170))(param_2);
  return;
}



// IOAccelRemoteMemory::completeRemoteStorageResource(IOAccelResource2*)

void __thiscall
IOAccelRemoteMemory::completeRemoteStorageResource(undefined8 param_1_00,long *param_2)

{
                    // WARNING: Could not recover jumptable at 0x000298df. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*param_2 + 0x178))(param_2);
  return;
}



// IOAccelRemoteMemory::prepareRemoteMemory(IOAccelResource2*)

long __thiscall IOAccelRemoteMemory::prepareRemoteMemory(undefined8 param_1_00,long param_2)

{
  long lVar1;
  
  lVar1 = *(long *)(param_2 + 0x88);
  if (((lVar1 == 0) && (lVar1 = *(long *)(param_2 + 0x80), lVar1 == 0)) ||
     ((*(byte *)(lVar1 + 0xc) & 4) == 0)) {
    lVar1 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "IOAccelRemoteMemory::prepareRemoteMemory() has no peer memory\n\n");
  }
  return lVar1;
}



// IOAccelRemoteMemory::completeRemoteMemory(IOAccelMemory*)

void IOAccelRemoteMemory::completeRemoteMemory(void)

{
  return;
}



// IOAccelRemoteMemory::completeRemoteStorage()

void __thiscall IOAccelRemoteMemory::completeRemoteStorage(IOAccelRemoteMemory *this)

{
  long lVar1;
  int iVar2;
  IOAccelEventFence *pIVar3;
  long *plVar4;
  long lVar5;
  
  iVar2 = IOAccelMemory::getPrepareCount((IOAccelMemory *)this);
  if ((iVar2 == 0) && (*(long *)(this + 0xb8) != 0)) {
    pIVar3 = (IOAccelEventFence *)
             IOAccelMemory::incrementExternalMemoryEvent(*(IOAccelMemory **)(this + 0xc0));
    if (pIVar3 != (IOAccelEventFence *)0x0) {
      pIVar3 = IOAccelExternalEventFence::withExternalEvent(pIVar3,*(long *)(this + 0x28));
      if (0 < *(short *)(this + 0x5a)) {
        lVar5 = 0;
        do {
          lVar1 = *(long *)(*(long *)(this + 0x50) + lVar5 * 8);
          plVar4 = (long *)IOAccelMemory::getEventMachine((IOAccelMemory *)this);
          (**(code **)(*plVar4 + 0x1b8))(plVar4,lVar1 + 0x38,pIVar3 + 0x68);
          lVar5 = lVar5 + 1;
        } while (lVar5 < *(short *)(this + 0x5a));
      }
      IOAccelFenceMachine::addEventFence
                (*(IOAccelFenceMachine **)(*(long *)(this + 0x28) + 0x390),0,(long)pIVar3);
    }
    (**(code **)(*(long *)this + 0x208))(this,*(undefined8 *)(this + 0xc0));
    *(undefined8 *)(this + 0xc0) = 0;
    (**(code **)(*(long *)this + 0x1f8))(this,*(undefined8 *)(this + 0xb8));
    *(undefined8 *)(this + 0xb8) = 0;
  }
  return;
}



// IOAccelRemoteMemory::wire()

undefined8 __thiscall IOAccelRemoteMemory::wire(IOAccelRemoteMemory *this)

{
  undefined8 uVar1;
  
  uVar1 = IOAccelMemory::getWireSerial(*(IOAccelMemory **)(this + 0xc0));
  *(undefined8 *)(this + 200) = uVar1;
  this[0xc] = (IOAccelRemoteMemory)((byte)this[0xc] | 2);
  return CONCAT71((int7)((ulong)uVar1 >> 8),1);
}



// IOAccelRemoteMemory::unwire()

void __thiscall IOAccelRemoteMemory::unwire(IOAccelRemoteMemory *this)

{
  IOAccelMemoryMap *this_00;
  short sVar1;
  int iVar2;
  long lVar3;
  
  iVar2 = *(int *)(this + 0x10);
  *(int *)(this + 0x10) = iVar2 + 1;
  sVar1 = *(short *)(this + 0x5a);
  if (0 < sVar1) {
    lVar3 = 0;
    do {
      this_00 = *(IOAccelMemoryMap **)(*(long *)(this + 0x50) + lVar3 * 8);
      if (((byte)this_00[0x10] & 4) != 0) {
        IOAccelMemoryMap::release_pte(this_00);
        sVar1 = *(short *)(this + 0x5a);
      }
      lVar3 = lVar3 + 1;
    } while (lVar3 < sVar1);
    iVar2 = *(int *)(this + 0x10) + -1;
  }
  this[0xc] = (IOAccelRemoteMemory)((byte)this[0xc] & 0xfd);
  *(int *)(this + 0x10) = iVar2;
  return;
}



// IOAccelRemoteMemory::increment_wire_count()

void __thiscall IOAccelRemoteMemory::increment_wire_count(IOAccelRemoteMemory *this)

{
  *(int *)(this + 0x14) = *(int *)(this + 0x14) + 1;
  return;
}



// IOAccelRemoteMemory::decrement_wire_count()

void __thiscall IOAccelRemoteMemory::decrement_wire_count(IOAccelRemoteMemory *this)

{
  *(int *)(this + 0x14) = *(int *)(this + 0x14) + -1;
  return;
}



// IOAccelRemoteMemory::MetaClass::~MetaClass()

void __thiscall IOAccelRemoteMemory::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelMemory::getLength() const

undefined8 __thiscall IOAccelMemory::getLength(IOAccelMemory *this)

{
  return *(undefined8 *)(this + 0x40);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelRemoteMemory_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelRemoteMemory::gMetaClass,"IOAccelRemoteMemory",
             (OSMetaClass *)&IOAccelMemory::gMetaClass,0xd0);
  _gMetaClass = &PTR__MetaClass_00077c80;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelRemoteMemory::gMetaClass);
  return;
}



// IOAccelClientSharedMachine::init(IOGraphicsAccelerator2*, task*, unsigned long, unsigned long,
// unsigned long, unsigned int)

void __thiscall
IOAccelClientSharedMachine::init
          (IOAccelClientSharedMachine *this,undefined8 param_1,undefined8 param_2,long param_3,
          long param_4,long param_5,undefined4 param_6)

{
  ulong uVar1;
  ulong uVar2;
  
  *(undefined8 *)this = param_1;
  _task_reference(param_2);
  *(undefined8 *)(this + 8) = param_2;
  uVar1 = param_3 + param_4 + 0x3fU & 0xffffffffffffffc0;
  *(ulong *)(this + 0x18) = uVar1;
  *(long *)(this + 0x20) = param_5;
  uVar2 = param_5 * uVar1 + 0xfff;
  *(ulong *)(this + 0x28) = uVar2 & 0xfffffffffffff000;
  *(int *)(this + 0x38) = (int)(((uint)uVar2 & 0xfffff000) / uVar1);
  *(undefined4 *)(this + 0x30) = param_6;
  *(undefined8 *)(this + 0x10) = 0;
  *(undefined4 *)(this + 0x34) = 0;
  return;
}



// IOAccelClientSharedMachine::free()

void __thiscall IOAccelClientSharedMachine::free(IOAccelClientSharedMachine *this)

{
  int iVar1;
  long lVar2;
  long lVar3;
  ulong uVar4;
  
  if (*(int *)(this + 0x34) == 0) {
    lVar3 = 0;
  }
  else {
    lVar3 = 0;
    uVar4 = 0;
    do {
      if (*(long *)(*(long *)(this + 0x10) + lVar3) != 0) {
        (**(code **)(**(long **)(*(long *)(this + 0x10) + 0x10 + lVar3) + 0x28))();
        (**(code **)(**(long **)(*(long *)(this + 0x10) + 8 + lVar3) + 0x28))();
        (**(code **)(**(long **)(*(long *)(this + 0x10) + lVar3) + 0x28))();
        lVar2 = *(long *)this;
        if (lVar2 != 0) {
          iVar1 = *(int *)(this + 0x28);
          IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar2 + 0x388) + 0x58),0x52);
          *(int *)(lVar2 + 0x2e8) = *(int *)(lVar2 + 0x2e8) - iVar1;
        }
      }
      uVar4 = uVar4 + 1;
      lVar3 = lVar3 + 0x48;
    } while (uVar4 < *(uint *)(this + 0x34));
    lVar3 = (ulong)*(uint *)(this + 0x34) * 0x48;
  }
  lVar2 = *(long *)(this + 0x10);
  if (lVar2 != 0) {
    *(undefined8 *)(this + 0x10) = 0;
    _IOFreeTypeVarImpl(&free()::kalloc_type_view_88,lVar2,lVar3);
  }
  if (*(long *)(this + 8) != 0) {
    _task_deallocate();
    return;
  }
  return;
}



// IOAccelClientSharedMachine::orphanClientMappings(OSSet*) const

void __thiscall
IOAccelClientSharedMachine::orphanClientMappings(IOAccelClientSharedMachine *this,long *param_1)

{
  uint uVar1;
  ulong uVar2;
  long lVar3;
  
  uVar1 = *(uint *)(this + 0x34);
  if (uVar1 != 0) {
    lVar3 = 8;
    uVar2 = 0;
    do {
      if (*(long *)(*(long *)(this + 0x10) + lVar3) != 0) {
        (**(code **)(*param_1 + 0x1c0))(param_1);
        uVar1 = *(uint *)(this + 0x34);
      }
      uVar2 = uVar2 + 1;
      lVar3 = lVar3 + 0x48;
    } while (uVar2 < uVar1);
  }
  return;
}



// IOAccelClientSharedMachine::mapClientSharedForId(unsigned int, void**)

ulong __thiscall
IOAccelClientSharedMachine::mapClientSharedForId
          (IOAccelClientSharedMachine *this,uint param_1,long *param_2)

{
  ulong *puVar1;
  long lVar2;
  uint uVar3;
  long lVar4;
  void *pvVar5;
  task *ptVar6;
  long *plVar7;
  long *plVar8;
  undefined8 uVar9;
  uint uVar10;
  ulong uVar11;
  ulong uVar12;
  
  uVar11 = (ulong)param_1 / (ulong)*(uint *)(this + 0x38);
  uVar10 = param_1 % *(uint *)(this + 0x38);
  uVar12 = (ulong)*(uint *)(this + 0x34);
  if ((uint)uVar11 < *(uint *)(this + 0x34)) {
    pvVar5 = *(void **)(this + 0x10);
  }
  else {
    do {
      uVar3 = (int)uVar12 * 2;
      if ((int)uVar12 == 0) {
        uVar3 = 4;
      }
      uVar12 = (ulong)uVar3;
      pvVar5 = (void *)_IOMallocTypeVarImpl
                                 (&mapClientSharedForId(unsigned_int,void**)::kalloc_type_view_109,
                                  uVar12 * 0x48);
      if (pvVar5 == (void *)0x0) {
        uVar11 = 0;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: failed to alloc fClientSharedArray\n",
                          "bool IOAccelClientSharedMachine::mapClientSharedForId(uint32_t, void **)"
                         );
        goto LAB_00029f73;
      }
      if (*(void **)(this + 0x10) != (void *)0x0) {
        _memmove(pvVar5,*(void **)(this + 0x10),(ulong)*(uint *)(this + 0x34) * 0x48);
        uVar9 = *(undefined8 *)(this + 0x10);
        *(undefined8 *)(this + 0x10) = 0;
        _IOFreeTypeVarImpl(&mapClientSharedForId(unsigned_int,void**)::kalloc_type_view_118,uVar9,
                           (ulong)*(uint *)(this + 0x34) * 0x48);
      }
      *(void **)(this + 0x10) = pvVar5;
      *(uint *)(this + 0x34) = uVar3;
    } while (uVar3 <= (uint)uVar11);
  }
  if (*(long *)((long)pvVar5 + uVar11 * 0x48) == 0) {
    if (0x100 < *(uint *)(this + 0x38)) {
      mapClientSharedForId();
      return 0;
    }
    ptVar6 = (task *)(**(code **)(**(long **)this + 0x928))
                               (*(long **)this,*(undefined8 *)PTR__kernel_task_0006b100,0x10003,
                                *(undefined8 *)(this + 0x28));
    if (ptVar6 == (task *)0x0) {
      uVar11 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "fAccelerator->createBufferMemoryDescriptorInTaskWithOptions failed to allocate a client_shared block.\n"
                       );
      goto LAB_00029f73;
    }
    IOGeneralMemoryDescriptor::setOwnership(ptVar6,(int)*(undefined8 *)(this + 8),4);
    plVar7 = (long *)IOMemoryDescriptor::createMappingInTask
                               (ptVar6,*(ulonglong *)(this + 8),0,
                                (ulong)(*(uint *)(this + 0x30) | 1),0);
    if (plVar7 == (long *)0x0) {
      (**(code **)(*(long *)ptVar6 + 0x28))(ptVar6);
    }
    else {
      plVar8 = (long *)(**(code **)(*(long *)ptVar6 + 0x200))(ptVar6,1);
      if (plVar8 != (long *)0x0) {
        lVar2 = *(long *)(this + 0x10);
        lVar4 = uVar11 * 0x48;
        *(task **)(lVar2 + lVar4) = ptVar6;
        *(long **)(lVar2 + 8 + lVar4) = plVar7;
        uVar9 = (**(code **)(*plVar7 + 0x118))(plVar7);
        lVar2 = *(long *)(this + 0x10);
        *(undefined8 *)(lVar2 + 0x20 + lVar4) = uVar9;
        *(long **)(lVar2 + 0x10 + lVar4) = plVar8;
        uVar9 = (**(code **)(*plVar8 + 0x118))(plVar8);
        pvVar5 = *(void **)(this + 0x10);
        *(undefined8 *)((long)pvVar5 + lVar4 + 0x18) = uVar9;
        lVar2 = *(long *)this;
        if (lVar2 != 0) {
          uVar9 = *(undefined8 *)(this + 0x28);
          IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar2 + 0x388) + 0x58),0x52);
          *(int *)(lVar2 + 0x2e8) = *(int *)(lVar2 + 0x2e8) + (int)uVar9;
          pvVar5 = *(void **)(this + 0x10);
        }
        goto LAB_00029daa;
      }
      (**(code **)(*plVar7 + 0x28))(plVar7);
      (**(code **)(*(long *)ptVar6 + 0x28))(ptVar6);
    }
    uVar11 = 0;
  }
  else {
LAB_00029daa:
    *param_2 = (ulong)uVar10 * *(long *)(this + 0x18) +
               *(long *)((long)pvVar5 + uVar11 * 0x48 + 0x18);
    puVar1 = (ulong *)(uVar11 * 0x48 + *(long *)(this + 0x10) + 0x28 + (ulong)(uVar10 >> 6) * 8);
    *puVar1 = *puVar1 | 1L << ((byte)uVar10 & 0x3f);
    uVar11 = CONCAT71((int7)((ulong)this >> 8),1);
  }
LAB_00029f73:
  return uVar11 & 0xffffffff;
}



// IOAccelClientSharedMachine::unmapClientSharedForId(unsigned int)

void __thiscall
IOAccelClientSharedMachine::unmapClientSharedForId(IOAccelClientSharedMachine *this,uint param_1)

{
  long *plVar1;
  uint uVar2;
  int iVar3;
  long lVar4;
  ulong uVar5;
  ulong uVar6;
  byte bVar7;
  long lVar8;
  
  if (param_1 == 0) {
    unmapClientSharedForId();
  }
  else {
    uVar2 = *(uint *)(this + 0x38);
    uVar5 = (ulong)param_1 / (ulong)uVar2;
    uVar6 = (ulong)param_1 % (ulong)uVar2;
    bVar7 = (byte)uVar6 & 0x3f;
    lVar4 = *(long *)(this + 0x10);
    plVar1 = (long *)(lVar4 + uVar5 * 0x48);
    plVar1[(uVar6 >> 6) + 5] =
         plVar1[(uVar6 >> 6) + 5] & (-2L << bVar7 | 0xfffffffffffffffeU >> 0x40 - bVar7);
    if ((((plVar1[6] == 0 && plVar1[5] == 0) && plVar1[7] == 0) && plVar1[8] == 0) &&
       (((((byte)this[0x31] & 0x10) == 0 || (uVar2 <= param_1)) && (*plVar1 != 0)))) {
      lVar8 = uVar5 * 0x48;
      (**(code **)(**(long **)(lVar4 + 0x10 + lVar8) + 0x28))();
      lVar4 = *(long *)(this + 0x10);
      *(undefined8 *)(lVar4 + 0x10 + lVar8) = 0;
      (**(code **)(**(long **)(lVar4 + 8 + lVar8) + 0x28))();
      lVar4 = *(long *)(this + 0x10);
      *(undefined8 *)(lVar4 + 8 + lVar8) = 0;
      (**(code **)(**(long **)(lVar4 + lVar8) + 0x28))();
      *(undefined8 *)(*(long *)(this + 0x10) + lVar8) = 0;
      lVar4 = *(long *)this;
      if (lVar4 != 0) {
        iVar3 = *(int *)(this + 0x28);
        IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar4 + 0x388) + 0x58),0x52);
        *(int *)(lVar4 + 0x2e8) = *(int *)(lVar4 + 0x2e8) - iVar3;
      }
    }
  }
  return;
}



// IOAccelClientSharedMachine::getClientSharedAddressForId(unsigned int, unsigned long long*)

void __thiscall
IOAccelClientSharedMachine::getClientSharedAddressForId
          (IOAccelClientSharedMachine *this,uint param_1,long *param_2)

{
  long lVar1;
  ulong uVar2;
  
  uVar2 = (ulong)param_1 / (ulong)*(uint *)(this + 0x38);
  if (((uint)uVar2 < *(uint *)(this + 0x34)) &&
     (lVar1 = *(long *)(*(long *)(this + 0x10) + 0x20 + uVar2 * 0x48), lVar1 != 0)) {
    *param_2 = ((ulong)param_1 % (ulong)*(uint *)(this + 0x38)) * *(long *)(this + 0x18) + lVar1;
    return;
  }
                    // WARNING: Subroutine does not return
  _panic("\"IOAccelClientSharedMachine::getClientSharedAddressForId unable to find client map for id %08x\\n\" @%s:%d"
         ,param_1,"IOAccelShared.cpp",0xe4);
}



// IOAccelSharedNamespace2::MetaClass::MetaClass()

void __thiscall IOAccelSharedNamespace2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelSharedNamespace2",
             (OSMetaClass *)&IOAccelNamespace::gMetaClass,0xd8);
  *(undefined ***)this = &PTR__MetaClass_00077eb0;
  return;
}



// IOAccelSharedNamespace2::MetaClass::~MetaClass()

void __thiscall IOAccelSharedNamespace2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelSharedNamespace2::IOAccelSharedNamespace2(OSMetaClass const*)

void __thiscall
IOAccelSharedNamespace2::IOAccelSharedNamespace2(IOAccelSharedNamespace2 *this,OSMetaClass *param_1)

{
  IOAccelNamespace::IOAccelNamespace((IOAccelNamespace *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelSharedNamespace2_00077d80;
  return;
}



// IOAccelSharedNamespace2::IOAccelSharedNamespace2(OSMetaClass const*)

void __thiscall
IOAccelSharedNamespace2::IOAccelSharedNamespace2(IOAccelSharedNamespace2 *this,OSMetaClass *param_1)

{
  IOAccelNamespace::IOAccelNamespace((IOAccelNamespace *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelSharedNamespace2_00077d80;
  return;
}



// IOAccelSharedNamespace2::~IOAccelSharedNamespace2()

void __thiscall IOAccelSharedNamespace2::~IOAccelSharedNamespace2(IOAccelSharedNamespace2 *this)

{
  IOAccelNamespace::~IOAccelNamespace((IOAccelNamespace *)this);
  return;
}



// IOAccelSharedNamespace2::~IOAccelSharedNamespace2()

void __thiscall IOAccelSharedNamespace2::~IOAccelSharedNamespace2(IOAccelSharedNamespace2 *this)

{
  IOAccelNamespace::~IOAccelNamespace((IOAccelNamespace *)this);
  return;
}



// IOAccelSharedNamespace2::~IOAccelSharedNamespace2()

void __thiscall IOAccelSharedNamespace2::~IOAccelSharedNamespace2(IOAccelSharedNamespace2 *this)

{
  IOAccelNamespace::~IOAccelNamespace((IOAccelNamespace *)this);
  _OSObject_typed_operator_delete(&IOAccelSharedNamespace2_ktv,this,0xd8);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSharedNamespace2::operator delete(void*, unsigned long)

void __cdecl IOAccelSharedNamespace2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelSharedNamespace2_ktv,param_1,param_2);
  return;
}



// IOAccelSharedNamespace2::getMetaClass() const

undefined1 * IOAccelSharedNamespace2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelSharedNamespace2::MetaClass::MetaClass()

void __thiscall IOAccelSharedNamespace2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelSharedNamespace2",
             (OSMetaClass *)&IOAccelNamespace::gMetaClass,0xd8);
  *(undefined ***)this = &PTR__MetaClass_00077eb0;
  return;
}



// IOAccelSharedNamespace2::MetaClass::alloc() const

IOAccelNamespace * IOAccelSharedNamespace2::MetaClass::alloc(void)

{
  IOAccelNamespace *this;
  
  this = (IOAccelNamespace *)_OSObject_typed_operator_new(&IOAccelSharedNamespace2_ktv,0xd8);
  IOAccelNamespace::IOAccelNamespace(this,(OSMetaClass *)&IOAccelSharedNamespace2::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelSharedNamespace2_00077d80;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelSharedNamespace2::operator new(unsigned long)

void * __thiscall IOAccelSharedNamespace2::operator_new(IOAccelSharedNamespace2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelSharedNamespace2_ktv,this);
  return pvVar1;
}



// IOAccelSharedNamespace2::IOAccelSharedNamespace2()

void __thiscall IOAccelSharedNamespace2::IOAccelSharedNamespace2(IOAccelSharedNamespace2 *this)

{
  IOAccelNamespace::IOAccelNamespace((IOAccelNamespace *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelSharedNamespace2_00077d80;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelSharedNamespace2::IOAccelSharedNamespace2()

void __thiscall IOAccelSharedNamespace2::IOAccelSharedNamespace2(IOAccelSharedNamespace2 *this)

{
  IOAccelNamespace::IOAccelNamespace((IOAccelNamespace *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelSharedNamespace2_00077d80;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelSharedNamespace2::init(IOGraphicsAccelerator2*, task*, IOAccelTask*, IOAccelShared2*)

void __thiscall
IOAccelSharedNamespace2::init
          (IOAccelSharedNamespace2 *this,undefined8 param_1,undefined8 param_2,undefined8 param_3,
          undefined8 param_4)

{
  uint uVar1;
  undefined4 uVar2;
  long lVar3;
  ulong uVar4;
  ulong uVar5;
  long local_40;
  IOAccelSharedNamespace2 *local_38;
  
  IOAccelNamespace::init((IOAccelNamespace *)this);
  *(undefined8 *)(this + 0x30) = param_1;
  _task_reference(param_2);
  *(undefined8 *)(this + 0x38) = param_2;
  *(undefined8 *)(this + 0x48) = param_3;
  *(undefined8 *)(this + 0xd0) = param_4;
  lVar3 = _get_bsdtask_info(param_2);
  if (lVar3 == 0) {
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = _proc_pid(lVar3);
  }
  *(undefined4 *)(this + 0x40) = uVar2;
  local_38 = this + 0x50;
  uVar1 = *(uint *)(*(long *)(this + 0x30) + 0xce0);
  *(undefined8 *)(this + 0x50) = param_1;
  _task_reference(param_2);
  *(undefined8 *)(this + 0x58) = param_2;
  uVar5 = (ulong)uVar1 + 0x147 & 0xffffffffffffffc0;
  *(ulong *)(this + 0x68) = uVar5;
  *(undefined8 *)(this + 0x70) = 0x10;
  uVar4 = uVar5 * 0x10 + 0xfff;
  *(ulong *)(this + 0x78) = uVar4 & 0xfffffffffffff000;
  *(int *)(this + 0x88) = (int)(((uint)uVar4 & 0xfffff000) / uVar5);
  *(undefined8 *)(this + 0x80) = 0x1000;
  *(undefined8 *)(this + 0x60) = 0;
  uVar1 = *(uint *)(*(long *)(this + 0x30) + 0xce4);
  *(undefined8 *)(this + 0x90) = param_1;
  _task_reference(param_2);
  *(undefined8 *)(this + 0x98) = param_2;
  uVar5 = (ulong)uVar1 + 0x5f & 0xffffffffffffffc0;
  *(ulong *)(this + 0xa8) = uVar5;
  *(undefined8 *)(this + 0xb0) = 0x10;
  uVar4 = uVar5 * 0x10 + 0xfff;
  *(ulong *)(this + 0xb8) = uVar4 & 0xfffffffffffff000;
  *(int *)(this + 200) = (int)(((uint)uVar4 & 0xfffff000) / uVar5);
  *(undefined8 *)(this + 0xc0) = 0;
  *(undefined8 *)(this + 0xa0) = 0;
  local_40 = 0;
  uVar4 = IOAccelClientSharedMachine::mapClientSharedForId
                    ((IOAccelClientSharedMachine *)local_38,0,&local_40);
  if ((char)uVar4 != '\0') {
    *(long *)(*(long *)(this + 0xd0) + 0xe0) = local_40 + 8;
  }
  return;
}



// IOAccelSharedNamespace2::mapClientSharedROForId(unsigned int, IOAccelClientSharedRO**)

void __thiscall
IOAccelSharedNamespace2::mapClientSharedROForId
          (IOAccelSharedNamespace2 *this,uint param_1,long *param_2)

{
  IOAccelClientSharedMachine::mapClientSharedForId
            ((IOAccelClientSharedMachine *)(this + 0x50),param_1,param_2);
  return;
}



// IOAccelSharedNamespace2::free()

void __thiscall IOAccelSharedNamespace2::free(IOAccelSharedNamespace2 *this)

{
  *(undefined8 *)(*(long *)(this + 0xd0) + 0xe0) = 0;
  IOAccelClientSharedMachine::free((IOAccelClientSharedMachine *)(this + 0x50));
  IOAccelClientSharedMachine::free((IOAccelClientSharedMachine *)(this + 0x90));
  if (*(long *)(this + 0x38) != 0) {
    _task_deallocate();
  }
  IOAccelNamespace::free((IOAccelNamespace *)this);
  return;
}



// IOAccelSharedNamespace2::orphanClientMappings(OSSet*) const

void __thiscall
IOAccelSharedNamespace2::orphanClientMappings(IOAccelSharedNamespace2 *this,long *param_1)

{
  uint uVar1;
  ulong uVar2;
  long lVar3;
  
  uVar1 = *(uint *)(this + 0x84);
  if (uVar1 != 0) {
    lVar3 = 8;
    uVar2 = 0;
    do {
      if (*(long *)(*(long *)(this + 0x60) + lVar3) != 0) {
        (**(code **)(*param_1 + 0x1c0))(param_1);
        uVar1 = *(uint *)(this + 0x84);
      }
      uVar2 = uVar2 + 1;
      lVar3 = lVar3 + 0x48;
    } while (uVar2 < uVar1);
  }
  uVar1 = *(uint *)(this + 0xc4);
  if (uVar1 != 0) {
    lVar3 = 8;
    uVar2 = 0;
    do {
      if (*(long *)(*(long *)(this + 0xa0) + lVar3) != 0) {
        (**(code **)(*param_1 + 0x1c0))(param_1);
        uVar1 = *(uint *)(this + 0xc4);
      }
      uVar2 = uVar2 + 1;
      lVar3 = lVar3 + 0x48;
    } while (uVar2 < uVar1);
  }
  return;
}



// IOAccelSharedNamespace2::mapClientSharedForId(unsigned int, IOAccelClientSharedRO**,
// IOAccelClientSharedRW**)

ulong __thiscall
IOAccelSharedNamespace2::mapClientSharedForId
          (IOAccelSharedNamespace2 *this,uint param_1,long *param_2,long *param_3)

{
  ulong uVar1;
  
  uVar1 = IOAccelClientSharedMachine::mapClientSharedForId
                    ((IOAccelClientSharedMachine *)(this + 0x50),param_1,param_2);
  if ((char)uVar1 != '\0') {
    uVar1 = IOAccelClientSharedMachine::mapClientSharedForId
                      ((IOAccelClientSharedMachine *)(this + 0x90),param_1,param_3);
    return uVar1;
  }
  return 0;
}



// IOAccelSharedNamespace2::unmapClientSharedForId(unsigned int)

void __thiscall
IOAccelSharedNamespace2::unmapClientSharedForId(IOAccelSharedNamespace2 *this,uint param_1)

{
  IOAccelClientSharedMachine::unmapClientSharedForId
            ((IOAccelClientSharedMachine *)(this + 0x50),param_1);
  IOAccelClientSharedMachine::unmapClientSharedForId
            ((IOAccelClientSharedMachine *)(this + 0x90),param_1);
  return;
}



// IOAccelSharedNamespace2::getClientSharedAddressesForId(unsigned int, unsigned long long*,
// unsigned long long*)

void __thiscall
IOAccelSharedNamespace2::getClientSharedAddressesForId
          (IOAccelSharedNamespace2 *this,uint param_1,long *param_2,long *param_3)

{
  IOAccelClientSharedMachine::getClientSharedAddressForId
            ((IOAccelClientSharedMachine *)(this + 0x50),param_1,param_2);
  IOAccelClientSharedMachine::getClientSharedAddressForId
            ((IOAccelClientSharedMachine *)(this + 0x90),param_1,param_3);
  return;
}



// IOAccelSharedNamespace2::getClientSharedROForId(unsigned int, unsigned long long*)

void __thiscall
IOAccelSharedNamespace2::getClientSharedROForId
          (IOAccelSharedNamespace2 *this,uint param_1,long *param_2)

{
  IOAccelClientSharedMachine::getClientSharedAddressForId
            ((IOAccelClientSharedMachine *)(this + 0x50),param_1,param_2);
  return;
}



// IOAccelShared2::MetaClass::MetaClass()

void __thiscall IOAccelShared2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelShared2",(OSMetaClass *)PTR_gMetaClass_0006b068,0x138);
  *(undefined ***)this = &PTR__MetaClass_00078128;
  return;
}



// IOAccelShared2::MetaClass::~MetaClass()

void __thiscall IOAccelShared2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelShared2::IOAccelShared2(OSMetaClass const*)

void __thiscall IOAccelShared2::IOAccelShared2(IOAccelShared2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelShared2_00077fa8;
  return;
}



// IOAccelShared2::IOAccelShared2(OSMetaClass const*)

void __thiscall IOAccelShared2::IOAccelShared2(IOAccelShared2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelShared2_00077fa8;
  return;
}



// IOAccelShared2::~IOAccelShared2()

void __thiscall IOAccelShared2::~IOAccelShared2(IOAccelShared2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelShared2::~IOAccelShared2()

void __thiscall IOAccelShared2::~IOAccelShared2(IOAccelShared2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelShared2::~IOAccelShared2()

void __thiscall IOAccelShared2::~IOAccelShared2(IOAccelShared2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelShared2_ktv,this,0x138);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelShared2::operator delete(void*, unsigned long)

void __cdecl IOAccelShared2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelShared2_ktv,param_1,param_2);
  return;
}



// IOAccelShared2::getMetaClass() const

undefined1 * IOAccelShared2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelShared2::MetaClass::MetaClass()

void __thiscall IOAccelShared2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelShared2",(OSMetaClass *)PTR_gMetaClass_0006b068,0x138);
  *(undefined ***)this = &PTR__MetaClass_00078128;
  return;
}



// IOAccelShared2::MetaClass::alloc() const

OSObject * IOAccelShared2::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelShared2_ktv,0x138);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelShared2::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelShared2_00077fa8;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelShared2::operator new(unsigned long)

void * __thiscall IOAccelShared2::operator_new(IOAccelShared2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelShared2_ktv,this);
  return pvVar1;
}



// IOAccelShared2::IOAccelShared2()

void __thiscall IOAccelShared2::IOAccelShared2(IOAccelShared2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelShared2_00077fa8;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelShared2::IOAccelShared2()

void __thiscall IOAccelShared2::IOAccelShared2(IOAccelShared2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelShared2_00077fa8;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelShared2::init(IOGraphicsAccelerator2*, task*)

undefined8 __thiscall
IOAccelShared2::init(IOAccelShared2 *this,undefined8 param_1,undefined8 param_2)

{
  byte bVar1;
  char cVar2;
  int iVar3;
  long lVar4;
  IOAccelNamespace *pIVar5;
  undefined8 uVar6;
  
  *(undefined8 *)(this + 0x78) = param_1;
  _task_reference(param_2);
  *(undefined8 *)(this + 0x80) = param_2;
  lVar4 = (**(code **)(**(long **)(this + 0x78) + 0x998))();
  *(long *)(this + 0x88) = lVar4;
  if (lVar4 != 0) {
    lVar4 = _get_bsdtask_info(param_2);
    if (lVar4 == 0) {
      bVar1 = (byte)this[0x28] | 1;
    }
    else {
      iVar3 = _proc_is64bit(lVar4);
      bVar1 = (byte)this[0x28] & 0xfe | iVar3 != 0;
    }
    this[0x28] = (IOAccelShared2)(bVar1 | 6);
    IOAccelSharedList::addShared((IOAccelSharedList *)(*(long *)(this + 0x78) + 0xa88),(long)this);
    pIVar5 = (IOAccelNamespace *)_OSObject_typed_operator_new(&IOAccelSharedNamespace2_ktv,0xd8);
    IOAccelNamespace::IOAccelNamespace(pIVar5,(OSMetaClass *)&IOAccelSharedNamespace2::gMetaClass);
    *(undefined ***)pIVar5 = &PTR__IOAccelSharedNamespace2_00077d80;
    OSMetaClass::instanceConstructed();
    *(IOAccelNamespace **)(this + 0x20) = pIVar5;
    cVar2 = IOAccelSharedNamespace2::init
                      ((IOAccelSharedNamespace2 *)pIVar5,param_1,param_2,
                       *(undefined8 *)(this + 0x88),this);
    if (cVar2 == '\0') {
      (**(code **)(**(long **)(this + 0x20) + 0x28))();
      *(undefined8 *)(this + 0x20) = 0;
    }
    else {
      IOAccelResourceList::init((IOAccelResourceList *)(this + 0xa0));
      pIVar5 = IOAccelNamespace::operator_new
                         ((IOAccelNamespace *)(segment_command_00000020.segname + 8));
      IOAccelNamespace::IOAccelNamespace(pIVar5);
      *(IOAccelNamespace **)(this + 0xb8) = pIVar5;
      if ((pIVar5 == (IOAccelNamespace *)0x0) ||
         (cVar2 = (**(code **)(*(long *)pIVar5 + 0x88))(pIVar5), cVar2 != '\0')) {
        lVar4 = OSArray::withCapacity(1);
        *(long *)(this + 0xc0) = lVar4;
        if (lVar4 != 0) {
          pIVar5 = IOAccelNamespace::operator_new
                             ((IOAccelNamespace *)(segment_command_00000020.segname + 8));
          IOAccelNamespace::IOAccelNamespace(pIVar5);
          *(IOAccelNamespace **)(this + 0x128) = pIVar5;
          if ((pIVar5 == (IOAccelNamespace *)0x0) ||
             (cVar2 = (**(code **)(*(long *)pIVar5 + 0x88))(pIVar5), cVar2 != '\0')) {
            lVar4 = OSArray::withCapacity(1);
            *(long *)(this + 0x130) = lVar4;
            if (lVar4 != 0) {
              *(undefined8 *)(this + 0x18) = 0;
              *(undefined8 *)(this + 0x90) = 0;
              this[0x98] = (IOAccelShared2)0x0;
              uVar6 = _OSAddAtomic64(1,&___globalObjectIDCounter);
              *(undefined8 *)(this + 0x30) = uVar6;
              return CONCAT71((int7)((ulong)uVar6 >> 8),1);
            }
          }
          else {
            (**(code **)(**(long **)(this + 0x128) + 0x28))();
            *(undefined8 *)(this + 0x128) = 0;
          }
        }
      }
      else {
        (**(code **)(**(long **)(this + 0xb8) + 0x28))();
        *(undefined8 *)(this + 0xb8) = 0;
      }
    }
  }
  return 0;
}



// IOAccelShared2::free()

void __thiscall IOAccelShared2::free(IOAccelShared2 *this)

{
  undefined8 *puVar1;
  long *plVar2;
  undefined8 uVar3;
  undefined8 extraout_RDX;
  long lVar4;
  long lVar5;
  undefined1 auVar6 [16];
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelResourceList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_40,(long)(this + 0xa0));
  auVar6 = IOAccelResourceList::ReverseIterator::getPrevResource((ReverseIterator *)&local_40);
  uVar3 = auVar6._8_8_;
  plVar2 = auVar6._0_8_;
  if (plVar2 != (long *)0x0) {
    do {
      *(undefined4 *)(plVar2[6] + 0x18) = 0;
      (**(code **)(*plVar2 + 0x160))(plVar2,this);
      auVar6 = IOAccelResourceList::ReverseIterator::getPrevResource((ReverseIterator *)&local_40);
      uVar3 = auVar6._8_8_;
      plVar2 = auVar6._0_8_;
    } while (plVar2 != (long *)0x0);
  }
  IOAccelOrphanedMemoryPool::sharedRelease
            ((IOAccelOrphanedMemoryPool *)(*(long *)(this + 0x78) + 0xb60),(IOAccelMemory *)this,
             uVar3);
  IOAccelOrphanedMemoryPool::sharedRelease
            ((IOAccelOrphanedMemoryPool *)(*(long *)(this + 0x78) + 0xbc8),(IOAccelMemory *)this,
             extraout_RDX);
  if (*(long **)(this + 0x58) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x58) + 0x28))();
    *(undefined8 *)(this + 0x58) = 0;
  }
  if (*(long **)(this + 0x50) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x50) + 0x28))();
    *(undefined8 *)(this + 0x50) = 0;
  }
  if (*(long **)(this + 0x48) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x48) + 0x28))();
    *(undefined8 *)(this + 0x48) = 0;
  }
  if (*(long **)(this + 0x130) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x130) + 0x28))();
    *(undefined8 *)(this + 0x130) = 0;
  }
  if (*(long **)(this + 0x128) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x128) + 0x28))();
    *(undefined8 *)(this + 0x128) = 0;
  }
  if (*(long **)(this + 0xc0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xc0) + 0x28))();
    *(undefined8 *)(this + 0xc0) = 0;
  }
  if (*(long **)(this + 0xb8) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xb8) + 0x28))();
    *(undefined8 *)(this + 0xb8) = 0;
  }
  if (*(long **)(this + 0x20) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x20) + 0x28))();
    *(undefined8 *)(this + 0x20) = 0;
  }
  if (*(long *)(this + 0x68) != 0) {
    _IOFreeData(*(long *)(this + 0x68),
                (ulong)(uint)(*(int *)(*(long *)(this + 0x78) + 0xcf4) * *(int *)(this + 0x70)) << 6
               );
    *(undefined8 *)(this + 0x68) = 0;
  }
  if (*(long *)(this + 0x18) != 0) {
    lVar5 = 0;
    do {
      puVar1 = *(undefined8 **)(*(long *)(this + 0x18) + lVar5 * 8);
      while (puVar1 != (undefined8 *)0x0) {
        *(undefined8 *)(puVar1[2] + 0x30) = 0;
        puVar1 = (undefined8 *)*puVar1;
        _IOFreeTypeImpl(&free()::kalloc_type_view_524);
      }
      lVar5 = lVar5 + 1;
    } while (lVar5 != 0x20);
    uVar3 = *(undefined8 *)(this + 0x18);
    *(undefined8 *)(this + 0x18) = 0;
    _IOFreeTypeVarImpl(&free()::kalloc_type_view_528,uVar3,0x100);
    *(undefined8 *)(this + 0x18) = 0;
  }
  if (*(IOAccelTask **)(this + 0x88) != (IOAccelTask *)0x0) {
    IOAccelTask::prune_orphaned_mappings(*(IOAccelTask **)(this + 0x88));
    (**(code **)(**(long **)(this + 0x88) + 0x28))();
    *(undefined8 *)(this + 0x88) = 0;
  }
  lVar5 = *(long *)(this + 0x118);
  if (lVar5 != 0) {
    lVar4 = 0;
    do {
      if (*(long **)(lVar5 + lVar4) != (long *)0x0) {
        (**(code **)(**(long **)(lVar5 + lVar4) + 0x28))();
        lVar5 = *(long *)(this + 0x118);
        *(undefined8 *)(lVar5 + lVar4) = 0;
      }
      lVar4 = lVar4 + 0x10;
    } while (lVar4 != 0x40);
    uVar3 = *(undefined8 *)(this + 0x118);
    *(undefined8 *)(this + 0x118) = 0;
    _IOFreeTypeImpl(&free()::kalloc_type_view_548,uVar3);
  }
  if (*(long **)(this + 0x90) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x90) + 0x28))();
    *(undefined8 *)(this + 0x90) = 0;
  }
  if (*(long *)(this + 0x80) != 0) {
    _task_deallocate();
  }
  IOAccelSharedList::removeShared((IOAccelSharedList *)(*(long *)(this + 0x78) + 0xa88),(long)this);
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelShared2::connectPeerShared(IOAccelSharedUserClient2*)

undefined8 __thiscall IOAccelShared2::connectPeerShared(IOAccelShared2 *this,long *param_1)

{
  ushort uVar1;
  long lVar2;
  undefined8 uVar3;
  long lVar4;
  
  lVar2 = *(long *)(this + 0x118);
  if (lVar2 == 0) {
    lVar2 = _IOMallocTypeImpl(&connectPeerShared(IOAccelSharedUserClient2*)::kalloc_type_view_596);
    *(long *)(this + 0x118) = lVar2;
    if (lVar2 == 0) {
      return 0xe00002bd;
    }
  }
  uVar1 = *(ushort *)(*(long *)(param_1[0x20] + 0x78) + 0xd18);
  uVar3 = 0xe00002c9;
  if ((((ulong)uVar1 < 4) && (uVar1 != *(ushort *)(*(long *)(this + 0x78) + 0xd18))) &&
     (lVar4 = (ulong)uVar1 * 0x10, *(long *)(lVar2 + lVar4) == 0)) {
    (**(code **)(*param_1 + 0x20))(param_1);
    *(long **)(*(long *)(this + 0x118) + lVar4) = param_1;
    uVar3 = 0;
  }
  return uVar3;
}



// IOAccelShared2::getPeerIndex() const

undefined2 __thiscall IOAccelShared2::getPeerIndex(IOAccelShared2 *this)

{
  return *(undefined2 *)(*(long *)(this + 0x78) + 0xd18);
}



// IOAccelShared2::disconnectPeer(unsigned int)

undefined8 __thiscall IOAccelShared2::disconnectPeer(IOAccelShared2 *this,uint param_1)

{
  long *plVar1;
  undefined8 uVar2;
  
  if (*(long *)(this + 0x118) == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "IOAccelShared::disconnectPeer(%u), No shared peers\n\n");
    uVar2 = 0xe00002bd;
  }
  else {
    if (param_1 < 4) {
      plVar1 = *(long **)(*(long *)(this + 0x118) + (ulong)param_1 * 0x10);
      if (plVar1 != (long *)0x0) {
        (**(code **)(*plVar1 + 0x28))();
        *(undefined8 *)(*(long *)(this + 0x118) + (ulong)param_1 * 0x10) = 0;
        return 0;
      }
    }
    else {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "IOAccelShared::disconnectPeer(%u), PeerIndex greater than MaxSharedPeers(%u)\n\n"
                        ,param_1,4);
    }
    uVar2 = 0xe00002c2;
  }
  return uVar2;
}



// IOAccelShared2::lockPeer(unsigned int)

ulong __thiscall IOAccelShared2::lockPeer(IOAccelShared2 *this,uint param_1)

{
  long lVar1;
  IOGraphicsAccelerator2 *pIVar2;
  ulong uVar3;
  long lVar4;
  ulong uVar5;
  
  lVar1 = *(long *)(this + 0x118);
  if (lVar1 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "IOAccelShared::lockPeer(%u), No shared peers\n\n");
    uVar5 = 0xe00002bd;
  }
  else if (param_1 < 4) {
    lVar4 = (ulong)param_1 * 0x10;
    uVar5 = 0xe00002c9;
    if (*(long *)(lVar1 + 8 + lVar4) == 0) {
      uVar5 = 0xe00002d9;
      if (*(IOAccelSharedUserClient2 **)(lVar1 + lVar4) != (IOAccelSharedUserClient2 *)0x0) {
        pIVar2 = (IOGraphicsAccelerator2 *)
                 IOAccelSharedUserClient2::getPeerAccelerator
                           (*(IOAccelSharedUserClient2 **)(lVar1 + lVar4));
        if (pIVar2 != (IOGraphicsAccelerator2 *)0x0) {
          uVar3 = IOGraphicsAccelerator2::lockPeerAccelerator
                            (*(IOGraphicsAccelerator2 **)(this + 0x78),pIVar2);
          uVar5 = uVar3 & 0xffffffff;
          if ((int)uVar3 == 0) {
            *(undefined8 *)(*(long *)(this + 0x118) + 8 + lVar4) = 1;
          }
          (**(code **)(*(long *)pIVar2 + 0x28))(pIVar2);
        }
      }
    }
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "IOAccelShared::lockPeer(%u), PeerIndex greater than MaxSharedPeers(%u)\n\n",
                      param_1,4);
    uVar5 = 0xe00002c2;
  }
  return uVar5;
}



// IOAccelSharedUserClient2::getPeerAccelerator()

long * __thiscall IOAccelSharedUserClient2::getPeerAccelerator(IOAccelSharedUserClient2 *this)

{
  long *plVar1;
  
  _OSIncrementAtomic(this + 0x160);
  if ((this[0x10d] == (IOAccelSharedUserClient2)0x0) &&
     (this[0x165] == (IOAccelSharedUserClient2)0x0)) {
    plVar1 = *(long **)(this + 0xf8);
    (**(code **)(*plVar1 + 0x20))(plVar1);
    exit_external_rpc(this);
  }
  else {
    plVar1 = (long *)0x0;
  }
  return plVar1;
}



// IOAccelShared2::unlockPeer(unsigned int)

void __thiscall IOAccelShared2::unlockPeer(IOAccelShared2 *this,uint param_1)

{
  long lVar1;
  long lVar2;
  
  lVar1 = *(long *)(this + 0x118);
  if (lVar1 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "IOAccelShared::unlockPeer(%u), No shared peers\n\n");
  }
  else if (param_1 < 4) {
    lVar2 = (ulong)param_1 * 0x10;
    if (*(long *)(lVar1 + 8 + lVar2) == 0) {
      unlockPeer();
    }
    else {
      IOGraphicsAccelerator2::unlockPeerAccelerator
                (*(undefined8 *)(this + 0x78),
                 *(IOGraphicsAccelerator2 **)(*(long *)(lVar1 + lVar2) + 0xf8));
      *(undefined8 *)(*(long *)(this + 0x118) + 8 + lVar2) = 0;
    }
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "IOAccelShared::unlockPeer(%u), PeerIndex greater than MaxSharedPeers(%u)\n\n"
                      ,param_1,4);
  }
  return;
}



// IOAccelShared2::getLockedPeer(unsigned int)

undefined8 __thiscall IOAccelShared2::getLockedPeer(IOAccelShared2 *this,uint param_1)

{
  long lVar1;
  undefined8 uVar2;
  
  lVar1 = *(long *)(this + 0x118);
  if (lVar1 == 0) {
    uVar2 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "IOAccelShared::getLockedPeer(%u), No shared peers\n\n");
  }
  else if (param_1 < 4) {
    if (*(long *)(lVar1 + 8 + (ulong)param_1 * 0x10) == 0) {
      uVar2 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "IOAccelShared::getLockedPeer(%d), peer userclient exists but is not locked\n\n"
                       );
    }
    else {
      uVar2 = *(undefined8 *)(*(long *)(lVar1 + (ulong)param_1 * 0x10) + 0x100);
    }
  }
  else {
    uVar2 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "IOAccelShared::getLockedPeer(%u), PeerIndex greater than MaxSharedPeers(%u)\n\n"
                      ,param_1,4);
  }
  return uVar2;
}



// IOAccelShared2::allocResourceId(void*, unsigned int*)

void __thiscall
IOAccelShared2::allocResourceId(IOAccelShared2 *this,undefined8 param_1,uint *param_2)

{
  IOAccelNamespace::allocId(*(IOAccelNamespace **)(this + 0x20),param_1,param_2);
  return;
}



// IOAccelShared2::freeResourceId(unsigned int)

void __thiscall IOAccelShared2::freeResourceId(IOAccelShared2 *this,uint param_1)

{
  IOAccelNamespace::freeId(*(IOAccelNamespace **)(this + 0x20),param_1);
  return;
}



// IOAccelShared2::lookupResource(unsigned int, void**)

void __thiscall IOAccelShared2::lookupResource(IOAccelShared2 *this,uint param_1,long *param_2)

{
  IOAccelNamespace::lookupId(*(IOAccelNamespace **)(this + 0x20),param_1,param_2);
  return;
}



// IOAccelShared2::remove_client_memory(IOAccelSysMemory*, unsigned long long, unsigned long long)

void __thiscall
IOAccelShared2::remove_client_memory(IOAccelShared2 *this,long param_1,long param_2,long param_3)

{
  long lVar1;
  long *plVar2;
  long *plVar3;
  uint uVar4;
  ulong uVar5;
  long local_10;
  
  local_10 = param_2;
  lVar1 = 0;
  uVar4 = 0;
  do {
    uVar4 = ((int)*(char *)((long)&local_10 + lVar1) + uVar4) * 0x401;
    uVar4 = uVar4 >> 6 ^ uVar4;
    lVar1 = lVar1 + 1;
  } while (lVar1 != 8);
  lVar1 = *(long *)(this + 0x18);
  if (lVar1 != 0) {
    uVar5 = (ulong)((uVar4 * 9 >> 0xb ^ uVar4 * 9) & 0x1f);
    plVar2 = *(long **)(lVar1 + uVar5 * 8);
    if (plVar2 != (long *)0x0) {
      do {
        if (((plVar2[3] == param_2) && (plVar2[4] == param_3)) && (plVar2[2] == param_1)) {
          plVar3 = (long *)(lVar1 + uVar5 * 8);
          if ((long *)plVar2[1] != (long *)0x0) {
            plVar3 = (long *)plVar2[1];
          }
          *plVar3 = *plVar2;
          if (*plVar2 != 0) {
            *(long *)(*plVar2 + 8) = plVar2[1];
          }
          _IOFreeTypeImpl(&remove_client_memory(IOAccelSysMemory*,unsigned_long_long,unsigned_long_long)
                           ::kalloc_type_view_814,plVar2);
          return;
        }
        plVar2 = (long *)*plVar2;
      } while (plVar2 != (long *)0x0);
    }
  }
  return;
}



// IOAccelShared2::memory_with_client_buffer(unsigned long long, unsigned long long)

IOAccelSysMemory * __thiscall
IOAccelShared2::memory_with_client_buffer(IOAccelShared2 *this,ulong param_1,ulong param_2)

{
  long lVar1;
  long lVar2;
  undefined8 uVar3;
  IOAccelSysMemory *pIVar4;
  undefined8 *puVar5;
  uint uVar6;
  ulong uVar7;
  ulong local_40;
  ulong local_38;
  
  local_40 = param_1;
  lVar2 = 0;
  uVar6 = 0;
  do {
    uVar6 = ((int)*(char *)((long)&local_40 + lVar2) + uVar6) * 0x401;
    uVar6 = uVar6 >> 6 ^ uVar6;
    lVar2 = lVar2 + 1;
  } while (lVar2 != 8);
  uVar6 = (uVar6 * 9 >> 0xb ^ uVar6 * 9) & 0x1f;
  local_38 = param_2;
  if (*(long *)(this + 0x18) != 0) {
    for (puVar5 = *(undefined8 **)(*(long *)(this + 0x18) + (ulong)uVar6 * 8);
        puVar5 != (undefined8 *)0x0; puVar5 = (undefined8 *)*puVar5) {
      if ((puVar5[3] == param_1) && (puVar5[4] == param_2)) {
        pIVar4 = (IOAccelSysMemory *)puVar5[2];
        uVar3 = IOAccelSysMemory::client_address_persistent(pIVar4);
        param_2 = local_38;
        if ((char)uVar3 != '\0') {
          (**(code **)(*(long *)pIVar4 + 0x20))(pIVar4);
          return pIVar4;
        }
      }
    }
  }
  pIVar4 = (IOAccelSysMemory *)
           IOAccelSysMemory::withClientBuffer
                     (*(long **)(this + 0x78),*(undefined8 *)(this + 0x80),this,param_1,param_2);
  if (pIVar4 == (IOAccelSysMemory *)0x0) {
    pIVar4 = (IOAccelSysMemory *)0x0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: withClientBuffer failed\n",
                      "IOAccelSysMemory *IOAccelShared2::memory_with_client_buffer(mach_vm_address_t, uint64_t)"
                     );
  }
  else {
    if (*(long *)(this + 0x18) == 0) {
      lVar2 = _IOMallocTypeVarImpl
                        (&memory_with_client_buffer(unsigned_long_long,unsigned_long_long)::
                          kalloc_type_view_869,0x100);
      *(long *)(this + 0x18) = lVar2;
      if (lVar2 == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: failed to allocate memory for fClientMemoryHashTable\n",
                          "IOAccelSysMemory *IOAccelShared2::memory_with_client_buffer(mach_vm_address_t, uint64_t)"
                         );
        return pIVar4;
      }
      lVar2 = 0;
      do {
        *(undefined8 *)(*(long *)(this + 0x18) + lVar2 * 8) = 0;
        lVar2 = lVar2 + 1;
      } while (lVar2 != 0x20);
    }
    puVar5 = (undefined8 *)
             _IOMallocTypeImpl(&memory_with_client_buffer(unsigned_long_long,unsigned_long_long)::
                                kalloc_type_view_882);
    if (puVar5 != (undefined8 *)0x0) {
      puVar5[2] = pIVar4;
      puVar5[3] = param_1;
      puVar5[4] = local_38;
      lVar2 = *(long *)(this + 0x18);
      uVar7 = (ulong)uVar6;
      *puVar5 = *(undefined8 *)(lVar2 + uVar7 * 8);
      puVar5[1] = 0;
      lVar1 = *(long *)(lVar2 + uVar7 * 8);
      if (lVar1 != 0) {
        *(undefined8 **)(lVar1 + 8) = puVar5;
      }
      *(undefined8 **)(lVar2 + uVar7 * 8) = puVar5;
    }
  }
  return pIVar4;
}



// IOAccelShared2::describeDriverAllocations(IOAccelAllocationInfo*)

void __thiscall
IOAccelShared2::describeDriverAllocations(IOAccelShared2 *this,IOAccelAllocationInfo *param_1)

{
  int iVar1;
  IOAccelResource2 *this_00;
  OSMetaClassBase *pOVar2;
  IOAccelDeviceShmem *this_01;
  int iVar3;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelResourceList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_48,(long)(this + 0xa0));
  this_00 = (IOAccelResource2 *)
            IOAccelResourceList::ReverseIterator::getPrevResource((ReverseIterator *)&local_48);
  if (this_00 != (IOAccelResource2 *)0x0) {
    do {
      IOAccelResource2::describeAllocations(this_00,param_1);
      this_00 = (IOAccelResource2 *)
                IOAccelResourceList::ReverseIterator::getPrevResource((ReverseIterator *)&local_48);
    } while (this_00 != (IOAccelResource2 *)0x0);
  }
  iVar1 = (**(code **)(**(long **)(this + 0xc0) + 0x130))();
  if (iVar1 != 0) {
    iVar3 = 0;
    do {
      pOVar2 = (OSMetaClassBase *)
               (**(code **)(**(long **)(this + 0xc0) + 0x1e8))(*(long **)(this + 0xc0),iVar3);
      this_01 = (IOAccelDeviceShmem *)
                OSMetaClassBase::safeMetaCast(pOVar2,(OSMetaClass *)&IOAccelDeviceShmem::gMetaClass)
      ;
      if (this_01 != (IOAccelDeviceShmem *)0x0) {
        IOAccelDeviceShmem::describeAllocation
                  (this_01,*(int *)(*(long *)(this + 0x20) + 0x40),(long)param_1);
      }
      iVar3 = iVar3 + 1;
    } while (iVar1 != iVar3);
  }
  return;
}



// IOAccelShared2::copyEntitlements()

undefined8 __thiscall IOAccelShared2::copyEntitlements(IOAccelShared2 *this)

{
  long lVar1;
  OSDictionary *pOVar2;
  OSMetaClassBase *pOVar3;
  proc *ppVar4;
  undefined8 uVar5;
  
  lVar1 = _get_bsdtask_info(*(undefined8 *)(this + 0x80));
  if (lVar1 != 0) {
    pOVar2 = (OSDictionary *)
             IOService::serviceMatching("AppleMobileFileIntegrity",(OSDictionary *)0x0);
    if (pOVar2 == (OSDictionary *)0x0) {
      return 0;
    }
    pOVar3 = (OSMetaClassBase *)IOService::waitForMatchingService(pOVar2,10000000000);
    (**(code **)(*(long *)pOVar2 + 0x28))(pOVar2);
    if (pOVar3 != (OSMetaClassBase *)0x0) {
      ppVar4 = (proc *)OSMetaClassBase::safeMetaCast(pOVar3,*(OSMetaClass **)PTR_metaClass_0006b040)
      ;
      if (ppVar4 == (proc *)0x0) {
        uVar5 = 0;
      }
      else {
        uVar5 = AppleMobileFileIntegrity::copyEntitlements(ppVar4);
      }
      (**(code **)(*(long *)pOVar3 + 0x28))(pOVar3);
      return uVar5;
    }
  }
  return 0;
}



// IOAccelShared2::doesEntitlementExist(char const*)

undefined8 __thiscall IOAccelShared2::doesEntitlementExist(IOAccelShared2 *this,undefined8 param_1)

{
  OSMetaClassBase *pOVar1;
  long *plVar2;
  undefined8 uVar3;
  
  if (this[0x98] == (IOAccelShared2)0x0) {
    plVar2 = (long *)copyEntitlements(this);
    *(long **)(this + 0x90) = plVar2;
    this[0x98] = (IOAccelShared2)0x1;
  }
  else {
    plVar2 = *(long **)(this + 0x90);
  }
  if ((plVar2 != (long *)0x0) &&
     (pOVar1 = (OSMetaClassBase *)(**(code **)(*plVar2 + 0x208))(plVar2,param_1),
     pOVar1 != (OSMetaClassBase *)0x0)) {
    plVar2 = (long *)OSMetaClassBase::safeMetaCast(pOVar1,*(OSMetaClass **)PTR_metaClass_0006b080);
    if (plVar2 == (long *)0x0) {
      return 1;
    }
                    // WARNING: Could not recover jumptable at 0x0002b4e8. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar3 = (**(code **)(*plVar2 + 0x128))(plVar2);
    return uVar3;
  }
  return 0;
}



// IOAccelShared2::noIgnoreOnGPURestart()

void __thiscall IOAccelShared2::noIgnoreOnGPURestart(IOAccelShared2 *this)

{
  doesEntitlementExist(this,"com.apple.private.graphics-restart-no-kill");
  return;
}



// IOAccelShared2::create_shmem(unsigned int, unsigned long long*, unsigned int*, unsigned int*)

undefined8 __thiscall
IOAccelShared2::create_shmem
          (IOAccelShared2 *this,uint param_1,undefined8 *param_2,undefined4 *param_3,
          undefined4 *param_4)

{
  undefined4 uVar1;
  undefined8 uVar2;
  OSObject *this_00;
  long lVar3;
  
  if (param_1 < 0x10000001) {
    this_00 = IOAccelDeviceShmem::deviceShmemWithTask
                        (*(long *)(this + 0x78),*(task **)(this + 0x80),*(long **)(this + 0xb8),
                         (ulong)param_1);
    if (this_00 == (OSObject *)0x0) {
      *param_2 = 0;
      *param_3 = 0;
      *param_4 = 0;
      uVar2 = 0xe00002bd;
    }
    else {
      (**(code **)(**(long **)(this + 0xc0) + 0x1b8))(*(long **)(this + 0xc0),this_00);
      (**(code **)(*(long *)this_00 + 0x28))(this_00);
      uVar2 = IOAccelDeviceShmem::getClientData((IOAccelDeviceShmem *)this_00);
      *param_2 = uVar2;
      uVar1 = (**(code **)(*(long *)this_00 + 0x128))(this_00);
      *param_3 = uVar1;
      uVar1 = IOAccelDeviceShmem::getShmemId((IOAccelDeviceShmem *)this_00);
      *param_4 = uVar1;
      lVar3 = (**(code **)(*(long *)this_00 + 0x128))(this_00);
      LOCK();
      **(long **)(this + 0xe0) = **(long **)(this + 0xe0) + lVar3;
      UNLOCK();
      uVar2 = 0;
    }
  }
  else {
    *param_2 = 0;
    *param_3 = 0;
    *param_4 = 0;
    uVar2 = 0xe00002be;
  }
  return uVar2;
}



// IOAccelShared2::increment_allocated_size(unsigned long long)

void __thiscall IOAccelShared2::increment_allocated_size(IOAccelShared2 *this,long param_1)

{
  LOCK();
  **(long **)(this + 0xe0) = **(long **)(this + 0xe0) + param_1;
  UNLOCK();
  return;
}



// IOAccelShared2::destroy_shmem(unsigned int)

undefined8 __thiscall IOAccelShared2::destroy_shmem(IOAccelShared2 *this,uint param_1)

{
  int iVar1;
  undefined8 uVar2;
  long lVar3;
  undefined8 uVar4;
  long *local_28;
  
  local_28 = (long *)0x0;
  uVar2 = IOAccelNamespace::lookupId(*(IOAccelNamespace **)(this + 0xb8),param_1,(long *)&local_28);
  uVar4 = 0xe00002c2;
  if ((char)uVar2 != '\0') {
    iVar1 = (**(code **)(**(long **)(this + 0xc0) + 0x1f8))(*(long **)(this + 0xc0),local_28,0);
    if (iVar1 != -1) {
      lVar3 = (**(code **)(*local_28 + 0x128))();
      LOCK();
      **(long **)(this + 0xe0) = **(long **)(this + 0xe0) - lVar3;
      UNLOCK();
      (**(code **)(**(long **)(this + 0xc0) + 0x1d8))(*(long **)(this + 0xc0),iVar1);
      uVar4 = 0;
    }
  }
  return uVar4;
}



// IOAccelShared2::decrement_allocated_size(unsigned long long)

void __thiscall IOAccelShared2::decrement_allocated_size(IOAccelShared2 *this,long param_1)

{
  LOCK();
  **(long **)(this + 0xe0) = **(long **)(this + 0xe0) - param_1;
  UNLOCK();
  return;
}



// IOAccelShared2::lookupDeviceShmem(unsigned int) const

undefined1 * __thiscall IOAccelShared2::lookupDeviceShmem(IOAccelShared2 *this,uint param_1)

{
  undefined8 uVar1;
  undefined1 *local_10;
  
  local_10 = &DAT_aaaaaaaaaaaaaaaa;
  uVar1 = IOAccelNamespace::lookupId(*(IOAccelNamespace **)(this + 0xb8),param_1,(long *)&local_10);
  if ((char)uVar1 == '\0') {
    local_10 = (undefined1 *)0x0;
  }
  return local_10;
}



// IOAccelShared2::create_mtlevent(unsigned long long, IOAccelCreateMTLEventResult*)

undefined8 __thiscall
IOAccelShared2::create_mtlevent(IOAccelShared2 *this,undefined8 param_1,ulong *param_2)

{
  long *plVar1;
  undefined8 uVar2;
  
  plVar1 = IOAccelMTLEvent2::withAcceleratorNamespace
                     (*(undefined8 *)(this + 0x78),*(undefined8 *)(this + 0x128),param_1);
  if (plVar1 == (long *)0x0) {
    uVar2 = 0xe00002bd;
  }
  else {
    *param_2 = (ulong)*(uint *)(plVar1 + 4);
    param_2[1] = plVar1[0x51];
    param_2[2] = plVar1[7];
    (**(code **)(**(long **)(this + 0x130) + 0x1b8))(*(long **)(this + 0x130),plVar1);
    (**(code **)(*plVar1 + 0x28))(plVar1);
    uVar2 = 0;
  }
  return uVar2;
}



// IOAccelShared2::destroy_mtlevent(unsigned int)

undefined8 __thiscall IOAccelShared2::destroy_mtlevent(IOAccelShared2 *this,uint param_1)

{
  int iVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  long local_20;
  
  local_20 = 0;
  uVar2 = IOAccelNamespace::lookupId(*(IOAccelNamespace **)(this + 0x128),param_1,&local_20);
  uVar3 = 0xe00002c2;
  if ((char)uVar2 != '\0') {
    iVar1 = (**(code **)(**(long **)(this + 0x130) + 0x1f8))(*(long **)(this + 0x130),local_20,0);
    if (iVar1 != -1) {
      (**(code **)(**(long **)(this + 0x130) + 0x1d8))(*(long **)(this + 0x130),iVar1);
      uVar3 = 0;
    }
  }
  return uVar3;
}



// IOAccelShared2::lookupMTLEvent(unsigned int) const

undefined1 * __thiscall IOAccelShared2::lookupMTLEvent(IOAccelShared2 *this,uint param_1)

{
  undefined8 uVar1;
  undefined1 *local_10;
  
  local_10 = &DAT_aaaaaaaaaaaaaaaa;
  uVar1 = IOAccelNamespace::lookupId(*(IOAccelNamespace **)(this + 0x128),param_1,(long *)&local_10)
  ;
  if ((char)uVar1 == '\0') {
    local_10 = (undefined1 *)0x0;
  }
  return local_10;
}



// IOAccelShared2::getDirtyRingAddresses(unsigned long long*, unsigned long long*, unsigned long
// long*)

undefined8 __thiscall
IOAccelShared2::getDirtyRingAddresses
          (IOAccelShared2 *this,long *param_1,long *param_2,undefined8 *param_3)

{
  undefined8 uVar1;
  ulong uVar2;
  task *ptVar3;
  long lVar4;
  long *plVar5;
  
  if (*(long *)(this + 0x60) == 0) {
    lVar4 = *(long *)(this + 0x20);
    uVar2 = IOAccelClientSharedMachine::mapClientSharedForId
                      ((IOAccelClientSharedMachine *)(lVar4 + 0x50),0,(long *)(this + 0x38));
    if ((char)uVar2 == '\0') {
      return 0xe00002bd;
    }
    uVar2 = IOAccelClientSharedMachine::mapClientSharedForId
                      ((IOAccelClientSharedMachine *)(lVar4 + 0x90),0,(long *)(this + 0x40));
    if ((char)uVar2 == '\0') {
      return 0xe00002bd;
    }
    ptVar3 = (task *)(**(code **)(**(long **)(this + 0x78) + 0x928))
                               (*(long **)(this + 0x78),0,0x10023,0x4000);
    *(task **)(this + 0x48) = ptVar3;
    if (ptVar3 == (task *)0x0) {
      return 0xe00002bd;
    }
    IOGeneralMemoryDescriptor::setOwnership(ptVar3,(int)*(undefined8 *)(this + 0x80),4);
    lVar4 = IOMemoryDescriptor::createMappingInTask
                      (*(task **)(this + 0x48),*(ulonglong *)(this + 0x80),0,1,0);
    *(long *)(this + 0x58) = lVar4;
    if (lVar4 == 0) {
      (**(code **)(**(long **)(this + 0x48) + 0x28))();
      *(undefined8 *)(this + 0x48) = 0;
      return 0xe00002bd;
    }
    plVar5 = (long *)(**(code **)(**(long **)(this + 0x48) + 0x200))();
    *(long **)(this + 0x50) = plVar5;
    if (plVar5 == (long *)0x0) {
      (**(code **)(**(long **)(this + 0x48) + 0x28))();
      *(undefined8 *)(this + 0x48) = 0;
      (**(code **)(**(long **)(this + 0x58) + 0x28))();
      *(undefined8 *)(this + 0x58) = 0;
      return 0xe00002bd;
    }
    uVar1 = (**(code **)(*plVar5 + 0x118))(plVar5);
    *(undefined8 *)(this + 0x60) = uVar1;
    **(undefined8 **)(this + 0x38) = 0x40000000001;
    **(undefined4 **)(this + 0x40) = 1;
  }
  lVar4 = *(long *)(this + 0x20);
  IOAccelClientSharedMachine::getClientSharedAddressForId
            ((IOAccelClientSharedMachine *)(lVar4 + 0x50),0,param_1);
  IOAccelClientSharedMachine::getClientSharedAddressForId
            ((IOAccelClientSharedMachine *)(lVar4 + 0x90),0,param_2);
  uVar1 = (**(code **)(**(long **)(this + 0x58) + 0x118))();
  *param_3 = uVar1;
  return 0;
}



// IOAccelShared2::processResourceDirtyCommands()

void __thiscall IOAccelShared2::processResourceDirtyCommands(IOAccelShared2 *this)

{
  int iVar1;
  uint uVar2;
  long lVar3;
  undefined8 uVar4;
  long lVar5;
  uint uVar6;
  uint uVar7;
  undefined8 local_50;
  long *local_40;
  IOAccelShared2 *local_38;
  
  if (*(long *)(this + 0x60) == 0) {
    return;
  }
  iVar1 = **(int **)(this + 0x40);
  uVar6 = iVar1 - **(int **)(this + 0x38);
  local_38 = this;
  if (uVar6 < 0x401) {
    if (uVar6 == 0) goto LAB_0002baca;
  }
  else {
    _IOLog("Available resource dirty commands exceeds ring size\n");
    uVar6 = 0x400;
  }
  local_40 = (long *)&DAT_aaaaaaaaaaaaaaaa;
  uVar7 = **(uint **)(this + 0x38);
  local_50 = 0;
  do {
    lVar3 = *(long *)(local_38 + 0x60);
    lVar5 = (ulong)(uVar7 & 0x3ff) * 0x10;
    uVar2 = *(uint *)(lVar3 + 4 + lVar5);
    uVar4 = IOAccelNamespace::lookupId
                      (*(IOAccelNamespace **)(local_38 + 0x20),*(uint *)(lVar3 + lVar5),
                       (long *)&local_40);
    if ((char)uVar4 != '\0') {
      switch(uVar2) {
      case 1:
        (**(code **)(*local_40 + 0x218))
                  (local_40,*(undefined4 *)(lVar3 + 8 + lVar5),*(undefined4 *)(lVar3 + 0xc + lVar5))
        ;
        break;
      case 2:
        (**(code **)(*local_40 + 0x210))
                  (local_40,*(undefined4 *)(lVar3 + 8 + lVar5),*(undefined4 *)(lVar3 + 0xc + lVar5))
        ;
        break;
      case 3:
        local_50 = *(undefined8 *)(lVar3 + 8 + lVar5);
        break;
      case 4:
        (**(code **)(*local_40 + 0x230))(local_40,local_50,*(undefined8 *)(lVar3 + 8 + lVar5));
        break;
      default:
        if (0xfe < uVar2) {
          (**(code **)(*local_40 + 0x238))(local_40,uVar2,*(undefined8 *)(lVar3 + 8 + lVar5));
        }
      }
    }
    uVar7 = uVar7 + 1;
    uVar6 = uVar6 - 1;
  } while (uVar6 != 0);
LAB_0002baca:
  **(int **)(local_38 + 0x38) = iVar1;
  return;
}



// IOAccelShared2::allocate_fence_memory(unsigned long long, unsigned long long*)

undefined8 __thiscall
IOAccelShared2::allocate_fence_memory(IOAccelShared2 *this,ulong param_1,ulong *param_2)

{
  uint uVar1;
  long lVar2;
  uint uVar3;
  ulong uVar4;
  long lVar5;
  int iVar6;
  long lVar7;
  int iVar8;
  long lVar9;
  ulong uVar10;
  
  if (0x10000 < param_1) {
    return 0xe00002bd;
  }
  if (*(uint *)(this + 0x70) < param_1) {
    uVar1 = *(uint *)(*(long *)(this + 0x78) + 0xcf4);
    uVar3 = -uVar1;
    if ((int)-uVar1 < 0) {
      uVar3 = uVar1;
    }
    uVar4 = uVar3 * param_1;
    uVar10 = -uVar4;
    if ((int)uVar1 >= 0) {
      uVar10 = uVar4;
    }
    if ((int)uVar1 < 0 && uVar4 != 0) {
      return 0xe00002bc;
    }
    if (uVar10 >> 0x3a != 0) {
      return 0xe00002bc;
    }
    lVar5 = _IOMallocData(uVar10 << 6);
    if (lVar5 == 0) {
      return 0xe00002bd;
    }
    iVar6 = *(int *)(this + 0x70);
    lVar2 = *(long *)(this + 0x68);
    if (lVar2 != 0) {
      if (iVar6 * uVar1 == 0) {
        lVar7 = 0;
      }
      else {
        uVar10 = (ulong)(iVar6 * uVar1);
        lVar7 = lVar2;
        lVar9 = lVar5;
        do {
          (**(code **)(**(long **)(*(long *)(this + 0x78) + 0x380) + 0x1b0))
                    (*(long **)(*(long *)(this + 0x78) + 0x380),lVar7,lVar9);
          lVar7 = lVar7 + 0x40;
          lVar9 = lVar9 + 0x40;
          uVar10 = uVar10 - 1;
        } while (uVar10 != 0);
        lVar7 = (ulong)(*(int *)(this + 0x70) * uVar1) << 6;
      }
      _IOFreeData(lVar2,lVar7);
      iVar6 = *(int *)(this + 0x70);
    }
    iVar6 = ((int)param_1 - iVar6) * uVar1;
    if (iVar6 != 0) {
      iVar8 = 0;
      do {
        (**(code **)(**(long **)(*(long *)(this + 0x78) + 0x380) + 0x140))
                  (*(long **)(*(long *)(this + 0x78) + 0x380),
                   (ulong)(*(int *)(this + 0x70) * uVar1 + iVar8) * 0x40 + lVar5);
        iVar8 = iVar8 + 1;
      } while (iVar6 != iVar8);
    }
    *(int *)(this + 0x70) = (int)param_1;
    *param_2 = param_1 & 0xffffffff;
    *(long *)(this + 0x68) = lVar5;
  }
  else {
    *param_2 = (ulong)*(uint *)(this + 0x70);
  }
  return 0;
}



// IOAccelShared2::scrubEvents()

void __thiscall IOAccelShared2::scrubEvents(IOAccelShared2 *this)

{
  long *plVar1;
  undefined1 *local_28;
  undefined1 *local_20;
  undefined1 *local_18;
  
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  local_20 = &DAT_aaaaaaaaaaaaaaaa;
  local_18 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelResourceList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_28,(long)(this + 0xa0));
  plVar1 = (long *)IOAccelResourceList::ReverseIterator::getPrevResource
                             ((ReverseIterator *)&local_28);
  if (plVar1 != (long *)0x0) {
    do {
      (**(code **)(*plVar1 + 0x228))(plVar1);
      plVar1 = (long *)IOAccelResourceList::ReverseIterator::getPrevResource
                                 ((ReverseIterator *)&local_28);
    } while (plVar1 != (long *)0x0);
  }
  return;
}



// IOAccelShared2::add_orphaned_mappings(OSSet*)

void __thiscall IOAccelShared2::add_orphaned_mappings(IOAccelShared2 *this,OSSet *param_1)

{
  long lVar1;
  undefined8 uVar2;
  
  lVar1 = *(long *)(this + 0x110);
  if (lVar1 != 0) {
    if (*(long **)(lVar1 + 0x150) != (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0002bd00. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(**(long **)(lVar1 + 0x150) + 0x1d0))();
      return;
    }
    uVar2 = OSSet::withSet(param_1,0);
    *(undefined8 *)(lVar1 + 0x150) = uVar2;
  }
  return;
}



// IOAccelSharedUserClient2::add_orphaned_mappings(OSSet*)

void __thiscall
IOAccelSharedUserClient2::add_orphaned_mappings(IOAccelSharedUserClient2 *this,OSSet *param_1)

{
  undefined8 uVar1;
  
  if (*(long **)(this + 0x150) != (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0002bd3f. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0x150) + 0x1d0))();
    return;
  }
  uVar1 = OSSet::withSet(param_1,0);
  *(undefined8 *)(this + 0x150) = uVar1;
  return;
}



// IOAccelShared2::set_user_client(IOAccelSharedUserClient2*)

void __thiscall IOAccelShared2::set_user_client(IOAccelShared2 *this,undefined8 param_1)

{
  *(undefined8 *)(this + 0x110) = param_1;
  return;
}



// IOAccelShared2::increment_ctx_refcount()

void __thiscall IOAccelShared2::increment_ctx_refcount(IOAccelShared2 *this)

{
  *(int *)(this + 0x120) = *(int *)(this + 0x120) + 1;
  return;
}



// IOAccelShared2::decrement_ctx_refcount()

void __thiscall IOAccelShared2::decrement_ctx_refcount(IOAccelShared2 *this)

{
  IOAccelShared2 *pIVar1;
  
  pIVar1 = this + 0x120;
  *(int *)pIVar1 = *(int *)pIVar1 + -1;
  if ((*(int *)pIVar1 == 0) &&
     (*(IOAccelSharedUserClient2 **)(this + 0x110) != (IOAccelSharedUserClient2 *)0x0)) {
    IOAccelSharedUserClient2::try_detach_shared(*(IOAccelSharedUserClient2 **)(this + 0x110));
    return;
  }
  return;
}



// IOAccelSharedUserClient2::try_detach_shared()

void __thiscall IOAccelSharedUserClient2::try_detach_shared(IOAccelSharedUserClient2 *this)

{
  int iVar1;
  
  if (this[0x10d] != (IOAccelSharedUserClient2)0x0) {
    _IOLockLock(*(undefined8 *)(this + 0x158));
    iVar1 = *(int *)(this + 0x160);
    this[0x10e] = (IOAccelSharedUserClient2)(iVar1 != 0);
    _IOLockUnlock(*(undefined8 *)(this + 0x158));
    if (iVar1 == 0) {
      detach_shared(this);
      return;
    }
  }
  return;
}



// IOAccelShared2::orphanClientMappings(OSSet*)

void __thiscall IOAccelShared2::orphanClientMappings(IOAccelShared2 *this,long *param_1)

{
  int iVar1;
  long lVar2;
  int iVar3;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelResourceList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_40,(long)(this + 0xa0));
  lVar2 = IOAccelResourceList::ReverseIterator::getPrevResource((ReverseIterator *)&local_40);
  if (lVar2 != 0) {
    do {
      if (*(long *)(lVar2 + 0x60) != 0) {
        (**(code **)(*param_1 + 0x1c0))(param_1);
      }
      if (*(long *)(lVar2 + 0x58) != 0) {
        (**(code **)(*param_1 + 0x1c0))(param_1);
      }
      lVar2 = IOAccelResourceList::ReverseIterator::getPrevResource((ReverseIterator *)&local_40);
    } while (lVar2 != 0);
  }
  iVar1 = (**(code **)(**(long **)(this + 0xc0) + 0x130))();
  if (iVar1 != 0) {
    iVar3 = 0;
    do {
      lVar2 = (**(code **)(**(long **)(this + 0xc0) + 0x1e8))(*(long **)(this + 0xc0),iVar3);
      if (*(long *)(lVar2 + 0x58) != 0) {
        (**(code **)(*param_1 + 0x1c0))(param_1);
      }
      iVar3 = iVar3 + 1;
    } while (iVar1 != iVar3);
  }
  if (*(long *)(this + 0x58) != 0) {
    (**(code **)(*param_1 + 0x1c0))(param_1);
  }
  IOAccelSharedNamespace2::orphanClientMappings(*(IOAccelSharedNamespace2 **)(this + 0x20),param_1);
  return;
}



// IOAccelShared2::getMemoryData(IOAccelMemoryData*)

undefined8 __thiscall IOAccelShared2::getMemoryData(IOAccelShared2 *this,long *param_1)

{
  IOAccelResource2 IVar1;
  int iVar2;
  IOAccelResource2 *this_00;
  long lVar3;
  OSMetaClassBase *pOVar4;
  long *plVar5;
  int iVar6;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  long *local_38;
  
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  param_1[5] = 0;
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelResourceList::Iterator::Iterator((Iterator *)&local_50,(undefined8 *)(this + 0xa0));
  this_00 = (IOAccelResource2 *)
            IOAccelResourceList::Iterator::getNextResource((Iterator *)&local_50);
  if (this_00 != (IOAccelResource2 *)0x0) {
    local_38 = param_1 + 5;
    do {
      lVar3 = IOAccelResource2::getResidentSize(this_00);
      *param_1 = *param_1 + lVar3;
      if (((byte)this_00[0xe] & 0x10) != 0) {
        param_1[1] = param_1[1] + lVar3;
      }
      if ((*(long *)(this_00 + 0x88) == 0) ||
         ((*(byte *)(*(long *)(this_00 + 0x88) + 0xc) & 4) == 0)) {
        param_1[2] = param_1[2] + lVar3;
        IVar1 = this_00[0xe];
        plVar5 = param_1 + 3;
      }
      else {
        param_1[4] = param_1[4] + lVar3;
        IVar1 = this_00[0xe];
        plVar5 = local_38;
      }
      if (((byte)IVar1 & 0x10) != 0) {
        *plVar5 = *plVar5 + lVar3;
      }
      this_00 = (IOAccelResource2 *)
                IOAccelResourceList::Iterator::getNextResource((Iterator *)&local_50);
    } while (this_00 != (IOAccelResource2 *)0x0);
  }
  iVar2 = (**(code **)(**(long **)(this + 0xc0) + 0x130))();
  if (iVar2 != 0) {
    iVar6 = 0;
    do {
      pOVar4 = (OSMetaClassBase *)
               (**(code **)(**(long **)(this + 0xc0) + 0x1e8))(*(long **)(this + 0xc0),iVar6);
      plVar5 = (long *)OSMetaClassBase::safeMetaCast
                                 (pOVar4,(OSMetaClass *)&IOAccelDeviceShmem::gMetaClass);
      if (plVar5 != (long *)0x0) {
        lVar3 = (**(code **)(*plVar5 + 0x128))(plVar5);
        *param_1 = *param_1 + lVar3;
      }
      iVar6 = iVar6 + 1;
    } while (iVar2 != iVar6);
  }
  return 0;
}



// IOAccelShared2::getAllocatedSize(unsigned long long*)

undefined8 __thiscall IOAccelShared2::getAllocatedSize(IOAccelShared2 *this,undefined8 *param_1)

{
  *param_1 = **(undefined8 **)(this + 0xe0);
  return 0;
}



// IOAccelShared2::getClientSharedAllocatedSizeAddress(unsigned long long*)

void __thiscall
IOAccelShared2::getClientSharedAllocatedSizeAddress(IOAccelShared2 *this,undefined8 *param_1)

{
  undefined1 *local_20;
  
  local_20 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelClientSharedMachine::getClientSharedAddressForId
            ((IOAccelClientSharedMachine *)(*(long *)(this + 0x20) + 0x50),0,(long *)&local_20);
  *param_1 = local_20 + 8;
  return;
}



// IOAccelShared2::setResourceOwnerIdentity(unsigned int, unsigned int)

ulong __thiscall
IOAccelShared2::setResourceOwnerIdentity(IOAccelShared2 *this,uint param_1,int param_2)

{
  int iVar1;
  undefined8 uVar2;
  ulong uVar3;
  IOAccelResource2 *local_28;
  long local_20;
  
  uVar3 = 0xe00002c2;
  if (param_2 - 1U < 0xfffffffe) {
    local_28 = (IOAccelResource2 *)0x0;
    uVar2 = IOAccelNamespace::lookupId
                      (*(IOAccelNamespace **)(this + 0x20),param_1,(long *)&local_28);
    uVar3 = 0xe00002c2;
    if ((char)uVar2 != '\0') {
      local_20 = 0;
      iVar1 = _task_id_token_port_name_to_task(param_2);
      uVar3 = 0xe00002c2;
      if (iVar1 == 0) {
        if (local_20 == 0) {
          uVar3 = 0xe00002c7;
        }
        else {
          uVar3 = IOAccelResource2::setOwnership(local_28,(int)local_20);
          uVar3 = uVar3 & 0xffffffff;
          _task_deallocate(local_20);
        }
      }
    }
  }
  return uVar3;
}



// IOAccelShared2::_RESERVEDIOAccelShared0()

void IOAccelShared2::_RESERVEDIOAccelShared0(void)

{
  OSMetaClass::reservedCalled(0x82480);
  return;
}



// IOAccelShared2::_RESERVEDIOAccelShared1()

void IOAccelShared2::_RESERVEDIOAccelShared1(void)

{
  OSMetaClass::reservedCalled(0x82480);
  return;
}



// IOAccelShared2::_RESERVEDIOAccelShared2()

void IOAccelShared2::_RESERVEDIOAccelShared2(void)

{
  OSMetaClass::reservedCalled(0x82480);
  return;
}



// IOAccelShared2::_RESERVEDIOAccelShared3()

void IOAccelShared2::_RESERVEDIOAccelShared3(void)

{
  OSMetaClass::reservedCalled(0x82480);
  return;
}



// IOAccelShared2::_RESERVEDIOAccelShared4()

void IOAccelShared2::_RESERVEDIOAccelShared4(void)

{
  OSMetaClass::reservedCalled(0x82480);
  return;
}



// IOAccelShared2::_RESERVEDIOAccelShared5()

void IOAccelShared2::_RESERVEDIOAccelShared5(void)

{
  OSMetaClass::reservedCalled(0x82480);
  return;
}



// IOAccelSharedUserClient2::MetaClass::MetaClass()

void __thiscall IOAccelSharedUserClient2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelSharedUserClient2",(OSMetaClass *)PTR_gMetaClass_0006b018,
             0x168);
  *(undefined ***)this = &PTR__MetaClass_00078bd8;
  return;
}



// IOAccelSharedUserClient2::MetaClass::~MetaClass()

void __thiscall IOAccelSharedUserClient2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelSharedUserClient2::IOAccelSharedUserClient2(OSMetaClass const*)

void __thiscall
IOAccelSharedUserClient2::IOAccelSharedUserClient2
          (IOAccelSharedUserClient2 *this,OSMetaClass *param_1)

{
  IOUserClient::IOUserClient((IOUserClient *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelSharedUserClient2_00078220;
  return;
}



// IOAccelSharedUserClient2::IOAccelSharedUserClient2(OSMetaClass const*)

void __thiscall
IOAccelSharedUserClient2::IOAccelSharedUserClient2
          (IOAccelSharedUserClient2 *this,OSMetaClass *param_1)

{
  IOUserClient::IOUserClient((IOUserClient *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelSharedUserClient2_00078220;
  return;
}



// IOAccelSharedUserClient2::~IOAccelSharedUserClient2()

void __thiscall IOAccelSharedUserClient2::~IOAccelSharedUserClient2(IOAccelSharedUserClient2 *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  return;
}



// IOAccelSharedUserClient2::~IOAccelSharedUserClient2()

void __thiscall IOAccelSharedUserClient2::~IOAccelSharedUserClient2(IOAccelSharedUserClient2 *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  return;
}



// IOAccelSharedUserClient2::~IOAccelSharedUserClient2()

void __thiscall IOAccelSharedUserClient2::~IOAccelSharedUserClient2(IOAccelSharedUserClient2 *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  _OSObject_typed_operator_delete(&IOAccelSharedUserClient2_ktv,this,0x168);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSharedUserClient2::operator delete(void*, unsigned long)

void __cdecl IOAccelSharedUserClient2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelSharedUserClient2_ktv,param_1,param_2);
  return;
}



// IOAccelSharedUserClient2::getMetaClass() const

undefined1 * IOAccelSharedUserClient2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelSharedUserClient2::MetaClass::MetaClass()

void __thiscall IOAccelSharedUserClient2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelSharedUserClient2",(OSMetaClass *)PTR_gMetaClass_0006b018,
             0x168);
  *(undefined ***)this = &PTR__MetaClass_00078bd8;
  return;
}



// IOAccelSharedUserClient2::MetaClass::alloc() const

IOUserClient * IOAccelSharedUserClient2::MetaClass::alloc(void)

{
  IOUserClient *this;
  
  this = (IOUserClient *)_OSObject_typed_operator_new(&IOAccelSharedUserClient2_ktv,0x168);
  IOUserClient::IOUserClient(this,(OSMetaClass *)&IOAccelSharedUserClient2::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelSharedUserClient2_00078220;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelSharedUserClient2::operator new(unsigned long)

void * __thiscall IOAccelSharedUserClient2::operator_new(IOAccelSharedUserClient2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelSharedUserClient2_ktv,this);
  return pvVar1;
}



// IOAccelSharedUserClient2::IOAccelSharedUserClient2()

void __thiscall IOAccelSharedUserClient2::IOAccelSharedUserClient2(IOAccelSharedUserClient2 *this)

{
  IOUserClient::IOUserClient((IOUserClient *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelSharedUserClient2_00078220;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelSharedUserClient2::IOAccelSharedUserClient2()

void __thiscall IOAccelSharedUserClient2::IOAccelSharedUserClient2(IOAccelSharedUserClient2 *this)

{
  IOUserClient::IOUserClient((IOUserClient *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelSharedUserClient2_00078220;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelSharedUserClient2::init(OSDictionary*, task*)

undefined4 __thiscall
IOAccelSharedUserClient2::init
          (IOAccelSharedUserClient2 *this,undefined8 param_2_00,undefined8 param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined8 uVar3;
  long lVar4;
  
  uVar1 = (**(code **)(PTR_vtable_0006b088 + 600))();
  if ((char)uVar1 != '\0') {
    uVar3 = _IOLockAlloc();
    *(undefined8 *)(this + 0x158) = uVar3;
    _task_reference(param_2);
    *(undefined8 *)(this + 0xe0) = param_2;
    lVar4 = _get_bsdtask_info(param_2);
    if (lVar4 == 0) {
      uVar2 = 0xffffffff;
    }
    else {
      uVar2 = _proc_pid(lVar4);
    }
    *(undefined4 *)(this + 0xe8) = uVar2;
  }
  return uVar1;
}



// IOAccelSharedUserClient2::start(IOService*)

bool __thiscall
IOAccelSharedUserClient2::start(IOAccelSharedUserClient2 *this,OSMetaClassBase *param_1)

{
  char cVar1;
  byte bVar2;
  IOGraphicsAccelerator2 *pIVar3;
  
  cVar1 = (**(code **)(PTR_vtable_0006b088 + 0x5d0))();
  if (cVar1 != '\0') {
    pIVar3 = (IOGraphicsAccelerator2 *)
             OSMetaClassBase::safeMetaCast
                       (param_1,(OSMetaClass *)&IOGraphicsAccelerator2::gMetaClass);
    *(IOGraphicsAccelerator2 **)(this + 0xf8) = pIVar3;
    if (pIVar3 != (IOGraphicsAccelerator2 *)0x0) {
      _OSIncrementAtomic(pIVar3 + 0x90);
      _IOLockLock(*(undefined8 *)(pIVar3 + 0x88));
      _OSDecrementAtomic(pIVar3 + 0x90);
      IOGraphicsAccelerator2::lock_busy(pIVar3);
      (**(code **)(*(long *)pIVar3 + 0x850))(pIVar3,"",0);
      bVar2 = (**(code **)(*(long *)this + 0x990))(this);
      *(uint *)(this + 0x108) = (uint)bVar2;
      pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
      (**(code **)(*(long *)pIVar3 + 0x858))(pIVar3,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar3);
      _IOLockUnlock(*(undefined8 *)(pIVar3 + 0x88));
      return *(int *)(this + 0x108) != 0;
    }
  }
  return false;
}



// IOGraphicsAccelerator2::acceleratorLock()

void __thiscall IOGraphicsAccelerator2::acceleratorLock(IOGraphicsAccelerator2 *this)

{
  _OSIncrementAtomic(this + 0x90);
  _IOLockLock(*(undefined8 *)(this + 0x88));
  _OSDecrementAtomic(this + 0x90);
  lock_busy(this);
                    // WARNING: Could not recover jumptable at 0x0002c509. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x850))(this,"",0);
  return;
}



// IOGraphicsAccelerator2::acceleratorUnlock()

void __thiscall IOGraphicsAccelerator2::acceleratorUnlock(IOGraphicsAccelerator2 *this)

{
  (**(code **)(*(long *)this + 0x858))(this,"",0);
  unlock_busy(this);
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  return;
}



// IOAccelSharedUserClient2::free()

void __thiscall IOAccelSharedUserClient2::free(IOAccelSharedUserClient2 *this)

{
  if (*(long *)(this + 0x158) != 0) {
    _IOLockFree();
    *(undefined8 *)(this + 0x158) = 0;
  }
  if (*(long **)(this + 0x150) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x150) + 0x28))();
  }
  *(undefined8 *)(this + 0x150) = 0;
  if (*(long *)(this + 0xe0) != 0) {
    _task_deallocate();
  }
                    // WARNING: Could not recover jumptable at 0x0002c5a5. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b088 + 0xa0))(this);
  return;
}



// IOAccelSharedUserClient2::stopLocked()

void __thiscall IOAccelSharedUserClient2::stopLocked(IOAccelSharedUserClient2 *this)

{
  (**(code **)(*(long *)this + 0x998))();
  *(undefined4 *)(this + 0x108) = 0;
  (**(code **)(*(long *)this + 0x678))(this,*(undefined8 *)(this + 0xf8));
  *(undefined8 *)(this + 0xf8) = 0;
                    // WARNING: Could not recover jumptable at 0x0002c5f2. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x28))(this);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSharedUserClient2::stop(IOService*)

void __cdecl IOAccelSharedUserClient2::stop(long *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  
  if ((int)param_1[0x21] != 0) {
    pIVar1 = (IOGraphicsAccelerator2 *)param_1[0x1f];
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    pIVar1 = (IOGraphicsAccelerator2 *)param_1[0x1f];
    (**(code **)(*(long *)pIVar1 + 0x20))(pIVar1);
    (**(code **)(*param_1 + 0x998))(param_1);
    *(undefined4 *)(param_1 + 0x21) = 0;
    (**(code **)(*param_1 + 0x678))(param_1,param_1[0x1f]);
    param_1[0x1f] = 0;
    (**(code **)(*param_1 + 0x28))(param_1);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
                    // WARNING: Could not recover jumptable at 0x0002c6dc. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*(long *)pIVar1 + 0x28))(pIVar1);
    return;
  }
  return;
}



// IOAccelSharedUserClient2::connectClient(IOUserClient*)

ulong __thiscall
IOAccelSharedUserClient2::connectClient(IOAccelSharedUserClient2 *this,OSMetaClassBase *param_1)

{
  IOGraphicsAccelerator2 *this_00;
  IOAccelSharedUserClient2 *this_01;
  long lVar1;
  ulong uVar2;
  
  this_01 = (IOAccelSharedUserClient2 *)
            OSMetaClassBase::safeMetaCast(param_1,(OSMetaClass *)&gMetaClass);
  if (this_01 == (IOAccelSharedUserClient2 *)0x0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Received a bogus share device.\n",
                      "virtual IOReturn IOAccelSharedUserClient2::connectClient(IOUserClient *)");
    uVar2 = 0xe00002bc;
  }
  else if (*(long *)(*(long *)(this + 0xf8) + 0xd10) == 0) {
    uVar2 = 0xe00002c7;
  }
  else {
    uVar2 = 0xe00002c2;
    if ((param_1 != (OSMetaClassBase *)this) &&
       (*(long *)(this_01 + 0xe0) == *(long *)(this + 0xe0))) {
      _OSIncrementAtomic(this_01 + 0x160);
      uVar2 = 0xe00002eb;
      if ((this_01[0x10d] == (IOAccelSharedUserClient2)0x0) &&
         (this_01[0x165] == (IOAccelSharedUserClient2)0x0)) {
        lVar1 = OSMetaClassBase::safeMetaCast
                          (*(OSMetaClassBase **)(this_01 + 0xf8),
                           (OSMetaClass *)&IOGraphicsAccelerator2::gMetaClass);
        uVar2 = 0xe00002c2;
        if (((lVar1 != 0) &&
            (this_00 = *(IOGraphicsAccelerator2 **)(this + 0xf8),
            *(long *)(lVar1 + 0xd10) == *(long *)(this_00 + 0xd10))) &&
           (*(short *)(lVar1 + 0xd18) != *(short *)(this_00 + 0xd18))) {
          IOGraphicsAccelerator2::acceleratorLock(this_00);
          uVar2 = IOAccelShared2::connectPeerShared
                            (*(IOAccelShared2 **)(this + 0x100),(long *)this_01);
          uVar2 = uVar2 & 0xffffffff;
          IOGraphicsAccelerator2::acceleratorUnlock(*(IOGraphicsAccelerator2 **)(this + 0xf8));
        }
        exit_external_rpc(this_01);
      }
    }
  }
  return uVar2;
}



// IOAccelSharedUserClient2::enter_external_rpc()

undefined8 __thiscall IOAccelSharedUserClient2::enter_external_rpc(IOAccelSharedUserClient2 *this)

{
  undefined8 uVar1;
  
  _OSIncrementAtomic(this + 0x160);
  uVar1 = 0xe00002d9;
  if ((this[0x10d] == (IOAccelSharedUserClient2)0x0) &&
     (uVar1 = 0xe00002d9, this[0x165] == (IOAccelSharedUserClient2)0x0)) {
    uVar1 = 0;
  }
  return uVar1;
}



// IOAccelSharedUserClient2::exit_external_rpc()

void __thiscall IOAccelSharedUserClient2::exit_external_rpc(IOAccelSharedUserClient2 *this)

{
  IOAccelSharedUserClient2 IVar1;
  IOAccelSharedUserClient2 IVar2;
  IOGraphicsAccelerator2 *this_00;
  int iVar3;
  
  iVar3 = _OSDecrementAtomic(this + 0x160);
  if ((iVar3 == 1) &&
     ((this[0x10d] != (IOAccelSharedUserClient2)0x0 ||
      (this[0x165] != (IOAccelSharedUserClient2)0x0)))) {
    _IOLockLock(*(undefined8 *)(this + 0x158));
    IVar1 = this[0x10e];
    if (IVar1 != (IOAccelSharedUserClient2)0x0) {
      this[0x10e] = (IOAccelSharedUserClient2)0x0;
    }
    IVar2 = this[0x164];
    if (IVar2 == (IOAccelSharedUserClient2)0x0) {
      _IOLockUnlock(*(undefined8 *)(this + 0x158));
      if (IVar1 == (IOAccelSharedUserClient2)0x0) {
        return;
      }
    }
    else {
      this[0x164] = (IOAccelSharedUserClient2)0x0;
      _IOLockUnlock(*(undefined8 *)(this + 0x158));
      if (IVar1 == (IOAccelSharedUserClient2)0x0) goto LAB_0002c994;
    }
    this_00 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
    (**(code **)(*(long *)this_00 + 0x20))(this_00);
    _OSIncrementAtomic(this_00 + 0x90);
    _IOLockLock(*(undefined8 *)(this_00 + 0x88));
    _OSDecrementAtomic(this_00 + 0x90);
    IOGraphicsAccelerator2::lock_busy(this_00);
    (**(code **)(*(long *)this_00 + 0x850))(this_00,"",0);
    detach_shared(this);
    (**(code **)(*(long *)this_00 + 0x858))(this_00,"",0);
    IOGraphicsAccelerator2::unlock_busy(this_00);
    _IOLockUnlock(*(undefined8 *)(this_00 + 0x88));
    (**(code **)(*(long *)this_00 + 0x28))(this_00);
    if (IVar2 != (IOAccelSharedUserClient2)0x0) {
LAB_0002c994:
                    // WARNING: Could not recover jumptable at 0x0002c9ab. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*(long *)this + 0x600))(this,0);
      return;
    }
  }
  return;
}



// IOAccelSharedUserClient2::requestTerminate(IOService*, unsigned int)

undefined8 IOAccelSharedUserClient2::requestTerminate(void)

{
  return 0;
}



// IOAccelSharedUserClient2::didTerminate(IOService*, unsigned int, bool*)

void __thiscall
IOAccelSharedUserClient2::didTerminate
          (IOAccelSharedUserClient2 *this,undefined8 param_1,undefined4 param_2,undefined1 *param_3)

{
  IOGraphicsAccelerator2 *this_00;
  
  *param_3 = 1;
  this[0x10d] = (IOAccelSharedUserClient2)0x1;
  this_00 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)this_00 + 0x20))(this_00);
  _OSIncrementAtomic(this_00 + 0x90);
  _IOLockLock(*(undefined8 *)(this_00 + 0x88));
  _OSDecrementAtomic(this_00 + 0x90);
  IOGraphicsAccelerator2::lock_busy(this_00);
  (**(code **)(*(long *)this_00 + 0x850))(this_00,"",0);
  if ((*(long *)(this + 0x100) != 0) && (*(int *)(*(long *)(this + 0x100) + 0x120) == 0)) {
    try_detach_shared(this);
  }
  (**(code **)(*(long *)this_00 + 0x858))(this_00,"",0);
  IOGraphicsAccelerator2::unlock_busy(this_00);
  _IOLockUnlock(*(undefined8 *)(this_00 + 0x88));
  (**(code **)(*(long *)this_00 + 0x28))(this_00);
                    // WARNING: Could not recover jumptable at 0x0002caa7. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b088 + 0x418))(this,param_1,param_2,param_3);
  return;
}



// IOAccelSharedUserClient2::clientClose()

undefined8 __thiscall IOAccelSharedUserClient2::clientClose(IOAccelSharedUserClient2 *this)

{
  int iVar1;
  
  this[0x165] = (IOAccelSharedUserClient2)0x1;
  _IOLockLock(*(undefined8 *)(this + 0x158));
  iVar1 = *(int *)(this + 0x160);
  this[0x164] = (IOAccelSharedUserClient2)(iVar1 != 0);
  _IOLockUnlock(*(undefined8 *)(this + 0x158));
  if (iVar1 == 0) {
    (**(code **)(*(long *)this + 0x600))(this,0);
  }
  return 0;
}



// IOAccelSharedUserClient2::new_resource(IOAccelNewResourceArgs*, IOAccelNewResourceReturnData*,
// unsigned long long, unsigned int*)

undefined8 __thiscall
IOAccelSharedUserClient2::new_resource
          (IOAccelSharedUserClient2 *this,uint *param_1,long *param_2,ulong param_3,uint *param_4)

{
  int *piVar1;
  IOAccelResource2 IVar2;
  ulonglong uVar3;
  char cVar4;
  uint uVar5;
  undefined4 uVar6;
  int iVar7;
  long *plVar8;
  ulong uVar9;
  undefined8 uVar10;
  long lVar11;
  ulong uVar12;
  IOAccelResource2 *pIVar13;
  long *plVar14;
  undefined8 *puVar15;
  IOAccelShared2 *pIVar16;
  uint uVar17;
  undefined8 uVar18;
  IOGraphicsAccelerator2 *pIVar19;
  IOAccelResource2 *local_40;
  
  uVar18 = 0xe00002c2;
  if (param_3 < 0x68) {
    return 0xe00002c2;
  }
  if ((ulong)*param_4 < (ulong)*(uint *)(*(long **)(this + 0xf8) + 0x19d) + 0x58) {
    return 0xe00002c2;
  }
  if (((char)param_1[8] != '\x06') && ((char)param_1[8] != '\x01')) {
    return 0xe00002c2;
  }
  uVar5 = *param_1;
  if ((uVar5 & 0xf) == 0) {
    uVar12 = *(ulong *)(param_1 + 0x16);
    uVar9 = (**(code **)(**(long **)(this + 0xf8) + 0x988))();
    if (uVar9 < uVar12) {
      (**(code **)(**(long **)(this + 0xf8) + 0x988))();
      uVar18 = *(undefined8 *)(param_1 + 0x16);
      uVar10 = (**(code **)(**(long **)(this + 0xf8) + 0x988))();
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s failed: try to wire down too much memory : %llu > %llu\n",
                        "IOReturn IOAccelSharedUserClient2::new_resource(IOAccelNewResourceArgs *, struct IOAccelNewResourceReturnData *, IOByteCount, uint32_t *)"
                        ,uVar18,uVar10);
      return 0xe00002c2;
    }
    uVar5 = *param_1;
    if (((uVar5 & 0x80) == 0) && ((param_1[1] & 0xfffff0ff) != 0)) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s invalid bits in cache_mode 0x%x\n",
                        "IOReturn IOAccelSharedUserClient2::new_resource(IOAccelNewResourceArgs *, struct IOAccelNewResourceReturnData *, IOByteCount, uint32_t *)"
                       );
      return 0xe00002c2;
    }
  }
  uVar17 = 0;
  if (uVar5 == 0x82) {
    plVar8 = (long *)IOSurfaceRoot::lookupSurface
                               ((uint)*(undefined8 *)(*(long *)(this + 0xf8) + 0x170),
                                (task *)(ulong)param_1[0x10]);
    if (plVar8 == (long *)0x0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s invalid IOSurface ID 0x%x\n",
                        "IOReturn IOAccelSharedUserClient2::new_resource(IOAccelNewResourceArgs *, struct IOAccelNewResourceReturnData *, IOByteCount, uint32_t *)"
                        ,param_1[0x10]);
      return 0xe00002c2;
    }
    uVar5 = IOSurface::getPlaneCount();
    if ((uVar5 != 0) && (uVar5 <= param_1[0x11])) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s invalid plane %d in IOSurface with %d planes\n",
                        "IOReturn IOAccelSharedUserClient2::new_resource(IOAccelNewResourceArgs *, struct IOAccelNewResourceReturnData *, IOByteCount, uint32_t *)"
                        ,param_1[0x11],uVar5);
      goto LAB_0002d50d;
    }
  }
  else {
    plVar8 = (long *)0x0;
  }
  if (((*(byte *)((long)param_1 + 0x25) & 8) == 0) || (uVar17 = param_1[0x18], uVar17 != 0)) {
    uVar5 = IOAccelResourceList::getCount((IOAccelResourceList *)(*(long *)(this + 0x100) + 0xa0));
    pIVar19 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
    if (*(uint *)(pIVar19 + 0xd00) < uVar5) {
      if ((uVar5 * 0x26e978d5 + 0x10624d8 >> 3 | uVar5 * -0x60000000) < 0x418937) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: PID %d likely leaking IOAccelResource (count=%d)\n",
                          "IOReturn IOAccelSharedUserClient2::new_resource(IOAccelNewResourceArgs *, struct IOAccelNewResourceReturnData *, IOByteCount, uint32_t *)"
                          ,*(undefined4 *)(this + 0xe8),uVar5);
        pIVar19 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
      }
      if (*(uint *)(pIVar19 + 0xd04) < uVar5) {
        _IOSleep(16000);
        pIVar19 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
      }
    }
    _OSIncrementAtomic(pIVar19 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar19 + 0x88));
    _OSDecrementAtomic(pIVar19 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar19);
    (**(code **)(*(long *)pIVar19 + 0x850))(pIVar19,"",0);
    uVar6 = IOGraphicsAccelerator2::acceleratorWaitEnabled
                      (*(IOGraphicsAccelerator2 **)(this + 0xf8));
    if ((char)uVar6 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: %s device terminated\n",
                        "IOReturn IOAccelSharedUserClient2::new_resource(IOAccelNewResourceArgs *, struct IOAccelNewResourceReturnData *, IOByteCount, uint32_t *)"
                        ,*(undefined8 *)(*(long *)(this + 0xf8) + 0xc88));
      pIVar19 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
      (**(code **)(*(long *)pIVar19 + 0x858))(pIVar19,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar19);
      _IOLockUnlock(*(undefined8 *)(pIVar19 + 0x88));
      return 0xe00002c0;
    }
    uVar5 = *param_1;
    if (0x3f < (int)uVar5) {
      if ((int)uVar5 < 0x82) {
        if (uVar5 == 0x40) goto switchD_0002cd33_caseD_0;
        if (uVar5 != 0x80) goto switchD_0002cd33_caseD_2;
LAB_0002cfa2:
        plVar14 = *(long **)(this + 0xf8);
        pIVar16 = *(IOAccelShared2 **)(this + 0x100);
        if (uVar17 == 0) {
          local_40 = IOAccelResource2::newResourceWithClientBuffer
                               (plVar14,pIVar16,(ulong)uVar5,*(long *)(param_1 + 0x16),
                                *(long *)(param_1 + 0x10),*(ulong *)(param_1 + 0x12),
                                *(undefined8 *)(param_1 + 0x14),param_2 + 1);
          lVar11 = *(long *)(this + 0xf8);
          uVar3 = *(ulonglong *)(*(long *)(lVar11 + 0x388) + 0x58);
          if (*param_1 == 0xc0) {
            IOSimpleReporter::incrementValue(uVar3,10);
            *(int *)(lVar11 + 0x1c8) = *(int *)(lVar11 + 0x1c8) + 1;
            lVar11 = *(long *)(this + 0xf8);
            uVar18 = *(undefined8 *)(param_1 + 0x14);
            IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar11 + 0x388) + 0x58),5);
            piVar1 = (int *)(lVar11 + 0x1b4);
            *piVar1 = *piVar1 + (int)uVar18;
          }
          else {
            IOSimpleReporter::incrementValue(uVar3,0xd);
            *(int *)(lVar11 + 0x1d4) = *(int *)(lVar11 + 0x1d4) + 1;
            lVar11 = *(long *)(this + 0xf8);
            uVar18 = *(undefined8 *)(param_1 + 0x16);
            IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar11 + 0x388) + 0x58),6);
            piVar1 = (int *)(lVar11 + 0x1b8);
            *piVar1 = *piVar1 + (int)uVar18;
          }
          goto LAB_0002d37e;
        }
LAB_0002d063:
        local_40 = IOAccelResource2::newResourceWithParentResourceID
                             (plVar14,pIVar16,uVar5,*(long *)(param_1 + 10),
                              *(long *)(param_1 + 0x16),*(long *)(param_1 + 0x10),
                              *(ulong *)(param_1 + 0x12),*(undefined8 *)(param_1 + 0x14),param_2 + 1
                              ,uVar17);
      }
      else {
        if (uVar5 != 0x82) {
          if (uVar5 == 0xc0) goto LAB_0002cfa2;
          goto switchD_0002cd33_caseD_2;
        }
        local_40 = IOAccelResource2::newResourceWithIOSurface
                             (*(IOGraphicsAccelerator2 **)(this + 0xf8),
                              *(IOAccelShared2 **)(this + 0x100),plVar8,param_1[0x11]);
        param_2[1] = 0;
        lVar11 = *(long *)(this + 0xf8);
        IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar11 + 0x388) + 0x58),0x10);
        piVar1 = (int *)(lVar11 + 0x1e0);
        *piVar1 = *piVar1 + 1;
      }
      goto LAB_0002d37e;
    }
    switch(uVar5) {
    case 0:
switchD_0002cd33_caseD_0:
      if (uVar17 != 0) {
        plVar14 = *(long **)(this + 0xf8);
        pIVar16 = *(IOAccelShared2 **)(this + 0x100);
        goto LAB_0002d063;
      }
      if ((*(byte *)((long)param_1 + 0x25) & 0x20) == 0) {
        lVar11 = *(long *)(param_1 + 10);
        if (lVar11 != 0) goto LAB_0002d1ab;
        uVar17 = param_1[1] | 0x10063;
        lVar11 = 0;
      }
      else {
        lVar11 = *(long *)(param_1 + 10);
LAB_0002d1ab:
        uVar17 = 99;
      }
      local_40 = IOAccelResource2::newResourceWithOptions
                           (*(IOGraphicsAccelerator2 **)(this + 0xf8),
                            *(IOAccelShared2 **)(this + 0x100),(ulong)uVar5,lVar11,
                            *(long *)(param_1 + 0x16),uVar17,*(undefined8 *)(param_1 + 0x14),
                            param_2 + 1,(long)param_1);
      if (((*(byte *)((long)param_1 + 0x26) & 1) != 0) && (local_40 != (IOAccelResource2 *)0x0)) {
        puVar15 = (undefined8 *)PTR__kernel_task_0006b100;
        if (*(long *)(this + 0x100) != 0) {
          puVar15 = (undefined8 *)(*(long *)(this + 0x100) + 0x80);
        }
        iVar7 = IOMemoryDescriptor::setOwnership
                          (*(task **)(*(long *)(local_40 + 0x80) + 0xd0),(int)*puVar15,4);
        if (iVar7 != 0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: setOwnership with no footprint failed\n");
          param_2[1] = 0;
          param_2[2] = 0;
          param_2[3] = 0;
          (**(code **)(*(long *)local_40 + 0x160))(local_40,*(undefined8 *)(this + 0x100));
          local_40 = (IOAccelResource2 *)0x0;
        }
      }
      lVar11 = *(long *)(this + 0xf8);
      uVar3 = *(ulonglong *)(*(long *)(lVar11 + 0x388) + 0x58);
      if (*param_1 == 0x40) {
        IOSimpleReporter::incrementValue(uVar3,0xb);
        *(int *)(lVar11 + 0x1cc) = *(int *)(lVar11 + 0x1cc) + 1;
        lVar11 = *(long *)(this + 0xf8);
        uVar18 = *(undefined8 *)(param_1 + 0x14);
        IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar11 + 0x388) + 0x58),7);
        piVar1 = (int *)(lVar11 + 0x1bc);
        *piVar1 = *piVar1 + (int)uVar18;
      }
      else {
        IOSimpleReporter::incrementValue(uVar3,0xc);
        *(int *)(lVar11 + 0x1d0) = *(int *)(lVar11 + 0x1d0) + 1;
        lVar11 = *(long *)(this + 0xf8);
        uVar18 = *(undefined8 *)(param_1 + 0x16);
        IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar11 + 0x388) + 0x58),8);
        piVar1 = (int *)(lVar11 + 0x1c0);
        *piVar1 = *piVar1 + (int)uVar18;
      }
      break;
    case 1:
      local_40 = IOAccelResource2::newResourceWithSurface
                           (*(long **)(this + 0xf8),*(IOAccelShared2 **)(this + 0x100),param_1[0x10]
                            ,param_1[0x11]);
      param_2[1] = 0;
      lVar11 = *(long *)(this + 0xf8);
      IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar11 + 0x388) + 0x58),0xe);
      piVar1 = (int *)(lVar11 + 0x1d8);
      *piVar1 = *piVar1 + 1;
      break;
    default:
switchD_0002cd33_caseD_2:
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Bogus resType = %d\n",
                        "IOReturn IOAccelSharedUserClient2::new_resource(IOAccelNewResourceArgs *, struct IOAccelNewResourceReturnData *, IOByteCount, uint32_t *)"
                        ,uVar5);
      param_2[2] = 0;
      param_2[3] = 0;
      param_2[1] = 0;
      goto LAB_0002d448;
    case 3:
      local_40 = IOAccelResource2::newResourceWithRemoteStorage
                           (*(long **)(this + 0xf8),*(IOAccelShared2 **)(this + 0x100),param_1[0x10]
                            ,param_1[0x11]);
      param_2[1] = 0;
      break;
    case 4:
      local_40 = IOAccelResource2::newResourceWithSurfaceBufferIndex
                           (*(long **)(this + 0xf8),*(IOAccelShared2 **)(this + 0x100),param_1[0x10]
                            ,param_1[0x11]);
      param_2[1] = 0;
      lVar11 = *(long *)(this + 0xf8);
      IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar11 + 0x388) + 0x58),0xf);
      piVar1 = (int *)(lVar11 + 0x1dc);
      *piVar1 = *piVar1 + 1;
    }
LAB_0002d37e:
    if (local_40 == (IOAccelResource2 *)0x0) {
LAB_0002d448:
      uVar18 = 0xe00002be;
    }
    else {
      cVar4 = (**(code **)(*(long *)local_40 + 0x140))(local_40,param_1,param_3);
      if (cVar4 == '\0') {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: initialize failed\n",
                          "IOReturn IOAccelSharedUserClient2::new_resource(IOAccelNewResourceArgs *, struct IOAccelNewResourceReturnData *, IOByteCount, uint32_t *)"
                         );
      }
      else {
        cVar4 = (**(code **)(*(long *)local_40 + 0x120))(local_40,*(undefined8 *)(this + 0x100));
        if (cVar4 == '\0') {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: allocMemory failed\n",
                            "IOReturn IOAccelSharedUserClient2::new_resource(IOAccelNewResourceArgs *, struct IOAccelNewResourceReturnData *, IOByteCount, uint32_t *)"
                           );
        }
        else {
          lVar11 = IOAccelResource2::getResidentSize(local_40);
          param_2[5] = lVar11;
          if (((((param_1[9] & 0x40) != 0) && (*(long *)(local_40 + 0x88) == 0)) &&
              (*(long *)(local_40 + 0x80) != 0)) && (((byte)local_40[0xe] & 8) != 0)) {
            if (*(long *)(local_40 + 0x60) == 0) {
              plVar14 = (long *)IOMemoryDescriptor::createMappingInTask
                                          (*(task **)(*(long *)(local_40 + 0x80) + 0xd0),
                                           *(ulonglong *)PTR__kernel_task_0006b100,0,1,0);
              if (plVar14 != (long *)0x0) {
                lVar11 = (**(code **)(*plVar14 + 0x118))(plVar14);
                if (lVar11 != 0) {
                  ___bzero(lVar11,*(undefined8 *)(local_40 + 0xd0));
                }
                (**(code **)(*plVar14 + 0x28))(plVar14);
              }
            }
            else {
              *(byte *)(param_2 + 4) = *(byte *)(param_2 + 4) | 1;
            }
          }
          if ((*(long *)(param_1 + 0xc) == 0) || (*(long *)(param_1 + 0xe) == 0)) {
            if (((byte)local_40[0x108] & 4) == 0) goto LAB_0002d649;
            uVar12 = IOAccelResource2::map(local_40);
            if ((char)uVar12 != '\0') {
              lVar11 = IOAccelResource2::getGPUVirtualAddressForUserProcess(local_40);
              *param_2 = lVar11;
              lVar11 = (**(code **)(**(long **)(local_40 + 0x40) + 0x188))();
              IVar2 = local_40[0x14];
              goto joined_r0x0002d56f;
            }
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to create mapping.\n"
                              ,
                              "IOReturn IOAccelSharedUserClient2::new_resource(IOAccelNewResourceArgs *, struct IOAccelNewResourceReturnData *, IOByteCount, uint32_t *)"
                             );
          }
          else {
            uVar12 = IOAccelResource2::mapAtAddressLength
                               (local_40,*(long *)(param_1 + 0xc),*(long *)(param_1 + 0xe));
            if ((char)uVar12 != '\0') {
              lVar11 = IOAccelResource2::getGPUVirtualAddressForUserProcess(local_40);
              *param_2 = lVar11;
              lVar11 = (**(code **)(**(long **)(local_40 + 0x40) + 0x188))();
              IVar2 = local_40[0x14];
joined_r0x0002d56f:
              if (IVar2 == (IOAccelResource2)0x0) {
LAB_0002d589:
                uVar12 = *(ulong *)(local_40 + 0xf8);
              }
              else if (IVar2 == (IOAccelResource2)0x82) {
                uVar12 = (ulong)*(uint *)(local_40 + 0xfc);
              }
              else {
                if (IVar2 == (IOAccelResource2)0x80) goto LAB_0002d589;
                uVar12 = 0;
              }
              param_2[10] = lVar11 - uVar12;
LAB_0002d649:
              IOAccelResource2::getClientSharedAddresses(local_40,param_2 + 2,param_2 + 3);
              lVar11 = *(long *)(this + 0xf8);
              if (*(int *)(lVar11 + 0xce8) != 0) {
                (**(code **)(*(long *)local_40 + 0x158))(local_40,param_2 + 0xb);
                lVar11 = *(long *)(this + 0xf8);
              }
              IOSimpleReporter::incrementValue
                        (*(ulonglong *)(*(long *)(lVar11 + 0x388) + 0x58),0x4b);
              *(int *)(lVar11 + 0x2cc) = *(int *)(lVar11 + 0x2cc) + 1;
              lVar11 = IOAccelResource2::getProtectionOptions(local_40);
              param_2[9] = lVar11;
              param_2[6] = *(long *)(local_40 + 0x110);
              pIVar13 = IOAccelResource2::getStorageResource(local_40);
              if (pIVar13 == (IOAccelResource2 *)0x0) {
                param_2[7] = 0;
LAB_0002d70f:
                param_2[8] = 0;
              }
              else {
                if (*(long *)(pIVar13 + 0x80) == 0) {
                  lVar11 = 0;
                }
                else {
                  lVar11 = *(long *)(*(long *)(pIVar13 + 0x80) + 0x48);
                }
                param_2[7] = lVar11;
                if (*(long *)(pIVar13 + 0x88) == 0) goto LAB_0002d70f;
                param_2[8] = *(long *)(*(long *)(pIVar13 + 0x88) + 0x48);
              }
              uVar18 = 0;
              goto LAB_0002d4d8;
            }
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                              "%s: failed to create mapping at address 0x%llx with length 0x%llx.\n"
                              ,
                              "IOReturn IOAccelSharedUserClient2::new_resource(IOAccelNewResourceArgs *, struct IOAccelNewResourceReturnData *, IOByteCount, uint32_t *)"
                              ,*(undefined8 *)(param_1 + 0xc),*(undefined8 *)(param_1 + 0xe));
          }
        }
      }
      (**(code **)(*(long *)local_40 + 0x160))(local_40,*(undefined8 *)(this + 0x100));
      param_2[1] = 0;
      param_2[2] = 0;
      param_2[3] = 0;
      param_2[7] = 0;
      param_2[8] = 0;
      uVar18 = 0xe00002bc;
    }
LAB_0002d4d8:
    pIVar19 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
    (**(code **)(*(long *)pIVar19 + 0x858))(pIVar19,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar19);
    _IOLockUnlock(*(undefined8 *)(pIVar19 + 0x88));
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s suballocation flag is set without parent resource id\n",
                      "IOReturn IOAccelSharedUserClient2::new_resource(IOAccelNewResourceArgs *, struct IOAccelNewResourceReturnData *, IOByteCount, uint32_t *)"
                     );
  }
  if (plVar8 == (long *)0x0) {
    return uVar18;
  }
LAB_0002d50d:
  (**(code **)(*plVar8 + 0x28))(plVar8);
  return uVar18;
}



// IOAccelSharedUserClient2::delete_resource(unsigned int)

undefined8 __thiscall
IOAccelSharedUserClient2::delete_resource(IOAccelSharedUserClient2 *this,uint param_1)

{
  int *piVar1;
  IOGraphicsAccelerator2 *pIVar2;
  long lVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  long *local_38;
  
  local_38 = (long *)&DAT_aaaaaaaaaaaaaaaa;
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar2 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar2 + 0x88));
  _OSDecrementAtomic(pIVar2 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar2);
  (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
  uVar4 = IOAccelNamespace::lookupId
                    (*(IOAccelNamespace **)(*(long *)(this + 0x100) + 0x20),param_1,
                     (long *)&local_38);
  uVar5 = 0xe00002c2;
  if ((char)uVar4 != '\0') {
    if (*(char *)((long)local_38 + 0x14) != '\n') {
      (**(code **)(*local_38 + 0x160))(local_38,*(undefined8 *)(this + 0x100));
    }
    lVar3 = *(long *)(this + 0xf8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar3 + 0x388) + 0x58),0x4c);
    piVar1 = (int *)(lVar3 + 0x2d0);
    *piVar1 = *piVar1 + 1;
    uVar5 = 0;
  }
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar2);
  _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
  return uVar5;
}



// IOAccelSharedUserClient2::page_off_resource(IOAccelSharedPageoffResourceArgs*)

undefined8 __thiscall
IOAccelSharedUserClient2::page_off_resource(IOAccelSharedUserClient2 *this,uint *param_1)

{
  byte bVar1;
  IOGraphicsAccelerator2 *pIVar2;
  long *plVar3;
  undefined8 uVar4;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  long *local_38;
  
  local_38 = (long *)&DAT_aaaaaaaaaaaaaaaa;
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar2 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar2 + 0x88));
  _OSDecrementAtomic(pIVar2 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar2);
  uVar4 = 0;
  (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  if (((byte)pIVar2[0xc78] & 2) == 0) {
    (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar2);
    _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
  }
  else {
    uVar4 = IOAccelNamespace::lookupId
                      (*(IOAccelNamespace **)(*(long *)(this + 0x100) + 0x20),*param_1,
                       (long *)&local_38);
    if ((char)uVar4 != '\0') {
      bVar1 = *(byte *)((long)local_38 + 0x14);
      if ((((4 < bVar1) || ((0x13U >> (bVar1 & 0x1f) & 1) == 0)) && (bVar1 != 0x82)) &&
         (bVar1 != 0x80)) {
        (**(code **)(*local_38 + 0x260))
                  (local_38,1 << ((byte)(param_1[1] >> 0x10) & 0x1f),1 << ((byte)param_1[1] & 0x1f))
        ;
        local_40 = &DAT_aaaaaaaaaaaaaaaa;
        local_48 = &DAT_aaaaaaaaaaaaaaaa;
        local_50 = &DAT_aaaaaaaaaaaaaaaa;
        local_58 = &DAT_aaaaaaaaaaaaaaaa;
        local_60 = &DAT_aaaaaaaaaaaaaaaa;
        local_68 = &DAT_aaaaaaaaaaaaaaaa;
        local_70 = &DAT_aaaaaaaaaaaaaaaa;
        local_78 = &DAT_aaaaaaaaaaaaaaaa;
        (**(code **)(**(long **)(*(long *)(this + 0xf8) + 0x380) + 0x140))
                  (*(long **)(*(long *)(this + 0xf8) + 0x380),&local_78);
        plVar3 = *(long **)(*(long *)(this + 0xf8) + 0x380);
        uVar4 = (**(code **)(*local_38 + 0x270))();
        (**(code **)(*plVar3 + 0x1b0))(plVar3,uVar4,&local_78);
        pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
        (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
        IOGraphicsAccelerator2::unlock_busy(pIVar2);
        _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
        (**(code **)(**(long **)(*(long *)(this + 0xf8) + 0x380) + 0x178))
                  (*(long **)(*(long *)(this + 0xf8) + 0x380),&local_78);
        return 0;
      }
    }
    pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
    (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar2);
    _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
    uVar4 = 0xe00002c2;
  }
  return uVar4;
}



// IOAccelSharedUserClient2::finish_object_event(unsigned int, unsigned int)

undefined8 __thiscall
IOAccelSharedUserClient2::finish_object_event
          (IOAccelSharedUserClient2 *this,uint param_1,uint param_2)

{
  int *piVar1;
  long *plVar2;
  long lVar3;
  int iVar4;
  undefined8 uVar5;
  IOGraphicsAccelerator2 *pIVar6;
  undefined8 uVar7;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_58 = &DAT_aaaaaaaaaaaaaaaa;
  local_60 = &DAT_aaaaaaaaaaaaaaaa;
  local_68 = &DAT_aaaaaaaaaaaaaaaa;
  local_70 = &DAT_aaaaaaaaaaaaaaaa;
  local_78 = &DAT_aaaaaaaaaaaaaaaa;
  uVar7 = 0xe00002c2;
  if (param_2 < 4) {
    pIVar6 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
    _OSIncrementAtomic(pIVar6 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar6 + 0x88));
    _OSDecrementAtomic(pIVar6 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar6);
    uVar7 = 0;
    (**(code **)(*(long *)pIVar6 + 0x850))(pIVar6,"",0);
    uVar5 = IOAccelNamespace::lookupId
                      (*(IOAccelNamespace **)(*(long *)(this + 0x100) + 0x20),param_1,
                       (long *)&local_38);
    pIVar6 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
    if ((char)uVar5 == '\0') {
      uVar7 = 0xe00002c2;
    }
    else {
      plVar2 = *(long **)(pIVar6 + 0x380);
      (**(code **)(*plVar2 + 0x140))(plVar2,&local_78);
      (**(code **)(*plVar2 + 0x1b0))
                (plVar2,(ulong)param_2 * 0x40 + *(long *)(local_38 + 0x38),&local_78);
      pIVar6 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
      (**(code **)(*(long *)pIVar6 + 0x858))(pIVar6,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar6);
      _IOLockUnlock(*(undefined8 *)(pIVar6 + 0x88));
      iVar4 = (**(code **)(*plVar2 + 0x178))(plVar2,&local_78);
      pIVar6 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
      _OSIncrementAtomic(pIVar6 + 0x90);
      _IOLockLock(*(undefined8 *)(pIVar6 + 0x88));
      _OSDecrementAtomic(pIVar6 + 0x90);
      IOGraphicsAccelerator2::lock_busy(pIVar6);
      (**(code **)(*(long *)pIVar6 + 0x850))(pIVar6,"",0);
      lVar3 = *(long *)(this + 0xf8);
      IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar3 + 0x388) + 0x58),0x2d);
      piVar1 = (int *)(lVar3 + 0x254);
      *piVar1 = *piVar1 + iVar4;
      pIVar6 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
    }
    (**(code **)(*(long *)pIVar6 + 0x858))(pIVar6,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar6);
    _IOLockUnlock(*(undefined8 *)(pIVar6 + 0x88));
  }
  return uVar7;
}



// IOAccelSharedUserClient2::set_resource_purgeable(unsigned int, eIOAccelResourcePurgeable,
// eIOAccelResourcePurgeable*)

undefined8 __thiscall
IOAccelSharedUserClient2::set_resource_purgeable
          (IOAccelSharedUserClient2 *this,uint param_1,int param_2,uint *param_3)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined8 uVar2;
  IOAccelResource2 *this_00;
  uint uVar3;
  undefined8 uVar4;
  int iVar5;
  IOAccelResource2 *local_40;
  uint local_34;
  
  uVar4 = 0xe00002c2;
  if (0xfffffffb < param_2 - 5U) {
    local_34 = 0xaaaaaaaa;
    iVar5 = 1;
    if (param_2 - 2U < 3) {
      iVar5 = param_2;
    }
    local_40 = (IOAccelResource2 *)&DAT_aaaaaaaaaaaaaaaa;
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    uVar2 = IOAccelNamespace::lookupId
                      (*(IOAccelNamespace **)(*(long *)(this + 0x100) + 0x20),param_1,
                       (long *)&local_40);
    uVar4 = 0xe00002c2;
    if ((char)uVar2 != '\0') {
      this_00 = IOAccelResource2::getStorageResource(local_40);
      if (this_00 == (IOAccelResource2 *)0x0) {
        uVar4 = 0xe0000001;
      }
      else {
        if (((byte)this_00[0x14] & 0x7f) == 0) {
          (**(code **)(**(long **)(*(long *)(this_00 + 0x80) + 0xd0) + 0x120))
                    (*(long **)(*(long *)(this_00 + 0x80) + 0xd0),iVar5,&local_34);
        }
        else {
          IOAccelResource2::setPurgeable(this_00,iVar5,iVar5,&local_34);
        }
        uVar3 = 1;
        if (local_34 - 2 < 3) {
          uVar3 = local_34;
        }
        *param_3 = uVar3;
        uVar4 = 0;
      }
    }
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  }
  return uVar4;
}



// IOAccelSharedUserClient2::get_surface_info(unsigned int, unsigned int*, unsigned int*, unsigned
// int*, unsigned int*, unsigned int*)

ulong __thiscall
IOAccelSharedUserClient2::get_surface_info
          (IOAccelSharedUserClient2 *this,int param_1,uint *param_2,int *param_3,int *param_4,
          undefined4 *param_5,undefined4 *param_6)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined *puVar2;
  long lVar3;
  uint uVar4;
  undefined4 uVar5;
  uint uVar6;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  uVar5 = 0;
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (param_1 != 0) {
    lVar3 = IOAccelSurfaceList::findSurfaceForID
                      ((IOAccelSurfaceList *)(*(long *)(this + 0xf8) + 0xaa8),param_1);
    if (lVar3 != 0) {
      uVar6 = *(uint *)((long)&DAT_000011b0 + lVar3);
      *param_2 = uVar6;
      uVar4 = 0x200;
      if (((*(uint *)((long)&DAT_00001190 + lVar3) & 0x80) != 0) ||
         (uVar4 = 0x100, (*(uint *)((long)&DAT_00001190 + lVar3) & 0x40) != 0)) {
        *param_2 = uVar4 | uVar6;
      }
      if ((*(short *)(&DAT_000011b8 + lVar3) == *(short *)(&DAT_000011bc + lVar3)) &&
         (*(short *)(&DAT_000011ba + lVar3) == *(short *)(&DAT_000011be + lVar3))) {
        puVar2 = &DAT_000011be;
        *param_3 = (int)*(short *)(&DAT_000011bc + lVar3);
      }
      else {
        *param_3 = (int)*(short *)(&DAT_000011b8 + lVar3);
        puVar2 = &DAT_000011ba;
      }
      *param_4 = (int)*(short *)(puVar2 + lVar3);
      lVar3 = *(long *)(&DAT_000011c0 + lVar3);
      if (lVar3 == 0) {
        *param_5 = 0;
        uVar5 = 0;
      }
      else {
        *param_5 = *(undefined4 *)(lVar3 + 0xb8);
        uVar5 = *(undefined4 *)(lVar3 + 200);
      }
      uVar6 = 0;
      goto LAB_0002dfc3;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Invalid surface ID = %u\n",
                      "IOReturn IOAccelSharedUserClient2::get_surface_info(uint32_t, uint32_t *, uint32_t *, uint32_t *, uint32_t *, uint32_t *)"
                      ,param_1);
  }
  *param_2 = 0;
  *param_3 = 0;
  *param_4 = 0;
  *param_5 = 0;
  uVar6 = 0xe00002c2;
LAB_0002dfc3:
  *param_6 = uVar5;
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return (ulong)uVar6;
}



// IOAccelSharedUserClient2::get_resource_info(unsigned int, IOAccelGetResourceInfoReturnData*,
// unsigned int*)

undefined4 __thiscall
IOAccelSharedUserClient2::get_resource_info
          (IOAccelSharedUserClient2 *this,uint param_1,undefined8 param_2,uint *param_3)

{
  IOGraphicsAccelerator2 *pIVar1;
  char cVar2;
  undefined8 uVar3;
  undefined4 uVar4;
  long *local_38;
  
  local_38 = (long *)&DAT_aaaaaaaaaaaaaaaa;
  uVar4 = 0xe00002c2;
  if (0x2f < *param_3) {
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    uVar3 = IOAccelNamespace::lookupId
                      (*(IOAccelNamespace **)(*(long *)(this + 0x100) + 0x20),param_1,
                       (long *)&local_38);
    uVar4 = 0xe00002c2;
    if ((char)uVar3 != '\0') {
      cVar2 = (**(code **)(*local_38 + 0x1a8))(local_38,param_2,param_3);
      uVar4 = 0xe00002c9;
      if (cVar2 != '\0') {
        uVar4 = 0;
      }
    }
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  }
  return uVar4;
}



// IOAccelSharedUserClient2::create_shmem(unsigned int, IOAccelDeviceShmemData*)

ulong __thiscall
IOAccelSharedUserClient2::create_shmem
          (IOAccelSharedUserClient2 *this,uint param_1,undefined8 *param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  uVar2 = IOAccelShared2::create_shmem
                    (*(IOAccelShared2 **)(this + 0x100),param_1,param_2,(undefined4 *)(param_2 + 1),
                     (undefined4 *)((long)param_2 + 0xc));
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2 & 0xffffffff;
}



// IOAccelSharedUserClient2::destroy_shmem(unsigned int)

ulong __thiscall
IOAccelSharedUserClient2::destroy_shmem(IOAccelSharedUserClient2 *this,uint param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  uVar2 = IOAccelShared2::destroy_shmem(*(IOAccelShared2 **)(this + 0x100),param_1);
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2 & 0xffffffff;
}



// IOAccelSharedUserClient2::get_shared_info(IOAccelSharedGetInfoReturnData*)

undefined8 __thiscall
IOAccelSharedUserClient2::get_shared_info(IOAccelSharedUserClient2 *this,undefined8 *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  long lVar2;
  undefined8 uVar3;
  undefined1 *local_30;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  uVar3 = 0;
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (param_1 == (undefined8 *)0x0) {
    uVar3 = 0xe00002c2;
  }
  else {
    lVar2 = *(long *)(this + 0x100);
    *param_1 = *(undefined8 *)(lVar2 + 0x30);
    local_30 = &DAT_aaaaaaaaaaaaaaaa;
    IOAccelClientSharedMachine::getClientSharedAddressForId
              ((IOAccelClientSharedMachine *)(*(long *)(lVar2 + 0x20) + 0x50),0,(long *)&local_30);
    param_1[1] = local_30 + 8;
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  }
  return uVar3;
}



// IOAccelSharedUserClient2::setup_dirty_ring(IOAccelSharedSetupDirtyRingReturnData*)

ulong __thiscall
IOAccelSharedUserClient2::setup_dirty_ring(IOAccelSharedUserClient2 *this,long *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  uVar2 = IOAccelShared2::getDirtyRingAddresses
                    (*(IOAccelShared2 **)(this + 0x100),param_1,param_1 + 1,param_1 + 2);
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2 & 0xffffffff;
}



// IOAccelSharedUserClient2::process_dirty_commands()

undefined8 __thiscall
IOAccelSharedUserClient2::process_dirty_commands(IOAccelSharedUserClient2 *this)

{
  IOGraphicsAccelerator2 *pIVar1;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  IOAccelShared2::processResourceDirtyCommands(*(IOAccelShared2 **)(this + 0x100));
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return 0;
}



// IOAccelSharedUserClient2::allocate_fence_memory(unsigned long long*, unsigned long long*)

ulong __thiscall
IOAccelSharedUserClient2::allocate_fence_memory
          (IOAccelSharedUserClient2 *this,ulong *param_1,ulong *param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  uVar2 = IOAccelShared2::allocate_fence_memory(*(IOAccelShared2 **)(this + 0x100),*param_1,param_2)
  ;
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2 & 0xffffffff;
}



// IOAccelSharedUserClient2::create_mtlevent(unsigned long long*, IOAccelCreateMTLEventResult*)

ulong __thiscall
IOAccelSharedUserClient2::create_mtlevent
          (IOAccelSharedUserClient2 *this,undefined8 *param_1,ulong *param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  uVar2 = IOAccelShared2::create_mtlevent(*(IOAccelShared2 **)(this + 0x100),*param_1,param_2);
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2 & 0xffffffff;
}



// IOAccelSharedUserClient2::destroy_mtlevent(unsigned int)

ulong __thiscall
IOAccelSharedUserClient2::destroy_mtlevent(IOAccelSharedUserClient2 *this,uint param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  uVar2 = IOAccelShared2::destroy_mtlevent(*(IOAccelShared2 **)(this + 0x100),param_1);
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2 & 0xffffffff;
}



// IOAccelSharedUserClient2::get_memory_data(IOAccelMemoryData*)

undefined8 __thiscall
IOAccelSharedUserClient2::get_memory_data(IOAccelSharedUserClient2 *this,long *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  IOAccelShared2::getMemoryData(*(IOAccelShared2 **)(this + 0x100),param_1);
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return 0;
}



// IOAccelSharedUserClient2::disconnect_peer(unsigned int)

ulong __thiscall
IOAccelSharedUserClient2::disconnect_peer(IOAccelSharedUserClient2 *this,uint param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  uVar2 = IOAccelShared2::disconnectPeer(*(IOAccelShared2 **)(this + 0x100),param_1);
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2 & 0xffffffff;
}



// IOAccelSharedUserClient2::set_resources_purgeable(unsigned int const*, eIOAccelResourcePurgeable,
// eIOAccelResourcePurgeable*, int)

undefined8 IOAccelSharedUserClient2::set_resources_purgeable(void)

{
  return 0xe00002c7;
}



// IOAccelSharedUserClient2::get_resource_offset(unsigned long long*, unsigned long long*)

undefined4 __thiscall
IOAccelSharedUserClient2::get_resource_offset
          (IOAccelSharedUserClient2 *this,undefined8 *param_1,undefined8 *param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined8 uVar2;
  undefined4 uVar3;
  IOAccelResource2 *local_38;
  
  local_38 = (IOAccelResource2 *)&DAT_aaaaaaaaaaaaaaaa;
  uVar2 = *param_1;
  *param_2 = 0;
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  uVar3 = 0xe00002e2;
  if ((*(byte *)(*(long *)(this + 0xf8) + 0xc9c) & 0x10) != 0) {
    uVar2 = IOAccelNamespace::lookupId
                      (*(IOAccelNamespace **)(*(long *)(this + 0x100) + 0x20),(uint)uVar2,
                       (long *)&local_38);
    uVar3 = 0xe00002c2;
    if ((char)uVar2 != '\0') {
      uVar2 = IOAccelResource2::getPhysicalOffset(local_38,param_1[1],param_2);
      uVar3 = 0xe00002bd;
      if ((char)uVar2 != '\0') {
        uVar3 = 0;
      }
    }
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar3;
}



// IOAccelSharedUserClient2::get_allocated_size(IOAccelAllocatedSize*)

undefined8 __thiscall
IOAccelSharedUserClient2::get_allocated_size(IOAccelSharedUserClient2 *this,undefined8 *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  *param_1 = **(undefined8 **)(*(long *)(this + 0x100) + 0xe0);
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return 0;
}



// IOAccelSharedUserClient2::set_resource_owner_identity(IOAccelResourceSetResourceOwnerIdentityData*)

ulong __thiscall
IOAccelSharedUserClient2::set_resource_owner_identity(IOAccelSharedUserClient2 *this,uint *param_1)

{
  uint uVar1;
  uint uVar2;
  IOGraphicsAccelerator2 *pIVar3;
  ulong uVar4;
  
  uVar1 = *param_1;
  uVar2 = param_1[2];
  pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  _OSIncrementAtomic(pIVar3 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar3 + 0x88));
  _OSDecrementAtomic(pIVar3 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar3);
  (**(code **)(*(long *)pIVar3 + 0x850))(pIVar3,"",0);
  uVar4 = IOAccelShared2::setResourceOwnerIdentity(*(IOAccelShared2 **)(this + 0x100),uVar1,uVar2);
  pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)pIVar3 + 0x858))(pIVar3,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar3);
  _IOLockUnlock(*(undefined8 *)(pIVar3 + 0x88));
  return uVar4 & 0xffffffff;
}



// IOAccelSharedUserClient2::sharedStart()

bool __thiscall IOAccelSharedUserClient2::sharedStart(IOAccelSharedUserClient2 *this)

{
  long lVar1;
  
  *(undefined8 *)(this + 0x100) = 0;
  lVar1 = (**(code **)(**(long **)(this + 0xf8) + 0x8b0))
                    (*(long **)(this + 0xf8),*(undefined8 *)(this + 0xe0));
  *(long *)(this + 0x100) = lVar1;
  if (lVar1 != 0) {
    *(IOAccelSharedUserClient2 **)(lVar1 + 0x110) = this;
    IOAccelSharedUserClientList::addSharedUserClient
              ((IOAccelSharedUserClientList *)(*(long *)(this + 0xf8) + 0xa98),(long)this);
  }
  return lVar1 != 0;
}



// IOAccelSharedUserClient2::sharedStop()

void __thiscall IOAccelSharedUserClient2::sharedStop(IOAccelSharedUserClient2 *this)

{
  long *plVar1;
  
  plVar1 = *(long **)(this + 0x100);
  if (plVar1 != (long *)0x0) {
    plVar1[0x22] = 0;
    (**(code **)(*plVar1 + 0x28))();
    *(undefined8 *)(this + 0x100) = 0;
  }
  IOAccelSharedUserClientList::removeSharedUserClient
            ((IOAccelSharedUserClientList *)(*(long *)(this + 0xf8) + 0xa98),(long)this);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSharedUserClient2::s_new_resource(IOAccelSharedUserClient2*, void*,
// IOExternalMethodArguments*)

ulong __cdecl
IOAccelSharedUserClient2::s_new_resource
          (IOAccelSharedUserClient2 *param_1,undefined8 param_2,long param_3)

{
  long *plVar1;
  long *plVar2;
  uint *puVar3;
  ulong uVar4;
  ulong uVar5;
  
  plVar1 = *(long **)(param_3 + 0x58);
  plVar2 = *(long **)(param_3 + 0x40);
  if (plVar2 == (long *)0x0) {
    uVar4 = (ulong)*(uint *)(param_3 + 0x38);
    puVar3 = *(uint **)(param_3 + 0x30);
    plVar2 = (long *)0x0;
  }
  else {
    plVar2 = (long *)(**(code **)(*plVar2 + 0x200))(plVar2,0x1000);
    if (plVar2 == (long *)0x0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s failed to map arguments\n",
                        "static IOReturn IOAccelSharedUserClient2::s_new_resource(IOAccelSharedUserClient2 *, void *, IOExternalMethodArguments *)"
                       );
      return 0xe00002c8;
    }
    puVar3 = (uint *)(**(code **)(*plVar2 + 0x118))(plVar2);
    uVar4 = (**(code **)(**(long **)(param_3 + 0x40) + 0x1c8))();
  }
  uVar5 = 0xe00002c2;
  if (((puVar3 != (uint *)0x0) && (0x67 < uVar4)) && (plVar1 != (long *)0x0)) {
    uVar5 = new_resource(param_1,puVar3,plVar1,uVar4,(uint *)(param_3 + 0x60));
    uVar5 = uVar5 & 0xffffffff;
  }
  if (plVar2 != (long *)0x0) {
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  if ((int)uVar5 == 0) {
    uVar5 = 0;
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s failed to create resource\n",
                      "static IOReturn IOAccelSharedUserClient2::s_new_resource(IOAccelSharedUserClient2 *, void *, IOExternalMethodArguments *)"
                     );
  }
  return uVar5;
}



// IOAccelSharedUserClient2::detach_shared()

void __thiscall IOAccelSharedUserClient2::detach_shared(IOAccelSharedUserClient2 *this)

{
  long *plVar1;
  OSSet *pOVar2;
  undefined8 uVar3;
  OSDictionary *pOVar4;
  long lVar5;
  
  pOVar2 = (OSSet *)OSSet::withCapacity(1);
  (**(code **)(**(long **)(this + 0x100) + 0x130))();
  plVar1 = *(long **)(this + 0x150);
  if (plVar1 == (long *)0x0) {
    uVar3 = OSSet::withSet(pOVar2,0);
    *(undefined8 *)(this + 0x150) = uVar3;
  }
  else {
    (**(code **)(*plVar1 + 0x1d0))(plVar1,pOVar2);
  }
  (**(code **)(*(long *)pOVar2 + 0x28))(pOVar2);
  (**(code **)(*(long *)this + 0x20))(this);
  (**(code **)(*(long *)this + 0x998))(this);
  *(undefined4 *)(this + 0x108) = 0;
  (**(code **)(*(long *)this + 0x678))(this);
  *(undefined8 *)(this + 0xf8) = 0;
  (**(code **)(*(long *)this + 0x28))(this);
  pOVar4 = (OSDictionary *)IOService::nameMatching("IOResources",(OSDictionary *)0x0);
  lVar5 = IOService::copyMatchingService(pOVar4);
  (**(code **)(*(long *)pOVar4 + 0x28))(pOVar4);
  if (lVar5 != 0) {
    (**(code **)(*(long *)this + 0x670))(this,lVar5);
  }
                    // WARNING: Could not recover jumptable at 0x0002ed42. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x28))(this);
  return;
}



// IOAccelSharedUserClient2::externalMethod(unsigned int, IOExternalMethodArguments*,
// IOExternalMethodDispatch*, OSObject*, void*)

undefined4 __thiscall
IOAccelSharedUserClient2::externalMethod
          (IOAccelSharedUserClient2 *this,int param_1,undefined8 param_2,undefined **param_3,
          IOAccelSharedUserClient2 *param_4,undefined8 param_5)

{
  IOAccelSharedUserClient2 IVar1;
  IOAccelSharedUserClient2 IVar2;
  IOGraphicsAccelerator2 *this_00;
  undefined4 uVar3;
  int iVar4;
  
  if (param_1 == 0) {
    param_3 = &externalMethod(unsigned_int,IOExternalMethodArguments*,IOExternalMethodDispatch*,OSObject*,void*)
               ::methods;
    param_4 = this;
  }
  else if (param_1 == 0x11) {
    param_3 = &PTR_s_set_resources_purgeable_00079238;
    param_4 = this;
  }
  _OSIncrementAtomic(this + 0x160);
  uVar3 = 0xe00002d7;
  if (this[0x10d] == (IOAccelSharedUserClient2)0x0) {
    uVar3 = (**(code **)(PTR_vtable_0006b088 + 0x860))(this,param_1,param_2,param_3,param_4,param_5)
    ;
  }
  iVar4 = _OSDecrementAtomic(this + 0x160);
  if (iVar4 != 1) {
    return uVar3;
  }
  if (this[0x10d] == (IOAccelSharedUserClient2)0x0) {
    return uVar3;
  }
  _IOLockLock(*(undefined8 *)(this + 0x158));
  IVar1 = this[0x10e];
  if (IVar1 != (IOAccelSharedUserClient2)0x0) {
    this[0x10e] = (IOAccelSharedUserClient2)0x0;
  }
  IVar2 = this[0x164];
  if (IVar2 == (IOAccelSharedUserClient2)0x0) {
    _IOLockUnlock(*(undefined8 *)(this + 0x158));
    if (IVar1 == (IOAccelSharedUserClient2)0x0) {
      return uVar3;
    }
  }
  else {
    this[0x164] = (IOAccelSharedUserClient2)0x0;
    _IOLockUnlock(*(undefined8 *)(this + 0x158));
    if (IVar1 == (IOAccelSharedUserClient2)0x0) goto LAB_0002eed4;
  }
  this_00 = *(IOGraphicsAccelerator2 **)(this + 0xf8);
  (**(code **)(*(long *)this_00 + 0x20))(this_00);
  _OSIncrementAtomic(this_00 + 0x90);
  _IOLockLock(*(undefined8 *)(this_00 + 0x88));
  _OSDecrementAtomic(this_00 + 0x90);
  IOGraphicsAccelerator2::lock_busy(this_00);
  (**(code **)(*(long *)this_00 + 0x850))(this_00,"",0);
  detach_shared(this);
  (**(code **)(*(long *)this_00 + 0x858))(this_00,"",0);
  IOGraphicsAccelerator2::unlock_busy(this_00);
  _IOLockUnlock(*(undefined8 *)(this_00 + 0x88));
  (**(code **)(*(long *)this_00 + 0x28))(this_00);
  if (IVar2 == (IOAccelSharedUserClient2)0x0) {
    return uVar3;
  }
LAB_0002eed4:
  (**(code **)(*(long *)this + 0x600))(this,0);
  return uVar3;
}



// IOAccelSharedUserClient2::s_set_resources_purgeable(IOAccelSharedUserClient2*, void*,
// IOExternalMethodArguments*)

undefined8 IOAccelSharedUserClient2::s_set_resources_purgeable(void)

{
  return 0xe00002c7;
}



// IOAccelSharedUserClient2::getTargetAndMethodForIndex(IOService**, unsigned int)

undefined ** __thiscall
IOAccelSharedUserClient2::getTargetAndMethodForIndex
          (IOAccelSharedUserClient2 *this,undefined8 *param_1,uint param_2)

{
  undefined **ppuVar1;
  
  *param_1 = this;
  ppuVar1 = (undefined **)0x0;
  if (param_2 < 0x15) {
    ppuVar1 = &sSharedMethods + (ulong)param_2 * 6;
  }
  return ppuVar1;
}



// IOAccelResource2::getGPUVirtualAddressForUserProcess() const

long __thiscall IOAccelResource2::getGPUVirtualAddressForUserProcess(IOAccelResource2 *this)

{
  IOAccelResource2 IVar1;
  long lVar2;
  ulong uVar3;
  
  lVar2 = (**(code **)(**(long **)(this + 0x40) + 0x130))();
  IVar1 = this[0x14];
  if (IVar1 != (IOAccelResource2)0x0) {
    if (IVar1 == (IOAccelResource2)0x82) {
      uVar3 = (ulong)*(uint *)(this + 0xfc);
      goto LAB_0002ef67;
    }
    if (IVar1 != (IOAccelResource2)0x80) {
      uVar3 = 0;
      goto LAB_0002ef67;
    }
  }
  uVar3 = *(ulong *)(this + 0xf8);
LAB_0002ef67:
  return uVar3 + lVar2;
}



// IOAccelSharedUserClient2::_RESERVEDIOAccelSharedUserClient0()

void IOAccelSharedUserClient2::_RESERVEDIOAccelSharedUserClient0(void)

{
  OSMetaClass::reservedCalled(0x824a8);
  return;
}



// IOAccelSharedUserClient2::_RESERVEDIOAccelSharedUserClient1()

void IOAccelSharedUserClient2::_RESERVEDIOAccelSharedUserClient1(void)

{
  OSMetaClass::reservedCalled(0x824a8);
  return;
}



// IOAccelSharedUserClient2::_RESERVEDIOAccelSharedUserClient2()

void IOAccelSharedUserClient2::_RESERVEDIOAccelSharedUserClient2(void)

{
  OSMetaClass::reservedCalled(0x824a8);
  return;
}



// IOAccelSharedUserClient2::_RESERVEDIOAccelSharedUserClient3()

void IOAccelSharedUserClient2::_RESERVEDIOAccelSharedUserClient3(void)

{
  OSMetaClass::reservedCalled(0x824a8);
  return;
}



// IOAccelSharedUserClient2::_RESERVEDIOAccelSharedUserClient4()

void IOAccelSharedUserClient2::_RESERVEDIOAccelSharedUserClient4(void)

{
  OSMetaClass::reservedCalled(0x824a8);
  return;
}



// IOAccelSharedUserClient2::_RESERVEDIOAccelSharedUserClient5()

void IOAccelSharedUserClient2::_RESERVEDIOAccelSharedUserClient5(void)

{
  OSMetaClass::reservedCalled(0x824a8);
  return;
}



// IOAccelSharedNamespace2::MetaClass::~MetaClass()

void __thiscall IOAccelSharedNamespace2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelShared2::MetaClass::~MetaClass()

void __thiscall IOAccelShared2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelSharedUserClient2::MetaClass::~MetaClass()

void __thiscall IOAccelSharedUserClient2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelShared_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelSharedNamespace2::gMetaClass,"IOAccelSharedNamespace2",
             (OSMetaClass *)&IOAccelNamespace::gMetaClass,0xd8);
  _gMetaClass = &PTR__MetaClass_00077eb0;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelShared2::gMetaClass,"IOAccelShared2",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x138);
  _gMetaClass = &PTR__MetaClass_00078128;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelSharedUserClient2::gMetaClass,"IOAccelSharedUserClient2",
             (OSMetaClass *)PTR_gMetaClass_0006b018,0x168);
  _gMetaClass = &PTR__MetaClass_00078bd8;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelSharedUserClient2::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelShared2::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelSharedNamespace2::gMetaClass);
  return;
}



// IOAccelStatistics2::MetaClass::MetaClass()

void __thiscall IOAccelStatistics2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelStatistics2",(OSMetaClass *)PTR_gMetaClass_0006b068,0x68);
  *(undefined ***)this = &PTR__MetaClass_00079458;
  return;
}



// IOAccelStatistics2::MetaClass::~MetaClass()

void __thiscall IOAccelStatistics2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelStatistics2::IOAccelStatistics2(OSMetaClass const*)

void __thiscall
IOAccelStatistics2::IOAccelStatistics2(IOAccelStatistics2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelStatistics2_000792c0;
  return;
}



// IOAccelStatistics2::IOAccelStatistics2(OSMetaClass const*)

void __thiscall
IOAccelStatistics2::IOAccelStatistics2(IOAccelStatistics2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelStatistics2_000792c0;
  return;
}



// IOAccelStatistics2::~IOAccelStatistics2()

void __thiscall IOAccelStatistics2::~IOAccelStatistics2(IOAccelStatistics2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelStatistics2::~IOAccelStatistics2()

void __thiscall IOAccelStatistics2::~IOAccelStatistics2(IOAccelStatistics2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelStatistics2::~IOAccelStatistics2()

void __thiscall IOAccelStatistics2::~IOAccelStatistics2(IOAccelStatistics2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelStatistics2_ktv,this,0x68);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelStatistics2::operator delete(void*, unsigned long)

void __cdecl IOAccelStatistics2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelStatistics2_ktv,param_1,param_2);
  return;
}



// IOAccelStatistics2::getMetaClass() const

undefined1 * IOAccelStatistics2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelStatistics2::MetaClass::MetaClass()

void __thiscall IOAccelStatistics2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelStatistics2",(OSMetaClass *)PTR_gMetaClass_0006b068,0x68);
  *(undefined ***)this = &PTR__MetaClass_00079458;
  return;
}



// IOAccelStatistics2::MetaClass::alloc() const

OSObject * IOAccelStatistics2::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelStatistics2_ktv,0x68);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelStatistics2::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelStatistics2_000792c0;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelStatistics2::operator new(unsigned long)

void * __thiscall IOAccelStatistics2::operator_new(IOAccelStatistics2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelStatistics2_ktv,this);
  return pvVar1;
}



// IOAccelStatistics2::IOAccelStatistics2()

void __thiscall IOAccelStatistics2::IOAccelStatistics2(IOAccelStatistics2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelStatistics2_000792c0;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelStatistics2::IOAccelStatistics2()

void __thiscall IOAccelStatistics2::IOAccelStatistics2(IOAccelStatistics2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelStatistics2_000792c0;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelStatistics2::init(IOGraphicsAccelerator2*)

void __thiscall IOAccelStatistics2::init(IOAccelStatistics2 *this,undefined8 param_1)

{
  long *plVar1;
  
  *(undefined8 *)(this + 0x10) = param_1;
  plVar1 = (long *)OSSerializer::forTarget(this,serialize_performance_stats_reset,(void *)0x0);
  if (plVar1 != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x10) + 0x268))
              (*(long **)(this + 0x10),"PerformanceStatistics",plVar1);
    (**(code **)(*plVar1 + 0x28))(plVar1);
  }
  plVar1 = (long *)OSSerializer::forTarget(this,serialize_internal_stats_reset,(void *)0x0);
  if (plVar1 != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x10) + 0x268))
              (*(long **)(this + 0x10),"InternalStatistics",plVar1);
    (**(code **)(*plVar1 + 0x28))(plVar1);
  }
  plVar1 = (long *)OSSerializer::forTarget(this,serialize_performance_stats_noreset,(void *)0x0);
  if (plVar1 != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x10) + 0x268))
              (*(long **)(this + 0x10),"PerformanceStatisticsAccum",plVar1);
    (**(code **)(*plVar1 + 0x28))(plVar1);
  }
  plVar1 = (long *)OSSerializer::forTarget(this,serialize_internal_stats_noreset,(void *)0x0);
  if (plVar1 != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x10) + 0x268))
              (*(long **)(this + 0x10),"InternalStatisticsAccm",plVar1);
    (**(code **)(*plVar1 + 0x28))(plVar1);
  }
  plVar1 = (long *)OSSerializer::forTarget(this,serialize_surface_list,(void *)0x0);
  if (plVar1 != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x10) + 0x268))(*(long **)(this + 0x10),"SurfaceList",plVar1);
    (**(code **)(*plVar1 + 0x28))(plVar1);
  }
  plVar1 = (long *)OSSerializer::forTarget(this,serialize_agc_info,(void *)0x0);
  if (plVar1 != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x10) + 0x268))(*(long **)(this + 0x10),"AGCInfo",plVar1);
    (**(code **)(*plVar1 + 0x28))(plVar1);
  }
                    // WARNING: Could not recover jumptable at 0x0002f401. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x130))(this);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelStatistics2::serialize_performance_stats_reset(void*, void*, OSSerialize*)

undefined4 __cdecl
IOAccelStatistics2::serialize_performance_stats_reset
          (OSMetaClassBase *param_1,undefined8 param_2,undefined8 param_3)

{
  undefined4 uVar1;
  IOAccelStatistics2 *this;
  
  this = (IOAccelStatistics2 *)OSMetaClassBase::safeMetaCast(param_1,(OSMetaClass *)&gMetaClass);
  if (this != (IOAccelStatistics2 *)0x0) {
    uVar1 = serialize_performance_stats(this,param_3,1);
    return uVar1;
  }
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelStatistics2::serialize_internal_stats_reset(void*, void*, OSSerialize*)

undefined4 __cdecl
IOAccelStatistics2::serialize_internal_stats_reset
          (OSMetaClassBase *param_1,undefined8 param_2,undefined8 param_3)

{
  undefined4 uVar1;
  long lVar2;
  long *plVar3;
  
  lVar2 = OSMetaClassBase::safeMetaCast(param_1,(OSMetaClass *)&gMetaClass);
  if ((lVar2 != 0) && (plVar3 = (long *)OSDictionary::withCapacity(1), plVar3 != (long *)0x0)) {
    uVar1 = (**(code **)(*plVar3 + 0x30))(plVar3,param_3);
    (**(code **)(*plVar3 + 0x28))(plVar3);
    return uVar1;
  }
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelStatistics2::serialize_performance_stats_noreset(void*, void*, OSSerialize*)

undefined4 __cdecl
IOAccelStatistics2::serialize_performance_stats_noreset
          (OSMetaClassBase *param_1,undefined8 param_2,undefined8 param_3)

{
  undefined4 uVar1;
  IOAccelStatistics2 *this;
  
  this = (IOAccelStatistics2 *)OSMetaClassBase::safeMetaCast(param_1,(OSMetaClass *)&gMetaClass);
  if (this != (IOAccelStatistics2 *)0x0) {
    uVar1 = serialize_performance_stats(this,param_3,0);
    return uVar1;
  }
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelStatistics2::serialize_internal_stats_noreset(void*, void*, OSSerialize*)

undefined4 __cdecl
IOAccelStatistics2::serialize_internal_stats_noreset
          (OSMetaClassBase *param_1,undefined8 param_2,undefined8 param_3)

{
  undefined4 uVar1;
  long lVar2;
  long *plVar3;
  
  lVar2 = OSMetaClassBase::safeMetaCast(param_1,(OSMetaClass *)&gMetaClass);
  if ((lVar2 != 0) && (plVar3 = (long *)OSDictionary::withCapacity(1), plVar3 != (long *)0x0)) {
    uVar1 = (**(code **)(*plVar3 + 0x30))(plVar3,param_3);
    (**(code **)(*plVar3 + 0x28))(plVar3);
    return uVar1;
  }
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelStatistics2::serialize_surface_list(void*, void*, OSSerialize*)

undefined4 __cdecl
IOAccelStatistics2::serialize_surface_list
          (OSMetaClassBase *param_1,undefined8 param_2,undefined8 param_3)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined4 uVar2;
  IOAccelStatistics2 *this;
  long *plVar3;
  
  this = (IOAccelStatistics2 *)OSMetaClassBase::safeMetaCast(param_1,(OSMetaClass *)&gMetaClass);
  if (this == (IOAccelStatistics2 *)0x0) {
    uVar2 = 0;
  }
  else {
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x10);
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    uVar2 = 0;
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    plVar3 = (long *)OSArray::withCapacity(1);
    if (plVar3 != (long *)0x0) {
      write_surface_list(this,plVar3);
      uVar2 = (**(code **)(*plVar3 + 0x30))(plVar3,param_3);
      (**(code **)(*plVar3 + 0x28))(plVar3);
    }
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x10);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  }
  return uVar2;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelStatistics2::serialize_agc_info(void*, void*, OSSerialize*)

undefined4 __cdecl
IOAccelStatistics2::serialize_agc_info
          (OSMetaClassBase *param_1,undefined8 param_2,undefined8 param_3)

{
  undefined4 uVar1;
  long lVar2;
  long *plVar3;
  long *plVar4;
  
  lVar2 = OSMetaClassBase::safeMetaCast(param_1,(OSMetaClass *)&gMetaClass);
  if ((lVar2 != 0) && (plVar3 = (long *)OSDictionary::withCapacity(1), plVar3 != (long *)0x0)) {
    plVar4 = (long *)OSNumber::withNumber((long)*(int *)(*(long *)(lVar2 + 0x10) + 0x158),0x20);
    (**(code **)(*plVar3 + 0x1d0))(plVar3,"fBusyCount",plVar4);
    (**(code **)(*plVar4 + 0x28))(plVar4);
    plVar4 = (long *)OSNumber::withNumber((long)*(int *)(*(long *)(lVar2 + 0x10) + 0x15c),0x20);
    (**(code **)(*plVar3 + 0x1d0))(plVar3,"fSubmissionsSinceLastCheck",plVar4);
    (**(code **)(*plVar4 + 0x28))(plVar4);
    plVar4 = (long *)OSNumber::withNumber((ulong)*(uint *)(*(long *)(lVar2 + 0x10) + 0xdd4),0x20);
    (**(code **)(*plVar3 + 0x1d0))(plVar3,"fLastSubmissionPID",plVar4);
    (**(code **)(*plVar4 + 0x28))(plVar4);
    plVar4 = (long *)OSBoolean::withBoolean
                               (SUB41((*(uint *)(*(long *)(lVar2 + 0x10) + 0xc78) & 4) >> 2,0));
    (**(code **)(*plVar3 + 0x1d0))(plVar3,"poweredOffByAGC",plVar4);
    (**(code **)(*plVar4 + 0x28))(plVar4);
    uVar1 = (**(code **)(*plVar3 + 0x30))(plVar3,param_3);
    (**(code **)(*plVar3 + 0x28))(plVar3);
    return uVar1;
  }
  return 0;
}



// IOAccelStatistics2::addChannel(char const*, unsigned long long)

void __thiscall
IOAccelStatistics2::addChannel(IOAccelStatistics2 *this,undefined8 param_2_00,char *param_2)

{
  IOReporter::addChannel(*(ulonglong *)(this + 0x58),param_2);
  return;
}



// IOAccelStatistics2::free()

void __thiscall IOAccelStatistics2::free(IOAccelStatistics2 *this)

{
  if (*(long **)(this + 0x58) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x58) + 0x28))();
  }
  if (*(long **)(this + 0x60) != (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0002f780. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0x60) + 0x28))();
    return;
  }
  return;
}



// IOAccelStatistics2::setupChannels()

void __thiscall IOAccelStatistics2::setupChannels(IOAccelStatistics2 *this)

{
  long lVar1;
  
  lVar1 = 8;
  do {
    IOReporter::addChannel(*(ulonglong *)(this + 0x58),*(char **)(&UNK_00079528 + lVar1));
    lVar1 = lVar1 + 0x10;
  } while (lVar1 != 0x3f8);
  return;
}



// IOAccelStatistics2::setupIOReporters()

undefined8 __thiscall IOAccelStatistics2::setupIOReporters(IOAccelStatistics2 *this)

{
  long lVar1;
  undefined8 uVar2;
  
  lVar1 = OSSet::withCapacity(4);
  *(long *)(this + 0x60) = lVar1;
  if (lVar1 == 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = 0;
    lVar1 = IOSimpleReporter::with(*(IOService **)(this + 0x10),0x8000,0);
    *(long *)(this + 0x58) = lVar1;
    if (lVar1 != 0) {
      (**(code **)(**(long **)(this + 0x60) + 0x1c0))(*(long **)(this + 0x60),lVar1);
      (**(code **)(*(long *)this + 0x138))(this);
      IOReportLegend::addReporterLegend
                (*(IOService **)(this + 0x10),*(IOReporter **)(this + 0x58),"Internal Statistics",
                 (char *)0x0);
      uVar2 = 1;
    }
  }
  return uVar2;
}



// IOAccelStatistics2::configureReport(IOReportChannelList*, unsigned int, void*, void*)

undefined8 IOAccelStatistics2::configureReport(void)

{
  return 0;
}



// IOAccelStatistics2::configure_report(IOReportChannelList*, unsigned int, void*, void*)

void __thiscall
IOAccelStatistics2::configure_report
          (IOAccelStatistics2 *this,IOReportChannelList *param_1,uint param_2,void *param_3,
          void *param_4)

{
  int iVar1;
  
  iVar1 = (**(code **)(*(long *)this + 0x140))();
  if (iVar1 != 0) {
    return;
  }
  IOReporter::configureAllReports(*(OSSet **)(this + 0x60),param_1,param_2,param_3,param_4);
  return;
}



// IOAccelStatistics2::updateReport(IOReportChannelList*, unsigned int, void*, void*)

undefined8 IOAccelStatistics2::updateReport(void)

{
  return 0;
}



// IOAccelStatistics2::update_report(IOReportChannelList*, unsigned int, void*, void*)

void __thiscall
IOAccelStatistics2::update_report
          (IOAccelStatistics2 *this,IOReportChannelList *param_1,uint param_2,void *param_3,
          void *param_4)

{
  int iVar1;
  
  IOSimpleReporter::setValue(*(ulonglong *)(this + 0x58),0x21);
  IOSimpleReporter::setValue(*(ulonglong *)(this + 0x58),0x6a);
  IOSimpleReporter::setValue(*(ulonglong *)(this + 0x58),0x69);
  iVar1 = (**(code **)(*(long *)this + 0x148))(this,param_1,param_2,param_3,param_4);
  if (iVar1 != 0) {
    return;
  }
  IOReporter::updateAllReports(*(OSSet **)(this + 0x60),param_1,param_2,param_3,param_4);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelStatistics2::setChannelValue(unsigned long long, unsigned long long)

void __cdecl IOAccelStatistics2::setChannelValue(long param_1,longlong param_2)

{
  IOSimpleReporter::setValue(*(ulonglong *)(param_1 + 0x58),param_2);
  return;
}



// IOAccelStatistics2::serialize_performance_stats(OSSerialize*, bool)

undefined4 __thiscall
IOAccelStatistics2::serialize_performance_stats
          (IOAccelStatistics2 *this,undefined8 param_1,undefined1 param_2)

{
  undefined4 uVar1;
  long *plVar2;
  
  plVar2 = (long *)OSDictionary::withCapacity(1);
  if (plVar2 == (long *)0x0) {
    uVar1 = 0;
  }
  else {
    (**(code **)(*(long *)this + 0x120))(this,plVar2,param_2);
    (**(code **)(*(long *)this + 0x128))(this,plVar2,param_2);
    uVar1 = (**(code **)(*plVar2 + 0x30))(plVar2,param_1);
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return uVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelStatistics2::serialize_internal_stats(OSSerialize*, bool)

undefined4 __cdecl
IOAccelStatistics2::serialize_internal_stats(undefined8 param_1,undefined8 param_2)

{
  undefined4 uVar1;
  long *plVar2;
  
  plVar2 = (long *)OSDictionary::withCapacity(1);
  if (plVar2 == (long *)0x0) {
    uVar1 = 0;
  }
  else {
    uVar1 = (**(code **)(*plVar2 + 0x30))(plVar2,param_2);
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return uVar1;
}



// IOAccelStatistics2::write_surface_list(OSArray*)

void __thiscall IOAccelStatistics2::write_surface_list(IOAccelStatistics2 *this,long *param_1)

{
  IOAccelContext2 *this_00;
  undefined1 *local_20;
  
  local_20 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelContextList::Iterator::Iterator
            ((Iterator *)&local_20,(undefined8 *)(*(long *)(this + 0x10) + 0xa58));
  this_00 = (IOAccelContext2 *)IOAccelContextList::Iterator::getNextContext((Iterator *)&local_20);
  if (this_00 != (IOAccelContext2 *)0x0) {
    do {
      IOAccelContext2::add_task_surface_to_array(this_00,param_1,'\0');
      this_00 = (IOAccelContext2 *)
                IOAccelContextList::Iterator::getNextContext((Iterator *)&local_20);
    } while (this_00 != (IOAccelContext2 *)0x0);
  }
  return;
}



// IOAccelStatistics2::writePerformanceStats(OSDictionary*, bool)

void __thiscall
IOAccelStatistics2::writePerformanceStats(IOAccelStatistics2 *this,long *param_1,int param_2)

{
  IOAccelStatistics2 *pIVar1;
  long lVar2;
  
  pIVar1 = this + 0x10;
  addNumber(param_1,*(uint *)(*(long *)(this + 0x10) + 0x1f0),"gartMapInBytesPerSample");
  lVar2 = *(long *)(this + 0x10);
  if (param_2 == 0) {
    addNumber(param_1,*(uint *)(lVar2 + 500),"gartMapOutBytesPerSample");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x1bc),"stdTextureCreationBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x1b4),"oolTextureCreationBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x1c0),"agpTextureCreationBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x1b8),"agprefTextureCreationBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x1c4),"iosurfaceTextureCreationBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x1f8),"stdTexturePageInBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x1fc),"oolTexturePageInBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x200),"surfaceBufferPageInBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x204),"ioSurfacePageInBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x210),"texturePageOutBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x208),"ioSurfacePageOutBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x20c),"surfaceBufferPageOutBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x220),"textureVolunteerUnloadBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x214),"ioSurfaceReadOutBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x218),"surfaceBufferReadOutBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x21c),"textureReadOutBytes");
    lVar2 = *(long *)pIVar1;
  }
  else {
    *(undefined4 *)(lVar2 + 0x1f0) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 500),"gartMapOutBytesPerSample");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 500) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x1bc),"stdTextureCreationBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x1bc) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x1b4),"oolTextureCreationBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x1b4) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x1c0),"agpTextureCreationBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x1c0) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x1b8),"agprefTextureCreationBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x1b8) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x1c4),"iosurfaceTextureCreationBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x1c4) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x1f8),"stdTexturePageInBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x1f8) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x1fc),"oolTexturePageInBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x1fc) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x200),"surfaceBufferPageInBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x200) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x204),"ioSurfacePageInBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x204) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x210),"texturePageOutBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x210) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x208),"ioSurfacePageOutBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x208) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x20c),"surfaceBufferPageOutBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x20c) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x220),"textureVolunteerUnloadBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x220) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x214),"ioSurfaceReadOutBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x214) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x218),"surfaceBufferReadOutBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x218) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x21c),"textureReadOutBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x21c) = 0;
  }
  addNumber(param_1,*(uint *)(lVar2 + 0x1e4),"textureCount");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x234),"contextGLCount");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2e8),"clientSharedAllocatedBytes");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x238),"contextCLCount");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x24c),"hardwareWaitTime");
  lVar2 = *(long *)pIVar1;
  if ((char)param_2 != '\0') {
    *(undefined4 *)(lVar2 + 0x24c) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2a4),"finishGLWaitTime");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2a4) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2a8),"finishCLWaitTime");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2a8) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x248),"vramEvictionWaitTime");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x248) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x25c),"freeToAllocGPUAddressWaitTime");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x25c) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x350),"gartUsedBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x9dc),"recoveryCount");
    *(undefined4 *)(*(long *)pIVar1 + 0x9dc) = 0;
    return;
  }
  addNumber(param_1,*(uint *)(lVar2 + 0x2a4),"finishGLWaitTime");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2a8),"finishCLWaitTime");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x248),"vramEvictionWaitTime");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x25c),"freeToAllocGPUAddressWaitTime");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x350),"gartUsedBytes");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x9dc),"recoveryCount");
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelStatistics2::addNumber(OSDictionary*, unsigned int, char const*)

void __cdecl IOAccelStatistics2::addNumber(long *param_1,uint param_2,undefined8 param_3)

{
  long *plVar1;
  
  plVar1 = (long *)OSNumber::withNumber((ulong)param_2,0x20);
  if (plVar1 != (long *)0x0) {
    (**(code **)(*param_1 + 0x1d0))(param_1,param_3,plVar1);
                    // WARNING: Could not recover jumptable at 0x000300fc. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*plVar1 + 0x28))(plVar1);
    return;
  }
  return;
}



// IOAccelStatistics2::writeInternalStats(OSDictionary*, bool)

void __thiscall
IOAccelStatistics2::writeInternalStats(IOAccelStatistics2 *this,long *param_1,int param_2)

{
  IOAccelStatistics2 *pIVar1;
  int iVar2;
  long lVar3;
  uint uVar4;
  uint uVar5;
  
  pIVar1 = this + 0x10;
  addNumber(param_1,*(uint *)(*(long *)(this + 0x10) + 0x1c8),"oolTextureCreationCount");
  lVar3 = *(long *)(this + 0x10);
  if (param_2 == 0) {
    addNumber(param_1,*(uint *)(lVar3 + 0x1cc),"stdTextureCreationCount");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x1d0),"agpTextureCreationCount");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x1d4),"agprefTextureCreationCount");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x1d8),"surfaceTextureCreationCount");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x1dc),"surfaceBufferTextureCreationCount");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x1e0),"iosurfaceTextureCreationCount");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x1ec),"swapBytesPerSample");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x1e8),"dataBytesPerSample");
    lVar3 = *(long *)pIVar1;
  }
  else {
    *(undefined4 *)(lVar3 + 0x1c8) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x1cc),"stdTextureCreationCount");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x1cc) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x1d0),"agpTextureCreationCount");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x1d0) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x1d4),"agprefTextureCreationCount");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x1d4) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x1d8),"surfaceTextureCreationCount");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x1d8) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x1dc),"surfaceBufferTextureCreationCount");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x1dc) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x1e0),"iosurfaceTextureCreationCount");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x1e0) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x1ec),"swapBytesPerSample");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x1ec) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x1e8),"dataBytesPerSample");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x1e8) = 0;
  }
  addNumber(param_1,*(uint *)(lVar3 + 0x224),"surfaceCount");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x22c),"context2DCount");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x230),"contextVideoCount");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x228),"volatileSurfaceCount");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x240),"bufferFlipCount");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x23c),"bufferSwapCount");
  lVar3 = *(long *)pIVar1;
  if ((char)param_2 == '\0') {
    addNumber(param_1,*(uint *)(lVar3 + 0x244),"dataBufferCount");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x250),"hardwareSubmitWaitTime");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x254),"clientGLWaitTime");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x264),"freeDataBufferWaitTime");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x268),"freeSurfaceSwapBufferWaitTime");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x26c),"freeSurfaceBackingWaitTime");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x274),"swapCompleteGLWaitTime");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x270),"swapComplete2DWaitTime");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x278),"swapCompleteVideoWaitTime");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x298),"finishAll2DWaitTime");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x29c),"finish2DWaitTime");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2a0),"finishVideoWaitTime");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x27c),"surfaceCopyInWaitTime");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x280),"surfaceCopyOutWaitTime");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x284),"surfaceReadLockIdleWaitTime");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x288),"surfaceWriteLockIdleWaitTime");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x28c),"surfaceSetShapeIdleWaitTime");
    lVar3 = *(long *)pIVar1;
  }
  else {
    *(undefined4 *)(lVar3 + 0x23c) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x244),"dataBufferCount");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x244) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x250),"hardwareSubmitWaitTime");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x250) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x254),"clientGLWaitTime");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x254) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x264),"freeDataBufferWaitTime");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x264) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x268),"freeSurfaceSwapBufferWaitTime");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x268) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x26c),"freeSurfaceBackingWaitTime");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x26c) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x274),"swapCompleteGLWaitTime");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x274) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x270),"swapComplete2DWaitTime");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x270) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x278),"swapCompleteVideoWaitTime");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x278) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x298),"finishAll2DWaitTime");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x298) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x29c),"finish2DWaitTime");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x29c) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x2a0),"finishVideoWaitTime");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x2a0) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x27c),"surfaceCopyInWaitTime");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x27c) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x280),"surfaceCopyOutWaitTime");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x280) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x284),"surfaceReadLockIdleWaitTime");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x284) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x288),"surfaceWriteLockIdleWaitTime");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x288) = 0;
    addNumber(param_1,*(uint *)(lVar3 + 0x28c),"surfaceSetShapeIdleWaitTime");
    lVar3 = *(long *)pIVar1;
    *(undefined4 *)(lVar3 + 0x28c) = 0;
  }
  addNumber64(param_1,*(long *)(lVar3 + 0x348) - *(long *)(lVar3 + 0x350),"gartFreeBytes");
  addNumber64(param_1,*(ulonglong *)(*(long *)pIVar1 + 0x348),"gartSizeBytes");
  addNumber64(param_1,*(ulonglong *)(*(long *)pIVar1 + 0x338),"gartCacheBytes");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0xba0),"orphanedReusableSysMemoryCount");
  addNumber64(param_1,*(ulonglong *)(*(long *)pIVar1 + 0xbb0),"orphanedReusableSysMemoryBytes");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0xba4),"orphanedNonReusableSysMemoryCount");
  addNumber64(param_1,*(ulonglong *)(*(long *)pIVar1 + 3000),"orphanedNonReusableSysMemoryBytes");
  iVar2 = *(int *)(*(long *)pIVar1 + 0xbc0);
  uVar5 = 0;
  uVar4 = 0;
  if (iVar2 != 0) {
    uVar4 = (uint)(iVar2 * 100) / (uint)(iVar2 + *(int *)(*(long *)pIVar1 + 0xbc4));
  }
  addNumber(param_1,uVar4,"orphanedReusableSysMemoryHitRate");
  lVar3 = *(long *)pIVar1;
  addNumber64(param_1,*(long *)(lVar3 + 0x350) -
                      (*(long *)(lVar3 + 0xbb0) + *(long *)(lVar3 + 3000)),"inUseSysMemoryBytes");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0xc08),"orphanedReusableVidMemoryCount");
  addNumber64(param_1,*(ulonglong *)(*(long *)pIVar1 + 0xc18),"orphanedReusableVidMemoryBytes");
  addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0xc0c),"orphanedNonReusableVidMemoryCount");
  addNumber64(param_1,*(ulonglong *)(*(long *)pIVar1 + 0xc20),"orphanedNonReusableVidMemoryBytes");
  iVar2 = *(int *)(*(long *)pIVar1 + 0xc28);
  if (iVar2 != 0) {
    uVar5 = (uint)(iVar2 * 100) / (uint)(iVar2 + *(int *)(*(long *)pIVar1 + 0xc2c));
  }
  addNumber(param_1,uVar5,"orphanedReusableVidMemoryHitRate");
  lVar3 = *(long *)pIVar1;
  addNumber64(param_1,*(long *)(lVar3 + 0x360) -
                      (*(long *)(lVar3 + 0xc18) + *(long *)(lVar3 + 0xc20)),"inUseVidMemoryBytes");
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelStatistics2::addNumber64(OSDictionary*, unsigned long long, char const*)

void __cdecl IOAccelStatistics2::addNumber64(long *param_1,ulonglong param_2,undefined8 param_3)

{
  long *plVar1;
  
  plVar1 = (long *)OSNumber::withNumber(param_2,0x40);
  if (plVar1 != (long *)0x0) {
    (**(code **)(*param_1 + 0x1d0))(param_1,param_3,plVar1);
                    // WARNING: Could not recover jumptable at 0x000309bd. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*plVar1 + 0x28))(plVar1);
    return;
  }
  return;
}



// IOAccelStatistics2::write_internal_stats_extra(OSDictionary*, bool)

void __thiscall
IOAccelStatistics2::write_internal_stats_extra(IOAccelStatistics2 *this,long *param_1,int param_2)

{
  IOAccelStatistics2 *pIVar1;
  long lVar2;
  uint uVar3;
  ulonglong uVar4;
  
  pIVar1 = this + 0x10;
  addNumber(param_1,*(uint *)(*(long *)(this + 0x10) + 0x2ac),"FTOVSearchPasses");
  lVar2 = *(long *)(this + 0x10);
  if (param_2 == 0) {
    addNumber(param_1,*(uint *)(lVar2 + 0x2b0),"FTOVLRUTests");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2b4),"FTOVLRUBusyTextures");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2b8),"FTOVLRUDeletedTextures");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 700),"FTOVMRUTests");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2c0),"FTOVMRUBusyTextures");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2c4),"FTOVMRUDeletedTextures");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2c8),"FTOVKeepTextureCount");
    lVar2 = *(long *)pIVar1;
  }
  else {
    *(undefined4 *)(lVar2 + 0x2ac) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2b0),"FTOVLRUTests");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2b0) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2b4),"FTOVLRUBusyTextures");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2b4) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2b8),"FTOVLRUDeletedTextures");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2b8) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 700),"FTOVMRUTests");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 700) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2c0),"FTOVMRUBusyTextures");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2c0) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2c4),"FTOVMRUDeletedTextures");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2c4) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2c8),"FTOVKeepTextureCount");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2c8) = 0;
  }
  uVar3 = *(int *)(lVar2 + 0x2cc) - *(int *)(lVar2 + 0x2d0);
  *(uint *)(lVar2 + 0x2d4) = uVar3;
  addNumber(param_1,uVar3,"new_delete_diff_TextureCallCount");
  lVar2 = *(long *)pIVar1;
  if ((char)param_2 == '\0') {
    addNumber(param_1,*(uint *)(lVar2 + 0x30c),"gartGCCount");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x310),"gartGCRemoved");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x314),"gartGCDataBuffers");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x318),"gartGCUnconsumedTextures");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x31c),"gartGCBoundTextures");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 800),"gartGCSwapBuffersInFlight");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x324),"gartGCSwapBuffersRemoved");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2cc),"newTextureCallCount");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2d0),"deleteTextureCallCount");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2d8),"AllocationCount");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2dc),"kernelIOAcceleratorAllocatedBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2e0),"kernelIOGLContextAllocatedBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2e4),"kernelIOSurfaceAllocatedBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2ec),"kernelClientSharedBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2f0),"kernelClientAllocationBytes");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2f4),"kernelContextAllocations");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2f8),"kernelCommandAllocations");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x2fc),"kernelSwapAllocations");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x300),"kernelSurfaceAllocations");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x304),"kernelTextureAllocations");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x308),"kernelPrivateAllocations");
    addNumber(param_1,*(uint *)(*(long *)pIVar1 + 0x32c),"dirtyTexureVolunteerPageoffCount");
    lVar2 = *(long *)pIVar1;
  }
  else {
    *(undefined4 *)(lVar2 + 0x2d4) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x30c),"gartGCCount");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x30c) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x310),"gartGCRemoved");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x310) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x314),"gartGCDataBuffers");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x314) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x318),"gartGCUnconsumedTextures");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x318) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x31c),"gartGCBoundTextures");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x31c) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 800),"gartGCSwapBuffersInFlight");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 800) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x324),"gartGCSwapBuffersRemoved");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x324) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2cc),"newTextureCallCount");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2cc) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2d0),"deleteTextureCallCount");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2d0) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2d8),"AllocationCount");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2d8) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2dc),"kernelIOAcceleratorAllocatedBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2dc) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2e0),"kernelIOGLContextAllocatedBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2e0) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2e4),"kernelIOSurfaceAllocatedBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2e4) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2ec),"kernelClientSharedBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2ec) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2f0),"kernelClientAllocationBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2f0) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2f4),"kernelContextAllocations");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2f4) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2f8),"kernelCommandAllocations");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2f8) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x2fc),"kernelSwapAllocations");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x2fc) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x300),"kernelSurfaceAllocations");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x300) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x304),"kernelTextureAllocations");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x304) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x308),"kernelPrivateAllocations");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x308) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x32c),"dirtyTexureVolunteerPageoffCount");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x32c) = 0;
  }
  uVar3 = *(int *)(lVar2 + 0x2e0) + *(int *)(lVar2 + 0x2dc) + *(int *)(lVar2 + 0x2e4) +
          *(int *)(lVar2 + 0x2e8);
  *(uint *)(lVar2 + 0x334) = uVar3;
  addNumber(param_1,uVar3,"kernelAllocatedBytes");
  lVar2 = *(long *)pIVar1;
  if ((char)param_2 == '\0') {
    addNumber(param_1,*(uint *)(lVar2 + 0x330),"backingStoreAllocatedBytes");
    lVar2 = *(long *)pIVar1;
  }
  else {
    *(undefined4 *)(lVar2 + 0x334) = 0;
    addNumber(param_1,*(uint *)(lVar2 + 0x330),"backingStoreAllocatedBytes");
    lVar2 = *(long *)pIVar1;
    *(undefined4 *)(lVar2 + 0x330) = 0;
  }
  if (*(int *)(lVar2 + 0xdc) == 0) {
    uVar4 = 0;
  }
  else {
    uVar4 = *(ulonglong *)(lVar2 + 0x338);
  }
  addNumber64(param_1,uVar4,"RequestGART_GC");
  return;
}



// IOAccelStatistics2::_RESERVEDIOAccelStatistics0()

void IOAccelStatistics2::_RESERVEDIOAccelStatistics0(void)

{
  OSMetaClass::reservedCalled(0x824d0);
  return;
}



// IOAccelStatistics2::_RESERVEDIOAccelStatistics1()

void IOAccelStatistics2::_RESERVEDIOAccelStatistics1(void)

{
  OSMetaClass::reservedCalled(0x824d0);
  return;
}



// IOAccelStatistics2::_RESERVEDIOAccelStatistics2()

void IOAccelStatistics2::_RESERVEDIOAccelStatistics2(void)

{
  OSMetaClass::reservedCalled(0x824d0);
  return;
}



// IOAccelStatistics2::_RESERVEDIOAccelStatistics3()

void IOAccelStatistics2::_RESERVEDIOAccelStatistics3(void)

{
  OSMetaClass::reservedCalled(0x824d0);
  return;
}



// IOAccelStatistics2::_RESERVEDIOAccelStatistics4()

void IOAccelStatistics2::_RESERVEDIOAccelStatistics4(void)

{
  OSMetaClass::reservedCalled(0x824d0);
  return;
}



// IOAccelStatistics2::_RESERVEDIOAccelStatistics5()

void IOAccelStatistics2::_RESERVEDIOAccelStatistics5(void)

{
  OSMetaClass::reservedCalled(0x824d0);
  return;
}



// IOAccelStatistics2::MetaClass::~MetaClass()

void __thiscall IOAccelStatistics2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelStatistics_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelStatistics2::gMetaClass,"IOAccelStatistics2",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x68);
  _gMetaClass = &PTR__MetaClass_00079458;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelStatistics2::gMetaClass);
  return;
}



// IOAccelEventMachineFast2::MetaClass::MetaClass()

void __thiscall IOAccelEventMachineFast2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelEventMachineFast2",
             (OSMetaClass *)&IOAccelEventMachine2::gMetaClass,0xd30);
  *(undefined ***)this = &PTR__MetaClass_00079c50;
  return;
}



// IOAccelEventMachineFast2::MetaClass::~MetaClass()

void __thiscall IOAccelEventMachineFast2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelEventMachineFast2::IOAccelEventMachineFast2(OSMetaClass const*)

void __thiscall
IOAccelEventMachineFast2::IOAccelEventMachineFast2
          (IOAccelEventMachineFast2 *this,OSMetaClass *param_1)

{
  IOAccelEventMachine2::IOAccelEventMachine2((IOAccelEventMachine2 *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelEventMachineFast2_00079940;
  return;
}



// IOAccelEventMachineFast2::~IOAccelEventMachineFast2()

void __thiscall IOAccelEventMachineFast2::~IOAccelEventMachineFast2(IOAccelEventMachineFast2 *this)

{
  IOAccelEventMachine2::~IOAccelEventMachine2((IOAccelEventMachine2 *)this);
  return;
}



// IOAccelEventMachineFast2::~IOAccelEventMachineFast2()

void __thiscall IOAccelEventMachineFast2::~IOAccelEventMachineFast2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelEventMachineFast2::~IOAccelEventMachineFast2()

void __thiscall IOAccelEventMachineFast2::~IOAccelEventMachineFast2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelEventMachineFast2::getMetaClass() const

undefined1 * IOAccelEventMachineFast2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelEventMachineFast2::MetaClass::MetaClass()

void __thiscall IOAccelEventMachineFast2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelEventMachineFast2",
             (OSMetaClass *)&IOAccelEventMachine2::gMetaClass,0xd30);
  *(undefined ***)this = &PTR__MetaClass_00079c50;
  return;
}



// IOAccelEventMachineFast2::MetaClass::alloc() const

undefined8 IOAccelEventMachineFast2::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelEventMachineFast2::operator new(unsigned long)

void * __thiscall IOAccelEventMachineFast2::operator_new(IOAccelEventMachineFast2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelEventMachineFast2_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelEventMachineFast2::operator delete(void*, unsigned long)

void __cdecl IOAccelEventMachineFast2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelEventMachineFast2_ktv,param_1,param_2);
  return;
}



// IOAccelEventMachineFast2::init(IOGraphicsAccelerator2*, unsigned int, int)

void __thiscall
IOAccelEventMachineFast2::init
          (IOAccelEventMachineFast2 *this,undefined8 param_1,int param_2,uint param_3)

{
  uint uVar1;
  undefined8 uVar2;
  ulong uVar3;
  long lVar4;
  
  uVar2 = IOAccelEventMachine2::init((IOAccelEventMachine2 *)this,param_1,param_2,param_3);
  if ((char)uVar2 != '\0') {
    uVar1 = *(uint *)(this + 0x30);
    uVar3 = (ulong)uVar1;
    if ((int)uVar1 < 1) {
      uVar3 = 0;
    }
    else {
      lVar4 = 0;
      do {
        *(undefined8 *)(this + lVar4 + 0xf8) = 0;
        *(undefined8 *)(this + lVar4 + 0xf0) = 0;
        lVar4 = lVar4 + 0x18;
      } while (uVar3 * 0x18 != lVar4);
      if (0x7f < uVar1) {
        return;
      }
    }
    lVar4 = uVar3 * 0x18 + 0xfc;
    do {
      *(undefined8 *)(this + lVar4 + -4) = 0;
      *(undefined8 *)(this + lVar4 + -0xc) = 0;
      lVar4 = lVar4 + 0x18;
    } while (lVar4 != 0xcfc);
  }
  return;
}



// IOAccelEventMachineFast2::free()

void IOAccelEventMachineFast2::free(void)

{
  IOAccelEventMachine2 *in_RDI;
  
  IOAccelEventMachine2::free(in_RDI);
  return;
}



// IOAccelEventMachineFast2::getClientTestEventFunc()

char * IOAccelEventMachineFast2::getClientTestEventFunc(void)

{
  return "IOAccelDeviceTestEventFast";
}



// IOAccelEventMachineFast2::initEvent(IOAccelEvent*)

void __thiscall IOAccelEventMachineFast2::initEvent(undefined8 param_1_00,long param_2)

{
  long lVar1;
  
  lVar1 = 0;
  do {
    *(undefined8 *)(param_2 + lVar1 * 8) = 0xffffffff;
    lVar1 = lVar1 + 1;
  } while (lVar1 != 8);
  return;
}



// IOAccelEventMachineFast2::incrementStamp(int)

void __thiscall IOAccelEventMachineFast2::incrementStamp(IOAccelEventMachineFast2 *this,int param_1)

{
  uint uVar1;
  uint uVar2;
  
  uVar2 = *(uint *)(this + (long)param_1 * 0x18 + 0xfc);
  uVar1 = uVar2 + 1;
  if (0x3fffffff < (uVar2 ^ uVar1)) {
    (**(code **)(**(long **)(this + 0x10) + 0x8f0))();
  }
  *(uint *)(this + (long)param_1 * 0x18 + 0xfc) = uVar1;
  *(int *)(*(long *)(this + 0x10) + 0xa0) = *(int *)(*(long *)(this + 0x10) + 0xa0) + 1;
  return;
}



// IOAccelEventMachineFast2::writeStampCommand(int, IOAccelEventQueue*, vendevtCommandRec*)

void __thiscall
IOAccelEventMachineFast2::writeStampCommand
          (IOAccelEventMachineFast2 *this,int param_1,undefined8 param_3_00,undefined8 param_3)

{
                    // WARNING: Could not recover jumptable at 0x0003145c. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x2a0))
            (this,(long)param_1,param_3,*(undefined4 *)(this + (long)param_1 * 0x18 + 0xfc),
             *(code **)(*(long *)this + 0x2a0));
  return;
}



// IOAccelEventMachineFast2::writeEventStampCommand(int, IOAccelEventQueue*, IOAccelEvent*,
// vendevtCommandRec*)

void __thiscall
IOAccelEventMachineFast2::writeEventStampCommand
          (IOAccelEventMachineFast2 *this,int param_1,undefined8 param_3_00,long param_3,
          undefined8 param_4)

{
  ulong uVar1;
  long lVar2;
  
  lVar2 = 0;
  do {
    uVar1 = *(ulong *)(param_3 + lVar2 * 8);
    if ((int)uVar1 == param_1) {
                    // WARNING: Could not recover jumptable at 0x0003148d. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*(long *)this + 0x2a0))
                (this,param_1,param_4,uVar1 >> 0x20,param_4,*(code **)(*(long *)this + 0x2a0));
      return;
    }
    lVar2 = lVar2 + 1;
  } while (lVar2 != 8);
  return;
}



// IOAccelEventMachineFast2::logCommandSubmission(int)

void __thiscall
IOAccelEventMachineFast2::logCommandSubmission(IOAccelEventMachineFast2 *this,int param_1)

{
  uint uVar1;
  uintptr_t arg3;
  uintptr_t arg1;
  
  arg1 = (uintptr_t)param_1;
  uVar1 = *(uint *)(this + arg1 * 0x18 + 0xfc);
  *(uint *)(this + arg1 * 0x18 + 0x104) = uVar1;
  if (___ktrace_kernel_enabled != 0) {
    arg3 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85120008,arg1,(ulong)uVar1,arg3,0,0);
    return;
  }
  return;
}



// IOAccelEventMachineFast2::stampIsIncremented()

undefined8 IOAccelEventMachineFast2::stampIsIncremented(void)

{
  return 0;
}



// IOAccelEventMachineFast2::getStamp(int)

undefined4 __thiscall IOAccelEventMachineFast2::getStamp(IOAccelEventMachineFast2 *this,int param_1)

{
  return *(undefined4 *)(this + (long)param_1 * 0x18 + 0xfc);
}



// IOAccelEventMachineFast2::writeEventBarrierCommand(IOAccelEventQueue*, IOAccelEvent*,
// vendevtBarrierRec*, int)

void __thiscall
IOAccelEventMachineFast2::writeEventBarrierCommand
          (IOAccelEventMachineFast2 *this,undefined8 param_2_00,long param_2,undefined8 param_3,
          int param_4)

{
  int iVar1;
  undefined8 uVar2;
  long lVar3;
  int iVar4;
  long lVar5;
  
  (**(code **)(*(long *)this + 0x2a8))(this,param_3);
  lVar5 = 0;
  do {
    uVar2 = *(undefined8 *)(param_2 + lVar5 * 8);
    iVar4 = (int)uVar2;
    if ((iVar4 != -1) && (iVar4 != param_4)) {
      lVar3 = (long)iVar4;
      iVar4 = (int)((ulong)uVar2 >> 0x20);
      if ((0 < iVar4 - *(int *)(this + lVar3 * 0x18 + 0xf8)) &&
         (iVar1 = **(int **)(*(long *)(this + 0x28) + lVar3 * 8),
         *(int *)(this + lVar3 * 0x18 + 0xf8) = iVar1, 0 < iVar4 - iVar1)) {
        (**(code **)(*(long *)this + 0x2b8))(this,param_3);
      }
    }
    lVar5 = lVar5 + 1;
  } while (lVar5 != 8);
                    // WARNING: Could not recover jumptable at 0x000315aa. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x2b0))(this,param_3);
  return;
}



// IOAccelEventMachineFast2::finishEventUnlocked(IOAccelEvent*)

void __thiscall
IOAccelEventMachineFast2::finishEventUnlocked(IOAccelEventMachineFast2 *this,long param_1)

{
  int *piVar1;
  long lVar2;
  int iVar3;
  ulong uVar4;
  undefined8 uVar5;
  int iVar6;
  uintptr_t uVar7;
  int iVar8;
  long lVar9;
  ulong arg2;
  undefined1 *local_58;
  uintptr_t local_50;
  int local_44;
  undefined8 local_40;
  undefined1 *local_38;
  
  lVar9 = 0;
  local_44 = 0;
  do {
    uVar4 = *(ulong *)(param_1 + lVar9 * 8);
    iVar8 = (int)uVar4;
    if (iVar8 != -1) {
      arg2 = uVar4 >> 0x20;
      local_50 = (uintptr_t)iVar8;
      iVar6 = (int)(uVar4 >> 0x20);
      if (0 < iVar6 - *(int *)(this + local_50 * 0x18 + 0xf8)) {
        lVar2 = local_50 * 0x18;
        iVar3 = **(int **)(*(long *)(this + 0x28) + local_50 * 8);
        *(int *)(this + lVar2 + 0xf8) = iVar3;
        if ((0 < iVar6 - iVar3) && (*(int *)(*(long *)(this + 0x10) + 0xdc8) == 0)) {
          local_40 = 0;
          local_58 = &DAT_aaaaaaaaaaaaaaaa;
          local_38 = &DAT_aaaaaaaaaaaaaaaa;
          _clock_get_uptime(&local_58);
          uVar7 = IORegistryEntry::getRegistryEntryID();
          _kernel_debug(0x85020055,local_50,arg2,uVar7,0,0);
          do {
            while( true ) {
              iVar6 = (**(code **)(*(long *)this + 0x238))
                                (this,uVar4 & 0xffffffff,arg2,this + lVar2 + 0xf8);
              if (iVar6 != -0x1ffffd2a) break;
              IOAccelEventMachine2::signalHardwareError((IOAccelEventMachine2 *)this,3,iVar8);
            }
          } while (iVar6 != 0);
          uVar7 = IORegistryEntry::getRegistryEntryID();
          _kernel_debug(0x85020056,local_50,arg2,uVar7,0,0);
          _clock_get_uptime(&local_38);
          local_38 = local_38 + -(long)local_58;
          _absolutetime_to_nanoseconds(local_38,&local_40);
          uVar5 = local_40;
          lVar2 = *(long *)(this + 0x10);
          IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar2 + 0x388) + 0x58),0x2b);
          piVar1 = (int *)(lVar2 + 0x24c);
          *piVar1 = *piVar1 + (int)uVar5;
          local_44 = local_44 + (int)local_40;
        }
      }
    }
    lVar9 = lVar9 + 1;
  } while (lVar9 != 8);
  return;
}



// IOAccelEventMachineFast2::testEventUnlocked(IOAccelEvent*)

byte __thiscall
IOAccelEventMachineFast2::testEventUnlocked(IOAccelEventMachineFast2 *this,long param_1)

{
  int iVar1;
  undefined8 uVar2;
  bool bVar3;
  ulong uVar4;
  int iVar5;
  long lVar6;
  
  bVar3 = true;
  uVar4 = 0;
  do {
    uVar2 = *(undefined8 *)(param_1 + uVar4 * 8);
    iVar5 = (int)uVar2;
    if (iVar5 != -1) {
      lVar6 = (long)iVar5;
      iVar5 = (int)((ulong)uVar2 >> 0x20);
      if (((0 < iVar5 - *(int *)(this + lVar6 * 0x18 + 0xf8)) &&
          (iVar1 = **(int **)(*(long *)(this + 0x28) + lVar6 * 8),
          *(int *)(this + lVar6 * 0x18 + 0xf8) = iVar1, 0 < iVar5 - iVar1)) &&
         (*(int *)(*(long *)(this + 0x10) + 0xdc8) == 0)) break;
    }
    bVar3 = uVar4 < 7;
    uVar4 = uVar4 + 1;
  } while (uVar4 != 8);
  return ~bVar3 & 1;
}



// IOAccelEventMachineFast2::enableEventStampInterrupts(IOAccelEvent const*)

void __thiscall
IOAccelEventMachineFast2::enableEventStampInterrupts(IOAccelEventMachineFast2 *this,long param_1)

{
  int iVar1;
  ulong uVar2;
  long lVar3;
  int iVar4;
  
  lVar3 = 0;
  do {
    uVar2 = *(ulong *)(param_1 + lVar3 * 8);
    iVar4 = (int)uVar2;
    if (iVar4 != -1) {
      _IOLockLock(*(undefined8 *)(this + 0x50));
      iVar1 = *(int *)(*(long *)(this + 0x48) + (long)iVar4 * 4);
      *(int *)(*(long *)(this + 0x48) + (long)iVar4 * 4) = iVar1 + 1;
      if (iVar1 == 0) {
        (**(code **)(*(long *)this + 0x240))(this,uVar2 & 0xffffffff);
      }
      _IOLockUnlock(*(undefined8 *)(this + 0x50));
    }
    lVar3 = lVar3 + 1;
  } while (lVar3 != 8);
  return;
}



// IOAccelEventMachineFast2::disableEventStampInterrupts(IOAccelEvent const*)

void __thiscall
IOAccelEventMachineFast2::disableEventStampInterrupts(IOAccelEventMachineFast2 *this,long param_1)

{
  int iVar1;
  ulong uVar2;
  long lVar3;
  int iVar4;
  
  lVar3 = 0;
  do {
    uVar2 = *(ulong *)(param_1 + lVar3 * 8);
    iVar4 = (int)uVar2;
    if (iVar4 != -1) {
      _IOLockLock(*(undefined8 *)(this + 0x50));
      iVar1 = *(int *)(*(long *)(this + 0x48) + (long)iVar4 * 4);
      *(int *)(*(long *)(this + 0x48) + (long)iVar4 * 4) = iVar1 + -1;
      if (iVar1 == 1) {
        (**(code **)(*(long *)this + 0x248))(this,uVar2 & 0xffffffff);
      }
      _IOLockUnlock(*(undefined8 *)(this + 0x50));
    }
    lVar3 = lVar3 + 1;
  } while (lVar3 != 8);
  return;
}



// IOAccelEventMachineFast2::finishStamp(int)

ulong __thiscall IOAccelEventMachineFast2::finishStamp(IOAccelEventMachineFast2 *this,int param_1)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  uintptr_t uVar4;
  long lVar5;
  uintptr_t arg1;
  ulong uVar6;
  ulong local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  
  arg1 = (uintptr_t)param_1;
  uVar2 = *(uint *)(this + arg1 * 0x18 + 0xfc);
  uVar6 = (ulong)uVar2;
  local_48 = 0;
  if (0 < (int)(uVar2 - *(int *)(this + arg1 * 0x18 + 0xf8))) {
    iVar3 = **(int **)(*(long *)(this + 0x28) + arg1 * 8);
    *(int *)(this + arg1 * 0x18 + 0xf8) = iVar3;
    if (0 < (int)(uVar2 - iVar3)) {
      local_48 = 0;
      local_40 = &DAT_aaaaaaaaaaaaaaaa;
      local_38 = &DAT_aaaaaaaaaaaaaaaa;
      _clock_get_uptime();
      uVar4 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x85020055,arg1,uVar6,uVar4,0,0);
      lVar5 = *(long *)this;
      while( true ) {
        iVar3 = (**(code **)(lVar5 + 0x238))(this,param_1,uVar6,this + arg1 * 0x18 + 0xf8);
        if (iVar3 == 0) break;
        IOAccelEventMachine2::handleFinishChannelRestart
                  ((IOAccelEventMachine2 *)this,iVar3,param_1,1);
        lVar5 = *(long *)this;
      }
      uVar4 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x85020056,arg1,uVar6,uVar4,0,0);
      _clock_get_uptime(&local_38);
      local_38 = local_38 + -(long)local_40;
      _absolutetime_to_nanoseconds(local_38,&local_48);
      uVar6 = local_48;
      lVar5 = *(long *)(this + 0x10);
      IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar5 + 0x388) + 0x58),0x2b);
      piVar1 = (int *)(lVar5 + 0x24c);
      *piVar1 = *piVar1 + (int)uVar6;
      local_48 = local_48 & 0xffffffff;
    }
  }
  return local_48;
}



// IOAccelEventMachineFast2::finishAllStamps()

uint __thiscall IOAccelEventMachineFast2::finishAllStamps(IOAccelEventMachineFast2 *this)

{
  int iVar1;
  byte bVar2;
  int iVar3;
  uint uVar4;
  
  if (*(int *)(this + 0x30) < 1) {
    uVar4 = 0;
  }
  else {
    iVar3 = 0;
    bVar2 = 0;
    uVar4 = 0;
    do {
      iVar1 = (**(code **)(*(long *)this + 0x150))(this,iVar3);
      if (iVar1 == -1) {
        iVar1 = 0;
        bVar2 = 1;
      }
      uVar4 = uVar4 + iVar1;
      iVar3 = iVar3 + 1;
    } while (iVar3 < *(int *)(this + 0x30));
    uVar4 = -(uint)bVar2 | uVar4;
  }
  return uVar4;
}



// IOAccelEventMachineFast2::testStamp(int)

undefined8 __thiscall
IOAccelEventMachineFast2::testStamp(IOAccelEventMachineFast2 *this,int param_1)

{
  int iVar1;
  int iVar2;
  long lVar3;
  
  lVar3 = (long)param_1;
  iVar2 = *(int *)(this + lVar3 * 0x18 + 0xfc);
  if (0 < iVar2 - *(int *)(this + lVar3 * 0x18 + 0xf8)) {
    iVar1 = **(int **)(*(long *)(this + 0x28) + lVar3 * 8);
    *(int *)(this + lVar3 * 0x18 + 0xf8) = iVar1;
    iVar2 = iVar2 - iVar1;
    if (0 < iVar2) {
      return 0;
    }
  }
  return CONCAT71((uint7)(uint3)((uint)iVar2 >> 8),1);
}



// IOAccelEventMachineFast2::testAllStamps()

ulong __thiscall IOAccelEventMachineFast2::testAllStamps(IOAccelEventMachineFast2 *this)

{
  uint uVar1;
  int iVar2;
  undefined8 in_RAX;
  undefined7 uVar3;
  IOAccelEventMachineFast2 *pIVar4;
  ulong uVar5;
  bool bVar6;
  bool bVar7;
  
  uVar1 = *(uint *)(this + 0x30);
  if ((int)uVar1 < 1) {
    bVar6 = false;
    uVar3 = 0;
  }
  else {
    pIVar4 = this + 0xf8;
    uVar3 = (undefined7)((ulong)in_RAX >> 8);
    bVar6 = true;
    uVar5 = 1;
    do {
      if ((0 < *(int *)(pIVar4 + 4) - *(int *)pIVar4) &&
         (iVar2 = **(int **)(*(long *)(this + 0x28) + -8 + uVar5 * 8), *(int *)pIVar4 = iVar2,
         0 < *(int *)(pIVar4 + 4) - iVar2)) break;
      bVar6 = uVar5 < uVar1;
      pIVar4 = pIVar4 + 0x18;
      bVar7 = uVar5 != uVar1;
      uVar5 = uVar5 + 1;
    } while (bVar7);
  }
  return CONCAT71(uVar3,~bVar6) & 0xffffffffffffff01;
}



// IOAccelEventMachineFast2::testAllStampsUnlocked()

ulong __thiscall IOAccelEventMachineFast2::testAllStampsUnlocked(IOAccelEventMachineFast2 *this)

{
  uint uVar1;
  int iVar2;
  undefined8 in_RAX;
  undefined7 uVar3;
  IOAccelEventMachineFast2 *pIVar4;
  ulong uVar5;
  bool bVar6;
  bool bVar7;
  
  uVar1 = *(uint *)(this + 0x30);
  if ((int)uVar1 < 1) {
    bVar6 = false;
    uVar3 = 0;
  }
  else {
    pIVar4 = this + 0xf8;
    uVar3 = (undefined7)((ulong)in_RAX >> 8);
    bVar6 = true;
    uVar5 = 1;
    do {
      if ((0 < *(int *)(pIVar4 + 4) - *(int *)pIVar4) &&
         (iVar2 = **(int **)(*(long *)(this + 0x28) + -8 + uVar5 * 8), *(int *)pIVar4 = iVar2,
         0 < *(int *)(pIVar4 + 4) - iVar2)) break;
      bVar6 = uVar5 < uVar1;
      pIVar4 = pIVar4 + 0x18;
      bVar7 = uVar5 != uVar1;
      uVar5 = uVar5 + 1;
    } while (bVar7);
  }
  return CONCAT71(uVar3,~bVar6) & 0xffffffffffffff01;
}



// IOAccelEventMachineFast2::cleanEvent(IOAccelEvent*)

void __thiscall IOAccelEventMachineFast2::cleanEvent(undefined8 param_1_00,long param_2)

{
  long lVar1;
  
  lVar1 = 0;
  do {
    *(undefined8 *)(param_2 + lVar1 * 8) = 0xffffffff;
    lVar1 = lVar1 + 1;
  } while (lVar1 != 8);
  return;
}



// IOAccelEventMachineFast2::finishEvent(IOAccelEvent*)

int __thiscall IOAccelEventMachineFast2::finishEvent(IOAccelEventMachineFast2 *this,long param_1)

{
  int *piVar1;
  int iVar2;
  ulong uVar3;
  long lVar4;
  undefined8 uVar5;
  int iVar6;
  uintptr_t arg3;
  uintptr_t uVar7;
  ulong arg2;
  int iVar8;
  long lVar9;
  undefined1 *local_58;
  uintptr_t local_50;
  undefined8 local_48;
  undefined1 *local_40;
  int local_34;
  
  lVar9 = 0;
  local_34 = 0;
  do {
    uVar3 = *(ulong *)(param_1 + lVar9 * 8);
    iVar8 = (int)uVar3;
    if (iVar8 != -1) {
      arg2 = uVar3 >> 0x20;
      uVar7 = (uintptr_t)iVar8;
      iVar6 = (int)(uVar3 >> 0x20);
      if (0 < iVar6 - *(int *)(this + uVar7 * 0x18 + 0xf8)) {
        iVar2 = **(int **)(*(long *)(this + 0x28) + uVar7 * 8);
        *(int *)(this + uVar7 * 0x18 + 0xf8) = iVar2;
        if (0 < iVar6 - iVar2) {
          local_48 = 0;
          local_58 = &DAT_aaaaaaaaaaaaaaaa;
          local_40 = &DAT_aaaaaaaaaaaaaaaa;
          local_50 = uVar7;
          _clock_get_uptime(&local_58);
          arg3 = IORegistryEntry::getRegistryEntryID();
          _kernel_debug(0x85020055,local_50,arg2,arg3,0,0);
          while( true ) {
            iVar6 = (**(code **)(*(long *)this + 0x238))
                              (this,uVar3 & 0xffffffff,arg2,this + uVar7 * 0x18 + 0xf8);
            if (iVar6 == 0) break;
            IOAccelEventMachine2::handleFinishChannelRestart
                      ((IOAccelEventMachine2 *)this,iVar6,iVar8,2);
          }
          uVar7 = IORegistryEntry::getRegistryEntryID();
          _kernel_debug(0x85020056,local_50,arg2,uVar7,0,0);
          _clock_get_uptime(&local_40);
          local_40 = local_40 + -(long)local_58;
          _absolutetime_to_nanoseconds(local_40,&local_48);
          uVar5 = local_48;
          lVar4 = *(long *)(this + 0x10);
          IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar4 + 0x388) + 0x58),0x2b);
          piVar1 = (int *)(lVar4 + 0x24c);
          *piVar1 = *piVar1 + (int)uVar5;
          local_34 = local_34 + (int)local_48;
        }
      }
    }
    lVar9 = lVar9 + 1;
  } while (lVar9 != 8);
  (**(code **)(*(long *)this + 0x148))(this);
  return local_34;
}



// IOAccelEventMachineFast2::testEvent(IOAccelEvent*)

undefined4 __thiscall
IOAccelEventMachineFast2::testEvent(IOAccelEventMachineFast2 *this,undefined8 param_1)

{
  undefined4 uVar1;
  
  uVar1 = (**(code **)(*(long *)this + 0x180))();
  if ((char)uVar1 != '\0') {
    (**(code **)(*(long *)this + 0x148))(this,param_1);
  }
  return uVar1;
}



// IOAccelEventMachineFast2::finishEventExcluding(IOAccelEvent*, int)

void __thiscall
IOAccelEventMachineFast2::finishEventExcluding
          (IOAccelEventMachineFast2 *this,long param_1,int param_2)

{
  long lVar1;
  int *piVar2;
  int iVar3;
  ulong uVar4;
  undefined8 uVar5;
  int iVar6;
  uintptr_t uVar7;
  long lVar8;
  int iVar9;
  ulong arg2;
  undefined1 *local_58;
  uintptr_t local_50;
  int local_48;
  int local_44;
  undefined8 local_40;
  undefined1 *local_38;
  
  lVar8 = 0;
  local_48 = 0;
  local_44 = param_2;
  do {
    uVar4 = *(ulong *)(param_1 + lVar8 * 8);
    iVar9 = (int)uVar4;
    if ((iVar9 != -1) && (iVar9 != param_2)) {
      arg2 = uVar4 >> 0x20;
      local_50 = (uintptr_t)iVar9;
      iVar6 = (int)(uVar4 >> 0x20);
      if (0 < iVar6 - *(int *)(this + local_50 * 0x18 + 0xf8)) {
        lVar1 = local_50 * 0x18;
        iVar3 = **(int **)(*(long *)(this + 0x28) + local_50 * 8);
        *(int *)(this + lVar1 + 0xf8) = iVar3;
        if (0 < iVar6 - iVar3) {
          local_40 = 0;
          local_58 = &DAT_aaaaaaaaaaaaaaaa;
          local_38 = &DAT_aaaaaaaaaaaaaaaa;
          _clock_get_uptime(&local_58);
          uVar7 = IORegistryEntry::getRegistryEntryID();
          _kernel_debug(0x85020055,local_50,arg2,uVar7,0,0);
          while( true ) {
            iVar6 = (**(code **)(*(long *)this + 0x238))
                              (this,uVar4 & 0xffffffff,arg2,this + lVar1 + 0xf8);
            if (iVar6 == 0) break;
            IOAccelEventMachine2::handleFinishChannelRestart
                      ((IOAccelEventMachine2 *)this,iVar6,iVar9,3);
          }
          uVar7 = IORegistryEntry::getRegistryEntryID();
          _kernel_debug(0x85020056,local_50,arg2,uVar7,0,0);
          _clock_get_uptime(&local_38);
          local_38 = local_38 + -(long)local_58;
          _absolutetime_to_nanoseconds(local_38,&local_40);
          uVar5 = local_40;
          lVar1 = *(long *)(this + 0x10);
          IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar1 + 0x388) + 0x58),0x2b);
          piVar2 = (int *)(lVar1 + 0x24c);
          *piVar2 = *piVar2 + (int)uVar5;
          local_48 = local_48 + (int)local_40;
          param_2 = local_44;
        }
      }
    }
    lVar8 = lVar8 + 1;
  } while (lVar8 != 8);
  return;
}



// IOAccelEventMachineFast2::testEventExcluding(IOAccelEvent*, int)

byte __thiscall
IOAccelEventMachineFast2::testEventExcluding
          (IOAccelEventMachineFast2 *this,long param_1,int param_2)

{
  int iVar1;
  undefined8 uVar2;
  bool bVar3;
  ulong uVar4;
  int iVar5;
  long lVar6;
  
  bVar3 = true;
  uVar4 = 0;
  do {
    uVar2 = *(undefined8 *)(param_1 + uVar4 * 8);
    iVar5 = (int)uVar2;
    if ((iVar5 != -1) && (iVar5 != param_2)) {
      lVar6 = (long)iVar5;
      iVar5 = (int)((ulong)uVar2 >> 0x20);
      if ((0 < iVar5 - *(int *)(this + lVar6 * 0x18 + 0xf8)) &&
         (iVar1 = **(int **)(*(long *)(this + 0x28) + lVar6 * 8),
         *(int *)(this + lVar6 * 0x18 + 0xf8) = iVar1, 0 < iVar5 - iVar1)) break;
    }
    bVar3 = uVar4 < 7;
    uVar4 = uVar4 + 1;
  } while (uVar4 != 8);
  return ~bVar3 & 1;
}



// IOAccelEventMachineFast2::waitForAnyStamp(IOAccelEvent*, int*)

undefined8 __thiscall
IOAccelEventMachineFast2::waitForAnyStamp(IOAccelEventMachineFast2 *this,long param_1,int *param_2)

{
  ulong uVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  uintptr_t uVar5;
  long lVar6;
  ulong uVar7;
  int iVar8;
  undefined8 uVar9;
  undefined8 local_e8;
  int *local_e0 [8];
  undefined1 *local_a0;
  int iStack_9c;
  undefined1 *local_98;
  undefined1 *local_90;
  undefined1 *local_88;
  undefined8 local_80;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined8 local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  long local_38;
  
  local_38 = *(long *)PTR____stack_chk_guard_0006b0b0;
  local_e8 = 0;
  local_58 = &DAT_aaaaaaaaaaaaaaaa;
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_78 = &DAT_aaaaaaaaaaaaaaaa;
  local_70 = &DAT_aaaaaaaaaaaaaaaa;
  local_68 = &DAT_aaaaaaaaaaaaaaaa;
  local_60 = &DAT_aaaaaaaaaaaaaaaa;
  local_98 = &DAT_aaaaaaaaaaaaaaaa;
  local_90 = &DAT_aaaaaaaaaaaaaaaa;
  local_88 = &DAT_aaaaaaaaaaaaaaaa;
  local_80 = &DAT_aaaaaaaaaaaaaaaa;
  local_a0 = &DAT_aaaaaaaaaaaaaaaa;
  local_e0[7] = (int *)&DAT_aaaaaaaaaaaaaaaa;
  local_e0[6] = (int *)&DAT_aaaaaaaaaaaaaaaa;
  local_e0[5] = (int *)&DAT_aaaaaaaaaaaaaaaa;
  local_e0[4] = (int *)&DAT_aaaaaaaaaaaaaaaa;
  local_e0[3] = (int *)&DAT_aaaaaaaaaaaaaaaa;
  local_e0[2] = (int *)&DAT_aaaaaaaaaaaaaaaa;
  local_e0[1] = (int *)&DAT_aaaaaaaaaaaaaaaa;
  if (*(int *)(*(long *)(this + 0x10) + 0xdc8) == 0) {
    local_e0[0] = param_2;
    uVar5 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85020055,0xffffffffffffffff,0xffffffffffffffff,uVar5,0,0);
    uVar7 = 1;
    while( true ) {
      uVar1 = *(ulong *)(param_1 + -8 + uVar7 * 8);
      *(int *)((long)&local_80 + uVar7 * 4 + 4) = (int)(uVar1 >> 0x20);
      if ((int)uVar1 == -1) break;
      *(int *)((long)&local_60 + uVar7 * 4 + 4) = (int)uVar1;
      piVar2 = *(int **)(*(long *)(this + 0x28) + ((long)(uVar1 << 0x20) >> 0x1d));
      local_e0[uVar7] = piVar2;
      (&iStack_9c)[uVar7] = *piVar2 + -1;
      _IOLockLock(*(undefined8 *)(this + 0x50));
      lVar6 = (long)(uVar1 << 0x20) >> 0x1e;
      iVar4 = *(int *)(*(long *)(this + 0x48) + lVar6);
      *(int *)(*(long *)(this + 0x48) + lVar6) = iVar4 + 1;
      if (iVar4 == 0) {
        (**(code **)(*(long *)this + 0x240))(this,uVar1 & 0xffffffff);
      }
      _IOLockUnlock(*(undefined8 *)(this + 0x50));
      uVar7 = uVar7 + 1;
      if (uVar7 == 9) {
        iVar4 = 1;
LAB_000320db:
        iVar8 = 1;
        do {
          lVar6 = 0;
          do {
            if (*(int *)((long)&local_98 + lVar6 * 4) != *local_e0[lVar6 + 1]) {
              *(int *)((long)&local_98 + lVar6 * 4) = *local_e0[lVar6 + 1];
              _clock_interval_to_deadline(iVar4,1000000000,&local_e8);
            }
            lVar6 = lVar6 + 1;
          } while (lVar6 != 8);
          iVar3 = _assert_wait_deadline(this,0,local_e8);
          lVar6 = 0;
          do {
            if ((*(int *)((long)&local_78 + lVar6 * 4) - *local_e0[lVar6 + 1] < 1) ||
               (*(int *)(*(long *)(this + 0x10) + 0xdc8) != 0)) {
              *local_e0[0] = (int)lVar6;
              _thread_wakeup_prim(this,0,0);
              goto LAB_000322b7;
            }
            lVar6 = lVar6 + 1;
          } while (lVar6 != 8);
          if (iVar3 == -1) {
            iVar3 = _thread_block(0);
          }
          else if (iVar3 == 0) goto LAB_000322b7;
          if (*(int *)(this + 0x94) != 0) {
            lVar6 = 0;
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                              "%s: a graphics error occurred, exitting..\n");
            do {
              iVar4 = *(int *)((long)&local_58 + lVar6 * 4);
              _IOLockLock(*(undefined8 *)(this + 0x50));
              iVar8 = *(int *)(*(long *)(this + 0x48) + (long)iVar4 * 4);
              *(int *)(*(long *)(this + 0x48) + (long)iVar4 * 4) = iVar8 + -1;
              if (iVar8 == 1) {
                (**(code **)(*(long *)this + 0x248))(this,iVar4);
              }
              _IOLockUnlock(*(undefined8 *)(this + 0x50));
              lVar6 = lVar6 + 1;
            } while (lVar6 != 8);
            uVar5 = IORegistryEntry::getRegistryEntryID();
            _kernel_debug(0x85020056,0xffffffffffffffff,0xffffffffffffffff,uVar5,0,0);
            uVar9 = 0xe00002e9;
            goto LAB_0003232a;
          }
          if (iVar3 == 1) {
            lVar6 = 0;
            if (iVar8 != 1) goto LAB_00032360;
            do {
              if (*(int *)((long)&local_98 + lVar6 * 4) != *local_e0[lVar6 + 1]) goto LAB_000320db;
              lVar6 = lVar6 + 1;
            } while (lVar6 != 8);
            iVar8 = *(int *)(*(long *)(this + 0x10) + 0xcf0);
            iVar4 = iVar8 + -1;
            _clock_interval_to_deadline(iVar4,1000000000,&local_e8);
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                              "%s: initial wait for %d second expired. Continue wait for %d seconds.\n"
                              ,
                              "virtual IOReturn IOAccelEventMachineFast2::waitForAnyStamp(sIOAccelEvent *, int32_t *)"
                              ,1,*(int *)(*(long *)(this + 0x10) + 0xcf0) + -1);
          }
          else if (iVar3 == 0) {
            lVar6 = 0;
            do {
              if (*(int *)((long)&local_78 + lVar6 * 4) - *local_e0[lVar6 + 1] < 1)
              goto LAB_00032372;
              lVar6 = lVar6 + 1;
            } while (lVar6 != 8);
          }
        } while( true );
      }
    }
    iVar4 = (int)uVar7 + -1;
    *local_e0[0] = iVar4;
    uVar9 = 0;
    if (0 < iVar4) {
      do {
        iVar4 = *(int *)((long)&local_60 + uVar7 * 4);
        _IOLockLock(*(undefined8 *)(this + 0x50));
        iVar8 = *(int *)(*(long *)(this + 0x48) + (long)iVar4 * 4);
        *(int *)(*(long *)(this + 0x48) + (long)iVar4 * 4) = iVar8 + -1;
        if (iVar8 == 1) {
          (**(code **)(*(long *)this + 0x248))(this,iVar4);
        }
        _IOLockUnlock(*(undefined8 *)(this + 0x50));
        uVar7 = uVar7 - 1;
        uVar9 = 0;
      } while (1 < uVar7);
    }
  }
  else {
    *param_2 = 0;
    uVar9 = 0;
  }
  goto LAB_0003232a;
LAB_00032372:
  *local_e0[0] = (int)lVar6;
LAB_000322b7:
  lVar6 = 0;
  do {
    iVar4 = *(int *)((long)&local_58 + lVar6 * 4);
    _IOLockLock(*(undefined8 *)(this + 0x50));
    iVar8 = *(int *)(*(long *)(this + 0x48) + (long)iVar4 * 4);
    *(int *)(*(long *)(this + 0x48) + (long)iVar4 * 4) = iVar8 + -1;
    if (iVar8 == 1) {
      (**(code **)(*(long *)this + 0x248))(this,iVar4);
    }
    _IOLockUnlock(*(undefined8 *)(this + 0x50));
    lVar6 = lVar6 + 1;
  } while (lVar6 != 8);
  uVar5 = IORegistryEntry::getRegistryEntryID();
  _kernel_debug(0x85020056,0xffffffffffffffff,0xffffffffffffffff,uVar5,0,0);
  uVar9 = 0;
  goto LAB_0003232a;
  while (lVar6 = lVar6 + 1, lVar6 != 8) {
LAB_00032360:
    if (*(int *)((long)&local_78 + lVar6 * 4) - *local_e0[lVar6 + 1] < 1) goto LAB_00032372;
  }
  lVar6 = 0;
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: timeout waiting for any stamp\n");
  do {
    iVar4 = *(int *)((long)&local_58 + lVar6 * 4);
    _IOLockLock(*(undefined8 *)(this + 0x50));
    iVar8 = *(int *)(*(long *)(this + 0x48) + (long)iVar4 * 4);
    *(int *)(*(long *)(this + 0x48) + (long)iVar4 * 4) = iVar8 + -1;
    if (iVar8 == 1) {
      (**(code **)(*(long *)this + 0x248))(this,iVar4);
    }
    _IOLockUnlock(*(undefined8 *)(this + 0x50));
    lVar6 = lVar6 + 1;
  } while (lVar6 != 8);
  uVar5 = IORegistryEntry::getRegistryEntryID();
  _kernel_debug(0x85020056,0xffffffffffffffff,0xffffffffffffffff,uVar5,0,0);
  uVar9 = 0xe00002d6;
LAB_0003232a:
  if (*(long *)PTR____stack_chk_guard_0006b0b0 != local_38) {
                    // WARNING: Subroutine does not return
    ___stack_chk_fail();
  }
  return uVar9;
}



// IOAccelEventMachineFast2::setEventStampWait(int, IOAccelEvent*, unsigned int)

void __thiscall
IOAccelEventMachineFast2::setEventStampWait
          (IOAccelEventMachineFast2 *this,uint param_1,long param_2,ulong param_3)

{
  int iVar1;
  undefined4 in_EAX;
  int iVar2;
  long lVar3;
  long lVar4;
  ulong uVar5;
  int iVar6;
  ulong uVar7;
  undefined8 uStack_38;
  
  uVar7 = param_3 & 0xffffffff;
  uVar5 = (ulong)param_1;
  uStack_38 = CONCAT44(0xaaaaaaaa,in_EAX);
  iVar2 = (**(code **)(*(long *)this + 0x2c0))(this,param_2);
  if (iVar2 != 0) {
    do {
      uStack_38 = uStack_38 & 0xffffffff;
      lVar3 = 0;
      do {
        uVar5 = *(ulong *)(param_2 + lVar3 * 8);
        uVar7 = uVar5 >> 0x20;
        lVar4 = (long)(int)uVar5;
        iVar6 = (int)(uVar5 >> 0x20);
        if ((0 < iVar6 - *(int *)(this + lVar4 * 0x18 + 0xf8)) &&
           (iVar1 = **(int **)(*(long *)(this + 0x28) + lVar4 * 8),
           *(int *)(this + lVar4 * 0x18 + 0xf8) = iVar1, 0 < iVar6 - iVar1)) {
          IOAccelEventMachine2::handleFinishChannelRestart
                    ((IOAccelEventMachine2 *)this,iVar2,(int)uVar5,4);
          break;
        }
        lVar3 = lVar3 + 1;
        uStack_38 = CONCAT44((int)lVar3,(undefined4)uStack_38);
      } while (lVar3 != 8);
      iVar2 = (**(code **)(*(long *)this + 0x2c0))(this,param_2,(long)&uStack_38 + 4);
    } while (iVar2 != 0);
  }
  *(ulong *)(param_2 + (long)uStack_38._4_4_ * 8) = uVar5 & 0xffffffff | uVar7 << 0x20;
  return;
}



// IOAccelEventMachineFast2::setEventStamp(int, IOAccelEvent*)

void __thiscall
IOAccelEventMachineFast2::setEventStamp(IOAccelEventMachineFast2 *this,uint param_1,long param_2)

{
  int iVar1;
  undefined8 uVar2;
  long lVar3;
  int iVar4;
  long lVar5;
  
  lVar3 = 0;
  do {
    if ((uint)*(undefined8 *)(param_2 + lVar3 * 8) == param_1) goto LAB_00032628;
    lVar3 = lVar3 + 1;
  } while (lVar3 != 8);
  lVar3 = 0;
  while( true ) {
    uVar2 = *(undefined8 *)(param_2 + lVar3 * 8);
    iVar4 = (int)uVar2;
    if (iVar4 == -1) break;
    lVar5 = (long)iVar4;
    iVar4 = (int)((ulong)uVar2 >> 0x20);
    if ((iVar4 - *(int *)(this + lVar5 * 0x18 + 0xf8) < 1) ||
       (iVar1 = **(int **)(*(long *)(this + 0x28) + lVar5 * 8),
       *(int *)(this + lVar5 * 0x18 + 0xf8) = iVar1, iVar4 - iVar1 < 1)) break;
    lVar3 = lVar3 + 1;
    if (lVar3 == 8) {
      setEventStampWait(this,param_1,param_2,
                        (ulong)*(uint *)(this + (long)(int)param_1 * 0x18 + 0xfc));
      return;
    }
  }
LAB_00032628:
  *(ulong *)(param_2 + lVar3 * 8) =
       CONCAT44(*(undefined4 *)(this + (long)(int)param_1 * 0x18 + 0xfc),param_1);
  return;
}



// IOAccelEventMachineFast2::moveEvent(IOAccelEvent*, IOAccelEvent*)

void __thiscall
IOAccelEventMachineFast2::moveEvent
          (IOAccelEventMachineFast2 *this,undefined8 *param_1,undefined8 *param_2)

{
  undefined8 uVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  undefined8 uVar7;
  
  uVar1 = *param_1;
  uVar2 = param_1[1];
  uVar3 = param_1[2];
  uVar4 = param_1[3];
  uVar5 = param_1[4];
  uVar6 = param_1[5];
  uVar7 = param_1[6];
  param_2[7] = param_1[7];
  param_2[6] = uVar7;
  param_2[5] = uVar6;
  param_2[4] = uVar5;
  param_2[3] = uVar4;
  param_2[2] = uVar3;
  param_2[1] = uVar2;
  *param_2 = uVar1;
                    // WARNING: Could not recover jumptable at 0x00032699. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x148))();
  return;
}



// IOAccelEventMachineFast2::copyEvent(IOAccelEvent*, IOAccelEvent*)

void __thiscall
IOAccelEventMachineFast2::copyEvent(undefined8 param_1_00,undefined8 *param_2,undefined8 *param_3)

{
  undefined8 uVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  undefined8 uVar7;
  
  uVar1 = *param_2;
  uVar2 = param_2[1];
  uVar3 = param_2[2];
  uVar4 = param_2[3];
  uVar5 = param_2[4];
  uVar6 = param_2[5];
  uVar7 = param_2[6];
  param_3[7] = param_2[7];
  param_3[6] = uVar7;
  param_3[5] = uVar6;
  param_3[4] = uVar5;
  param_3[3] = uVar4;
  param_3[2] = uVar3;
  param_3[1] = uVar2;
  *param_3 = uVar1;
  return;
}



// IOAccelEventMachineFast2::mergeEvent(IOAccelEvent*, IOAccelEvent*)

void __thiscall
IOAccelEventMachineFast2::mergeEvent(IOAccelEventMachineFast2 *this,long param_1,long param_2)

{
  int iVar1;
  ulong uVar2;
  ulong uVar3;
  undefined8 uVar4;
  int iVar5;
  int iVar6;
  long lVar7;
  int iVar8;
  long lVar9;
  long lVar10;
  long lVar11;
  int local_34;
  
  lVar11 = 0;
  do {
    uVar2 = *(ulong *)(param_1 + lVar11 * 8);
    iVar5 = (int)uVar2;
    if (iVar5 != -1) {
      lVar7 = (long)iVar5;
      iVar6 = (int)(uVar2 >> 0x20);
      if (0 < iVar6 - *(int *)(this + lVar7 * 0x18 + 0xf8)) {
        lVar10 = *(long *)(this + 0x28);
        iVar8 = **(int **)(lVar10 + lVar7 * 8);
        *(int *)(this + lVar7 * 0x18 + 0xf8) = iVar8;
        if (0 < iVar6 - iVar8) {
          lVar7 = 0;
          do {
            uVar3 = *(ulong *)(param_2 + lVar7 * 8);
            if ((int)uVar3 == iVar5) {
              if (0 < iVar6 - (int)(uVar3 >> 0x20)) {
                *(ulong *)(param_2 + lVar7 * 8) = uVar3 & 0xffffffff | uVar2 & 0xffffffff00000000;
              }
              goto LAB_000328a2;
            }
            lVar7 = lVar7 + 1;
          } while (lVar7 != 8);
          lVar7 = 0;
          do {
            uVar4 = *(undefined8 *)(param_2 + lVar7 * 8);
            iVar5 = (int)uVar4;
            if (iVar5 == -1) {
LAB_0003288a:
              *(ulong *)(param_2 + lVar7 * 8) = uVar2;
              goto LAB_000328a2;
            }
            lVar9 = (long)iVar5;
            iVar5 = (int)((ulong)uVar4 >> 0x20);
            if ((iVar5 - *(int *)(this + lVar9 * 0x18 + 0xf8) < 1) ||
               (iVar6 = **(int **)(lVar10 + lVar9 * 8), *(int *)(this + lVar9 * 0x18 + 0xf8) = iVar6
               , iVar5 - iVar6 < 1)) goto LAB_0003288a;
            lVar7 = lVar7 + 1;
          } while (lVar7 != 8);
          local_34 = -1;
LAB_000327e9:
          iVar5 = (**(code **)(*(long *)this + 0x2c0))(this,param_2,&local_34);
          if (iVar5 != 0) {
            local_34 = 0;
            lVar7 = 0;
            do {
              uVar4 = *(undefined8 *)(param_2 + lVar7 * 8);
              iVar6 = (int)uVar4;
              lVar10 = (long)iVar6;
              iVar8 = (int)((ulong)uVar4 >> 0x20);
              if ((0 < iVar8 - *(int *)(this + lVar10 * 0x18 + 0xf8)) &&
                 (iVar1 = **(int **)(*(long *)(this + 0x28) + lVar10 * 8),
                 *(int *)(this + lVar10 * 0x18 + 0xf8) = iVar1, 0 < iVar8 - iVar1)) {
                IOAccelEventMachine2::handleFinishChannelRestart
                          ((IOAccelEventMachine2 *)this,iVar5,iVar6,5);
                break;
              }
              lVar7 = lVar7 + 1;
              local_34 = (int)lVar7;
            } while (lVar7 != 8);
            goto LAB_000327e9;
          }
          *(ulong *)(param_2 + (long)local_34 * 8) = uVar2;
        }
      }
    }
LAB_000328a2:
    lVar11 = lVar11 + 1;
    if (lVar11 == 8) {
      return;
    }
  } while( true );
}



// IOAccelEventMachineFast2::copyEventExcluding(IOAccelEvent*, IOAccelEvent*, int)

void __thiscall
IOAccelEventMachineFast2::copyEventExcluding
          (IOAccelEventMachineFast2 *this,long param_1,long param_2,int param_3)

{
  undefined8 uVar1;
  char cVar2;
  long lVar3;
  int iVar4;
  int iVar5;
  long lVar6;
  
  (**(code **)(*(long *)this + 0x148))(this,param_2);
  cVar2 = (**(code **)(*(long *)this + 0x1a0))(this,param_1,param_3);
  if (cVar2 == '\0') {
    lVar3 = 0;
    iVar4 = 0;
    do {
      uVar1 = *(undefined8 *)(param_1 + lVar3 * 8);
      iVar5 = (int)uVar1;
      if ((iVar5 != -1) && (iVar5 != param_3)) {
        lVar6 = (long)iVar4;
        iVar4 = iVar4 + 1;
        *(undefined8 *)(param_2 + lVar6 * 8) = uVar1;
      }
      lVar3 = lVar3 + 1;
    } while (lVar3 != 8);
  }
                    // WARNING: Could not recover jumptable at 0x00032933. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 400))(this,param_2);
  return;
}



// IOAccelEventMachineFast2::mergeEventExcluding(IOAccelEvent*, IOAccelEvent*, int)

void __thiscall
IOAccelEventMachineFast2::mergeEventExcluding
          (IOAccelEventMachineFast2 *this,long param_1,long param_2,int param_3)

{
  int iVar1;
  ulong uVar2;
  ulong uVar3;
  undefined8 uVar4;
  char cVar5;
  int iVar6;
  undefined8 in_RAX;
  long lVar7;
  int iVar8;
  long lVar9;
  int iVar10;
  long lVar11;
  int local_34;
  
  local_34 = (int)((ulong)in_RAX >> 0x20);
  cVar5 = (**(code **)(*(long *)this + 0x1a0))(this,param_1,param_3);
  if (cVar5 == '\0') {
    local_34 = -0x55555556;
    lVar11 = 0;
    do {
      uVar2 = *(ulong *)(param_1 + lVar11 * 8);
      iVar6 = (int)uVar2;
      if ((iVar6 != -1) && (iVar6 != param_3)) {
        local_34 = 0;
        lVar7 = 0;
        do {
          uVar3 = *(ulong *)(param_2 + lVar7 * 8);
          if ((int)uVar3 == iVar6) {
            if (0 < (int)(uVar2 >> 0x20) - (int)(uVar3 >> 0x20)) {
              *(ulong *)(param_2 + lVar7 * 8) = uVar3 & 0xffffffff | uVar2 & 0xffffffff00000000;
            }
            goto LAB_00032ad7;
          }
          lVar7 = lVar7 + 1;
          local_34 = (int)lVar7;
        } while (lVar7 != 8);
        local_34 = 0;
        lVar7 = 0;
        do {
          uVar4 = *(undefined8 *)(param_2 + lVar7 * 8);
          iVar6 = (int)uVar4;
          if (iVar6 == -1) {
LAB_00032ad3:
            *(ulong *)(param_2 + lVar7 * 8) = uVar2;
            goto LAB_00032ad7;
          }
          lVar9 = (long)iVar6;
          iVar6 = (int)((ulong)uVar4 >> 0x20);
          if ((iVar6 - *(int *)(this + lVar9 * 0x18 + 0xf8) < 1) ||
             (iVar8 = **(int **)(*(long *)(this + 0x28) + lVar9 * 8),
             *(int *)(this + lVar9 * 0x18 + 0xf8) = iVar8, iVar6 - iVar8 < 1)) goto LAB_00032ad3;
          lVar7 = lVar7 + 1;
          local_34 = (int)lVar7;
        } while (lVar7 != 8);
LAB_00032a89:
        iVar6 = (**(code **)(*(long *)this + 0x2c0))(this,param_2,&local_34);
        if (iVar6 != 0) {
          local_34 = 0;
          lVar7 = 0;
          do {
            uVar4 = *(undefined8 *)(param_2 + lVar7 * 8);
            iVar8 = (int)uVar4;
            lVar9 = (long)iVar8;
            iVar10 = (int)((ulong)uVar4 >> 0x20);
            if ((0 < iVar10 - *(int *)(this + lVar9 * 0x18 + 0xf8)) &&
               (iVar1 = **(int **)(*(long *)(this + 0x28) + lVar9 * 8),
               *(int *)(this + lVar9 * 0x18 + 0xf8) = iVar1, 0 < iVar10 - iVar1)) {
              IOAccelEventMachine2::handleFinishChannelRestart
                        ((IOAccelEventMachine2 *)this,iVar6,iVar8,6);
              break;
            }
            lVar7 = lVar7 + 1;
            local_34 = (int)lVar7;
          } while (lVar7 != 8);
          goto LAB_00032a89;
        }
        *(ulong *)(param_2 + (long)local_34 * 8) = uVar2;
      }
LAB_00032ad7:
      lVar11 = lVar11 + 1;
    } while (lVar11 != 8);
  }
  (**(code **)(*(long *)this + 400))(this,param_2);
  return;
}



// IOAccelEventMachineFast2::checkGPUProgress()

void __thiscall IOAccelEventMachineFast2::checkGPUProgress(IOAccelEventMachineFast2 *this)

{
  int iVar1;
  char cVar2;
  long lVar3;
  ulong uVar4;
  IOAccelEventMachineFast2 *pIVar5;
  undefined1 *local_40;
  long local_38;
  
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = 0;
  if (0 < *(int *)(this + 0x30)) {
    pIVar5 = this + 0xf0;
    uVar4 = 0;
    do {
      iVar1 = **(int **)(*(long *)(this + 0x28) + uVar4 * 8);
      if (*(int *)(pIVar5 + 0x14) - iVar1 < 1) {
        lVar3 = 0;
LAB_00032c0d:
        *(long *)pIVar5 = lVar3;
      }
      else {
        if (local_38 == 0) {
          _clock_get_uptime(&local_40);
          _absolutetime_to_nanoseconds(local_40,&local_38);
        }
        if ((*(long *)pIVar5 == 0) || (iVar1 != *(int *)(pIVar5 + 0x10))) {
          *(int *)(pIVar5 + 0x10) = iVar1;
          lVar3 = local_38;
          goto LAB_00032c0d;
        }
        if (*(uint *)(*(long *)(this + 0x10) + 0xcf0) <=
            (uint)((ulong)(local_38 - *(long *)pIVar5) / 1000000000)) {
          cVar2 = IOAccelDisplayMachine::waitForStampTimeout
                            (*(IOAccelDisplayMachine **)(*(long *)(this + 0x10) + 0x378),(int)uVar4)
          ;
          if (cVar2 == '\0') {
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                              "%s - Signaling hardware error on channel %d..\n",
                              "virtual void IOAccelEventMachineFast2::checkGPUProgress()",
                              uVar4 & 0xffffffff);
            IOAccelEventMachine2::signalHardwareError((IOAccelEventMachine2 *)this,2,(int)uVar4);
            lVar3 = local_38;
            goto LAB_00032c0d;
          }
        }
      }
      uVar4 = uVar4 + 1;
      pIVar5 = pIVar5 + 0x18;
    } while ((long)uVar4 < (long)*(int *)(this + 0x30));
    if (((*(byte *)(*(long *)(this + 0x10) + 0xc92) & 8) == 0) && (local_38 != 0)) {
      IOAccelEventMachine2::startHardwareProgressTimer((IOAccelEventMachine2 *)this);
    }
  }
  return;
}



// IOAccelEventMachineFast2::checkChannelProgress(int)

undefined4 __thiscall
IOAccelEventMachineFast2::checkChannelProgress(IOAccelEventMachineFast2 *this,int param_1)

{
  int iVar1;
  
  iVar1 = **(int **)(*(long *)(this + 0x28) + (long)param_1 * 8);
  return CONCAT31((int3)((uint)iVar1 >> 8),iVar1 != *(int *)(this + (long)param_1 * 0x18 + 0x100));
}



// IOAccelEventMachineFast2::eventTimeout(int)

long * __thiscall IOAccelEventMachineFast2::eventTimeout(IOAccelEventMachineFast2 *this,int param_1)

{
  undefined8 uVar1;
  long *plVar2;
  long lVar3;
  long lVar4;
  int iVar5;
  int iVar6;
  long *plVar7;
  long *plVar8;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelChannelList::Iterator::Iterator
            ((Iterator *)&local_48,(undefined8 *)(*(long *)(this + 0x10) + 0xc38));
  plVar2 = (long *)IOAccelChannelList::Iterator::getNextChannel((Iterator *)&local_48);
  iVar6 = 0;
  if (plVar2 == (long *)0x0) {
    plVar7 = (long *)0x0;
  }
  else {
    plVar7 = (long *)0x0;
    do {
      lVar3 = (**(code **)(*plVar2 + 0x120))(plVar2);
      if (lVar3 != 0) {
        lVar4 = 0;
        plVar8 = plVar7;
        do {
          uVar1 = *(undefined8 *)(lVar3 + lVar4 * 8);
          plVar7 = plVar8;
          iVar5 = iVar6;
          if (((int)uVar1 == param_1) &&
             (iVar5 = (int)((ulong)uVar1 >> 0x20), plVar7 = plVar2, iVar6 - iVar5 < 1 && iVar6 != 0)
             ) {
            plVar7 = plVar8;
            iVar5 = iVar6;
          }
          iVar6 = iVar5;
          lVar4 = lVar4 + 1;
          plVar8 = plVar7;
        } while (lVar4 != 8);
      }
      plVar2 = (long *)IOAccelChannelList::Iterator::getNextChannel((Iterator *)&local_48);
    } while (plVar2 != (long *)0x0);
  }
  return plVar7;
}



// IOAccelEventMachineFast2::deviceTerminatedUnlocked()

void __thiscall IOAccelEventMachineFast2::deviceTerminatedUnlocked(IOAccelEventMachineFast2 *this)

{
  long lVar1;
  undefined4 *puVar2;
  int iVar3;
  IOAccelEventMachineFast2 *pIVar4;
  long lVar5;
  
  lVar1 = *(long *)(this + 0x28);
  if (lVar1 != 0) {
    iVar3 = *(int *)(this + 0x30);
    if (0 < iVar3) {
      pIVar4 = this + 0x104;
      lVar5 = 0;
      do {
        puVar2 = *(undefined4 **)(lVar1 + lVar5 * 8);
        if (puVar2 != (undefined4 *)0x0) {
          *puVar2 = *(undefined4 *)pIVar4;
          iVar3 = *(int *)(this + 0x30);
        }
        lVar5 = lVar5 + 1;
        pIVar4 = pIVar4 + 0x18;
      } while (lVar5 < iVar3);
    }
  }
  IOAccelEventMachine2::deviceTerminatedUnlocked((IOAccelEventMachine2 *)this);
  return;
}



// IOAccelEventMachineFast2::getSubmittedStamp(int)

undefined4 __thiscall
IOAccelEventMachineFast2::getSubmittedStamp(IOAccelEventMachineFast2 *this,int param_1)

{
  return *(undefined4 *)(this + (long)param_1 * 0x18 + 0x104);
}



// IOAccelEventMachineFast2::scrubEvent(IOAccelEvent*)

undefined8 __thiscall
IOAccelEventMachineFast2::scrubEvent(IOAccelEventMachineFast2 *this,long param_1)

{
  int iVar1;
  undefined8 uVar2;
  undefined8 in_RAX;
  undefined8 uVar3;
  long lVar4;
  int iVar5;
  long lVar6;
  
  uVar3 = CONCAT71((int7)((ulong)in_RAX >> 8),1);
  lVar4 = 0;
  do {
    uVar2 = *(undefined8 *)(param_1 + lVar4 * 8);
    iVar5 = (int)uVar2;
    if (iVar5 != -1) {
      lVar6 = (long)iVar5;
      iVar5 = (int)((ulong)uVar2 >> 0x20);
      if (((iVar5 - *(int *)(this + lVar6 * 0x18 + 0xf8) < 1) ||
          (iVar1 = **(int **)(*(long *)(this + 0x28) + lVar6 * 8),
          *(int *)(this + lVar6 * 0x18 + 0xf8) = iVar1, iVar5 - iVar1 < 1)) ||
         (*(int *)(*(long *)(this + 0x10) + 0xdc8) != 0)) {
        *(undefined8 *)(param_1 + lVar4 * 8) = 0xffffffff;
      }
      else {
        uVar3 = 0;
      }
    }
    lVar4 = lVar4 + 1;
  } while (lVar4 != 8);
  return uVar3;
}



// IOAccelEventMachineFast2::triage(char**, unsigned long long*)

ulong __thiscall
IOAccelEventMachineFast2::triage
          (undefined8 param_1_00,undefined8 param_2_00,undefined8 param_3,undefined8 param_4,
          undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8,
          IOAccelEventMachineFast2 *this,long *param_10,size_t *param_11,undefined8 param_12,
          undefined8 param_13,undefined8 param_14)

{
  IOGraphicsAccelerator2 *pIVar1;
  uint *puVar2;
  int iVar3;
  uint uVar4;
  ulong uVar5;
  uintptr_t uVar6;
  uint64_t uVar7;
  uint64_t uVar8;
  long *plVar9;
  ulong uVar10;
  long lVar11;
  ulong uVar12;
  undefined8 uVar13;
  undefined8 extraout_XMM0_Qa;
  undefined8 extraout_XMM0_Qa_00;
  undefined8 extraout_XMM0_Qa_01;
  undefined8 extraout_XMM0_Qa_02;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  
  uVar10 = (ulong)*(uint *)(this + 0x90);
  uVar5 = glkBfLog(param_1_00,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,param_10,
                   param_11,"Event Machine:\n    fHWErrorStampIdx: [0x%03x]\nBusy channels:\n",
                   uVar10,param_13,param_14);
  uVar12 = uVar5 & 0xffffffff;
  if ((int)uVar5 == 0) {
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x10);
    iVar3 = _IOLockTryLock(*(undefined8 *)(pIVar1 + 0x88));
    if (iVar3 == 0) {
      if (___ktrace_kernel_enabled != 0) {
        uVar6 = IORegistryEntry::getRegistryEntryID();
        uVar10 = 0;
        param_13 = 0;
        param_14 = 0;
        _kernel_debug(0x8512001c,uVar6,0,0,0,0);
      }
      uVar7 = _mach_absolute_time();
      while( true ) {
        _IOSleep(1);
        iVar3 = _IOLockTryLock(*(undefined8 *)(pIVar1 + 0x88));
        if (iVar3 != 0) break;
        if (___ktrace_kernel_enabled != 0) {
          uVar6 = IORegistryEntry::getRegistryEntryID();
          uVar10 = 0;
          param_13 = 0;
          param_14 = 0;
          _kernel_debug(0x8512001c,uVar6,0,0,0,0);
        }
        uVar8 = _mach_absolute_time();
        if (uVar7 + 1000000000 <= uVar8) {
          uVar5 = glkBfLog(extraout_XMM0_Qa,param_2_00,param_3,param_4,param_5,param_6,param_7,
                           param_8,param_10,param_11,
                           "Channels triage skipped: could not acquire accelerator lock\n",uVar10,
                           param_13,param_14);
          return uVar5;
        }
      }
    }
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    uVar12 = 0;
    uVar13 = (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    uVar5 = glkBfLog(uVar13,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,param_10,
                     param_11,"    [index]: fGPUStamp  | sstamp     | Label and status\n",uVar10,
                     param_13,param_14);
    if ((int)uVar5 == 0) {
      local_48 = &DAT_aaaaaaaaaaaaaaaa;
      local_40 = &DAT_aaaaaaaaaaaaaaaa;
      local_38 = &DAT_aaaaaaaaaaaaaaaa;
      IOAccelChannelList::Iterator::Iterator
                ((Iterator *)&local_48,(undefined8 *)(*(long *)(this + 0x10) + 0xc38));
      plVar9 = (long *)IOAccelChannelList::Iterator::getNextChannel((Iterator *)&local_48);
      uVar13 = extraout_XMM0_Qa_00;
      if (plVar9 != (long *)0x0) {
        do {
          lVar11 = (long)(int)plVar9[4];
          uVar5 = (ulong)*(uint *)(this + lVar11 * 0x18 + 0x104);
          puVar2 = *(uint **)(*(long *)(this + 0x28) + lVar11 * 8);
          if (0 < (int)(*(uint *)(this + lVar11 * 0x18 + 0x104) - *puVar2)) {
            uVar10 = (ulong)*puVar2;
            uVar13 = glkBfLog(uVar13,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,
                              param_10,param_11,"    [0x%03x]: 0x%08x | 0x%08x | ",lVar11,uVar10,
                              uVar5);
            uVar4 = (uint)uVar13;
            if ((uVar4 == 0) &&
               (uVar4 = (**(code **)(*plVar9 + 0x178))(plVar9,param_10,param_11), uVar4 == 0)) {
              uVar13 = glkBfLog(extraout_XMM0_Qa_01,param_2_00,param_3,param_4,param_5,param_6,
                                param_7,param_8,param_10,param_11,"\n",lVar11,uVar10,uVar5);
              uVar4 = (uint)uVar13;
              if (uVar4 == 0) goto LAB_0003303f;
            }
            uVar12 = (ulong)uVar4;
            goto LAB_00033058;
          }
LAB_0003303f:
          plVar9 = (long *)IOAccelChannelList::Iterator::getNextChannel((Iterator *)&local_48);
          uVar13 = extraout_XMM0_Qa_02;
        } while (plVar9 != (long *)0x0);
        uVar12 = 0;
      }
LAB_00033058:
      pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x10);
      (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar1);
      _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
    }
    else {
      uVar12 = uVar5 & 0xffffffff;
      pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x10);
      (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar1);
      _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
    }
  }
  return uVar12;
}



// IOAccelEventMachineFast2::_RESERVEDIOAccelEventMachineFast0()

void IOAccelEventMachineFast2::_RESERVEDIOAccelEventMachineFast0(void)

{
  OSMetaClass::reservedCalled(0x824f8);
  return;
}



// IOAccelEventMachineFast2::_RESERVEDIOAccelEventMachineFast1()

void IOAccelEventMachineFast2::_RESERVEDIOAccelEventMachineFast1(void)

{
  OSMetaClass::reservedCalled(0x824f8);
  return;
}



// IOAccelEventMachineFast2::_RESERVEDIOAccelEventMachineFast2()

void IOAccelEventMachineFast2::_RESERVEDIOAccelEventMachineFast2(void)

{
  OSMetaClass::reservedCalled(0x824f8);
  return;
}



// IOAccelEventMachineFast2::_RESERVEDIOAccelEventMachineFast3()

void IOAccelEventMachineFast2::_RESERVEDIOAccelEventMachineFast3(void)

{
  OSMetaClass::reservedCalled(0x824f8);
  return;
}



// IOAccelEventMachineFast2::_RESERVEDIOAccelEventMachineFast4()

void IOAccelEventMachineFast2::_RESERVEDIOAccelEventMachineFast4(void)

{
  OSMetaClass::reservedCalled(0x824f8);
  return;
}



// IOAccelEventMachineFast2::_RESERVEDIOAccelEventMachineFast5()

void IOAccelEventMachineFast2::_RESERVEDIOAccelEventMachineFast5(void)

{
  OSMetaClass::reservedCalled(0x824f8);
  return;
}



// IOAccelEventMachineFast2::MetaClass::~MetaClass()

void __thiscall IOAccelEventMachineFast2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelEventMachine2::collectAllLiveEventIfNeeded()

void IOAccelEventMachine2::collectAllLiveEventIfNeeded(void)

{
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelEventMachineFast_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelEventMachineFast2::gMetaClass,"IOAccelEventMachineFast2",
             (OSMetaClass *)&IOAccelEventMachine2::gMetaClass,0xd30);
  _gMetaClass = &PTR__MetaClass_00079c50;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelEventMachineFast2::gMetaClass);
  return;
}



// IOAccelLegacyDisplayPipe::MetaClass::MetaClass()

void __thiscall IOAccelLegacyDisplayPipe::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelLegacyDisplayPipe",
             (OSMetaClass *)&IOAccelDisplayPipe::gMetaClass,0x380);
  *(undefined ***)this = &PTR__MetaClass_0007a750;
  return;
}



// IOAccelLegacyDisplayPipe::MetaClass::~MetaClass()

void __thiscall IOAccelLegacyDisplayPipe::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelLegacyDisplayPipe::IOAccelLegacyDisplayPipe(OSMetaClass const*)

void __thiscall
IOAccelLegacyDisplayPipe::IOAccelLegacyDisplayPipe
          (IOAccelLegacyDisplayPipe *this,OSMetaClass *param_1)

{
  IOAccelDisplayPipe::IOAccelDisplayPipe((IOAccelDisplayPipe *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelLegacyDisplayPipe_00079d48;
  return;
}



// IOAccelLegacyDisplayPipe::IOAccelLegacyDisplayPipe(OSMetaClass const*)

void __thiscall
IOAccelLegacyDisplayPipe::IOAccelLegacyDisplayPipe
          (IOAccelLegacyDisplayPipe *this,OSMetaClass *param_1)

{
  IOAccelDisplayPipe::IOAccelDisplayPipe((IOAccelDisplayPipe *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelLegacyDisplayPipe_00079d48;
  return;
}



// IOAccelLegacyDisplayPipe::~IOAccelLegacyDisplayPipe()

void __thiscall IOAccelLegacyDisplayPipe::~IOAccelLegacyDisplayPipe(IOAccelLegacyDisplayPipe *this)

{
  IOAccelDisplayPipe::~IOAccelDisplayPipe((IOAccelDisplayPipe *)this);
  return;
}



// IOAccelLegacyDisplayPipe::~IOAccelLegacyDisplayPipe()

void __thiscall IOAccelLegacyDisplayPipe::~IOAccelLegacyDisplayPipe(IOAccelLegacyDisplayPipe *this)

{
  IOAccelDisplayPipe::~IOAccelDisplayPipe((IOAccelDisplayPipe *)this);
  return;
}



// IOAccelLegacyDisplayPipe::~IOAccelLegacyDisplayPipe()

void __thiscall IOAccelLegacyDisplayPipe::~IOAccelLegacyDisplayPipe(IOAccelLegacyDisplayPipe *this)

{
  IOAccelDisplayPipe::~IOAccelDisplayPipe((IOAccelDisplayPipe *)this);
  _OSObject_typed_operator_delete(&IOAccelLegacyDisplayPipe_ktv,this,0x380);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelLegacyDisplayPipe::operator delete(void*, unsigned long)

void __cdecl IOAccelLegacyDisplayPipe::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelLegacyDisplayPipe_ktv,param_1,param_2);
  return;
}



// IOAccelLegacyDisplayPipe::getMetaClass() const

undefined1 * IOAccelLegacyDisplayPipe::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelLegacyDisplayPipe::MetaClass::MetaClass()

void __thiscall IOAccelLegacyDisplayPipe::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelLegacyDisplayPipe",
             (OSMetaClass *)&IOAccelDisplayPipe::gMetaClass,0x380);
  *(undefined ***)this = &PTR__MetaClass_0007a750;
  return;
}



// IOAccelLegacyDisplayPipe::MetaClass::alloc() const

IOAccelDisplayPipe * IOAccelLegacyDisplayPipe::MetaClass::alloc(void)

{
  IOAccelDisplayPipe *this;
  
  this = (IOAccelDisplayPipe *)_OSObject_typed_operator_new(&IOAccelLegacyDisplayPipe_ktv,0x380);
  IOAccelDisplayPipe::IOAccelDisplayPipe(this,(OSMetaClass *)&IOAccelLegacyDisplayPipe::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelLegacyDisplayPipe_00079d48;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelLegacyDisplayPipe::operator new(unsigned long)

void * __thiscall IOAccelLegacyDisplayPipe::operator_new(IOAccelLegacyDisplayPipe *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelLegacyDisplayPipe_ktv,this);
  return pvVar1;
}



// IOAccelLegacyDisplayPipe::IOAccelLegacyDisplayPipe()

void __thiscall IOAccelLegacyDisplayPipe::IOAccelLegacyDisplayPipe(IOAccelLegacyDisplayPipe *this)

{
  IOAccelDisplayPipe::IOAccelDisplayPipe((IOAccelDisplayPipe *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelLegacyDisplayPipe_00079d48;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelLegacyDisplayPipe::IOAccelLegacyDisplayPipe()

void __thiscall IOAccelLegacyDisplayPipe::IOAccelLegacyDisplayPipe(IOAccelLegacyDisplayPipe *this)

{
  IOAccelDisplayPipe::IOAccelDisplayPipe((IOAccelDisplayPipe *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelLegacyDisplayPipe_00079d48;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelLegacyDisplayPipe::init(IOGraphicsAccelerator2*, IOAccelDisplayMachine*, IOFramebuffer*,
// unsigned int)

ulong __thiscall
IOAccelLegacyDisplayPipe::init
          (IOAccelLegacyDisplayPipe *this,undefined8 param_1,OSMetaClassBase *param_2,
          _func_int_OSObject_ptr_void_ptr_IOFramebuffer_ptr_int_void_ptr *param_3,uint param_4)

{
  ulong uVar1;
  long lVar2;
  ulong uVar3;
  
  uVar1 = IOAccelDisplayPipe::init((IOAccelDisplayPipe *)this,param_1,param_2,param_3,param_4);
  uVar3 = uVar1 & 0xffffffff;
  if ((char)uVar1 != '\0') {
    lVar2 = OSMetaClassBase::safeMetaCast
                      (param_2,(OSMetaClass *)&IOAccelLegacyDisplayMachine::gMetaClass);
    *(long *)(this + 0x318) = lVar2;
    if (lVar2 == *(long *)(this + 0x90)) {
      *(undefined8 *)(this + 0x330) = 0;
    }
    else {
      init();
      uVar3 = 0;
    }
  }
  return uVar3;
}



// IOAccelLegacyDisplayPipe::free()

void IOAccelLegacyDisplayPipe::free(void)

{
  IOAccelDisplayPipe *in_RDI;
  
  IOAccelDisplayPipe::free(in_RDI);
  return;
}



// IOAccelLegacyDisplayPipe::isAcceleratorBacked() const

bool __thiscall IOAccelLegacyDisplayPipe::isAcceleratorBacked(IOAccelLegacyDisplayPipe *this)

{
  return this[0x378] != (IOAccelLegacyDisplayPipe)0x0;
}



// IOAccelLegacyDisplayPipe::getScanoutWidth() const

undefined4 __thiscall IOAccelLegacyDisplayPipe::getScanoutWidth(IOAccelLegacyDisplayPipe *this)

{
  return *(undefined4 *)(this + 0x370);
}



// IOAccelLegacyDisplayPipe::getScanoutHeight() const

undefined4 __thiscall IOAccelLegacyDisplayPipe::getScanoutHeight(IOAccelLegacyDisplayPipe *this)

{
  return *(undefined4 *)(this + 0x374);
}



// IOAccelLegacyDisplayPipe::getBytesPerPixel() const

undefined2 __thiscall IOAccelLegacyDisplayPipe::getBytesPerPixel(IOAccelLegacyDisplayPipe *this)

{
  return *(undefined2 *)(this + 0x296);
}



// IOAccelLegacyDisplayPipe::getStereoMode() const

undefined8 IOAccelLegacyDisplayPipe::getStereoMode(void)

{
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelLegacyDisplayPipe::getDisplayResource(unsigned int) const

undefined8 __cdecl IOAccelLegacyDisplayPipe::getDisplayResource(long param_1)

{
  return *(undefined8 *)(param_1 + 0x330);
}



// IOAccelLegacyDisplayPipe::getFullScreenSurface() const

undefined8 __thiscall IOAccelLegacyDisplayPipe::getFullScreenSurface(IOAccelLegacyDisplayPipe *this)

{
  return *(undefined8 *)(this + 800);
}



// IOAccelLegacyDisplayPipe::getWindowServerFullScreenAssemblySurface() const

undefined8 __thiscall
IOAccelLegacyDisplayPipe::getWindowServerFullScreenAssemblySurface(IOAccelLegacyDisplayPipe *this)

{
  return *(undefined8 *)(this + 0x348);
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelLegacyDisplayPipe::getScanoutResource(unsigned int) const

undefined8 __cdecl IOAccelLegacyDisplayPipe::getScanoutResource(long param_1)

{
  return *(undefined8 *)(param_1 + 0x358);
}



// IOAccelLegacyDisplayPipe::getScanoutSurface() const

undefined8 __thiscall IOAccelLegacyDisplayPipe::getScanoutSurface(IOAccelLegacyDisplayPipe *this)

{
  return *(undefined8 *)(this + 0x338);
}



// IOAccelLegacyDisplayPipe::isMirrored() const

byte __thiscall IOAccelLegacyDisplayPipe::isMirrored(IOAccelLegacyDisplayPipe *this)

{
  return ((byte)this[0x36b] & 0x20) >> 5;
}



// IOAccelLegacyDisplayPipe::isMirrorPrimary() const

byte __thiscall IOAccelLegacyDisplayPipe::isMirrorPrimary(IOAccelLegacyDisplayPipe *this)

{
  return (byte)this[0x36b] >> 7;
}



// IOAccelLegacyDisplayPipe::framebuffer_will_power_off()

void __thiscall IOAccelLegacyDisplayPipe::framebuffer_will_power_off(IOAccelLegacyDisplayPipe *this)

{
  save_scanout_surface(this);
  if (this[0x298] != (IOAccelLegacyDisplayPipe)0x0) {
    save_fullscreen_surface(this);
  }
  IOAccelDisplayPipe::framebuffer_will_power_off((IOAccelDisplayPipe *)this);
  return;
}



// IOAccelLegacyDisplayPipe::save_scanout_surface()

void __thiscall IOAccelLegacyDisplayPipe::save_scanout_surface(IOAccelLegacyDisplayPipe *this)

{
  IOAccelLegacySurface *pIVar1;
  
  if ((this[0x378] != (IOAccelLegacyDisplayPipe)0x0) &&
     (pIVar1 = *(IOAccelLegacySurface **)(this + 0x338), pIVar1 != (IOAccelLegacySurface *)0x0)) {
    *(IOAccelLegacySurface **)(this + 0x340) = pIVar1;
    IOAccelLegacySurface::update_exclusive_scanout_bit(pIVar1,*(uint *)(this + 0x284),'\x01');
    return;
  }
  return;
}



// IOAccelLegacyDisplayPipe::save_fullscreen_surface()

void __thiscall IOAccelLegacyDisplayPipe::save_fullscreen_surface(IOAccelLegacyDisplayPipe *this)

{
  uint uVar1;
  IOAccelLegacySurface *this_00;
  long *plVar2;
  long *plVar3;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  undefined1 *local_28;
  
  this_00 = *(IOAccelLegacySurface **)(this + 800);
  if ((this_00 != (IOAccelLegacySurface *)0x0) &&
     (uVar1 = *(uint *)(this_00 + 0x1390), uVar1 == *(uint *)(this + 0x284))) {
    *(IOAccelLegacySurface **)(this + 0x328) = this_00;
    if (((byte)this_00[0x11b0] & 0x20) != 0) {
      IOAccelLegacySurface::update_exclusive_bit(this_00,(ulong)uVar1,'\x01',0);
      return;
    }
    local_28 = &DAT_aaaaaaaaaaaaaaaa;
    local_30 = &DAT_aaaaaaaaaaaaaaaa;
    local_38 = &DAT_aaaaaaaaaaaaaaaa;
    local_40 = &DAT_aaaaaaaaaaaaaaaa;
    local_48 = &DAT_aaaaaaaaaaaaaaaa;
    local_50 = &DAT_aaaaaaaaaaaaaaaa;
    local_58 = &DAT_aaaaaaaaaaaaaaaa;
    local_60 = &DAT_aaaaaaaaaaaaaaaa;
    plVar2 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
    (**(code **)(*plVar2 + 0x140))(plVar2,&local_60);
    plVar2 = *(long **)(this + 0x330);
    plVar3 = *(long **)(this + 0xe0);
    if (plVar2 == plVar3) {
      plVar2 = (long *)0x0;
    }
    else {
      *(long **)(this + 0x330) = plVar3;
      (**(code **)(*plVar3 + 0x20))();
      (**(code **)(**(long **)(this + 0x330) + 0x170))();
    }
    if (this[0x378] == (IOAccelLegacyDisplayPipe)0x0) {
      (**(code **)(*(long *)this + 0x9d0))(this,&local_60,*(undefined8 *)(this + 0x330),0);
      plVar3 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
      (**(code **)(*plVar3 + 0x1b8))
                (plVar3,&local_60,
                 (ulong)*(byte *)(*(long *)(this + 0x330) + 0x15) * 0x40 +
                 *(long *)(*(long *)(this + 0x330) + 0x38));
      plVar3 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
      (**(code **)(*plVar3 + 0x1b8))
                (plVar3,&local_60,*(long *)(*(long *)(this + 0x330) + 0x40) + 0x38);
    }
    if (plVar2 != (long *)0x0) {
      if (*(long *)(this + 0x330) != 0) {
        plVar3 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
        (**(code **)(*plVar3 + 0x1b8))
                  (plVar3,(ulong)*(byte *)(*(long *)(this + 0x330) + 0x15) * 0x40 +
                          *(long *)(*(long *)(this + 0x330) + 0x38),
                   (ulong)*(byte *)((long)plVar2 + 0x15) * 0x40 + plVar2[7]);
        plVar3 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
        (**(code **)(*plVar3 + 0x1b8))
                  (plVar3,(ulong)*(byte *)(*(long *)(this + 0x330) + 0x15) * 0x40 +
                          *(long *)(*(long *)(this + 0x330) + 0x38),plVar2[8] + 0x38);
      }
      (**(code **)(*plVar2 + 0x178))(plVar2);
      (**(code **)(*plVar2 + 0x28))(plVar2);
    }
  }
  return;
}



// IOAccelLegacyDisplayPipe::framebuffer_did_power_on()

ulong __thiscall IOAccelLegacyDisplayPipe::framebuffer_did_power_on(IOAccelLegacyDisplayPipe *this)

{
  IOAccelLegacySurface *pIVar1;
  ulong uVar2;
  
  uVar2 = IOAccelDisplayPipe::framebuffer_did_power_on((IOAccelDisplayPipe *)this);
  pIVar1 = *(IOAccelLegacySurface **)(this + 0x340);
  if (pIVar1 != (IOAccelLegacySurface *)0x0) {
    *(undefined8 *)(this + 0x340) = 0;
    IOAccelLegacySurface::update_exclusive_scanout_bit(pIVar1,*(uint *)(this + 0x284),'\0');
  }
  if (this[0x298] != (IOAccelLegacyDisplayPipe)0x0) {
    restore_fullscreen_surface(this);
  }
  return uVar2 & 0xffffffff;
}



// IOAccelLegacyDisplayPipe::restore_scanout_surface()

void __thiscall IOAccelLegacyDisplayPipe::restore_scanout_surface(IOAccelLegacyDisplayPipe *this)

{
  IOAccelLegacySurface *pIVar1;
  
  pIVar1 = *(IOAccelLegacySurface **)(this + 0x340);
  if (pIVar1 != (IOAccelLegacySurface *)0x0) {
    *(undefined8 *)(this + 0x340) = 0;
    IOAccelLegacySurface::update_exclusive_scanout_bit(pIVar1,*(uint *)(this + 0x284),'\0');
    return;
  }
  return;
}



// IOAccelLegacyDisplayPipe::restore_fullscreen_surface()

void __thiscall IOAccelLegacyDisplayPipe::restore_fullscreen_surface(IOAccelLegacyDisplayPipe *this)

{
  IOAccelLegacySurface *this_00;
  
  this_00 = *(IOAccelLegacySurface **)(this + 0x328);
  if (this_00 != (IOAccelLegacySurface *)0x0) {
    *(undefined8 *)(this + 0x328) = 0;
    if (((byte)this_00[0x11b0] & 0x20) != 0) {
      IOAccelLegacySurface::update_exclusive_bit(this_00,(ulong)*(uint *)(this + 0x284),'\0',0);
      return;
    }
    *(IOAccelLegacySurface **)(this + 800) = this_00;
    if (this[0x378] == (IOAccelLegacyDisplayPipe)0x0) {
                    // WARNING: Could not recover jumptable at 0x0003378b. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*(long *)this + 0x9c8))(this,*(undefined8 *)(this + 0x330),0);
      return;
    }
  }
  return;
}



// IOAccelLegacyDisplayPipe::framebuffer_terminated()

void __thiscall IOAccelLegacyDisplayPipe::framebuffer_terminated(IOAccelLegacyDisplayPipe *this)

{
  if (this[0x378] != (IOAccelLegacyDisplayPipe)0x0) {
    destroy_scanout_resource(this,*(IOAccelResource2 **)(this + 0x358));
  }
  IOAccelDisplayPipe::framebuffer_terminated((IOAccelDisplayPipe *)this);
  return;
}



// IOAccelLegacyDisplayPipe::destroy_scanout_resource(IOAccelResource2*)

void __thiscall
IOAccelLegacyDisplayPipe::destroy_scanout_resource
          (IOAccelLegacyDisplayPipe *this,IOAccelResource2 *param_1)

{
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 uVar1;
  IOAccelResource2 *pIVar2;
  IOAccelMemory *this_00;
  
  pIVar2 = param_1;
  (**(code **)(*(long *)param_1 + 0x178))(param_1);
  uVar1 = extraout_RDX;
  if (*(long *)(param_1 + 0x40) != 0) {
    IOAccelMemoryMap::finishEvent(*(long *)(param_1 + 0x40),pIVar2,extraout_RDX);
    IOAccelResource2::unmap(param_1);
    uVar1 = extraout_RDX_00;
  }
  this_00 = *(IOAccelMemory **)(param_1 + 0x88);
  if (this_00 != (IOAccelMemory *)0x0) {
    if (((byte)this_00[0xd] & 0x10) == 0) {
      IOAccelMemory::pruneOrphanedMappings(this_00,pIVar2,uVar1);
      this_00 = *(IOAccelMemory **)(param_1 + 0x88);
    }
    *(undefined8 *)(this_00 + 0x38) = 0;
    (**(code **)(*(long *)this_00 + 0x28))();
    *(undefined8 *)(param_1 + 0x88) = 0;
    *(undefined2 *)(*(long *)(param_1 + 0x30) + 0xc) = 0;
  }
  (**(code **)(*(long *)this + 0x998))(this,0,param_1);
  this[0x378] = (IOAccelLegacyDisplayPipe)0x0;
  return;
}



// IOAccelLegacyDisplayPipe::is_safe_for_exclusive()

undefined8 __thiscall
IOAccelLegacyDisplayPipe::is_safe_for_exclusive(IOAccelLegacyDisplayPipe *this)

{
  undefined8 uVar1;
  
  if ((this[0x299] == (IOAccelLegacyDisplayPipe)0x0) &&
     (*(int *)(*(long *)(this + 0x90) + 0x10c) == 0)) {
    uVar1 = CONCAT71((int7)((ulong)*(long *)(this + 0x90) >> 8),
                     this[0x2ac] == (IOAccelLegacyDisplayPipe)0x0);
  }
  else {
    uVar1 = 0;
  }
  return uVar1;
}



// IOAccelLegacyDisplayPipe::surface_will_stop(IOAccelLegacySurface*)

void __thiscall
IOAccelLegacyDisplayPipe::surface_will_stop(IOAccelLegacyDisplayPipe *this,long param_1)

{
  if (*(long *)(this + 0x338) == param_1) {
    *(undefined8 *)(this + 0x338) = 0;
  }
  if (*(long *)(this + 0x340) == param_1) {
    *(undefined8 *)(this + 0x340) = 0;
  }
  if (*(long *)(this + 800) == param_1) {
    *(undefined8 *)(this + 800) = 0;
  }
  if (*(long *)(this + 0x328) == param_1) {
    *(undefined8 *)(this + 0x328) = 0;
  }
  if (*(long *)(this + 0x350) == param_1) {
    *(undefined8 *)(this + 0x350) = 0;
  }
  if (*(long *)(this + 0x348) == param_1) {
    *(undefined8 *)(this + 0x348) = 0;
  }
  return;
}



// IOAccelLegacyDisplayPipe::set_windowserver_scanout_surface(IOAccelLegacySurface*)

void __thiscall
IOAccelLegacyDisplayPipe::set_windowserver_scanout_surface
          (IOAccelLegacyDisplayPipe *this,undefined8 param_1)

{
  *(undefined8 *)(this + 0x350) = param_1;
  return;
}



// IOAccelLegacyDisplayPipe::set_windowserver_fullscreen_assembly_surface(IOAccelLegacySurface*)

void __thiscall
IOAccelLegacyDisplayPipe::set_windowserver_fullscreen_assembly_surface
          (IOAccelLegacyDisplayPipe *this,undefined8 param_1)

{
  *(undefined8 *)(this + 0x348) = param_1;
  return;
}



// IOAccelLegacyDisplayPipe::initScanoutResource(unsigned int, IOAccelResource2*)

void __thiscall
IOAccelLegacyDisplayPipe::initScanoutResource
          (IOAccelLegacyDisplayPipe *this,undefined4 param_1,undefined8 param_2)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = *(code **)(**(long **)(this + 0x318) + 0x8e0);
                    // WARNING: Could not recover jumptable at 0x0003394b. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)
            (*(long **)(this + 0x318),*(undefined4 *)(this + 0x284),param_1,
             *(undefined8 *)(this + 0x98),param_2,UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelLegacyDisplayPipe::destroyScanoutResource(unsigned int, IOAccelResource2*)

void __thiscall
IOAccelLegacyDisplayPipe::destroyScanoutResource
          (IOAccelLegacyDisplayPipe *this,undefined4 param_1,undefined8 param_2)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = *(code **)(**(long **)(this + 0x318) + 0x8e8);
                    // WARNING: Could not recover jumptable at 0x00033979. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)
            (*(long **)(this + 0x318),*(undefined4 *)(this + 0x284),param_1,
             *(undefined8 *)(this + 0x98),param_2,UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelLegacyDisplayPipe::setStereo(IOAccelStereoMode)

void __thiscall
IOAccelLegacyDisplayPipe::setStereo(IOAccelLegacyDisplayPipe *this,undefined4 param_1)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = *(code **)(**(long **)(this + 0x318) + 0x8f0);
                    // WARNING: Could not recover jumptable at 0x0003399d. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)
            (*(long **)(this + 0x318),*(undefined4 *)(this + 0x284),param_1,UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelLegacyDisplayPipe::needsSecondaryFramebufferResources()

void __thiscall
IOAccelLegacyDisplayPipe::needsSecondaryFramebufferResources(IOAccelLegacyDisplayPipe *this)

{
                    // WARNING: Could not recover jumptable at 0x000339af. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0x318) + 0x930))();
  return;
}



// IOAccelLegacyDisplayPipe::isHardwareMirrorOfPipe(IOAccelLegacyDisplayPipe*)

void __thiscall
IOAccelLegacyDisplayPipe::isHardwareMirrorOfPipe
          (IOAccelLegacyDisplayPipe *this,IOAccelDisplayPipe *param_1)

{
  undefined4 uVar1;
  long *plVar2;
  code *UNRECOVERED_JUMPTABLE;
  undefined4 uVar3;
  
  plVar2 = *(long **)(this + 0x318);
  uVar1 = *(undefined4 *)(this + 0x284);
  uVar3 = IOAccelDisplayPipe::getFramebufferIndex(param_1);
  UNRECOVERED_JUMPTABLE = *(code **)(*plVar2 + 0x928);
                    // WARNING: Could not recover jumptable at 0x000339e9. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)(plVar2,uVar1,uVar3,UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelLegacyDisplayPipe::setupFullScreen(IOAccelResource2*, IOAccelResource2*)

void __thiscall
IOAccelLegacyDisplayPipe::setupFullScreen
          (IOAccelLegacyDisplayPipe *this,undefined8 param_1,undefined8 param_2)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = *(code **)(**(long **)(this + 0x318) + 0x8f8);
                    // WARNING: Could not recover jumptable at 0x00033a11. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)
            (*(long **)(this + 0x318),*(undefined4 *)(this + 0x284),param_1,param_2,
             UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelLegacyDisplayPipe::resetFullScreen(IOAccelEvent*, IOAccelResource2*, IOAccelResource2*)

void __thiscall
IOAccelLegacyDisplayPipe::resetFullScreen
          (IOAccelLegacyDisplayPipe *this,undefined8 param_1,undefined8 param_2,undefined8 param_3)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = *(code **)(**(long **)(this + 0x318) + 0x900);
                    // WARNING: Could not recover jumptable at 0x00033a39. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)
            (*(long **)(this + 0x318),param_1,*(undefined4 *)(this + 0x284),param_2,param_3,
             UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelLegacyDisplayPipe::setupScanout(IOAccelResource2*, IOAccelResource2*)

void __thiscall
IOAccelLegacyDisplayPipe::setupScanout
          (IOAccelLegacyDisplayPipe *this,undefined8 param_1,undefined8 param_2)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = *(code **)(**(long **)(this + 0x318) + 0x910);
                    // WARNING: Could not recover jumptable at 0x00033a61. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)
            (*(long **)(this + 0x318),*(undefined4 *)(this + 0x284),param_1,param_2,
             UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelLegacyDisplayPipe::resetScanout(IOAccelEvent*, IOAccelResource2*, IOAccelResource2*)

void __thiscall
IOAccelLegacyDisplayPipe::resetScanout
          (IOAccelLegacyDisplayPipe *this,undefined8 param_1,undefined8 param_2,undefined8 param_3)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = *(code **)(**(long **)(this + 0x318) + 0x918);
                    // WARNING: Could not recover jumptable at 0x00033a89. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)
            (*(long **)(this + 0x318),param_1,*(undefined4 *)(this + 0x284),param_2,param_3,
             UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelLegacyDisplayPipe::submitScanoutFlipBuffer(IOAccelEvent*, unsigned int, IOAccelResource2*,
// IOAccelResource2*)

void __thiscall
IOAccelLegacyDisplayPipe::submitScanoutFlipBuffer
          (IOAccelLegacyDisplayPipe *this,undefined8 param_1,undefined4 param_2,undefined8 param_3,
          undefined8 param_4)

{
                    // WARNING: Could not recover jumptable at 0x00033ab3. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0x318) + 0x920))
            (*(long **)(this + 0x318),param_1,*(undefined4 *)(this + 0x284),param_2,param_3,param_4)
  ;
  return;
}



// IOAccelLegacyDisplayPipe::submitFlipBuffer(IOAccelEvent*, unsigned int, IOAccelResource2*,
// IOAccelResource2*)

void __thiscall
IOAccelLegacyDisplayPipe::submitFlipBuffer
          (IOAccelLegacyDisplayPipe *this,undefined8 param_1,undefined4 param_2,undefined8 param_3,
          undefined8 param_4)

{
                    // WARNING: Could not recover jumptable at 0x00033add. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0x318) + 0x908))
            (*(long **)(this + 0x318),param_1,*(undefined4 *)(this + 0x284),param_2,param_3,param_4)
  ;
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelLegacyDisplayPipe::isCurrentModeAcceleratorBacked()

void __cdecl
IOAccelLegacyDisplayPipe::isCurrentModeAcceleratorBacked
          (long param_1,undefined8 param_2,undefined8 param_3)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = *(code **)(**(long **)(param_1 + 0x318) + 0x938);
                    // WARNING: Could not recover jumptable at 0x00033aff. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)
            (*(long **)(param_1 + 0x318),*(undefined4 *)(param_1 + 0x284),param_3,
             UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelLegacyDisplayPipe::is_current_mode_accelerator_backed()

byte __thiscall
IOAccelLegacyDisplayPipe::is_current_mode_accelerator_backed(IOAccelLegacyDisplayPipe *this)

{
  byte bVar1;
  int iVar2;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  undefined4 local_28;
  undefined4 local_20;
  undefined4 local_1c;
  
  local_1c = 0xaaaaaaaa;
  local_20 = 0xaaaaaaaa;
  iVar2 = (**(code **)(**(long **)(this + 0x98) + 0x9f0))();
  if (iVar2 == 0) {
    local_30 = &DAT_aaaaaaaaaaaaaaaa;
    local_38 = &DAT_aaaaaaaaaaaaaaaa;
    local_40 = &DAT_aaaaaaaaaaaaaaaa;
    local_48 = &DAT_aaaaaaaaaaaaaaaa;
    local_28 = 0xaaaaaaaa;
    iVar2 = (**(code **)(**(long **)(this + 0x98) + 0x9d8))
                      (*(long **)(this + 0x98),local_1c,&local_48);
    bVar1 = (byte)((uint)local_38 >> 0x16) & 1 & iVar2 == 0;
  }
  else {
    bVar1 = 0;
  }
  return bVar1;
}



// IOAccelLegacyDisplayPipe::init_scanout_resource(IOAccelResource2*)

undefined8 __thiscall
IOAccelLegacyDisplayPipe::init_scanout_resource(IOAccelLegacyDisplayPipe *this,long *param_1)

{
  char cVar1;
  long lVar2;
  undefined8 uVar3;
  
  uVar3 = 0;
  lVar2 = (**(code **)(*(long *)this + 0x990))(this,0,param_1);
  if (lVar2 != 0) {
    *(byte *)(lVar2 + 0xc) = *(byte *)(lVar2 + 0xc) | 0x20;
    param_1[0x11] = lVar2;
    cVar1 = (**(code **)(*param_1 + 0x170))(param_1);
    if (cVar1 == '\0') {
      uVar3 = 0;
    }
    else {
      (**(code **)(*param_1 + 0x168))(param_1,0,0);
      *(undefined1 *)(param_1[6] + 0x1c) = 0;
      (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x148))
                (*(long **)(*(long *)(this + 0x88) + 0x380),
                 (ulong)*(byte *)((long)param_1 + 0x15) * 0x40 + param_1[7]);
      (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x148))
                (*(long **)(*(long *)(this + 0x88) + 0x380),
                 (ulong)*(byte *)((long)param_1 + 0x16) * 0x40 + param_1[7]);
      this[0x378] = (IOAccelLegacyDisplayPipe)0x1;
      uVar3 = 1;
    }
  }
  return uVar3;
}



// IOAccelLegacyDisplayPipe::setup_scanout(IOAccelLegacySurface*)

void __thiscall IOAccelLegacyDisplayPipe::setup_scanout(IOAccelLegacyDisplayPipe *this,long param_1)

{
  long *plVar1;
  char cVar2;
  long *plVar3;
  undefined8 uVar4;
  
  if ((*(long *)(this + 0x338) == 0) || (*(long *)(this + 0x338) != param_1)) {
    plVar1 = *(long **)(this + 0x360);
    plVar3 = *(long **)(&DAT_000011c0 + param_1);
    if (plVar3 == (long *)0x0) {
      *(undefined8 *)(this + 0x360) = 0;
      uVar4 = 0;
    }
    else {
      cVar2 = (**(code **)(*plVar3 + 0x170))(plVar3);
      if (cVar2 == '\0') {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: prepare scanout buffer failed\n"
                          ,"void IOAccelLegacyDisplayPipe::setup_scanout(IOAccelLegacySurface *)");
        return;
      }
      *(long **)(this + 0x360) = plVar3;
      (**(code **)(*plVar3 + 0x20))(plVar3);
      uVar4 = *(undefined8 *)(this + 0x360);
    }
    (**(code **)(*(long *)this + 0x9d8))(this,uVar4,0);
    if (plVar1 != (long *)0x0) {
      if (*(long *)(this + 0x360) != 0) {
        plVar3 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
        (**(code **)(*plVar3 + 0x1b8))
                  (plVar3,(ulong)*(byte *)(*(long *)(this + 0x360) + 0x15) * 0x40 +
                          *(long *)(*(long *)(this + 0x360) + 0x38),
                   (ulong)*(byte *)((long)plVar1 + 0x15) * 0x40 + plVar1[7]);
        plVar3 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
        (**(code **)(*plVar3 + 0x1b8))
                  (plVar3,(ulong)*(byte *)(*(long *)(this + 0x360) + 0x15) * 0x40 +
                          *(long *)(*(long *)(this + 0x360) + 0x38),plVar1[8] + 0x38);
      }
      (**(code **)(*plVar1 + 0x178))(plVar1);
      (**(code **)(*plVar1 + 0x28))(plVar1);
    }
    *(long *)(this + 0x338) = param_1;
  }
  return;
}



// IOAccelLegacyDisplayPipe::reset_scanout()

void __thiscall IOAccelLegacyDisplayPipe::reset_scanout(IOAccelLegacyDisplayPipe *this)

{
  long *plVar1;
  long *plVar2;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  undefined1 *local_28;
  
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_58 = &DAT_aaaaaaaaaaaaaaaa;
  local_60 = &DAT_aaaaaaaaaaaaaaaa;
  plVar1 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
  (**(code **)(*plVar1 + 0x140))(plVar1,&local_60);
  plVar1 = *(long **)(this + 0x358);
  plVar2 = *(long **)(this + 0x360);
  if (plVar2 == plVar1) {
    plVar2 = (long *)0x0;
  }
  else {
    *(long **)(this + 0x360) = plVar1;
    (**(code **)(*plVar1 + 0x170))();
    (**(code **)(**(long **)(this + 0x360) + 0x20))();
  }
  plVar1 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
  (**(code **)(*plVar1 + 0x148))(plVar1,&local_60);
  (**(code **)(*(long *)this + 0x9e0))(this,&local_60,*(undefined8 *)(this + 0x360),0);
  plVar1 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
  (**(code **)(*plVar1 + 0x1b8))
            (plVar1,&local_60,
             (ulong)*(byte *)(*(long *)(this + 0x360) + 0x15) * 0x40 +
             *(long *)(*(long *)(this + 0x360) + 0x38));
  plVar1 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
  (**(code **)(*plVar1 + 0x1b8))(plVar1,&local_60,*(long *)(*(long *)(this + 0x360) + 0x40) + 0x38);
  if (plVar2 != (long *)0x0) {
    plVar1 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
    (**(code **)(*plVar1 + 0x1b8))
              (plVar1,(ulong)*(byte *)(*(long *)(this + 0x360) + 0x15) * 0x40 +
                      *(long *)(*(long *)(this + 0x360) + 0x38),
               (ulong)*(byte *)((long)plVar2 + 0x15) * 0x40 + plVar2[7]);
    plVar1 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
    (**(code **)(*plVar1 + 0x1b8))
              (plVar1,(ulong)*(byte *)(*(long *)(this + 0x360) + 0x15) * 0x40 +
                      *(long *)(*(long *)(this + 0x360) + 0x38),plVar2[8] + 0x38);
    (**(code **)(*plVar2 + 0x178))(plVar2);
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  *(undefined8 *)(this + 0x338) = 0;
  return;
}



// IOAccelLegacyDisplayPipe::setup_fullscreen(IOAccelLegacySurface*)

void __thiscall
IOAccelLegacyDisplayPipe::setup_fullscreen(IOAccelLegacyDisplayPipe *this,long param_1)

{
  long *plVar1;
  char cVar2;
  long *plVar3;
  
  if (this[0x298] == (IOAccelLegacyDisplayPipe)0x0) goto LAB_00034071;
  plVar1 = *(long **)(this + 0x330);
  if (*(long **)(&DAT_000011c0 + param_1) == (long *)0x0) {
LAB_00033fb2:
    *(undefined8 *)(this + 0x330) = 0;
  }
  else {
    cVar2 = (**(code **)(**(long **)(&DAT_000011c0 + param_1) + 0x170))();
    plVar3 = *(long **)(&DAT_000011c0 + param_1);
    if (cVar2 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to prepare resource %p.\n",
                        "void IOAccelLegacyDisplayPipe::setup_fullscreen(IOAccelLegacySurface *)");
      goto LAB_00033fb2;
    }
    *(long **)(this + 0x330) = plVar3;
    (**(code **)(*plVar3 + 0x20))(plVar3);
  }
  if ((this[0x378] == (IOAccelLegacyDisplayPipe)0x0) && (*(long *)(this + 800) == 0)) {
    (**(code **)(*(long *)this + 0x9c8))(this,*(undefined8 *)(this + 0x330),0);
  }
  if (plVar1 != (long *)0x0) {
    if (*(long *)(this + 0x330) != 0) {
      plVar3 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
      (**(code **)(*plVar3 + 0x1b8))
                (plVar3,(ulong)*(byte *)(*(long *)(this + 0x330) + 0x15) * 0x40 +
                        *(long *)(*(long *)(this + 0x330) + 0x38),
                 (ulong)*(byte *)((long)plVar1 + 0x15) * 0x40 + plVar1[7]);
      plVar3 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
      (**(code **)(*plVar3 + 0x1b8))
                (plVar3,(ulong)*(byte *)(*(long *)(this + 0x330) + 0x15) * 0x40 +
                        *(long *)(*(long *)(this + 0x330) + 0x38),plVar1[8] + 0x38);
    }
    (**(code **)(*plVar1 + 0x178))(plVar1);
    (**(code **)(*plVar1 + 0x28))(plVar1);
  }
LAB_00034071:
  *(long *)(this + 800) = param_1;
  return;
}



// IOAccelLegacyDisplayPipe::reset_fullscreen(bool)

void __thiscall
IOAccelLegacyDisplayPipe::reset_fullscreen(IOAccelLegacyDisplayPipe *this,char param_1)

{
  long *plVar1;
  long *plVar2;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  
  if (this[0x298] != (IOAccelLegacyDisplayPipe)0x0) {
    local_30 = &DAT_aaaaaaaaaaaaaaaa;
    local_38 = &DAT_aaaaaaaaaaaaaaaa;
    local_40 = &DAT_aaaaaaaaaaaaaaaa;
    local_48 = &DAT_aaaaaaaaaaaaaaaa;
    local_50 = &DAT_aaaaaaaaaaaaaaaa;
    local_58 = &DAT_aaaaaaaaaaaaaaaa;
    local_60 = &DAT_aaaaaaaaaaaaaaaa;
    local_68 = &DAT_aaaaaaaaaaaaaaaa;
    plVar2 = *(long **)(this + 800);
    plVar1 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
    (**(code **)(*plVar1 + 0x140))(plVar1,&local_68);
    if (param_1 != '\0') {
      if (*(long *)(this + 0x330) != *(long *)(this + 0xe0)) {
        (**(code **)(*plVar2 + 0x970))(plVar2,&local_68);
        plVar2 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
        (**(code **)(*plVar2 + 0x1b8))
                  (plVar2,&local_68,
                   (ulong)*(byte *)(*(long *)(this + 0x330) + 0x15) * 0x40 +
                   *(long *)(*(long *)(this + 0x330) + 0x38));
        plVar2 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
        (**(code **)(*plVar2 + 0x1b8))
                  (plVar2,&local_68,
                   (ulong)*(byte *)(*(long *)(this + 0xe0) + 0x15) * 0x40 +
                   *(long *)(*(long *)(this + 0xe0) + 0x38));
        plVar2 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
        (**(code **)(*plVar2 + 0x1b8))
                  (plVar2,&local_68,
                   (ulong)*(byte *)(*(long *)(this + 0xe0) + 0x16) * 0x40 +
                   *(long *)(*(long *)(this + 0xe0) + 0x38));
        (**(code **)(**(long **)(this + 0xe0) + 0x168))(*(long **)(this + 0xe0),0,0);
      }
    }
    plVar2 = *(long **)(this + 0x330);
    *(long **)(this + 0x330) = *(long **)(this + 0xe0);
    (**(code **)(**(long **)(this + 0xe0) + 0x20))();
    (**(code **)(**(long **)(this + 0x330) + 0x170))();
    if (this[0x378] == (IOAccelLegacyDisplayPipe)0x0) {
      plVar1 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
      (**(code **)(*plVar1 + 0x148))(plVar1,&local_68);
      (**(code **)(*(long *)this + 0x9d0))(this,&local_68,*(undefined8 *)(this + 0x330),0);
      plVar1 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
      (**(code **)(*plVar1 + 0x1b8))
                (plVar1,&local_68,
                 (ulong)*(byte *)(*(long *)(this + 0x330) + 0x15) * 0x40 +
                 *(long *)(*(long *)(this + 0x330) + 0x38));
      plVar1 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
      (**(code **)(*plVar1 + 0x1b8))
                (plVar1,&local_68,*(long *)(*(long *)(this + 0x330) + 0x40) + 0x38);
    }
    if (plVar2 != (long *)0x0) {
      if (*(long *)(this + 0x330) != 0) {
        plVar1 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
        (**(code **)(*plVar1 + 0x1b8))
                  (plVar1,(ulong)*(byte *)(*(long *)(this + 0x330) + 0x15) * 0x40 +
                          *(long *)(*(long *)(this + 0x330) + 0x38),
                   (ulong)*(byte *)((long)plVar2 + 0x15) * 0x40 + plVar2[7]);
        plVar1 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
        (**(code **)(*plVar1 + 0x1b8))
                  (plVar1,(ulong)*(byte *)(*(long *)(this + 0x330) + 0x15) * 0x40 +
                          *(long *)(*(long *)(this + 0x330) + 0x38),plVar2[8] + 0x38);
      }
      (**(code **)(*plVar2 + 0x178))(plVar2);
      (**(code **)(*plVar2 + 0x28))(plVar2);
    }
  }
  *(undefined8 *)(this + 800) = 0;
  return;
}



// IOAccelLegacyDisplayPipe::submit_scanout_flip(IOAccelEvent*, unsigned int)

void __thiscall
IOAccelLegacyDisplayPipe::submit_scanout_flip
          (IOAccelLegacyDisplayPipe *this,undefined8 param_1,uint param_2)

{
  uint uVar1;
  long *plVar2;
  long lVar3;
  char cVar4;
  uintptr_t uVar5;
  long lVar6;
  long *plVar7;
  ulong uVar8;
  uintptr_t arg4;
  uintptr_t arg3;
  
  plVar2 = *(long **)(this + 0x360);
  if (___ktrace_kernel_enabled != 0) {
    uVar5 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85200010,uVar5,(ulong)*(uint *)(this + 0x284),(ulong)param_2,0,0);
  }
  plVar7 = *(long **)(&DAT_000011c0 + *(long *)(this + 0x338));
  if (plVar7 == (long *)0x0) {
    *(undefined8 *)(this + 0x360) = 0;
  }
  else {
    cVar4 = (**(code **)(*plVar7 + 0x170))(plVar7);
    if (cVar4 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: prepare failed\n",
                        "void IOAccelLegacyDisplayPipe::submit_scanout_flip(IOAccelEvent *, uint32_t)"
                       );
      return;
    }
    (**(code **)(*plVar7 + 0x20))(plVar7);
    *(long **)(this + 0x360) = plVar7;
    (**(code **)(*(long *)this + 0x9b8))
              (this,param_1,*(uint *)((long)&DAT_00001190 + *(long *)(this + 0x338)) & 4 | param_2,
               plVar7);
  }
  if (___ktrace_kernel_enabled == 0) goto LAB_000344a0;
  uVar5 = IORegistryEntry::getRegistryEntryID();
  uVar1 = *(uint *)(this + 0x284);
  lVar3 = *(long *)(this + 0x360);
  if (lVar3 == 0) {
    arg3 = 0;
    arg4 = 0;
  }
  else {
    arg3 = *(uintptr_t *)(lVar3 + 0x110);
    lVar6 = (**(code **)(**(long **)(lVar3 + 0x40) + 0x128))();
    cVar4 = *(char *)(lVar3 + 0x14);
    if (cVar4 == '\0') {
LAB_00034439:
      uVar8 = *(ulong *)(lVar3 + 0xf8);
    }
    else if (cVar4 == -0x7e) {
      uVar8 = (ulong)*(uint *)(lVar3 + 0xfc);
    }
    else {
      if (cVar4 == -0x80) goto LAB_00034439;
      uVar8 = 0;
    }
    arg4 = uVar8 + lVar6;
  }
  _kernel_debug(0x85200014,uVar5,(ulong)uVar1,arg3,arg4,0);
LAB_000344a0:
  if (plVar2 == (long *)0x0) {
    return;
  }
  if (*(long *)(this + 0x360) != 0) {
    plVar7 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
    (**(code **)(*plVar7 + 0x1b8))
              (plVar7,(ulong)*(byte *)(*(long *)(this + 0x360) + 0x15) * 0x40 +
                      *(long *)(*(long *)(this + 0x360) + 0x38),
               (ulong)*(byte *)((long)plVar2 + 0x15) * 0x40 + plVar2[7]);
    plVar7 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
    (**(code **)(*plVar7 + 0x1b8))
              (plVar7,(ulong)*(byte *)(*(long *)(this + 0x360) + 0x15) * 0x40 +
                      *(long *)(*(long *)(this + 0x360) + 0x38),plVar2[8] + 0x38);
  }
  (**(code **)(*plVar2 + 0x178))(plVar2);
                    // WARNING: Could not recover jumptable at 0x00034535. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*plVar2 + 0x28))(plVar2);
  return;
}



// IOAccelLegacyDisplayPipe::submit_flip(IOAccelEvent*, IOAccelLegacyDisplayPipe*, unsigned int)

undefined8 __thiscall
IOAccelLegacyDisplayPipe::submit_flip
          (IOAccelLegacyDisplayPipe *this,undefined8 param_1,IOAccelDisplayPipe *param_2,
          uint param_3)

{
  uint uVar1;
  long *plVar2;
  long lVar3;
  IOAccelLegacySurface *this_00;
  char cVar4;
  uint uVar5;
  int iVar6;
  uintptr_t uVar7;
  long lVar8;
  long *plVar9;
  ulong uVar10;
  uintptr_t arg4;
  undefined8 uVar11;
  uintptr_t arg3;
  
  if (this[0x298] == (IOAccelLegacyDisplayPipe)0x0) {
    return 0;
  }
  plVar2 = *(long **)(this + 0x330);
  if (___ktrace_kernel_enabled != 0) {
    uVar7 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x8520000c,uVar7,(ulong)*(uint *)(this + 0x284),(ulong)param_3,0,0);
  }
  plVar9 = *(long **)(&DAT_000011c0 + *(long *)(param_2 + 800));
  if (plVar9 == (long *)0x0) {
LAB_00034619:
    *(undefined8 *)(this + 0x330) = 0;
  }
  else {
    cVar4 = (**(code **)(*plVar9 + 0x170))(plVar9);
    if (cVar4 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to prepare resource %p\n");
      goto LAB_00034619;
    }
    *(long **)(this + 0x330) = plVar9;
    (**(code **)(*plVar9 + 0x20))(plVar9);
  }
  lVar3 = *(long *)(param_2 + 800);
  if (this[0x378] != (IOAccelLegacyDisplayPipe)0x0) {
    uVar11 = 0;
    if (((lVar3 != 0) && ((*(byte *)((long)&DAT_000011b0 + lVar3 + 1) & 0xc) == 0)) &&
       (uVar11 = 0x10000000, *(char *)(*(long *)(this + 0x88) + 0xcce) == '\0')) {
      this_00 = *(IOAccelLegacySurface **)(this + 0x338);
      uVar5 = IOAccelDisplayPipe::getFramebufferIndex(param_2);
      iVar6 = IOAccelLegacySurface::submitFullScreenUpdate(this_00,uVar5);
      if (iVar6 == 0) {
        IOAccelSurface::flip_buffers(*(IOAccelSurface **)(this + 0x338));
        submit_scanout_flip(this,param_1,param_3);
        uVar11 = 0;
      }
    }
    goto LAB_000347a6;
  }
  uVar5 = *(uint *)((long)&DAT_00001190 + lVar3) & 4 | param_3;
  if (*(long *)(this + 0x330) != 0) {
    (**(code **)(*(long *)this + 0x9c0))(this,param_1,uVar5);
  }
  if (___ktrace_kernel_enabled != 0) {
    uVar7 = IORegistryEntry::getRegistryEntryID();
    uVar1 = *(uint *)(this + 0x284);
    lVar3 = *(long *)(this + 0x330);
    if (lVar3 == 0) {
      arg3 = 0;
      arg4 = 0;
    }
    else {
      arg3 = *(uintptr_t *)(lVar3 + 0x110);
      lVar8 = (**(code **)(**(long **)(lVar3 + 0x40) + 0x128))();
      cVar4 = *(char *)(lVar3 + 0x14);
      if (cVar4 == '\0') {
LAB_00034749:
        uVar10 = *(ulong *)(lVar3 + 0xf8);
      }
      else if (cVar4 == -0x7e) {
        uVar10 = (ulong)*(uint *)(lVar3 + 0xfc);
      }
      else {
        if (cVar4 == -0x80) goto LAB_00034749;
        uVar10 = 0;
      }
      arg4 = uVar10 + lVar8;
    }
    _kernel_debug(0x85200014,uVar7,(ulong)uVar1,arg3,arg4,0);
  }
  uVar11 = 0;
  if (this == (IOAccelLegacyDisplayPipe *)param_2) {
    (**(code **)(**(long **)(param_2 + 800) + 0xa40))
              (*(long **)(param_2 + 800),*(undefined4 *)(this + 0x284),uVar5);
  }
LAB_000347a6:
  if (plVar2 != (long *)0x0) {
    if (*(long *)(this + 0x330) != 0) {
      plVar9 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
      (**(code **)(*plVar9 + 0x1b8))
                (plVar9,(ulong)*(byte *)(*(long *)(this + 0x330) + 0x15) * 0x40 +
                        *(long *)(*(long *)(this + 0x330) + 0x38),
                 (ulong)*(byte *)((long)plVar2 + 0x15) * 0x40 + plVar2[7]);
      plVar9 = (long *)IOAccelDisplayPipe::getEventMachine((IOAccelDisplayPipe *)this);
      (**(code **)(*plVar9 + 0x1b8))
                (plVar9,(ulong)*(byte *)(*(long *)(this + 0x330) + 0x15) * 0x40 +
                        *(long *)(*(long *)(this + 0x330) + 0x38),plVar2[8] + 0x38);
    }
    (**(code **)(*plVar2 + 0x178))(plVar2);
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return uVar11;
}



// IOAccelLegacyDisplayPipe::displayModeWillChange()

void __thiscall IOAccelLegacyDisplayPipe::displayModeWillChange(IOAccelLegacyDisplayPipe *this)

{
  long *plVar1;
  
  IOAccelDisplayPipe::displayModeWillChange((IOAccelDisplayPipe *)this);
  if (*(long **)(this + 0x330) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x330) + 0x178))();
    plVar1 = *(long **)(this + 0x330);
    *(undefined8 *)(this + 0x330) = 0;
    (**(code **)(*plVar1 + 0x28))();
  }
  if (*(long **)(this + 0x360) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x360) + 0x178))();
    plVar1 = *(long **)(this + 0x360);
    *(undefined8 *)(this + 0x360) = 0;
                    // WARNING: Could not recover jumptable at 0x000348b5. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*plVar1 + 0x28))();
    return;
  }
  return;
}



// IOAccelLegacyDisplayPipe::displayModeDidChange()

void __thiscall IOAccelLegacyDisplayPipe::displayModeDidChange(IOAccelLegacyDisplayPipe *this)

{
  IOAccelLegacySurface *pIVar1;
  char cVar2;
  int iVar3;
  uint uVar4;
  long lVar5;
  undefined8 uVar6;
  long *plVar7;
  
  *(undefined8 *)(this + 0x368) = 0;
  iVar3 = IOFramebuffer::getAttributeExt((uint)*(undefined8 *)(this + 0x98),(ulong *)0x6d697272);
  if ((((iVar3 == 0) && (((byte)this[0x36b] & 0x20) != 0)) &&
      (cVar2 = (**(code **)(*(long *)this + 0x9a8))(this), cVar2 == '\0')) &&
     (((byte)this[0x36b] & 0x80) == 0)) {
    return;
  }
  IOAccelDisplayPipe::displayModeDidChange((IOAccelDisplayPipe *)this);
  if (this[0x298] != (IOAccelLegacyDisplayPipe)0x0) {
    plVar7 = *(long **)(this + 0xe0);
    if (plVar7 != (long *)0x0) {
      *(long **)(this + 0x330) = plVar7;
      (**(code **)(*plVar7 + 0x20))();
      (**(code **)(**(long **)(this + 0x330) + 0x170))();
    }
    cVar2 = (**(code **)(*(long *)this + 0x9e8))(this);
    if (cVar2 == '\0') {
      *(undefined4 *)(this + 0x370) = 0;
      uVar4 = 0;
    }
    else {
      plVar7 = *(long **)(this + 0x358);
      if (plVar7 == (long *)0x0) {
        lVar5 = (**(code **)(**(long **)(this + 0x88) + 0x8d0))(*(long **)(this + 0x88),0,0x40);
        *(long *)(this + 0x358) = lVar5;
        if (lVar5 == 0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: Failed to create scanout surface buffer at %d\n",
                            "virtual void IOAccelLegacyDisplayPipe::displayModeDidChange()",
                            *(undefined4 *)(this + 0x284));
          return;
        }
        *(byte *)(lVar5 + 0xc) = *(byte *)(lVar5 + 0xc) | 0x10;
        *(uint *)(*(long *)(this + 0x358) + 0xc) =
             *(uint *)(*(long *)(this + 0x358) + 0xc) & 0xfffeffff;
        IOAccelResource2::updateReadWriteBits(*(IOAccelResource2 **)(this + 0x358),1,'\x01');
        plVar7 = *(long **)(this + 0x358);
      }
      uVar6 = init_scanout_resource(this,plVar7);
      if ((char)uVar6 == '\0') {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Failed to initialize scanout surface buffer at %d\n",
                          "virtual void IOAccelLegacyDisplayPipe::displayModeDidChange()",
                          *(undefined4 *)(this + 0x284));
        return;
      }
      *(long **)(this + 0x360) = *(long **)(this + 0x358);
      (**(code **)(**(long **)(this + 0x358) + 0x20))();
      (**(code **)(**(long **)(this + 0x360) + 0x170))();
      *(uint *)(this + 0x370) = (uint)*(ushort *)(*(long *)(this + 0x358) + 0xb0);
      uVar4 = (uint)*(ushort *)(*(long *)(this + 0x358) + 0xb2);
    }
    *(uint *)(this + 0x374) = uVar4;
  }
  if (this[0x378] == (IOAccelLegacyDisplayPipe)0x0) {
    plVar7 = *(long **)(this + 0x358);
    if (plVar7 != (long *)0x0) {
      *(undefined8 *)(this + 0x358) = 0;
      (**(code **)(*plVar7 + 0x28))();
    }
    *(undefined8 *)(this + 0x340) = 0;
  }
  if (this[0x299] == (IOAccelLegacyDisplayPipe)0x0) {
    if (this[0x298] != (IOAccelLegacyDisplayPipe)0x0) {
      restore_fullscreen_surface(this);
    }
    pIVar1 = *(IOAccelLegacySurface **)(this + 0x340);
    if (pIVar1 != (IOAccelLegacySurface *)0x0) {
      *(undefined8 *)(this + 0x340) = 0;
      IOAccelLegacySurface::update_exclusive_scanout_bit(pIVar1,*(uint *)(this + 0x284),'\0');
      return;
    }
  }
  return;
}



// IOAccelLegacyDisplayPipe::audit_freed_resource(IOAccelResource2*)

void __thiscall
IOAccelLegacyDisplayPipe::audit_freed_resource(IOAccelLegacyDisplayPipe *this,long param_1)

{
  ulong uVar1;
  char *pcVar2;
  undefined8 uVar3;
  
  if (*(long *)(this + 0xe0) == param_1) {
    uVar1 = (ulong)*(uint *)(this + 0x284);
    pcVar2 = 
    "\"Resource 0x%016llx freed while display pipe %d has pointer to it at \" \"fBuffer\" @%s:%d";
    uVar3 = 0x377;
  }
  else if (*(long *)(this + 0x330) == param_1) {
    uVar1 = (ulong)*(uint *)(this + 0x284);
    pcVar2 = 
    "\"Resource 0x%016llx freed while display pipe %d has pointer to it at \" \"fDisplayBuffer\" @%s:%d"
    ;
    uVar3 = 0x378;
  }
  else if (*(long *)(this + 0x358) == param_1) {
    uVar1 = (ulong)*(uint *)(this + 0x284);
    pcVar2 = 
    "\"Resource 0x%016llx freed while display pipe %d has pointer to it at \" \"fScanoutBuffer\" @%s:%d"
    ;
    uVar3 = 0x379;
  }
  else {
    if (*(long *)(this + 0x360) != param_1) {
      return;
    }
    uVar1 = (ulong)*(uint *)(this + 0x284);
    pcVar2 = 
    "\"Resource 0x%016llx freed while display pipe %d has pointer to it at \" \"fScanoutDisplayBuffer\" @%s:%d"
    ;
    uVar3 = 0x37a;
  }
                    // WARNING: Subroutine does not return
  _panic(pcVar2,param_1,uVar1,"IOAccelLegacyDisplayPipe.cpp",uVar3);
}



// IOAccelLegacyDisplayPipe::MetaClass::~MetaClass()

void __thiscall IOAccelLegacyDisplayPipe::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelLegacyDisplayPipe_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelLegacyDisplayPipe::gMetaClass,"IOAccelLegacyDisplayPipe",
             (OSMetaClass *)&IOAccelDisplayPipe::gMetaClass,0x380);
  _gMetaClass = &PTR__MetaClass_0007a750;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelLegacyDisplayPipe::gMetaClass);
  return;
}



// IOAccelSegmentResourceList::MetaClass::MetaClass()

void __thiscall IOAccelSegmentResourceList::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelSegmentResourceList",(OSMetaClass *)PTR_gMetaClass_0006b068
             ,0x58);
  *(undefined ***)this = &PTR__MetaClass_0007a9c8;
  return;
}



// IOAccelSegmentResourceList::MetaClass::~MetaClass()

void __thiscall IOAccelSegmentResourceList::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelSegmentResourceList::IOAccelSegmentResourceList(OSMetaClass const*)

void __thiscall
IOAccelSegmentResourceList::IOAccelSegmentResourceList
          (IOAccelSegmentResourceList *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelSegmentResourceList_0007a848;
  return;
}



// IOAccelSegmentResourceList::IOAccelSegmentResourceList(OSMetaClass const*)

void __thiscall
IOAccelSegmentResourceList::IOAccelSegmentResourceList
          (IOAccelSegmentResourceList *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelSegmentResourceList_0007a848;
  return;
}



// IOAccelSegmentResourceList::~IOAccelSegmentResourceList()

void __thiscall
IOAccelSegmentResourceList::~IOAccelSegmentResourceList(IOAccelSegmentResourceList *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelSegmentResourceList::~IOAccelSegmentResourceList()

void __thiscall
IOAccelSegmentResourceList::~IOAccelSegmentResourceList(IOAccelSegmentResourceList *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelSegmentResourceList::~IOAccelSegmentResourceList()

void __thiscall
IOAccelSegmentResourceList::~IOAccelSegmentResourceList(IOAccelSegmentResourceList *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelSegmentResourceList_ktv,this,0x58);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSegmentResourceList::operator delete(void*, unsigned long)

void __cdecl IOAccelSegmentResourceList::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelSegmentResourceList_ktv,param_1,param_2);
  return;
}



// IOAccelSegmentResourceList::getMetaClass() const

undefined1 * IOAccelSegmentResourceList::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelSegmentResourceList::MetaClass::MetaClass()

void __thiscall IOAccelSegmentResourceList::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelSegmentResourceList",(OSMetaClass *)PTR_gMetaClass_0006b068
             ,0x58);
  *(undefined ***)this = &PTR__MetaClass_0007a9c8;
  return;
}



// IOAccelSegmentResourceList::MetaClass::alloc() const

OSObject * IOAccelSegmentResourceList::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelSegmentResourceList_ktv,0x58);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelSegmentResourceList::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelSegmentResourceList_0007a848;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelSegmentResourceList::operator new(unsigned long)

void * __thiscall IOAccelSegmentResourceList::operator_new(IOAccelSegmentResourceList *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelSegmentResourceList_ktv,this);
  return pvVar1;
}



// IOAccelSegmentResourceList::IOAccelSegmentResourceList()

void __thiscall
IOAccelSegmentResourceList::IOAccelSegmentResourceList(IOAccelSegmentResourceList *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelSegmentResourceList_0007a848;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelSegmentResourceList::IOAccelSegmentResourceList()

void __thiscall
IOAccelSegmentResourceList::IOAccelSegmentResourceList(IOAccelSegmentResourceList *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelSegmentResourceList_0007a848;
  OSMetaClass::instanceConstructed();
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSegmentResourceList::initWithSharedResourceList(IOAccelShared2*,
// IOAccelSegmentResourceListHeader const*)

void __cdecl IOAccelSegmentResourceList::initWithSharedResourceList(long *param_1)

{
                    // WARNING: Could not recover jumptable at 0x00034de4. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*param_1 + 0x130))();
  return;
}



// IOAccelSegmentResourceList::initWithSharedResourceList(IOAccelShared2*,
// IOAccelSegmentResourceListHeader const*, IOAccelDeviceShmem*)

undefined8 __thiscall
IOAccelSegmentResourceList::initWithSharedResourceList
          (IOAccelSegmentResourceList *this,IOAccelShared2 *param_1,long param_2,long *param_3)

{
  ushort uVar1;
  uint uVar2;
  char cVar3;
  uint uVar4;
  int iVar5;
  long lVar6;
  long lVar7;
  undefined8 uVar8;
  ulong uVar9;
  ulong uVar10;
  undefined1 *local_60;
  long local_58;
  long *local_50;
  int local_44;
  ulong local_40;
  int local_34;
  
  local_34 = *(int *)(param_2 + 0x10);
  uVar2 = *(uint *)(param_2 + 0x14);
  lVar6 = (**(code **)(*param_3 + 0x128))(param_3);
  lVar7 = (**(code **)(*param_3 + 0x118))(param_3);
  local_58 = param_2;
  if ((ulong)(lVar7 + lVar6) < (long)(int)uVar2 * 0x58 + param_2 + 0x18U) {
LAB_00034e40:
    lVar6 = *param_3;
LAB_00034f95:
    (**(code **)(lVar6 + 0x120))(param_3);
    uVar8 = 0;
  }
  else {
    uVar4 = uVar2 * 8;
    *(uint *)(this + 0xc) = uVar4;
    if (uVar4 != 0) {
      lVar6 = _IOMallocTypeVarImpl
                        (&initWithSharedResourceList(IOAccelShared2*,IOAccelSegmentResourceListHeader_const*,IOAccelDeviceShmem*)
                          ::kalloc_type_view_49,(ulong)uVar4 << 3);
      *(long *)(this + 0x10) = lVar6;
      if (lVar6 == 0) goto LAB_00034e40;
    }
    if ((ulong)uVar2 != 0) {
      local_60 = &DAT_aaaaaaaaaaaaaaaa;
      local_50 = param_3;
      if ((int)uVar2 < 1) {
        iVar5 = 0;
      }
      else {
        lVar6 = local_58 + 0x18;
        uVar10 = 0;
        iVar5 = 0;
        do {
          uVar1 = *(ushort *)(local_58 + 0x6e + uVar10 * 0x58);
          local_44 = iVar5;
          local_40 = uVar10;
          if (6 < uVar1) goto LAB_00034f8e;
          if (uVar1 == 0) {
            uVar4 = 0;
LAB_00034f2e:
            do {
              *(undefined8 *)(*(long *)(this + 0x10) + (long)(int)(uVar4 | (int)local_40 * 8) * 8) =
                   0;
              uVar4 = uVar4 + 1;
            } while (uVar4 != 8);
          }
          else {
            uVar9 = 0;
            do {
              cVar3 = IOAccelShared2::lookupResource
                                (param_1,*(uint *)(lVar6 + uVar9 * 4),(long *)&local_60);
              if (cVar3 == '\0') goto LAB_00034f8e;
              *(undefined1 **)
               (*(long *)(this + 0x10) + (long)(int)((int)uVar10 * 8 | (uint)uVar9) * 8) = local_60;
              uVar9 = uVar9 + 1;
            } while (uVar1 != uVar9);
            uVar4 = (uint)uVar1;
            if (uVar1 < 8) goto LAB_00034f2e;
          }
          iVar5 = local_44 + (uint)uVar1;
          uVar10 = local_40 + 1;
          lVar6 = lVar6 + 0x58;
        } while (uVar10 != uVar2);
      }
      param_3 = local_50;
      if (iVar5 != local_34) {
LAB_00034f8e:
        lVar6 = *local_50;
        param_3 = local_50;
        goto LAB_00034f95;
      }
    }
    uVar8 = (**(code **)(*param_3 + 0x120))(param_3);
    uVar8 = CONCAT71((int7)((ulong)uVar8 >> 8),1);
  }
  return uVar8;
}



// IOAccelSegmentResourceList::prepare()

ulong __thiscall IOAccelSegmentResourceList::prepare(IOAccelSegmentResourceList *this)

{
  long *plVar1;
  char cVar2;
  ulong uVar3;
  undefined8 unaff_R14;
  ulong uVar4;
  ulong uVar5;
  
  uVar3 = (ulong)*(uint *)(this + 0xc);
  uVar4 = CONCAT71((int7)((ulong)unaff_R14 >> 8),1);
  if (*(uint *)(this + 0xc) != 0) {
    uVar5 = 0;
    do {
      plVar1 = *(long **)(*(long *)(this + 0x10) + uVar5 * 8);
      if (plVar1 != (long *)0x0) {
        cVar2 = (**(code **)(*plVar1 + 0x170))();
        uVar3 = (ulong)*(uint *)(this + 0xc);
        if (cVar2 == '\0') break;
      }
      uVar5 = uVar5 + 1;
    } while (uVar5 < uVar3);
    if ((int)uVar3 != (int)uVar5) {
      if (0 < (int)uVar5) {
        uVar5 = uVar5 + 1;
        do {
          plVar1 = *(long **)(*(long *)(this + 0x10) + (ulong)((int)uVar5 - 2) * 8);
          if (plVar1 != (long *)0x0) {
            (**(code **)(*plVar1 + 0x178))();
          }
          uVar5 = uVar5 - 1;
        } while (1 < uVar5);
      }
      uVar4 = 0;
    }
  }
  return uVar4 & 0xffffffff;
}



// IOAccelSegmentResourceList::complete()

void __thiscall IOAccelSegmentResourceList::complete(IOAccelSegmentResourceList *this)

{
  long *plVar1;
  uint uVar2;
  ulong uVar3;
  
  uVar2 = *(uint *)(this + 0xc);
  if (uVar2 != 0) {
    uVar3 = 0;
    do {
      plVar1 = *(long **)(*(long *)(this + 0x10) + uVar3 * 8);
      if (plVar1 != (long *)0x0) {
        (**(code **)(*plVar1 + 0x178))();
        uVar2 = *(uint *)(this + 0xc);
      }
      uVar3 = uVar3 + 1;
    } while (uVar3 < uVar2);
  }
  return;
}



// IOAccelSegmentResourceList::free()

void __thiscall IOAccelSegmentResourceList::free(IOAccelSegmentResourceList *this)

{
  long lVar1;
  
  lVar1 = *(long *)(this + 0x10);
  if (lVar1 != 0) {
    *(undefined8 *)(this + 0x10) = 0;
    _IOFreeTypeVarImpl(&free()::kalloc_type_view_145,lVar1,(ulong)*(uint *)(this + 0xc) << 3);
  }
                    // WARNING: Could not recover jumptable at 0x000350a7. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelSegmentResourceList::_RESERVEDIOAccelSegmentResourceList0()

void IOAccelSegmentResourceList::_RESERVEDIOAccelSegmentResourceList0(void)

{
  OSMetaClass::reservedCalled(0x82548);
  return;
}



// IOAccelSegmentResourceList::_RESERVEDIOAccelSegmentResourceList1()

void IOAccelSegmentResourceList::_RESERVEDIOAccelSegmentResourceList1(void)

{
  OSMetaClass::reservedCalled(0x82548);
  return;
}



// IOAccelSegmentResourceList::_RESERVEDIOAccelSegmentResourceList2()

void IOAccelSegmentResourceList::_RESERVEDIOAccelSegmentResourceList2(void)

{
  OSMetaClass::reservedCalled(0x82548);
  return;
}



// IOAccelSegmentResourceList::_RESERVEDIOAccelSegmentResourceList3()

void IOAccelSegmentResourceList::_RESERVEDIOAccelSegmentResourceList3(void)

{
  OSMetaClass::reservedCalled(0x82548);
  return;
}



// IOAccelSegmentResourceList::_RESERVEDIOAccelSegmentResourceList4()

void IOAccelSegmentResourceList::_RESERVEDIOAccelSegmentResourceList4(void)

{
  OSMetaClass::reservedCalled(0x82548);
  return;
}



// IOAccelSegmentResourceList::_RESERVEDIOAccelSegmentResourceList5()

void IOAccelSegmentResourceList::_RESERVEDIOAccelSegmentResourceList5(void)

{
  OSMetaClass::reservedCalled(0x82548);
  return;
}



// IOAccelSegmentResourceList::MetaClass::~MetaClass()

void __thiscall IOAccelSegmentResourceList::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelSegmentResourceList_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelSegmentResourceList::gMetaClass,"IOAccelSegmentResourceList",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x58);
  _gMetaClass = &PTR__MetaClass_0007a9c8;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelSegmentResourceList::gMetaClass);
  return;
}



// IOAccelSurface::MetaClass::MetaClass()

void __thiscall IOAccelSurface::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelSurface",(OSMetaClass *)PTR_gMetaClass_0006b018,0x1338);
  *(undefined ***)this = &PTR__MetaClass_0007b510;
  return;
}



// IOAccelSurface::MetaClass::~MetaClass()

void __thiscall IOAccelSurface::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelSurface::IOAccelSurface(OSMetaClass const*)

void __thiscall IOAccelSurface::IOAccelSurface(IOAccelSurface *this,OSMetaClass *param_1)

{
  IOUserClient::IOUserClient((IOUserClient *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelSurface_0007aac0;
  return;
}



// IOAccelSurface::~IOAccelSurface()

void __thiscall IOAccelSurface::~IOAccelSurface(IOAccelSurface *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  return;
}



// IOAccelSurface::~IOAccelSurface()

void __thiscall IOAccelSurface::~IOAccelSurface(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelSurface::~IOAccelSurface()

void __thiscall IOAccelSurface::~IOAccelSurface(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelSurface::getMetaClass() const

undefined1 * IOAccelSurface::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelSurface::MetaClass::MetaClass()

void __thiscall IOAccelSurface::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelSurface",(OSMetaClass *)PTR_gMetaClass_0006b018,0x1338);
  *(undefined ***)this = &PTR__MetaClass_0007b510;
  return;
}



// IOAccelSurface::MetaClass::alloc() const

undefined8 IOAccelSurface::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelSurface::operator new(unsigned long)

void * __thiscall IOAccelSurface::operator_new(IOAccelSurface *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelSurface_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurface::operator delete(void*, unsigned long)

void __cdecl IOAccelSurface::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelSurface_ktv,param_1,param_2);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurface::s_signal_shared_event(IOAccelSurface*, void*, IOExternalMethodArguments*)

void __cdecl
IOAccelSurface::s_signal_shared_event(IOAccelSurface *param_1,undefined8 param_2,long param_3)

{
  long *plVar1;
  
  plVar1 = *(long **)(param_3 + 0x20);
  signal_shared_event(param_1,*plVar1,*(uint *)(plVar1 + 1),plVar1[2]);
  return;
}



// IOAccelSurface::surface_read_lock_options(unsigned int, IOAccelSurfaceInformation*, unsigned long
// long)

void __thiscall
IOAccelSurface::surface_read_lock_options
          (IOAccelSurface *this,undefined4 param_1,undefined8 param_2,undefined8 param_3)

{
                    // WARNING: Could not recover jumptable at 0x0003529a. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0xa20))(this,1,param_1,param_2,param_3);
  return;
}



// IOAccelSurface::surface_read_unlock_options(unsigned int)

void __thiscall IOAccelSurface::surface_read_unlock_options(IOAccelSurface *this,undefined4 param_1)

{
                    // WARNING: Could not recover jumptable at 0x000352b2. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0xa28))(this,1,param_1);
  return;
}



// IOAccelSurface::get_state(eIOAccelSurfaceStateBits*)

undefined8 __thiscall IOAccelSurface::get_state(IOAccelSurface *this,uint *param_1)

{
  byte bVar1;
  
  bVar1 = (**(code **)(**(long **)(this + 0x12c8) + 0x870))();
  *param_1 = (uint)bVar1;
  return 0;
}



// IOAccelSurface::surface_write_lock_options(unsigned int, IOAccelSurfaceInformation*, unsigned
// long long)

void __thiscall
IOAccelSurface::surface_write_lock_options
          (IOAccelSurface *this,undefined4 param_1,undefined8 param_2,undefined8 param_3)

{
                    // WARNING: Could not recover jumptable at 0x000352f8. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0xa20))(this,2,param_1,param_2,param_3);
  return;
}



// IOAccelSurface::surface_write_unlock_options(unsigned int)

void __thiscall
IOAccelSurface::surface_write_unlock_options(IOAccelSurface *this,undefined4 param_1)

{
                    // WARNING: Could not recover jumptable at 0x00035310. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0xa28))(this,2,param_1);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurface::surface_read(IOAccelSurfaceReadData*, unsigned long long)

undefined8 __cdecl IOAccelSurface::surface_read(IOAccelSurface *param_1,uint *param_2)

{
  int *piVar1;
  ushort uVar2;
  long lVar3;
  IOGraphicsAccelerator2 *pIVar4;
  IOAccelResource2 *this;
  char cVar5;
  int iVar6;
  IOAccelSysMemory *pIVar7;
  undefined8 uVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar13;
  int iVar14;
  ulong uVar15;
  ulong uVar16;
  undefined1 *local_98;
  undefined1 *local_90;
  undefined1 *local_88;
  undefined1 *local_80;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  ulong local_58;
  ulong local_50;
  IOAccelSysMemory *local_48;
  ulong local_40;
  ulong local_38;
  int iVar12;
  
  lVar3 = *(long *)(param_2 + 4);
  if (lVar3 == 0) {
    return 0xe00002c2;
  }
  if (param_2[6] == 0) {
    return 0xe00002c2;
  }
  local_50 = (ulong)*param_2;
  local_38 = CONCAT44(local_38._4_4_,param_2[1]);
  local_40 = (ulong)param_2[2];
  local_58 = (ulong)param_2[3];
  pIVar4 = *(IOGraphicsAccelerator2 **)(param_1 + 0x12c8);
  _OSIncrementAtomic(pIVar4 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar4 + 0x88));
  _OSDecrementAtomic(pIVar4 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar4);
  (**(code **)(*(long *)pIVar4 + 0x850))(pIVar4,"",0);
  if ((((param_1[0x118c] != (IOAccelSurface)0x0) ||
       (this = *(IOAccelResource2 **)(param_1 + 0x11c0), this == (IOAccelResource2 *)0x0)) ||
      (((byte)param_1[0x1188] & 1) == 0)) ||
     ((*(long *)(this + 0x88) == 0 || (uVar2 = *(ushort *)(this + 0xd8), uVar2 == 0)))) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Surface disabled or no buffer\n",
                      "IOReturn IOAccelSurface::surface_read(IOAccelSurfaceReadData *, IOByteCount)"
                     );
    pIVar4 = *(IOGraphicsAccelerator2 **)(param_1 + 0x12c8);
    (**(code **)(*(long *)pIVar4 + 0x858))(pIVar4,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar4);
    _IOLockUnlock(*(undefined8 *)(pIVar4 + 0x88));
    return 0xe00002cc;
  }
  if ((((*(ushort **)(this + 0x30))[6] | **(ushort **)(this + 0x30)) & 1) == 0) {
    IOGraphicsAccelerator2::acceleratorUnlock(*(IOGraphicsAccelerator2 **)(param_1 + 0x12c8));
    return 0;
  }
  iVar9 = (int)local_50;
  iVar6 = (int)local_40;
  iVar13 = iVar6 + iVar9;
  if (iVar13 != 0 && SCARRY4(iVar6,iVar9) == iVar13 < 0) {
    iVar12 = (int)local_58;
    iVar11 = iVar12 + (int)local_38;
    if (((iVar11 != 0 && SCARRY4(iVar12,(int)local_38) == iVar11 < 0) &&
        (iVar10 = (int)*(short *)(param_1 + 0x11bc), iVar9 < iVar10)) &&
       (iVar14 = (int)*(short *)(param_1 + 0x11be), (int)local_38 < iVar14)) {
      local_48 = (IOAccelSysMemory *)CONCAT44(local_48._4_4_,iVar14);
      local_40 = 0;
      if (iVar9 < 0) {
        iVar6 = iVar13;
      }
      uVar15 = 0;
      if (0 < iVar9) {
        uVar15 = local_50 & 0xffffffff;
      }
      local_58 = (ulong)param_2[6];
      if ((int)local_38 < 0) {
        iVar12 = iVar11;
      }
      if (0 < (int)local_38) {
        local_40 = local_38 & 0xffffffff;
      }
      iVar13 = iVar10 - (int)uVar15;
      if (iVar6 + (int)uVar15 <= iVar10) {
        iVar13 = iVar6;
      }
      iVar6 = iVar14 - (int)local_40;
      if (iVar12 + (int)local_40 <= iVar14) {
        iVar6 = iVar12;
      }
      uVar16 = lVar3 + (ulong)((iVar9 >> 0x1f & -(iVar9 * (uint)uVar2)) -
                              ((int)local_38 >> 0x1f & param_2[6] * (int)local_38));
      lVar3 = *(long *)PTR__page_size_0006b108;
      local_38 = lVar3 - 1U & uVar16;
      local_50 = uVar15;
      pIVar7 = (IOAccelSysMemory *)
               IOAccelSysMemory::withClientBuffer
                         (*(long **)(param_1 + 0x12c8),*(undefined8 *)(param_1 + 0xe8),0,
                          uVar16 & -lVar3,
                          (local_38 & 0xffffffff) +
                          (ulong)((uint)uVar2 * iVar13) + (long)(iVar6 + -1) * local_58 + lVar3 + -1
                          & -lVar3);
      if (pIVar7 == (IOAccelSysMemory *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Failed to create IOMemoryDescriptor\n",
                          "IOReturn IOAccelSurface::surface_read(IOAccelSurfaceReadData *, IOByteCount)"
                         );
        uVar8 = 0xe00002be;
      }
      else {
        local_60 = &DAT_aaaaaaaaaaaaaaaa;
        local_68 = &DAT_aaaaaaaaaaaaaaaa;
        local_70 = &DAT_aaaaaaaaaaaaaaaa;
        local_78 = &DAT_aaaaaaaaaaaaaaaa;
        local_80 = &DAT_aaaaaaaaaaaaaaaa;
        local_88 = &DAT_aaaaaaaaaaaaaaaa;
        local_90 = &DAT_aaaaaaaaaaaaaaaa;
        local_98 = &DAT_aaaaaaaaaaaaaaaa;
        local_48 = pIVar7;
        (**(code **)(**(long **)(*(long *)(param_1 + 0x12c8) + 0x380) + 0x140))
                  (*(long **)(*(long *)(param_1 + 0x12c8) + 0x380),&local_98);
        uVar8 = IOAccelResource2::canQuickLockForCPUAccess(this,1);
        if (((char)uVar8 == '\0') &&
           (cVar5 = (**(code **)(*(long *)param_1 + 0x960))
                              (param_1,local_50,local_40,iVar13,iVar6,0,0,&local_98,this,local_48,
                               local_38,local_58,0), cVar5 != '\0')) {
          (**(code **)(**(long **)(*(long *)(param_1 + 0x12c8) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(param_1 + 0x12c8) + 0x380),&local_98,
                     (ulong)(byte)this[0x15] * 0x40 + *(long *)(this + 0x38));
          IOGraphicsAccelerator2::acceleratorUnlock(*(IOGraphicsAccelerator2 **)(param_1 + 0x12c8));
          iVar6 = (**(code **)(**(long **)(*(long *)(param_1 + 0x12c8) + 0x380) + 0x178))
                            (*(long **)(*(long *)(param_1 + 0x12c8) + 0x380),&local_98);
          lVar3 = *(long *)(param_1 + 0x12c8);
          IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar3 + 0x388) + 0x58),0x38);
          piVar1 = (int *)(lVar3 + 0x280);
          *piVar1 = *piVar1 + iVar6;
          IOGraphicsAccelerator2::acceleratorLock(*(IOGraphicsAccelerator2 **)(param_1 + 0x12c8));
          pIVar7 = local_48;
          if ((*(byte *)(*(long *)(param_1 + 0x12c8) + 0xc90) & 0x80) != 0) {
            IOAccelSysMemory::flushProcessorCacheForIn(local_48);
          }
          pIVar7[0xc] = (IOAccelSysMemory)((byte)pIVar7[0xc] | 1);
        }
        else {
          pIVar7 = local_48;
          copyFromBufferWithCPU
                    (param_1,(int)local_50,(uint)local_40,iVar13,iVar6,0,0,this,local_48,
                     (uint)local_38,local_58,0);
        }
        (**(code **)(*(long *)pIVar7 + 0x28))(pIVar7);
        uVar8 = 0;
      }
      goto LAB_00035720;
    }
  }
  uVar8 = 0;
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed. w = %d, h = %d\n\n",
                    "IOReturn IOAccelSurface::surface_read(IOAccelSurfaceReadData *, IOByteCount)",
                    local_40,local_58);
LAB_00035720:
  IOGraphicsAccelerator2::acceleratorUnlock(*(IOGraphicsAccelerator2 **)(param_1 + 0x12c8));
  return uVar8;
}



// IOAccelSurface::set_scale(unsigned int, IOAccelSurfaceScaling*, unsigned long long)

undefined4 __thiscall
IOAccelSurface::set_scale(IOAccelSurface *this,undefined4 param_1,undefined8 param_2,long param_3)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined4 uVar2;
  
  if ((param_3 == 0x2c) || (param_3 == 0)) {
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    if (param_3 == 0) {
      param_2 = 0;
    }
    uVar2 = (**(code **)(*(long *)this + 0x9f0))(this,param_1,param_2);
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  }
  else {
    uVar2 = 0xe00002c2;
  }
  return uVar2;
}



// IOAccelSurface::surface_query_lock()

undefined8 IOAccelSurface::surface_query_lock(void)

{
  return 0;
}



// IOAccelSurface::surface_read_lock(IOAccelSurfaceInformation*, unsigned long long)

void __thiscall
IOAccelSurface::surface_read_lock(IOAccelSurface *this,undefined8 param_1,undefined8 param_2)

{
                    // WARNING: Could not recover jumptable at 0x0003589b. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0xa20))(this,1,2,param_1,param_2);
  return;
}



// IOAccelSurface::surface_read_unlock()

void __thiscall IOAccelSurface::surface_read_unlock(IOAccelSurface *this)

{
                    // WARNING: Could not recover jumptable at 0x000358b7. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0xa28))(this,1,2);
  return;
}



// IOAccelSurface::surface_write_lock(IOAccelSurfaceInformation*, unsigned long long)

void __thiscall
IOAccelSurface::surface_write_lock(IOAccelSurface *this,undefined8 param_1,undefined8 param_2)

{
                    // WARNING: Could not recover jumptable at 0x000358d9. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0xa20))(this,2,1,param_1,param_2);
  return;
}



// IOAccelSurface::surface_write_unlock()

void __thiscall IOAccelSurface::surface_write_unlock(IOAccelSurface *this)

{
                    // WARNING: Could not recover jumptable at 0x000358f5. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0xa28))(this,2,2);
  return;
}



// IOAccelSurface::surface_control(unsigned int, unsigned int, unsigned int*)

undefined4 __thiscall
IOAccelSurface::surface_control
          (IOAccelSurface *this,undefined4 param_1,undefined4 param_2,undefined8 param_3)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined4 uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  uVar2 = (**(code **)(*(long *)this + 0xa30))(this,param_1,param_2,param_3);
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2;
}



// IOAccelSurface::init(OSDictionary*, task*)

undefined4 __thiscall
IOAccelSurface::init(IOAccelSurface *this,undefined8 param_2_00,undefined8 param_2)

{
  undefined4 uVar1;
  undefined8 uVar2;
  
  uVar1 = (**(code **)(PTR_vtable_0006b088 + 600))();
  if ((char)uVar1 != '\0') {
    uVar2 = _IOLockAlloc();
    *(undefined8 *)(this + 0x1320) = uVar2;
    _task_reference(param_2);
    *(undefined8 *)(this + 0xe8) = param_2;
  }
  return uVar1;
}



// IOAccelSurface::start(IOService*)

bool __thiscall IOAccelSurface::start(IOAccelSurface *this,OSMetaClassBase *param_1)

{
  char cVar1;
  IOAccelSurface IVar2;
  IOGraphicsAccelerator2 *pIVar3;
  
  cVar1 = (**(code **)(PTR_vtable_0006b088 + 0x5d0))();
  if (cVar1 != '\0') {
    pIVar3 = (IOGraphicsAccelerator2 *)
             OSMetaClassBase::safeMetaCast
                       (param_1,(OSMetaClass *)&IOGraphicsAccelerator2::gMetaClass);
    *(IOGraphicsAccelerator2 **)(this + 0x12c8) = pIVar3;
    if (pIVar3 != (IOGraphicsAccelerator2 *)0x0) {
      _OSIncrementAtomic(pIVar3 + 0x90);
      _IOLockLock(*(undefined8 *)(pIVar3 + 0x88));
      _OSDecrementAtomic(pIVar3 + 0x90);
      IOGraphicsAccelerator2::lock_busy(pIVar3);
      (**(code **)(*(long *)pIVar3 + 0x850))(pIVar3,"",0);
      IVar2 = (IOAccelSurface)(**(code **)(*(long *)this + 0x978))(this);
      this[0xf2] = IVar2;
      pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
      (**(code **)(*(long *)pIVar3 + 0x858))(pIVar3,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar3);
      _IOLockUnlock(*(undefined8 *)(pIVar3 + 0x88));
      return this[0xf2] != (IOAccelSurface)0x0;
    }
  }
  return false;
}



// IOGraphicsAccelerator2::acceleratorLock()

void __thiscall IOGraphicsAccelerator2::acceleratorLock(IOGraphicsAccelerator2 *this)

{
  _OSIncrementAtomic(this + 0x90);
  _IOLockLock(*(undefined8 *)(this + 0x88));
  _OSDecrementAtomic(this + 0x90);
  lock_busy(this);
                    // WARNING: Could not recover jumptable at 0x00035b3b. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x850))(this,"",0);
  return;
}



// IOGraphicsAccelerator2::acceleratorUnlock()

void __thiscall IOGraphicsAccelerator2::acceleratorUnlock(IOGraphicsAccelerator2 *this)

{
  (**(code **)(*(long *)this + 0x858))(this,"",0);
  unlock_busy(this);
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  return;
}



// IOAccelSurface::stopLocked()

void __thiscall IOAccelSurface::stopLocked(IOAccelSurface *this)

{
  (**(code **)(*(long *)this + 0x980))();
  this[0xf2] = (IOAccelSurface)0x0;
  (**(code **)(*(long *)this + 0x678))(this,*(undefined8 *)(this + 0x12c8));
  *(undefined8 *)(this + 0x12c8) = 0;
                    // WARNING: Could not recover jumptable at 0x00035bb7. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x28))(this);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurface::stop(IOService*)

void __cdecl IOAccelSurface::stop(long *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  
  if (*(char *)((long)param_1 + 0xf2) != '\0') {
    pIVar1 = (IOGraphicsAccelerator2 *)param_1[0x259];
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    pIVar1 = (IOGraphicsAccelerator2 *)param_1[0x259];
    (**(code **)(*(long *)pIVar1 + 0x20))(pIVar1);
    (**(code **)(*param_1 + 0x980))(param_1);
    *(undefined1 *)((long)param_1 + 0xf2) = 0;
    (**(code **)(*param_1 + 0x678))(param_1,param_1[0x259]);
    param_1[0x259] = 0;
    (**(code **)(*param_1 + 0x28))(param_1);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
                    // WARNING: Could not recover jumptable at 0x00035c9d. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*(long *)pIVar1 + 0x28))(pIVar1);
    return;
  }
  return;
}



// IOAccelSurface::requestTerminate(IOService*, unsigned int)

undefined8 IOAccelSurface::requestTerminate(void)

{
  return 0;
}



// IOAccelSurface::didTerminate(IOService*, unsigned int, bool*)

void __thiscall
IOAccelSurface::didTerminate
          (IOAccelSurface *this,undefined8 param_1,undefined4 param_2,undefined1 *param_3)

{
  int iVar1;
  IOGraphicsAccelerator2 *this_00;
  
  *param_3 = 1;
  this[0x1334] = (IOAccelSurface)0x1;
  _IOLockLock(*(undefined8 *)(this + 0x1320));
  iVar1 = *(int *)(this + 0x1328);
  this[0x1335] = (IOAccelSurface)(iVar1 != 0);
  _IOLockUnlock(*(undefined8 *)(this + 0x1320));
  if (iVar1 == 0) {
    this_00 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
    (**(code **)(*(long *)this_00 + 0x20))(this_00);
    _OSIncrementAtomic(this_00 + 0x90);
    _IOLockLock(*(undefined8 *)(this_00 + 0x88));
    _OSDecrementAtomic(this_00 + 0x90);
    IOGraphicsAccelerator2::lock_busy(this_00);
    (**(code **)(*(long *)this_00 + 0x850))(this_00,"",0);
    detach_surface(this);
    (**(code **)(*(long *)this_00 + 0x858))(this_00,"",0);
    IOGraphicsAccelerator2::unlock_busy(this_00);
    _IOLockUnlock(*(undefined8 *)(this_00 + 0x88));
    (**(code **)(*(long *)this_00 + 0x28))(this_00);
  }
                    // WARNING: Could not recover jumptable at 0x00035dc5. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b088 + 0x418))(this,param_1,param_2,param_3);
  return;
}



// IOAccelSurface::detach_surface()

void __thiscall IOAccelSurface::detach_surface(IOAccelSurface *this)

{
  long *plVar1;
  OSSet *pOVar2;
  undefined8 uVar3;
  OSDictionary *pOVar4;
  long lVar5;
  
  pOVar2 = (OSSet *)OSSet::withCapacity(1);
  (**(code **)(*(long *)this + 0x9a0))(this);
  plVar1 = *(long **)(this + 0x1318);
  if (plVar1 == (long *)0x0) {
    uVar3 = OSSet::withSet(pOVar2,0);
    *(undefined8 *)(this + 0x1318) = uVar3;
  }
  else {
    (**(code **)(*plVar1 + 0x1d0))(plVar1,pOVar2);
  }
  (**(code **)(*(long *)pOVar2 + 0x28))(pOVar2);
  (**(code **)(*(long *)this + 0x20))(this);
  (**(code **)(*(long *)this + 0x980))(this);
  this[0xf2] = (IOAccelSurface)0x0;
  (**(code **)(*(long *)this + 0x678))(this);
  *(undefined8 *)(this + 0x12c8) = 0;
  (**(code **)(*(long *)this + 0x28))(this);
  pOVar4 = (OSDictionary *)IOService::nameMatching("IOResources",(OSDictionary *)0x0);
  lVar5 = IOService::copyMatchingService(pOVar4);
  (**(code **)(*(long *)pOVar4 + 0x28))(pOVar4);
  if (lVar5 != 0) {
    (**(code **)(*(long *)this + 0x670))(this,lVar5);
  }
                    // WARNING: Could not recover jumptable at 0x00035eb5. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x28))(this);
  return;
}



// IOAccelSurface::add_orphaned_mappings(OSSet*)

void __thiscall IOAccelSurface::add_orphaned_mappings(IOAccelSurface *this,OSSet *param_1)

{
  undefined8 uVar1;
  
  if (*(long **)(this + 0x1318) != (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00035edd. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0x1318) + 0x1d0))();
    return;
  }
  uVar1 = OSSet::withSet(param_1,0);
  *(undefined8 *)(this + 0x1318) = uVar1;
  return;
}



// IOAccelSurface::orphanClientMappings(OSSet*)

void __thiscall IOAccelSurface::orphanClientMappings(IOAccelSurface *this,long *param_1)

{
  if (*(long *)(this + 0x1180) != 0) {
    (**(code **)(*param_1 + 0x1c0))(param_1);
  }
  if (this[0x10d0] == (IOAccelSurface)0x3) {
    (**(code **)(*param_1 + 0x1c0))(param_1,*(undefined8 *)(*(long *)(this + 0x10d8) + 0x58));
  }
  if (this[0x10d1] == (IOAccelSurface)0x3) {
                    // WARNING: Could not recover jumptable at 0x00035f64. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*param_1 + 0x1c0))(param_1,*(undefined8 *)(*(long *)(this + 0x10e0) + 0x58));
    return;
  }
  return;
}



// IOAccelSurface::clientClose()

undefined8 __thiscall IOAccelSurface::clientClose(IOAccelSurface *this)

{
  IOGraphicsAccelerator2 *pIVar1;
  int iVar2;
  OSMetaClassBase *pOVar3;
  IOAccelContext2 *this_00;
  uint uVar4;
  
  if (this[0xf2] != (IOAccelSurface)0x0) {
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    if (*(long **)(this + 0x1028) != (long *)0x0) {
      iVar2 = (**(code **)(**(long **)(this + 0x1028) + 0x130))();
      if (0 < iVar2) {
        uVar4 = iVar2 + 1;
        do {
          pOVar3 = (OSMetaClassBase *)
                   (**(code **)(**(long **)(this + 0x1028) + 0x1e8))
                             (*(long **)(this + 0x1028),uVar4 - 2);
          this_00 = (IOAccelContext2 *)
                    OSMetaClassBase::safeMetaCast
                              (pOVar3,(OSMetaClass *)&IOAccelContext2::gMetaClass);
          if (this_00 == (IOAccelContext2 *)0x0) {
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: unknown object type\n",
                              "virtual IOReturn IOAccelSurface::clientClose()");
          }
          else {
            IOAccelContext2::remove_surface(this_00,(long)this);
          }
          uVar4 = uVar4 - 1;
        } while (1 < uVar4);
      }
    }
    this[0x118c] = (IOAccelSurface)0x1;
    *(undefined4 *)(this + 0x1168) = 0xffffffe0;
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  }
  (**(code **)(*(long *)this + 0x600))(this,0);
  return 0;
}



// IOAccelSurface::surfaceStart()

undefined8 __thiscall IOAccelSurface::surfaceStart(IOAccelSurface *this)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  undefined8 uVar4;
  long lVar5;
  undefined *puVar6;
  undefined4 *puVar7;
  ulong uVar8;
  IOAccelSurface *pIVar9;
  
  *(undefined8 *)(this + 0x12d0) = *(undefined8 *)(*(long *)(this + 0x12c8) + 0x378);
  this[0xf2] = (IOAccelSurface)0x0;
  *(undefined8 *)(this + 0x12c0) = *(undefined8 *)(*(long *)(this + 0x12c8) + 0x150);
  *(undefined4 *)(this + 0x1168) = 0xffffffe0;
  uVar4 = OSArray::withCapacity(1);
  *(undefined8 *)(this + 0x1028) = uVar4;
  *(undefined8 *)(this + 0x11b0) = 0;
  *(undefined4 *)(this + 0x1188) = 0;
  *(undefined4 *)(this + 0x1190) = 0;
  *(undefined8 *)(this + 0x1198) = 0;
  *(undefined8 *)(this + 0x11a0) = 0;
  *(undefined8 *)(this + 0x116c) = 0;
  *(undefined8 *)(this + 0x11b8) = 0;
  this[0xf3] = (IOAccelSurface)0x0;
  this[0x118d] = (IOAccelSurface)0x0;
  lVar5 = 0x238;
  do {
    *(undefined8 *)(this + lVar5 * 8) = 0;
    lVar5 = lVar5 + 1;
  } while (lVar5 != 600);
  puVar6 = &DAT_0000105c;
  do {
    *(undefined8 *)(this + (long)(puVar6 + -0xc)) = 0;
    *(undefined4 *)(this + (long)(puVar6 + -4)) = 0;
    this[(long)puVar6] = (IOAccelSurface)0x1;
    puVar6 = puVar6 + 0x10;
  } while (puVar6 != &DAT_000010dc);
  uVar8 = 0;
  *(undefined8 *)(this + 0x1008) = 0;
  *(IOAccelSurface **)(this + 0x1010) = this + 0x1008;
  *(undefined8 *)(this + 0x1018) = 0;
  *(IOAccelSurface **)(this + 0x1020) = this + 0x1018;
  this[0x118c] = (IOAccelSurface)0x1;
  *(undefined2 *)(this + 0x10d0) = 0;
  *(undefined8 *)(this + 0x10d8) = 0;
  *(undefined8 *)(this + 0x10e0) = 0;
  *(undefined8 *)(this + 0x1180) = 0;
  *(undefined8 *)(this + 0x1178) = 0;
  *(undefined4 *)(this + 0x1038) = 0;
  *(undefined4 *)(this + 0x1000) = 0;
  *(undefined2 *)(this + 0x1004) = 0;
  IOAccelSurfaceList::addSurface
            ((IOAccelSurfaceList *)(*(long *)(this + 0x12c8) + 0xaa8),(long)this);
  lVar5 = *(long *)(this + 0x12c8);
  IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar5 + 0x388) + 0x58),0x21);
  piVar1 = (int *)(lVar5 + 0x224);
  *piVar1 = *piVar1 + 1;
  iVar2 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x12d0));
  if (iVar2 != 0) {
    pIVar9 = this + 0x1050;
    uVar8 = 0;
    do {
      puVar7 = (undefined4 *)_IOMallocData(0xc);
      *(undefined4 **)pIVar9 = puVar7;
      if (puVar7 == (undefined4 *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Failed to allocate region\n",
                          "virtual bool IOAccelSurface::surfaceStart()");
        break;
      }
      lVar5 = *(long *)(this + 0x12c8);
      if (lVar5 != 0) {
        IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar5 + 0x388) + 0x58),0x51);
        *(int *)(lVar5 + 0x2e4) = *(int *)(lVar5 + 0x2e4) + 0xc;
        puVar7 = *(undefined4 **)pIVar9;
      }
      *(undefined4 *)(pIVar9 + 8) = 0xc;
      *puVar7 = 0;
      *(undefined8 *)(puVar7 + 1) = 0;
      uVar8 = uVar8 + 1;
      uVar3 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x12d0))
      ;
      pIVar9 = pIVar9 + 0x10;
    } while (uVar8 < uVar3);
  }
  iVar2 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x12d0));
  if ((int)uVar8 == iVar2) {
    uVar8 = IOGraphicsAccelerator2::find_vram_descriptor
                      (*(IOGraphicsAccelerator2 **)(this + 0x12c8));
    if ((char)uVar8 != '\0') {
      this[0xf2] = (IOAccelSurface)0x1;
      return CONCAT71((int7)(uVar8 >> 8),1);
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: failed to get the vram descriptors\n",
                      "virtual bool IOAccelSurface::surfaceStart()");
  }
  surfaceStop(this);
  return 0;
}



// IOAccelSurface::surfaceStop()

void __thiscall IOAccelSurface::surfaceStop(IOAccelSurface *this)

{
  int *piVar1;
  IOAccelResource2 *pIVar2;
  long *plVar3;
  undefined8 *puVar4;
  long lVar5;
  long lVar6;
  int iVar7;
  OSMetaClassBase *pOVar8;
  IOAccelContext2 *this_00;
  char *pcVar9;
  uint uVar10;
  long lVar11;
  IOAccelSurface *pIVar12;
  ulong uVar13;
  
  this[0xf2] = (IOAccelSurface)0x0;
  if (*(int *)(this + 0x1000) != 0) {
    lVar11 = *(long *)(this + 0x12c8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar11 + 0x388) + 0x58),0x22);
    piVar1 = (int *)(lVar11 + 0x228);
    *piVar1 = *piVar1 + -1;
  }
  lVar11 = *(long *)(this + 0x1008);
  if (lVar11 != 0) {
    *(undefined8 *)(lVar11 + 0xf0) = 0;
    lVar6 = *(long *)(lVar11 + 0xe0);
    while (lVar5 = lVar6, puVar4 = (undefined8 *)(lVar11 + 0xe0), lVar5 != 0) {
      if (*(undefined8 **)(lVar5 + 0xe8) != puVar4) {
        pcVar9 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
        goto LAB_00036749;
      }
      if (**(long **)(lVar11 + 0xe8) != lVar11) goto LAB_00036742;
      *(long **)(lVar5 + 0xe8) = *(long **)(lVar11 + 0xe8);
      **(undefined8 **)(lVar11 + 0xe8) = *puVar4;
      *(undefined8 *)(lVar5 + 0xf0) = 0;
      lVar6 = *(long *)(lVar5 + 0xe0);
      lVar11 = lVar5;
    }
    if (**(long **)(lVar11 + 0xe8) != lVar11) {
LAB_00036742:
      pcVar9 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_00036749:
                    // WARNING: Subroutine does not return
      _panic(pcVar9,lVar11,0x1a9,"IOAccelSurface.cpp",0x1a9);
    }
    *(long **)(this + 0x1010) = *(long **)(lVar11 + 0xe8);
    **(undefined8 **)(lVar11 + 0xe8) = *puVar4;
  }
  if (this[0x10d0] != (IOAccelSurface)0x0) {
    pIVar2 = *(IOAccelResource2 **)(this + 0x10d8);
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Back buffer still locked. Lock = %d\n",
                      "virtual void IOAccelSurface::surfaceStop()");
    IOAccelResource2::unlockForCPUAccess(pIVar2,*(long *)(this + 0xe8),1);
    plVar3 = *(long **)(this + 0x10d8);
    *(undefined8 *)(this + 0x10d8) = 0;
    (**(code **)(*plVar3 + 0x28))();
    this[0x10d0] = (IOAccelSurface)0x0;
  }
  if (this[0x10d1] != (IOAccelSurface)0x0) {
    pIVar2 = *(IOAccelResource2 **)(this + 0x10e0);
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Back buffer still locked. Lock = %d\n",
                      "virtual void IOAccelSurface::surfaceStop()");
    IOAccelResource2::unlockForCPUAccess(pIVar2,*(long *)(this + 0xe8),2);
    plVar3 = *(long **)(this + 0x10e0);
    *(undefined8 *)(this + 0x10e0) = 0;
    (**(code **)(*plVar3 + 0x28))();
    this[0x10d1] = (IOAccelSurface)0x0;
  }
  if (*(long **)(this + 0x1180) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x1180) + 0x28))();
    *(undefined8 *)(this + 0x1180) = 0;
  }
  if (*(long **)(this + 0x1028) != (long *)0x0) {
    iVar7 = (**(code **)(**(long **)(this + 0x1028) + 0x130))();
    if (0 < iVar7) {
      uVar10 = iVar7 + 1;
      do {
        pOVar8 = (OSMetaClassBase *)
                 (**(code **)(**(long **)(this + 0x1028) + 0x1e8))
                           (*(long **)(this + 0x1028),uVar10 - 2);
        this_00 = (IOAccelContext2 *)
                  OSMetaClassBase::safeMetaCast(pOVar8,(OSMetaClass *)&IOAccelContext2::gMetaClass);
        if (this_00 == (IOAccelContext2 *)0x0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: unknown object type\n",
                            "virtual void IOAccelSurface::surfaceStop()");
        }
        else {
          IOAccelContext2::remove_surface(this_00,(long)this);
        }
        IOGraphicsAccelerator2::decrement_busy_count(*(IOGraphicsAccelerator2 **)(this + 0x12c8));
        uVar10 = uVar10 - 1;
      } while (1 < uVar10);
    }
    (**(code **)(**(long **)(this + 0x1028) + 0x28))();
    *(undefined8 *)(this + 0x1028) = 0;
  }
  lVar11 = 0x238;
  do {
    plVar3 = *(long **)(this + lVar11 * 8);
    if (plVar3 != (long *)0x0) {
      *(undefined8 *)(this + lVar11 * 8) = 0;
      (**(code **)(*plVar3 + 0x28))();
    }
    lVar11 = lVar11 + 1;
  } while (lVar11 != 600);
  iVar7 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x12d0));
  if (iVar7 != 0) {
    pIVar12 = this + 0x105c;
    uVar13 = 0;
    do {
      if (*(long *)(pIVar12 + -0xc) != 0) {
        _IOFreeData(*(long *)(pIVar12 + -0xc),*(undefined4 *)(pIVar12 + -4));
        lVar11 = *(long *)(this + 0x12c8);
        if (lVar11 != 0) {
          iVar7 = *(int *)(pIVar12 + -4);
          IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar11 + 0x388) + 0x58),0x51);
          *(int *)(lVar11 + 0x2e4) = *(int *)(lVar11 + 0x2e4) - iVar7;
        }
        *(undefined8 *)(pIVar12 + -0xc) = 0;
        *(undefined4 *)(pIVar12 + -4) = 0;
        *pIVar12 = (IOAccelSurface)0x1;
      }
      uVar13 = uVar13 + 1;
      uVar10 = IOAccelDisplayMachine::getFramebufferCount
                         (*(IOAccelDisplayMachine **)(this + 0x12d0));
      pIVar12 = pIVar12 + 0x10;
    } while (uVar13 < uVar10);
  }
  IOAccelSurfaceList::removeSurface
            ((IOAccelSurfaceList *)(*(long *)(this + 0x12c8) + 0xaa8),(long)this);
  lVar11 = *(long *)(this + 0x12c8);
  IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar11 + 0x388) + 0x58),0x21);
  piVar1 = (int *)(lVar11 + 0x224);
  *piVar1 = *piVar1 + 1;
  this[0xf1] = (IOAccelSurface)0x0;
  _IOLockWakeup_darwin14(*(undefined8 *)(*(long *)(this + 0x12c8) + 0x88),this,0);
  return;
}



// IOAccelSurface::set_surface_blocking(unsigned int)

undefined8 __thiscall IOAccelSurface::set_surface_blocking(IOAccelSurface *this,int param_1)

{
  this[0xf1] = (IOAccelSurface)(param_1 != 0);
  if (param_1 == 0) {
    _IOLockWakeup_darwin14(*(undefined8 *)(*(long *)(this + 0x12c8) + 0x88),this,0);
  }
  return 0;
}



// IOAccelSurface::free()

void __thiscall IOAccelSurface::free(IOAccelSurface *this)

{
  if (*(long *)(this + 0x1320) != 0) {
    _IOLockFree();
    *(undefined8 *)(this + 0x1320) = 0;
  }
  if (*(long **)(this + 0x1318) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x1318) + 0x28))();
  }
  *(undefined8 *)(this + 0x1318) = 0;
  _task_deallocate(*(undefined8 *)(this + 0xe8));
                    // WARNING: Could not recover jumptable at 0x000367ee. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b088 + 0xa0))(this);
  return;
}



// IOAccelSurface::getTargetAndMethodForIndex(IOService**, unsigned int)

undefined ** __thiscall
IOAccelSurface::getTargetAndMethodForIndex(IOAccelSurface *this,undefined8 *param_1,uint param_2)

{
  undefined **ppuVar1;
  
  *param_1 = this;
  ppuVar1 = (undefined **)0x0;
  if (param_2 < 0x13) {
    ppuVar1 = &sSurfaceMethods + (ulong)param_2 * 6;
  }
  return ppuVar1;
}



// IOAccelSurface::add_context_to_list(IOAccelContext2*)

void __thiscall IOAccelSurface::add_context_to_list(IOAccelSurface *this,long *param_1)

{
  uint uVar1;
  
  (**(code **)(**(long **)(this + 0x1028) + 0x1b8))();
  IOGraphicsAccelerator2::increment_busy_count(*(IOGraphicsAccelerator2 **)(this + 0x12c8));
  uVar1 = (**(code **)(*param_1 + 0xb00))(param_1);
  *(uint *)(this + 0x1190) = *(uint *)(this + 0x1190) | uVar1;
  return;
}



// IOAccelSurface::remove_context_from_list(IOAccelContext2*)

void __thiscall IOAccelSurface::remove_context_from_list(IOAccelSurface *this,long param_1)

{
  int iVar1;
  long lVar2;
  int iVar3;
  
  iVar1 = (**(code **)(**(long **)(this + 0x1028) + 0x130))();
  if (0 < iVar1) {
    iVar3 = 0;
    do {
      lVar2 = (**(code **)(**(long **)(this + 0x1028) + 0x1e8))(*(long **)(this + 0x1028),iVar3);
      if (lVar2 == param_1) {
        (**(code **)(**(long **)(this + 0x1028) + 0x1d8))(*(long **)(this + 0x1028),iVar3);
        IOGraphicsAccelerator2::decrement_busy_count(*(IOGraphicsAccelerator2 **)(this + 0x12c8));
        break;
      }
      iVar3 = iVar3 + 1;
    } while (iVar1 != iVar3);
  }
                    // WARNING: Could not recover jumptable at 0x000368d6. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x9e8))(this);
  return;
}



// IOAccelSurface::add_texture(IOAccelResource2*)

void __thiscall IOAccelSurface::add_texture(IOAccelSurface *this,long param_1)

{
  *(undefined8 *)(param_1 + 0xe0) = 0;
  *(undefined8 *)(param_1 + 0xe8) = *(undefined8 *)(this + 0x1010);
  **(long **)(this + 0x1010) = param_1;
  *(long *)(this + 0x1010) = param_1 + 0xe0;
  return;
}



// IOAccelSurface::remove_texture(IOAccelResource2*)

void __thiscall IOAccelSurface::remove_texture(IOAccelSurface *this,long param_1)

{
  long lVar1;
  char *pcVar2;
  
  lVar1 = *(long *)(param_1 + 0xe0);
  if (lVar1 == 0) {
    if (**(long **)(param_1 + 0xe8) == param_1) {
      *(long **)(this + 0x1010) = *(long **)(param_1 + 0xe8);
LAB_0003696a:
      **(undefined8 **)(param_1 + 0xe8) = *(undefined8 *)(param_1 + 0xe0);
      return;
    }
  }
  else {
    if (*(undefined8 **)(lVar1 + 0xe8) != (undefined8 *)(param_1 + 0xe0)) {
      pcVar2 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
      goto LAB_00036985;
    }
    if (**(long **)(param_1 + 0xe8) == param_1) {
      *(long **)(lVar1 + 0xe8) = *(long **)(param_1 + 0xe8);
      goto LAB_0003696a;
    }
  }
  pcVar2 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_00036985:
                    // WARNING: Subroutine does not return
  _panic(pcVar2,param_1,599,"IOAccelSurface.cpp",599);
}



// IOAccelSurface::get_surfaceref_texture(IOAccelShared2*, unsigned int)

long __thiscall
IOAccelSurface::get_surfaceref_texture(IOAccelSurface *this,long param_1,int param_2)

{
  long lVar1;
  
  lVar1 = *(long *)(this + 0x1008);
  if (lVar1 != 0) {
    do {
      if ((*(long *)(lVar1 + 0x68) == *(long *)(param_1 + 0x20)) &&
         (*(int *)(lVar1 + 0x100) == param_2)) {
        return lVar1;
      }
      lVar1 = *(long *)(lVar1 + 0xe0);
    } while (lVar1 != 0);
  }
  return 0;
}



// IOAccelSurface::get_drawable(IOAccelShared2*, unsigned int, int, int)

long * __thiscall
IOAccelSurface::get_drawable
          (IOAccelSurface *this,IOAccelShared2 *param_1,uint param_2,uint param_3,uint param_4)

{
  ulong uVar1;
  bool bVar2;
  long *plVar3;
  IOAccelResource2 *this_00;
  long lVar4;
  long *plVar5;
  
  for (plVar3 = *(long **)(this + 0x1018); plVar3 != (long *)0x0; plVar3 = (long *)plVar3[0x26]) {
    if (((((IOAccelShared2 *)plVar3[3] == param_1) && (*(uint *)(plVar3 + 0x28) == param_2)) &&
        (*(byte *)(plVar3 + 0x25) == param_3)) && (*(byte *)((long)plVar3 + 0x129) == param_4)) {
      lVar4 = 4;
      plVar5 = plVar3;
      goto LAB_00036b77;
    }
  }
  plVar5 = (long *)0x0;
  plVar3 = (long *)(**(code **)(**(long **)(this + 0x12c8) + 0x8f8))
                             (*(long **)(this + 0x12c8),this,param_1,0);
  if (plVar3 != (long *)0x0) {
    *(char *)(plVar3 + 0x25) = (char)param_3;
    *(char *)((long)plVar3 + 0x129) = (char)param_4;
    lVar4 = 0x28;
    plVar5 = plVar3;
    if (param_2 != 0) {
      lVar4 = 0x1e4;
      do {
        uVar1 = lVar4 - 0x1e4;
        if ((param_2 & 1) != 0) {
          this_00 = IOAccelResource2::newResourceWithSurface
                              (*(long **)(this + 0x12c8),param_1,this,(int)uVar1);
          if (this_00 == (IOAccelResource2 *)0x0) {
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                              "%s: fail to create surface texture\n",
                              "IOAccelDrawable2 *IOAccelSurface::get_drawable(IOAccelShared2 *, uint32_t, int, int)"
                             );
            lVar4 = 5;
            plVar5 = (long *)0x0;
            goto LAB_00036b77;
          }
          LOCK();
          *(int *)(*(long *)(this_00 + 0x30) + 0x18) =
               *(int *)(*(long *)(this_00 + 0x30) + 0x18) + 1;
          UNLOCK();
          IOAccelResource2::updateReadWriteBits(this_00,1,'\x01');
          (**(code **)(*(long *)this_00 + 0x20))(this_00);
          plVar3[lVar4 + -0x1df] = (long)this_00;
          *(uint *)(plVar3 + 0x28) = *(uint *)(plVar3 + 0x28) | 1 << ((byte)uVar1 & 0x1f);
          *(char *)((long)plVar3 + lVar4 + -0x20) = (char)param_3;
          *(char *)((long)plVar3 + lVar4) = (char)param_4;
          *(undefined4 *)((long)plVar3 + lVar4 * 4 + -0x64c) = 0;
        }
        if (0x1e < uVar1) break;
        lVar4 = lVar4 + 1;
        bVar2 = 1 < param_2;
        param_2 = param_2 >> 1;
      } while (bVar2);
      lVar4 = 0x28;
    }
LAB_00036b77:
    (**(code **)(*plVar3 + lVar4 * 8))(plVar3);
  }
  return plVar5;
}



// IOAccelSurface::set_compatible_surface_mode(IOAccelContext2*, unsigned long long)

ulong __thiscall
IOAccelSurface::set_compatible_surface_mode(IOAccelSurface *this,long *param_1,ulong param_2)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  long *plVar4;
  ulong uVar5;
  ulong uVar6;
  ulong local_30;
  
  uVar6 = *(ulong *)(this + 0x11b0);
  local_30 = uVar6;
  uVar2 = (**(code **)(**(long **)(this + 0x1028) + 0x130))();
  if ((uVar2 < 2) &&
     ((iVar3 = (**(code **)(**(long **)(this + 0x1028) + 0x130))(), iVar3 != 1 ||
      (plVar4 = (long *)(**(code **)(**(long **)(this + 0x1028) + 0x1f0))(), plVar4 == param_1)))) {
    uVar5 = (**(code **)(*param_1 + 0xb30))(param_1);
    local_30 = ~uVar5 & param_2 | (ulong)((uint)uVar6 & 0x7f8c3f);
  }
  else {
    cVar1 = (**(code **)(*param_1 + 0xb10))
                      (param_1,&local_30,param_2,*(undefined4 *)(this + 0x1190));
    if (cVar1 == '\0') {
      uVar6 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Failing fWindowMode = 0x%llx, mode = 0x%llx\n",
                        "bool IOAccelSurface::set_compatible_surface_mode(IOAccelContext2 *, uint64_t)"
                        ,*(undefined8 *)(this + 0x11b0),param_2);
      goto LAB_00036c73;
    }
  }
  *(ulong *)(this + 0x11b0) = local_30;
  uVar6 = CONCAT71((int7)((ulong)this >> 8),1);
LAB_00036c73:
  return uVar6 & 0xffffffff;
}



// IOAccelSurface::set_id_mode(unsigned int, unsigned int)

undefined8 __thiscall IOAccelSurface::set_id_mode(IOAccelSurface *this,uint param_1,uint param_2)

{
  uint uVar1;
  IOGraphicsAccelerator2 *pIVar2;
  int iVar3;
  undefined8 in_RAX;
  undefined8 uVar4;
  undefined4 uVar5;
  
  uVar5 = (undefined4)((ulong)in_RAX >> 0x20);
  if ((param_2 & 0xff8073c0) != 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Surface mode contains bad bits\n",
                      "virtual IOReturn IOAccelSurface::set_id_mode(uint32_t, uint32_t)");
    return 0xe00002c2;
  }
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
  _OSIncrementAtomic(pIVar2 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar2 + 0x88));
  _OSDecrementAtomic(pIVar2 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar2);
  (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
  if ((this[0x10d0] != (IOAccelSurface)0x0) || (this[0x10d1] != (IOAccelSurface)0x0)) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: surface data read or write locked\n"
                      ,"virtual IOReturn IOAccelSurface::set_id_mode(uint32_t, uint32_t)");
    uVar4 = 0xe00002cc;
    goto LAB_00036d5e;
  }
  if ((~param_2 & 0xc00) == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Surface mode illegal. Can\'t force both front and back buffers at the same time.\n"
                      ,"virtual IOReturn IOAccelSurface::set_id_mode(uint32_t, uint32_t)");
  }
  else {
    iVar3 = (**(code **)(**(long **)(this + 0x1028) + 0x130))();
    if (iVar3 != 0) {
      if ((((uint)*(undefined8 *)(this + 0x11b0) ^ param_2) & 0x7f8c3f) != 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Surface mode incompatible\n",
                          "virtual IOReturn IOAccelSurface::set_id_mode(uint32_t, uint32_t)");
        goto LAB_00036e67;
      }
      param_2 = (uint)*(undefined8 *)(this + 0x11b0) & 0xff8073c0 | param_2;
    }
    if ((param_2 & 0x20) != 0) {
      uVar1 = *(uint *)(this + 0x1168);
      if ((uVar1 == 0xffffffe0) || (uVar1 == param_1)) {
        if (0xff < param_1) {
          *(ulong *)(this + 0x11b0) = (ulong)param_2;
          *(uint *)(this + 0x1168) = param_1;
          *(undefined4 *)(this + 0x1188) = 0;
          (**(code **)(*(long *)this + 0x9e8))(this);
          reset_access(this);
          (**(code **)(*(long *)this + 0x9e0))(this);
          (**(code **)(*(long *)this + 0x9d8))(this);
          this[0x118c] = (IOAccelSurface)0x0;
          uVar4 = 0;
          goto LAB_00036d5e;
        }
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: New id (0x%08x) less than 256, Assembly surfaces for display updates not supported\n"
                          ,"virtual IOReturn IOAccelSurface::set_id_mode(uint32_t, uint32_t)",
                          param_1);
      }
      else {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Surface already has id (0x%08x), can not accept new id (0x%08x)\n",
                          "virtual IOReturn IOAccelSurface::set_id_mode(uint32_t, uint32_t)",uVar1,
                          CONCAT44(uVar5,param_1));
      }
      uVar4 = 0xe00002c2;
      goto LAB_00036d5e;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: mode 0x%x must has kIOAccelSurfaceModeWindowedBit bit\n",
                      "virtual IOReturn IOAccelSurface::set_id_mode(uint32_t, uint32_t)",param_2);
  }
LAB_00036e67:
  uVar4 = 0xe00002bc;
LAB_00036d5e:
  pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
  (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar2);
  _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
  return uVar4;
}



// IOAccelSurface::reset_access()

void __thiscall IOAccelSurface::reset_access(IOAccelSurface *this)

{
  task *ptVar1;
  long *plVar2;
  undefined8 uVar3;
  
  ptVar1 = *(task **)(*(long *)(this + 0x12c8) + 0x180);
  if (*(long **)(this + 0x1180) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x1180) + 0x28))();
  }
  *(undefined8 *)(this + 0x1178) = 0;
  plVar2 = (long *)IOMemoryDescriptor::createMappingInTask(ptVar1,*(ulonglong *)(this + 0xe8),0,1,0)
  ;
  *(long **)(this + 0x1180) = plVar2;
  if (plVar2 == (long *)0x0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to get server surface map\n",
                      "void IOAccelSurface::reset_access()");
  }
  else {
    uVar3 = (**(code **)(*plVar2 + 0x118))(plVar2);
    *(undefined8 *)(this + 0x1178) = uVar3;
  }
  return;
}



// IOAccelSurface::copyFromBufferWithCPU(int, int, int, int, unsigned int, unsigned int,
// IOAccelResource2*, IOAccelSysMemory*, unsigned int, unsigned long long, unsigned int)

void __thiscall
IOAccelSurface::copyFromBufferWithCPU
          (IOAccelSurface *this,int param_1,uint param_2,int param_3,int param_4,
          undefined1 param_6_00,undefined1 param_6,IOAccelResource2 *param_7,
          IOAccelSysMemory *param_8,uint param_9,long param_10,uint param_11)

{
  int *piVar1;
  ushort uVar2;
  undefined *puVar3;
  int iVar4;
  long lVar5;
  long lVar6;
  sbyte sVar7;
  int iVar8;
  undefined4 *puVar9;
  int iVar10;
  undefined4 *puVar11;
  undefined4 *puVar12;
  undefined4 *puVar13;
  uint local_38;
  int local_34;
  
  local_34 = -0x55555556;
  lVar5 = IOAccelSysMemory::lockForCPUAccess(param_8,*(ulonglong *)PTR__kernel_task_0006b100,1);
  if (lVar5 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: lockForCPUAccess failed\n",
                      "void IOAccelSurface::copyFromBufferWithCPU(int32_t, int32_t, int32_t, int32_t, uint32_t, uint32_t, IOAccelResource2 *, IOAccelSysMemory *, uint32_t, IOByteCount, uint32_t)"
                     );
  }
  else {
    iVar4 = (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x188))
                      (*(long **)(*(long *)(this + 0x12c8) + 0x380),
                       (ulong)(byte)param_7[0x15] * 0x40 + *(long *)(param_7 + 0x38));
    lVar6 = *(long *)(this + 0x12c8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar6 + 0x388) + 0x58),0x38);
    piVar1 = (int *)(lVar6 + 0x280);
    *piVar1 = *piVar1 + iVar4;
    puVar3 = PTR__kernel_task_0006b100;
    local_38 = param_2;
    if (((param_11 & 2) != 0) && (((byte)this[0x11b2] & 0x70) == 0)) {
      local_38 = ~param_2 + (uint)*(ushort *)(param_7 + 0xb2);
    }
    lVar6 = IOAccelResource2::lockForCPUAccess
                      (param_7,*(ulonglong *)PTR__kernel_task_0006b100,1,1,'\0',param_6_00,param_6,
                       &local_34);
    if (lVar6 == 0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: lockForCPUAccess failed\n",
                        "void IOAccelSurface::copyFromBufferWithCPU(int32_t, int32_t, int32_t, int32_t, uint32_t, uint32_t, IOAccelResource2 *, IOAccelSysMemory *, uint32_t, IOByteCount, uint32_t)"
                       );
      lVar5 = *(long *)puVar3;
    }
    else {
      uVar2 = *(ushort *)(param_7 + 0xd8);
      iVar4 = local_34 / (int)(uint)uVar2;
      local_34 = iVar4;
      if (((param_11 & 2) != 0) && (local_34 = -iVar4, ((byte)this[0x11b2] & 0x70) != 0)) {
        local_34 = iVar4;
      }
      local_34 = local_34 * (uint)uVar2;
      if (uVar2 == 1) {
        sVar7 = 4;
        iVar8 = 0xf;
      }
      else if (uVar2 == 2) {
        sVar7 = 3;
        iVar8 = 7;
      }
      else {
        sVar7 = 2;
        iVar8 = 3;
      }
      iVar8 = iVar8 + param_3 >> sVar7;
      if (0 < param_4) {
        puVar13 = (undefined4 *)(lVar5 + (ulong)param_9);
        puVar9 = (undefined4 *)(lVar6 + (long)(int)(iVar4 * local_38 + param_1) * (ulong)uVar2);
        iVar4 = 0;
        do {
          puVar11 = puVar9;
          puVar12 = puVar13;
          iVar10 = iVar8;
          if (0 < iVar8) {
            do {
              *puVar12 = *puVar11;
              puVar12[1] = puVar11[1];
              puVar12[2] = puVar11[2];
              puVar12[3] = puVar11[3];
              iVar10 = iVar10 + -1;
              puVar11 = puVar11 + 4;
              puVar12 = puVar12 + 4;
            } while (iVar10 != 0);
          }
          puVar13 = (undefined4 *)((long)puVar13 + param_10);
          puVar9 = (undefined4 *)((long)puVar9 + (long)local_34);
          iVar4 = iVar4 + 1;
        } while (iVar4 != param_4);
      }
      IOAccelResource2::unlockForCPUAccess(param_7,*(long *)puVar3,1);
      lVar5 = *(long *)puVar3;
    }
    IOAccelSysMemory::unlockForCPUAccess(param_8,lVar5);
  }
  return;
}



// IOAccelSurface::alloc_surfaces_retry(unsigned int, eLockType)

undefined8 __thiscall
IOAccelSurface::alloc_surfaces_retry(IOAccelSurface *this,uint param_1,int param_2)

{
  IOAccelSurface IVar1;
  int iVar2;
  IOGraphicsAccelerator2 *pIVar3;
  ulong uVar4;
  long lVar5;
  undefined1 *local_48;
  int local_3c;
  ulong local_38;
  
  local_38 = 0;
  local_3c = param_2;
  do {
    iVar2 = (int)local_38;
    if (param_2 == 2) {
      IVar1 = this[0x10d1];
joined_r0x000372dd:
      if (IVar1 != (IOAccelSurface)0x0) {
        return 0xe00002cc;
      }
LAB_000372f2:
      if (this[0x118c] != (IOAccelSurface)0x0) {
LAB_0003741b:
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Surface disabled\n",
                          "IOReturn IOAccelSurface::alloc_surfaces_retry(uint32_t, enum eLockType)")
        ;
        return 0xe00002cc;
      }
      if ((*(byte *)(*(long *)(this + 0x12c8) + 0xc78) & 2) == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Accelerator disabled\n",
                          "IOReturn IOAccelSurface::alloc_surfaces_retry(uint32_t, enum eLockType)")
        ;
        return 0xe00002be;
      }
    }
    else {
      if (param_2 == 1) {
        IVar1 = this[0x10d0];
        goto joined_r0x000372dd;
      }
      if (param_2 != 0) goto LAB_000372f2;
      if ((*(byte *)(*(long *)(this + 0x12c8) + 0xc78) & 2) == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Accelerator disabled\n",
                          "IOReturn IOAccelSurface::alloc_surfaces_retry(uint32_t, enum eLockType)")
        ;
        return 0xe00002be;
      }
      if (this[0x118c] != (IOAccelSurface)0x0) goto LAB_0003741b;
    }
    uVar4 = prepare_buffers(this,param_1);
    if ((char)uVar4 != '\0') {
      return 0;
    }
    local_48 = &DAT_aaaaaaaaaaaaaaaa;
    IOAccelSurfaceList::Iterator::Iterator
              ((Iterator *)&local_48,(undefined8 *)(*(long *)(this + 0x12c8) + 0xaa8));
    do {
      lVar5 = IOAccelSurfaceList::Iterator::getNextSurface((Iterator *)&local_48);
      if (lVar5 == 0) {
        return 0xe00002be;
      }
    } while (((&DAT_000010d0)[lVar5] == '\0') && ((&DAT_000010d1)[lVar5] == '\0'));
    if (iVar2 == 1000) {
      return 0xe00002be;
    }
    local_38 = (ulong)(iVar2 + 1);
    pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
    (**(code **)(*(long *)pIVar3 + 0x858))(pIVar3,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar3);
    _IOLockUnlock(*(undefined8 *)(pIVar3 + 0x88));
    _thread_block(0);
    _IOSleep(1);
    pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
    _OSIncrementAtomic(pIVar3 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar3 + 0x88));
    param_2 = local_3c;
    _OSDecrementAtomic(pIVar3 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar3);
    (**(code **)(*(long *)pIVar3 + 0x850))(pIVar3,"",0);
  } while( true );
}



// IOAccelSurface::prepare_buffers(unsigned int)

ulong __thiscall IOAccelSurface::prepare_buffers(IOAccelSurface *this,uint param_1)

{
  char cVar1;
  uint uVar2;
  undefined8 unaff_R12;
  ulong uVar3;
  ulong uVar4;
  bool bVar5;
  
  uVar3 = CONCAT71((int7)((ulong)unaff_R12 >> 8),1);
  uVar2 = *(uint *)(this + 0x1190) & param_1;
  if (uVar2 != 0) {
    uVar4 = 0;
    do {
      if (((uint)(1L << ((byte)uVar4 & 0x3f)) & uVar2) != 0) {
        if ((*(long **)(this + (long)(&DAT_000011c0 + uVar4 * 8)) == (long *)0x0) ||
           (cVar1 = (**(code **)(**(long **)(this + (long)(&DAT_000011c0 + uVar4 * 8)) + 0x170))(),
           cVar1 == '\0')) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: failed to prepare buffer %p.\n",
                            "bool IOAccelSurface::prepare_buffers(uint32_t)",
                            *(undefined8 *)(this + (long)(&DAT_000011c0 + uVar4 * 8)));
          goto LAB_00037550;
        }
        uVar2 = uVar2 & ~(1 << ((uint)uVar4 & 0x1f));
      }
    } while ((uVar2 != 0) && (bVar5 = uVar4 < 0x1f, uVar4 = uVar4 + 1, bVar5));
    if (uVar2 != 0) {
LAB_00037550:
      complete_buffers(this,~uVar2 & *(uint *)(this + 0x1190) & param_1);
      uVar3 = 0;
    }
  }
  return uVar3 & 0xffffffff;
}



// IOAccelSurface::pageoffInLinear()

void __thiscall IOAccelSurface::pageoffInLinear(IOAccelSurface *this)

{
  IOAccelSurface *pIVar1;
  
  if ((((byte)this[0x11b2] & 0x70) == 0) && (this[0x118c] == (IOAccelSurface)0x0)) {
    if ((*(uint *)(this + 0x1168) < 0x100) && (((byte)this[0x1190] & 2) != 0)) {
      pIVar1 = this + 0x11c8;
    }
    else {
      pIVar1 = this + 0x11c0;
    }
    if (*(IOAccelResource2 **)pIVar1 != (IOAccelResource2 *)0x0) {
      IOAccelResource2::pageoffInLinear(*(IOAccelResource2 **)pIVar1);
      return;
    }
  }
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurface::surface_lock_options(eLockType, unsigned int, IOAccelSurfaceInformation*,
// unsigned long long)

undefined8 __cdecl
IOAccelSurface::surface_lock_options(long *param_1,int param_2,undefined4 param_3,long *param_4)

{
  IOGraphicsAccelerator2 *pIVar1;
  IOAccelResource2 *this;
  ulong uVar2;
  ulong uVar3;
  uint uVar4;
  undefined4 uVar5;
  undefined8 in_RAX;
  long lVar6;
  long *plVar7;
  byte bVar8;
  undefined8 uVar9;
  undefined8 local_38;
  
  local_38._4_4_ = (undefined4)((ulong)in_RAX >> 0x20);
  local_38 = CONCAT44(local_38._4_4_,param_3);
  param_4[10] = 0;
  param_4[9] = 0;
  param_4[8] = 0;
  param_4[7] = 0;
  param_4[6] = 0;
  param_4[5] = 0;
  param_4[4] = 0;
  param_4[3] = 0;
  param_4[2] = 0;
  param_4[1] = 0;
  *param_4 = 0;
  pIVar1 = (IOGraphicsAccelerator2 *)param_1[0x259];
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  uVar2 = local_38;
  if ((&DAT_000010d1 + (long)param_1)[-(ulong)(param_2 == 1)] != '\0') {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Surface is already locked\n",
                      "virtual IOReturn IOAccelSurface::surface_lock_options(enum eLockType, uint32_t, IOAccelSurfaceData *, IOByteCount)"
                     );
    pIVar1 = (IOGraphicsAccelerator2 *)param_1[0x259];
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
    return 0xe00002cc;
  }
  uVar4 = (uint)local_38;
  if (((*(uint *)(param_1 + 0x232) & 3) == 0) && ((*(byte *)((long)param_1 + 0x11b1) & 0x80) == 0))
  {
    *(byte *)(param_1 + 0x231) = *(byte *)(param_1 + 0x231) | 1;
    *(uint *)(param_1 + 0x232) = *(uint *)(param_1 + 0x232) | 1;
    (**(code **)(*param_1 + 0x9e0))(param_1);
    (**(code **)(*param_1 + 0x9d8))(param_1);
  }
  uVar3 = local_38;
  if (*(uint *)(param_1 + 0x22d) < 0x100) {
    surface_lock_options();
    return 0;
  }
  if (*(char *)((long)param_1 + 0x118c) == '\0') {
    this = (IOAccelResource2 *)param_1[0x238];
    if (this == (IOAccelResource2 *)0x0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: No buffer\n",
                        "virtual IOReturn IOAccelSurface::surface_lock_options(enum eLockType, uint32_t, IOAccelSurfaceData *, IOByteCount)"
                       );
    }
    else {
      if (*(long *)(this + 200) != 0) {
        local_38 = local_38 & 0xffffffff;
        if ((uVar4 & 3) == 3) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Bogus options\n",
                            "virtual IOReturn IOAccelSurface::surface_lock_options(enum eLockType, uint32_t, IOAccelSurfaceData *, IOByteCount)"
                           );
          pIVar1 = (IOGraphicsAccelerator2 *)param_1[0x259];
          (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
          IOGraphicsAccelerator2::unlock_busy(pIVar1);
          _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
          return 0xe00002c2;
        }
        if ((param_2 == 2) || (*(char *)((long)param_1 + 0xf3) != '\0')) {
          if ((uVar2 & 4) == 0) {
            bVar8 = 0;
            lVar6 = IOAccelResource2::lockForCPUAccess
                              (this,param_1[0x1d],param_2,1,(uVar2 & 3) == 0,0,0,(long)&local_38 + 4
                              );
            if (lVar6 == 0) {
              lVar6 = 0;
            }
            else {
              bVar8 = ((byte)this[0xd] & 0x10) >> 3 | 1;
            }
          }
          else {
            local_38._0_4_ = (uint)uVar3;
            local_38 = CONCAT44(0xbada55,(uint)local_38);
            lVar6 = 0x13375fc;
            bVar8 = 4;
          }
        }
        else {
          lVar6 = 0;
          bVar8 = 2;
        }
        *(undefined4 *)(param_4 + 4) = local_38._4_4_;
        *param_4 = lVar6;
        *(uint *)((long)param_4 + 0x24) = (uint)*(ushort *)(this + 0xb0);
        *(uint *)(param_4 + 5) = (uint)*(ushort *)(this + 0xb2);
        uVar4 = *(uint *)(param_1 + 0x236) & 0xf;
        *(uint *)((long)param_4 + 0x2c) = uVar4;
        if (uVar4 == 6) {
          uVar5 = 0x79757673;
LAB_00037975:
          *(undefined4 *)((long)param_4 + 0x2c) = uVar5;
        }
        else {
          if (uVar4 == 10) {
            uVar5 = 4;
            goto LAB_00037975;
          }
          if (uVar4 == 9) {
            uVar5 = 0x32767579;
            goto LAB_00037975;
          }
        }
        *(int *)(param_4 + 6) = (int)param_1[0x207];
        *(undefined4 *)((long)param_4 + 0x44) = *(undefined4 *)((long)param_1 + 0x103c);
        *(int *)(param_4 + 9) = (int)param_1[0x208];
        *(undefined4 *)((long)param_4 + 0x4c) = *(undefined4 *)((long)param_1 + 0x1044);
        *(int *)(param_4 + 10) = (int)param_1[0x209];
        *(undefined4 *)((long)param_4 + 0x34) = 0x1cccc;
        uVar9 = 0;
        if (bVar8 != 0) {
          if (param_2 == 1) {
            *(byte *)(param_1 + 0x21a) = bVar8;
            plVar7 = param_1 + 0x21b;
          }
          else {
            *(byte *)((long)param_1 + 0x10d1) = bVar8;
            plVar7 = param_1 + 0x21c;
          }
          *plVar7 = (long)this;
          (**(code **)(*(long *)this + 0x20))(this);
        }
        goto LAB_00037762;
      }
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Surface has null shape\n",
                        "virtual IOReturn IOAccelSurface::surface_lock_options(enum eLockType, uint32_t, IOAccelSurfaceData *, IOByteCount)"
                       );
    }
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Surface disabled\n",
                      "virtual IOReturn IOAccelSurface::surface_lock_options(enum eLockType, uint32_t, IOAccelSurfaceData *, IOByteCount)"
                     );
  }
  uVar9 = 0xe00002cc;
LAB_00037762:
  pIVar1 = (IOGraphicsAccelerator2 *)param_1[0x259];
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar9;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurface::surface_unlock_options(eLockType, unsigned int)

ulong __cdecl IOAccelSurface::surface_unlock_options(long param_1,int param_2)

{
  char cVar1;
  IOGraphicsAccelerator2 *pIVar2;
  IOAccelResource2 *this;
  ulong uVar3;
  ulong uVar4;
  uint uVar5;
  
  pIVar2 = *(IOGraphicsAccelerator2 **)(&DAT_000012c8 + param_1);
  _OSIncrementAtomic(pIVar2 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar2 + 0x88));
  _OSDecrementAtomic(pIVar2 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar2);
  (**(code **)(*(long *)pIVar2 + 0x850))(pIVar2,"",0);
  uVar3 = (ulong)(param_2 != 1);
  uVar4 = (ulong)(param_2 == 1) ^ 0x10d1;
  this = *(IOAccelResource2 **)(&DAT_000010d8 + uVar3 * 8 + param_1);
  *(undefined8 *)(&DAT_000010d8 + uVar3 * 8 + param_1) = 0;
  cVar1 = *(char *)(param_1 + uVar4);
  if ((cVar1 != '\x04') && (cVar1 != '\x02')) {
    if (cVar1 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: surface is not locked.\n",
                        "virtual IOReturn IOAccelSurface::surface_unlock_options(enum eLockType, uint32_t)"
                       );
      uVar5 = 0xe00002cc;
      goto LAB_00037af8;
    }
    IOAccelResource2::unlockForCPUAccess(this,*(long *)(param_1 + 0xe8),param_2);
  }
  if (param_2 == 2) {
    *(undefined1 *)(param_1 + 0xf3) = 1;
  }
  *(undefined1 *)(param_1 + uVar4) = 0;
  (**(code **)(*(long *)this + 0x28))(this);
  uVar5 = 0;
LAB_00037af8:
  pIVar2 = *(IOGraphicsAccelerator2 **)(&DAT_000012c8 + param_1);
  (**(code **)(*(long *)pIVar2 + 0x858))(pIVar2,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar2);
  _IOLockUnlock(*(undefined8 *)(pIVar2 + 0x88));
  return (ulong)uVar5;
}



// IOAccelSurface::update_swap_event(IOAccelEvent*)

void __thiscall IOAccelSurface::update_swap_event(IOAccelSurface *this,undefined8 param_1)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = *(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8);
                    // WARNING: Could not recover jumptable at 0x00037b5b. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)
            (*(long **)(*(long *)(this + 0x12c8) + 0x380),param_1,this + 0x10e8,
             UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelSurface::update_previous_swap()

void __thiscall IOAccelSurface::update_previous_swap(IOAccelSurface *this)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = *(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b0);
                    // WARNING: Could not recover jumptable at 0x00037b8c. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)
            (*(long **)(*(long *)(this + 0x12c8) + 0x380),this + 0x10e8,this + 0x1128,
             UNRECOVERED_JUMPTABLE);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurface::set_shape(eIOAccelSurfaceShapeBits, unsigned int, IOAccelDeviceRegion*, unsigned
// long long)

void __cdecl IOAccelSurface::set_shape(long *param_1)

{
  (**(code **)(*param_1 + 0xa18))();
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurface::s_set_shape(IOAccelSurface*, void*, IOExternalMethodArguments*)

undefined4 __cdecl IOAccelSurface::s_set_shape(long *param_1,undefined8 param_2,long param_3)

{
  undefined4 uVar1;
  long *plVar2;
  long lVar3;
  ulong uVar4;
  
  plVar2 = *(long **)(param_3 + 0x40);
  if (plVar2 == (long *)0x0) {
    uVar4 = (ulong)*(uint *)(param_3 + 0x38);
    lVar3 = *(long *)(param_3 + 0x30);
    plVar2 = (long *)0x0;
  }
  else {
    plVar2 = (long *)(**(code **)(*plVar2 + 0x200))(plVar2,0x1000);
    if (plVar2 == (long *)0x0) {
      return 0xe00002c8;
    }
    lVar3 = (**(code **)(*plVar2 + 0x118))(plVar2);
    uVar4 = (**(code **)(**(long **)(param_3 + 0x40) + 0x1c8))();
  }
  uVar1 = 0xe00002c2;
  if ((lVar3 != 0) && (0xb < uVar4)) {
    uVar1 = (**(code **)(*param_1 + 0xa10))
                      (param_1,**(undefined4 **)(param_3 + 0x20),
                       (*(undefined4 **)(param_3 + 0x20))[2],lVar3,uVar4);
  }
  if (plVar2 != (long *)0x0) {
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return uVar1;
}



// IOAccelSurface::externalMethod(unsigned int, IOExternalMethodArguments*,
// IOExternalMethodDispatch*, OSObject*, void*)

undefined4 __thiscall
IOAccelSurface::externalMethod
          (IOAccelSurface *this,undefined4 param_1,long param_2,undefined **param_3,
          IOAccelSurface *param_4,undefined8 param_5)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  IOGraphicsAccelerator2 *this_00;
  undefined4 uVar5;
  int iVar6;
  IOAccelLegacySurface *this_01;
  undefined8 uVar7;
  undefined8 uVar8;
  long lVar9;
  
  _OSIncrementAtomic(this + 0x1328);
  uVar5 = 0xe00002d7;
  if (this[0x1334] != (IOAccelSurface)0x0) goto LAB_00037dff;
  switch(param_1) {
  case 6:
    if (*(int *)(param_2 + 0x28) != 4) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: must have 4 scalar arguments. actual is %d\n",
                        "virtual IOReturn IOAccelSurface::externalMethod(uint32_t, IOExternalMethodArguments *, IOExternalMethodDispatch *, OSObject *, void *)"
                       );
      return 0xe00002c2;
    }
    puVar4 = *(undefined4 **)(param_2 + 0x20);
    uVar5 = *puVar4;
    uVar1 = puVar4[2];
    uVar7 = *(undefined8 *)(puVar4 + 4);
    uVar2 = puVar4[6];
    uVar3 = *(undefined4 *)(param_2 + 0x38);
    lVar9 = *(long *)this;
    uVar8 = 0;
    goto LAB_00037dc9;
  case 7:
    if (*(int *)(param_2 + 0x28) != 2) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: must have 2 scalar arguments. actual is %d\n",
                        "virtual IOReturn IOAccelSurface::externalMethod(uint32_t, IOExternalMethodArguments *, IOExternalMethodDispatch *, OSObject *, void *)"
                       );
      return 0xe00002c2;
    }
    uVar5 = (**(code **)(*(long *)this + 0xa08))
                      (this,**(undefined4 **)(param_2 + 0x20),(*(undefined4 **)(param_2 + 0x20))[2])
    ;
    goto LAB_00037dff;
  default:
    break;
  case 9:
    param_3 = &externalMethod(unsigned_int,IOExternalMethodArguments*,IOExternalMethodDispatch*,OSObject*,void*)
               ::newResourceDispatch;
    param_1 = 9;
    param_4 = this;
    break;
  case 10:
    if (*(int *)(param_2 + 0x28) != 2) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: must have 2 scalar arguments. actual is %d\n",
                        "virtual IOReturn IOAccelSurface::externalMethod(uint32_t, IOExternalMethodArguments *, IOExternalMethodDispatch *, OSObject *, void *)"
                       );
      return 0xe00002c2;
    }
    this_01 = (IOAccelLegacySurface *)
              OSMetaClassBase::safeMetaCast
                        ((OSMetaClassBase *)this,(OSMetaClass *)&IOAccelLegacySurface::gMetaClass);
    if (this_01 == (IOAccelLegacySurface *)0x0) {
      uVar5 = 0xaaaaaaaa;
    }
    else {
      uVar7 = IOAccelLegacySurface::surface_flush
                        (this_01,**(uint **)(param_2 + 0x20),(*(uint **)(param_2 + 0x20))[2]);
      uVar5 = (undefined4)uVar7;
    }
    goto LAB_00037dff;
  case 0x11:
    puVar4 = *(undefined4 **)(param_2 + 0x20);
    uVar5 = *puVar4;
    uVar1 = puVar4[2];
    uVar7 = *(undefined8 *)(puVar4 + 4);
    uVar2 = puVar4[6];
    uVar8 = *(undefined8 *)(puVar4 + 8);
    uVar3 = *(undefined4 *)(param_2 + 0x38);
    lVar9 = *(long *)this;
LAB_00037dc9:
    uVar5 = (**(code **)(lVar9 + 0xa18))
                      (this,uVar5,uVar1,uVar7,uVar2,uVar8,*(undefined8 *)(param_2 + 0x30),uVar3);
    goto LAB_00037dff;
  case 0x12:
    param_3 = &sSignalEventDispatch;
    param_1 = 0x12;
    param_4 = this;
  }
  uVar5 = (**(code **)(PTR_vtable_0006b088 + 0x860))(this,param_1,param_2,param_3,param_4,param_5);
LAB_00037dff:
  iVar6 = _OSDecrementAtomic(this + 0x1328);
  if ((iVar6 == 1) && (this[0x1334] != (IOAccelSurface)0x0)) {
    _IOLockLock(*(undefined8 *)(this + 0x1320));
    if (this[0x1335] == (IOAccelSurface)0x0) {
      _IOLockUnlock(*(undefined8 *)(this + 0x1320));
    }
    else {
      this[0x1335] = (IOAccelSurface)0x0;
      _IOLockUnlock(*(undefined8 *)(this + 0x1320));
      this_00 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
      (**(code **)(*(long *)this_00 + 0x20))(this_00);
      _OSIncrementAtomic(this_00 + 0x90);
      _IOLockLock(*(undefined8 *)(this_00 + 0x88));
      _OSDecrementAtomic(this_00 + 0x90);
      IOGraphicsAccelerator2::lock_busy(this_00);
      (**(code **)(*(long *)this_00 + 0x850))(this_00,"",0);
      detach_surface(this);
      (**(code **)(*(long *)this_00 + 0x858))(this_00,"",0);
      IOGraphicsAccelerator2::unlock_busy(this_00);
      _IOLockUnlock(*(undefined8 *)(this_00 + 0x88));
      (**(code **)(*(long *)this_00 + 0x28))(this_00);
    }
  }
  return uVar5;
}



// IOAccelSurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, unsigned int, unsigned
// long long, unsigned int, unsigned long long, IOAccelDeviceRegion*, unsigned long long)

undefined8 __thiscall
IOAccelSurface::set_shape_backing_length_ext
          (IOAccelSurface *this,uint param_1,uint param_2,ulong param_3,uint param_4,ulong param_5,
          uint *param_6,ulong param_7)

{
  int *piVar1;
  short sVar2;
  IOGraphicsAccelerator2 *pIVar3;
  long lVar4;
  long *plVar5;
  IOAccelResource2 *this_00;
  bool bVar6;
  bool bVar7;
  char cVar8;
  short sVar9;
  uint uVar10;
  undefined4 uVar11;
  int iVar12;
  undefined8 *puVar13;
  IOAccelSurface *pIVar14;
  ulong uVar15;
  ulong uVar16;
  IOAccelSurface IVar17;
  short sVar18;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 uVar19;
  short sVar20;
  ulong uVar21;
  undefined8 uVar22;
  ulong uVar23;
  long lVar24;
  IOAccelSurface *pIVar25;
  undefined8 local_88;
  undefined8 local_80;
  undefined4 local_78;
  ulong local_70;
  long local_68;
  IOAccelSurface *local_60;
  uint *local_58;
  undefined4 local_4c;
  ulong local_48;
  ulong local_40;
  uint local_34;
  
  local_80 = 0;
  local_88 = 0;
  local_78 = 0;
  local_70 = param_5;
  uVar10 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x12d0));
  if (uVar10 <= param_2) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Bad frame buffer index\n",
                      "virtual IOReturn IOAccelSurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                     );
    return 0xe00002bc;
  }
  local_48 = param_3;
  local_40 = (ulong)param_4;
  if (param_7 == 0) {
    local_58 = (uint *)&local_88;
  }
  else {
    if (param_7 < 0xc) {
      return 0xe00002bc;
    }
    if ((ulong)*param_6 * 8 + 0xc != param_7) {
      return 0xe00002bc;
    }
    sVar18 = (short)param_6[2];
    if ((sVar18 < 0) || (*(short *)((long)param_6 + 10) < 0)) {
LAB_0003820e:
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: bounds width or height invalid, w=%d h=%d\n",
                        "virtual IOReturn IOAccelSurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                        ,(int)sVar18,(int)*(short *)((long)param_6 + 10));
      return 0xe00002bc;
    }
    local_58 = param_6;
    cVar8 = (**(code **)(*(long *)this + 0x988))
                      (this,(int)sVar18,(int)*(short *)((long)param_6 + 10));
    sVar18 = (short)param_6[2];
    if (cVar8 == '\0') goto LAB_0003820e;
    if ((sVar18 == 0) || (*(short *)((long)param_6 + 10) == 0)) {
      param_6[2] = 0x10001;
      local_40 = 0;
      local_48 = 0;
    }
  }
  pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
  _OSIncrementAtomic(pIVar3 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar3 + 0x88));
  _OSDecrementAtomic(pIVar3 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar3);
  (**(code **)(*(long *)pIVar3 + 0x850))(pIVar3,"",0);
  uVar19 = extraout_RDX;
  if (((param_1 & 0x80) != 0) &&
     (uVar11 = IOGraphicsAccelerator2::acceleratorWaitEnabled
                         (*(IOGraphicsAccelerator2 **)(this + 0x12c8)), uVar19 = extraout_RDX_00,
     (char)uVar11 == '\0')) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: %s device terminated\n",
                      "virtual IOReturn IOAccelSurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                      ,*(undefined8 *)(*(long *)(this + 0x12c8) + 0xc88));
    pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
    (**(code **)(*(long *)pIVar3 + 0x858))(pIVar3,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar3);
    _IOLockUnlock(*(undefined8 *)(pIVar3 + 0x88));
    return 0xe00002c0;
  }
  if ((this[0x10d0] != (IOAccelSurface)0x0) || (this[0x10d1] != (IOAccelSurface)0x0)) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Deadlock.  SetSurfaceShape called with buffer locked.\n",
                      "virtual IOReturn IOAccelSurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                     );
    uVar22 = 0xe00002cc;
    goto LAB_0003818d;
  }
  uVar16 = *(ulong *)(this + 0x11b0);
  if ((uVar16 & 0x20) == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Called on full screen surface.\n",
                      "virtual IOReturn IOAccelSurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                     );
    uVar22 = 0xe00002bc;
    goto LAB_0003818d;
  }
  *(uint *)(this + 0x1170) = param_1;
  if (((param_1 & 4) == 0) || (this[0x1005] == (IOAccelSurface)0x0)) {
    uVar22 = 0xe00002c2;
    if (((param_1 >> 0xe & 1) != 0) || ((uVar16 & 0xc00) != 0)) goto LAB_0003818d;
    local_4c = (undefined4)CONCAT71((int7)((ulong)uVar19 >> 8),1);
    if ((this[0x1005] == (IOAccelSurface)0x0) &&
       ((*(short *)(this + 0x11bc) != (short)local_58[2] ||
        (*(short *)(this + 0x11be) != *(short *)((long)local_58 + 10))))) goto LAB_00038341;
  }
  else {
    this[0x1005] = (IOAccelSurface)0x0;
    uVar22 = 0xe00002c2;
    if (((param_1 >> 0xe & 1) != 0) || ((uVar16 & 0xc00) != 0)) goto LAB_0003818d;
LAB_00038341:
    local_4c = 0;
  }
  lVar24 = (ulong)param_2 * 0x10;
  pIVar25 = this + lVar24 + 0x1050;
  uVar10 = (uint)param_7;
  local_34 = param_1;
  if ((*(uint *)(this + lVar24 + 0x1058) < param_7) ||
     ((uVar10 & 0xffffff00) != (*(uint *)(this + lVar24 + 0x1058) & 0xffffff00))) {
    puVar13 = (undefined8 *)_IOMallocData();
    if (puVar13 != (undefined8 *)0x0) {
      lVar4 = *(long *)(this + 0x12c8);
      pIVar14 = this + lVar24 + 0x1058;
      local_68 = lVar24;
      if (lVar4 != 0) {
        local_60 = this + lVar24 + 0x1058;
        IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar4 + 0x388) + 0x58),0x51);
        *(int *)(lVar4 + 0x2e4) = *(int *)(lVar4 + 0x2e4) + uVar10;
        pIVar14 = local_60;
      }
      _IOFreeData(*(long *)pIVar25,*(uint *)pIVar14);
      lVar24 = *(long *)(this + 0x12c8);
      if (lVar24 != 0) {
        local_60 = (IOAccelSurface *)CONCAT44(local_60._4_4_,*(uint *)pIVar14);
        IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar24 + 0x388) + 0x58),0x51);
        *(int *)(lVar24 + 0x2e4) = *(int *)(lVar24 + 0x2e4) - (int)local_60;
      }
      *(undefined8 **)pIVar25 = puVar13;
      *(uint *)pIVar14 = uVar10;
      lVar24 = local_68;
      goto LAB_00038474;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Failed to alloc region\n",
                      "virtual IOReturn IOAccelSurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                     );
  }
  else {
    puVar13 = *(undefined8 **)pIVar25;
LAB_00038474:
    uVar16 = local_48;
    *(uint *)(puVar13 + 1) = local_58[2];
    *puVar13 = *(undefined8 *)local_58;
    if (*local_58 == 0) {
      bVar7 = false;
LAB_000384f9:
      bVar6 = bVar7;
      IVar17 = (IOAccelSurface)0x0;
    }
    else {
      uVar15 = 0;
      do {
        *(undefined8 *)(*(long *)pIVar25 + 0xc + uVar15 * 8) =
             *(undefined8 *)(local_58 + uVar15 * 2 + 3);
        uVar15 = uVar15 + 1;
      } while (uVar15 < *local_58);
      if (*local_58 != 1) {
        bVar7 = false;
        goto LAB_000384f9;
      }
      if ((short)local_58[4] == 0) {
        IVar17 = (IOAccelSurface)0x1;
        bVar6 = true;
      }
      else {
        bVar6 = true;
        bVar7 = true;
        if (*(short *)((long)local_58 + 0x12) != 0) goto LAB_000384f9;
        IVar17 = (IOAccelSurface)0x1;
      }
    }
    this[(long)(&DAT_0000105c + lVar24)] = IVar17;
    this[0xf0] = (IOAccelSurface)0x1;
    if (this[0x1005] == (IOAccelSurface)0x0) {
      *(short *)(this + 0x11bc) = (short)local_58[2];
      *(undefined2 *)(this + 0x11be) = *(undefined2 *)((long)local_58 + 10);
    }
    if (bVar6 && local_48 != 0) {
      sVar18 = (short)local_58[4];
      sVar20 = *(short *)((long)local_58 + 0x12);
      sVar9 = *(short *)(this + 0x11bc);
      sVar2 = *(short *)(this + 0x11be);
    }
    else {
      sVar18 = *(short *)(this + 0x11bc);
      sVar20 = *(short *)(this + 0x11be);
      sVar9 = sVar18;
      sVar2 = sVar20;
    }
    *(short *)(this + 0x11b8) = sVar18;
    *(short *)(this + 0x11ba) = sVar20;
    cVar8 = (**(code **)(*(long *)this + 0x988))(this,(int)sVar9,(int)sVar2);
    if (cVar8 != '\0') {
      bVar7 = false;
      cVar8 = (char)local_4c;
      if ((int)local_40 != -1) {
        if ((((int)local_40 == 0) || (uVar16 == 0)) || ((*(uint *)(this + 0x1190) & 3) != 0)) {
          if ((this[0x10d0] != (IOAccelSurface)0x3) &&
             (bVar7 = false, this[0x10d1] != (IOAccelSurface)0x3)) goto LAB_00038683;
          bVar7 = false;
          if (((byte)this[0x1190] & 1) != 0) {
            detach_buffer_at_index(this,0);
            this[0x11a0] = (IOAccelSurface)((byte)this[0x11a0] & 0xfe);
            bVar7 = true;
          }
        }
        else {
          *(uint *)(this + 0x1190) = *(uint *)(this + 0x1190) | 1;
          bVar7 = true;
        }
        (**(code **)(*(long *)this + 0x9e0))(this);
      }
LAB_00038683:
      if (cVar8 == '\0') {
        this[0xf3] = (IOAccelSurface)0x0;
        (**(code **)(*(long *)this + 0x9d8))(this);
        param_1 = local_34;
        for (plVar5 = *(long **)(this + 0x1018); plVar5 != (long *)0x0;
            plVar5 = (long *)plVar5[0x26]) {
          (**(code **)(*plVar5 + 0x140))(plVar5);
        }
      }
      else {
        uVar16 = update_displayable(this);
        param_1 = local_34;
        if ((bVar7) && ((char)uVar16 == '\0')) {
          (**(code **)(*(long *)this + 0x9d8))(this);
        }
      }
      uVar22 = 0;
      if (((((byte)this[0x1190] & 1) != 0) && ((int)local_40 != -1)) &&
         (this_00 = *(IOAccelResource2 **)(this + 0x11c0), this_00 != (IOAccelResource2 *)0x0)) {
        if (*(long *)(this_00 + 0x80) != 0) {
          IOAccelResource2::deleteBackingMemory(this_00);
        }
        uVar22 = 0;
        if (((int)local_40 != 0) && (local_48 != 0)) {
          uVar16 = local_70;
          if ((local_70 == 0) &&
             (uVar15 = (ulong)*(ushort *)(this_00 + 0xb2) * (local_40 & 0xffffffff),
             uVar16 = uVar15 & 0xffffffff, (int)(uVar15 >> 0x20) != 0)) {
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: size overflow\n",
                              "virtual IOReturn IOAccelSurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                             );
          }
          else {
            uVar15 = *(long *)PTR__page_size_0006b108 - 1;
            uVar16 = (uVar16 & 0xffffffff) + (ulong)((uint)uVar15 & (uint)local_48);
            if (!CARRY8(uVar16,uVar15)) {
              uVar21 = -*(long *)PTR__page_size_0006b108;
              uVar23 = local_48 & uVar21;
              lVar24 = IOAccelSysMemory::withClientBuffer
                                 (*(long **)(this + 0x12c8),*(undefined8 *)(this + 0xe8),0,uVar23,
                                  uVar16 + uVar15 & uVar21);
              uVar10 = local_34;
              if (lVar24 == 0) {
                __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: bad backing\n",
                                  "virtual IOReturn IOAccelSurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                                 );
                uVar22 = 0xe00002c8;
              }
              else {
                if ((param_1 & 0x20) == 0) {
                  this[0xf3] = (IOAccelSurface)0x1;
                }
                IOAccelResource2::setBackingMemory
                          (this_00,lVar24,(int)local_48 - (int)uVar23,(int)local_40,
                           (uint)((local_34 & 0x20) == 0));
                uVar22 = 0;
                param_1 = uVar10;
              }
              goto LAB_0003818d;
            }
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: size overflow\n",
                              "virtual IOReturn IOAccelSurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                             );
          }
          uVar22 = 0xe0000001;
        }
      }
      goto LAB_0003818d;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: bounds are too big\n",
                      "virtual IOReturn IOAccelSurface::set_shape_backing_length_ext(eIOAccelSurfaceShapeBits, uint32_t, mach_vm_address_t, uint32_t, IOByteCount, IOAccelDeviceRegion *, IOByteCount)"
                     );
    this[0x118c] = (IOAccelSurface)0x1;
  }
  uVar22 = 0xe00002be;
  param_1 = local_34;
LAB_0003818d:
  if ((param_1 & 1) == 0) {
    iVar12 = (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x188))
                       (*(long **)(*(long *)(this + 0x12c8) + 0x380),this + 0x10e8);
    lVar24 = *(long *)(this + 0x12c8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar24 + 0x388) + 0x58),0x3b);
    piVar1 = (int *)(lVar24 + 0x28c);
    *piVar1 = *piVar1 + iVar12;
  }
  pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
  (**(code **)(*(long *)pIVar3 + 0x858))(pIVar3,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar3);
  _IOLockUnlock(*(undefined8 *)(pIVar3 + 0x88));
  return uVar22;
}



// IOAccelSurface::detach_buffer_at_index(int)

void __thiscall IOAccelSurface::detach_buffer_at_index(IOAccelSurface *this,int param_1)

{
  long *plVar1;
  undefined8 *puVar2;
  byte bVar3;
  long lVar4;
  long lVar5;
  
  lVar5 = *(long *)(this + 0x1018);
  lVar4 = (long)param_1;
  if (lVar5 != 0) {
    bVar3 = (byte)param_1 & 0x1f;
    do {
      plVar1 = *(long **)(lVar5 + 0x28 + lVar4 * 8);
      if (plVar1 != (long *)0x0) {
        IOAccelResource2::clientRelease(plVar1);
        (**(code **)(**(long **)(lVar5 + 0x28 + lVar4 * 8) + 0x28))();
        *(undefined8 *)(lVar5 + 0x28 + lVar4 * 8) = 0;
        *(uint *)(lVar5 + 0x140) =
             *(uint *)(lVar5 + 0x140) & (-2 << bVar3 | 0xfffffffeU >> 0x20 - bVar3);
      }
      lVar5 = *(long *)(lVar5 + 0x130);
    } while (lVar5 != 0);
  }
  plVar1 = *(long **)(this + (long)(&DAT_000011c0 + lVar4 * 8));
  puVar2 = (undefined8 *)plVar1[6];
  *puVar2 = 0;
  puVar2[1] = 0;
  puVar2[2] = 0;
  *(byte *)((long)puVar2 + 0x1c) = *(byte *)((long)puVar2 + 0x1c) & 0xfe;
  *(undefined8 *)(this + (long)(&DAT_000011c0 + lVar4 * 8)) = 0;
                    // WARNING: Could not recover jumptable at 0x000388f2. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*plVar1 + 0x28))();
  return;
}



// IOAccelSurface::update_contexts()

void __thiscall IOAccelSurface::update_contexts(IOAccelSurface *this)

{
  long *plVar1;
  
  for (plVar1 = *(long **)(this + 0x1018); plVar1 != (long *)0x0; plVar1 = (long *)plVar1[0x26]) {
    (**(code **)(*plVar1 + 0x140))(plVar1);
  }
  return;
}



// IOAccelSurface::update_displayable()

ulong __thiscall IOAccelSurface::update_displayable(IOAccelSurface *this)

{
  char cVar1;
  uint uVar2;
  long *plVar3;
  long lVar4;
  long alStack_1218 [557];
  Alignment *pAStack_b0;
  undefined1 *local_a0;
  undefined1 *local_98;
  undefined1 *local_90;
  undefined1 *local_88;
  undefined1 *local_80;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  uint local_5c;
  long local_58 [4];
  long local_38;
  
  local_38 = *(long *)PTR____stack_chk_guard_0006b0b0;
  uVar2 = *(uint *)(this + 0x1170) ^ *(uint *)(this + 0x1330);
  if ((uVar2 >> 0xf & 1) != 0) {
    lVar4 = 0;
    local_58[2] = 0;
    local_58[1] = 0;
    local_58[0] = 0;
    local_5c = uVar2;
    do {
      if ((*(uint *)(this + 0x1190) >> ((uint)lVar4 & 0x1f) & 1) == 0) {
        plVar3 = (long *)local_58[lVar4];
      }
      else {
        plVar3 = *(long **)(this + (long)(&DAT_000011c0 + lVar4 * 8));
        local_58[lVar4] = (long)plVar3;
      }
      if (plVar3 != (long *)0x0) {
        pAStack_b0 = (Alignment *)0x38999;
        (**(code **)(*plVar3 + 0x20))();
      }
      lVar4 = lVar4 + 1;
    } while (lVar4 != 3);
    pAStack_b0 = (Alignment *)0x389ae;
    (**(code **)(*(long *)this + 0x9d8))(this);
    lVar4 = 0x238;
    do {
      plVar3 = (long *)alStack_1218[lVar4];
      if (plVar3 != (long *)0x0) {
        if ((*(long **)(this + lVar4 * 8) != (long *)0x0) &&
           (*(long **)(this + lVar4 * 8) != plVar3)) {
          pAStack_b0 = (Alignment *)0x389f8;
          cVar1 = (**(code **)(*plVar3 + 0x170))(plVar3);
          if (cVar1 != '\0') {
            pAStack_b0 = (Alignment *)0x38a0d;
            cVar1 = (**(code **)(**(long **)(this + lVar4 * 8) + 0x170))();
            if (cVar1 != '\0') {
              local_68 = &DAT_aaaaaaaaaaaaaaaa;
              local_70 = &DAT_aaaaaaaaaaaaaaaa;
              local_78 = &DAT_aaaaaaaaaaaaaaaa;
              local_80 = &DAT_aaaaaaaaaaaaaaaa;
              local_88 = &DAT_aaaaaaaaaaaaaaaa;
              local_90 = &DAT_aaaaaaaaaaaaaaaa;
              local_98 = &DAT_aaaaaaaaaaaaaaaa;
              local_a0 = &DAT_aaaaaaaaaaaaaaaa;
              pAStack_b0 = (Alignment *)0x38a58;
              (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x140))
                        (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_a0);
              pAStack_b0 = (Alignment *)0x38a6e;
              (**(code **)(*(long *)this + 0x970))
                        (this,&local_a0,plVar3,*(undefined8 *)(this + lVar4 * 8));
              pAStack_b0 = (Alignment *)0x38a95;
              (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                        (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_a0,
                         (ulong)*(byte *)((long)plVar3 + 0x15) * 0x40 + plVar3[7]);
              pAStack_b0 = (Alignment *)0x38abf;
              (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                        (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_a0,
                         (ulong)*(byte *)(*(long *)(this + lVar4 * 8) + 0x15) * 0x40 +
                         *(long *)(*(long *)(this + lVar4 * 8) + 0x38));
              pAStack_b0 = (Alignment *)0x38ae9;
              (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                        (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_a0,
                         (ulong)*(byte *)(*(long *)(this + lVar4 * 8) + 0x16) * 0x40 +
                         *(long *)(*(long *)(this + lVar4 * 8) + 0x38));
              pAStack_b0 = (Alignment *)0x38b03;
              (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x148))
                        (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_a0);
              pAStack_b0 = (Alignment *)0x38b14;
              (**(code **)(**(long **)(this + lVar4 * 8) + 0x168))(*(long **)(this + lVar4 * 8),0,0)
              ;
              pAStack_b0 = (Alignment *)0x38b21;
              (**(code **)(**(long **)(this + lVar4 * 8) + 0x178))();
            }
            pAStack_b0 = (Alignment *)0x38b2d;
            (**(code **)(*plVar3 + 0x178))(plVar3);
          }
        }
        pAStack_b0 = (Alignment *)0x38b36;
        (**(code **)(*plVar3 + 0x28))(plVar3);
      }
      lVar4 = lVar4 + 1;
      uVar2 = local_5c;
    } while (lVar4 != 0x23b);
  }
  if (*(long *)PTR____stack_chk_guard_0006b0b0 != local_38) {
                    // WARNING: Subroutine does not return
    pAStack_b0 = &UNK_00038b73;
    ___stack_chk_fail();
  }
  return ((ulong)uVar2 & 0xffff) >> 0xf;
}



// IOAccelSurface::set_scaling(unsigned int, IOAccelSurfaceScaling*)

undefined8 __thiscall
IOAccelSurface::set_scaling(IOAccelSurface *this,ulong param_2_00,long param_2)

{
  long lVar1;
  bool bVar2;
  bool bVar3;
  char cVar4;
  short sVar5;
  undefined8 uVar6;
  short sVar7;
  short sVar8;
  long *plVar9;
  
  if (((param_2_00 & 2) != 0) && (param_2 == 0)) {
    return 0xe00002c2;
  }
  if ((param_2_00 & 2) == 0) {
    this[0x1005] = (IOAccelSurface)0x0;
    lVar1 = *(long *)(this + 0x1050);
    sVar7 = *(short *)(lVar1 + 8);
    if (*(short *)(this + 0x11bc) == sVar7) {
      sVar5 = *(short *)(this + 0x11be);
      sVar8 = *(short *)(lVar1 + 10);
      if (sVar5 != *(short *)(lVar1 + 10)) goto LAB_00038c04;
      bVar3 = false;
    }
    else {
      sVar8 = *(short *)(lVar1 + 10);
LAB_00038c04:
      sVar5 = sVar8;
      bVar3 = true;
    }
    *(short *)(this + 0x11bc) = sVar7;
    *(short *)(this + 0x11be) = sVar5;
  }
  else {
    sVar7 = *(short *)(param_2 + 4);
    if (sVar7 < 0) {
      return 0xe00002c2;
    }
    sVar8 = *(short *)(param_2 + 6);
    if (sVar8 < 0) {
      return 0xe00002c2;
    }
    if (((byte)this[0x11b0] & 0x20) == 0) {
      sVar7 = *(short *)(this + 0x11bc);
      uVar6 = 0xe00002bc;
      bVar2 = false;
      bVar3 = false;
      goto LAB_00038c1b;
    }
    this[0x1005] = (IOAccelSurface)0x1;
    if ((*(short *)(this + 0x11bc) == sVar7) && (*(short *)(this + 0x11be) == sVar8)) {
      bVar3 = false;
    }
    else {
      bVar3 = true;
    }
    *(short *)(this + 0x11bc) = sVar7;
    *(short *)(this + 0x11be) = sVar8;
  }
  uVar6 = 0;
  bVar2 = true;
LAB_00038c1b:
  if ((sVar7 == 0) || (sVar8 = *(short *)(this + 0x11be), sVar8 == 0)) {
    *(undefined4 *)(this + 0x11bc) = 0x10001;
    sVar8 = 1;
    sVar7 = 1;
  }
  *(short *)(this + 0x11b8) = sVar7;
  *(short *)(this + 0x11ba) = sVar8;
  if (bVar2) {
    if (bVar3) {
      this[0xf3] = (IOAccelSurface)0x0;
    }
    (**(code **)(*(long *)this + 0x9d8))(this);
    for (plVar9 = *(long **)(this + 0x1018); plVar9 != (long *)0x0; plVar9 = (long *)plVar9[0x26]) {
      (**(code **)(*plVar9 + 0x140))(plVar9);
    }
    this[0x118c] = (IOAccelSurface)0x0;
    cVar4 = (**(code **)(*(long *)this + 0x988))
                      (this,(int)*(short *)(this + 0x11bc),(int)*(short *)(this + 0x11be));
    uVar6 = 0;
    if (cVar4 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: bounds are too big\n",
                        "virtual IOReturn IOAccelSurface::set_scaling(IOOptionBits, IOAccelSurfaceScaling *)"
                       );
      this[0x118c] = (IOAccelSurface)0x1;
      uVar6 = 0xe00002be;
    }
  }
  return uVar6;
}



// IOAccelSurface::surface_control_with_lock(unsigned int, unsigned int, unsigned int*)

undefined8 __thiscall
IOAccelSurface::surface_control_with_lock
          (IOAccelSurface *this,int param_1,int param_2,uint *param_3)

{
  IOAccelResource2 *this_00;
  long lVar1;
  ushort uVar2;
  int iVar3;
  ulong uVar4;
  uint uVar5;
  uint uVar6;
  ulong uVar7;
  
  if (param_1 == 5) {
    this_00 = *(IOAccelResource2 **)(this + 0x11c0);
    if (this_00 == (IOAccelResource2 *)0x0) {
      return 0xe00002bc;
    }
    if (*(long *)(this_00 + 0x80) == 0) {
      return 0xe00002bc;
    }
    if ((*(byte *)(*(long *)(this_00 + 0x80) + 0xc) & 0x40) == 0) {
      return 0xe00002bc;
    }
    *param_3 = (uint)(byte)this[0x1004];
    this[0x1004] = (IOAccelSurface)(param_2 != 0);
    if (param_2 == 0) {
      *(uint *)(this_00 + 0xc) = *(uint *)(this_00 + 0xc) & 0xfffdffff;
      iVar3 = 2;
    }
    else {
      *(uint *)(this_00 + 0xc) = *(uint *)(this_00 + 0xc) | 0x20000;
      if ((*(byte *)(*(long *)(this_00 + 0x30) + 0xc) & 1) == 0) {
        return 0;
      }
      iVar3 = 3;
    }
    IOAccelResource2::setPurgeable(this_00,iVar3,1,(uint *)0x0);
    return 0;
  }
  if (param_1 != 4) {
    if (param_1 != 1) {
      return 0xe00002c2;
    }
    this[0xf1] = (IOAccelSurface)(param_2 != 0);
    if (param_2 != 0) {
      return 0;
    }
    _IOLockWakeup_darwin14(*(undefined8 *)(*(long *)(this + 0x12c8) + 0x88),this,0);
    return 0;
  }
  if (*(uint *)(this + 0x1190) != 0) {
    uVar4 = 0;
    uVar6 = *(uint *)(this + 0x1190);
    do {
      uVar5 = uVar6;
      if ((uVar5 & 1) != 0) {
        lVar1 = *(long *)(this + (long)(&DAT_000011c0 + uVar4 * 8));
        if (lVar1 == 0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Missing buffer\n",
                            "virtual IOReturn IOAccelSurface::surface_control_with_lock(uint32_t, uint32_t, uint32_t *)"
                           );
          return 0xe00002bc;
        }
        uVar6 = 2;
        if ((ulong)*(byte *)(lVar1 + 0xac) == 0) goto LAB_00038e70;
        uVar7 = 0;
        uVar2 = 0;
        do {
          uVar2 = uVar2 | (*(ushort *)(*(long *)(lVar1 + 0x30) + uVar7 * 2) |
                          *(ushort *)(*(long *)(lVar1 + 0x30) + 0xc + uVar7 * 2)) & 1;
          uVar7 = uVar7 + 1;
        } while (*(byte *)(lVar1 + 0xac) != uVar7);
        if (uVar2 == 0) goto LAB_00038e70;
      }
      if (0xb < uVar4) break;
      uVar4 = uVar4 + 1;
      uVar6 = (int)uVar5 >> 1;
    } while (1 < uVar5);
    uVar6 = 2;
    if (1 < uVar5) goto LAB_00038e70;
  }
  uVar6 = *(uint *)(this + 0x1000);
LAB_00038e70:
  *param_3 = uVar6;
  set_volatile_state(this,param_2);
  return 0;
}



// IOAccelSurface::set_volatile_state(eSurfaceVolatileState)

void __thiscall IOAccelSurface::set_volatile_state(IOAccelSurface *this,int param_1)

{
  int *piVar1;
  long lVar2;
  bool bVar3;
  uint uVar4;
  ulong uVar5;
  int iVar6;
  
  if (*(int *)(this + 0x1000) != param_1) {
    *(int *)(this + 0x1000) = param_1;
    if (param_1 == 0) {
      iVar6 = -1;
      if (*(uint *)(this + 0x1190) != 0) {
        uVar5 = 0;
        uVar4 = *(uint *)(this + 0x1190);
        do {
          if (((uVar4 & 1) != 0) &&
             (*(IOAccelResource2 **)(this + (long)(&DAT_000011c0 + uVar5 * 8)) !=
              (IOAccelResource2 *)0x0)) {
            IOAccelResource2::setPurgeable
                      (*(IOAccelResource2 **)(this + (long)(&DAT_000011c0 + uVar5 * 8)),1,2,
                       (uint *)0x0);
          }
          if (0xb < uVar5) break;
          uVar5 = uVar5 + 1;
          bVar3 = 1 < uVar4;
          uVar4 = (int)uVar4 >> 1;
        } while (bVar3);
      }
    }
    else {
      if (param_1 != 1) {
        return;
      }
      if (*(uint *)(this + 0x1190) == 0) {
        iVar6 = 1;
      }
      else {
        uVar5 = 0;
        iVar6 = 1;
        uVar4 = *(uint *)(this + 0x1190);
        do {
          if (((uVar4 & 1) != 0) &&
             (*(IOAccelResource2 **)(this + (long)(&DAT_000011c0 + uVar5 * 8)) !=
              (IOAccelResource2 *)0x0)) {
            IOAccelResource2::setPurgeable
                      (*(IOAccelResource2 **)(this + (long)(&DAT_000011c0 + uVar5 * 8)),1,3,
                       (uint *)0x0);
          }
          if (0xb < uVar5) break;
          uVar5 = uVar5 + 1;
          bVar3 = 1 < uVar4;
          uVar4 = (int)uVar4 >> 1;
        } while (bVar3);
      }
    }
    lVar2 = *(long *)(this + 0x12c8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar2 + 0x388) + 0x58),0x22);
    piVar1 = (int *)(lVar2 + 0x228);
    *piVar1 = *piVar1 + iVar6;
  }
  return;
}



// IOAccelSurface::signal_shared_event(unsigned long long, unsigned int, unsigned long long)

undefined8 __thiscall
IOAccelSurface::signal_shared_event
          (IOAccelSurface *this,long param_1,uint param_2,undefined8 param_3)

{
  IOGraphicsAccelerator2 *pIVar1;
  int iVar2;
  long lVar3;
  long *plVar4;
  IOAccelEventFence *pIVar5;
  undefined8 uVar6;
  OSObject *local_38;
  
  if (param_1 == 0) {
    local_38 = (OSObject *)0x0;
    iVar2 = IOUserClient::copyObjectForPortNameInTask(*(task **)(this + 0xe8),param_2,&local_38);
    if ((iVar2 == 0) &&
       (lVar3 = OSMetaClassBase::safeMetaCast
                          ((OSMetaClassBase *)local_38,*(OSMetaClass **)PTR_metaClass_0006b048),
       lVar3 != 0)) {
      pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
      _OSIncrementAtomic(pIVar1 + 0x90);
      _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
      _OSDecrementAtomic(pIVar1 + 0x90);
      IOGraphicsAccelerator2::lock_busy(pIVar1);
      uVar6 = 0;
      (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
      lVar3 = *(long *)(this + 0x11c0);
      plVar4 = (long *)IOSurfaceSharedEventReference::getSharedEvent();
      if (lVar3 == 0) {
        IOSurfaceSharedEvent::signalCompleted((ulonglong)plVar4);
      }
      else {
        uVar6 = 0;
        pIVar5 = IOAccelSharedEventFence::withSharedEvent(plVar4,param_3,*(long *)(this + 0x12c8),0)
        ;
        if (pIVar5 == (IOAccelEventFence *)0x0) {
          uVar6 = 0xe00002bd;
        }
        else {
          (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b0))
                    (*(long **)(*(long *)(this + 0x12c8) + 0x380),
                     (ulong)*(byte *)(lVar3 + 0x16) * 0x40 + *(long *)(lVar3 + 0x38),pIVar5 + 0x68);
          IOAccelFenceMachine::addEventFence
                    (*(IOAccelFenceMachine **)(*(long *)(this + 0x12c8) + 0x390),0,(long)pIVar5);
        }
      }
      pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x12c8);
      (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar1);
      _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
    }
    else {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s:signal_shared_event: bad event port name: %d obj: %p\n",
                        "IOReturn IOAccelSurface::signal_shared_event(uint64_t, mach_port_name_t, uint64_t)"
                        ,param_2,local_38);
      uVar6 = 0xe00002c2;
    }
    if (local_38 != (OSObject *)0x0) {
      (**(code **)(*(long *)local_38 + 0x28))();
    }
    return uVar6;
  }
  return 0xe00002c7;
}



// IOAccelSurface::invalidate_contexts()

void __thiscall IOAccelSurface::invalidate_contexts(IOAccelSurface *this)

{
  int iVar1;
  OSMetaClassBase *pOVar2;
  long *plVar3;
  int iVar4;
  
  iVar1 = (**(code **)(**(long **)(this + 0x1028) + 0x130))();
  if (0 < iVar1) {
    iVar4 = 0;
    do {
      pOVar2 = (OSMetaClassBase *)
               (**(code **)(**(long **)(this + 0x1028) + 0x1e8))(*(long **)(this + 0x1028),iVar4);
      plVar3 = (long *)OSMetaClassBase::safeMetaCast
                                 (pOVar2,(OSMetaClass *)&IOAccelContext2::gMetaClass);
      if (plVar3 != (long *)0x0) {
        (**(code **)(*plVar3 + 0xaa8))(plVar3);
      }
      iVar4 = iVar4 + 1;
    } while (iVar1 != iVar4);
  }
  return;
}



// IOAccelSurface::reset_req_bits()

void __thiscall IOAccelSurface::reset_req_bits(IOAccelSurface *this)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  OSMetaClassBase *pOVar4;
  long *plVar5;
  int iVar6;
  IOAccelResource2 *this_00;
  
  *(undefined4 *)(this + 0x1188) = 0;
  uVar3 = 7;
  if ((*(uint *)(this + 0x11b0) >> 10 & 1) == 0) {
    uVar3 = *(uint *)(this + 0x1190) & 3;
  }
  *(uint *)(this + 0x1190) = uVar3;
  iVar2 = (**(code **)(**(long **)(this + 0x1028) + 0x130))();
  if (0 < iVar2) {
    iVar6 = 0;
    do {
      pOVar4 = (OSMetaClassBase *)
               (**(code **)(**(long **)(this + 0x1028) + 0x1e8))(*(long **)(this + 0x1028),iVar6);
      plVar5 = (long *)OSMetaClassBase::safeMetaCast
                                 (pOVar4,(OSMetaClass *)&IOAccelContext2::gMetaClass);
      if (plVar5 == (long *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: unknown object type\n",
                          "virtual void IOAccelSurface::reset_req_bits()");
      }
      else {
        bVar1 = (**(code **)(*plVar5 + 0xb08))(plVar5);
        this[0x118d] = (IOAccelSurface)((byte)this[0x118d] | bVar1);
        uVar3 = (**(code **)(*plVar5 + 0xb00))(plVar5);
        *(uint *)(this + 0x1190) = *(uint *)(this + 0x1190) | uVar3;
      }
      iVar6 = iVar6 + 1;
    } while (iVar2 != iVar6);
  }
  for (this_00 = *(IOAccelResource2 **)(this + 0x1008); this_00 != (IOAccelResource2 *)0x0;
      this_00 = *(IOAccelResource2 **)(this_00 + 0xe0)) {
    uVar3 = IOAccelResource2::get_surface_buffer_reqbit(this_00);
    *(uint *)(this + 0x1190) = *(uint *)(this + 0x1190) | uVar3;
  }
  return;
}



// IOAccelSurface::flip_buffers()

void __thiscall IOAccelSurface::flip_buffers(IOAccelSurface *this)

{
  long lVar1;
  IOAccelSurface *pIVar2;
  
  lVar1 = *(long *)(this + 0x11c8);
  if (lVar1 != 0) {
    pIVar2 = this + 0x11c8;
    if (*(long *)(this + 0x11d0) != 0) {
      *(long *)pIVar2 = *(long *)(this + 0x11d0);
      pIVar2 = this + 0x11d0;
    }
    *(long *)pIVar2 = *(long *)(this + 0x11c0);
    *(long *)(this + 0x11c0) = lVar1;
  }
  return;
}



// IOAccelSurface::prune_buffers()

void __thiscall IOAccelSurface::prune_buffers(IOAccelSurface *this)

{
  IOAccelResource2 *this_00;
  uint uVar1;
  long lVar2;
  
  if (((byte)this[0x11b0] & 0x20) != 0) {
    uVar1 = *(uint *)(this + 0x1188);
    *(uint *)(this + 0x1188) = *(uint *)(this + 0x1190) & 7 | uVar1;
    *(uint *)(this + 0x1190) = uVar1 | *(uint *)(this + 0x1190);
  }
  lVar2 = 0;
  do {
    uVar1 = (uint)lVar2;
    if ((*(uint *)(this + 0x1190) >> (uVar1 & 0x1f) & 1) == 0) {
      if (*(long *)(this + (long)(&DAT_000011c0 + lVar2 * 8)) != 0) {
        detach_buffer_at_index(this,uVar1);
        *(ulong *)(this + 0x11a0) = *(ulong *)(this + 0x11a0) & (long)~(1 << ((byte)lVar2 & 0x1f));
      }
    }
    else if (*(long *)(this + (long)(&DAT_000011c0 + lVar2 * 8)) == 0) {
      if (((byte)this[0x11b2] & 0x70) == 0) {
LAB_00039449:
        this_00 = (IOAccelResource2 *)
                  (**(code **)(**(long **)(this + 0x12c8) + 0x8d0))
                            (*(long **)(this + 0x12c8),0,0x40);
        this_00[0xc] = (IOAccelResource2)((byte)this_00[0xc] | 4);
        IOAccelResource2::updateReadWriteBits(this_00,1,'\x01');
        IOAccelResourceList::addResource
                  ((IOAccelResourceList *)(*(long *)(this + 0x12c8) + 0xb00),(long)this_00);
      }
      else {
        if (uVar1 == 0) {
          this_00 = *(IOAccelResource2 **)(this + 0x11c8);
        }
        else {
          if (uVar1 != 1) goto LAB_00039449;
          this_00 = *(IOAccelResource2 **)(this + 0x11c0);
        }
        if (this_00 == (IOAccelResource2 *)0x0) goto LAB_00039449;
        (**(code **)(*(long *)this_00 + 0x20))(this_00);
      }
      attach_buffer_at_index(this,uVar1,(long *)this_00);
      (**(code **)(*(long *)this_00 + 0x28))(this_00);
    }
    lVar2 = lVar2 + 1;
    if (lVar2 == 0xd) {
      return;
    }
  } while( true );
}



// IOAccelSurface::attach_buffer_at_index(int, IOAccelResource2*)

void __thiscall
IOAccelSurface::attach_buffer_at_index(IOAccelSurface *this,int param_1,long *param_2)

{
  undefined1 uVar1;
  undefined1 uVar2;
  long lVar3;
  IOAccelResource2 *this_00;
  long lVar4;
  
  lVar3 = (long)param_1;
  if (*(long **)(this + (long)(&DAT_000011c0 + lVar3 * 8)) != param_2) {
    if (*(long **)(this + (long)(&DAT_000011c0 + lVar3 * 8)) != (long *)0x0) {
      detach_buffer_at_index(this,param_1);
    }
    (**(code **)(*param_2 + 0x20))(param_2);
    *(long **)(this + (long)(&DAT_000011c0 + lVar3 * 8)) = param_2;
    lVar4 = *(long *)(this + 0x1018);
    if (lVar4 != 0) {
      do {
        this_00 = IOAccelResource2::newResourceWithSurface
                            (*(long **)(this + 0x12c8),*(IOAccelShared2 **)(lVar4 + 0x18),this,
                             param_1);
        if (this_00 == (IOAccelResource2 *)0x0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: fail to create surface texture\n",
                            "void IOAccelSurface::attach_buffer_at_index(int, IOAccelResource2 *)");
          return;
        }
        LOCK();
        *(int *)(*(long *)(this_00 + 0x30) + 0x18) = *(int *)(*(long *)(this_00 + 0x30) + 0x18) + 1;
        UNLOCK();
        IOAccelResource2::updateReadWriteBits(this_00,1,'\x01');
        uVar1 = *(undefined1 *)(lVar4 + 0x128);
        uVar2 = *(undefined1 *)(lVar4 + 0x129);
        (**(code **)(*(long *)this_00 + 0x20))(this_00);
        *(IOAccelResource2 **)(lVar4 + 0x28 + lVar3 * 8) = this_00;
        *(uint *)(lVar4 + 0x140) = *(uint *)(lVar4 + 0x140) | 1 << ((byte)param_1 & 0x1f);
        *(undefined1 *)(lVar4 + 0x1c4 + lVar3) = uVar1;
        *(undefined1 *)(lVar4 + 0x1e4 + lVar3) = uVar2;
        *(undefined4 *)(lVar4 + 0x144 + lVar3 * 4) = 0;
        lVar4 = *(long *)(lVar4 + 0x130);
      } while (lVar4 != 0);
    }
  }
  return;
}



// IOAccelSurface::isSurfaceSizeSupported(short, short)

undefined2 __thiscall
IOAccelSurface::isSurfaceSizeSupported(IOAccelSurface *this,int param_2_00,short param_2)

{
  ushort uVar1;
  undefined2 uVar2;
  
  if ((int)(uint)*(ushort *)(*(long *)(this + 0x12c8) + 0xcb8) < param_2_00) {
    uVar2 = 0;
  }
  else {
    uVar1 = *(ushort *)(*(long *)(this + 0x12c8) + 0xcba);
    uVar2 = CONCAT11((char)(uVar1 >> 8),(int)param_2 <= (int)(uint)uVar1);
  }
  return uVar2;
}



// IOAccelSurface::convertGLIndexToBufferIndex(eIOAccelGLBufferType) const

undefined8 __thiscall IOAccelSurface::convertGLIndexToBufferIndex(IOAccelSurface *this,int param_1)

{
  undefined8 uVar1;
  
  uVar1 = 1;
  switch(param_1) {
  case 0:
    break;
  case 2:
    uVar1 = 4;
    break;
  case 3:
    uVar1 = 3;
    break;
  case 4:
  case 7:
  case 10:
  case 0xb:
  case 0xc:
  case 0xd:
  case 0xf:
switchD_00039646_caseD_4:
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: bad gl_index %d\n",
                      "uint32_t IOAccelSurface::convertGLIndexToBufferIndex(eIOAccelGLBufferType) const"
                      ,0xaaaaaaaa);
    uVar1 = 0xffff;
    break;
  case 5:
    uVar1 = 6;
    break;
  case 6:
    uVar1 = 7;
    break;
  case 8:
    uVar1 = 9;
    break;
  case 9:
    uVar1 = 10;
    break;
  case 0xe:
    uVar1 = 0xc;
    break;
  case 0x10:
    uVar1 = 8;
    break;
  default:
    if (param_1 != 0x7fffffff) goto switchD_00039646_caseD_4;
  case 1:
    uVar1 = 0;
  }
  return uVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurface::getSurfaceBuffer(eIOAccelGLBufferType) const

undefined8 __cdecl IOAccelSurface::getSurfaceBuffer(IOAccelSurface *param_1,int param_2)

{
  ulong uVar1;
  undefined8 uVar2;
  
  uVar1 = convertGLIndexToBufferIndex(param_1,param_2);
  if ((int)uVar1 == 0xffff) {
    uVar2 = 0;
  }
  else {
    uVar2 = *(undefined8 *)(param_1 + (long)(&DAT_000011c0 + (uVar1 & 0xffffffff) * 8));
  }
  return uVar2;
}



// IOAccelSurface::update_shape()

void __thiscall IOAccelSurface::update_shape(IOAccelSurface *this)

{
  long *plVar1;
  long *plVar2;
  char cVar3;
  uint uVar4;
  uint uVar5;
  IOAccelResource2 *this_00;
  undefined2 uVar6;
  ulong uVar7;
  ulong uVar8;
  ulong uVar9;
  bool bVar10;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined2 local_34;
  undefined2 local_32;
  
  if (this[0xf0] != (IOAccelSurface)0x0) {
    uVar6 = *(undefined2 *)(this + 0x11bc);
    local_34 = *(undefined2 *)(this + 0x11be);
    uVar8 = *(ulong *)(this + 0x11b0) ^ *(ulong *)(this + 0x1198);
    uVar4 = ~*(uint *)(this + 0x11a0) & *(uint *)(this + 0x1190) | 7;
    uVar5 = ~*(uint *)(this + 0x11a0) & *(uint *)(this + 0x1190);
    if (((*(uint *)(this + 0x1170) ^ *(uint *)(this + 0x1330)) >> 0xf & 1) != 0) {
      uVar5 = uVar4;
    }
    if ((uVar8 & 0x7f800f) != 0) {
      uVar5 = uVar4;
    }
    uVar4 = (**(code **)(*(long *)this + 0x998))(this,uVar8);
    uVar4 = uVar4 | uVar5;
    if ((((uint)*(ushort *)(this + 0x11a8) == (int)*(short *)(this + 0x11bc)) &&
        ((uVar8 & 0x7f0000) == 0)) &&
       ((uint)*(ushort *)(this + 0x11aa) == (int)*(short *)(this + 0x11be))) {
      uVar5 = *(uint *)(this + 0x1190);
    }
    else {
      uVar5 = *(uint *)(this + 0x1190);
      uVar4 = uVar4 | uVar5;
    }
    uVar8 = (ulong)(uVar4 & uVar5);
    local_32 = uVar6;
    if ((uVar4 & uVar5) == 0) {
      uVar8 = 0;
    }
    else {
      uVar7 = uVar8;
      uVar9 = 0;
      do {
        if ((uVar7 & 1) != 0) {
          uVar5 = (uint)uVar9;
          if ((*(byte *)(*(long *)(this + (long)(&DAT_000011c0 + uVar9 * 8)) + 0xc) & 0x10) == 0) {
            if ((((byte)this[0x11b2] & 0x70) == 0) &&
               (*(long *)(*(long *)(this + (long)(&DAT_000011c0 + uVar9 * 8)) + 200) != 0)) {
              detach_buffer_at_index(this,uVar5);
              this_00 = (IOAccelResource2 *)
                        (**(code **)(**(long **)(this + 0x12c8) + 0x8d0))
                                  (*(long **)(this + 0x12c8),0,0x40);
              this_00[0xc] = (IOAccelResource2)((byte)this_00[0xc] | 4);
              IOAccelResource2::updateReadWriteBits(this_00,1,'\x01');
              IOAccelResourceList::addResource
                        ((IOAccelResourceList *)(*(long *)(this + 0x12c8) + 0xb00),(long)this_00);
              attach_buffer_at_index(this,uVar5,(long *)this_00);
              uVar6 = local_32;
              (**(code **)(*(long *)this_00 + 0x28))(this_00);
            }
          }
          else {
            uVar8 = (ulong)((uint)uVar8 & ~(1 << (uVar5 & 0x1f)));
          }
        }
        if (uVar7 < 2) break;
        uVar7 = uVar7 >> 1;
        bVar10 = uVar9 < 0xc;
        uVar9 = uVar9 + 1;
      } while (bVar10);
    }
    if (((byte)this[0x11b2] & 0x70) != 0) {
      uVar7 = uVar8 & 0xfffffffffffffffd;
      if ((*(ulong *)(this + 0x11a0) & 1) == 0) {
        uVar7 = uVar8;
      }
      uVar8 = uVar7 & 0xfffffffffffffffe;
      if ((*(ulong *)(this + 0x11a0) & 2) == 0) {
        uVar8 = uVar7;
      }
      if ((~(uint)uVar8 & 3) == 0) {
        uVar8 = uVar8 & 0xfffffffffffffffc | 1;
      }
    }
    (**(code **)(*(long *)this + 0x990))(this,uVar8,uVar6,local_34);
    if (((this[0xf3] != (IOAccelSurface)0x0) && ((uVar8 & 2) != 0)) &&
       (((~*(uint *)(this + 0x1190) & 3) == 0 &&
        ((((((byte)this[0x11a0] & 2) == 0 &&
           (plVar1 = *(long **)(this + 0x11c0), plVar1 != (long *)0x0)) &&
          (plVar2 = *(long **)(this + 0x11c8), plVar2 != (long *)0x0)) &&
         ((plVar1 != plVar2 && (cVar3 = (**(code **)(*plVar1 + 0x170))(plVar1), cVar3 != '\0')))))))
       ) {
      cVar3 = (**(code **)(*plVar2 + 0x170))(plVar2);
      if (cVar3 != '\0') {
        local_40 = &DAT_aaaaaaaaaaaaaaaa;
        local_48 = &DAT_aaaaaaaaaaaaaaaa;
        local_50 = &DAT_aaaaaaaaaaaaaaaa;
        local_58 = &DAT_aaaaaaaaaaaaaaaa;
        local_60 = &DAT_aaaaaaaaaaaaaaaa;
        local_68 = &DAT_aaaaaaaaaaaaaaaa;
        local_70 = &DAT_aaaaaaaaaaaaaaaa;
        local_78 = &DAT_aaaaaaaaaaaaaaaa;
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x140))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_78);
        (**(code **)(*(long *)this + 0x970))(this,&local_78,plVar1,plVar2);
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_78,
                   (ulong)*(byte *)((long)plVar1 + 0x15) * 0x40 + plVar1[7]);
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_78,
                   (ulong)*(byte *)((long)plVar2 + 0x15) * 0x40 + plVar2[7]);
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_78,
                   (ulong)*(byte *)((long)plVar2 + 0x16) * 0x40 + plVar2[7]);
        uVar6 = local_32;
        (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x148))
                  (*(long **)(*(long *)(this + 0x12c8) + 0x380),&local_78);
        (**(code **)(*plVar2 + 0x178))(plVar2);
      }
      (**(code **)(*plVar1 + 0x178))(plVar1);
    }
    *(undefined8 *)(this + 0x1198) = *(undefined8 *)(this + 0x11b0);
    *(ulong *)(this + 0x11a0) = (ulong)*(uint *)(this + 0x1190);
    *(undefined2 *)(this + 0x11a8) = uVar6;
    *(undefined2 *)(this + 0x11aa) = local_34;
    *(undefined4 *)(this + 0x1330) = *(undefined4 *)(this + 0x1170);
  }
  return;
}



// IOAccelSurface::getOwningTaskPid() const

undefined8 __thiscall IOAccelSurface::getOwningTaskPid(IOAccelSurface *this)

{
  long lVar1;
  undefined8 uVar2;
  
  lVar1 = _get_bsdtask_info(*(undefined8 *)(this + 0xe8));
  if (lVar1 != 0) {
    uVar2 = _proc_pid(lVar1);
    return uVar2;
  }
  return 0xffffffff;
}



// IOAccelSurface::complete_buffers(unsigned int)

void __thiscall IOAccelSurface::complete_buffers(IOAccelSurface *this,uint param_1)

{
  uint uVar1;
  ulong uVar2;
  bool bVar3;
  
  uVar1 = param_1 & *(uint *)(this + 0x1190);
  if (uVar1 != 0) {
    uVar2 = 0;
    do {
      if (((uVar1 & 1) != 0) &&
         (*(long **)(this + (long)(&DAT_000011c0 + uVar2 * 8)) != (long *)0x0)) {
        (**(code **)(**(long **)(this + (long)(&DAT_000011c0 + uVar2 * 8)) + 0x178))();
      }
      if (uVar1 < 2) {
        return;
      }
      uVar1 = uVar1 >> 1;
      bVar3 = uVar2 < 0x1f;
      uVar2 = uVar2 + 1;
    } while (bVar3);
  }
  return;
}



// IOAccelSurface::copyToBufferWithCPU(int, int, int, int, unsigned int, unsigned int,
// IOAccelResource2*, IOAccelSysMemory*, unsigned int, unsigned long long, unsigned int)

void __thiscall
IOAccelSurface::copyToBufferWithCPU
          (IOAccelSurface *this,int param_1,uint param_2,int param_3,int param_4,
          undefined1 param_6_00,undefined1 param_6,IOAccelResource2 *param_7,
          IOAccelSysMemory *param_8,uint param_9,long param_10,uint param_11)

{
  int *piVar1;
  ushort uVar2;
  undefined *puVar3;
  int iVar4;
  long lVar5;
  long lVar6;
  sbyte sVar7;
  int iVar8;
  undefined4 *puVar9;
  int iVar10;
  undefined4 *puVar11;
  undefined4 *puVar12;
  undefined4 *puVar13;
  uint local_38;
  int local_34;
  
  local_34 = -0x55555556;
  lVar5 = IOAccelSysMemory::lockForCPUAccess(param_8,*(ulonglong *)PTR__kernel_task_0006b100,1);
  if (lVar5 != 0) {
    iVar4 = (**(code **)(**(long **)(*(long *)(this + 0x12c8) + 0x380) + 0x188))
                      (*(long **)(*(long *)(this + 0x12c8) + 0x380),
                       (ulong)(byte)param_7[0x15] * 0x40 + *(long *)(param_7 + 0x38));
    lVar6 = *(long *)(this + 0x12c8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar6 + 0x388) + 0x58),0x37);
    piVar1 = (int *)(lVar6 + 0x27c);
    *piVar1 = *piVar1 + iVar4;
    puVar3 = PTR__kernel_task_0006b100;
    local_38 = param_2;
    if (((param_11 & 2) != 0) && (((byte)this[0x11b2] & 0x70) == 0)) {
      local_38 = ~param_2 + (uint)*(ushort *)(param_7 + 0xb2);
    }
    lVar6 = IOAccelResource2::lockForCPUAccess
                      (param_7,*(ulonglong *)PTR__kernel_task_0006b100,2,1,'\0',param_6_00,param_6,
                       &local_34);
    if (lVar6 == 0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: lockForCPUAccess failed\n",
                        "void IOAccelSurface::copyToBufferWithCPU(int32_t, int32_t, int32_t, int32_t, uint32_t, uint32_t, IOAccelResource2 *, IOAccelSysMemory *, uint32_t, IOByteCount, uint32_t)"
                       );
    }
    else {
      uVar2 = *(ushort *)(param_7 + 0xd8);
      iVar4 = local_34 / (int)(uint)uVar2;
      local_34 = iVar4;
      if (((param_11 & 2) != 0) && (local_34 = -iVar4, ((byte)this[0x11b2] & 0x70) != 0)) {
        local_34 = iVar4;
      }
      local_34 = local_34 * (uint)uVar2;
      if (uVar2 == 1) {
        sVar7 = 4;
        iVar8 = 0xf;
      }
      else if (uVar2 == 2) {
        sVar7 = 3;
        iVar8 = 7;
      }
      else {
        sVar7 = 2;
        iVar8 = 3;
      }
      iVar8 = iVar8 + param_3 >> sVar7;
      if (0 < param_4) {
        puVar13 = (undefined4 *)(lVar5 + (ulong)param_9);
        puVar9 = (undefined4 *)(lVar6 + (long)(int)(iVar4 * local_38 + param_1) * (ulong)uVar2);
        iVar4 = 0;
        do {
          puVar11 = puVar13;
          puVar12 = puVar9;
          iVar10 = iVar8;
          if (0 < iVar8) {
            do {
              *puVar12 = *puVar11;
              puVar12[1] = puVar11[1];
              puVar12[2] = puVar11[2];
              puVar12[3] = puVar11[3];
              iVar10 = iVar10 + -1;
              puVar11 = puVar11 + 4;
              puVar12 = puVar12 + 4;
            } while (iVar10 != 0);
          }
          puVar13 = (undefined4 *)((long)puVar13 + param_10);
          puVar9 = (undefined4 *)((long)puVar9 + (long)local_34);
          iVar4 = iVar4 + 1;
        } while (iVar4 != param_4);
      }
      IOAccelResource2::unlockForCPUAccess(param_7,*(long *)puVar3,2);
    }
    IOAccelSysMemory::unlockForCPUAccess(param_8,*(long *)puVar3);
  }
  return;
}



// IOAccelSurface::describe_allocations(IOAccelAllocationInfo*)

void __thiscall
IOAccelSurface::describe_allocations(IOAccelSurface *this,IOAccelAllocationInfo *param_1)

{
  short sVar1;
  short sVar2;
  uint uVar3;
  IOAccelResource2 *this_00;
  char *pcVar4;
  char *pcVar5;
  uint uVar6;
  long lVar7;
  
  sVar1 = *(short *)(this + 0x11bc);
  sVar2 = *(short *)(this + 0x11be);
  uVar3 = *(uint *)(this + 0x11b0);
  uVar6 = 0;
  lVar7 = 0;
  do {
    this_00 = *(IOAccelResource2 **)(this + (long)(&DAT_000011c0 + lVar7 * 2));
    if (this_00 != (IOAccelResource2 *)0x0) {
      if ((((byte)this[0x11b2] & 0x70) == 0) || (lVar7 != 0)) {
        pcVar5 = "Unknown Buffer Index";
        if (uVar6 < 0xd) {
          pcVar5 = &DAT_0006ae74 + *(int *)(&DAT_0006ae74 + lVar7);
        }
      }
      else {
        pcVar5 = "Front Buffer";
        if (this_00 == *(IOAccelResource2 **)(this + 0x11c8)) goto LAB_00039ea2;
      }
      pcVar4 = "Unknown Pixel Format";
      if ((uVar3 & 0xf) - 3 < 0xd) {
        pcVar4 = &DAT_0006aea8 + *(int *)(&DAT_0006ae9c + (ulong)(uVar3 & 0xf) * 4);
      }
      IOAccelResource2::describeAllocationsWithSurface
                (this_00,param_1,*(uint *)(this + 0x1168),pcVar5,(int)sVar1,(int)sVar2,pcVar4);
    }
LAB_00039ea2:
    lVar7 = lVar7 + 4;
    uVar6 = uVar6 + 1;
    if (lVar7 == 0x80) {
      return;
    }
  } while( true );
}



// IOAccelSurface::audit_freed_resource(IOAccelResource2*)

void __thiscall IOAccelSurface::audit_freed_resource(IOAccelSurface *this,long param_1)

{
  long lVar1;
  
  lVar1 = 0;
  do {
    if (*(long *)(this + (long)(&DAT_000011c0 + lVar1 * 8)) == param_1) {
      audit_freed_resource((uint)lVar1,param_1,(long)this);
      return;
    }
    lVar1 = lVar1 + 1;
  } while (lVar1 != 0x20);
  return;
}



// IOAccelSurface::getFrontBufferResourceId() const

undefined4 __thiscall IOAccelSurface::getFrontBufferResourceId(IOAccelSurface *this)

{
  undefined4 uVar1;
  
  if (*(long *)(this + 0x11c0) == 0) {
    uVar1 = 0;
  }
  else {
    uVar1 = *(undefined4 *)(*(long *)(*(long *)(this + 0x11c0) + 0x38) + 0x100);
  }
  return uVar1;
}



// IOAccelSurface::_RESERVEDIOAccelSurface0()

void IOAccelSurface::_RESERVEDIOAccelSurface0(void)

{
  OSMetaClass::reservedCalled(0x82570);
  return;
}



// IOAccelSurface::_RESERVEDIOAccelSurface1()

void IOAccelSurface::_RESERVEDIOAccelSurface1(void)

{
  OSMetaClass::reservedCalled(0x82570);
  return;
}



// IOAccelSurface::_RESERVEDIOAccelSurface2()

void IOAccelSurface::_RESERVEDIOAccelSurface2(void)

{
  OSMetaClass::reservedCalled(0x82570);
  return;
}



// IOAccelSurface::_RESERVEDIOAccelSurface3()

void IOAccelSurface::_RESERVEDIOAccelSurface3(void)

{
  OSMetaClass::reservedCalled(0x82570);
  return;
}



// IOAccelSurface::_RESERVEDIOAccelSurface4()

void IOAccelSurface::_RESERVEDIOAccelSurface4(void)

{
  OSMetaClass::reservedCalled(0x82570);
  return;
}



// IOAccelSurface::_RESERVEDIOAccelSurface5()

void IOAccelSurface::_RESERVEDIOAccelSurface5(void)

{
  OSMetaClass::reservedCalled(0x82570);
  return;
}



// IOAccelSurface::MetaClass::~MetaClass()

void __thiscall IOAccelSurface::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelSurface_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelSurface::gMetaClass,"IOAccelSurface",
             (OSMetaClass *)PTR_gMetaClass_0006b018,0x1338);
  _gMetaClass = &PTR__MetaClass_0007b510;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelSurface::gMetaClass);
  return;
}



// IOAccelTask::MetaClass::MetaClass()

void __thiscall IOAccelTask::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelTask",(OSMetaClass *)PTR_gMetaClass_0006b068,600);
  *(undefined ***)this = &PTR__MetaClass_0007bb78;
  return;
}



// IOAccelTask::MetaClass::~MetaClass()

void __thiscall IOAccelTask::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelTask::IOAccelTask(OSMetaClass const*)

void __thiscall IOAccelTask::IOAccelTask(IOAccelTask *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelTask_0007b9c8;
  return;
}



// IOAccelTask::IOAccelTask(OSMetaClass const*)

void __thiscall IOAccelTask::IOAccelTask(IOAccelTask *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelTask_0007b9c8;
  return;
}



// IOAccelTask::~IOAccelTask()

void __thiscall IOAccelTask::~IOAccelTask(IOAccelTask *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelTask::~IOAccelTask()

void __thiscall IOAccelTask::~IOAccelTask(IOAccelTask *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelTask::~IOAccelTask()

void __thiscall IOAccelTask::~IOAccelTask(IOAccelTask *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelTask_ktv,this,600);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelTask::operator delete(void*, unsigned long)

void __cdecl IOAccelTask::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelTask_ktv,param_1,param_2);
  return;
}



// IOAccelTask::getMetaClass() const

undefined1 * IOAccelTask::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelTask::MetaClass::MetaClass()

void __thiscall IOAccelTask::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelTask",(OSMetaClass *)PTR_gMetaClass_0006b068,600);
  *(undefined ***)this = &PTR__MetaClass_0007bb78;
  return;
}



// IOAccelTask::MetaClass::alloc() const

OSObject * IOAccelTask::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelTask_ktv,600);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelTask::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelTask_0007b9c8;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelTask::operator new(unsigned long)

void * __thiscall IOAccelTask::operator_new(IOAccelTask *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelTask_ktv,this);
  return pvVar1;
}



// IOAccelTask::IOAccelTask()

void __thiscall IOAccelTask::IOAccelTask(IOAccelTask *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelTask_0007b9c8;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelTask::IOAccelTask()

void __thiscall IOAccelTask::IOAccelTask(IOAccelTask *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelTask_0007b9c8;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelTask::init(IOGraphicsAccelerator2*, unsigned int, IORangeAllocator**)

uint __thiscall IOAccelTask::init(IOAccelTask *this,long param_1,uint param_2,long param_3)

{
  long *plVar1;
  uint uVar2;
  int iVar3;
  undefined8 uVar4;
  long lVar5;
  uint uVar6;
  ulong uVar7;
  
  uVar2 = (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  if ((char)uVar2 == '\0') {
    return uVar2;
  }
  *(long *)(this + 0x10) = param_1;
  (**(code **)(**(long **)(param_1 + 0x380) + 0x140))(*(long **)(param_1 + 0x380),this + 0x20);
  this[0x60] = (IOAccelTask)((byte)this[0x60] & 0xfe);
  if (param_2 == 0) {
    param_2 = 0;
  }
  else {
    uVar7 = 0;
    do {
      if ((param_3 == 0) || (plVar1 = *(long **)(param_3 + uVar7 * 8), plVar1 == (long *)0x0)) {
        *(undefined8 *)(this + uVar7 * 8 + 0x68) = 0;
        *(undefined8 *)(this + uVar7 * 8 + 0xe8) = 0;
        *(undefined8 *)(this + uVar7 * 8 + 0x168) = 0;
      }
      else {
        (**(code **)(*plVar1 + 0x20))();
        *(undefined8 *)(this + uVar7 * 8 + 0x168) = *(undefined8 *)(param_3 + uVar7 * 8);
        uVar4 = (**(code **)(**(long **)(param_3 + uVar7 * 8) + 0x148))();
        *(undefined8 *)(this + uVar7 * 8 + 0x68) = uVar4;
        *(undefined8 *)(this + uVar7 * 8 + 0xe8) = 0;
      }
      uVar7 = uVar7 + 1;
    } while (param_2 != uVar7);
    uVar6 = uVar2 & 0xff;
    uVar2 = uVar2 & 0xff;
    if (0xf < param_2) goto LAB_0003a29e;
  }
  uVar6 = uVar2;
  lVar5 = (ulong)param_2 + 0x2d;
  do {
    *(undefined8 *)(this + lVar5 * 8 + -0x100) = 0;
    *(undefined8 *)(this + lVar5 * 8 + -0x80) = 0;
    *(undefined8 *)(this + lVar5 * 8) = 0;
    iVar3 = (int)lVar5;
    lVar5 = lVar5 + 1;
  } while (iVar3 != 0x3c);
LAB_0003a29e:
  IOAccelMemoryMapList::init((IOAccelMemoryMapList *)(this + 0x1e8));
  IOAccelMemoryMapList::init((IOAccelMemoryMapList *)(this + 0x200));
  *(undefined8 *)(this + 0x18) = 0;
  IOAccelTaskList::addTask((IOAccelTaskList *)(*(long *)(this + 0x10) + 0xc48),(long)this);
  return uVar6;
}



// IOAccelTask::free()

void __thiscall IOAccelTask::free(IOAccelTask *this)

{
  IOAccelMemoryMapList *this_00;
  int iVar1;
  undefined4 uVar2;
  long *plVar3;
  long lVar4;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  
  this_00 = (IOAccelMemoryMapList *)(this + 0x1e8);
  iVar1 = IOAccelMemoryMapList::getCount(this_00);
  if (iVar1 != 0) {
    IOAccelMemoryMapList::getCount(this_00);
    uVar2 = IOAccelMemoryMapList::getCount(this_00);
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Still have %d IOAccelMemoryMaps now will be in limbo, task=%p\n",
                      "virtual void IOAccelTask::free()",uVar2,this);
    local_40 = &DAT_aaaaaaaaaaaaaaaa;
    local_38 = &DAT_aaaaaaaaaaaaaaaa;
    local_30 = &DAT_aaaaaaaaaaaaaaaa;
    IOAccelMemoryMapList::ReverseIterator::ReverseIterator
              ((ReverseIterator *)&local_40,(long)this_00);
    plVar3 = (long *)IOAccelMemoryMapList::ReverseIterator::getPrevMapping
                               ((ReverseIterator *)&local_40);
    if (plVar3 != (long *)0x0) {
      do {
        (**(code **)(*plVar3 + 0x160))(plVar3);
        plVar3 = (long *)IOAccelMemoryMapList::ReverseIterator::getPrevMapping
                                   ((ReverseIterator *)&local_40);
      } while (plVar3 != (long *)0x0);
    }
  }
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelMemoryMapList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_40,(long)(this + 0x200));
  plVar3 = (long *)IOAccelMemoryMapList::ReverseIterator::getPrevMapping
                             ((ReverseIterator *)&local_40);
  if (plVar3 != (long *)0x0) {
    do {
      (**(code **)(*plVar3 + 0x28))(plVar3);
      plVar3 = (long *)IOAccelMemoryMapList::ReverseIterator::getPrevMapping
                                 ((ReverseIterator *)&local_40);
    } while (plVar3 != (long *)0x0);
  }
  lVar4 = 0x2d;
  do {
    if (*(long **)(this + lVar4 * 8) != (long *)0x0) {
      (**(code **)(**(long **)(this + lVar4 * 8) + 0x28))();
      *(undefined8 *)(this + lVar4 * 8) = 0;
    }
    lVar4 = lVar4 + 1;
  } while (lVar4 != 0x3d);
  IOAccelTaskList::removeTask
            ((IOAccelTaskList *)
             ((ulong)(*(uint *)(this + 0x60) & 1) * 0x10 + *(long *)(this + 0x10) + 0xc48),
             (long)this);
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelTask::release() const

void __thiscall IOAccelTask::release(IOAccelTask *this)

{
  char cVar1;
  int iVar2;
  long lVar3;
  IOAccelMemoryMap *this_00;
  undefined8 extraout_RDX;
  IOAccelMemoryMapList *this_01;
  undefined1 *local_38;
  undefined1 *local_30;
  undefined1 *local_28;
  
  iVar2 = (**(code **)(*(long *)this + 0x18))();
  if (iVar2 == 1) {
    if (((byte)this[0x60] & 1) == 0) {
      local_38 = &DAT_aaaaaaaaaaaaaaaa;
      local_30 = &DAT_aaaaaaaaaaaaaaaa;
      local_28 = &DAT_aaaaaaaaaaaaaaaa;
      IOAccelMemoryMapList::ReverseIterator::ReverseIterator
                ((ReverseIterator *)&local_38,(long)(this + 0x200));
      lVar3 = IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_38);
      if (lVar3 != 0) {
        do {
          (**(code **)(**(long **)(*(long *)(this + 0x10) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x10) + 0x380),lVar3 + 0x38,this + 0x20);
          lVar3 = IOAccelMemoryMapList::ReverseIterator::getPrevMapping
                            ((ReverseIterator *)&local_38);
        } while (lVar3 != 0);
      }
      lVar3 = *(long *)(this + 0x10);
      if ((*(byte *)(lVar3 + 0xc78) & 8) != 0) {
LAB_0003a5b5:
        this[0x60] = (IOAccelTask)((byte)this[0x60] | 1);
        IOAccelTaskList::removeTask((IOAccelTaskList *)(lVar3 + 0xc48),(long)this);
        IOAccelTaskList::addTask((IOAccelTaskList *)(*(long *)(this + 0x10) + 0xc58),(long)this);
        IOGraphicsAccelerator2::kickOrphanResourceTimer(*(IOGraphicsAccelerator2 **)(this + 0x10));
        return;
      }
      cVar1 = (**(code **)(**(long **)(lVar3 + 0x380) + 400))(*(long **)(lVar3 + 0x380),this + 0x20)
      ;
      if (cVar1 == '\0') {
        lVar3 = *(long *)(this + 0x10);
        goto LAB_0003a5b5;
      }
      free_orphaned_mappings(this);
    }
    this_01 = (IOAccelMemoryMapList *)(this + 0x1e8);
    iVar2 = IOAccelMemoryMapList::getCount(this_01);
    if (iVar2 != 0) {
      local_38 = &DAT_aaaaaaaaaaaaaaaa;
      local_30 = &DAT_aaaaaaaaaaaaaaaa;
      local_28 = &DAT_aaaaaaaaaaaaaaaa;
      IOAccelMemoryMapList::ReverseIterator::ReverseIterator
                ((ReverseIterator *)&local_38,(long)this_01);
      this_00 = (IOAccelMemoryMap *)
                IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_38);
      if (this_00 != (IOAccelMemoryMap *)0x0) {
        do {
          iVar2 = IOAccelMemoryMap::getPrepareCount(this_00);
          if ((iVar2 == 0) && (((byte)this_00[0x10] & 4) != 0)) {
            IOAccelMemoryMap::finishEvent((long)this_00,this_01,extraout_RDX);
            IOAccelMemoryMap::release_pte(this_00);
            (**(code **)(*(long *)this_00 + 0x160))(this_00);
          }
          this_00 = (IOAccelMemoryMap *)
                    IOAccelMemoryMapList::ReverseIterator::getPrevMapping
                              ((ReverseIterator *)&local_38);
        } while (this_00 != (IOAccelMemoryMap *)0x0);
      }
    }
  }
  (**(code **)(PTR_vtable_0006b0a0 + 0x68))(this,0,1);
  return;
}



// IOAccelTask::free_orphaned_mappings()

void __thiscall IOAccelTask::free_orphaned_mappings(IOAccelTask *this)

{
  IOAccelTask *pIVar1;
  long *plVar2;
  undefined1 auVar3 [16];
  undefined1 *local_30;
  undefined1 *local_28;
  undefined1 *local_20;
  
  if ((*(byte *)(*(long *)(this + 0x10) + 0xc78) & 8) == 0) {
    local_30 = &DAT_aaaaaaaaaaaaaaaa;
    local_28 = &DAT_aaaaaaaaaaaaaaaa;
    local_20 = &DAT_aaaaaaaaaaaaaaaa;
    pIVar1 = this + 0x200;
    IOAccelMemoryMapList::ReverseIterator::ReverseIterator
              ((ReverseIterator *)&local_30,(long)pIVar1);
    auVar3 = IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_30);
    if (auVar3._0_8_ != 0) {
      do {
        plVar2 = auVar3._0_8_;
        IOAccelMemoryMap::finishEvent((long)plVar2,pIVar1,auVar3._8_8_);
        (**(code **)(*plVar2 + 0x28))(plVar2);
        auVar3 = IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_30)
        ;
      } while (auVar3._0_8_ != 0);
    }
  }
  return;
}



// IOAccelTask::allocate(IOAccelMemoryMap const*)

undefined1 * __thiscall IOAccelTask::allocate(IOAccelTask *this,long *param_1)

{
  uint uVar1;
  long *plVar2;
  char cVar3;
  long lVar4;
  undefined1 *puVar5;
  undefined1 *local_40;
  IOAccelTask *local_38;
  
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  uVar1 = *(uint *)(param_1 + 0xf);
  plVar2 = *(long **)(this + (ulong)uVar1 * 8 + 0x168);
  local_38 = this;
  if ((*(byte *)((long)param_1 + 0x11) & 0x40) == 0) {
    lVar4 = (**(code **)(*param_1 + 0x168))(param_1);
    cVar3 = (**(code **)(*plVar2 + 0x150))(plVar2,lVar4,&local_40,param_1[0x10]);
  }
  else {
    puVar5 = (undefined1 *)(**(code **)(*param_1 + 0x128))(param_1);
    lVar4 = (**(code **)(*param_1 + 400))(param_1);
    cVar3 = (**(code **)(*plVar2 + 0x158))(plVar2,puVar5,lVar4);
    local_40 = puVar5;
  }
  if (cVar3 == '\0') {
    local_40 = (undefined1 *)0x0;
  }
  else {
    *(long *)(local_38 + (ulong)uVar1 * 8 + 0xe8) =
         *(long *)(local_38 + (ulong)uVar1 * 8 + 0xe8) + lVar4;
  }
  return local_40;
}



// IOAccelTask::deallocate(IOAccelMemoryMap const*, unsigned long long)

void __thiscall IOAccelTask::deallocate(IOAccelTask *this,long *param_1,undefined8 param_2)

{
  uint uVar1;
  long lVar2;
  
  uVar1 = *(uint *)(param_1 + 0xf);
  lVar2 = (**(code **)(*param_1 + 0x168))(param_1);
  if ((*(byte *)((long)param_1 + 0x11) & 0x40) != 0) {
    lVar2 = (**(code **)(*param_1 + 400))(param_1);
  }
  (**(code **)(**(long **)(this + (ulong)uVar1 * 8 + 0x168) + 0x160))
            (*(long **)(this + (ulong)uVar1 * 8 + 0x168),param_2,lVar2);
  *(long *)(this + (ulong)uVar1 * 8 + 0xe8) = *(long *)(this + (ulong)uVar1 * 8 + 0xe8) - lVar2;
  return;
}



// IOAccelTask::reserve(unsigned int, unsigned long long, unsigned long long)

void __thiscall
IOAccelTask::reserve(IOAccelTask *this,ulong param_2_00,undefined8 param_2,undefined8 param_3)

{
                    // WARNING: Could not recover jumptable at 0x0003a7bb. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + (param_2_00 & 0xffffffff) * 8 + 0x168) + 0x158))
            (*(long **)(this + (param_2_00 & 0xffffffff) * 8 + 0x168),param_2,param_3);
  return;
}



// IOAccelTask::prune_orphaned_mappings()

void __thiscall IOAccelTask::prune_orphaned_mappings(IOAccelTask *this)

{
  char cVar1;
  IOAccelTask *pIVar2;
  long *plVar3;
  undefined1 auVar4 [16];
  undefined1 *local_30;
  undefined1 *local_28;
  undefined1 *local_20;
  
  if ((*(byte *)(*(long *)(this + 0x10) + 0xc78) & 8) == 0) {
    local_30 = &DAT_aaaaaaaaaaaaaaaa;
    local_28 = &DAT_aaaaaaaaaaaaaaaa;
    local_20 = &DAT_aaaaaaaaaaaaaaaa;
    pIVar2 = this + 0x200;
    IOAccelMemoryMapList::ReverseIterator::ReverseIterator
              ((ReverseIterator *)&local_30,(long)pIVar2);
    auVar4 = IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_30);
    if (auVar4._0_8_ != 0) {
      do {
        plVar3 = auVar4._0_8_;
        cVar1 = IOAccelMemoryMap::testEvent((long)plVar3,pIVar2,auVar4._8_8_);
        if (cVar1 == '\0') {
          return;
        }
        (**(code **)(*plVar3 + 0x28))(plVar3);
        auVar4 = IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_30)
        ;
      } while (auVar4._0_8_ != 0);
    }
  }
  return;
}



// IOAccelTask::freeToAllocGPUAddress(IOAccelMemoryMap*)

ulong __thiscall IOAccelTask::freeToAllocGPUAddress(IOAccelTask *this,long *param_1)

{
  int *piVar1;
  long lVar2;
  undefined1 *puVar3;
  char cVar4;
  uint uVar5;
  undefined8 uVar6;
  undefined8 unaff_R14;
  ulong uVar7;
  undefined1 *local_38;
  undefined1 *local_30;
  
  cVar4 = (**(code **)(*(long *)this + 400))(this,param_1,0);
  uVar7 = CONCAT71((int7)((ulong)unaff_R14 >> 8),1);
  if (cVar4 == '\0') {
    local_38 = &DAT_aaaaaaaaaaaaaaaa;
    local_30 = &DAT_aaaaaaaaaaaaaaaa;
    _clock_get_uptime();
    uVar5 = (**(code **)(*(long *)this + 400))(this,param_1,1);
    uVar7 = (ulong)uVar5;
    if ((char)uVar5 == '\0') {
      (**(code **)(*param_1 + 0x168))(param_1);
      lVar2 = param_1[0xf];
      uVar6 = (**(code **)(*param_1 + 0x168))(param_1);
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: failed to alloc GART space at segment %d. Needed %lld bytes, used %lld, size %lld. vram=%d\n"
                        ,"virtual bool IOAccelTask::freeToAllocGPUAddress(IOAccelMemoryMap *)",
                        (int)lVar2,uVar6,
                        *(undefined8 *)(this + (ulong)*(uint *)(param_1 + 0xf) * 8 + 0xe8),
                        *(undefined8 *)(this + (ulong)*(uint *)(param_1 + 0xf) * 8 + 0x68),
                        *(uint *)(param_1 + 2) >> 4 & 1);
    }
    else {
      _clock_get_uptime(&local_38);
      _absolutetime_to_nanoseconds(local_38 + 0x5555555555555556,&local_30);
      puVar3 = local_30;
      lVar2 = *(long *)(this + 0x10);
      IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar2 + 0x388) + 0x58),0x2f);
      piVar1 = (int *)(lVar2 + 0x25c);
      *piVar1 = *piVar1 + (int)puVar3;
    }
  }
  return uVar7 & 0xffffffff;
}



// IOAccelTask::freeWaitToAllocGPUAddress(IOAccelMemoryMap*, bool)

undefined8 __thiscall
IOAccelTask::freeWaitToAllocGPUAddress(IOAccelTask *this,long *param_1,char param_2)

{
  char cVar1;
  int iVar2;
  long *plVar3;
  undefined8 uVar4;
  IOAccelMemoryMap *this_00;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_var;
  undefined4 extraout_var_00;
  long *plVar5;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  
  local_60 = &DAT_aaaaaaaaaaaaaaaa;
  local_58 = &DAT_aaaaaaaaaaaaaaaa;
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelMemoryMapList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_60,(long)(this + 0x200));
  plVar3 = (long *)IOAccelMemoryMapList::ReverseIterator::getPrevMapping
                             ((ReverseIterator *)&local_60);
  if (plVar3 != (long *)0x0) {
    do {
      plVar5 = param_1;
      cVar1 = (**(code **)(*plVar3 + 0x148))(plVar3);
      if (cVar1 != '\0') {
        if (param_2 == '\0') {
          cVar1 = IOAccelMemoryMap::testEvent
                            ((long)plVar3,plVar5,CONCAT44(extraout_var,extraout_EDX));
          if (cVar1 == '\0') goto LAB_0003aa11;
        }
        else {
          IOAccelMemoryMap::finishEvent((long)plVar3,plVar5,CONCAT44(extraout_var,extraout_EDX));
        }
        (**(code **)(*plVar3 + 0x28))(plVar3);
        uVar4 = (**(code **)(*param_1 + 0x150))(param_1);
        if ((char)uVar4 != '\0') goto LAB_0003aae7;
      }
LAB_0003aa11:
      plVar3 = (long *)IOAccelMemoryMapList::ReverseIterator::getPrevMapping
                                 ((ReverseIterator *)&local_60);
    } while (plVar3 != (long *)0x0);
  }
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelMemoryMapList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_48,(long)(this + 0x1e8));
  this_00 = (IOAccelMemoryMap *)
            IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_48);
  if (this_00 != (IOAccelMemoryMap *)0x0) {
    do {
      if (((((byte)this_00[0x10] & 2) == 0) &&
          (plVar3 = param_1, cVar1 = (**(code **)(*(long *)this_00 + 0x148))(this_00), cVar1 != '\0'
          )) && (iVar2 = IOAccelMemoryMap::getPrepareCount(this_00), iVar2 == 0)) {
        if (param_2 == '\0') {
          cVar1 = IOAccelMemoryMap::testEvent
                            ((long)this_00,plVar3,CONCAT44(extraout_var_00,extraout_EDX_00));
          if (cVar1 == '\0') goto LAB_0003aad3;
        }
        else {
          IOAccelMemoryMap::finishEvent
                    ((long)this_00,plVar3,CONCAT44(extraout_var_00,extraout_EDX_00));
        }
        if (((byte)this_00[0x10] & 4) != 0) {
          IOAccelMemoryMap::release_pte(this_00);
        }
        (**(code **)(*(long *)this_00 + 0x160))(this_00);
        uVar4 = (**(code **)(*param_1 + 0x150))(param_1);
        if ((char)uVar4 != '\0') {
LAB_0003aae7:
          return CONCAT71((int7)((ulong)uVar4 >> 8),1);
        }
      }
LAB_0003aad3:
      this_00 = (IOAccelMemoryMap *)
                IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_48);
    } while (this_00 != (IOAccelMemoryMap *)0x0);
  }
  return 0;
}



// IOAccelTask::freeAllGPUMappings()

void __thiscall IOAccelTask::freeAllGPUMappings(IOAccelTask *this)

{
  int iVar1;
  long *plVar2;
  IOAccelMemoryMap *this_00;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  undefined1 *local_28;
  
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelMemoryMapList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_50,(long)(this + 0x200));
  plVar2 = (long *)IOAccelMemoryMapList::ReverseIterator::getPrevMapping
                             ((ReverseIterator *)&local_50);
  if (plVar2 != (long *)0x0) {
    do {
      (**(code **)(*plVar2 + 0x28))(plVar2);
      plVar2 = (long *)IOAccelMemoryMapList::ReverseIterator::getPrevMapping
                                 ((ReverseIterator *)&local_50);
    } while (plVar2 != (long *)0x0);
  }
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelMemoryMapList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_38,(long)(this + 0x1e8));
  this_00 = (IOAccelMemoryMap *)
            IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_38);
  if (this_00 != (IOAccelMemoryMap *)0x0) {
    do {
      if (((byte)this_00[0x10] & 2) == 0) {
        iVar1 = IOAccelMemoryMap::getPrepareCount(this_00);
        if (iVar1 == 0) {
          if (((byte)this_00[0x10] & 4) != 0) {
            IOAccelMemoryMap::release_pte(this_00);
          }
          (**(code **)(*(long *)this_00 + 0x160))(this_00);
        }
      }
      this_00 = (IOAccelMemoryMap *)
                IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_38);
    } while (this_00 != (IOAccelMemoryMap *)0x0);
  }
  return;
}



// IOAccelTask::freeAllDynamicGPUVirtualAddress()

void __thiscall IOAccelTask::freeAllDynamicGPUVirtualAddress(IOAccelTask *this)

{
  int iVar1;
  IOAccelMemoryMap *this_00;
  undefined8 extraout_RDX;
  IOAccelTask *pIVar2;
  undefined1 *local_30;
  undefined1 *local_28;
  undefined1 *local_20;
  
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  local_20 = &DAT_aaaaaaaaaaaaaaaa;
  pIVar2 = this + 0x1e8;
  IOAccelMemoryMapList::ReverseIterator::ReverseIterator((ReverseIterator *)&local_30,(long)pIVar2);
  this_00 = (IOAccelMemoryMap *)
            IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_30);
  if (this_00 != (IOAccelMemoryMap *)0x0) {
    do {
      if (((byte)this_00[0x10] & 2) == 0) {
        iVar1 = IOAccelMemoryMap::getPrepareCount(this_00);
        if ((iVar1 == 0) && (((byte)this_00[0x10] & 1) != 0)) {
          IOAccelMemoryMap::finishEvent((long)this_00,pIVar2,extraout_RDX);
          if (((byte)this_00[0x10] & 4) != 0) {
            IOAccelMemoryMap::release_pte(this_00);
          }
          (**(code **)(*(long *)this_00 + 0x160))(this_00);
        }
      }
      this_00 = (IOAccelMemoryMap *)
                IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_30);
    } while (this_00 != (IOAccelMemoryMap *)0x0);
  }
  return;
}



// IOAccelTask::freeAllVidMemoryMappings()

void __thiscall IOAccelTask::freeAllVidMemoryMappings(IOAccelTask *this)

{
  int iVar1;
  long *plVar2;
  IOAccelMemoryMap *this_00;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  undefined1 *local_28;
  
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelMemoryMapList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_50,(long)(this + 0x200));
  plVar2 = (long *)IOAccelMemoryMapList::ReverseIterator::getPrevMapping
                             ((ReverseIterator *)&local_50);
  if (plVar2 != (long *)0x0) {
    do {
      if ((*(byte *)(plVar2 + 2) & 0x10) != 0) {
        (**(code **)(*plVar2 + 0x28))(plVar2);
      }
      plVar2 = (long *)IOAccelMemoryMapList::ReverseIterator::getPrevMapping
                                 ((ReverseIterator *)&local_50);
    } while (plVar2 != (long *)0x0);
  }
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelMemoryMapList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_38,(long)(this + 0x1e8));
  this_00 = (IOAccelMemoryMap *)
            IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_38);
  if (this_00 != (IOAccelMemoryMap *)0x0) {
    do {
      if ((*(uint *)(this_00 + 0x10) & 0x12) == 0x10) {
        iVar1 = IOAccelMemoryMap::getPrepareCount(this_00);
        if (iVar1 == 0) {
          if (((byte)this_00[0x10] & 4) != 0) {
            IOAccelMemoryMap::release_pte(this_00);
          }
          (**(code **)(*(long *)this_00 + 0x160))(this_00);
        }
      }
      this_00 = (IOAccelMemoryMap *)
                IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_38);
    } while (this_00 != (IOAccelMemoryMap *)0x0);
  }
  return;
}



// IOAccelTask::freeAllSysMemoryMappings()

void __thiscall IOAccelTask::freeAllSysMemoryMappings(IOAccelTask *this)

{
  int iVar1;
  long *plVar2;
  IOAccelMemoryMap *this_00;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  undefined1 *local_28;
  
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelMemoryMapList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_50,(long)(this + 0x200));
  plVar2 = (long *)IOAccelMemoryMapList::ReverseIterator::getPrevMapping
                             ((ReverseIterator *)&local_50);
  if (plVar2 != (long *)0x0) {
    do {
      if ((*(byte *)(plVar2 + 2) & 0x10) == 0) {
        (**(code **)(*plVar2 + 0x28))(plVar2);
      }
      plVar2 = (long *)IOAccelMemoryMapList::ReverseIterator::getPrevMapping
                                 ((ReverseIterator *)&local_50);
    } while (plVar2 != (long *)0x0);
  }
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelMemoryMapList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_38,(long)(this + 0x1e8));
  this_00 = (IOAccelMemoryMap *)
            IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_38);
  if (this_00 != (IOAccelMemoryMap *)0x0) {
    do {
      if (((byte)this_00[0x10] & 0x12) == 0) {
        iVar1 = IOAccelMemoryMap::getPrepareCount(this_00);
        if (iVar1 == 0) {
          if (((byte)this_00[0x10] & 4) != 0) {
            IOAccelMemoryMap::release_pte(this_00);
          }
          (**(code **)(*(long *)this_00 + 0x160))(this_00);
        }
      }
      this_00 = (IOAccelMemoryMap *)
                IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_38);
    } while (this_00 != (IOAccelMemoryMap *)0x0);
  }
  return;
}



// IOAccelTask::printAllMappings()

void __thiscall IOAccelTask::printAllMappings(IOAccelTask *this)

{
  uint uVar1;
  int iVar2;
  IOAccelMemoryMap *pIVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  IOAccelMemoryMapList *pIVar6;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  IOAccelTask *local_38;
  
  pIVar6 = (IOAccelMemoryMapList *)(this + 0x200);
  iVar2 = IOAccelMemoryMapList::getCount(pIVar6);
  if (iVar2 != 0) {
    local_50 = &DAT_aaaaaaaaaaaaaaaa;
    local_48 = &DAT_aaaaaaaaaaaaaaaa;
    local_40 = &DAT_aaaaaaaaaaaaaaaa;
    local_38 = this;
    IOAccelMemoryMapList::ReverseIterator::ReverseIterator
              ((ReverseIterator *)&local_50,(long)pIVar6);
    iVar2 = IOAccelMemoryMapList::getCount(pIVar6);
    _kprintf("Listing all orphaned maps. Total %d mappings\n",iVar2);
    pIVar3 = (IOAccelMemoryMap *)
             IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_50);
    this = local_38;
    if (pIVar3 != (IOAccelMemoryMap *)0x0) {
      do {
        uVar4 = (**(code **)(*(long *)pIVar3 + 0x128))(pIVar3);
        uVar1 = *(uint *)(pIVar3 + 0x10);
        iVar2 = IOAccelMemoryMap::getPrepareCount(pIVar3);
        uVar5 = (**(code **)(*(long *)pIVar3 + 0x168))(pIVar3);
        _kprintf("mapping=%p, address=0x%llx, vram=%d, prepare_count=%d, size=0x%llx\n",pIVar3,uVar4
                 ,uVar1 >> 4 & 1,iVar2,uVar5);
        pIVar3 = (IOAccelMemoryMap *)
                 IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_50)
        ;
        this = local_38;
      } while (pIVar3 != (IOAccelMemoryMap *)0x0);
    }
  }
  pIVar6 = (IOAccelMemoryMapList *)(this + 0x1e8);
  iVar2 = IOAccelMemoryMapList::getCount(pIVar6);
  if (iVar2 != 0) {
    local_50 = &DAT_aaaaaaaaaaaaaaaa;
    local_48 = &DAT_aaaaaaaaaaaaaaaa;
    local_40 = &DAT_aaaaaaaaaaaaaaaa;
    IOAccelMemoryMapList::ReverseIterator::ReverseIterator
              ((ReverseIterator *)&local_50,(long)pIVar6);
    iVar2 = IOAccelMemoryMapList::getCount(pIVar6);
    _kprintf("Listing all allocated maps. Total %d mappings\n",iVar2);
    pIVar3 = (IOAccelMemoryMap *)
             IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_50);
    if (pIVar3 != (IOAccelMemoryMap *)0x0) {
      do {
        uVar4 = (**(code **)(*(long *)pIVar3 + 0x128))(pIVar3);
        uVar1 = *(uint *)(pIVar3 + 0x10);
        iVar2 = IOAccelMemoryMap::getPrepareCount(pIVar3);
        uVar5 = (**(code **)(*(long *)pIVar3 + 0x168))(pIVar3);
        _kprintf("mapping=%p, address=0x%llx, vram=%d, prepare_count=%d, size=0x%llx\n",pIVar3,uVar4
                 ,uVar1 >> 4 & 1,iVar2,uVar5);
        pIVar3 = (IOAccelMemoryMap *)
                 IOAccelMemoryMapList::ReverseIterator::getPrevMapping((ReverseIterator *)&local_50)
        ;
      } while (pIVar3 != (IOAccelMemoryMap *)0x0);
    }
  }
  return;
}



// IOAccelTask::searchMapForGPUVirtualAddress(unsigned long long, IOAccelMemoryMap**)

long * __thiscall
IOAccelTask::searchMapForGPUVirtualAddress(IOAccelTask *this,ulong param_1,undefined8 *param_2)

{
  ulong uVar1;
  ulong uVar2;
  long *plVar3;
  long *plVar4;
  ulong uVar5;
  long lVar6;
  ulong uVar7;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  long *local_48;
  undefined8 *local_40;
  ulong local_38;
  
  local_78 = &DAT_aaaaaaaaaaaaaaaa;
  local_70 = &DAT_aaaaaaaaaaaaaaaa;
  local_68 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = param_2;
  local_38 = param_1;
  IOAccelMemoryMapList::Iterator::Iterator((Iterator *)&local_78,(undefined8 *)(this + 0x200));
  local_60 = &DAT_aaaaaaaaaaaaaaaa;
  local_58 = &DAT_aaaaaaaaaaaaaaaa;
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelMemoryMapList::Iterator::Iterator((Iterator *)&local_60,(undefined8 *)(this + 0x1e8));
  plVar3 = (long *)IOAccelMemoryMapList::Iterator::getNextMapping((Iterator *)&local_78);
  uVar1 = local_38;
  if (plVar3 == (long *)0x0) {
    uVar7 = 0xffffffffffffffff;
    plVar4 = (long *)0x0;
  }
  else {
    uVar7 = 0xffffffffffffffff;
    plVar4 = (long *)0x0;
    do {
      local_48 = plVar4;
      uVar5 = (**(code **)(*plVar3 + 0x128))(plVar3);
      lVar6 = (**(code **)(*plVar3 + 0x168))(plVar3);
      if ((uVar5 <= uVar1) && (uVar1 < lVar6 + uVar5)) {
        return plVar3;
      }
      uVar2 = uVar1 - uVar5;
      if (uVar7 <= uVar1 - uVar5) {
        plVar3 = local_48;
        uVar2 = uVar7;
      }
      plVar4 = plVar3;
      if (uVar1 < uVar5) {
        plVar4 = local_48;
        uVar2 = uVar7;
      }
      uVar7 = uVar2;
      plVar3 = (long *)IOAccelMemoryMapList::Iterator::getNextMapping((Iterator *)&local_78);
    } while (plVar3 != (long *)0x0);
  }
  plVar3 = (long *)IOAccelMemoryMapList::Iterator::getNextMapping((Iterator *)&local_60);
  uVar1 = local_38;
  while( true ) {
    if (plVar3 == (long *)0x0) {
      if (plVar4 != (long *)0x0) {
        *local_40 = plVar4;
      }
      return (long *)0x0;
    }
    uVar5 = (**(code **)(*plVar3 + 0x128))(plVar3);
    lVar6 = (**(code **)(*plVar3 + 0x168))(plVar3);
    if ((uVar5 <= uVar1) && (uVar1 < lVar6 + uVar5)) break;
    uVar2 = uVar1 - uVar5;
    if (uVar7 <= uVar1 - uVar5) {
      plVar3 = plVar4;
      uVar2 = uVar7;
    }
    if (uVar5 <= uVar1) {
      plVar4 = plVar3;
      uVar7 = uVar2;
    }
    plVar3 = (long *)IOAccelMemoryMapList::Iterator::getNextMapping((Iterator *)&local_60);
  }
  return plVar3;
}



// IOAccelTask::getProcessIDAndName(char*, int) const

int __thiscall IOAccelTask::getProcessIDAndName(IOAccelTask *this,void *param_1,uint32_t param_2)

{
  long lVar1;
  int pid;
  undefined1 *local_30;
  
  if (*(IOAccelTask **)(*(long *)(this + 0x10) + 0x150) == this) {
    ___strncpy_chk(param_1,"kernel_task",(long)(int)param_2,0xffffffffffffffff);
    pid = 0;
  }
  else {
    local_30 = &DAT_aaaaaaaaaaaaaaaa;
    IOAccelSharedUserClientList::Iterator::Iterator
              ((Iterator *)&local_30,(undefined8 *)(*(long *)(this + 0x10) + 0xa98));
    do {
      lVar1 = IOAccelSharedUserClientList::Iterator::getNextSharedUserClient((Iterator *)&local_30);
      if (lVar1 == 0) {
        return -1;
      }
    } while (*(IOAccelTask **)(*(long *)(lVar1 + 0x100) + 0x88) != this);
    pid = *(int *)(lVar1 + 0xe8);
    _proc_name(pid,param_1,param_2);
  }
  return pid;
}



// IOAccelTask::describeDriverAllocations(IOAccelAllocationInfo*)

void IOAccelTask::describeDriverAllocations(void)

{
  return;
}



// IOAccelTask::_RESERVEDIOAccelTask0()

void IOAccelTask::_RESERVEDIOAccelTask0(void)

{
  OSMetaClass::reservedCalled(0x82598);
  return;
}



// IOAccelTask::_RESERVEDIOAccelTask1()

void IOAccelTask::_RESERVEDIOAccelTask1(void)

{
  OSMetaClass::reservedCalled(0x82598);
  return;
}



// IOAccelTask::_RESERVEDIOAccelTask2()

void IOAccelTask::_RESERVEDIOAccelTask2(void)

{
  OSMetaClass::reservedCalled(0x82598);
  return;
}



// IOAccelTask::_RESERVEDIOAccelTask3()

void IOAccelTask::_RESERVEDIOAccelTask3(void)

{
  OSMetaClass::reservedCalled(0x82598);
  return;
}



// IOAccelTask::_RESERVEDIOAccelTask4()

void IOAccelTask::_RESERVEDIOAccelTask4(void)

{
  OSMetaClass::reservedCalled(0x82598);
  return;
}



// IOAccelTask::_RESERVEDIOAccelTask5()

void IOAccelTask::_RESERVEDIOAccelTask5(void)

{
  OSMetaClass::reservedCalled(0x82598);
  return;
}



// IOAccelTask::MetaClass::~MetaClass()

void __thiscall IOAccelTask::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelTask_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelTask::gMetaClass,"IOAccelTask",
             (OSMetaClass *)PTR_gMetaClass_0006b068,600);
  _gMetaClass = &PTR__MetaClass_0007bb78;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelTask::gMetaClass);
  return;
}



// IOAccelVideoContext2::MetaClass::MetaClass()

void __thiscall IOAccelVideoContext2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelVideoContext2",(OSMetaClass *)&IOAccelContext2::gMetaClass,
             0x10e8);
  *(undefined ***)this = &PTR__MetaClass_0007c7f8;
  return;
}



// IOAccelVideoContext2::MetaClass::~MetaClass()

void __thiscall IOAccelVideoContext2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelVideoContext2::IOAccelVideoContext2(OSMetaClass const*)

void __thiscall
IOAccelVideoContext2::IOAccelVideoContext2(IOAccelVideoContext2 *this,OSMetaClass *param_1)

{
  IOAccelContext2::IOAccelContext2((IOAccelContext2 *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelVideoContext2_0007bc70;
  return;
}



// IOAccelVideoContext2::IOAccelVideoContext2(OSMetaClass const*)

void __thiscall
IOAccelVideoContext2::IOAccelVideoContext2(IOAccelVideoContext2 *this,OSMetaClass *param_1)

{
  IOAccelContext2::IOAccelContext2((IOAccelContext2 *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelVideoContext2_0007bc70;
  return;
}



// IOAccelVideoContext2::~IOAccelVideoContext2()

void __thiscall IOAccelVideoContext2::~IOAccelVideoContext2(IOAccelVideoContext2 *this)

{
  IOAccelContext2::~IOAccelContext2((IOAccelContext2 *)this);
  return;
}



// IOAccelVideoContext2::~IOAccelVideoContext2()

void __thiscall IOAccelVideoContext2::~IOAccelVideoContext2(IOAccelVideoContext2 *this)

{
  IOAccelContext2::~IOAccelContext2((IOAccelContext2 *)this);
  return;
}



// IOAccelVideoContext2::~IOAccelVideoContext2()

void __thiscall IOAccelVideoContext2::~IOAccelVideoContext2(IOAccelVideoContext2 *this)

{
  IOAccelContext2::~IOAccelContext2((IOAccelContext2 *)this);
  _OSObject_typed_operator_delete(&IOAccelVideoContext2_ktv,this,&DAT_000010e8);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelVideoContext2::operator delete(void*, unsigned long)

void __cdecl IOAccelVideoContext2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelVideoContext2_ktv,param_1,param_2);
  return;
}



// IOAccelVideoContext2::getMetaClass() const

undefined1 * IOAccelVideoContext2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelVideoContext2::MetaClass::MetaClass()

void __thiscall IOAccelVideoContext2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelVideoContext2",(OSMetaClass *)&IOAccelContext2::gMetaClass,
             0x10e8);
  *(undefined ***)this = &PTR__MetaClass_0007c7f8;
  return;
}



// IOAccelVideoContext2::MetaClass::alloc() const

undefined8 IOAccelVideoContext2::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelVideoContext2::operator new(unsigned long)

void * __thiscall IOAccelVideoContext2::operator_new(IOAccelVideoContext2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelVideoContext2_ktv,this);
  return pvVar1;
}



// IOAccelVideoContext2::contextStart()

ulong __thiscall IOAccelVideoContext2::contextStart(IOAccelVideoContext2 *this)

{
  int *piVar1;
  long lVar2;
  ulong uVar3;
  
  uVar3 = IOAccelContext2::contextStart((IOAccelContext2 *)this);
  if ((char)uVar3 != '\0') {
    lVar2 = *(long *)(this + 0x5a8);
    IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar2 + 0x388) + 0x58),0x24);
    piVar1 = (int *)(lVar2 + 0x230);
    *piVar1 = *piVar1 + 1;
  }
  return uVar3 & 0xffffffff;
}



// IOAccelVideoContext2::contextStop()

void __thiscall IOAccelVideoContext2::contextStop(IOAccelVideoContext2 *this)

{
  int *piVar1;
  long lVar2;
  
  lVar2 = *(long *)(this + 0x5a8);
  IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar2 + 0x388) + 0x58),0x24);
  piVar1 = (int *)(lVar2 + 0x230);
  *piVar1 = *piVar1 + -1;
  IOAccelContext2::contextStop((IOAccelContext2 *)this);
  return;
}



// IOAccelVideoContext2::processSidebandToken(IOAccelCommandStreamInfo&)

void IOAccelVideoContext2::processSidebandToken(void)

{
  long in_RSI;
  IOAccelContext2 *in_RDI;
  
  IOAccelContext2::processSidebandToken(in_RDI,in_RSI);
  return;
}



// IOAccelVideoContext2::discardSidebandToken(IOAccelCommandStreamInfo&)

void IOAccelVideoContext2::discardSidebandToken(void)

{
  long in_RSI;
  IOAccelContext2 *in_RDI;
  
  IOAccelContext2::discardSidebandToken(in_RDI,in_RSI);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelVideoContext2::processDataBuffers(unsigned int)

void __cdecl IOAccelVideoContext2::processDataBuffers(long param_1,undefined4 param_2)

{
  undefined4 uVar1;
  
  uVar1 = IOGraphicsAccelerator2::acceleratorWaitEnabled
                    (*(IOGraphicsAccelerator2 **)(param_1 + 0x5a8));
  if ((char)uVar1 == '\0') {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: %s device terminated\n",
                      "virtual uint32_t IOAccelVideoContext2::processDataBuffers(uint32_t)",
                      *(undefined8 *)(*(long *)(param_1 + 0x5a8) + 0xc88));
    *(byte *)(param_1 + 0x63b) = *(byte *)(param_1 + 0x63b) | 8;
  }
  IOAccelContext2::processDataBuffers((long *)param_1);
  return;
}



// IOAccelVideoContext2::_RESERVEDIOAccelVideoContext0()

void IOAccelVideoContext2::_RESERVEDIOAccelVideoContext0(void)

{
  OSMetaClass::reservedCalled(0x825c0);
  return;
}



// IOAccelVideoContext2::_RESERVEDIOAccelVideoContext1()

void IOAccelVideoContext2::_RESERVEDIOAccelVideoContext1(void)

{
  OSMetaClass::reservedCalled(0x825c0);
  return;
}



// IOAccelVideoContext2::_RESERVEDIOAccelVideoContext2()

void IOAccelVideoContext2::_RESERVEDIOAccelVideoContext2(void)

{
  OSMetaClass::reservedCalled(0x825c0);
  return;
}



// IOAccelVideoContext2::_RESERVEDIOAccelVideoContext3()

void IOAccelVideoContext2::_RESERVEDIOAccelVideoContext3(void)

{
  OSMetaClass::reservedCalled(0x825c0);
  return;
}



// IOAccelVideoContext2::_RESERVEDIOAccelVideoContext4()

void IOAccelVideoContext2::_RESERVEDIOAccelVideoContext4(void)

{
  OSMetaClass::reservedCalled(0x825c0);
  return;
}



// IOAccelVideoContext2::_RESERVEDIOAccelVideoContext5()

void IOAccelVideoContext2::_RESERVEDIOAccelVideoContext5(void)

{
  OSMetaClass::reservedCalled(0x825c0);
  return;
}



// IOAccelVideoContext2::MetaClass::~MetaClass()

void __thiscall IOAccelVideoContext2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelContext2::getOwningTask() const

undefined8 __thiscall IOAccelContext2::getOwningTask(IOAccelContext2 *this)

{
  return *(undefined8 *)(this + 0x578);
}



// IOAccelContext2::getGPUTask() const

undefined8 __thiscall IOAccelContext2::getGPUTask(IOAccelContext2 *this)

{
  return *(undefined8 *)(this + 0x598);
}



// IOAccelContext2::getOwningTaskPid() const

undefined4 __thiscall IOAccelContext2::getOwningTaskPid(IOAccelContext2 *this)

{
  return *(undefined4 *)(this + 0x580);
}



// IOAccelSubmitter2::retireCommandBuffer(IOAccelEventFence*)

void IOAccelSubmitter2::retireCommandBuffer(void)

{
  return;
}



// IOAccelSubmitter2::setSubmissionError(unsigned int)

void IOAccelSubmitter2::setSubmissionError(void)

{
  return;
}



// IOAccelSubmitter2::isOpportunisticWorkload() const

undefined8 IOAccelSubmitter2::isOpportunisticWorkload(void)

{
  return 0;
}



// IOAccelContext2::postTokenSanityCheck(IOAccelCommandStreamInfo&)

void IOAccelContext2::postTokenSanityCheck(void)

{
  return;
}



// IOAccelContext2::getDataBufferPrivate(IOAccelResource2*, IOAccelResourcePrivate*, unsigned long
// long)

void IOAccelContext2::getDataBufferPrivate(void)

{
  return;
}



// IOAccelContext2::validateDataBuffer(unsigned long long, IOBufferMemoryDescriptor*,
// IOAccelResource2*)

undefined8 IOAccelContext2::validateDataBuffer(void)

{
  return 0;
}



// IOAccelContext2::invalidate()

void IOAccelContext2::invalidate(void)

{
  return;
}



// IOAccelContext2::getFrameDelimiter()

undefined8 IOAccelContext2::getFrameDelimiter(void)

{
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelVideoContext_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelVideoContext2::gMetaClass,"IOAccelVideoContext2",
             (OSMetaClass *)&IOAccelContext2::gMetaClass,0x10e8);
  _gMetaClass = &PTR__MetaClass_0007c7f8;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelVideoContext2::gMetaClass);
  return;
}



// IOGraphicsAccelerator2::MetaClass::MetaClass()

void __thiscall IOGraphicsAccelerator2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOGraphicsAccelerator2",(OSMetaClass *)PTR_gMetaClass_0006b028,
             0xdd8);
  *(undefined ***)this = &PTR__MetaClass_0007d3f8;
  return;
}



// IOGraphicsAccelerator2::MetaClass::~MetaClass()

void __thiscall IOGraphicsAccelerator2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOGraphicsAccelerator2::IOGraphicsAccelerator2(OSMetaClass const*)

void __thiscall
IOGraphicsAccelerator2::IOGraphicsAccelerator2(IOGraphicsAccelerator2 *this,OSMetaClass *param_1)

{
  IOAccelerator::IOAccelerator((IOAccelerator *)this,param_1);
  *(undefined ***)this = &PTR__IOGraphicsAccelerator2_0007c8f0;
  *(undefined ***)(this + 0xb60) = &PTR_init_000814e0;
  *(undefined ***)(this + 0xbc8) = &PTR_init_00081520;
  return;
}



// IOGraphicsAccelerator2::~IOGraphicsAccelerator2()

void __thiscall IOGraphicsAccelerator2::~IOGraphicsAccelerator2(IOGraphicsAccelerator2 *this)

{
  IOAccelerator::~IOAccelerator((IOAccelerator *)this);
  return;
}



// IOGraphicsAccelerator2::~IOGraphicsAccelerator2()

void __thiscall IOGraphicsAccelerator2::~IOGraphicsAccelerator2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOGraphicsAccelerator2::~IOGraphicsAccelerator2()

void __thiscall IOGraphicsAccelerator2::~IOGraphicsAccelerator2(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOGraphicsAccelerator2::getMetaClass() const

undefined1 * IOGraphicsAccelerator2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOGraphicsAccelerator2::MetaClass::MetaClass()

void __thiscall IOGraphicsAccelerator2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOGraphicsAccelerator2",(OSMetaClass *)PTR_gMetaClass_0006b028,
             0xdd8);
  *(undefined ***)this = &PTR__MetaClass_0007d3f8;
  return;
}



// IOGraphicsAccelerator2::MetaClass::alloc() const

undefined8 IOGraphicsAccelerator2::MetaClass::alloc(void)

{
  return 0;
}



// IOGraphicsAccelerator2::operator new(unsigned long)

void * __thiscall IOGraphicsAccelerator2::operator_new(IOGraphicsAccelerator2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOGraphicsAccelerator2_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOGraphicsAccelerator2::operator delete(void*, unsigned long)

void __cdecl IOGraphicsAccelerator2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOGraphicsAccelerator2_ktv,param_1,param_2);
  return;
}



// IOGraphicsAccelerator2::initializeConfigStructure()

void __thiscall IOGraphicsAccelerator2::initializeConfigStructure(IOGraphicsAccelerator2 *this)

{
  *(undefined8 *)(this + 0xc88) = 0;
  *(undefined8 *)(this + 0xc90) = 0;
  *(undefined4 *)(this + 0xc98) = 0;
  *(undefined4 *)(this + 0xca0) = 1;
  *(undefined8 *)(this + 0xca8) = 0;
  *(undefined8 *)(this + 0xcb0) = 0x100000001;
  *(undefined4 *)(this + 0xcb8) = 0x10001000;
  *(undefined8 *)(this + 0xcbc) = 0x4000000004000;
  *(undefined8 *)(this + 0xcc4) = 0x1000000000200;
  *(undefined2 *)(this + 0xccc) = 1;
  *(undefined8 *)(this + 0xcd0) = 0x30000000c;
  *(undefined8 *)(this + 0xcd8) = 0x7fff00000003;
  *(undefined4 *)(this + 0xce8) = 0;
  *(undefined8 *)(this + 0xce0) = 0;
  *(undefined8 *)(this + 0xcec) = 0x500000000;
  *(undefined8 *)(this + 0xcf4) = 0x10000000001;
  *(undefined8 *)(this + 0xcfc) = 0x186a000000200;
  *(undefined8 *)(this + 0xd04) = 0x1000030d40;
  *(undefined4 *)(this + 0xd1c) = 0x80;
  *(undefined8 *)(this + 0xd78) = 0;
  *(undefined8 *)(this + 0xd70) = 0;
  *(undefined8 *)(this + 0xd68) = 0;
  *(undefined8 *)(this + 0xd60) = 0;
  *(undefined8 *)(this + 0xd58) = 0;
  *(undefined8 *)(this + 0xd50) = 0;
  *(undefined8 *)(this + 0xd48) = 0;
  *(undefined8 *)(this + 0xd40) = 0;
  *(undefined8 *)(this + 0xd38) = 0;
  *(undefined8 *)(this + 0xd30) = 0;
  *(undefined8 *)(this + 0xd28) = 0;
  *(undefined8 *)(this + 0xd20) = 0;
  return;
}



// IOGraphicsAccelerator2::validateConfigStructure()

ulong __thiscall IOGraphicsAccelerator2::validateConfigStructure(IOGraphicsAccelerator2 *this)

{
  uint uVar1;
  undefined8 unaff_RBX;
  ulong uVar2;
  
  if (*(long *)(this + 0xc88) == 0) {
    uVar2 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: accelName must not NULL\n",
                      "bool IOGraphicsAccelerator2::validateConfigStructure()");
  }
  else if (*(int *)(this + 0xca0) == 0) {
    uVar2 = 0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: numEventChannels must at least 1\n",
                      "bool IOGraphicsAccelerator2::validateConfigStructure()");
  }
  else {
    uVar1 = (int)*(undefined8 *)PTR__page_size_0006b108 - 1;
    if ((*(uint *)(this + 0xcbc) & uVar1) == 0) {
      if ((*(uint *)(this + 0xcc0) & uVar1) == 0) {
        uVar2 = CONCAT71((int7)((ulong)unaff_RBX >> 8),1);
        if (*(int *)(this + 0xcf0) == 0) {
          uVar2 = 0;
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: waitForGPUTimeoutSeconds can not be zero.\n",
                            "bool IOGraphicsAccelerator2::validateConfigStructure()");
        }
      }
      else {
        uVar2 = 0;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: sidebandBufferSizeMax must be page size aligned.\n",
                          "bool IOGraphicsAccelerator2::validateConfigStructure()");
      }
    }
    else {
      uVar2 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: sidebandBufferSizeMin must be page size aligned.\n",
                        "bool IOGraphicsAccelerator2::validateConfigStructure()");
    }
  }
  return uVar2 & 0xffffffff;
}



// IOGraphicsAccelerator2::configIsHeadless()

bool __thiscall IOGraphicsAccelerator2::configIsHeadless(IOGraphicsAccelerator2 *this)

{
  int iVar1;
  
  iVar1 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x378));
  return iVar1 == 0;
}



// IOGraphicsAccelerator2::initLog(char const*)

void __thiscall IOGraphicsAccelerator2::initLog(IOGraphicsAccelerator2 *this,char *param_1)

{
  long lVar1;
  OSDictionary *pOVar2;
  long *plVar3;
  char local_b8 [128];
  long local_38;
  
  local_38 = *(long *)PTR____stack_chk_guard_0006b0b0;
  lVar1 = OSData::withCapacity(0);
  *(long *)(this + 0xd90) = lVar1;
  if (lVar1 != 0) {
    pOVar2 = (OSDictionary *)IOService::nameMatching("IOResources",(OSDictionary *)0x0);
    if (pOVar2 != (OSDictionary *)0x0) {
      plVar3 = (long *)IOService::copyMatchingService(pOVar2);
      if (plVar3 != (long *)0x0) {
        local_b8[0x78] = '\0';
        local_b8[0x79] = '\0';
        local_b8[0x7a] = '\0';
        local_b8[0x7b] = '\0';
        local_b8[0x7c] = '\0';
        local_b8[0x7d] = '\0';
        local_b8[0x7e] = '\0';
        local_b8[0x7f] = '\0';
        local_b8[0x70] = '\0';
        local_b8[0x71] = '\0';
        local_b8[0x72] = '\0';
        local_b8[0x73] = '\0';
        local_b8[0x74] = '\0';
        local_b8[0x75] = '\0';
        local_b8[0x76] = '\0';
        local_b8[0x77] = '\0';
        local_b8[0x68] = '\0';
        local_b8[0x69] = '\0';
        local_b8[0x6a] = '\0';
        local_b8[0x6b] = '\0';
        local_b8[0x6c] = '\0';
        local_b8[0x6d] = '\0';
        local_b8[0x6e] = '\0';
        local_b8[0x6f] = '\0';
        local_b8[0x60] = '\0';
        local_b8[0x61] = '\0';
        local_b8[0x62] = '\0';
        local_b8[99] = '\0';
        local_b8[100] = '\0';
        local_b8[0x65] = '\0';
        local_b8[0x66] = '\0';
        local_b8[0x67] = '\0';
        local_b8[0x58] = '\0';
        local_b8[0x59] = '\0';
        local_b8[0x5a] = '\0';
        local_b8[0x5b] = '\0';
        local_b8[0x5c] = '\0';
        local_b8[0x5d] = '\0';
        local_b8[0x5e] = '\0';
        local_b8[0x5f] = '\0';
        local_b8[0x50] = '\0';
        local_b8[0x51] = '\0';
        local_b8[0x52] = '\0';
        local_b8[0x53] = '\0';
        local_b8[0x54] = '\0';
        local_b8[0x55] = '\0';
        local_b8[0x56] = '\0';
        local_b8[0x57] = '\0';
        local_b8[0x48] = '\0';
        local_b8[0x49] = '\0';
        local_b8[0x4a] = '\0';
        local_b8[0x4b] = '\0';
        local_b8[0x4c] = '\0';
        local_b8[0x4d] = '\0';
        local_b8[0x4e] = '\0';
        local_b8[0x4f] = '\0';
        local_b8[0x40] = '\0';
        local_b8[0x41] = '\0';
        local_b8[0x42] = '\0';
        local_b8[0x43] = '\0';
        local_b8[0x44] = '\0';
        local_b8[0x45] = '\0';
        local_b8[0x46] = '\0';
        local_b8[0x47] = '\0';
        local_b8[0x38] = '\0';
        local_b8[0x39] = '\0';
        local_b8[0x3a] = '\0';
        local_b8[0x3b] = '\0';
        local_b8[0x3c] = '\0';
        local_b8[0x3d] = '\0';
        local_b8[0x3e] = '\0';
        local_b8[0x3f] = '\0';
        local_b8[0x30] = '\0';
        local_b8[0x31] = '\0';
        local_b8[0x32] = '\0';
        local_b8[0x33] = '\0';
        local_b8[0x34] = '\0';
        local_b8[0x35] = '\0';
        local_b8[0x36] = '\0';
        local_b8[0x37] = '\0';
        local_b8[0x28] = '\0';
        local_b8[0x29] = '\0';
        local_b8[0x2a] = '\0';
        local_b8[0x2b] = '\0';
        local_b8[0x2c] = '\0';
        local_b8[0x2d] = '\0';
        local_b8[0x2e] = '\0';
        local_b8[0x2f] = '\0';
        local_b8[0x20] = '\0';
        local_b8[0x21] = '\0';
        local_b8[0x22] = '\0';
        local_b8[0x23] = '\0';
        local_b8[0x24] = '\0';
        local_b8[0x25] = '\0';
        local_b8[0x26] = '\0';
        local_b8[0x27] = '\0';
        local_b8[0x18] = '\0';
        local_b8[0x19] = '\0';
        local_b8[0x1a] = '\0';
        local_b8[0x1b] = '\0';
        local_b8[0x1c] = '\0';
        local_b8[0x1d] = '\0';
        local_b8[0x1e] = '\0';
        local_b8[0x1f] = '\0';
        local_b8[0x10] = '\0';
        local_b8[0x11] = '\0';
        local_b8[0x12] = '\0';
        local_b8[0x13] = '\0';
        local_b8[0x14] = '\0';
        local_b8[0x15] = '\0';
        local_b8[0x16] = '\0';
        local_b8[0x17] = '\0';
        local_b8[8] = '\0';
        local_b8[9] = '\0';
        local_b8[10] = '\0';
        local_b8[0xb] = '\0';
        local_b8[0xc] = '\0';
        local_b8[0xd] = '\0';
        local_b8[0xe] = '\0';
        local_b8[0xf] = '\0';
        local_b8[0] = '\0';
        local_b8[1] = '\0';
        local_b8[2] = '\0';
        local_b8[3] = '\0';
        local_b8[4] = '\0';
        local_b8[5] = '\0';
        local_b8[6] = '\0';
        local_b8[7] = '\0';
        _snprintf(local_b8,0x7f,"IOAFTriage-%s",param_1);
        (**(code **)(*plVar3 + 0x268))(plVar3,local_b8,*(undefined8 *)(this + 0xd90));
        (**(code **)(*plVar3 + 0x28))(plVar3);
      }
      (**(code **)(*(long *)pOVar2 + 0x28))(pOVar2);
    }
  }
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_38) {
    return;
  }
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// IOGraphicsAccelerator2::appendLog(unsigned char)

void __thiscall IOGraphicsAccelerator2::appendLog(IOGraphicsAccelerator2 *this,undefined1 param_1)

{
  long *plVar1;
  undefined1 local_9;
  
  plVar1 = *(long **)(this + 0xd90);
  if (plVar1 != (long *)0x0) {
    local_9 = param_1;
    (**(code **)(*plVar1 + 0x168))(plVar1,&local_9,1);
  }
  return;
}



// IOGraphicsAccelerator2::start(IOService*)

ulong __thiscall
IOGraphicsAccelerator2::start(IOGraphicsAccelerator2 *this,OSMetaClassBase *param_1)

{
  long *plVar1;
  char cVar2;
  bool bVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  undefined4 uVar7;
  boolean_t bVar8;
  undefined8 uVar9;
  long *plVar10;
  OSMetaClassBase *pOVar11;
  char *pcVar12;
  void *pvVar13;
  OSDictionary *pOVar14;
  ulong uVar15;
  IOAccelNamespace *this_00;
  IOAccelBufferMemoryDescriptorPool2 *this_01;
  IOAccelResidentMemorySet *this_02;
  IOAccelFenceMachine *this_03;
  int *piVar16;
  OSString *pOVar17;
  long lVar18;
  ulong uVar19;
  int iVar20;
  OSMetaClass *pOVar21;
  undefined1 *local_78;
  ulong local_70;
  uint local_68;
  int local_64;
  int local_60;
  int local_5c;
  int local_58;
  int local_54;
  ulong local_50;
  OSString *local_48;
  long *local_40;
  long local_38;
  
  local_38 = *(long *)PTR____stack_chk_guard_0006b0b0;
  local_78 = &DAT_aaaaaaaaaaaaaaaa;
  uVar15 = 0;
  uVar9 = (**(code **)(*(long *)param_1 + 0x388))(param_1,0);
  initLog(this,uVar9);
  cVar2 = (**(code **)(PTR_vtable_0006b090 + 0x5d0))(this,param_1);
  if (cVar2 != '\0') {
    local_50 = CONCAT71(local_50._1_7_,1);
    plVar10 = *(long **)(this + 0xd90);
    if (plVar10 != (long *)0x0) {
      (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
    }
    *(undefined4 *)(this + 0xe0) = 0;
    *(undefined4 *)(this + 0xec) = 0;
    *(undefined8 *)(this + 0x138) = 0;
    *(undefined8 *)(this + 0x130) = 0;
    *(undefined8 *)(this + 0x9d8) = 0;
    *(undefined8 *)(this + 0x9d0) = 0;
    *(undefined8 *)(this + 0x9c8) = 0;
    *(undefined8 *)(this + 0x360) = 0;
    *(undefined8 *)(this + 0x350) = 0;
    *(undefined8 *)(this + 0x338) = 0;
    *(undefined8 *)(this + 0x160) = 0;
    *(uint *)(this + 0xc78) = *(uint *)(this + 0xc78) & 0xfffffbe8;
    *(undefined8 *)(this + 0x158) = 0;
    *(undefined4 *)(this + 0x9bc) = 0;
    *(undefined4 *)(this + 0x90) = 0;
    *(undefined8 *)(this + 0x380) = 0;
    *(undefined8 *)(this + 0x378) = 0;
    *(undefined8 *)(this + 0x388) = 0;
    *(undefined8 *)(this + 0xf0) = 0;
    *(undefined8 *)(this + 0x100) = 0;
    *(undefined8 *)(this + 0xf8) = 0;
    *(undefined8 *)(this + 0x110) = 0;
    *(undefined8 *)(this + 0x108) = 0;
    *(undefined4 *)(this + 0xa0) = 0;
    *(undefined8 *)(this + 0xa8) = 0;
    *(undefined8 *)(this + 0xb0) = 0;
    *(undefined8 *)(this + 0x140) = 0;
    *(undefined8 *)(this + 0x180) = 0;
    *(undefined8 *)(this + 0x188) = 0;
    *(undefined8 *)(this + 400) = 0;
    *(undefined8 *)(this + 0xc80) = 0;
    lVar18 = 0x3b0;
    do {
      *(undefined8 *)(this + lVar18 + -0x10) = 0;
      *(undefined8 *)(this + lVar18 + -8) = 0;
      *(undefined4 *)(this + lVar18) = 0;
      lVar18 = lVar18 + 0x18;
    } while (lVar18 != 0x9b0);
    *(undefined4 *)(this + 0x9a0) = 0;
    *(undefined8 *)(this + 0x9e8) = 0;
    *(IOGraphicsAccelerator2 **)(this + 0x9f0) = this + 0x9e8;
    *(undefined8 *)(this + 0x9f8) = 0;
    *(undefined8 *)(this + 0xa00) = 0x1000000000000000;
    *(undefined8 *)(this + 0x150) = 0;
    *(undefined8 *)(this + 0x390) = 0;
    ___bzero(this + 0x1a0,0x198);
    iVar4 = _csr_check(0x10);
    *(uint *)(this + 0xc78) = *(uint *)(this + 0xc78) & 0xfffff7ff | (uint)(iVar4 == 0) << 0xb;
    lVar18 = _IOLockAlloc();
    *(long *)(this + 0x88) = lVar18;
    if (lVar18 == 0) {
      (**(code **)(*(long *)this + 0x5c8))(this,param_1);
      uVar15 = 0;
    }
    else {
      local_50 = CONCAT71(local_50._1_7_,2);
      plVar10 = *(long **)(this + 0xd90);
      if (plVar10 != (long *)0x0) {
        (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
        lVar18 = *(long *)(this + 0x88);
      }
      _IOLockLock(lVar18);
      _OSIncrementAtomic(this + 0x158);
      (**(code **)(*(long *)this + 0x850))(this,"",0);
      lVar18 = OSMetaClassBase::safeMetaCast(param_1,*(OSMetaClass **)PTR_metaClass_0006b078);
      *(long *)(this + 0x368) = lVar18;
      if (lVar18 == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: provider is not the right device\n",
                          "virtual bool IOGraphicsAccelerator2::start(IOService *)");
LAB_0003bfa9:
        (**(code **)(*(long *)this + 0x858))(this,"",0);
        unlock_busy(this);
        _IOLockUnlock(*(undefined8 *)(this + 0x88));
      }
      else {
        local_50 = CONCAT71(local_50._1_7_,3);
        plVar10 = *(long **)(this + 0xd90);
        if (plVar10 != (long *)0x0) {
          (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
          lVar18 = *(long *)(this + 0x368);
        }
        cVar2 = (**(code **)(*(long *)this + 0x9c0))(this,lVar18);
        if (cVar2 == '\0') {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: configureDevice failed\n",
                            "virtual bool IOGraphicsAccelerator2::start(IOService *)");
          goto LAB_0003bfa9;
        }
        local_50 = CONCAT71(local_50._1_7_,4);
        plVar10 = *(long **)(this + 0xd90);
        if (plVar10 != (long *)0x0) {
          (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
        }
        plVar10 = (long *)OSMetaClassBase::safeMetaCast
                                    (*(OSMetaClassBase **)(this + 0x368),
                                     *(OSMetaClass **)PTR_metaClass_0006b038);
        if (plVar10 == (long *)0x0) {
LAB_0003c027:
          uVar9 = 0;
        }
        else {
          pOVar11 = (OSMetaClassBase *)(**(code **)(*plVar10 + 0x2b8))(plVar10,"model");
          plVar10 = (long *)OSMetaClassBase::safeMetaCast
                                      (pOVar11,*(OSMetaClass **)PTR_metaClass_0006b050);
          if (plVar10 == (long *)0x0) goto LAB_0003c027;
          uVar5 = (**(code **)(*plVar10 + 0x140))(plVar10);
          uVar6 = 0xfff;
          if (uVar5 < 0xfff) {
            uVar6 = (**(code **)(*plVar10 + 0x140))(plVar10);
          }
          local_70 = (ulong)(uVar6 + 1);
          pcVar12 = (char *)_IOMallocData();
          if (pcVar12 == (char *)0x0) goto LAB_0003c027;
          pvVar13 = (void *)(**(code **)(*plVar10 + 0x178))(plVar10);
          if (uVar6 == 0xffffffff) {
            start();
            if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_38) {
              return 0;
            }
            goto LAB_0003d315;
          }
          _memmove(pcVar12,pvVar13,(ulong)uVar6);
          pcVar12[uVar6] = '\0';
          uVar9 = OSString::withCString(pcVar12);
          _IOFreeData(pcVar12,local_70);
        }
        *(undefined8 *)(this + 0x370) = uVar9;
        *(undefined4 *)(this + 0x9c0) = 0;
        pOVar11 = (OSMetaClassBase *)
                  (**(code **)(**(long **)(this + 0x368) + 0x2b8))
                            (*(long **)(this + 0x368),"IOMemoryDescriptorOptions");
        pOVar21 = *(OSMetaClass **)PTR_metaClass_0006b060;
        plVar10 = (long *)OSMetaClassBase::safeMetaCast(pOVar11,pOVar21);
        if (plVar10 != (long *)0x0) {
          uVar7 = (**(code **)(*plVar10 + 0x148))(plVar10);
          *(undefined4 *)(this + 0x9c0) = uVar7;
        }
        pOVar14 = (OSDictionary *)IOService::nameMatching("GMUX",(OSDictionary *)0x0);
        plVar10 = (long *)IOService::copyMatchingService(pOVar14);
        if (plVar10 != (long *)0x0) {
          this[0xc78] = (IOGraphicsAccelerator2)((byte)this[0xc78] | 0x80);
          (**(code **)(*plVar10 + 0x28))(plVar10);
        }
        (**(code **)(*(long *)pOVar14 + 0x28))(pOVar14);
        local_50._0_1_ = 5;
        plVar10 = *(long **)(this + 0xd90);
        if (plVar10 != (long *)0x0) {
          (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
        }
        initializeConfigStructure(this);
        (**(code **)(*(long *)this + 0x9b0))(this,this + 0xc88);
        local_50 = CONCAT71(local_50._1_7_,6);
        plVar10 = *(long **)(this + 0xd90);
        if (plVar10 != (long *)0x0) {
          (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
        }
        if (((byte)this[0xc92] & 0x20) != 0) {
          this[0xcec] = (IOGraphicsAccelerator2)((byte)this[0xcec] | 10);
        }
        lVar18 = (**(code **)(*(long *)this + 0x2d0))
                           (this,"IOPCITunnelled",*(undefined8 *)PTR__gIOServicePlane_0006b0c8,3);
        if (lVar18 != 0) {
          this[0xc91] = (IOGraphicsAccelerator2)((byte)this[0xc91] | 0x20);
          (**(code **)(*(long *)this + 0x278))(this,"Removable",1);
          IOService::requireMaxInterruptDelay((uint)this);
        }
        local_50 = CONCAT71(local_50._1_7_,7);
        plVar10 = *(long **)(this + 0xd90);
        if (plVar10 != (long *)0x0) {
          (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
        }
        *(undefined4 *)(this + 0xc9c) = 0;
        local_68 = 0;
        bVar8 = _PE_parse_boot_argn("ioaccel_debug",&local_68,4);
        if ((bVar8 != 0) && (local_68 != 0)) {
          *(uint *)(this + 0xc9c) = *(uint *)(this + 0xc9c) | local_68 & 0xf00005f;
        }
        local_64 = 0;
        bVar8 = _PE_parse_boot_argn("panic_on_gpu_hang",&local_64,4);
        if ((bVar8 != 0) && (local_64 != 0)) {
          this[0xc9c] = (IOGraphicsAccelerator2)((byte)this[0xc9c] | 2);
        }
        local_60 = 0;
        bVar8 = _PE_parse_boot_argn("panic_on_display_hang",&local_60,4);
        if ((bVar8 != 0) && (local_60 != 0)) {
          this[0xc9f] = (IOGraphicsAccelerator2)((byte)this[0xc9f] | 4);
        }
        local_5c = 0;
        bVar8 = _PE_parse_boot_argn("spin_wait_for_gpu",&local_5c,4);
        if ((bVar8 != 0) && (local_5c != 0)) {
          this[0xc9c] = (IOGraphicsAccelerator2)((byte)this[0xc9c] | 1);
        }
        local_58 = 0;
        bVar8 = _PE_parse_boot_argn("gpu_no_zero_fill",&local_58,4);
        if ((bVar8 != 0) && (local_58 != 0)) {
          this[0xc9c] = (IOGraphicsAccelerator2)((byte)this[0xc9c] | 4);
        }
        local_54 = 0;
        bVar8 = _PE_parse_boot_argn("prepare_throttling",&local_54,4);
        if ((bVar8 != 0) && (local_54 != 0)) {
          this[0xc9f] = (IOGraphicsAccelerator2)((byte)this[0xc9f] | 8);
        }
        uVar5 = *(uint *)(this + 0xc9c);
        if (((byte)this[0xc92] & 0x20) != 0) {
          uVar5 = uVar5 & 0xfffffffb;
          *(uint *)(this + 0xc9c) = uVar5;
        }
        if (uVar5 != 0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "IOGraphicsAccelerator:start() [%s: fConfig.debugBits=0x%x]\n",
                            *(undefined8 *)(this + 0xc88));
        }
        local_50 = CONCAT71(local_50._1_7_,8);
        plVar10 = *(long **)(this + 0xd90);
        if (plVar10 != (long *)0x0) {
          (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
        }
        if ((((byte)this[0xcec] & 0x40) == 0) ||
           (uVar15 = createDMACommandPool(this), (char)uVar15 != '\0')) {
          pOVar14 = (OSDictionary *)IOService::nameMatching("IOSurfaceRoot",(OSDictionary *)0x0);
          plVar10 = (long *)IOService::waitForService(pOVar14,(mach_timespec *)0x0);
          *(long **)(this + 0x170) = plVar10;
          if (plVar10 == (long *)0x0) {
            bVar3 = false;
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                              "%s: fail to get IOSurface root\n",
                              "virtual bool IOGraphicsAccelerator2::start(IOService *)");
          }
          else {
            local_50._0_1_ = 9;
            plVar1 = *(long **)(this + 0xd90);
            if (plVar1 != (long *)0x0) {
              (**(code **)(*plVar1 + 0x168))(plVar1,&local_50,1);
              plVar10 = *(long **)(this + 0x170);
            }
            (**(code **)(*plVar10 + 0x20))(plVar10);
            IOSurfaceRoot::updateLimits
                      ((uint)*(undefined8 *)(this + 0x170),*(uint *)(this + 0xcd4),
                       *(uint *)(this + 0xcd8),*(uint *)(this + 0xcdc),
                       (uint)*(ushort *)(this + 0xcb8));
            uVar7 = IOSurfaceRoot::generateUniqueAcceleratorID(*(void **)(this + 0x170));
            *(undefined4 *)(this + 0x178) = uVar7;
            initGlobalCommPage(this);
            local_50 = CONCAT71(local_50._1_7_,10);
            plVar10 = *(long **)(this + 0xd90);
            if (plVar10 != (long *)0x0) {
              (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
            }
            oneTimeSetup();
            this_00 = IOAccelNamespace::operator_new
                                ((IOAccelNamespace *)(segment_command_00000020.segname + 8));
            IOAccelNamespace::IOAccelNamespace(this_00);
            *(IOAccelNamespace **)(this + 0xc80) = this_00;
            if (this_00 != (IOAccelNamespace *)0x0) {
              local_50 = CONCAT71(local_50._1_7_,0xb);
              plVar10 = *(long **)(this + 0xd90);
              if (plVar10 != (long *)0x0) {
                (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
                this_00 = *(IOAccelNamespace **)(this + 0xc80);
              }
              cVar2 = (**(code **)(*(long *)this_00 + 0x88))(this_00);
              if (cVar2 != '\0') {
                local_50 = CONCAT71(local_50._1_7_,0xc);
                plVar10 = *(long **)(this + 0xd90);
                if (plVar10 != (long *)0x0) {
                  (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
                }
                lVar18 = (**(code **)(*(long *)this + 0x880))(this);
                *(long *)(this + 0x380) = lVar18;
                if (lVar18 == 0) {
                  bVar3 = false;
                  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                    "%s: failed to create event machine\n",
                                    "virtual bool IOGraphicsAccelerator2::start(IOService *)");
                }
                else {
                  local_50 = CONCAT71(local_50._1_7_,0xd);
                  plVar10 = *(long **)(this + 0xd90);
                  if (plVar10 != (long *)0x0) {
                    (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
                  }
                  if (((byte)this[0xc92] & 0x20) != 0) {
                    this_01 = IOAccelBufferMemoryDescriptorPool2::operator_new
                                        ((IOAccelBufferMemoryDescriptorPool2 *)
                                         segment_command_000001a8.segname);
                    IOAccelBufferMemoryDescriptorPool2::IOAccelBufferMemoryDescriptorPool2(this_01);
                    *(IOAccelBufferMemoryDescriptorPool2 **)(this + 0xc30) = this_01;
                    IOAccelBufferMemoryDescriptorPool2::initWithAccelerator(this_01,(long)this);
                  }
                  local_50 = CONCAT71(local_50._1_7_,0xe);
                  plVar10 = *(long **)(this + 0xd90);
                  if (plVar10 != (long *)0x0) {
                    (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
                  }
                  IOAccelChannelList::init((IOAccelChannelList *)(this + 0xc38));
                  IOAccelTaskList::init((IOAccelTaskList *)(this + 0xc48));
                  IOAccelTaskList::init((IOAccelTaskList *)(this + 0xc58));
                  IOAccelCommandBufferPoolList::init((IOAccelCommandBufferPoolList *)(this + 0xc68))
                  ;
                  plVar10 = (long *)(**(code **)(*(long *)this + 0xa00))(this);
                  *(long **)(this + 0x378) = plVar10;
                  if (plVar10 == (long *)0x0) {
                    bVar3 = false;
                    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                      "%s: fDisplayMachine alloc failed\n",
                                      "virtual bool IOGraphicsAccelerator2::start(IOService *)");
                  }
                  else {
                    local_50._0_1_ = 0xf;
                    plVar1 = *(long **)(this + 0xd90);
                    if (plVar1 != (long *)0x0) {
                      (**(code **)(*plVar1 + 0x168))(plVar1,&local_50,1);
                      plVar10 = *(long **)(this + 0x378);
                    }
                    (**(code **)(*plVar10 + 0x850))(plVar10,this);
                    local_50 = CONCAT71(local_50._1_7_,0x10);
                    plVar10 = *(long **)(this + 0xd90);
                    if (plVar10 != (long *)0x0) {
                      (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
                    }
                    IOAccelContextList::init((IOAccelContextList *)(this + 0xa58));
                    IOAccelDeviceList::init((IOAccelDeviceList *)(this + 0xa78));
                    IOAccelSharedList::init((IOAccelSharedList *)(this + 0xa88));
                    IOAccelSurfaceList::init((IOAccelSurfaceList *)(this + 0xaa8));
                    IOAccelSurfaceMTLList::init((IOAccelSurfaceMTLList *)(this + 0xac0));
                    IOAccelVidMemoryList::init((IOAccelVidMemoryList *)(this + 0xb48));
                    IOAccelResourceList::init((IOAccelResourceList *)(this + 0xb00));
                    this_02 = (IOAccelResidentMemorySet *)
                              _IOMallocTypeImpl(IOMallocTypeMixin<>::operator_new);
                    *(IOAccelResidentMemorySet **)(this + 0xa08) = this_02;
                    if ((this_02 == (IOAccelResidentMemorySet *)0x0) ||
                       (bVar3 = IOAccelResidentMemorySet::init(this_02,this), !bVar3)) {
                      bVar3 = false;
                      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                        "Failed to allocate sysmem resident set\n");
                    }
                    else {
                      IOAccelSysMemoryList::init((IOAccelSysMemoryList *)(this + 0xb30));
                      local_50 = CONCAT71(local_50._1_7_,0x11);
                      plVar10 = *(long **)(this + 0xd90);
                      if (plVar10 != (long *)0x0) {
                        (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
                      }
                      plVar10 = (long *)(**(code **)(*(long *)this + 0xa80))(this);
                      *(long **)(this + 0x388) = plVar10;
                      if (plVar10 == (long *)0x0) {
                        bVar3 = false;
                        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                          "%s: statistics object alloc fail\n",
                                          "virtual bool IOGraphicsAccelerator2::start(IOService *)")
                        ;
                      }
                      else {
                        (**(code **)(*plVar10 + 0x118))(plVar10,this);
                        local_50 = CONCAT71(local_50._1_7_,0x12);
                        plVar10 = *(long **)(this + 0xd90);
                        if (plVar10 != (long *)0x0) {
                          (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
                        }
                        lVar18 = IOWorkLoop::workLoop();
                        *(long *)(this + 0xf0) = lVar18;
                        if (lVar18 == 0) {
                          bVar3 = false;
                          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                            "%s: workloop alloc fail\n",
                                            "virtual bool IOGraphicsAccelerator2::start(IOService *)"
                                           );
                        }
                        else {
                          local_50 = CONCAT71(local_50._1_7_,0x13);
                          plVar10 = *(long **)(this + 0xd90);
                          if (plVar10 != (long *)0x0) {
                            (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
                          }
                          lVar18 = IOInterruptEventSource::interruptEventSource
                                             ((OSObject *)this,garbage_collector,(IOService *)0x0,0)
                          ;
                          *(long *)(this + 0x100) = lVar18;
                          if (lVar18 != 0) {
                            (**(code **)(**(long **)(this + 0xf0) + 0x140))
                                      (*(long **)(this + 0xf0),lVar18);
                            (**(code **)(**(long **)(this + 0x100) + 0x150))();
                          }
                          lVar18 = IOTimerEventSource::timerEventSource
                                             ((OSObject *)this,garbage_collector_timer);
                          *(long *)(this + 0xf8) = lVar18;
                          if (lVar18 != 0) {
                            (**(code **)(**(long **)(this + 0xf0) + 0x140))
                                      (*(long **)(this + 0xf0),lVar18);
                            (**(code **)(**(long **)(this + 0xf8) + 0x150))();
                          }
                          lVar18 = IOInterruptEventSource::interruptEventSource
                                             ((OSObject *)this,gart_collector,(IOService *)0x0,0);
                          *(long *)(this + 0x110) = lVar18;
                          if (lVar18 != 0) {
                            (**(code **)(**(long **)(this + 0xf0) + 0x140))
                                      (*(long **)(this + 0xf0),lVar18);
                            (**(code **)(**(long **)(this + 0x110) + 0x150))();
                          }
                          lVar18 = IOTimerEventSource::timerEventSource
                                             ((OSObject *)this,gart_collector_timer);
                          *(long *)(this + 0x108) = lVar18;
                          if (lVar18 != 0) {
                            (**(code **)(**(long **)(this + 0xf0) + 0x140))
                                      (*(long **)(this + 0xf0),lVar18);
                            lVar18 = 0x2a;
                            if (((byte)this[0xc9c] & 0x40) != 0) {
                              __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                                "%s: Gart collector is disabled\n");
                              lVar18 = 0x2b;
                            }
                            (**(code **)(**(long **)(this + 0x108) + lVar18 * 8))();
                          }
                          lVar18 = IOInterruptEventSource::interruptEventSource
                                             ((OSObject *)this,
                                              reusable_orphaned_memory_pool_collector,
                                              (IOService *)0x0,0);
                          *(long *)(this + 0x138) = lVar18;
                          if (lVar18 != 0) {
                            (**(code **)(**(long **)(this + 0xf0) + 0x140))
                                      (*(long **)(this + 0xf0),lVar18);
                            (**(code **)(**(long **)(this + 0x138) + 0x150))();
                          }
                          lVar18 = IOTimerEventSource::timerEventSource
                                             ((OSObject *)this,reusable_orphaned_memory_pool_timer);
                          *(long *)(this + 0x130) = lVar18;
                          if (lVar18 != 0) {
                            (**(code **)(**(long **)(this + 0xf0) + 0x140))
                                      (*(long **)(this + 0xf0),lVar18);
                            (**(code **)(**(long **)(this + 0x130) + 0x150))();
                          }
                          lVar18 = IOInterruptEventSource::interruptEventSource
                                             ((OSObject *)this,
                                              nonreusable_orphaned_memory_pool_collector,
                                              (IOService *)0x0,0);
                          *(long *)(this + 0x9d0) = lVar18;
                          if (lVar18 != 0) {
                            (**(code **)(**(long **)(this + 0xf0) + 0x140))
                                      (*(long **)(this + 0xf0),lVar18);
                            (**(code **)(**(long **)(this + 0x9d0) + 0x150))();
                          }
                          lVar18 = IOTimerEventSource::timerEventSource
                                             ((OSObject *)this,
                                              nonreusable_orphaned_memory_pool_timer);
                          *(long *)(this + 0x9c8) = lVar18;
                          if (lVar18 != 0) {
                            (**(code **)(**(long **)(this + 0xf0) + 0x140))
                                      (*(long **)(this + 0xf0),lVar18);
                            (**(code **)(**(long **)(this + 0x9c8) + 0x150))();
                          }
                          lVar18 = IOInterruptEventSource::interruptEventSource
                                             ((OSObject *)this,finalize_interrupt,(IOService *)0x0,0
                                             );
                          *(long *)(this + 0x9e0) = lVar18;
                          if (lVar18 != 0) {
                            (**(code **)(**(long **)(this + 0xf0) + 0x140))
                                      (*(long **)(this + 0xf0),lVar18);
                            (**(code **)(**(long **)(this + 0x9e0) + 0x150))();
                          }
                          this_03 = IOAccelFenceMachine::operator_new
                                              ((IOAccelFenceMachine *)&section_00000068.size);
                          IOAccelFenceMachine::IOAccelFenceMachine(this_03);
                          *(IOAccelFenceMachine **)(this + 0x390) = this_03;
                          if (this_03 != (IOAccelFenceMachine *)0x0) {
                            uVar15 = IOAccelFenceMachine::init(this_03,(long)this);
                            if ((char)uVar15 == '\0') {
                              (**(code **)(**(long **)(this + 0x390) + 0x28))();
                              *(undefined8 *)(this + 0x390) = 0;
                            }
                            else if (*(long **)(this + 0x390) != (long *)0x0) {
                              local_50 = CONCAT71(local_50._1_7_,0x14);
                              plVar10 = *(long **)(this + 0xd90);
                              if (plVar10 != (long *)0x0) {
                                (**(code **)(*plVar10 + 0x168))(plVar10,&local_50,1);
                              }
                              lVar18 = IOInterruptEventSource::interruptEventSource
                                                 ((OSObject *)this,fence_collector,(IOService *)0x0,
                                                  0);
                              *(long *)(this + 0x128) = lVar18;
                              if (lVar18 != 0) {
                                (**(code **)(**(long **)(this + 0xf0) + 0x140))
                                          (*(long **)(this + 0xf0),lVar18);
                                (**(code **)(**(long **)(this + 0x128) + 0x150))();
                              }
                              if (*(long *)(this + 0xc30) != 0) {
                                lVar18 = IOInterruptEventSource::interruptEventSource
                                                   ((OSObject *)this,memory_pool_interrupt,
                                                    (IOService *)0x0,0);
                                *(long *)(this + 0x120) = lVar18;
                                if (lVar18 != 0) {
                                  (**(code **)(**(long **)(this + 0xf0) + 0x140))
                                            (*(long **)(this + 0xf0),lVar18);
                                  (**(code **)(**(long **)(this + 0x120) + 0x150))();
                                }
                                lVar18 = IOTimerEventSource::timerEventSource
                                                   ((OSObject *)this,memory_pool_timer);
                                *(long *)(this + 0x118) = lVar18;
                                if (lVar18 != 0) {
                                  (**(code **)(**(long **)(this + 0xf0) + 0x140))
                                            (*(long **)(this + 0xf0),lVar18);
                                  (**(code **)(**(long **)(this + 0x118) + 0x150))();
                                }
                              }
                              lVar18 = IOInterruptEventSource::interruptEventSource
                                                 ((OSObject *)this,send_agc_status_message,
                                                  (IOService *)0x0,0);
                              *(long *)(this + 0x140) = lVar18;
                              if (lVar18 == 0) {
                                bVar3 = false;
                                __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                                  "%s: Failed to create event for scheduling send of AGC status messages!\n"
                                                  ,
                                                  "virtual bool IOGraphicsAccelerator2::start(IOService *)"
                                                 );
                              }
                              else {
                                (**(code **)(**(long **)(this + 0xf0) + 0x140))
                                          (*(long **)(this + 0xf0),lVar18);
                                (**(code **)(**(long **)(this + 0x140) + 0x150))();
                                lVar18 = IOInterruptEventSource::interruptEventSource
                                                   ((OSObject *)this,
                                                    display_post_transaction_interrupt,
                                                    (IOService *)0x0,0);
                                *(long *)(this + 0x148) = lVar18;
                                if (lVar18 == 0) {
                                  bVar3 = false;
                                  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                                                                                        
                                                  "%s: Failed to create event for display post-transaction interrupt!\n"
                                                  ,
                                                  "virtual bool IOGraphicsAccelerator2::start(IOService *)"
                                                  );
                                }
                                else {
                                  (**(code **)(**(long **)(this + 0xf0) + 0x140))
                                            (*(long **)(this + 0xf0),lVar18);
                                  (**(code **)(**(long **)(this + 0x148) + 0x150))();
                                  local_50 = 0;
                                  local_78 = (undefined1 *)0x8;
                                  iVar4 = _sysctlbyname("hw.memsize",&local_50,(size_t *)&local_78,
                                                        (void *)0x0,0);
                                  if (iVar4 == 0) {
                                    *(undefined8 *)(this + 0x338) = 0x2000000;
                                    uVar15 = 0x2000000;
                                    if ((((byte)this[0xc92] & 0x20) != 0) &&
                                       (uVar15 = local_50 * 3 >> 5, 0x2fffffff < uVar15)) {
                                      uVar15 = 0x30000000;
                                    }
                                  }
                                  else {
                                    *(undefined8 *)(this + 0x338) = 0x800000;
                                    local_50 = 0x20000000;
                                    uVar15 = 0x800000;
                                  }
                                  *(ulong *)(this + 0x340) = uVar15;
                                  local_40._0_1_ = (OSMetaClass)0x15;
                                  plVar10 = *(long **)(this + 0xd90);
                                  if (plVar10 != (long *)0x0) {
                                    (**(code **)(*plVar10 + 0x168))(plVar10,&local_40,1);
                                  }
                                  (*(code *)**(undefined8 **)(this + 0xb60))
                                            (this + 0xb60,this,local_50 >> 2,&DAT_000012c0);
                                  (*(code *)**(undefined8 **)(this + 0xbc8))
                                            (this + 0xbc8,this,0xffffffffffffffff,0);
                                  local_40 = (long *)CONCAT71(local_40._1_7_,0x16);
                                  plVar10 = *(long **)(this + 0xd90);
                                  if (plVar10 != (long *)0x0) {
                                    (**(code **)(*plVar10 + 0x168))(plVar10,&local_40,1);
                                  }
                                  uVar9 = (**(code **)(*(long *)this + 0x9b8))(this,local_50);
                                  *(undefined8 *)(this + 0x348) = uVar9;
                                  *(ulong *)(this + 0xdc0) = local_50;
                                  *(undefined8 *)(this + 0xb8) = 0xfa;
                                  *(undefined4 *)(this + 0xc0) = 4;
                                  _clock_get_uptime(this + 200);
                                  pOVar11 = (OSMetaClassBase *)
                                            (**(code **)(*(long *)this + 0x2b8))
                                                      (this,"GARTReclaimInterval");
                                  plVar10 = (long *)OSMetaClassBase::safeMetaCast(pOVar11,pOVar21);
                                  if (plVar10 != (long *)0x0) {
                                    uVar7 = (**(code **)(*plVar10 + 0x148))(plVar10);
                                    *(undefined4 *)(this + 0xb8) = uVar7;
                                    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                                                                                            
                                                  "%s: GARTReclaimInterval set to non default value (%d) milisec\n"
                                                  ,*(undefined8 *)(this + 0xc88),uVar7);
                                  }
                                  _nanoseconds_to_absolutetime
                                            (*(int *)(this + 0xb8) * 1000000,this + 0xd0);
                                  pOVar11 = (OSMetaClassBase *)
                                            (**(code **)(*(long *)this + 0x2b8))
                                                      (this,"GARTReclaimTimeout");
                                  plVar10 = (long *)OSMetaClassBase::safeMetaCast(pOVar11,pOVar21);
                                  if (plVar10 != (long *)0x0) {
                                    uVar5 = (**(code **)(*plVar10 + 0x148))(plVar10);
                                    *(uint *)(this + 0xc0) = uVar5 / *(uint *)(this + 0xb8);
                                    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                                                                                            
                                                  "%s: GARTReclaimTimeout set to non default value (%d) milisec\n"
                                                  ,*(undefined8 *)(this + 0xc88),uVar5);
                                  }
                                  if (*(int *)(this + 0xc0) != 0) {
                                    uVar15 = 1;
                                    do {
                                      uVar19 = uVar15;
                                      uVar5 = (uint)uVar19;
                                      uVar15 = (ulong)(uVar5 * 2);
                                    } while (uVar5 < *(int *)(this + 0xc0) + 1U);
                                    *(uint *)(this + 0xb0) = uVar5;
                                    lVar18 = _IOMallocData(uVar19 << 3);
                                    *(long *)(this + 0xa8) = lVar18;
                                    if (lVar18 != 0) {
                                      uVar5 = *(uint *)(this + 0xb0);
                                      if ((ulong)uVar5 != 0) {
                                        uVar15 = 0;
                                        do {
                                          *(undefined8 *)(lVar18 + uVar15 * 8) = 0;
                                          uVar15 = uVar15 + 1;
                                        } while (uVar5 != uVar15);
                                      }
                                      *(undefined4 *)(this + 0xb4) = 0;
                                    }
                                  }
                                  pOVar11 = (OSMetaClassBase *)
                                            (**(code **)(*(long *)this + 0x2b8))
                                                      (this,"GARTCacheSize");
                                  plVar10 = (long *)OSMetaClassBase::safeMetaCast(pOVar11,pOVar21);
                                  if (plVar10 != (long *)0x0) {
                                    uVar5 = (**(code **)(*plVar10 + 0x148))(plVar10);
                                    *(ulong *)(this + 0x338) = (ulong)uVar5;
                                  }
                                  local_40 = (long *)CONCAT71(local_40._1_7_,0x17);
                                  plVar10 = *(long **)(this + 0xd90);
                                  if (plVar10 != (long *)0x0) {
                                    (**(code **)(*plVar10 + 0x168))(plVar10,&local_40,1);
                                  }
                                  piVar16 = (int *)_IOMallocData(0x30);
                                  *(int **)(this + 0xd98) = piVar16;
                                  if (piVar16 == (int *)0x0) {
                                    bVar3 = false;
                                    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                                      "Failed to allocate gart collector ages\n");
                                  }
                                  else {
                                    iVar4 = 0x50;
                                    if (local_50 < 0x200000001) {
                                      iVar4 = 0x14;
                                    }
                                    iVar20 = 0x28;
                                    if (local_50 < 0x200000001) {
                                      iVar20 = 10;
                                    }
                                    *piVar16 = iVar4;
                                    *(undefined8 *)(piVar16 + 2) = *(undefined8 *)(this + 0x338);
                                    piVar16[4] = iVar20;
                                    *(ulong *)(piVar16 + 6) = local_50 >> 4;
                                    piVar16[8] = (uint)(0x200000000 < local_50) << 4 | 4;
                                    *(ulong *)(piVar16 + 10) = local_50 >> 3;
                                    uVar15 = IOAccelResidentMemorySet::setCollectionEras
                                                       (*(IOAccelResidentMemorySet **)(this + 0xa08)
                                                        ,piVar16);
                                    if ((char)uVar15 == '\0') {
                                      bVar3 = false;
                                      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                                        "Failed to set eras\n");
                                    }
                                    else {
                                      local_40 = (long *)CONCAT71(local_40._1_7_,0x18);
                                      plVar10 = *(long **)(this + 0xd90);
                                      if (plVar10 != (long *)0x0) {
                                        (**(code **)(*plVar10 + 0x168))(plVar10,&local_40,1);
                                      }
                                      *(undefined8 *)(this + 0x358) = *(undefined8 *)(this + 0xca8);
                                      lVar18 = (**(code **)(*(long *)this + 0x9d0))(this);
                                      *(long *)(this + 0x150) = lVar18;
                                      if (lVar18 == 0) {
                                        bVar3 = false;
                                        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                                          "%s: createKernelGPUTask failed\n",
                                                                                                                    
                                                  "virtual bool IOGraphicsAccelerator2::start(IOService *)"
                                                  );
                                      }
                                      else {
                                        local_40 = (long *)CONCAT71(local_40._1_7_,0x19);
                                        plVar10 = *(long **)(this + 0xd90);
                                        if (plVar10 != (long *)0x0) {
                                          (**(code **)(*plVar10 + 0x168))(plVar10,&local_40,1);
                                        }
                                        plVar10 = (long *)OSMetaClassBase::safeMetaCast
                                                                    (*(OSMetaClassBase **)
                                                                      (this + 0x368),
                                                                     *(OSMetaClass **)
                                                                      PTR_metaClass_0006b008);
                                        if (plVar10 != (long *)0x0) {
                                          (**(code **)(*plVar10 + 0x8c8))(plVar10,1);
                                          (**(code **)(*plVar10 + 0x8d8))(plVar10,1);
                                        }
                                        (**(code **)(*(long *)this + 0x280))
                                                  (this,"IOAccelRevision",2,0x20);
                                        (**(code **)(*(long *)this + 0x280))
                                                  (this,"AccelCaps",*(undefined4 *)(this + 0xc94),
                                                   0x20);
                                        pOVar17 = (OSString *)
                                                  OSString::withCString
                                                            ("ACCF0000-0000-0000-0000-000a2789904e")
                                        ;
                                        plVar10 = (long *)OSString::withCString
                                                                    ("IOAccelerator2D.plugin");
                                        pOVar21 = (OSMetaClass *)&local_40;
                                        local_48 = pOVar17;
                                        local_40 = plVar10;
                                        uVar9 = OSDictionary::withObjects
                                                          ((OSObject **)pOVar21,&local_48,1,1);
                                        (**(code **)(*(long *)this + 0x268))
                                                  (this,"IOCFPlugInTypes",uVar9);
                                        (**(code **)(*(long *)pOVar17 + 0x28))(pOVar17);
                                        (**(code **)(*plVar10 + 0x28))(plVar10);
                                        local_40 = (long *)CONCAT71(local_40._1_7_,0x1a);
                                        plVar10 = *(long **)(this + 0xd90);
                                        if (plVar10 != (long *)0x0) {
                                          (**(code **)(*plVar10 + 0x168))(plVar10,&local_40,1);
                                        }
                                        bVar3 = true;
                                      }
                                    }
                                  }
                                }
                              }
                              goto LAB_0003cbfd;
                            }
                          }
                          bVar3 = false;
                          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                            "%s: IOAccelFenceMachine alloc or init failed\n",
                                            "virtual bool IOGraphicsAccelerator2::start(IOService *)"
                                           );
                        }
                      }
                    }
                  }
                }
                goto LAB_0003cbfd;
              }
              (**(code **)(**(long **)(this + 0xc80) + 0x28))();
              *(undefined8 *)(this + 0xc80) = 0;
            }
            bVar3 = false;
          }
        }
        else {
          bVar3 = false;
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: Failed to Create Command Pool\n",
                            "virtual bool IOGraphicsAccelerator2::start(IOService *)");
        }
LAB_0003cbfd:
        (**(code **)(*(long *)this + 0x858))(this,"",0);
        unlock_busy(this);
        _IOLockUnlock(*(undefined8 *)(this + 0x88));
        uVar15 = CONCAT71((int7)((ulong)pOVar21 >> 8),1);
        if (bVar3) goto LAB_0003c001;
      }
      uVar15 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "IOGraphicsAccelerator::start: Failure exit\n");
      stop(this,param_1);
    }
  }
LAB_0003c001:
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_38) {
    return uVar15 & 0xffffffff;
  }
LAB_0003d315:
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// IOGraphicsAccelerator2::createDMACommandPool()

ulong __thiscall IOGraphicsAccelerator2::createDMACommandPool(IOGraphicsAccelerator2 *this)

{
  IOGraphicsAccelerator2 *pIVar1;
  IOGraphicsAccelerator2 *pIVar2;
  long lVar3;
  long *plVar4;
  IOGraphicsAccelerator2 *pIVar5;
  ulong uVar6;
  IOGraphicsAccelerator2 *pIVar7;
  
  if (((byte)this[0xcec] & 0x40) == 0) {
    uVar6 = 0;
  }
  else {
    lVar3 = _IOLockAlloc();
    *(long *)(this + 0xa18) = lVar3;
    if (lVar3 == 0) {
      uVar6 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Failed to allocate IODMACommandPool Lock\n",
                        "bool IOGraphicsAccelerator2::createDMACommandPool()");
    }
    else {
      plVar4 = (long *)(**(code **)(*(long *)this + 0xab0))(this);
      *(long **)(this + 0xa10) = plVar4;
      if (plVar4 == (long *)0x0) {
        uVar6 = 0;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Failed to Create IODMACommand\n"
                          ,"bool IOGraphicsAccelerator2::createDMACommandPool()");
      }
      else {
        pIVar1 = this + 0xa20;
        *(IOGraphicsAccelerator2 **)(this + 0xa20) = pIVar1;
        *(IOGraphicsAccelerator2 **)(this + 0xa28) = pIVar1;
        (**(code **)(*plVar4 + 0x20))(plVar4);
        pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0xa20);
        pIVar5 = pIVar2 + 0x18;
        if (pIVar1 == pIVar2) {
          pIVar5 = this + 0xa28;
        }
        pIVar7 = *(IOGraphicsAccelerator2 **)(this + 0xa10);
        *(IOGraphicsAccelerator2 **)pIVar5 = pIVar7;
        *(IOGraphicsAccelerator2 **)(pIVar7 + 0x10) = pIVar2;
        *(IOGraphicsAccelerator2 **)(pIVar7 + 0x18) = pIVar1;
        *(IOGraphicsAccelerator2 **)(this + 0xa20) = pIVar7;
        *(undefined4 *)(this + 0xda0) = 1;
        if (1 < *(uint *)(this + 0xd1c)) {
          uVar6 = 1;
          do {
            lVar3 = (**(code **)(**(long **)(this + 0xa10) + 0x118))(*(long **)(this + 0xa10),0);
            if (lVar3 != 0) {
              pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0xa20);
              pIVar5 = pIVar2 + 0x18;
              if (pIVar1 == pIVar2) {
                pIVar5 = this + 0xa28;
              }
              *(long *)pIVar5 = lVar3;
              *(IOGraphicsAccelerator2 **)(lVar3 + 0x10) = pIVar2;
              *(IOGraphicsAccelerator2 **)(lVar3 + 0x18) = pIVar1;
              *(long *)(this + 0xa20) = lVar3;
              *(int *)(this + 0xda0) = *(int *)(this + 0xda0) + 1;
            }
            uVar6 = uVar6 + 1;
          } while (uVar6 < *(uint *)(this + 0xd1c));
          pIVar7 = *(IOGraphicsAccelerator2 **)pIVar1;
        }
        if (pIVar1 == pIVar7) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: Failed to Create IODMACommandPool\n",
                            "bool IOGraphicsAccelerator2::createDMACommandPool()");
        }
        uVar6 = CONCAT71((int7)((ulong)this >> 8),pIVar1 != pIVar7);
      }
    }
  }
  return uVar6 & 0xffffffff;
}



// IOGraphicsAccelerator2::initGlobalCommPage()

void __thiscall IOGraphicsAccelerator2::initGlobalCommPage(IOGraphicsAccelerator2 *this)

{
  char cVar1;
  undefined4 uVar2;
  long *plVar3;
  undefined8 uVar4;
  
  cVar1 = _OSCompareAndSwapPtr(0,1,&__global_comm_page_memory_descriptor);
  if (cVar1 == '\0') {
    while (__global_comm_page_memory_descriptor == (long *)((long)&MACH_HEADER.magic + 1)) {
      _thread_block(0);
    }
  }
  else {
    __global_comm_page_memory_descriptor = (long *)IOSurfaceRoot::getGraphicsCommPageDescriptor();
  }
  uVar2 = 0;
  plVar3 = (long *)(**(code **)(*__global_comm_page_memory_descriptor + 0x200))
                             (__global_comm_page_memory_descriptor,0);
  *(long **)(this + 0x9a8) = plVar3;
  if (plVar3 == (long *)0x0) {
    *(undefined8 *)(this + 0x9b0) = 0;
  }
  else {
    uVar4 = (**(code **)(*plVar3 + 0x118))(plVar3);
    *(undefined8 *)(this + 0x9b0) = uVar4;
    uVar2 = (**(code **)(*__global_comm_page_memory_descriptor + 0x2d8))();
  }
  *(undefined4 *)(this + 0x9b8) = uVar2;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// IOGraphicsAccelerator2::oneTimeSetup()

void IOGraphicsAccelerator2::oneTimeSetup(void)

{
  kd_callback_t callback;
  char cVar1;
  int iVar2;
  char local_20 [8];
  long local_18;
  
  local_18 = *(long *)PTR____stack_chk_guard_0006b0b0;
  cVar1 = _OSCompareAndSwap(0,1,&___ktrace_enable_callback_registered);
  if (cVar1 != '\0') {
    ___lastSubmissionTimeSymbol = OSSymbol::withCString("lastSubmittedTime");
    ___accumulatedGPUTimeSymbol = OSSymbol::withCString("accumulatedGPUTime");
    ____ktrace_enable_filter = 0;
    _DAT_00082628 = 0;
    _DAT_00082630 = 0;
    _DAT_00082638 = 0;
    local_20 = (char  [8])&DAT_aaaaaaaaaaaaaaaa;
    _strlcpy(local_20,"IOAcceleratorFamily",8);
    callback.iop_name[0] = local_20[0];
    callback.iop_name[1] = local_20[1];
    callback.iop_name[2] = local_20[2];
    callback.iop_name[3] = local_20[3];
    callback.iop_name[4] = local_20[4];
    callback.iop_name[5] = local_20[5];
    callback.iop_name[6] = local_20[6];
    callback.iop_name[7] = local_20[7];
    callback.func = IOAcceleratorKDCallback;
    callback.context = (void *)0x0;
    iVar2 = _kernel_debug_register_callback(callback);
    if (iVar2 == 0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "Failed to create the ktrace callback\n");
    }
  }
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_18) {
    return;
  }
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOGraphicsAccelerator2::garbage_collector(IOInterruptEventSource*, int)

void __cdecl IOGraphicsAccelerator2::garbage_collector(IOGraphicsAccelerator2 *param_1)

{
  int iVar1;
  
  _OSIncrementAtomic(param_1 + 0x90);
  _IOLockLock(*(undefined8 *)(param_1 + 0x88));
  _OSDecrementAtomic(param_1 + 0x90);
  _OSIncrementAtomic(param_1 + 0x158);
  (**(code **)(*(long *)param_1 + 0x850))(param_1,"",0);
  if (((byte)param_1[0xc78] & 2) != 0) {
    free_orphaned_gputasks(param_1);
    iVar1 = IOAccelTaskList::getCount((IOAccelTaskList *)(param_1 + 0xc58));
    if (((iVar1 != 0) && (*(int *)(param_1 + 0xe0) == 0)) && (((byte)param_1[0xc78] & 0x10) == 0)) {
      *(undefined4 *)(param_1 + 0xe0) = 1;
      (**(code **)(**(long **)(param_1 + 0xf8) + 0x1d0))(*(long **)(param_1 + 0xf8),100);
    }
  }
  (**(code **)(*(long *)param_1 + 0x858))(param_1,"",0);
  unlock_busy(param_1);
  _IOLockUnlock(*(undefined8 *)(param_1 + 0x88));
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOGraphicsAccelerator2::garbage_collector_timer(IOTimerEventSource*)

void __cdecl IOGraphicsAccelerator2::garbage_collector_timer(long param_1)

{
  *(undefined4 *)(param_1 + 0xe0) = 0;
                    // WARNING: Could not recover jumptable at 0x0003d75c. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(param_1 + 0x100) + 0x1d8))(*(long **)(param_1 + 0x100),0,0,0);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOGraphicsAccelerator2::gart_collector(IOInterruptEventSource*, int)

void __cdecl IOGraphicsAccelerator2::gart_collector(IOGraphicsAccelerator2 *param_1)

{
  uint uVar1;
  uintptr_t arg1;
  undefined8 extraout_RDX;
  char *arg1_00;
  int local_1c;
  
  _IOLockLock(*(undefined8 *)(param_1 + 0x88));
  _OSIncrementAtomic(param_1 + 0x158);
  arg1_00 = "";
  (**(code **)(*(long *)param_1 + 0x850))(param_1,"",0);
  update_gart_collector_age(param_1);
  if (((byte)param_1[0xc78] & 8) == 0) {
    if (___ktrace_kernel_enabled != 0) {
      arg1_00 = (char *)IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x85120021,(uintptr_t)arg1_00,0,0,0,0);
    }
    if (*(int *)(param_1 + 0xe0) != 0) {
      *(undefined4 *)(param_1 + 0xe0) = 0;
      (**(code **)(**(long **)(param_1 + 0xf8) + 0x218))();
      free_orphaned_gputasks(param_1);
      IOAccelOrphanedMemoryPool::pruneNonReusableOrphanedMemory
                ((IOAccelOrphanedMemoryPool *)(param_1 + 0xb60),arg1_00,extraout_RDX);
    }
    if (((byte)param_1[0xc92] & 0x20) != 0) {
      local_1c = -0x55555556;
      _mach_vm_pressure_level_monitor(0,&local_1c);
      if (local_1c == 3) {
        uVar1 = IOAccelResidentMemorySet::getEarliestExpiredLRUSeed
                          (*(IOAccelResidentMemorySet **)(param_1 + 0xa08));
        try_unload_dirty_resources(param_1,uVar1);
      }
    }
    if (*(ulong *)(param_1 + 0x338) < *(ulong *)(param_1 + 0x350)) {
      (**(code **)(*(long *)param_1 + 0x970))(param_1);
    }
    (**(code **)(**(long **)(param_1 + 0x380) + 0x230))();
    if ((*(int *)(param_1 + 0xdc) != 0) && (*(int *)(param_1 + 0xd8) == 0)) {
      *(undefined8 *)(param_1 + 0xd8) = 1;
      (**(code **)(**(long **)(param_1 + 0x108) + 0x1d0))
                (*(long **)(param_1 + 0x108),*(undefined4 *)(param_1 + 0xb8));
    }
    if (___ktrace_kernel_enabled != 0) {
      arg1 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x85120022,arg1,0,0,0,0);
    }
    (**(code **)(*(long *)param_1 + 0x858))(param_1,"",0);
    unlock_busy(param_1);
    _IOLockUnlock(*(undefined8 *)(param_1 + 0x88));
    return;
  }
  (**(code **)(*(long *)param_1 + 0x858))(param_1,"",0);
  unlock_busy(param_1);
  _IOLockUnlock(*(undefined8 *)(param_1 + 0x88));
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOGraphicsAccelerator2::gart_collector_timer(IOTimerEventSource*)

void __cdecl IOGraphicsAccelerator2::gart_collector_timer(long param_1)

{
  *(undefined4 *)(param_1 + 0xd8) = 0;
                    // WARNING: Could not recover jumptable at 0x0003d958. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(param_1 + 0x110) + 0x1d8))(*(long **)(param_1 + 0x110),0,0,0);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOGraphicsAccelerator2::reusable_orphaned_memory_pool_collector(IOInterruptEventSource*, int)

void __cdecl
IOGraphicsAccelerator2::reusable_orphaned_memory_pool_collector(IOGraphicsAccelerator2 *param_1)

{
  undefined8 extraout_RDX;
  char *pcVar1;
  
  _OSIncrementAtomic(param_1 + 0x90);
  _IOLockLock(*(undefined8 *)(param_1 + 0x88));
  _OSDecrementAtomic(param_1 + 0x90);
  _OSIncrementAtomic(param_1 + 0x158);
  pcVar1 = "";
  (**(code **)(*(long *)param_1 + 0x850))(param_1,"",0);
  if (((byte)param_1[0xc78] & 2) != 0) {
    update_gart_collector_age(param_1);
    IOAccelOrphanedMemoryPool::pruneReusableOrphanedMemory
              ((IOAccelOrphanedMemoryPool *)(param_1 + 0xb60),pcVar1,extraout_RDX);
    if (((*(int *)(param_1 + 0xba0) != 0) && (*(int *)(param_1 + 0xec) == 0)) &&
       (((byte)param_1[0xc78] & 0x10) == 0)) {
      *(undefined4 *)(param_1 + 0xec) = 1;
      (**(code **)(**(long **)(param_1 + 0x130) + 0x1d0))(*(long **)(param_1 + 0x130),60000);
    }
  }
  (**(code **)(*(long *)param_1 + 0x858))(param_1,"",0);
  unlock_busy(param_1);
  _IOLockUnlock(*(undefined8 *)(param_1 + 0x88));
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOGraphicsAccelerator2::reusable_orphaned_memory_pool_timer(IOTimerEventSource*)

void __cdecl IOGraphicsAccelerator2::reusable_orphaned_memory_pool_timer(long param_1)

{
  *(undefined4 *)(param_1 + 0xec) = 0;
                    // WARNING: Could not recover jumptable at 0x0003da52. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(param_1 + 0x138) + 0x1d8))(*(long **)(param_1 + 0x138),0,0,0);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOGraphicsAccelerator2::nonreusable_orphaned_memory_pool_collector(IOInterruptEventSource*, int)

void __cdecl
IOGraphicsAccelerator2::nonreusable_orphaned_memory_pool_collector(IOGraphicsAccelerator2 *param_1)

{
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  char *pcVar1;
  
  _OSIncrementAtomic(param_1 + 0x90);
  _IOLockLock(*(undefined8 *)(param_1 + 0x88));
  _OSDecrementAtomic(param_1 + 0x90);
  _OSIncrementAtomic(param_1 + 0x158);
  pcVar1 = "";
  (**(code **)(*(long *)param_1 + 0x850))(param_1,"",0);
  IOAccelOrphanedMemoryPool::pruneNonReusableOrphanedMemory
            ((IOAccelOrphanedMemoryPool *)(param_1 + 0xb60),pcVar1,extraout_RDX);
  IOAccelOrphanedMemoryPool::pruneNonReusableOrphanedMemory
            ((IOAccelOrphanedMemoryPool *)(param_1 + 0xbc8),pcVar1,extraout_RDX_00);
  if (((*(int *)(param_1 + 0xba4) + *(int *)(param_1 + 0xc0c) != 0) &&
      (*(int *)(param_1 + 0x9d8) == 0)) && (((byte)param_1[0xc78] & 8) == 0)) {
    *(undefined4 *)(param_1 + 0x9d8) = 1;
    (**(code **)(**(long **)(param_1 + 0x9c8) + 0x1d0))(*(long **)(param_1 + 0x9c8),0x32);
  }
  (**(code **)(*(long *)param_1 + 0x858))(param_1,"",0);
  unlock_busy(param_1);
  _IOLockUnlock(*(undefined8 *)(param_1 + 0x88));
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOGraphicsAccelerator2::nonreusable_orphaned_memory_pool_timer(IOTimerEventSource*)

void __cdecl IOGraphicsAccelerator2::nonreusable_orphaned_memory_pool_timer(long param_1)

{
  *(undefined4 *)(param_1 + 0x9d8) = 0;
                    // WARNING: Could not recover jumptable at 0x0003db4c. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(param_1 + 0x9d0) + 0x1d8))(*(long **)(param_1 + 0x9d0),0,0,0);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOGraphicsAccelerator2::finalize_interrupt(IOInterruptEventSource*, int)

void __cdecl IOGraphicsAccelerator2::finalize_interrupt(IOGraphicsAccelerator2 *param_1)

{
  undefined *puVar1;
  int iVar2;
  ulong in_RAX;
  undefined8 uVar3;
  undefined8 uStack_28;
  
  uStack_28 = in_RAX;
  iVar2 = _OSIncrementAtomic(param_1 + 0xdd0);
  if (iVar2 == 0) {
    IOSurfaceRoot::terminateDeviceCachesWithAccelerator(*(void **)(param_1 + 0x170));
    _OSIncrementAtomic(param_1 + 0x90);
    _IOLockLock(*(undefined8 *)(param_1 + 0x88));
    _OSDecrementAtomic(param_1 + 0x90);
    _OSIncrementAtomic(param_1 + 0x158);
    (**(code **)(*(long *)param_1 + 0x850))(param_1,"",0);
    (**(code **)(*(long *)param_1 + 0x9a0))(param_1);
    _IOLockWakeup_darwin14(*(undefined8 *)(param_1 + 0x88),param_1,0);
    (**(code **)(*(long *)param_1 + 0x858))(param_1,"",0);
    unlock_busy(param_1);
    _IOLockUnlock(*(undefined8 *)(param_1 + 0x88));
    puVar1 = PTR_vtable_0006b090;
    if (*(int *)(param_1 + 0xdc8) == 0) {
                    // WARNING: Could not recover jumptable at 0x0003dc5e. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(PTR_vtable_0006b090 + 0x618))(param_1,0);
      return;
    }
    uStack_28 = uStack_28 & 0xffffffffffffff;
    uVar3 = (**(code **)(*(long *)param_1 + 0x680))(param_1);
    (**(code **)(puVar1 + 0x418))(param_1,uVar3,0,(long)&uStack_28 + 7);
  }
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOGraphicsAccelerator2::fence_collector(IOInterruptEventSource*, int)

void __cdecl IOGraphicsAccelerator2::fence_collector(IOGraphicsAccelerator2 *param_1)

{
  _OSIncrementAtomic(param_1 + 0x90);
  _IOLockLock(*(undefined8 *)(param_1 + 0x88));
  _OSDecrementAtomic(param_1 + 0x90);
  _OSIncrementAtomic(param_1 + 0x158);
  (**(code **)(*(long *)param_1 + 0x850))(param_1,"",0);
  collectBlockFences(param_1);
  (**(code **)(*(long *)param_1 + 0x858))(param_1,"",0);
  unlock_busy(param_1);
  _IOLockUnlock(*(undefined8 *)(param_1 + 0x88));
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOGraphicsAccelerator2::memory_pool_interrupt(IOInterruptEventSource*, int)

void __cdecl IOGraphicsAccelerator2::memory_pool_interrupt(IOGraphicsAccelerator2 *param_1)

{
  bool bVar1;
  
  _IOLockLock(*(undefined8 *)(param_1 + 0x88));
  _OSIncrementAtomic(param_1 + 0x158);
  (**(code **)(*(long *)param_1 + 0x850))(param_1,"",0);
  IOAccelBufferMemoryDescriptorPool2::fillWiredBuckets
            (*(IOAccelBufferMemoryDescriptorPool2 **)(param_1 + 0xc30),4);
  bVar1 = IOAccelBufferMemoryDescriptorPool2::anyWiredBucketsBelowLowWaterMark
                    (*(IOAccelBufferMemoryDescriptorPool2 **)(param_1 + 0xc30));
  if (bVar1) {
    kickMemoryPoolTimer(param_1);
  }
  (**(code **)(*(long *)param_1 + 0x858))(param_1,"",0);
  unlock_busy(param_1);
  _IOLockUnlock(*(undefined8 *)(param_1 + 0x88));
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOGraphicsAccelerator2::memory_pool_timer(IOTimerEventSource*)

void __cdecl IOGraphicsAccelerator2::memory_pool_timer(long param_1)

{
  *(undefined4 *)(param_1 + 0xe8) = 0;
                    // WARNING: Could not recover jumptable at 0x0003dd9a. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(param_1 + 0x120) + 0x1d8))(*(long **)(param_1 + 0x120),0,0,0);
  return;
}



// IOGraphicsAccelerator2::send_agc_status_message()

void __thiscall IOGraphicsAccelerator2::send_agc_status_message(IOGraphicsAccelerator2 *this)

{
                    // WARNING: Could not recover jumptable at 0x0003ddb4. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x730))(this,0xe3ff8005,0,0);
  return;
}



// IOGraphicsAccelerator2::display_post_transaction_interrupt()

void __thiscall
IOGraphicsAccelerator2::display_post_transaction_interrupt(IOGraphicsAccelerator2 *this)

{
  IOAccelDisplayMachine *this_00;
  undefined8 local_30;
  undefined8 *local_28;
  
  local_30 = 0;
  local_28 = &local_30;
  _OSIncrementAtomic(this + 0x90);
  _IOLockLock(*(undefined8 *)(this + 0x88));
  _OSDecrementAtomic(this + 0x90);
  _OSIncrementAtomic(this + 0x158);
  (**(code **)(*(long *)this + 0x850))(this,"",0);
  this_00 = *(IOAccelDisplayMachine **)(this + 0x378);
  IOAccelDisplayMachine::get_finished_transactions(this_00,&local_30);
  accel_transaction_finished(this_00,&local_30);
  (**(code **)(*(long *)this + 0x858))(this,"",0);
  unlock_busy(this);
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  return;
}



// IOGraphicsAccelerator2::stop(IOService*)

void __thiscall IOGraphicsAccelerator2::stop(IOGraphicsAccelerator2 *this,undefined8 param_1)

{
  IOAccelKernelMappedMemory *pIVar1;
  long *plVar2;
  IOAccelKernelMappedMemory *this_00;
  long *plVar3;
  long lVar4;
  
  if (*(long *)(this + 0x88) != 0) {
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    (**(code **)(*(long *)this + 0x850))(this,"",0);
  }
  if (*(long **)(this + 0x380) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x380) + 0x158))();
    (**(code **)(**(long **)(this + 0x380) + 0x268))();
  }
  if (*(long **)(this + 0x378) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x378) + 0x860))();
    (**(code **)(**(long **)(this + 0x378) + 0x28))();
    *(undefined8 *)(this + 0x378) = 0;
  }
  lVar4 = 0x3a8;
  do {
    if (*(long **)(this + lVar4 + -8) != (long *)0x0) {
      (**(code **)(**(long **)(this + lVar4 + -8) + 0x28))();
      *(undefined8 *)(this + lVar4 + -8) = 0;
    }
    if (*(long **)(this + lVar4) != (long *)0x0) {
      (**(code **)(**(long **)(this + lVar4) + 0x28))();
      *(undefined8 *)(this + lVar4) = 0;
    }
    lVar4 = lVar4 + 0x18;
  } while (lVar4 != 0x9a8);
  if (*(long *)(this + 0x88) != 0) {
    (**(code **)(*(long *)this + 0x858))(this,"",0);
    unlock_busy(this);
    _IOLockUnlock(*(undefined8 *)(this + 0x88));
  }
  if (*(_func_int **)(this + 0xf0) != (_func_int *)0x0) {
    IOWorkLoop::runActionBlock(*(_func_int **)(this + 0xf0));
  }
  if (*(long *)(this + 0x88) != 0) {
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    (**(code **)(*(long *)this + 0x850))(this,"",0);
  }
  if (*(IOAccelFenceMachine **)(this + 0x390) != (IOAccelFenceMachine *)0x0) {
    IOAccelFenceMachine::notify_fences(*(IOAccelFenceMachine **)(this + 0x390));
    collectBlockFences(this);
    (**(code **)(**(long **)(this + 0x390) + 0x28))();
    *(undefined8 *)(this + 0x390) = 0;
  }
  (**(code **)(*(long *)(this + 0xb60) + 8))(this + 0xb60);
  (**(code **)(*(long *)(this + 0xbc8) + 8))(this + 0xbc8);
  if (*(long **)(this + 0xc80) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xc80) + 0x28))();
    *(undefined8 *)(this + 0xc80) = 0;
  }
  if (*(long **)(this + 0x9a8) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x9a8) + 0x28))();
    *(undefined8 *)(this + 0x9a8) = 0;
  }
  if (*(long **)(this + 0xc30) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xc30) + 0x28))();
    *(undefined8 *)(this + 0xc30) = 0;
  }
  pIVar1 = *(IOAccelKernelMappedMemory **)(this + 0x9e8);
  while (this_00 = pIVar1, this_00 != (IOAccelKernelMappedMemory *)0x0) {
    pIVar1 = *(IOAccelKernelMappedMemory **)(this_00 + 0x10);
    if (*(int *)(this_00 + 0x38) == 0) {
      IOAccelKernelMappedMemory::unmap(this_00);
    }
  }
  if (*(long *)(this + 0x88) != 0) {
    (**(code **)(*(long *)this + 0x858))(this,"",0);
    unlock_busy(this);
    _IOLockUnlock(*(undefined8 *)(this + 0x88));
  }
  if (*(long **)(this + 0x140) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x140) + 0x28))();
    *(undefined8 *)(this + 0x140) = 0;
  }
  if (*(long **)(this + 0x148) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x148) + 0x28))();
    *(undefined8 *)(this + 0x148) = 0;
  }
  if (*(long **)(this + 0xf0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xf0) + 0x28))();
    *(undefined8 *)(this + 0xf0) = 0;
  }
  plVar3 = *(long **)(this + 0x180);
  if (plVar3 != (long *)0x0) {
    plVar2 = *(long **)(this + 0x188);
    if (plVar2 != (long *)0x0) {
      (**(code **)(*plVar2 + 0x28))(plVar2);
      *(undefined8 *)(this + 0x188) = 0;
      plVar3 = *(long **)(this + 0x180);
    }
    *(undefined8 *)(this + 400) = 0;
    (**(code **)(*plVar3 + 0x28))();
    *(undefined8 *)(this + 0x180) = 0;
  }
  lVar4 = *(long *)(this + 0xa8);
  if (lVar4 != 0) {
    *(undefined8 *)(this + 0xa8) = 0;
    _IOFreeData(lVar4,(ulong)*(uint *)(this + 0xb0) << 3);
    *(undefined8 *)(this + 0xa8) = 0;
  }
  lVar4 = *(long *)(this + 0xd98);
  if (lVar4 != 0) {
    *(undefined8 *)(this + 0xd98) = 0;
    _IOFreeData(lVar4,0x30);
    *(undefined8 *)(this + 0xd98) = 0;
  }
  if (((byte)this[0xcec] & 0x40) != 0) {
    releaseDMACommandPool(this);
  }
  if (*(long **)(this + 0x150) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x150) + 0x28))();
    *(undefined8 *)(this + 0x150) = 0;
  }
  if (*(long **)(this + 0xd90) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xd90) + 0x28))();
    *(undefined8 *)(this + 0xd90) = 0;
  }
  (**(code **)(*(long *)this + 0x9c8))(this,*(undefined8 *)(this + 0x368));
  IOService::requireMaxInterruptDelay((uint)this);
  *(undefined8 *)(this + 0x368) = 0;
  (**(code **)(PTR_vtable_0006b090 + 0x5d8))(this,param_1);
  return;
}



undefined8 ____ZN22IOGraphicsAccelerator24stopEP9IOService_block_invoke(long param_1)

{
  long lVar1;
  
  lVar1 = *(long *)(param_1 + 0x20);
  if (*(long **)(lVar1 + 0x9e0) != (long *)0x0) {
    (**(code **)(**(long **)(lVar1 + 0x9e0) + 0x158))();
    (**(code **)(**(long **)(lVar1 + 0xf0) + 0x148))
              (*(long **)(lVar1 + 0xf0),*(undefined8 *)(lVar1 + 0x9e0));
    (**(code **)(**(long **)(lVar1 + 0x9e0) + 0x28))();
    *(undefined8 *)(lVar1 + 0x9e0) = 0;
  }
  if (*(long **)(lVar1 + 0x128) != (long *)0x0) {
    (**(code **)(**(long **)(lVar1 + 0x128) + 0x158))();
    (**(code **)(**(long **)(lVar1 + 0xf0) + 0x148))
              (*(long **)(lVar1 + 0xf0),*(undefined8 *)(lVar1 + 0x128));
    (**(code **)(**(long **)(lVar1 + 0x128) + 0x28))();
    *(undefined8 *)(lVar1 + 0x128) = 0;
  }
  if (*(long **)(lVar1 + 0x138) != (long *)0x0) {
    (**(code **)(**(long **)(lVar1 + 0x138) + 0x158))();
    (**(code **)(**(long **)(lVar1 + 0xf0) + 0x148))
              (*(long **)(lVar1 + 0xf0),*(undefined8 *)(lVar1 + 0x138));
    (**(code **)(**(long **)(lVar1 + 0x138) + 0x28))();
    *(undefined8 *)(lVar1 + 0x138) = 0;
  }
  if (*(long *)(lVar1 + 0x130) != 0) {
    (**(code **)(**(long **)(lVar1 + 0xf0) + 0x148))();
    (**(code **)(**(long **)(lVar1 + 0x130) + 0x28))();
    *(undefined8 *)(lVar1 + 0x130) = 0;
  }
  if (*(long **)(lVar1 + 0x9d0) != (long *)0x0) {
    (**(code **)(**(long **)(lVar1 + 0x9d0) + 0x158))();
    (**(code **)(**(long **)(lVar1 + 0xf0) + 0x148))
              (*(long **)(lVar1 + 0xf0),*(undefined8 *)(lVar1 + 0x9d0));
    (**(code **)(**(long **)(lVar1 + 0x9d0) + 0x28))();
    *(undefined8 *)(lVar1 + 0x9d0) = 0;
  }
  if (*(long *)(lVar1 + 0x9c8) != 0) {
    (**(code **)(**(long **)(lVar1 + 0xf0) + 0x148))();
    (**(code **)(**(long **)(lVar1 + 0x9c8) + 0x28))();
    *(undefined8 *)(lVar1 + 0x9c8) = 0;
  }
  if (*(long *)(lVar1 + 0x100) != 0) {
    (**(code **)(**(long **)(lVar1 + 0xf0) + 0x148))();
    (**(code **)(**(long **)(lVar1 + 0x100) + 0x28))();
    *(undefined8 *)(lVar1 + 0x100) = 0;
  }
  if (*(long *)(lVar1 + 0xf8) != 0) {
    (**(code **)(**(long **)(lVar1 + 0xf0) + 0x148))();
    (**(code **)(**(long **)(lVar1 + 0xf8) + 0x28))();
    *(undefined8 *)(lVar1 + 0xf8) = 0;
  }
  *(undefined4 *)(lVar1 + 0xdc) = 0;
  if (*(long *)(lVar1 + 0x110) != 0) {
    (**(code **)(**(long **)(lVar1 + 0xf0) + 0x148))();
    (**(code **)(**(long **)(lVar1 + 0x110) + 0x28))();
    *(undefined8 *)(lVar1 + 0x110) = 0;
  }
  if (*(long *)(lVar1 + 0x108) != 0) {
    (**(code **)(**(long **)(lVar1 + 0xf0) + 0x148))();
    (**(code **)(**(long **)(lVar1 + 0x108) + 0x28))();
    *(undefined8 *)(lVar1 + 0x108) = 0;
  }
  *(undefined4 *)(lVar1 + 0xe4) = 0;
  if (*(long *)(lVar1 + 0x120) != 0) {
    (**(code **)(**(long **)(lVar1 + 0xf0) + 0x148))();
    (**(code **)(**(long **)(lVar1 + 0x120) + 0x28))();
    *(undefined8 *)(lVar1 + 0x120) = 0;
  }
  if (*(long *)(lVar1 + 0x118) != 0) {
    (**(code **)(**(long **)(lVar1 + 0xf0) + 0x148))();
    (**(code **)(**(long **)(lVar1 + 0x118) + 0x28))();
    *(undefined8 *)(lVar1 + 0x118) = 0;
  }
  return 0;
}



// IOGraphicsAccelerator2::collectBlockFences()

void __thiscall IOGraphicsAccelerator2::collectBlockFences(IOGraphicsAccelerator2 *this)

{
  long *plVar1;
  long **pplVar2;
  long **pplVar3;
  char *pcVar4;
  long *local_20;
  long **local_18;
  
  local_18 = &local_20;
  local_20 = (long *)0x0;
  IOAccelFenceMachine::getCompletedEventFences
            (*(IOAccelFenceMachine **)(this + 0x390),(long)local_18);
  do {
    if (local_20 == (long *)0x0) {
      return;
    }
    plVar1 = (long *)local_20[0x15];
    if (plVar1 == (long *)0x0) {
      pplVar3 = (long **)local_20[0x16];
      pplVar2 = pplVar3;
      if (*pplVar3 != local_20) {
LAB_0003e60a:
        pcVar4 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_0003e61a:
                    // WARNING: Subroutine does not return
        _panic(pcVar4,local_20,0x146e,"IOGraphicsAccelerator.cpp",0x146e);
      }
    }
    else {
      if ((long *)plVar1[0x16] != local_20 + 0x15) {
        pcVar4 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
        goto LAB_0003e61a;
      }
      if (*(long **)local_20[0x16] != local_20) goto LAB_0003e60a;
      plVar1[0x16] = (long)local_20[0x16];
      pplVar3 = (long **)local_20[0x16];
      pplVar2 = local_18;
    }
    local_18 = pplVar2;
    *pplVar3 = plVar1;
    (**(code **)(*local_20 + 0x28))(local_20);
  } while( true );
}



// IOGraphicsAccelerator2::releaseDMACommandPool()

void __thiscall IOGraphicsAccelerator2::releaseDMACommandPool(IOGraphicsAccelerator2 *this)

{
  IOGraphicsAccelerator2 *pIVar1;
  IOGraphicsAccelerator2 *pIVar2;
  long *plVar3;
  IOGraphicsAccelerator2 *pIVar4;
  
  if (((byte)this[0xcec] & 0x40) != 0) {
    pIVar1 = this + 0xa20;
    pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0xa20);
    while (pIVar1 != pIVar2) {
      plVar3 = *(long **)(this + 0xa28);
      pIVar2 = (IOGraphicsAccelerator2 *)plVar3[3];
      pIVar4 = pIVar2 + 0x10;
      if (pIVar1 == pIVar2) {
        pIVar4 = pIVar1;
      }
      *(IOGraphicsAccelerator2 **)pIVar4 = pIVar1;
      *(IOGraphicsAccelerator2 **)(this + 0xa28) = pIVar2;
      plVar3[2] = 0;
      plVar3[3] = 0;
      (**(code **)(*plVar3 + 0x28))();
      pIVar2 = *(IOGraphicsAccelerator2 **)(this + 0xa20);
    }
    *(undefined4 *)(this + 0xda0) = 0;
    (**(code **)(**(long **)(this + 0xa10) + 0x28))();
    *(undefined8 *)(this + 0xa10) = 0;
    if (*(long *)(this + 0xa18) != 0) {
      _IOLockFree();
      *(undefined8 *)(this + 0xa18) = 0;
    }
  }
  return;
}



// IOGraphicsAccelerator2::free()

void __thiscall IOGraphicsAccelerator2::free(IOGraphicsAccelerator2 *this)

{
  if (*(long **)(this + 0x380) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x380) + 0x28))();
  }
  *(undefined8 *)(this + 0x380) = 0;
  if (*(long **)(this + 0x170) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x170) + 0x28))();
  }
  *(undefined8 *)(this + 0x170) = 0;
  if (*(long *)(this + 0x88) != 0) {
    _IOLockFree();
    *(undefined8 *)(this + 0x88) = 0;
  }
  if (*(long **)(this + 0x370) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x370) + 0x28))();
    *(undefined8 *)(this + 0x370) = 0;
  }
  if (*(long **)(this + 0x388) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x388) + 0x28))();
    *(undefined8 *)(this + 0x388) = 0;
  }
  if (*(IOAccelResidentMemorySet **)(this + 0xa08) != (IOAccelResidentMemorySet *)0x0) {
    IOAccelResidentMemorySet::free(*(IOAccelResidentMemorySet **)(this + 0xa08));
    if (*(long *)(this + 0xa08) != 0) {
      _IOFreeTypeImpl(IOMallocTypeMixin<>::operator_delete);
    }
    *(undefined8 *)(this + 0xa08) = 0;
  }
                    // WARNING: Could not recover jumptable at 0x0003e7bf. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b090 + 0xa0))(this);
  return;
}



// IOGraphicsAccelerator2::requestTerminate(IOService*, unsigned int)

void __thiscall
IOGraphicsAccelerator2::requestTerminate
          (IOGraphicsAccelerator2 *this,undefined8 param_1,undefined4 param_2)

{
  deviceTerminatedUnlocked(this);
                    // WARNING: Could not recover jumptable at 0x0003e7f6. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b090 + 0x408))(this,param_1,param_2);
  return;
}



// IOGraphicsAccelerator2::deviceTerminatedUnlocked()

void __thiscall IOGraphicsAccelerator2::deviceTerminatedUnlocked(IOGraphicsAccelerator2 *this)

{
  int iVar1;
  
  iVar1 = _OSIncrementAtomic(this + 0xdc8);
  if ((iVar1 == 0) && (*(int *)(this + 0xdd0) == 0)) {
    if (*(long **)(this + 0x380) != (long *)0x0) {
      (**(code **)(**(long **)(this + 0x380) + 0x250))();
      (**(code **)(**(long **)(*(long *)(this + 0x390) + 0x30) + 0x1d8))
                (*(long **)(*(long *)(this + 0x390) + 0x30),0,0,0);
    }
    if (*(IOAccelDisplayMachine **)(this + 0x378) != (IOAccelDisplayMachine *)0x0) {
      IOAccelDisplayMachine::device_terminated(*(IOAccelDisplayMachine **)(this + 0x378));
      return;
    }
  }
  return;
}



// IOGraphicsAccelerator2::didTerminate(IOService*, unsigned int, bool*)

void IOGraphicsAccelerator2::didTerminate(void)

{
  undefined1 *in_RCX;
  
  *in_RCX = 1;
                    // WARNING: Could not recover jumptable at 0x0003e87b. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b090 + 0x418))();
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOGraphicsAccelerator2::finalize(unsigned int)

undefined8 __cdecl IOGraphicsAccelerator2::finalize(long param_1)

{
  undefined8 uVar1;
  
  if (*(long *)(param_1 + 0x150) != 0) {
    _OSIncrementAtomic(param_1 + 0xdcc);
    if ((*(int *)(param_1 + 0xdcc) != 0) &&
       (*(int *)(*(long *)(param_1 + 0x378) + 0x170) == *(int *)(*(long *)(param_1 + 0x378) + 0x108)
       )) {
      (**(code **)(**(long **)(param_1 + 0x9e0) + 0x1d8))(*(long **)(param_1 + 0x9e0),0,0,0);
    }
    return 0;
  }
                    // WARNING: Could not recover jumptable at 0x0003e8ee. Too many branches
                    // WARNING: Treating indirect jump as call
  uVar1 = (**(code **)(PTR_vtable_0006b090 + 0x618))(param_1);
  return uVar1;
}



// IOGraphicsAccelerator2::finalize_if_possible()

void __thiscall IOGraphicsAccelerator2::finalize_if_possible(IOGraphicsAccelerator2 *this)

{
  if ((*(int *)(this + 0xdcc) != 0) &&
     (*(int *)(*(long *)(this + 0x378) + 0x170) == *(int *)(*(long *)(this + 0x378) + 0x108))) {
                    // WARNING: Could not recover jumptable at 0x0003e92e. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0x9e0) + 0x1d8))(*(long **)(this + 0x9e0),0,0,0);
    return;
  }
  return;
}



// IOGraphicsAccelerator2::display_pipe_terminated()

void __thiscall IOGraphicsAccelerator2::display_pipe_terminated(IOGraphicsAccelerator2 *this)

{
  if ((*(int *)(this + 0xdcc) != 0) &&
     (*(int *)(*(long *)(this + 0x378) + 0x170) == *(int *)(*(long *)(this + 0x378) + 0x108))) {
                    // WARNING: Could not recover jumptable at 0x0003e96c. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0x9e0) + 0x1d8))(*(long **)(this + 0x9e0),0,0,0);
    return;
  }
  return;
}



// IOGraphicsAccelerator2::terminate(unsigned int)

void IOGraphicsAccelerator2::terminate(void)

{
                    // WARNING: Could not recover jumptable at 0x0003e97c. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b090 + 0x610))();
  return;
}



// IOGraphicsAccelerator2::signalStampsUpdated()

void __thiscall IOGraphicsAccelerator2::signalStampsUpdated(IOGraphicsAccelerator2 *this)

{
                    // WARNING: Could not recover jumptable at 0x0003e9a2. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(*(long *)(this + 0x390) + 0x30) + 0x1d8))
            (*(long **)(*(long *)(this + 0x390) + 0x30),0,0,0);
  return;
}



// IOGraphicsAccelerator2::acceleratorFinalize()

void __thiscall IOGraphicsAccelerator2::acceleratorFinalize(IOGraphicsAccelerator2 *this)

{
  if (((byte)this[0xc92] & 0x20) != 0) {
    unload_dirty_resources(this);
  }
  (**(code **)(*(long *)this + 0x948))(this);
                    // WARNING: Could not recover jumptable at 0x0003e9d6. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x978))(this);
  return;
}



// IOGraphicsAccelerator2::unload_dirty_resources()

void __thiscall IOGraphicsAccelerator2::unload_dirty_resources(IOGraphicsAccelerator2 *this)

{
  long lVar1;
  IOAccelResource2 *pIVar2;
  undefined8 uVar3;
  ulong uVar4;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  
  this[0xc78] = (IOGraphicsAccelerator2)((byte)this[0xc78] | 0x40);
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelSharedList::Iterator::Iterator((Iterator *)&local_50,(undefined8 *)(this + 0xa88));
  lVar1 = IOAccelSharedList::Iterator::getNextShared((Iterator *)&local_50);
  if (lVar1 != 0) {
    do {
      local_48 = &DAT_aaaaaaaaaaaaaaaa;
      local_40 = &DAT_aaaaaaaaaaaaaaaa;
      local_38 = &DAT_aaaaaaaaaaaaaaaa;
      IOAccelResourceList::ReverseIterator::ReverseIterator
                ((ReverseIterator *)&local_48,lVar1 + 0xa0);
      pIVar2 = (IOAccelResource2 *)
               IOAccelResourceList::ReverseIterator::getPrevResource((ReverseIterator *)&local_48);
      while (pIVar2 != (IOAccelResource2 *)0x0) {
        uVar3 = IOAccelResource2::isPurgeable(pIVar2);
        if ((char)uVar3 == '\0') {
          uVar4 = IOAccelResource2::requirePageoff(pIVar2);
          if ((char)uVar4 != '\0') {
            (**(code **)(*(long *)pIVar2 + 0x188))(pIVar2);
          }
        }
        else {
          IOAccelResource2::setPurgeable(pIVar2,1,4,(uint *)0x0);
        }
        pIVar2 = (IOAccelResource2 *)
                 IOAccelResourceList::ReverseIterator::getPrevResource((ReverseIterator *)&local_48)
        ;
      }
      lVar1 = IOAccelSharedList::Iterator::getNextShared((Iterator *)&local_50);
    } while (lVar1 != 0);
  }
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelResourceList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_48,(long)(this + 0xb00));
  pIVar2 = (IOAccelResource2 *)
           IOAccelResourceList::ReverseIterator::getPrevResource((ReverseIterator *)&local_48);
  if (pIVar2 != (IOAccelResource2 *)0x0) {
    do {
      uVar3 = IOAccelResource2::isPurgeable(pIVar2);
      if ((char)uVar3 == '\0') {
        uVar4 = IOAccelResource2::requirePageoff(pIVar2);
        if ((char)uVar4 != '\0') {
          (**(code **)(*(long *)pIVar2 + 0x188))(pIVar2);
        }
      }
      else {
        IOAccelResource2::setPurgeable(pIVar2,1,4,(uint *)0x0);
      }
      pIVar2 = (IOAccelResource2 *)
               IOAccelResourceList::ReverseIterator::getPrevResource((ReverseIterator *)&local_48);
    } while (pIVar2 != (IOAccelResource2 *)0x0);
  }
  this[0xc78] = (IOGraphicsAccelerator2)((byte)this[0xc78] & 0xbf);
  return;
}



// IOGraphicsAccelerator2::requestProbe(unsigned int)

undefined8 __thiscall
IOGraphicsAccelerator2::requestProbe(IOGraphicsAccelerator2 *this,ulong param_1)

{
  long *plVar1;
  undefined8 uVar2;
  
  uVar2 = 0xe00002c7;
  if ((param_1 & 1) != 0) {
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    uVar2 = 0;
    (**(code **)(*(long *)this + 0x850))(this,"",0);
    plVar1 = *(long **)(this + 0x378);
    if (plVar1 != (long *)0x0) {
      (**(code **)(*plVar1 + 0x858))(plVar1,*(undefined8 *)(this + 0x368));
    }
    (**(code **)(*(long *)this + 0x858))(this,"",0);
    unlock_busy(this);
    _IOLockUnlock(*(undefined8 *)(this + 0x88));
  }
  return uVar2;
}



// IOGraphicsAccelerator2::reportGPURestart(IOAccelSubmitter2*, char const*, unsigned int, unsigned
// long long)

void __thiscall
IOGraphicsAccelerator2::reportGPURestart
          (IOGraphicsAccelerator2 *this,long *param_1,char *param_2,uint param_3,ulonglong param_4)

{
  int pid;
  char *pcVar1;
  long *plVar2;
  OSString *pOVar3;
  long *plVar4;
  long *plVar5;
  long *plVar6;
  long *plVar7;
  long *plVar8;
  OSObject *pOVar9;
  long *plVar10;
  size_t sVar11;
  long *plVar12;
  long *plVar13;
  long *plVar14;
  IOAccelGPURestartReport2 *this_00;
  uint uVar15;
  byte bVar16;
  long *local_140;
  OSObject *local_138;
  long *local_130;
  long *local_128;
  long *local_120;
  long *local_118;
  long *local_110;
  OSString *local_108;
  long *local_100;
  long *local_f8;
  long *local_f0;
  long *local_e8;
  long *local_e0;
  undefined1 *local_d8;
  undefined1 *local_d0;
  undefined4 local_c8;
  char local_b8 [8];
  undefined1 *local_b0;
  undefined1 *local_a8;
  undefined1 *local_a0;
  undefined1 *local_98;
  undefined1 *local_90;
  undefined1 *local_88;
  undefined1 *local_80;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  long local_38;
  
  local_38 = *(long *)PTR____stack_chk_guard_0006b0b0;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_58 = &DAT_aaaaaaaaaaaaaaaa;
  local_60 = &DAT_aaaaaaaaaaaaaaaa;
  local_68 = &DAT_aaaaaaaaaaaaaaaa;
  local_70 = &DAT_aaaaaaaaaaaaaaaa;
  local_78 = &DAT_aaaaaaaaaaaaaaaa;
  local_80 = &DAT_aaaaaaaaaaaaaaaa;
  local_88 = &DAT_aaaaaaaaaaaaaaaa;
  local_90 = &DAT_aaaaaaaaaaaaaaaa;
  local_98 = &DAT_aaaaaaaaaaaaaaaa;
  local_a0 = &DAT_aaaaaaaaaaaaaaaa;
  local_a8 = &DAT_aaaaaaaaaaaaaaaa;
  local_b0 = &DAT_aaaaaaaaaaaaaaaa;
  local_b8[0] = '\0';
  local_b8[1] = -0x56;
  local_b8[2] = -0x56;
  local_b8[3] = -0x56;
  local_b8[4] = -0x56;
  local_b8[5] = -0x56;
  local_b8[6] = -0x56;
  local_b8[7] = -0x56;
  if (param_1 != (long *)0x0) {
    pid = (**(code **)(*param_1 + 0x970))(param_1);
    _proc_name(pid,local_b8,0x80);
  }
  *(int *)(this + 0x9dc) = *(int *)(this + 0x9dc) + 1;
  if (*(long **)(this + 0x370) == (long *)0x0) {
    pcVar1 = "Undefined";
  }
  else {
    pcVar1 = (char *)(**(code **)(**(long **)(this + 0x370) + 0x148))();
  }
  plVar2 = (long *)OSString::withCString(pcVar1);
  pOVar3 = (OSString *)OSString::withCString("Application");
  plVar4 = (long *)OSString::withCString("AppPath");
  plVar5 = (long *)OSString::withCString("Graphics");
  plVar6 = (long *)OSString::withCString("Report");
  plVar7 = (long *)OSString::withCString("Signature");
  plVar8 = (long *)OSString::withCString("GPUSubmissionTraceID");
  pOVar9 = (OSObject *)OSString::withCString(local_b8);
  plVar10 = (long *)"";
  if (param_1 != (long *)0x0) {
    plVar10 = param_1 + 0x1b;
  }
  plVar10 = (long *)OSString::withCString((char *)plVar10);
  if (param_2 == (char *)0x0) {
LAB_0003ee45:
    local_140 = (long *)OSString::withCString("Vendor failed to provide GPURestartReport");
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Vendor failed to provide GPURestarrReport\n",
                      "void IOGraphicsAccelerator2::reportGPURestart(IOAccelSubmitter2 *, const char *, uint32_t, uint64_t)"
                     );
    bVar16 = ((byte)this[0xc79] & 4) >> 2;
    uVar15 = 0x400;
  }
  else {
    sVar11 = _strlen(param_2);
    if (sVar11 < 0x3ffff) {
      if (sVar11 == 0) goto LAB_0003ee45;
      local_140 = (long *)OSString::withCString(param_2);
    }
    else {
      pcVar1 = (char *)_IOMallocData(0x3ffff);
      if (pcVar1 == (char *)0x0) {
        local_140 = (long *)OSString::withCString
                                      (
                                      "Failed to reallocate/truncate vendor\'s (too-long) GPURestartReport"
                                      );
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Failed to realloc/truncate vendor\'s (too-long) GPURestartReport from %ld to %d\n"
                          ,
                          "void IOGraphicsAccelerator2::reportGPURestart(IOAccelSubmitter2 *, const char *, uint32_t, uint64_t)"
                          ,sVar11,0x3fffe);
      }
      else {
        _strlcpy(pcVar1,param_2,0x3ffff);
        local_140 = (long *)OSString::withCString(pcVar1);
        _IOFreeData(pcVar1,0x3ffff);
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Truncated vendor\'s (too-long) GPURestartReport from %ld to %d\n",
                          "void IOGraphicsAccelerator2::reportGPURestart(IOAccelSubmitter2 *, const char *, uint32_t, uint64_t)"
                          ,sVar11,0x3fffe);
      }
    }
    uVar15 = 0;
    bVar16 = 0;
  }
  *(uint *)(this + 0xc78) = *(uint *)(this + 0xc78) & 0xfffffbff | uVar15;
  local_d8 = &DAT_aaaaaaaaaaaaaaaa;
  local_d0 = &DAT_aaaaaaaaaaaaaaaa;
  local_c8 = 0xaaaaaaaa;
  _snprintf((char *)&local_d8,0x14,"%x",param_3);
  plVar12 = (long *)OSString::withCString((char *)&local_d8);
  _snprintf((char *)&local_d8,0x14,"%llx",param_4);
  plVar13 = (long *)OSString::withCString((char *)&local_d8);
  if (((((pOVar3 == (OSString *)0x0) || (plVar6 == (long *)0x0)) || (plVar4 == (long *)0x0)) ||
      (((plVar5 == (long *)0x0 || (plVar7 == (long *)0x0)) ||
       ((plVar8 == (long *)0x0 || ((pOVar9 == (OSObject *)0x0 || (local_140 == (long *)0x0))))))))
     || ((plVar10 == (long *)0x0 ||
         ((((plVar2 == (long *)0x0 || (plVar12 == (long *)0x0)) || (plVar13 == (long *)0x0)) ||
          (bVar16 != 0)))))) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Can\'t allocate GPURestartReport keys/objects.  Skipping...\n",
                      "void IOGraphicsAccelerator2::reportGPURestart(IOAccelSubmitter2 *, const char *, uint32_t, uint64_t)"
                     );
  }
  else {
    local_120 = local_140;
    local_138 = pOVar9;
    local_130 = plVar10;
    local_128 = plVar2;
    local_118 = plVar12;
    local_110 = plVar13;
    local_108 = pOVar3;
    local_100 = plVar4;
    local_f8 = plVar5;
    local_f0 = plVar6;
    local_e8 = plVar7;
    local_e0 = plVar8;
    plVar14 = (long *)OSDictionary::withObjects(&local_138,&local_108,6,6);
    if (plVar14 == (long *)0x0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Can\'t allocate GPURestartReport dictionary.  Skipping....\n",
                        "void IOGraphicsAccelerator2::reportGPURestart(IOAccelSubmitter2 *, const char *, uint32_t, uint64_t)"
                       );
    }
    else {
      this_00 = IOAccelGPURestartReport2::operator_new
                          ((IOAccelGPURestartReport2 *)&section_00000068.addr);
      IOAccelGPURestartReport2::IOAccelGPURestartReport2(this_00);
      if (this_00 == (IOAccelGPURestartReport2 *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Can\'t allocate GPURestartReport nub.  Skipping...\n",
                          "void IOGraphicsAccelerator2::reportGPURestart(IOAccelSubmitter2 *, const char *, uint32_t, uint64_t)"
                         );
      }
      else {
        (**(code **)(*(long *)this_00 + 0x248))(this_00,plVar14);
        (**(code **)(*(long *)this_00 + 0x3b0))(this_00,"GPURestartReport",0);
        (**(code **)(*(long *)this_00 + 0x670))(this_00,this);
        (**(code **)(*(long *)this_00 + 0x5b0))(this_00,0);
        (**(code **)(*(long *)this_00 + 0x28))(this_00);
      }
      (**(code **)(*plVar14 + 0x28))(plVar14);
    }
  }
  if (pOVar3 != (OSString *)0x0) {
    (**(code **)(*(long *)pOVar3 + 0x28))();
  }
  if (plVar6 != (long *)0x0) {
    (**(code **)(*plVar6 + 0x28))();
  }
  if (plVar4 != (long *)0x0) {
    (**(code **)(*plVar4 + 0x28))();
  }
  if (plVar5 != (long *)0x0) {
    (**(code **)(*plVar5 + 0x28))();
  }
  if (plVar7 != (long *)0x0) {
    (**(code **)(*plVar7 + 0x28))();
  }
  if (plVar8 != (long *)0x0) {
    (**(code **)(*plVar8 + 0x28))();
  }
  if (pOVar9 != (OSObject *)0x0) {
    (**(code **)(*(long *)pOVar9 + 0x28))();
  }
  if (local_140 != (long *)0x0) {
    (**(code **)(*local_140 + 0x28))(local_140);
  }
  if (plVar10 != (long *)0x0) {
    (**(code **)(*plVar10 + 0x28))();
  }
  if (plVar2 != (long *)0x0) {
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  if (plVar12 != (long *)0x0) {
    (**(code **)(*plVar12 + 0x28))(plVar12);
  }
  if (plVar13 != (long *)0x0) {
    (**(code **)(*plVar13 + 0x28))(plVar13);
  }
  if (*(long *)PTR____stack_chk_guard_0006b0b0 != local_38) {
                    // WARNING: Subroutine does not return
    ___stack_chk_fail();
  }
  return;
}



// IOGraphicsAccelerator2::getHardwareWorkLoop() const

undefined8 __thiscall IOGraphicsAccelerator2::getHardwareWorkLoop(IOGraphicsAccelerator2 *this)

{
  return *(undefined8 *)(*(long *)(this + 0x380) + 0x58);
}



// IOGraphicsAccelerator2::newUserClient(task*, void*, unsigned int, IOUserClient**)

undefined8 __thiscall
IOGraphicsAccelerator2::newUserClient
          (IOGraphicsAccelerator2 *this,long param_1,undefined8 param_3_00,int param_3,
          undefined8 *param_4)

{
  char cVar1;
  int pid;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  long lVar7;
  IOAccelContext2 *this_00;
  OSMetaClassBase *pOVar8;
  uint uVar9;
  char *pcVar10;
  undefined1 **ppuVar11;
  undefined8 uVar12;
  byte bVar13;
  undefined1 *local_b8 [16];
  long local_38;
  
  bVar13 = 0;
  local_38 = *(long *)PTR____stack_chk_guard_0006b0b0;
  uVar12 = 0xe00002c2;
  if (param_1 != 0) {
    *param_4 = 0;
    *(undefined4 *)(this + 0x9bc) = 1;
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    (**(code **)(*(long *)this + 0x850))(this,"",0);
    lVar7 = _get_bsdtask_info(param_1);
    if (lVar7 != 0) {
      pid = _proc_pid(lVar7);
      iVar2 = IOAccelContextList::getCountWithPID((IOAccelContextList *)(this + 0xa58),pid);
      iVar3 = IOAccelCommandQueueList::getCountWithPID
                        ((IOAccelCommandQueueList *)(this + 0xa68),pid);
      iVar4 = IOAccelSharedUserClientList::getCountWithPID
                        ((IOAccelSharedUserClientList *)(this + 0xa98),pid);
      iVar5 = IOAccelDeviceList::getCountWithPID((IOAccelDeviceList *)(this + 0xa78),pid);
      uVar9 = iVar2 + iVar3 + iVar4 + iVar5;
      if (*(uint *)(this + 0xcfc) >> 1 < uVar9) {
        iVar2 = IOAccelContextList::getCountWithPID((IOAccelContextList *)(this + 0xa58),pid);
        iVar3 = IOAccelCommandQueueList::getCountWithPID
                          ((IOAccelCommandQueueList *)(this + 0xa68),pid);
        iVar4 = IOAccelSharedUserClientList::getCountWithPID
                          ((IOAccelSharedUserClientList *)(this + 0xa98),pid);
        iVar5 = IOAccelDeviceList::getCountWithPID((IOAccelDeviceList *)(this + 0xa78),pid);
        uVar9 = iVar3 + iVar2 + iVar4 + iVar5;
      }
      if (*(uint *)(this + 0xcf8) < uVar9) {
        pcVar10 = "Unknown";
        ppuVar11 = local_b8;
        for (lVar7 = 0x10; lVar7 != 0; lVar7 = lVar7 + -1) {
          *ppuVar11 = *(undefined1 **)pcVar10;
          pcVar10 = pcVar10 + ((ulong)bVar13 * -2 + 1) * 8;
          ppuVar11 = ppuVar11 + (ulong)bVar13 * -2 + 1;
        }
        _proc_name(pid,local_b8,0x80);
        if ((*(uint *)(this + 0xcfc) < uVar9) && (((byte)this[0xc9c] & 8) != 0)) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: process %s (PID %d) has too many contexts(%d) + queues (%d) + device (%d) + shared (%d), exceeding limit (%d). Failing context creation\n"
                            ,"IOGraphicsAccelerator::newUserClient()",local_b8,pid,iVar2,iVar3,iVar5
                            ,iVar4,*(uint *)(this + 0xcfc));
          (**(code **)(*(long *)this + 0x858))(this,"",0);
          unlock_busy(this);
          _IOLockUnlock(*(undefined8 *)(this + 0x88));
          uVar12 = 0xe0078001;
          goto LAB_0003fa7f;
        }
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: process %s (PID %d) has too many contexts (%d) + queues (%d) + device (%d) + shared (%d) created. Possibly leaking?\n"
                          ,"IOGraphicsAccelerator::newUserClient()",local_b8,pid,iVar2,iVar3,iVar5,
                          iVar4);
      }
    }
    (**(code **)(*(long *)this + 0x858))(this,"",0);
    unlock_busy(this);
    _IOLockUnlock(*(undefined8 *)(this + 0x88));
    switch(param_3) {
    case 0:
      this_00 = (IOAccelContext2 *)(**(code **)(*(long *)this + 0xa30))(this);
      uVar12 = 0xe00002be;
      if (this_00 != (IOAccelContext2 *)0x0) {
        uVar6 = IOAccelSurface::init((IOAccelSurface *)this_00,0,param_1);
        cVar1 = (char)uVar6;
LAB_0003f801:
        uVar12 = 0xe00002be;
        if (cVar1 == '\0') {
          (**(code **)(*(long *)this_00 + 0x28))(this_00);
        }
        else {
          cVar1 = (**(code **)(*(long *)this_00 + 0x670))(this_00,this);
          if (cVar1 != '\0') {
            cVar1 = (**(code **)(*(long *)this_00 + 0x5c0))(this_00,this);
            if (cVar1 == '\0') {
              lVar7 = OSMetaClassBase::safeMetaCast
                                ((OSMetaClassBase *)this_00,
                                 (OSMetaClass *)&IOAccelGLDrawableUserClient::gMetaClass);
              if (lVar7 == 0) {
LAB_0003f8b2:
                lVar7 = OSMetaClassBase::safeMetaCast
                                  ((OSMetaClassBase *)this_00,
                                   (OSMetaClass *)&IOAccelSurfaceMTL::gMetaClass);
                if (lVar7 == 0) {
LAB_0003f8fe:
                  lVar7 = OSMetaClassBase::safeMetaCast
                                    ((OSMetaClassBase *)this_00,
                                     (OSMetaClass *)&IOAccelSurface::gMetaClass);
                  if (lVar7 == 0) {
LAB_0003f94a:
                    lVar7 = OSMetaClassBase::safeMetaCast
                                      ((OSMetaClassBase *)this_00,
                                       (OSMetaClass *)&IOAccel2DContext2::gMetaClass);
                    if (lVar7 == 0) {
                      lVar7 = OSMetaClassBase::safeMetaCast
                                        ((OSMetaClassBase *)this_00,
                                         (OSMetaClass *)&IOAccelDevice2::gMetaClass);
                      if (lVar7 == 0) {
                        lVar7 = OSMetaClassBase::safeMetaCast
                                          ((OSMetaClassBase *)this_00,
                                           (OSMetaClass *)&IOAccelSharedUserClient2::gMetaClass);
                        if (lVar7 == 0) {
LAB_0003fa5f:
                          (**(code **)(*(long *)this_00 + 0x678))(this_00,this);
                          goto LAB_0003fa6f;
                        }
                        local_b8[0] = &DAT_aaaaaaaaaaaaaaaa;
                        IOAccelSharedUserClientList::Iterator::Iterator
                                  ((Iterator *)local_b8,(undefined8 *)(this + 0xa98));
                        do {
                          pOVar8 = (OSMetaClassBase *)
                                   IOAccelSharedUserClientList::Iterator::getNextSharedUserClient
                                             ((Iterator *)local_b8);
                          if (pOVar8 == (OSMetaClassBase *)0x0) goto LAB_0003fa5f;
                        } while (pOVar8 != (OSMetaClassBase *)this_00);
                        newUserClient();
                      }
                      else {
                        local_b8[0] = &DAT_aaaaaaaaaaaaaaaa;
                        IOAccelDeviceList::Iterator::Iterator
                                  ((Iterator *)local_b8,(undefined8 *)(this + 0xa78));
                        do {
                          pOVar8 = (OSMetaClassBase *)
                                   IOAccelDeviceList::Iterator::getNextDevice((Iterator *)local_b8);
                          if (pOVar8 == (OSMetaClassBase *)0x0) goto LAB_0003fa5f;
                        } while (pOVar8 != (OSMetaClassBase *)this_00);
                        newUserClient();
                      }
                    }
                    else {
                      local_b8[0] = &DAT_aaaaaaaaaaaaaaaa;
                      IOAccelContextList::Iterator::Iterator
                                ((Iterator *)local_b8,(undefined8 *)(this + 0xa58));
                      do {
                        pOVar8 = (OSMetaClassBase *)
                                 IOAccelContextList::Iterator::getNextContext((Iterator *)local_b8);
                        if (pOVar8 == (OSMetaClassBase *)0x0) goto LAB_0003fa5f;
                      } while (pOVar8 != (OSMetaClassBase *)this_00);
                      newUserClient();
                    }
                  }
                  else {
                    local_b8[0] = &DAT_aaaaaaaaaaaaaaaa;
                    IOAccelSurfaceList::Iterator::Iterator
                              ((Iterator *)local_b8,(undefined8 *)(this + 0xaa8));
                    do {
                      pOVar8 = (OSMetaClassBase *)
                               IOAccelSurfaceList::Iterator::getNextSurface((Iterator *)local_b8);
                      if (pOVar8 == (OSMetaClassBase *)0x0) goto LAB_0003f94a;
                    } while (pOVar8 != (OSMetaClassBase *)this_00);
                    newUserClient();
                  }
                }
                else {
                  local_b8[0] = &DAT_aaaaaaaaaaaaaaaa;
                  IOAccelSurfaceMTLList::Iterator::Iterator
                            ((Iterator *)local_b8,(undefined8 *)(this + 0xac0));
                  do {
                    pOVar8 = (OSMetaClassBase *)
                             IOAccelSurfaceMTLList::Iterator::getNextSurface((Iterator *)local_b8);
                    if (pOVar8 == (OSMetaClassBase *)0x0) goto LAB_0003f8fe;
                  } while (pOVar8 != (OSMetaClassBase *)this_00);
                  newUserClient();
                }
              }
              else {
                local_b8[0] = &DAT_aaaaaaaaaaaaaaaa;
                IOAccelGLDrawableUserClientList::Iterator::Iterator
                          ((Iterator *)local_b8,(undefined8 *)(this + 0xad8));
                do {
                  pOVar8 = (OSMetaClassBase *)
                           IOAccelGLDrawableUserClientList::Iterator::getNextGLDrawableUserClient
                                     ((Iterator *)local_b8);
                  if (pOVar8 == (OSMetaClassBase *)0x0) goto LAB_0003f8b2;
                } while (pOVar8 != (OSMetaClassBase *)this_00);
                newUserClient();
              }
              if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_38) {
                return 0;
              }
              goto LAB_0003faa4;
            }
            *param_4 = this_00;
            (**(code **)(*(long *)this_00 + 0x20))(this_00);
            goto LAB_0003f845;
          }
LAB_0003fa6f:
          lVar7 = *(long *)this_00;
LAB_0003fa76:
          (**(code **)(lVar7 + 0x28))(this_00);
          uVar12 = 0xe00002c9;
        }
      }
      break;
    case 1:
    case 3:
    case 7:
switchD_0003f528_caseD_1:
      this_00 = (IOAccelContext2 *)(**(code **)(*(long *)this + 0xa58))(this);
      uVar12 = 0xe00002c2;
      if (this_00 != (IOAccelContext2 *)0x0) {
        uVar6 = IOAccelContext2::init(this_00,0,param_1);
        lVar7 = *(long *)this_00;
        if ((char)uVar6 == '\0') {
          (**(code **)(lVar7 + 0x28))(this_00);
          uVar12 = 0xe00002be;
        }
        else {
LAB_0003f6f4:
          cVar1 = (**(code **)(lVar7 + 0x670))(this_00,this);
          if (cVar1 == '\0') {
            lVar7 = *(long *)this_00;
            goto LAB_0003fa76;
          }
          *param_4 = this_00;
LAB_0003f845:
          uVar12 = 0;
        }
      }
      break;
    case 2:
      this_00 = (IOAccelContext2 *)(**(code **)(*(long *)this + 0xa38))(this);
      uVar12 = 0xe00002be;
      if (this_00 != (IOAccelContext2 *)0x0) {
        uVar6 = IOAccelContext2::init(this_00,0,param_1);
        cVar1 = (char)uVar6;
        goto LAB_0003f801;
      }
      break;
    case 4:
      if (this[0xccf] == (IOGraphicsAccelerator2)0x0) {
        uVar12 = 0xe00002c7;
      }
      else {
        this_00 = IOAccelDisplayPipeUserClient2::operator_new
                            ((IOAccelDisplayPipeUserClient2 *)&segment_command_000001a8);
        IOAccelDisplayPipeUserClient2::IOAccelDisplayPipeUserClient2
                  ((IOAccelDisplayPipeUserClient2 *)this_00);
        uVar12 = 0xe00002be;
        if (this_00 != (IOAccelContext2 *)0x0) {
          uVar6 = IOAccelDisplayPipeUserClient2::init
                            ((IOAccelDisplayPipeUserClient2 *)this_00,0,param_1);
          cVar1 = (char)uVar6;
          goto LAB_0003f801;
        }
      }
      break;
    case 5:
      this_00 = (IOAccelContext2 *)(**(code **)(*(long *)this + 0xa18))(this);
      uVar12 = 0xe00002be;
      if (this_00 != (IOAccelContext2 *)0x0) {
        uVar6 = IOAccelDevice2::init((IOAccelDevice2 *)this_00,0,param_1);
        cVar1 = (char)uVar6;
        goto LAB_0003f801;
      }
      break;
    case 6:
      this_00 = (IOAccelContext2 *)(**(code **)(*(long *)this + 0xa10))(this);
      uVar12 = 0xe00002be;
      if (this_00 != (IOAccelContext2 *)0x0) {
        uVar6 = IOAccelSharedUserClient2::init((IOAccelSharedUserClient2 *)this_00,0,param_1);
        cVar1 = (char)uVar6;
        goto LAB_0003f801;
      }
      break;
    case 8:
      this_00 = (IOAccelContext2 *)(**(code **)(*(long *)this + 0xae0))(this);
      uVar12 = 0xe00002be;
      if (this_00 != (IOAccelContext2 *)0x0) {
        uVar6 = IOAccelCommandQueue::init((IOAccelCommandQueue *)this_00,0,param_1);
        lVar7 = *(long *)this_00;
        if ((char)uVar6 != '\0') goto LAB_0003f6f4;
        (**(code **)(lVar7 + 0x28))(this_00);
      }
      break;
    case 9:
      this_00 = IOAccelGLDrawableUserClient::operator_new
                          ((IOAccelGLDrawableUserClient *)&DAT_00000670);
      IOAccelGLDrawableUserClient::IOAccelGLDrawableUserClient
                ((IOAccelGLDrawableUserClient *)this_00);
      uVar12 = 0xe00002be;
      if (this_00 != (IOAccelContext2 *)0x0) {
        uVar6 = IOAccelGLDrawableUserClient::init((IOAccelGLDrawableUserClient *)this_00,0,param_1);
        cVar1 = (char)uVar6;
        goto LAB_0003f801;
      }
      break;
    default:
      if (param_3 == 0x20) {
        this_00 = IOAccelSurfaceMTL::operator_new((IOAccelSurfaceMTL *)section_00000330.segname);
        IOAccelSurfaceMTL::IOAccelSurfaceMTL((IOAccelSurfaceMTL *)this_00);
        uVar12 = 0xe00002be;
        if (this_00 != (IOAccelContext2 *)0x0) {
          uVar6 = IOAccelSurfaceMTL::init((IOAccelSurfaceMTL *)this_00,0,param_1);
          cVar1 = (char)uVar6;
          goto LAB_0003f801;
        }
      }
      else {
        if (param_3 != 0x21) goto switchD_0003f528_caseD_1;
        this_00 = IOAccelMemoryInfoUserClient::operator_new
                            ((IOAccelMemoryInfoUserClient *)&section_000000b8.offset);
        IOAccelMemoryInfoUserClient::IOAccelMemoryInfoUserClient
                  ((IOAccelMemoryInfoUserClient *)this_00);
        uVar12 = 0xe00002be;
        if (this_00 != (IOAccelContext2 *)0x0) {
          cVar1 = (**(code **)(*(long *)this_00 + 0x88))(this_00);
          goto LAB_0003f801;
        }
      }
    }
  }
LAB_0003fa7f:
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_38) {
    return uVar12;
  }
LAB_0003faa4:
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// IOGraphicsAccelerator2::newSurfaceMTL()

IOAccelSurfaceMTL * IOGraphicsAccelerator2::newSurfaceMTL(void)

{
  IOAccelSurfaceMTL *this;
  
  this = IOAccelSurfaceMTL::operator_new((IOAccelSurfaceMTL *)section_00000330.segname);
  IOAccelSurfaceMTL::IOAccelSurfaceMTL(this);
  return this;
}



// IOGraphicsAccelerator2::newGLDrawableClient()

IOAccelGLDrawableUserClient * IOGraphicsAccelerator2::newGLDrawableClient(void)

{
  IOAccelGLDrawableUserClient *this;
  
  this = IOAccelGLDrawableUserClient::operator_new((IOAccelGLDrawableUserClient *)&DAT_00000670);
  IOAccelGLDrawableUserClient::IOAccelGLDrawableUserClient(this);
  return this;
}



// IOGraphicsAccelerator2::newShared()

IOAccelShared2 * IOGraphicsAccelerator2::newShared(void)

{
  IOAccelShared2 *this;
  
  this = IOAccelShared2::operator_new((IOAccelShared2 *)&section_00000108.offset);
  IOAccelShared2::IOAccelShared2(this);
  return this;
}



// IOGraphicsAccelerator2::newSharedUserClient()

IOAccelSharedUserClient2 * IOGraphicsAccelerator2::newSharedUserClient(void)

{
  IOAccelSharedUserClient2 *this;
  
  this = IOAccelSharedUserClient2::operator_new
                   ((IOAccelSharedUserClient2 *)section_00000158.segname);
  IOAccelSharedUserClient2::IOAccelSharedUserClient2(this);
  return this;
}



// IOGraphicsAccelerator2::newDevice()

IOAccelDevice2 * IOGraphicsAccelerator2::newDevice(void)

{
  IOAccelDevice2 *this;
  
  this = IOAccelDevice2::operator_new((IOAccelDevice2 *)&section_00000158.offset);
  IOAccelDevice2::IOAccelDevice2(this);
  return this;
}



// IOGraphicsAccelerator2::newCommandDescriptor()

void IOGraphicsAccelerator2::newCommandDescriptor(void)

{
  undefined8 *puVar1;
  
  puVar1 = ::operator_new(0x50);
  *puVar1 = &PTR_init_0007d500;
  return;
}



// IOGraphicsAccelerator2::newStatistics()

IOAccelStatistics2 * IOGraphicsAccelerator2::newStatistics(void)

{
  IOAccelStatistics2 *this;
  
  this = IOAccelStatistics2::operator_new((IOAccelStatistics2 *)&section_00000068);
  IOAccelStatistics2::IOAccelStatistics2(this);
  return this;
}



// IOGraphicsAccelerator2::newDrawable()

IOAccelDrawable2 * IOGraphicsAccelerator2::newDrawable(void)

{
  IOAccelDrawable2 *this;
  
  this = IOAccelDrawable2::operator_new((IOAccelDrawable2 *)(section_000001f0.segname + 8));
  IOAccelDrawable2::IOAccelDrawable2(this);
  return this;
}



// IOGraphicsAccelerator2::newDisplayPipe()

IOAccelDisplayPipe * IOGraphicsAccelerator2::newDisplayPipe(void)

{
  IOAccelDisplayPipe *this;
  
  this = IOAccelDisplayPipe::operator_new((IOAccelDisplayPipe *)&section_000002e0.reloff);
  IOAccelDisplayPipe::IOAccelDisplayPipe(this);
  return this;
}



// IOGraphicsAccelerator2::createEventMachine()

long * __thiscall IOGraphicsAccelerator2::createEventMachine(IOGraphicsAccelerator2 *this)

{
  char cVar1;
  long *plVar2;
  int iVar3;
  
  plVar2 = (long *)(**(code **)(*(long *)this + 0x888))();
  iVar3 = 1000;
  if (((byte)this[0xc92] & 8) != 0) {
    iVar3 = *(int *)(this + 0xcf0) * 1000;
  }
  if (plVar2 != (long *)0x0) {
    cVar1 = (**(code **)(*plVar2 + 0x118))(plVar2,this,iVar3,*(undefined4 *)(this + 0xca0));
    if (cVar1 != '\0') {
      return plVar2;
    }
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return (long *)0x0;
}



// IOGraphicsAccelerator2::createSysMemory()

long * __thiscall IOGraphicsAccelerator2::createSysMemory(IOGraphicsAccelerator2 *this)

{
  char cVar1;
  long *plVar2;
  
  plVar2 = (long *)(**(code **)(*(long *)this + 0xa60))();
  if (plVar2 != (long *)0x0) {
    cVar1 = (**(code **)(*plVar2 + 0x118))(plVar2,this);
    if (cVar1 != '\0') {
      return plVar2;
    }
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return (long *)0x0;
}



// IOGraphicsAccelerator2::createVidMemory(IOAccelShared2*, IOAccelResource2*, unsigned long long,
// void*)

long * __thiscall
IOGraphicsAccelerator2::createVidMemory
          (IOGraphicsAccelerator2 *this,undefined8 param_1,undefined8 param_2,undefined8 param_3,
          undefined8 param_4)

{
  char cVar1;
  long *plVar2;
  
  plVar2 = (long *)(**(code **)(*(long *)this + 0xa68))();
  if (plVar2 != (long *)0x0) {
    cVar1 = (**(code **)(*plVar2 + 0x1e0))(plVar2,this,param_1,param_2,param_3,param_4);
    if (cVar1 != '\0') {
      return plVar2;
    }
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return (long *)0x0;
}



// IOGraphicsAccelerator2::newRemoteMemory()

IOAccelRemoteMemory * IOGraphicsAccelerator2::newRemoteMemory(void)

{
  IOAccelRemoteMemory *this;
  
  this = IOAccelRemoteMemory::operator_new((IOAccelRemoteMemory *)(section_000000b8.segname + 8));
  IOAccelRemoteMemory::IOAccelRemoteMemory(this);
  return this;
}



// IOGraphicsAccelerator2::createRemoteMemory(IOAccelShared2*, unsigned long long, unsigned int,
// unsigned int)

long * __thiscall
IOGraphicsAccelerator2::createRemoteMemory
          (IOGraphicsAccelerator2 *this,undefined8 param_1,undefined8 param_2,undefined4 param_3,
          undefined4 param_4)

{
  char cVar1;
  long *plVar2;
  
  plVar2 = (long *)(**(code **)(*(long *)this + 0xa98))();
  if (plVar2 != (long *)0x0) {
    cVar1 = (**(code **)(*plVar2 + 0x1e0))(plVar2,this,param_1,param_2,param_3,param_4);
    if (cVar1 != '\0') {
      return plVar2;
    }
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return (long *)0x0;
}



// IOGraphicsAccelerator2::createMemoryMap(IOAccelTask*, IOAccelMemory*, unsigned int)

long * __thiscall
IOGraphicsAccelerator2::createMemoryMap
          (IOGraphicsAccelerator2 *this,undefined8 param_1,undefined8 param_2,undefined4 param_3)

{
  char cVar1;
  long *plVar2;
  
  plVar2 = (long *)(**(code **)(*(long *)this + 0xa88))();
  if (plVar2 != (long *)0x0) {
    cVar1 = (**(code **)(*plVar2 + 0x118))(plVar2,this,param_1,param_2,param_3);
    if (cVar1 != '\0') {
      return plVar2;
    }
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return (long *)0x0;
}



// IOGraphicsAccelerator2::newContext(unsigned int)

undefined8 __thiscall IOGraphicsAccelerator2::newContext(IOGraphicsAccelerator2 *this,int param_1)

{
  undefined8 uVar1;
  
  if (param_1 == 1) {
                    // WARNING: Could not recover jumptable at 0x0003fe49. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (**(code **)(*(long *)this + 0xa20))();
    return uVar1;
  }
  if (param_1 != 7) {
    if (param_1 == 3) {
                    // WARNING: Could not recover jumptable at 0x0003fe3f. Too many branches
                    // WARNING: Treating indirect jump as call
      uVar1 = (**(code **)(*(long *)this + 0xa40))();
      return uVar1;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Unknown contextType 0x%08x\n\n",
                      "virtual IOAccelContext2 *IOGraphicsAccelerator2::newContext(UInt32)");
    return 0;
  }
                    // WARNING: Could not recover jumptable at 0x0003fe53. Too many branches
                    // WARNING: Treating indirect jump as call
  uVar1 = (**(code **)(*(long *)this + 0xa28))();
  return uVar1;
}



// IOGraphicsAccelerator2::newCommandQueue()

IOAccelCommandQueue * IOGraphicsAccelerator2::newCommandQueue(void)

{
  IOAccelCommandQueue *this;
  
  this = IOAccelCommandQueue::operator_new((IOAccelCommandQueue *)&DAT_000006a8);
  IOAccelCommandQueue::IOAccelCommandQueue(this);
  return this;
}



// IOGraphicsAccelerator2::createShared(task*)

long * __thiscall
IOGraphicsAccelerator2::createShared(IOGraphicsAccelerator2 *this,undefined8 param_1)

{
  char cVar1;
  long *plVar2;
  
  plVar2 = (long *)(**(code **)(*(long *)this + 0xa08))();
  if (plVar2 != (long *)0x0) {
    cVar1 = (**(code **)(*plVar2 + 0x118))(plVar2,this,param_1);
    if (cVar1 != '\0') {
      return plVar2;
    }
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return (long *)0x0;
}



// IOGraphicsAccelerator2::createResource(IOAccelShared2*, unsigned int)

long * __thiscall
IOGraphicsAccelerator2::createResource
          (IOGraphicsAccelerator2 *this,undefined8 param_1,undefined4 param_2)

{
  char cVar1;
  long *plVar2;
  
  plVar2 = (long *)(**(code **)(*(long *)this + 0xa70))();
  if (plVar2 != (long *)0x0) {
    cVar1 = (**(code **)(*plVar2 + 0x138))(plVar2,this,param_1,param_2);
    if (cVar1 != '\0') {
      return plVar2;
    }
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return (long *)0x0;
}



// IOGraphicsAccelerator2::newBlockFence()

IOAccelBlockFence * IOGraphicsAccelerator2::newBlockFence(void)

{
  IOAccelBlockFence *this;
  
  this = IOAccelBlockFence::operator_new((IOAccelBlockFence *)&section_000000b8.size);
  IOAccelBlockFence::IOAccelBlockFence(this);
  return this;
}



// IOGraphicsAccelerator2::newContextEventFence()

IOAccelContextEventFence * IOGraphicsAccelerator2::newContextEventFence(void)

{
  IOAccelContextEventFence *this;
  
  this = IOAccelContextEventFence::operator_new
                   ((IOAccelContextEventFence *)section_000000b8.segname);
  IOAccelContextEventFence::IOAccelContextEventFence(this);
  return this;
}



// IOGraphicsAccelerator2::createCommandDescriptor()

undefined8 * __thiscall
IOGraphicsAccelerator2::createCommandDescriptor(IOGraphicsAccelerator2 *this)

{
  undefined8 *puVar1;
  
  puVar1 = (undefined8 *)(**(code **)(*(long *)this + 0xa78))();
  if (puVar1 != (undefined8 *)0x0) {
    (**(code **)*puVar1)(puVar1,this);
  }
  return puVar1;
}



// IOGraphicsAccelerator2::createDrawable(IOAccelSurface*, IOAccelShared2*, bool)

long * __thiscall
IOGraphicsAccelerator2::createDrawable
          (IOGraphicsAccelerator2 *this,undefined8 param_1,undefined8 param_2,undefined1 param_3)

{
  char cVar1;
  long *plVar2;
  
  plVar2 = (long *)(**(code **)(*(long *)this + 0xa50))();
  if (plVar2 != (long *)0x0) {
    cVar1 = (**(code **)(*plVar2 + 0x118))(plVar2,this,param_1,param_2,param_3);
    if (cVar1 != '\0') {
      return plVar2;
    }
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return (long *)0x0;
}



// IOGraphicsAccelerator2::resourceTypeForIOSurface(IOSurface*)

int IOGraphicsAccelerator2::resourceTypeForIOSurface(void)

{
  byte bVar1;
  
  bVar1 = IOSurface::isSysMemOnly();
  return (bVar1 ^ 1 | 2) << 6;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOGraphicsAccelerator2::deviceCacheForIOSurface(IOSurface*, unsigned int)

long * __cdecl
IOGraphicsAccelerator2::deviceCacheForIOSurface(IOGraphicsAccelerator2 *param_1,void *param_2)

{
  char cVar1;
  long *plVar2;
  long *plVar3;
  
  plVar2 = (long *)IOSurface::deviceCacheForAccelerator
                             (param_2,(uint)param_1,*(uint *)(param_1 + 0x178));
  if (plVar2 == (long *)0x0) {
    return (long *)0x0;
  }
  *(undefined1 *)((long)plVar2 + 0x5a) = 1;
  if (plVar2[4] != 0) {
    return plVar2;
  }
  plVar3 = IOAccelResource2::newResourceWithIOSurfaceDeviceCache(param_1,(long)plVar2);
  if (plVar3 == (long *)0x0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to allocate\n",
                      "IOSurfaceDeviceCache *IOGraphicsAccelerator2::deviceCacheForIOSurface(IOSurface *, uint32_t)"
                     );
    plVar3 = plVar2;
  }
  else {
    (**(code **)(*plVar3 + 0x20))(plVar3);
    (**(code **)(*plVar2 + 0x148))(plVar2,plVar3,deviceCacheControl);
    cVar1 = (**(code **)(*plVar3 + 0x140))(plVar3,0,0);
    if (cVar1 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to initialize\n",
                        "IOSurfaceDeviceCache *IOGraphicsAccelerator2::deviceCacheForIOSurface(IOSurface *, uint32_t)"
                       );
    }
    else {
      cVar1 = (**(code **)(*plVar3 + 0x120))(plVar3,0);
      if (cVar1 != '\0') goto LAB_0004016e;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: allocMemory failed\n",
                        "IOSurfaceDeviceCache *IOGraphicsAccelerator2::deviceCacheForIOSurface(IOSurface *, uint32_t)"
                       );
    }
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  plVar2 = (long *)0x0;
LAB_0004016e:
  (**(code **)(*plVar3 + 0x28))(plVar3);
  return plVar2;
}



// IOGraphicsAccelerator2::deviceCacheControl(IOSurfaceDeviceCache*, unsigned int, unsigned long
// long, unsigned long long)

void __thiscall
IOGraphicsAccelerator2::deviceCacheControl
          (IOGraphicsAccelerator2 *this,IOAccelResource2 *param_1,undefined4 param_2,long *param_3,
          undefined1 *param_4)

{
  code *UNRECOVERED_JUMPTABLE;
  undefined8 *puVar1;
  IOAccelResource2 *pIVar2;
  undefined1 uVar3;
  bool bVar4;
  undefined4 uVar5;
  int iVar6;
  ulong uVar7;
  long lVar8;
  IOAccelEventFence *pIVar9;
  undefined8 uVar10;
  undefined1 auVar11 [16];
  
  switch(param_2) {
  case 0:
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    (**(code **)(*(long *)this + 0x850))(this,"",0);
    param_1 = *(IOAccelResource2 **)(param_1 + 0x20);
    (**(code **)(*(long *)param_1 + 0x20))(param_1);
    uVar7 = IOAccelResource2::requirePageoff(param_1);
    if ((char)uVar7 != '\0') {
      uVar5 = acceleratorWaitEnabled(this);
      if ((char)uVar5 == '\0') {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: %s device terminated. pageoff skipped\n",
                          "void IOGraphicsAccelerator2::deviceCacheControl(IOSurfaceDeviceCache *, uint32_t, uint64_t, uint64_t)"
                          ,*(undefined8 *)(this + 0xc88));
      }
      else {
        (**(code **)(*(long *)param_1 + 0x260))(param_1,0x3f,0xffffffff);
      }
    }
    lVar8 = *(long *)param_1;
    goto LAB_000405e4;
  case 2:
    auVar11 = (**(code **)(**(long **)(param_1 + 0x20) + 0x270))();
    if (auVar11._0_8_ != 0) {
      UNRECOVERED_JUMPTABLE = *(code **)(**(long **)(this + 0x380) + 0x178);
                    // WARNING: Could not recover jumptable at 0x00040279. Too many branches
                    // WARNING: Treating indirect jump as call
      (*UNRECOVERED_JUMPTABLE)
                (*(long **)(this + 0x380),auVar11._0_8_,auVar11._8_8_,UNRECOVERED_JUMPTABLE);
      return;
    }
    break;
  case 3:
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    (**(code **)(*(long *)this + 0x850))(this,"",0);
    uVar7 = IOAccelResource2::requirePageoff(*(IOAccelResource2 **)(param_1 + 0x20));
    if ((char)uVar7 != '\0') {
      acceleratorWaitEnabled(this);
    }
    lVar8 = *(long *)param_1;
LAB_000405e4:
    (**(code **)(lVar8 + 0x28))(param_1);
LAB_000405e7:
    lVar8 = *(long *)this;
LAB_000405f4:
    (**(code **)(lVar8 + 0x858))(this,"",0);
    unlock_busy(this);
    _IOLockUnlock(*(undefined8 *)(this + 0x88));
    return;
  case 4:
    pIVar2 = *(IOAccelResource2 **)(param_1 + 0x20);
    uVar7 = IOAccelResource2::requirePageoff(pIVar2);
    if ((((char)uVar7 != '\0') && (((byte)this[0xc78] & 2) != 0)) &&
       (iVar6 = IOSurface::getClientRetainCount(), iVar6 != 0)) {
      (**(code **)(*(long *)pIVar2 + 0x260))(pIVar2,0x3f,0xffffffff);
    }
    lVar8 = (**(code **)(*(long *)pIVar2 + 0x270))(pIVar2);
    if (lVar8 != 0) {
      (**(code **)(**(long **)(this + 0x380) + 0x188))(*(long **)(this + 0x380),lVar8);
    }
    *(undefined8 *)(pIVar2 + 0xe0) = 0;
                    // WARNING: Could not recover jumptable at 0x0004035e. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*(long *)pIVar2 + 0x28))(pIVar2);
    return;
  case 5:
    puVar1 = *(undefined8 **)(*(long *)(param_1 + 0x20) + 0x30);
    *puVar1 = 0;
    puVar1[1] = 0;
    puVar1[2] = 0;
    *(byte *)((long)puVar1 + 0x1c) = *(byte *)((long)puVar1 + 0x1c) & 0xfe;
    break;
  case 6:
    pIVar2 = *(IOAccelResource2 **)(param_1 + 0x20);
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    (**(code **)(*(long *)this + 0x850))(this,"",0);
    if ((param_3 == (long *)0x0) || (acceleratorWaitEnabled(this), ((byte)this[0xc78] & 2) != 0)) {
      uVar10 = IOAccelResource2::unpurge(pIVar2,(uint)(param_3 != (long *)0x0));
      uVar3 = (undefined1)uVar10;
    }
    else {
      uVar3 = 0;
    }
    *param_4 = uVar3;
    goto LAB_000405e7;
  case 7:
    pIVar2 = *(IOAccelResource2 **)(param_1 + 0x20);
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    (**(code **)(*(long *)this + 0x850))(this,"",0);
    IOAccelResource2::setPurgeableIOSurface(pIVar2,(int)param_3);
    lVar8 = *(long *)this;
    goto LAB_000405f4;
  case 8:
    pIVar2 = *(IOAccelResource2 **)(param_1 + 0x20);
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    (**(code **)(*(long *)this + 0x850))(this,"",0);
    bVar4 = IOAccelResource2::testIOSurfacePurgeable(pIVar2);
    *param_4 = bVar4;
    lVar8 = *(long *)this;
    goto LAB_000405f4;
  case 9:
    if (*param_3 == 0) {
      lVar8 = *(long *)(param_1 + 0x20);
      _OSIncrementAtomic(this + 0x90);
      _IOLockLock(*(undefined8 *)(this + 0x88));
      _OSDecrementAtomic(this + 0x90);
      _OSIncrementAtomic(this + 0x158);
      (**(code **)(*(long *)this + 0x850))(this,"",0);
      pIVar9 = IOAccelSharedEventFence::withSharedEvent((long *)param_3[2],param_3[1],(long)this,0);
      if (pIVar9 != (IOAccelEventFence *)0x0) {
        (**(code **)(**(long **)(this + 0x380) + 0x1b0))
                  (*(long **)(this + 0x380),
                   (ulong)*(byte *)(lVar8 + 0x16) * 0x40 + *(long *)(lVar8 + 0x38),pIVar9 + 0x68);
        IOAccelFenceMachine::addEventFence(*(IOAccelFenceMachine **)(this + 0x390),0,(long)pIVar9);
      }
      (**(code **)(*(long *)this + 0x858))(this,"",0);
      unlock_busy(this);
      _IOLockUnlock(*(undefined8 *)(this + 0x88));
      *(undefined4 *)(param_3 + 3) = 0;
    }
  }
  return;
}



// IOGraphicsAccelerator2::createDisplayPipe(IOFramebuffer*, unsigned int)

long * __thiscall
IOGraphicsAccelerator2::createDisplayPipe
          (IOGraphicsAccelerator2 *this,undefined8 param_1,undefined4 param_2)

{
  char cVar1;
  long *plVar2;
  
  plVar2 = (long *)(**(code **)(*(long *)this + 0xa48))();
  if (plVar2 != (long *)0x0) {
    cVar1 = (**(code **)(*plVar2 + 0x850))
                      (plVar2,this,*(undefined8 *)(this + 0x378),param_1,param_2);
    if (cVar1 != '\0') {
      return plVar2;
    }
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return (long *)0x0;
}



// IOGraphicsAccelerator2::newClientSharedRO()

void __thiscall IOGraphicsAccelerator2::newClientSharedRO(IOGraphicsAccelerator2 *this)

{
  _IOMallocData((ulong)*(uint *)(this + 0xce0) + 0x108);
  return;
}



// IOGraphicsAccelerator2::newClientSharedRW()

void __thiscall IOGraphicsAccelerator2::newClientSharedRW(IOGraphicsAccelerator2 *this)

{
  _IOMallocData((ulong)*(uint *)(this + 0xce4) + 0x20);
  return;
}



// IOGraphicsAccelerator2::deleteClientSharedRO(IOAccelClientSharedRO*)

void __thiscall
IOGraphicsAccelerator2::deleteClientSharedRO(IOGraphicsAccelerator2 *this,undefined8 param_1)

{
  _IOFreeData(param_1,(ulong)*(uint *)(this + 0xce0) + 0x108);
  return;
}



// IOGraphicsAccelerator2::deleteClientSharedRW(IOAccelClientSharedRW*)

void __thiscall
IOGraphicsAccelerator2::deleteClientSharedRW(IOGraphicsAccelerator2 *this,undefined8 param_1)

{
  _IOFreeData(param_1,(ulong)*(uint *)(this + 0xce4) + 0x20);
  return;
}



// IOGraphicsAccelerator2::deleteCommandDescriptor(IOAccelCommandDescriptor*)

void __thiscall IOGraphicsAccelerator2::deleteCommandDescriptor(undefined8 param_1_00,void *param_2)

{
  if (param_2 != (void *)0x0) {
    ::operator_delete(param_2);
    return;
  }
  return;
}



// IOGraphicsAccelerator2::createMemoryDescriptorWithAddressRange(unsigned long long, unsigned long
// long, unsigned int, task*)

void __thiscall
IOGraphicsAccelerator2::createMemoryDescriptorWithAddressRange
          (undefined8 param_1_00,ulonglong param_2,ulonglong param_3,uint param_4,task *param_5)

{
  IOMemoryDescriptor::withAddressRange(param_2,param_3,param_4,param_5);
  return;
}



// IOGraphicsAccelerator2::createMemoryDescriptorWithPersistentMemoryDescriptor(IOMemoryDescriptor*)

void __thiscall
IOGraphicsAccelerator2::createMemoryDescriptorWithPersistentMemoryDescriptor
          (undefined8 param_1_00,IOMemoryDescriptor *param_2)

{
  IOMemoryDescriptor::withPersistentMemoryDescriptor(param_2);
  return;
}



// IOGraphicsAccelerator2::createBufferMemoryDescriptorWithOptions(unsigned int, unsigned long,
// unsigned long)

long __thiscall
IOGraphicsAccelerator2::createBufferMemoryDescriptorWithOptions
          (undefined8 param_1_00,uint param_2,ulong param_3,ulong param_4)

{
  long lVar1;
  
  lVar1 = IOBufferMemoryDescriptor::withOptions(param_2,param_3,param_4);
  if (lVar1 != 0) {
    IOMemoryDescriptor::setVMTags((uint)lVar1,0);
  }
  return lVar1;
}



// IOGraphicsAccelerator2::createBufferMemoryDescriptorInTaskWithOptions(task*, unsigned int,
// unsigned long, unsigned long)

void __thiscall
IOGraphicsAccelerator2::createBufferMemoryDescriptorInTaskWithOptions
          (undefined8 param_1_00,task *param_2,uint param_3,ulong param_4,ulong param_5)

{
  IOBufferMemoryDescriptor::inTaskWithOptions(param_2,param_3,param_4,param_5,0,100);
  return;
}



// IOGraphicsAccelerator2::freeToPrepareMapping(IOAccelMemoryMap*)

ulong __thiscall
IOGraphicsAccelerator2::freeToPrepareMapping
          (IOGraphicsAccelerator2 *this,long *param_1,undefined8 param_2)

{
  IOAccelOrphanedMemoryPool *this_00;
  undefined1 *puVar1;
  char cVar2;
  undefined8 uVar3;
  ulong uVar4;
  undefined8 unaff_R15;
  ulong uVar5;
  undefined1 *local_38;
  undefined1 *local_30;
  
  if ((*(byte *)(param_1 + 2) & 0x10) == 0) {
    cVar2 = (**(code **)(*(long *)this + 0x968))(this,param_1,0);
    uVar5 = CONCAT71((int7)((ulong)unaff_R15 >> 8),1);
    if (cVar2 == '\0') {
      cVar2 = (**(code **)(*(long *)this + 0x968))(this,param_1,1);
      if (cVar2 == '\0') {
        (**(code **)(*param_1 + 0x168))(param_1);
        uVar3 = (**(code **)(*param_1 + 0x168))(param_1);
        uVar5 = 0;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: failed to wire down system map %p. needed %lld, used %lld, size %lld bytes.\n"
                          ,"bool IOGraphicsAccelerator2::freeToPrepareMapping(IOAccelMemoryMap *)",
                          param_1,uVar3,*(undefined8 *)(this + 0x350),*(undefined8 *)(this + 0x348))
        ;
      }
    }
  }
  else if (((byte)this[0xc78] & 0x20) == 0) {
    this_00 = (IOAccelOrphanedMemoryPool *)(this + 0xbc8);
    uVar5 = *(ulong *)(this + 0xc20);
    if (uVar5 != 0) {
      IOAccelOrphanedMemoryPool::pruneNonReusableOrphanedMemory(this_00,param_1,param_2);
      uVar5 = uVar5 - *(long *)(this + 0xc20);
      uVar4 = (**(code **)(*param_1 + 0x168))(param_1);
      if (uVar4 < uVar5) {
        cVar2 = (**(code **)(*param_1 + 0x138))(param_1);
        uVar5 = CONCAT71((int7)(uVar5 >> 8),1);
        if (cVar2 != '\0') goto LAB_0004099a;
      }
    }
    cVar2 = (**(code **)(*(long *)this_00 + 0x18))(this_00,param_1,0);
    uVar5 = CONCAT71((int7)(uVar5 >> 8),1);
    if (cVar2 == '\0') {
      cVar2 = (**(code **)(*(long *)this + 0x940))(this,param_1,0,0);
      if (cVar2 == '\0') {
        local_38 = &DAT_aaaaaaaaaaaaaaaa;
        local_30 = &DAT_aaaaaaaaaaaaaaaa;
        _clock_get_uptime();
        cVar2 = (**(code **)(*(long *)this_00 + 0x18))(this_00,param_1,1);
        if (cVar2 == '\0') {
          cVar2 = (**(code **)(*(long *)this + 0x940))(this,param_1,1,0);
          if (cVar2 == '\0') {
            this[0xc78] = (IOGraphicsAccelerator2)((byte)this[0xc78] | 0x20);
            cVar2 = (**(code **)(*(long *)this + 0x940))(this,param_1,1,1);
            this[0xc78] = (IOGraphicsAccelerator2)((byte)this[0xc78] & 0xdf);
            if (cVar2 == '\0') {
              (**(code **)(*param_1 + 0x168))(param_1);
              uVar3 = (**(code **)(*param_1 + 0x168))(param_1);
              uVar5 = 0;
              __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                "%s: failed to wire down video map %p. needed %lld, used %lld, size %lld bytes.\n"
                                ,
                                "bool IOGraphicsAccelerator2::freeToPrepareMapping(IOAccelMemoryMap *)"
                                ,param_1,uVar3,*(undefined8 *)(this + 0x360),
                                *(undefined8 *)(this + 0x358));
              goto LAB_0004099a;
            }
          }
        }
        _clock_get_uptime(&local_38);
        _absolutetime_to_nanoseconds(local_38 + 0x5555555555555556,&local_30);
        puVar1 = local_30;
        IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(this + 0x388) + 0x58),0x2a);
        *(int *)(this + 0x248) = *(int *)(this + 0x248) + (int)puVar1;
      }
    }
  }
  else {
    uVar5 = 0;
  }
LAB_0004099a:
  return uVar5 & 0xffffffff;
}



// IOGraphicsAccelerator2::freeWaitToPrepareSysMap(IOAccelMemoryMap*, bool)

undefined8 __thiscall
IOGraphicsAccelerator2::freeWaitToPrepareSysMap
          (IOGraphicsAccelerator2 *this,long *param_1,char param_2)

{
  int iVar1;
  IOAccelMemory *pIVar2;
  undefined8 uVar3;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  
  local_60 = &DAT_aaaaaaaaaaaaaaaa;
  local_58 = &DAT_aaaaaaaaaaaaaaaa;
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelResidentMemorySet::LRUIterator::LRUIterator
            ((LRUIterator *)&local_60,*(long *)(this + 0xa08));
  pIVar2 = IOAccelResidentMemorySet::LRUIterator::getNextMemory((LRUIterator *)&local_60);
  if (pIVar2 != (IOAccelMemory *)0x0) {
    do {
      iVar1 = IOAccelMemory::getPrepareCount(pIVar2);
      if (iVar1 == 0) {
        if (param_2 == '\0') {
          uVar3 = IOAccelMemory::testAllEvent(pIVar2);
          if ((char)uVar3 == '\0') goto LAB_00040acd;
        }
        else {
          IOAccelMemory::finishAllEvent(pIVar2);
        }
        (**(code **)(*(long *)pIVar2 + 0x1b8))(pIVar2);
        uVar3 = (**(code **)(*param_1 + 0x138))(param_1);
        if ((char)uVar3 != '\0') goto LAB_00040bbe;
      }
      else {
        IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(this + 0x388) + 0x58),0x5f);
        *(int *)(this + 0x31c) = *(int *)(this + 0x31c) + 1;
      }
LAB_00040acd:
      pIVar2 = IOAccelResidentMemorySet::LRUIterator::getNextMemory((LRUIterator *)&local_60);
    } while (pIVar2 != (IOAccelMemory *)0x0);
  }
  IOAccelResidentMemorySet::sort(*(IOAccelResidentMemorySet **)(this + 0xa08));
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelResidentMemorySet::LRUIterator::LRUIterator
            ((LRUIterator *)&local_48,*(long *)(this + 0xa08));
  pIVar2 = IOAccelResidentMemorySet::LRUIterator::getNextMemory((LRUIterator *)&local_48);
  if (pIVar2 != (IOAccelMemory *)0x0) {
    do {
      iVar1 = IOAccelMemory::getPrepareCount(pIVar2);
      if (iVar1 == 0) {
        if (param_2 == '\0') {
          uVar3 = IOAccelMemory::testAllEvent(pIVar2);
          if ((char)uVar3 == '\0') goto LAB_00040b8c;
        }
        else {
          IOAccelMemory::finishAllEvent(pIVar2);
        }
        (**(code **)(*(long *)pIVar2 + 0x1b8))(pIVar2);
        uVar3 = (**(code **)(*param_1 + 0x138))(param_1);
        if ((char)uVar3 != '\0') {
LAB_00040bbe:
          return CONCAT71((int7)((ulong)uVar3 >> 8),1);
        }
      }
      else {
        IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(this + 0x388) + 0x58),0x5f);
        *(int *)(this + 0x31c) = *(int *)(this + 0x31c) + 1;
      }
LAB_00040b8c:
      pIVar2 = IOAccelResidentMemorySet::LRUIterator::getNextMemory((LRUIterator *)&local_48);
    } while (pIVar2 != (IOAccelMemory *)0x0);
  }
  if (param_2 == '\0') {
    uVar3 = 0;
  }
  else {
    *(uint *)(param_1[3] + 0xc) = *(uint *)(param_1[3] + 0xc) | 0x20000;
    uVar3 = (**(code **)(*param_1 + 0x138))(param_1);
  }
  return uVar3;
}



// IOGraphicsAccelerator2::freeWaitToPrepareVidMap(IOAccelMemoryMap*, bool, bool)

undefined8 __thiscall
IOGraphicsAccelerator2::freeWaitToPrepareVidMap
          (IOGraphicsAccelerator2 *this,long *param_1,undefined4 param_2,undefined4 param_3)

{
  bool bVar1;
  char cVar2;
  int iVar3;
  IOAccelMemory *this_00;
  ulong uVar4;
  undefined8 uVar5;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 extraout_RDX_01;
  undefined8 uVar6;
  IOGraphicsAccelerator2 *pIVar7;
  undefined1 *local_40;
  undefined4 local_34;
  
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  pIVar7 = this + 0xb48;
  local_34 = param_2;
  IOAccelVidMemoryList::ReverseIterator::ReverseIterator((ReverseIterator *)&local_40,(long)pIVar7);
  this_00 = (IOAccelMemory *)
            IOAccelVidMemoryList::ReverseIterator::getPrevMemory((ReverseIterator *)&local_40);
  if (this_00 != (IOAccelMemory *)0x0) {
    do {
      iVar3 = IOAccelMemory::getPrepareCount(this_00);
      if (iVar3 == 0) {
        if ((char)param_3 == '\0') {
          uVar4 = IOAccelVidMemory::requirePageoff((IOAccelVidMemory *)this_00);
          if ((char)uVar4 != '\0') goto LAB_00040cba;
        }
        if ((char)local_34 == '\0') {
          uVar5 = IOAccelMemory::testAllEvent(this_00);
          uVar6 = extraout_RDX_01;
          if ((char)uVar5 == '\0') goto LAB_00040cba;
        }
        else {
          bVar1 = IOAccelVidMemory::canDoAsyncPageTableUpdate((IOAccelVidMemory *)this_00);
          uVar6 = extraout_RDX;
          if (!bVar1) {
            IOAccelMemory::finishAllEvent(this_00);
            uVar6 = extraout_RDX_00;
          }
        }
        if (((byte)this_00[0xd] & 4) == 0) {
          (**(code **)(*(long *)this_00 + 0x1b8))(this_00);
        }
        else {
          IOAccelMemory::pruneOrphanedMappings(this_00,pIVar7,uVar6);
        }
        cVar2 = (**(code **)(*param_1 + 0x138))(param_1);
        if (cVar2 != '\0') {
          uVar6 = CONCAT71((uint7)(uint3)((uint)param_3 >> 8),1);
          goto LAB_00040cd0;
        }
      }
      else {
        pIVar7 = (IOGraphicsAccelerator2 *)((long)&segment_command_00000020.initprot + 3);
        IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(this + 0x388) + 0x58),0x5f);
        *(int *)(this + 0x31c) = *(int *)(this + 0x31c) + 1;
      }
LAB_00040cba:
      this_00 = (IOAccelMemory *)
                IOAccelVidMemoryList::ReverseIterator::getPrevMemory((ReverseIterator *)&local_40);
    } while (this_00 != (IOAccelMemory *)0x0);
  }
  uVar6 = 0;
LAB_00040cd0:
  IOAccelVidMemoryList::ReverseIterator::~ReverseIterator((ReverseIterator *)&local_40);
  return uVar6;
}



// IOGraphicsAccelerator2::freeToPrepareMemory(IOAccelMemory*)

ulong __thiscall
IOGraphicsAccelerator2::freeToPrepareMemory(IOGraphicsAccelerator2 *this,OSMetaClassBase *param_1)

{
  IOAccelOrphanedMemoryPool *this_00;
  char cVar1;
  long lVar2;
  undefined8 uVar3;
  long *plVar4;
  ulong uVar5;
  undefined1 *puVar6;
  undefined8 unaff_R15;
  ulong uVar7;
  undefined1 auVar8 [16];
  undefined1 *local_40;
  undefined1 *local_38;
  
  if (((byte)param_1[0xc] & 4) == 0) {
    lVar2 = OSMetaClassBase::safeMetaCast(param_1,(OSMetaClass *)&IOAccelSysMemory::gMetaClass);
    if (lVar2 == 0) {
      uVar7 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: internal error. memory object %p claims to be IOAccelSysMemory but is not.\n"
                        ,"bool IOGraphicsAccelerator2::freeToPrepareMemory(IOAccelMemory *)",param_1
                       );
    }
    else {
      cVar1 = (**(code **)(*(long *)this + 0x960))(this,lVar2,0);
      uVar7 = CONCAT71((int7)((ulong)unaff_R15 >> 8),1);
      if (cVar1 == '\0') {
        cVar1 = (**(code **)(*(long *)this + 0x960))(this,lVar2,1);
        if (cVar1 == '\0') {
          (**(code **)(*(long *)param_1 + 0x120))(param_1);
          uVar3 = (**(code **)(*(long *)param_1 + 0x120))(param_1);
          uVar7 = 0;
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: failed to wire down system memory %p. needed %lld, used %lld, size %lld bytes.\n"
                            ,"bool IOGraphicsAccelerator2::freeToPrepareMemory(IOAccelMemory *)",
                            param_1,uVar3,*(undefined8 *)(this + 0x350),
                            *(undefined8 *)(this + 0x348));
        }
      }
    }
  }
  else if (((byte)this[0xc78] & 0x20) == 0) {
    puVar6 = &IOAccelVidMemory::gMetaClass;
    auVar8 = OSMetaClassBase::safeMetaCast(param_1,(OSMetaClass *)&IOAccelVidMemory::gMetaClass);
    plVar4 = auVar8._0_8_;
    if (plVar4 == (long *)0x0) {
      uVar7 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: internal error. memory object %p claims to be IOAccelVidMemory but is not.\n"
                        ,"bool IOGraphicsAccelerator2::freeToPrepareMemory(IOAccelMemory *)",param_1
                       );
    }
    else {
      this_00 = (IOAccelOrphanedMemoryPool *)(this + 0xbc8);
      uVar7 = *(ulong *)(this + 0xc20);
      if (uVar7 != 0) {
        IOAccelOrphanedMemoryPool::pruneNonReusableOrphanedMemory(this_00,puVar6,auVar8._8_8_);
        uVar7 = uVar7 - *(long *)(this + 0xc20);
        uVar5 = (**(code **)(*plVar4 + 0x120))(plVar4);
        if (uVar5 < uVar7) {
          cVar1 = (**(code **)(*plVar4 + 0x148))(plVar4);
          uVar7 = CONCAT71((int7)(uVar7 >> 8),1);
          if (cVar1 != '\0') goto LAB_00040f98;
        }
      }
      cVar1 = (**(code **)(*(long *)this_00 + 0x20))(this_00,plVar4,0);
      uVar7 = CONCAT71((int7)(uVar7 >> 8),1);
      if (cVar1 == '\0') {
        cVar1 = (**(code **)(*(long *)this + 0x938))(this,plVar4,0,0);
        if (cVar1 == '\0') {
          local_40 = &DAT_aaaaaaaaaaaaaaaa;
          local_38 = &DAT_aaaaaaaaaaaaaaaa;
          _clock_get_uptime();
          cVar1 = (**(code **)(*(long *)this_00 + 0x20))(this_00,plVar4,1);
          if (cVar1 == '\0') {
            cVar1 = (**(code **)(*(long *)this + 0x938))(this,plVar4,1,0);
            if (cVar1 == '\0') {
              this[0xc78] = (IOGraphicsAccelerator2)((byte)this[0xc78] | 0x20);
              cVar1 = (**(code **)(*(long *)this + 0x938))(this,plVar4,1,1);
              this[0xc78] = (IOGraphicsAccelerator2)((byte)this[0xc78] & 0xdf);
              if (cVar1 == '\0') {
                (**(code **)(*(long *)param_1 + 0x120))(param_1);
                uVar3 = (**(code **)(*(long *)param_1 + 0x120))(param_1);
                uVar7 = 0;
                __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                  "%s: failed to wire down video memory %p. needed %lld, used %lld, size %lld bytes.\n"
                                  ,
                                  "bool IOGraphicsAccelerator2::freeToPrepareMemory(IOAccelMemory *)"
                                  ,param_1,uVar3,*(undefined8 *)(this + 0x360),
                                  *(undefined8 *)(this + 0x358));
                goto LAB_00040f98;
              }
            }
          }
          _clock_get_uptime(&local_40);
          _absolutetime_to_nanoseconds(local_40 + 0x5555555555555556,&local_38);
          puVar6 = local_38;
          IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(this + 0x388) + 0x58),0x2a);
          *(int *)(this + 0x248) = *(int *)(this + 0x248) + (int)puVar6;
        }
      }
    }
  }
  else {
    uVar7 = 0;
  }
LAB_00040f98:
  return uVar7 & 0xffffffff;
}



// IOGraphicsAccelerator2::freeWaitToPrepareSysMemory(IOAccelSysMemory*, bool)

undefined8 __thiscall
IOGraphicsAccelerator2::freeWaitToPrepareSysMemory
          (IOGraphicsAccelerator2 *this,long *param_1,undefined4 param_2)

{
  long lVar1;
  int iVar2;
  long lVar3;
  ulong uVar4;
  IOAccelMemory *pIVar5;
  undefined8 uVar6;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined4 local_34;
  
  lVar1 = *(long *)(this + 0x350);
  local_34 = param_2;
  lVar3 = (**(code **)(*param_1 + 0x120))(param_1);
  uVar4 = (**(code **)(*(long *)this + 0x990))(this);
  if (uVar4 < (ulong)(lVar3 + lVar1)) {
    local_68 = &DAT_aaaaaaaaaaaaaaaa;
    local_60 = &DAT_aaaaaaaaaaaaaaaa;
    local_58 = &DAT_aaaaaaaaaaaaaaaa;
    IOAccelResidentMemorySet::LRUIterator::LRUIterator
              ((LRUIterator *)&local_68,*(long *)(this + 0xa08));
    pIVar5 = IOAccelResidentMemorySet::LRUIterator::getNextMemory((LRUIterator *)&local_68);
    if (pIVar5 != (IOAccelMemory *)0x0) {
      do {
        iVar2 = IOAccelMemory::getPrepareCount(pIVar5);
        if (iVar2 == 0) {
          if ((char)local_34 == '\0') {
            uVar6 = IOAccelMemory::testAllEvent(pIVar5);
            if ((char)uVar6 == '\0') goto LAB_0004111d;
          }
          else {
            IOAccelMemory::finishAllEvent(pIVar5);
          }
          (**(code **)(*(long *)pIVar5 + 0x1b8))(pIVar5);
          lVar1 = *(long *)(this + 0x350);
          lVar3 = (**(code **)(*param_1 + 0x120))(param_1);
          uVar4 = (**(code **)(*(long *)this + 0x990))(this);
          if ((ulong)(lVar3 + lVar1) <= uVar4) goto LAB_00041231;
        }
        else {
          IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(this + 0x388) + 0x58),0x5f);
          *(int *)(this + 0x31c) = *(int *)(this + 0x31c) + 1;
        }
LAB_0004111d:
        pIVar5 = IOAccelResidentMemorySet::LRUIterator::getNextMemory((LRUIterator *)&local_68);
      } while (pIVar5 != (IOAccelMemory *)0x0);
    }
    IOAccelResidentMemorySet::sort(*(IOAccelResidentMemorySet **)(this + 0xa08));
    local_50 = &DAT_aaaaaaaaaaaaaaaa;
    local_48 = &DAT_aaaaaaaaaaaaaaaa;
    local_40 = &DAT_aaaaaaaaaaaaaaaa;
    IOAccelResidentMemorySet::LRUIterator::LRUIterator
              ((LRUIterator *)&local_50,*(long *)(this + 0xa08));
    pIVar5 = IOAccelResidentMemorySet::LRUIterator::getNextMemory((LRUIterator *)&local_50);
    if (pIVar5 != (IOAccelMemory *)0x0) {
      do {
        iVar2 = IOAccelMemory::getPrepareCount(pIVar5);
        if (iVar2 == 0) {
          if ((char)local_34 == '\0') {
            uVar6 = IOAccelMemory::testAllEvent(pIVar5);
            if ((char)uVar6 == '\0') goto LAB_00041202;
          }
          else {
            IOAccelMemory::finishAllEvent(pIVar5);
          }
          (**(code **)(*(long *)pIVar5 + 0x1b8))(pIVar5);
          lVar1 = *(long *)(this + 0x350);
          lVar3 = (**(code **)(*param_1 + 0x120))(param_1);
          uVar4 = (**(code **)(*(long *)this + 0x990))(this);
          if ((ulong)(lVar3 + lVar1) <= uVar4) {
            if ((char)local_34 != '\0') {
              *(byte *)((long)param_1 + 0xe) = *(byte *)((long)param_1 + 0xe) | 2;
            }
LAB_00041231:
            uVar6 = (**(code **)(*param_1 + 0x148))(param_1);
            return uVar6;
          }
        }
        else {
          IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(this + 0x388) + 0x58),0x5f);
          *(int *)(this + 0x31c) = *(int *)(this + 0x31c) + 1;
        }
LAB_00041202:
        pIVar5 = IOAccelResidentMemorySet::LRUIterator::getNextMemory((LRUIterator *)&local_50);
      } while (pIVar5 != (IOAccelMemory *)0x0);
    }
  }
  return 0;
}



// IOGraphicsAccelerator2::freeWaitToPrepareVidMemory(IOAccelVidMemory*, bool, bool)

undefined8 __thiscall
IOGraphicsAccelerator2::freeWaitToPrepareVidMemory
          (IOGraphicsAccelerator2 *this,long *param_1,undefined4 param_2,undefined4 param_3)

{
  bool bVar1;
  char cVar2;
  int iVar3;
  IOAccelMemory *this_00;
  ulong uVar4;
  undefined8 uVar5;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 extraout_RDX_01;
  undefined8 uVar6;
  IOGraphicsAccelerator2 *pIVar7;
  undefined1 *local_40;
  undefined4 local_34;
  
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  pIVar7 = this + 0xb48;
  local_34 = param_2;
  IOAccelVidMemoryList::ReverseIterator::ReverseIterator((ReverseIterator *)&local_40,(long)pIVar7);
  this_00 = (IOAccelMemory *)
            IOAccelVidMemoryList::ReverseIterator::getPrevMemory((ReverseIterator *)&local_40);
  if (this_00 != (IOAccelMemory *)0x0) {
    do {
      iVar3 = IOAccelMemory::getPrepareCount(this_00);
      if (iVar3 == 0) {
        if ((char)param_3 == '\0') {
          uVar4 = IOAccelVidMemory::requirePageoff((IOAccelVidMemory *)this_00);
          if ((char)uVar4 != '\0') goto LAB_0004132a;
        }
        if ((char)local_34 == '\0') {
          uVar5 = IOAccelMemory::testAllEvent(this_00);
          uVar6 = extraout_RDX_01;
          if ((char)uVar5 == '\0') goto LAB_0004132a;
        }
        else {
          bVar1 = IOAccelVidMemory::canDoAsyncPageTableUpdate((IOAccelVidMemory *)this_00);
          uVar6 = extraout_RDX;
          if (!bVar1) {
            IOAccelMemory::finishAllEvent(this_00);
            uVar6 = extraout_RDX_00;
          }
        }
        if (((byte)this_00[0xd] & 4) == 0) {
          (**(code **)(*(long *)this_00 + 0x1b8))(this_00);
        }
        else {
          IOAccelMemory::pruneOrphanedMappings(this_00,pIVar7,uVar6);
        }
        cVar2 = (**(code **)(*param_1 + 0x148))(param_1);
        if (cVar2 != '\0') {
          uVar6 = CONCAT71((uint7)(uint3)((uint)param_3 >> 8),1);
          goto LAB_00041340;
        }
      }
      else {
        pIVar7 = (IOGraphicsAccelerator2 *)((long)&segment_command_00000020.initprot + 3);
        IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(this + 0x388) + 0x58),0x5f);
        *(int *)(this + 0x31c) = *(int *)(this + 0x31c) + 1;
      }
LAB_0004132a:
      this_00 = (IOAccelMemory *)
                IOAccelVidMemoryList::ReverseIterator::getPrevMemory((ReverseIterator *)&local_40);
    } while (this_00 != (IOAccelMemory *)0x0);
  }
  uVar6 = 0;
LAB_00041340:
  IOAccelVidMemoryList::ReverseIterator::~ReverseIterator((ReverseIterator *)&local_40);
  return uVar6;
}



// IOGraphicsAccelerator2::purgeAllSysMemory()

void __thiscall IOGraphicsAccelerator2::purgeAllSysMemory(IOGraphicsAccelerator2 *this)

{
  int iVar1;
  IOAccelMemory *this_00;
  long *plVar2;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  int local_2c;
  
  (**(code **)(**(long **)(this + 0x380) + 0x158))();
  local_2c = -0x55555556;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelResidentMemorySet::LRUIterator::LRUIterator
            ((LRUIterator *)&local_48,*(long *)(this + 0xa08));
  this_00 = IOAccelResidentMemorySet::LRUIterator::getNextMemory((LRUIterator *)&local_48);
  if (this_00 != (IOAccelMemory *)0x0) {
    do {
      iVar1 = IOAccelMemory::getPrepareCount(this_00);
      if (iVar1 == 0) {
        IOAccelMemory::finishAllEvent(this_00);
        (**(code **)(*(long *)this_00 + 0x1b8))(this_00);
        plVar2 = *(long **)(this_00 + 0xd0);
        if (plVar2 != (long *)0x0) {
          (**(code **)(*plVar2 + 0x120))(plVar2,4,0);
        }
      }
      this_00 = IOAccelResidentMemorySet::LRUIterator::getNextMemory((LRUIterator *)&local_48);
    } while (this_00 != (IOAccelMemory *)0x0);
  }
  local_68 = &DAT_aaaaaaaaaaaaaaaa;
  local_60 = &DAT_aaaaaaaaaaaaaaaa;
  local_58 = &DAT_aaaaaaaaaaaaaaaa;
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelSysMemoryList::OrderedReverseIterator::OrderedReverseIterator
            ((OrderedReverseIterator *)&local_68,(long)(this + 0xb30));
  plVar2 = (long *)IOAccelSysMemoryList::OrderedReverseIterator::getPrevMemory
                             ((OrderedReverseIterator *)&local_68);
  if (plVar2 != (long *)0x0) {
    do {
      iVar1 = (**(code **)(*plVar2 + 0x160))(plVar2,1,&local_2c);
      if (((iVar1 != 0) || (local_2c == 3)) &&
         (plVar2 = (long *)plVar2[0x1a], plVar2 != (long *)0x0)) {
        (**(code **)(*plVar2 + 0x120))(plVar2,4,0);
      }
      plVar2 = (long *)IOAccelSysMemoryList::OrderedReverseIterator::getPrevMemory
                                 ((OrderedReverseIterator *)&local_68);
    } while (plVar2 != (long *)0x0);
  }
  return;
}



// IOGraphicsAccelerator2::purgeAllVidMemory()

void __thiscall IOGraphicsAccelerator2::purgeAllVidMemory(IOGraphicsAccelerator2 *this)

{
  int iVar1;
  IOAccelMemory *this_00;
  undefined8 extraout_RDX;
  IOGraphicsAccelerator2 *pIVar2;
  undefined1 *local_20;
  
  (**(code **)(**(long **)(this + 0x380) + 0x158))();
  local_20 = &DAT_aaaaaaaaaaaaaaaa;
  pIVar2 = this + 0xb48;
  IOAccelVidMemoryList::ReverseIterator::ReverseIterator((ReverseIterator *)&local_20,(long)pIVar2);
  this_00 = (IOAccelMemory *)
            IOAccelVidMemoryList::ReverseIterator::getPrevMemory((ReverseIterator *)&local_20);
  if (this_00 != (IOAccelMemory *)0x0) {
    do {
      iVar1 = IOAccelMemory::getPrepareCount(this_00);
      if (iVar1 == 0) {
        IOAccelMemory::finishAllEvent(this_00);
        (**(code **)(*(long *)this_00 + 0x1b8))(this_00);
        IOAccelMemory::pruneOrphanedMappings(this_00,pIVar2,extraout_RDX);
      }
      this_00 = (IOAccelMemory *)
                IOAccelVidMemoryList::ReverseIterator::getPrevMemory((ReverseIterator *)&local_20);
    } while (this_00 != (IOAccelMemory *)0x0);
  }
  IOAccelVidMemoryList::ReverseIterator::~ReverseIterator((ReverseIterator *)&local_20);
  return;
}



// IOGraphicsAccelerator2::freeAllDynamicGPUVirtualAddress()

void __thiscall
IOGraphicsAccelerator2::freeAllDynamicGPUVirtualAddress(IOGraphicsAccelerator2 *this)

{
  IOAccelTask *this_00;
  undefined1 *local_28;
  undefined1 *local_20;
  undefined1 *local_18;
  
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  local_20 = &DAT_aaaaaaaaaaaaaaaa;
  local_18 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelTaskList::Iterator::Iterator((Iterator *)&local_28,(undefined8 *)(this + 0xc48));
  this_00 = (IOAccelTask *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_28);
  if (this_00 != (IOAccelTask *)0x0) {
    do {
      IOAccelTask::freeAllDynamicGPUVirtualAddress(this_00);
      this_00 = (IOAccelTask *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_28);
    } while (this_00 != (IOAccelTask *)0x0);
  }
  return;
}



// IOGraphicsAccelerator2::getMaxSingleSysMemorySize()

ulong __thiscall IOGraphicsAccelerator2::getMaxSingleSysMemorySize(IOGraphicsAccelerator2 *this)

{
  return -*(long *)PTR__page_size_0006b108 & (ulong)(*(long *)(this + 0x348) * 3) >> 2;
}



// IOGraphicsAccelerator2::getMaxResourceSize()

ulong __thiscall IOGraphicsAccelerator2::getMaxResourceSize(IOGraphicsAccelerator2 *this)

{
  ulong uVar1;
  ulong uVar2;
  
  uVar1 = (**(code **)(*(long *)this + 0x988))();
  if ((*(long *)(this + 0xca8) != 0) &&
     (uVar2 = -*(long *)PTR__page_size_0006b108 & (ulong)(*(long *)(this + 0xca8) * 3) >> 2,
     uVar2 <= uVar1)) {
    uVar1 = uVar2;
  }
  uVar2 = 0x40000000;
  if (0x40000000 < uVar1) {
    uVar2 = uVar1;
  }
  return uVar2;
}



// IOGraphicsAccelerator2::getMaxWiredSysMemorySize()

undefined8 __thiscall IOGraphicsAccelerator2::getMaxWiredSysMemorySize(IOGraphicsAccelerator2 *this)

{
  return *(undefined8 *)(this + 0x348);
}



// IOGraphicsAccelerator2::vidmem_wired(IOAccelVidMemory*)

void __thiscall IOGraphicsAccelerator2::vidmem_wired(IOGraphicsAccelerator2 *this,long *param_1)

{
  long lVar1;
  long lVar2;
  uintptr_t arg2;
  
  IOAccelVidMemoryList::addMemory((IOAccelVidMemoryList *)(this + 0xb48),(long)param_1);
  lVar2 = (**(code **)(*param_1 + 0x130))(param_1);
  lVar1 = *(long *)(this + 0x360);
  *(long *)(this + 0x360) = lVar2 + lVar1;
  if (___ktrace_kernel_enabled != 0) {
    arg2 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85120038,lVar2 + lVar1,arg2,0,0,0);
    return;
  }
  return;
}



// IOGraphicsAccelerator2::vidmem_unwired(IOAccelVidMemory*)

void __thiscall IOGraphicsAccelerator2::vidmem_unwired(IOGraphicsAccelerator2 *this,long *param_1)

{
  long lVar1;
  long lVar2;
  uintptr_t arg2;
  
  IOAccelVidMemoryList::removeMemory((IOAccelVidMemoryList *)(this + 0xb48),(long)param_1);
  lVar2 = (**(code **)(*param_1 + 0x130))(param_1);
  lVar1 = *(long *)(this + 0x360);
  *(long *)(this + 0x360) = lVar1 - lVar2;
  if (___ktrace_kernel_enabled != 0) {
    arg2 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85120038,lVar1 - lVar2,arg2,0,0,0);
    return;
  }
  return;
}



// IOGraphicsAccelerator2::freeAllVidMemoryMappings()

void __thiscall IOGraphicsAccelerator2::freeAllVidMemoryMappings(IOGraphicsAccelerator2 *this)

{
  long *plVar1;
  undefined1 *local_28;
  undefined1 *local_20;
  undefined1 *local_18;
  
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  local_20 = &DAT_aaaaaaaaaaaaaaaa;
  local_18 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelTaskList::Iterator::Iterator((Iterator *)&local_28,(undefined8 *)(this + 0xc48));
  plVar1 = (long *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_28);
  if (plVar1 != (long *)0x0) {
    do {
      (**(code **)(*plVar1 + 0x138))(plVar1);
      plVar1 = (long *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_28);
    } while (plVar1 != (long *)0x0);
  }
  return;
}



// IOGraphicsAccelerator2::pageoffSurfaceInLinear()

void __thiscall IOGraphicsAccelerator2::pageoffSurfaceInLinear(IOGraphicsAccelerator2 *this)

{
  IOAccelSurface *this_00;
  undefined1 *local_18;
  
  local_18 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelSurfaceList::Iterator::Iterator((Iterator *)&local_18,(undefined8 *)(this + 0xaa8));
  this_00 = (IOAccelSurface *)IOAccelSurfaceList::Iterator::getNextSurface((Iterator *)&local_18);
  if (this_00 != (IOAccelSurface *)0x0) {
    do {
      IOAccelSurface::pageoffInLinear(this_00);
      this_00 = (IOAccelSurface *)
                IOAccelSurfaceList::Iterator::getNextSurface((Iterator *)&local_18);
    } while (this_00 != (IOAccelSurface *)0x0);
  }
  return;
}



// IOGraphicsAccelerator2::unwireAllVidMemory()

void __thiscall
IOGraphicsAccelerator2::unwireAllVidMemory(IOGraphicsAccelerator2 *this,undefined8 param_1)

{
  int iVar1;
  IOAccelMemory *this_00;
  undefined8 extraout_RDX;
  undefined1 *local_20;
  
  unload_dirty_resources(this);
  (**(code **)(**(long **)(this + 0x380) + 0x158))();
  IOAccelOrphanedMemoryPool::releaseOrphanedMemory
            ((IOAccelOrphanedMemoryPool *)(this + 0xbc8),param_1,extraout_RDX);
  local_20 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelVidMemoryList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_20,(long)(this + 0xb48));
  this_00 = (IOAccelMemory *)
            IOAccelVidMemoryList::ReverseIterator::getPrevMemory((ReverseIterator *)&local_20);
  if (this_00 != (IOAccelMemory *)0x0) {
    do {
      iVar1 = IOAccelMemory::getPrepareCount(this_00);
      if (iVar1 == 0) {
        (**(code **)(*(long *)this_00 + 0x1b8))(this_00);
      }
      this_00 = (IOAccelMemory *)
                IOAccelVidMemoryList::ReverseIterator::getPrevMemory((ReverseIterator *)&local_20);
    } while (this_00 != (IOAccelMemory *)0x0);
  }
  IOAccelVidMemoryList::ReverseIterator::~ReverseIterator((ReverseIterator *)&local_20);
  return;
}



// IOGraphicsAccelerator2::logAllVidMemory()

void __thiscall IOGraphicsAccelerator2::logAllVidMemory(IOGraphicsAccelerator2 *this)

{
  IOAccelResource2 *this_00;
  IOAccelMemory *this_01;
  ulonglong param4;
  ulonglong param5;
  char *param7;
  uint param2;
  undefined1 *local_48;
  undefined1 *local_40;
  int local_34;
  
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelVidMemoryList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_40,(long)(this + 0xb48));
  _kprintf("*** %s: Begin Log ***\n","void IOGraphicsAccelerator2::logAllVidMemory()");
  this_01 = (IOAccelMemory *)
            IOAccelVidMemoryList::ReverseIterator::getPrevMemory((ReverseIterator *)&local_40);
  while (this_01 != (IOAccelMemory *)0x0) {
    this_00 = *(IOAccelResource2 **)(this_01 + 0x38);
    local_48 = &DAT_aaaaaaaaaaaaaaaa;
    param2 = *(uint *)(this_01 + 0xc) >> 1 & 1;
    local_34 = IOAccelMemory::getPrepareCount(this_01);
    param4 = (**(code **)(*(long *)this_01 + 0x120))(this_01);
    param5 = (**(code **)(*(long *)this_01 + 0x158))(this_01,0,&local_48);
    if (this_00 == (IOAccelResource2 *)0x0) {
      _kprintf("vram=%p: wired=%d, prepare_count=%d, vram_allocbytes=0x%llx, phys=0x%llx\n",this_01,
               param2,local_34,param4,param5);
    }
    else {
      param7 = IOAccelResource2::objTypeName(this_00);
      _kprintf("vram=%p: wired=%d, prepare_count=%d, vram_allocbytes=0x%llx, phys=0x%llx, texbuf=%p: %s\n"
               ,this_01,param2,local_34,param4,param5,this_00,param7);
    }
    this_01 = (IOAccelMemory *)
              IOAccelVidMemoryList::ReverseIterator::getPrevMemory((ReverseIterator *)&local_40);
  }
  _kprintf("*** %s: End Log ***\n","void IOGraphicsAccelerator2::logAllVidMemory()");
  IOAccelVidMemoryList::ReverseIterator::~ReverseIterator((ReverseIterator *)&local_40);
  return;
}



// IOGraphicsAccelerator2::find_vram_descriptor()

ulong __thiscall IOGraphicsAccelerator2::find_vram_descriptor(IOGraphicsAccelerator2 *this)

{
  int iVar1;
  uint uVar2;
  long *plVar3;
  undefined8 uVar4;
  undefined8 unaff_RBX;
  ulong uVar5;
  uint uVar6;
  
  uVar5 = CONCAT71((int7)((ulong)unaff_RBX >> 8),1);
  if (*(long *)(this + 0x180) == 0) {
    iVar1 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x378));
    if (iVar1 != 0) {
      uVar6 = 0;
      do {
        plVar3 = (long *)IOAccelDisplayMachine::getIOFramebuffer
                                   (*(IOAccelDisplayMachine **)(this + 0x378),uVar6);
        if (plVar3 != (long *)0x0) {
          plVar3 = (long *)(**(code **)(*plVar3 + 0x9b0))(plVar3);
          *(long **)(this + 0x180) = plVar3;
          if (plVar3 != (long *)0x0) goto LAB_00041a0a;
        }
        uVar6 = uVar6 + 1;
        uVar2 = IOAccelDisplayMachine::getFramebufferCount
                          (*(IOAccelDisplayMachine **)(this + 0x378));
      } while (uVar6 < uVar2);
    }
    plVar3 = *(long **)(this + 0x180);
    if (plVar3 != (long *)0x0) {
LAB_00041a0a:
      plVar3 = (long *)(**(code **)(*plVar3 + 0x200))(plVar3,1);
      *(long **)(this + 0x188) = plVar3;
      if (plVar3 != (long *)0x0) {
        uVar4 = (**(code **)(*plVar3 + 0x118))(plVar3);
        *(undefined8 *)(this + 400) = uVar4;
        goto LAB_00041a56;
      }
      (**(code **)(**(long **)(this + 0x180) + 0x28))();
      *(undefined8 *)(this + 0x180) = 0;
    }
    uVar5 = 0;
  }
LAB_00041a56:
  return uVar5 & 0xffffffff;
}



// IOGraphicsAccelerator2::freeAllGPUMappings()

void __thiscall IOGraphicsAccelerator2::freeAllGPUMappings(IOGraphicsAccelerator2 *this)

{
  long *plVar1;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  undefined1 *local_28;
  
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelTaskList::Iterator::Iterator((Iterator *)&local_50,(undefined8 *)(this + 0xc48));
  plVar1 = (long *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_50);
  if (plVar1 != (long *)0x0) {
    do {
      (**(code **)(*plVar1 + 0x128))(plVar1);
      plVar1 = (long *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_50);
    } while (plVar1 != (long *)0x0);
  }
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelTaskList::Iterator::Iterator((Iterator *)&local_38,(undefined8 *)(this + 0xc58));
  plVar1 = (long *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_38);
  if (plVar1 != (long *)0x0) {
    do {
      (**(code **)(**(long **)(this + 0x380) + 0x188))(*(long **)(this + 0x380),plVar1 + 4);
      (**(code **)(*plVar1 + 0x28))(plVar1);
      plVar1 = (long *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_38);
    } while (plVar1 != (long *)0x0);
  }
  return;
}



// IOGraphicsAccelerator2::kickReusableOrphanedMemoryPoolCollector()

void __thiscall
IOGraphicsAccelerator2::kickReusableOrphanedMemoryPoolCollector(IOGraphicsAccelerator2 *this)

{
  if ((*(int *)(this + 0xec) == 0) && (((byte)this[0xc78] & 0x10) == 0)) {
    *(undefined4 *)(this + 0xec) = 1;
                    // WARNING: Could not recover jumptable at 0x00041b67. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0x130) + 0x1d0))(*(long **)(this + 0x130),60000);
    return;
  }
  return;
}



// IOGraphicsAccelerator2::update_gart_collector_age()

void __thiscall IOGraphicsAccelerator2::update_gart_collector_age(IOGraphicsAccelerator2 *this)

{
  int iVar1;
  undefined1 *local_20;
  
  local_20 = &DAT_aaaaaaaaaaaaaaaa;
  _clock_get_uptime(&local_20);
  iVar1 = (int)((ulong)((long)local_20 - *(long *)(this + 200)) / *(ulong *)(this + 0xd0));
  if (iVar1 != 0) {
    *(int *)(this + 0xbc) = *(int *)(this + 0xbc) + iVar1;
    *(undefined1 **)(this + 200) = local_20;
    IOAccelResidentMemorySet::updateCollectionLRUs(*(long **)(this + 0xa08));
  }
  return;
}



// IOGraphicsAccelerator2::kickNonReusableOrphanedMemoryPoolCollector(bool)

void __thiscall
IOGraphicsAccelerator2::kickNonReusableOrphanedMemoryPoolCollector
          (IOGraphicsAccelerator2 *this,char param_1)

{
  undefined8 uVar1;
  
  if ((*(int *)(this + 0x9d8) == 0) && (((byte)this[0xc78] & 8) == 0)) {
    *(undefined4 *)(this + 0x9d8) = 1;
    uVar1 = 0x32;
    if (param_1 != '\0') {
      uVar1 = 1;
    }
                    // WARNING: Could not recover jumptable at 0x00041c10. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0x9c8) + 0x1d0))(*(long **)(this + 0x9c8),uVar1);
    return;
  }
  return;
}



// IOGraphicsAccelerator2::kickOrphanResourceTimer()

void __thiscall IOGraphicsAccelerator2::kickOrphanResourceTimer(IOGraphicsAccelerator2 *this)

{
  if ((*(int *)(this + 0xe0) == 0) && (((byte)this[0xc78] & 0x10) == 0)) {
    *(undefined4 *)(this + 0xe0) = 1;
                    // WARNING: Could not recover jumptable at 0x00041c4b. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0xf8) + 0x1d0))(*(long **)(this + 0xf8),100);
    return;
  }
  return;
}



// IOGraphicsAccelerator2::free_orphaned_gputasks()

void __thiscall IOGraphicsAccelerator2::free_orphaned_gputasks(IOGraphicsAccelerator2 *this)

{
  char cVar1;
  IOAccelTask *this_00;
  undefined1 *local_38;
  undefined1 *local_30;
  undefined1 *local_28;
  
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelTaskList::Iterator::Iterator((Iterator *)&local_38,(undefined8 *)(this + 0xc58));
  this_00 = (IOAccelTask *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_38);
  if (this_00 != (IOAccelTask *)0x0) {
    do {
      cVar1 = (**(code **)(**(long **)(this + 0x380) + 400))
                        (*(long **)(this + 0x380),this_00 + 0x20);
      if (cVar1 != '\0') {
        IOAccelTask::free_orphaned_mappings(this_00);
        (**(code **)(*(long *)this_00 + 0x28))(this_00);
      }
      this_00 = (IOAccelTask *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_38);
    } while (this_00 != (IOAccelTask *)0x0);
  }
  return;
}



// IOGraphicsAccelerator2::update_gc_low_water_mark(unsigned long long)

void __thiscall
IOGraphicsAccelerator2::update_gc_low_water_mark(IOGraphicsAccelerator2 *this,ulong param_1)

{
  int *piVar1;
  
  *(ulong *)(this + 0x338) = param_1;
  if (((byte)this[0xc92] & 0x20) == 0) {
    *(ulong *)(this + 0x340) = param_1;
  }
  else if (*(ulong *)(this + 0x340) < param_1) {
    *(ulong *)(this + 0x340) = param_1;
    piVar1 = *(int **)(this + 0xd98);
    *(ulong *)(piVar1 + 2) = param_1;
    IOAccelResidentMemorySet::setCollectionEras(*(IOAccelResidentMemorySet **)(this + 0xa08),piVar1)
    ;
    return;
  }
  return;
}



// IOGraphicsAccelerator2::enable_gart_collector()

void __thiscall IOGraphicsAccelerator2::enable_gart_collector(IOGraphicsAccelerator2 *this)

{
  if (*(ulong *)(this + 0x338) < *(ulong *)(this + 0x350)) {
    if (*(int *)(this + 0xd8) == 0) {
      *(undefined4 *)(this + 0xd8) = 1;
      (**(code **)(**(long **)(this + 0x108) + 0x1d0))
                (*(long **)(this + 0x108),*(undefined4 *)(this + 0xb8));
    }
    else {
      *(undefined4 *)(this + 0xdc) = 1;
    }
  }
  if ((((byte)this[0xc92] & 8) == 0) && (((byte)this[0xc78] & 2) != 0)) {
    IOAccelEventMachine2::startHardwareProgressTimer(*(IOAccelEventMachine2 **)(this + 0x380));
  }
  *(int *)(this + 0x15c) = *(int *)(this + 0x15c) + 1;
  return;
}



// IOGraphicsAccelerator2::disable_gart_collector()

void __thiscall IOGraphicsAccelerator2::disable_gart_collector(IOGraphicsAccelerator2 *this)

{
  if (*(int *)(this + 0xd8) != 0) {
    (**(code **)(**(long **)(this + 0x108) + 0x218))();
  }
  *(undefined8 *)(this + 0xd8) = 0;
  return;
}



// IOGraphicsAccelerator2::collectGartWirings()

void __thiscall IOGraphicsAccelerator2::collectGartWirings(IOGraphicsAccelerator2 *this)

{
  IOAccelResidentMemorySet::collect(*(IOAccelResidentMemorySet **)(this + 0xa08));
  return;
}



// IOGraphicsAccelerator2::try_unload_dirty_resources(unsigned int)

void __thiscall
IOGraphicsAccelerator2::try_unload_dirty_resources(IOGraphicsAccelerator2 *this,uint param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  long lVar2;
  IOAccelResource2 *pIVar3;
  ulong uVar4;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  IOGraphicsAccelerator2 *local_38;
  
  this[0xc78] = (IOGraphicsAccelerator2)((byte)this[0xc78] | 0x40);
  local_58 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = this;
  IOAccelSharedList::Iterator::Iterator((Iterator *)&local_58,(undefined8 *)(this + 0xa88));
  lVar2 = IOAccelSharedList::Iterator::getNextShared((Iterator *)&local_58);
  if (lVar2 != 0) {
    do {
      local_50 = &DAT_aaaaaaaaaaaaaaaa;
      local_48 = &DAT_aaaaaaaaaaaaaaaa;
      local_40 = &DAT_aaaaaaaaaaaaaaaa;
      IOAccelResourceList::ReverseIterator::ReverseIterator
                ((ReverseIterator *)&local_50,lVar2 + 0xa0);
      pIVar3 = (IOAccelResource2 *)
               IOAccelResourceList::ReverseIterator::getPrevResource((ReverseIterator *)&local_50);
      while (pIVar3 != (IOAccelResource2 *)0x0) {
        if ((*(uint *)(pIVar3 + 0x10) < param_1) &&
           (uVar4 = IOAccelResource2::requirePageoff(pIVar3), (char)uVar4 != '\0')) {
          IOAccelResource2::try_unload(pIVar3);
        }
        pIVar3 = (IOAccelResource2 *)
                 IOAccelResourceList::ReverseIterator::getPrevResource((ReverseIterator *)&local_50)
        ;
      }
      lVar2 = IOAccelSharedList::Iterator::getNextShared((Iterator *)&local_58);
    } while (lVar2 != 0);
  }
  pIVar1 = local_38;
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelResourceList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_50,(long)(local_38 + 0xb00));
  pIVar3 = (IOAccelResource2 *)
           IOAccelResourceList::ReverseIterator::getPrevResource((ReverseIterator *)&local_50);
  if (pIVar3 != (IOAccelResource2 *)0x0) {
    do {
      if ((*(uint *)(pIVar3 + 0x10) < param_1) &&
         (uVar4 = IOAccelResource2::requirePageoff(pIVar3), (char)uVar4 != '\0')) {
        IOAccelResource2::try_unload(pIVar3);
      }
      pIVar3 = (IOAccelResource2 *)
               IOAccelResourceList::ReverseIterator::getPrevResource((ReverseIterator *)&local_50);
    } while (pIVar3 != (IOAccelResource2 *)0x0);
  }
  pIVar1[0xc78] = (IOGraphicsAccelerator2)((byte)pIVar1[0xc78] & 0xbf);
  return;
}



// IOGraphicsAccelerator2::kickMemoryPoolTimer()

void __thiscall IOGraphicsAccelerator2::kickMemoryPoolTimer(IOGraphicsAccelerator2 *this)

{
  char cVar1;
  
  if (*(long *)(this + 0xc30) != 0) {
    cVar1 = _OSCompareAndSwap(0,1,this + 0xe8);
    if (cVar1 != '\0') {
                    // WARNING: Could not recover jumptable at 0x00041f60. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(**(long **)(this + 0x118) + 0x1d0))(*(long **)(this + 0x118),0x11);
      return;
    }
  }
  return;
}



// IOGraphicsAccelerator2::sysmem_wired(IOAccelSysMemory*)

void __thiscall
IOGraphicsAccelerator2::sysmem_wired(IOGraphicsAccelerator2 *this,IOAccelMemory *param_1)

{
  long lVar1;
  long lVar2;
  uintptr_t arg2;
  
  IOAccelSysMemoryList::removeMemory((IOAccelSysMemoryList *)(this + 0xb30),(long)param_1);
  IOAccelResidentMemorySet::addMemory(*(IOAccelResidentMemorySet **)(this + 0xa08),param_1);
  lVar2 = (**(code **)(*(long *)param_1 + 0x120))(param_1);
  lVar1 = *(long *)(this + 0x350);
  *(long *)(this + 0x350) = lVar2 + lVar1;
  if (___ktrace_kernel_enabled != 0) {
    arg2 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85120034,lVar2 + lVar1,arg2,0,0,0);
    return;
  }
  return;
}



// IOGraphicsAccelerator2::sysmem_unwired(IOAccelSysMemory*)

void __thiscall IOGraphicsAccelerator2::sysmem_unwired(IOGraphicsAccelerator2 *this,long *param_1)

{
  long lVar1;
  long lVar2;
  uintptr_t arg2;
  
  IOAccelResidentMemorySet::removeMemory(*(IOAccelResidentMemorySet **)(this + 0xa08),(long)param_1)
  ;
  IOAccelSysMemoryList::addMemory((IOAccelSysMemoryList *)(this + 0xb30),(long)param_1);
  lVar2 = (**(code **)(*param_1 + 0x120))(param_1);
  lVar1 = *(long *)(this + 0x350);
  *(long *)(this + 0x350) = lVar1 - lVar2;
  if (___ktrace_kernel_enabled != 0) {
    arg2 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85120034,lVar1 - lVar2,arg2,0,0,0);
    return;
  }
  return;
}



// IOGraphicsAccelerator2::freeAllSysMemoryMappings()

void __thiscall IOGraphicsAccelerator2::freeAllSysMemoryMappings(IOGraphicsAccelerator2 *this)

{
  long *plVar1;
  undefined1 *local_28;
  undefined1 *local_20;
  undefined1 *local_18;
  
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  local_20 = &DAT_aaaaaaaaaaaaaaaa;
  local_18 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelTaskList::Iterator::Iterator((Iterator *)&local_28,(undefined8 *)(this + 0xc48));
  plVar1 = (long *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_28);
  if (plVar1 != (long *)0x0) {
    do {
      (**(code **)(*plVar1 + 0x130))(plVar1);
      plVar1 = (long *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_28);
    } while (plVar1 != (long *)0x0);
  }
  return;
}



// IOGraphicsAccelerator2::unwireAllSysMemory()

void __thiscall IOGraphicsAccelerator2::unwireAllSysMemory(IOGraphicsAccelerator2 *this)

{
  int iVar1;
  IOAccelMemory *this_00;
  undefined1 *local_30;
  undefined1 *local_28;
  undefined1 *local_20;
  
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  local_20 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelResidentMemorySet::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_30,*(long *)(this + 0xa08));
  this_00 = (IOAccelMemory *)
            IOAccelResidentMemorySet::ReverseIterator::getPrevMemory((ReverseIterator *)&local_30);
  if (this_00 != (IOAccelMemory *)0x0) {
    do {
      iVar1 = IOAccelMemory::getPrepareCount(this_00);
      if (iVar1 == 0) {
        IOAccelMemory::finishAllEvent(this_00);
        (**(code **)(*(long *)this_00 + 0x1b8))(this_00);
      }
      this_00 = (IOAccelMemory *)
                IOAccelResidentMemorySet::ReverseIterator::getPrevMemory
                          ((ReverseIterator *)&local_30);
    } while (this_00 != (IOAccelMemory *)0x0);
  }
  return;
}



// IOGraphicsAccelerator2::logAllSysMemory()

void __thiscall IOGraphicsAccelerator2::logAllSysMemory(IOGraphicsAccelerator2 *this)

{
  int param3;
  IOAccelMemory *this_00;
  ulonglong param2;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  
  _kprintf("*** %s: Begin Log ***\n","void IOGraphicsAccelerator2::logAllSysMemory()");
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelResidentMemorySet::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_40,*(long *)(this + 0xa08));
  this_00 = (IOAccelMemory *)
            IOAccelResidentMemorySet::ReverseIterator::getPrevMemory((ReverseIterator *)&local_40);
  if (this_00 != (IOAccelMemory *)0x0) {
    do {
      param2 = (**(code **)(*(long *)this_00 + 0x120))(this_00);
      param3 = IOAccelMemory::getPrepareCount(this_00);
      _kprintf("memory=%p: allocbytes=0x%llx, prepare_count=%d\n",this_00,param2,param3);
      this_00 = (IOAccelMemory *)
                IOAccelResidentMemorySet::ReverseIterator::getPrevMemory
                          ((ReverseIterator *)&local_40);
    } while (this_00 != (IOAccelMemory *)0x0);
  }
  _kprintf("*** %s: End Log ***\n","void IOGraphicsAccelerator2::logAllSysMemory()");
  return;
}



// IOGraphicsAccelerator2::searchResourceForMemory(IOAccelMemory*)

void __thiscall
IOGraphicsAccelerator2::searchResourceForMemory(IOGraphicsAccelerator2 *this,long param_1)

{
  long lVar1;
  long lVar2;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelSharedList::Iterator::Iterator((Iterator *)&local_38,(undefined8 *)(this + 0xa88));
  lVar1 = IOAccelSharedList::Iterator::getNextShared((Iterator *)&local_38);
  if (lVar1 != 0) {
    do {
      local_50 = &DAT_aaaaaaaaaaaaaaaa;
      local_48 = &DAT_aaaaaaaaaaaaaaaa;
      local_40 = &DAT_aaaaaaaaaaaaaaaa;
      IOAccelResourceList::ReverseIterator::ReverseIterator
                ((ReverseIterator *)&local_50,lVar1 + 0xa0);
      while (lVar1 = IOAccelResourceList::ReverseIterator::getPrevResource
                               ((ReverseIterator *)&local_50), lVar1 != 0) {
        lVar2 = *(long *)(lVar1 + 0x88);
        if (lVar2 == 0) {
          lVar2 = *(long *)(lVar1 + 0x80);
        }
        if (lVar2 == param_1) {
          return;
        }
      }
      lVar1 = IOAccelSharedList::Iterator::getNextShared((Iterator *)&local_38);
    } while (lVar1 != 0);
  }
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelResourceList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_50,(long)(this + 0xb00));
  do {
    lVar1 = IOAccelResourceList::ReverseIterator::getPrevResource((ReverseIterator *)&local_50);
    if (lVar1 == 0) {
      return;
    }
    lVar2 = *(long *)(lVar1 + 0x88);
    if (lVar2 == 0) {
      lVar2 = *(long *)(lVar1 + 0x80);
    }
  } while (lVar2 != param_1);
  return;
}



// IOGraphicsAccelerator2::calcMaxGPUPhysicalMemoryBytes(unsigned long long)

ulong __thiscall
IOGraphicsAccelerator2::calcMaxGPUPhysicalMemoryBytes(undefined8 param_1_00,ulong param_2)

{
  ulong uVar1;
  
  uVar1 = 0x4000000;
  if (0x4000000 < param_2 / 3) {
    uVar1 = param_2 / 3;
  }
  return -*(long *)PTR__page_size_0006b108 & (uVar1 + *(long *)PTR__page_size_0006b108) - 1;
}



// IOGraphicsAccelerator2::isIdle()

void __thiscall IOGraphicsAccelerator2::isIdle(IOGraphicsAccelerator2 *this)

{
                    // WARNING: Could not recover jumptable at 0x00042343. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0x380) + 0x168))();
  return;
}



// IOGraphicsAccelerator2::systemWillSleep()

void __thiscall IOGraphicsAccelerator2::systemWillSleep(IOGraphicsAccelerator2 *this)

{
  char cVar1;
  uint uVar2;
  IOAccelTask *pIVar3;
  undefined8 uVar4;
  undefined8 extraout_RDX;
  IOGraphicsAccelerator2 *pIVar5;
  IOAccelDisplayMachine *this_00;
  undefined1 auVar6 [16];
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 **local_30;
  undefined1 *local_28;
  
  if (*(IOAccelDisplayMachine **)(this + 0x378) != (IOAccelDisplayMachine *)0x0) {
    IOAccelDisplayMachine::system_will_sleep(*(IOAccelDisplayMachine **)(this + 0x378));
    local_38 = (undefined1 *)0x0;
    this_00 = *(IOAccelDisplayMachine **)(this + 0x378);
    local_30 = &local_38;
    IOAccelDisplayMachine::get_finished_transactions(this_00,&local_38);
    accel_transaction_finished(this_00,&local_38);
  }
  uVar2 = *(uint *)(this + 0xc90);
  if ((uVar2 & 0x1200000) == 0x200000) {
    try_unload_dirty_resources(this,0xffffffff);
    uVar2 = *(uint *)(this + 0xc90);
  }
  if ((uVar2 >> 0x17 & 1) == 0) {
    (**(code **)(*(long *)this + 0x948))(this);
  }
  (**(code **)(*(long *)this + 0x978))(this);
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_30 = (undefined1 **)&DAT_aaaaaaaaaaaaaaaa;
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelTaskList::Iterator::Iterator((Iterator *)&local_38,(undefined8 *)(this + 0xc48));
  pIVar3 = (IOAccelTask *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_38);
  if (pIVar3 != (IOAccelTask *)0x0) {
    do {
      IOAccelTask::free_orphaned_mappings(pIVar3);
      pIVar3 = (IOAccelTask *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_38);
    } while (pIVar3 != (IOAccelTask *)0x0);
  }
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  pIVar5 = this + 0xc58;
  IOAccelTaskList::Iterator::Iterator((Iterator *)&local_50,(undefined8 *)pIVar5);
  auVar6 = IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_38);
  uVar4 = auVar6._8_8_;
  pIVar3 = auVar6._0_8_;
  if (pIVar3 != (IOAccelTask *)0x0) {
    do {
      pIVar5 = (IOGraphicsAccelerator2 *)(pIVar3 + 0x20);
      cVar1 = (**(code **)(**(long **)(this + 0x380) + 400))();
      if (cVar1 != '\0') {
        IOAccelTask::free_orphaned_mappings(pIVar3);
        (**(code **)(*(long *)pIVar3 + 0x28))(pIVar3);
      }
      auVar6 = IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_38);
      uVar4 = auVar6._8_8_;
      pIVar3 = auVar6._0_8_;
    } while (pIVar3 != (IOAccelTask *)0x0);
  }
  IOAccelOrphanedMemoryPool::releaseOrphanedMemory
            ((IOAccelOrphanedMemoryPool *)(this + 0xb60),pIVar5,uVar4);
  IOAccelOrphanedMemoryPool::releaseOrphanedMemory
            ((IOAccelOrphanedMemoryPool *)(this + 0xbc8),pIVar5,extraout_RDX);
  (**(code **)(**(long **)(this + 0x380) + 0x158))();
  IOAccelEventMachine2::signalAllStamps(*(IOAccelEventMachine2 **)(this + 0x380));
  if (((byte)this[0xc91] & 0x20) != 0) {
    IOService::requireMaxInterruptDelay((uint)this);
  }
  this[0xc78] = (IOGraphicsAccelerator2)((byte)this[0xc78] | 0x10);
  return;
}



// IOGraphicsAccelerator2::accel_transaction_finished(DisplayTransactionListHead*)

void __thiscall
IOGraphicsAccelerator2::accel_transaction_finished(undefined8 param_1_00,undefined8 *param_2)

{
  IOAccelDisplayPipeTransaction2 *this;
  long lVar1;
  long *plVar2;
  char *pcVar3;
  
  this = (IOAccelDisplayPipeTransaction2 *)*param_2;
  do {
    if (this == (IOAccelDisplayPipeTransaction2 *)0x0) {
      return;
    }
    lVar1 = *(long *)(this + 0x10);
    if (lVar1 == 0) {
      plVar2 = *(long **)(this + 0x18);
      if ((IOAccelDisplayPipeTransaction2 *)*plVar2 != this) {
LAB_00042556:
        pcVar3 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_00042566:
                    // WARNING: Subroutine does not return
        _panic(pcVar3,this,&DAT_00001138,"IOGraphicsAccelerator.cpp",&DAT_00001138);
      }
      param_2[1] = plVar2;
    }
    else {
      if (*(IOAccelDisplayPipeTransaction2 **)(lVar1 + 0x18) != this + 0x10) {
        pcVar3 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
        goto LAB_00042566;
      }
      if ((IOAccelDisplayPipeTransaction2 *)**(long **)(this + 0x18) != this) goto LAB_00042556;
      *(long **)(lVar1 + 0x18) = *(long **)(this + 0x18);
      plVar2 = *(long **)(this + 0x18);
    }
    *plVar2 = lVar1;
    IOAccelDisplayPipeTransaction2::finish(this);
    IOAccelDisplayPipeTransaction2::complete(this);
    (**(code **)(*(long *)this + 0x28))(this);
    this = (IOAccelDisplayPipeTransaction2 *)*param_2;
  } while( true );
}



// IOGraphicsAccelerator2::systemDidWake()

void __thiscall IOGraphicsAccelerator2::systemDidWake(IOGraphicsAccelerator2 *this)

{
  int iVar1;
  
  this[0xc78] = (IOGraphicsAccelerator2)((byte)this[0xc78] & 0xef);
  if (((byte)this[0xc91] & 0x20) != 0) {
    IOService::requireMaxInterruptDelay((uint)this);
  }
  iVar1 = IOAccelTaskList::getCount((IOAccelTaskList *)(this + 0xc58));
  if (((iVar1 != 0) && (*(int *)(this + 0xe0) == 0)) && (((byte)this[0xc78] & 0x10) == 0)) {
    *(undefined4 *)(this + 0xe0) = 1;
                    // WARNING: Could not recover jumptable at 0x000425f0. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0xf8) + 0x1d0))(*(long **)(this + 0xf8),100);
    return;
  }
  return;
}



// IOGraphicsAccelerator2::systemWillChangeSpeed()

void IOGraphicsAccelerator2::systemWillChangeSpeed(void)

{
  return;
}



// IOGraphicsAccelerator2::systemDidChangeSpeed()

void IOGraphicsAccelerator2::systemDidChangeSpeed(void)

{
  return;
}



// IOGraphicsAccelerator2::system_will_sleep(int, bool)

ulong __thiscall
IOGraphicsAccelerator2::system_will_sleep
          (IOGraphicsAccelerator2 *this,undefined8 param_1,uint param_2)

{
  char cVar1;
  int iVar2;
  uint uVar3;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined7 uVar5;
  ulong uVar4;
  char *pcVar6;
  uint uVar7;
  byte bVar8;
  
  _kernel_debug(0x850200a5,(ulong)*(uint *)(this + 0x178),(ulong)param_2,0,0,0);
  uVar5 = (undefined7)((ulong)this >> 8);
  if (param_2 == 0) {
    iVar2 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x378));
    bVar8 = 1;
    if (iVar2 != 0) {
      uVar7 = 0;
      bVar8 = 1;
      do {
        cVar1 = (**(code **)(**(long **)(this + 0x378) + 0x8c8))(*(long **)(this + 0x378),uVar7);
        if (cVar1 == '\0') {
          bVar8 = 0;
        }
        uVar7 = uVar7 + 1;
        uVar3 = IOAccelDisplayMachine::getFramebufferCount
                          (*(IOAccelDisplayMachine **)(this + 0x378));
      } while (uVar7 < uVar3);
    }
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    pcVar6 = "";
    (**(code **)(*(long *)this + 0x850))(this,"",0);
    IOAccelOrphanedMemoryPool::releaseOrphanedMemory
              ((IOAccelOrphanedMemoryPool *)(this + 0xb60),pcVar6,extraout_RDX);
    IOAccelOrphanedMemoryPool::releaseOrphanedMemory
              ((IOAccelOrphanedMemoryPool *)(this + 0xbc8),pcVar6,extraout_RDX_00);
    (**(code **)(*(long *)this + 0x858))(this,"",0);
    unlock_busy(this);
    _IOLockUnlock(*(undefined8 *)(this + 0x88));
    uVar4 = CONCAT71(uVar5,bVar8 != 0);
    _kernel_debug(0x850200a6,(ulong)*(uint *)(this + 0x178),(ulong)bVar8,0,0,0);
  }
  else {
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    (**(code **)(*(long *)this + 0x850))(this,"",0);
    if (((byte)this[0xc78] & 1) == 0) {
      (**(code **)(*(long *)this + 0x9d8))(this);
      if (((byte)this[0xc92] & 2) != 0) {
        this[0xc78] = (IOGraphicsAccelerator2)((byte)this[0xc78] | 8);
        if (*(int *)(this + 0x9d8) != 0) {
          (**(code **)(**(long **)(this + 0x9c8) + 0x218))();
        }
        *(undefined4 *)(this + 0x9d8) = 0;
      }
      this[0xc78] = (IOGraphicsAccelerator2)((byte)this[0xc78] | 1);
      if (*(int *)(this + 0xd8) != 0) {
        (**(code **)(**(long **)(this + 0x108) + 0x218))();
      }
      *(undefined8 *)(this + 0xd8) = 0;
      if (((byte)this[0xc92] & 8) == 0) {
        IOAccelEventMachine2::stopHardwareProgressTimer(*(IOAccelEventMachine2 **)(this + 0x380));
      }
    }
    (**(code **)(*(long *)this + 0x858))(this,"",0);
    unlock_busy(this);
    _IOLockUnlock(*(undefined8 *)(this + 0x88));
    _kernel_debug(0x850200a6,(ulong)*(uint *)(this + 0x178),1,0,0,0);
    uVar4 = CONCAT71(uVar5,1);
  }
  return uVar4 & 0xffffffff;
}



// IOGraphicsAccelerator2::system_did_wake(int, bool)

ulong __thiscall
IOGraphicsAccelerator2::system_did_wake
          (IOGraphicsAccelerator2 *this,undefined8 param_1,uint param_2)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  long *plVar5;
  IOAccelTask *this_00;
  undefined8 uVar6;
  undefined8 extraout_RDX;
  undefined7 uVar8;
  ulong uVar7;
  IOGraphicsAccelerator2 *pIVar9;
  byte bVar10;
  undefined1 auVar11 [16];
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  
  _kernel_debug(0x850200a9,(ulong)*(uint *)(this + 0x178),(ulong)param_2,0,0,0);
  uVar8 = (undefined7)((ulong)this >> 8);
  if (param_2 == 0) {
    iVar3 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x378));
    bVar10 = 1;
    if (iVar3 != 0) {
      uVar2 = 0;
      bVar10 = 1;
      do {
        cVar1 = (**(code **)(**(long **)(this + 0x378) + 0x8d0))(*(long **)(this + 0x378),uVar2);
        if (cVar1 == '\0') {
          bVar10 = 0;
        }
        uVar2 = uVar2 + 1;
        uVar4 = IOAccelDisplayMachine::getFramebufferCount
                          (*(IOAccelDisplayMachine **)(this + 0x378));
      } while (uVar2 < uVar4);
    }
    uVar7 = CONCAT71(uVar8,bVar10 != 0);
    _kernel_debug(0x850200aa,(ulong)*(uint *)(this + 0x178),(ulong)bVar10,0,0,0);
  }
  else {
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    (**(code **)(*(long *)this + 0x850))(this,"",0);
    uVar2 = *(uint *)(this + 0xc78);
    if ((uVar2 & 1) != 0) {
      (**(code **)(*(long *)this + 0x9e0))(this);
      uVar2 = *(uint *)(this + 0xc78) & 0xfffffffe;
      *(uint *)(this + 0xc78) = uVar2;
    }
    if (((byte)this[0xc92] & 2) != 0) {
      *(uint *)(this + 0xc78) = uVar2 & 0xfffffff7;
      local_58 = &DAT_aaaaaaaaaaaaaaaa;
      local_50 = &DAT_aaaaaaaaaaaaaaaa;
      local_48 = &DAT_aaaaaaaaaaaaaaaa;
      IOAccelTaskList::Iterator::Iterator((Iterator *)&local_58,(undefined8 *)(this + 0xc58));
      plVar5 = (long *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_58);
      if (plVar5 != (long *)0x0) {
        do {
          (**(code **)(*plVar5 + 0x28))(plVar5);
          plVar5 = (long *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_58);
        } while (plVar5 != (long *)0x0);
      }
      local_40 = &DAT_aaaaaaaaaaaaaaaa;
      local_38 = &DAT_aaaaaaaaaaaaaaaa;
      local_30 = &DAT_aaaaaaaaaaaaaaaa;
      pIVar9 = this + 0xc48;
      IOAccelTaskList::Iterator::Iterator((Iterator *)&local_40,(undefined8 *)pIVar9);
      auVar11 = IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_40);
      uVar6 = auVar11._8_8_;
      this_00 = auVar11._0_8_;
      if (this_00 != (IOAccelTask *)0x0) {
        do {
          IOAccelTask::prune_orphaned_mappings(this_00);
          auVar11 = IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_40);
          uVar6 = auVar11._8_8_;
          this_00 = auVar11._0_8_;
        } while (this_00 != (IOAccelTask *)0x0);
      }
      IOAccelOrphanedMemoryPool::pruneNonReusableOrphanedMemory
                ((IOAccelOrphanedMemoryPool *)(this + 0xb60),pIVar9,uVar6);
      IOAccelOrphanedMemoryPool::pruneNonReusableOrphanedMemory
                ((IOAccelOrphanedMemoryPool *)(this + 0xbc8),pIVar9,extraout_RDX);
    }
    (**(code **)(*(long *)this + 0x858))(this,"",0);
    unlock_busy(this);
    _IOLockUnlock(*(undefined8 *)(this + 0x88));
    _kernel_debug(0x850200aa,(ulong)*(uint *)(this + 0x178),1,0,0,0);
    uVar7 = CONCAT71(uVar8,1);
  }
  return uVar7 & 0xffffffff;
}



// IOGraphicsAccelerator2::system_will_change_speed()

void __thiscall IOGraphicsAccelerator2::system_will_change_speed(IOGraphicsAccelerator2 *this)

{
  _kernel_debug(0x850200ad,(ulong)*(uint *)(this + 0x178),0,0,0,0);
  _OSIncrementAtomic(this + 0x90);
  _IOLockLock(*(undefined8 *)(this + 0x88));
  _OSDecrementAtomic(this + 0x90);
  _OSIncrementAtomic(this + 0x158);
  (**(code **)(*(long *)this + 0x850))(this,"",0);
  if (((byte)this[0xc78] & 4) == 0) {
    (**(code **)(*(long *)this + 0x9e8))(this);
  }
  (**(code **)(*(long *)this + 0x858))(this,"",0);
  unlock_busy(this);
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  _kernel_debug(0x850200ae,(ulong)*(uint *)(this + 0x178),0,0,0,0);
  return;
}



// IOGraphicsAccelerator2::system_did_change_speed()

void __thiscall IOGraphicsAccelerator2::system_did_change_speed(IOGraphicsAccelerator2 *this)

{
  _kernel_debug(0x850200b1,(ulong)*(uint *)(this + 0x178),0,0,0,0);
  _OSIncrementAtomic(this + 0x90);
  _IOLockLock(*(undefined8 *)(this + 0x88));
  _OSDecrementAtomic(this + 0x90);
  _OSIncrementAtomic(this + 0x158);
  (**(code **)(*(long *)this + 0x850))(this,"",0);
  if (((byte)this[0xc78] & 4) == 0) {
    (**(code **)(*(long *)this + 0x9f0))(this);
  }
  (**(code **)(*(long *)this + 0x858))(this,"",0);
  unlock_busy(this);
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  _kernel_debug(0x850200b2,(ulong)*(uint *)(this + 0x178),0,0,0,0);
  return;
}



// IOGraphicsAccelerator2::message(unsigned int, IOService*, void*)

undefined8 __thiscall
IOGraphicsAccelerator2::message
          (IOGraphicsAccelerator2 *this,int param_1,undefined8 param_2,OSMetaClassBase *param_3)

{
  int iVar1;
  uint uVar2;
  long *plVar3;
  IOAccelContext2 *this_00;
  long lVar4;
  ulong uVar5;
  undefined8 uVar6;
  undefined8 uVar7;
  uint uVar8;
  undefined1 *local_30;
  
  if (param_1 < -0x1c008000) {
    if (param_1 == -0x1ffe9ffd) {
      _OSIncrementAtomic(this + 0x90);
      _IOLockLock(*(undefined8 *)(this + 0x88));
      _OSDecrementAtomic(this + 0x90);
      _OSIncrementAtomic(this + 0x158);
      (**(code **)(*(long *)this + 0x850))(this,"",0);
      if ((*(uint *)(this + 0xc78) >> 8 & 1) == 0) {
        *(uint *)(this + 0xc78) = *(uint *)(this + 0xc78) | 0x100;
        (**(code **)(*(long *)this + 0x278))(this,"SafeEjectRequested",1);
        lVar4 = *(long *)this;
        uVar6 = 0xe3ff80c8;
        goto LAB_000430ca;
      }
    }
    else {
      if (param_1 != -0x1ffe9ffb) {
        return 0;
      }
      _OSIncrementAtomic(this + 0x90);
      _IOLockLock(*(undefined8 *)(this + 0x88));
      _OSDecrementAtomic(this + 0x90);
      _OSIncrementAtomic(this + 0x158);
      (**(code **)(*(long *)this + 0x850))(this,"",0);
      if ((*(uint *)(this + 0xc78) >> 8 & 1) != 0) {
        *(uint *)(this + 0xc78) = *(uint *)(this + 0xc78) & 0xfffffeff;
        (**(code **)(*(long *)this + 0x2a0))(this,"SafeEjectRequested");
        lVar4 = *(long *)this;
        uVar6 = 0xe3ff80c9;
LAB_000430ca:
        (**(code **)(lVar4 + 0x740))(this,uVar6,0,0);
      }
    }
LAB_000430d4:
    lVar4 = *(long *)this;
    goto LAB_000430e1;
  }
  uVar6 = 0;
  switch(param_1) {
  case -0x1c008000:
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    (**(code **)(*(long *)this + 0x850))(this,"",0);
    *(undefined8 *)(this + 0x160) = param_2;
    *(OSMetaClassBase **)(this + 0x168) = param_3;
    if ((*(int *)(this + 0x158) == 1) && (*(int *)(this + 0x15c) == 0)) {
      lVar4 = *(long *)this;
      uVar6 = 0xe3ff8001;
    }
    else {
      param_3 = (OSMetaClassBase *)(ulong)*(uint *)(this + 0xdd4);
      lVar4 = *(long *)this;
      uVar6 = 0xe3ff8002;
    }
    (**(code **)(lVar4 + 0x738))(this,uVar6,param_2,param_3,0);
    lVar4 = *(long *)this;
    goto LAB_000430e1;
  case -0x1c007fff:
  case -0x1c007ffe:
    break;
  case -0x1c007ffd:
    uVar6 = 0;
    _kernel_debug(0x850200b8,(ulong)*(uint *)(this + 0x178),0,0,0,0);
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    (**(code **)(*(long *)this + 0x850))(this,"",0);
    if (*(int *)(this + 0x158) == 1) {
      this[0xc78] = (IOGraphicsAccelerator2)((byte)this[0xc78] | 4);
      (**(code **)(*(long *)this + 0x858))(this,"",0);
      unlock_busy(this);
      _IOLockUnlock(*(undefined8 *)(this + 0x88));
      iVar1 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x378));
      if (iVar1 != 0) {
        uVar6 = 0;
        uVar8 = 0;
        do {
          (**(code **)(**(long **)(this + 0x378) + 0x8c8))(*(long **)(this + 0x378),uVar8);
          uVar8 = uVar8 + 1;
          uVar2 = IOAccelDisplayMachine::getFramebufferCount
                            (*(IOAccelDisplayMachine **)(this + 0x378));
        } while (uVar8 < uVar2);
      }
    }
    else {
      (**(code **)(*(long *)this + 0x858))(this,"",0);
      unlock_busy(this);
      _IOLockUnlock(*(undefined8 *)(this + 0x88));
      uVar6 = 0xe00002bc;
    }
    break;
  case -0x1c007ffc:
    uVar8 = 0;
    _kernel_debug(0x850200b8,(ulong)*(uint *)(this + 0x178),0,0,0,0);
    iVar1 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0x378));
    if (iVar1 != 0) {
      do {
        (**(code **)(**(long **)(this + 0x378) + 0x8d0))(*(long **)(this + 0x378),uVar8);
        uVar8 = uVar8 + 1;
        uVar2 = IOAccelDisplayMachine::getFramebufferCount
                          (*(IOAccelDisplayMachine **)(this + 0x378));
      } while (uVar8 < uVar2);
    }
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    (**(code **)(*(long *)this + 0x850))(this,"",0);
    this[0xc78] = (IOGraphicsAccelerator2)((byte)this[0xc78] & 0xfb);
    lVar4 = *(long *)this;
LAB_000430e1:
    (**(code **)(lVar4 + 0x858))(this,"",0);
    unlock_busy(this);
    _IOLockUnlock(*(undefined8 *)(this + 0x88));
    uVar6 = 0;
    break;
  case -0x1c007ffb:
    uVar6 = 0;
    if (*(long *)(this + 0x160) != 0) {
      if ((*(int *)(this + 0x158) == 0) && (*(int *)(this + 0x15c) == 0)) {
        lVar4 = *(long *)this;
        uVar5 = *(ulong *)(this + 0x168);
        uVar7 = 0xe3ff8001;
      }
      else {
        *(undefined4 *)(this + 0x15c) = 0;
        uVar5 = (ulong)*(uint *)(this + 0xdd4);
        lVar4 = *(long *)this;
        uVar7 = 0xe3ff8002;
      }
      uVar6 = 0;
      (**(code **)(lVar4 + 0x738))(this,uVar7,*(long *)(this + 0x160),uVar5,0);
    }
    break;
  default:
    if (param_1 != -0x1c007ff1) {
      return 0;
    }
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    (**(code **)(*(long *)this + 0x850))(this,"",0);
    if (((param_3 != (OSMetaClassBase *)0x0) && (*(long *)(this + 0x160) != 0)) &&
       (plVar3 = (long *)OSMetaClassBase::safeMetaCast
                                   (param_3,*(OSMetaClass **)PTR_metaClass_0006b058),
       plVar3 != (long *)0x0)) {
      local_30 = &DAT_aaaaaaaaaaaaaaaa;
      IOAccelContextList::Iterator::Iterator((Iterator *)&local_30,(undefined8 *)(this + 0xa58));
      this_00 = (IOAccelContext2 *)
                IOAccelContextList::Iterator::getNextContext((Iterator *)&local_30);
      if (this_00 != (IOAccelContext2 *)0x0) {
        do {
          IOAccelContext2::add_task_surface_to_array(this_00,plVar3,'\x01');
          this_00 = (IOAccelContext2 *)
                    IOAccelContextList::Iterator::getNextContext((Iterator *)&local_30);
        } while (this_00 != (IOAccelContext2 *)0x0);
      }
    }
    goto LAB_000430d4;
  }
  return uVar6;
}



// IOGraphicsAccelerator2::sendAGCStatusMessage()

void __thiscall IOGraphicsAccelerator2::sendAGCStatusMessage(IOGraphicsAccelerator2 *this)

{
                    // WARNING: Could not recover jumptable at 0x000431a4. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0x140) + 0x1d8))(*(long **)(this + 0x140),0,0,0);
  return;
}



// IOGraphicsAccelerator2::kickDisplayPostTransaction()

void __thiscall IOGraphicsAccelerator2::kickDisplayPostTransaction(IOGraphicsAccelerator2 *this)

{
                    // WARNING: Could not recover jumptable at 0x000431c2. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0x148) + 0x1d8))(*(long **)(this + 0x148),0,0,0);
  return;
}



// IOGraphicsAccelerator2::request_power_up()

void __thiscall IOGraphicsAccelerator2::request_power_up(IOGraphicsAccelerator2 *this)

{
  _kernel_debug(0x850200b4,(ulong)*(uint *)(this + 0x178),0,0,0,0);
  if (*(long *)(this + 0x160) != 0) {
                    // WARNING: Could not recover jumptable at 0x00043214. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*(long *)this + 0x738))
              (this,0xe3ff8002,*(long *)(this + 0x160),*(undefined4 *)(this + 0xdd4),0);
    return;
  }
  return;
}



// IOGraphicsAccelerator2::increment_busy_count()

void __thiscall IOGraphicsAccelerator2::increment_busy_count(IOGraphicsAccelerator2 *this)

{
  int iVar1;
  
  iVar1 = _OSIncrementAtomic(this + 0x158);
  if (((iVar1 == 1) && (((byte)this[0xc78] & 4) != 0)) && (*(long *)(this + 0x160) != 0)) {
                    // WARNING: Could not recover jumptable at 0x0004326e. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*(long *)this + 0x738))
              (this,0xe3ff8002,*(long *)(this + 0x160),*(undefined4 *)(this + 0xdd4),0);
    return;
  }
  return;
}



// IOGraphicsAccelerator2::decrement_busy_count()

void __thiscall IOGraphicsAccelerator2::decrement_busy_count(IOGraphicsAccelerator2 *this)

{
  _OSDecrementAtomic(this + 0x158);
  return;
}



// IOGraphicsAccelerator2::lock_busy()

void __thiscall IOGraphicsAccelerator2::lock_busy(IOGraphicsAccelerator2 *this)

{
  _OSIncrementAtomic(this + 0x158);
  return;
}



// IOGraphicsAccelerator2::unlock_busy()

void __thiscall IOGraphicsAccelerator2::unlock_busy(IOGraphicsAccelerator2 *this)

{
  int iVar1;
  
  iVar1 = _OSDecrementAtomic(this + 0x158);
  if (((iVar1 == 1) && (((byte)this[0xc78] & 4) == 0)) && (*(long *)(this + 0x160) != 0)) {
                    // WARNING: Could not recover jumptable at 0x000432ed. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*(long *)this + 0x738))
              (this,0xe3ff8001,*(long *)(this + 0x160),*(undefined8 *)(this + 0x168),0);
    return;
  }
  return;
}



// IOGraphicsAccelerator2::acceleratorWaitEnabled()

undefined4 __thiscall IOGraphicsAccelerator2::acceleratorWaitEnabled(IOGraphicsAccelerator2 *this)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = *(uint *)(this + 0xc78);
  do {
    uVar2 = uVar1 & 2;
    if (uVar2 != 0) {
LAB_000433a8:
      return CONCAT31((int3)(uVar1 >> 8),uVar2 != 0);
    }
    if (*(int *)(this + 0xdc8) != 0) {
      uVar2 = 0;
      goto LAB_000433a8;
    }
    if ((uVar1 & 4) != 0) {
      request_power_up(this);
    }
    (**(code **)(*(long *)this + 0x858))(this,"",0);
    if (((byte)this[0xc78] & 4) == 0) {
      if (*(int *)(*(long *)(this + 0x378) + 0x10c) == 0) {
        waiting_for_fEnabled(*(undefined8 *)(this + 0x88),this);
      }
      else {
        waiting_for_fEnabled_after_displayModeChange(*(undefined8 *)(this + 0x88),this);
      }
    }
    else {
      waiting_for_fEnabled_after_poweredOffByAGC(*(undefined8 *)(this + 0x88),this);
    }
    (**(code **)(*(long *)this + 0x850))(this,"",0);
    uVar1 = *(uint *)(this + 0xc78);
  } while( true );
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// waiting_for_fEnabled_after_poweredOffByAGC(_IOLock*, IOGraphicsAccelerator2*)

void __cdecl waiting_for_fEnabled_after_poweredOffByAGC(undefined8 param_1,undefined8 param_2)

{
  _IOLockSleep_darwin14(param_1,param_2,0);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// waiting_for_fEnabled_after_displayModeChange(_IOLock*, IOGraphicsAccelerator2*)

void __cdecl waiting_for_fEnabled_after_displayModeChange(undefined8 param_1,undefined8 param_2)

{
  _IOLockSleep_darwin14(param_1,param_2,0);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// waiting_for_fEnabled(_IOLock*, IOGraphicsAccelerator2*)

void __cdecl waiting_for_fEnabled(undefined8 param_1,undefined8 param_2)

{
  _IOLockSleep_darwin14(param_1,param_2,0);
  return;
}



// IOGraphicsAccelerator2::lockPeerAccelerator(IOGraphicsAccelerator2*)

undefined8 __thiscall
IOGraphicsAccelerator2::lockPeerAccelerator
          (IOGraphicsAccelerator2 *this,IOGraphicsAccelerator2 *param_1)

{
  int iVar1;
  uintptr_t arg1;
  long lVar2;
  undefined8 uVar3;
  
  _OSIncrementAtomic();
  _OSIncrementAtomic();
  lVar2 = 0;
  do {
    iVar1 = _IOLockTryLock(*(undefined8 *)(param_1 + 0x88));
    if (iVar1 == 0) {
      if (___ktrace_kernel_enabled != 0) {
        arg1 = IORegistryEntry::getRegistryEntryID();
        _kernel_debug(0x8512001c,arg1,0,0,0,0);
      }
    }
    else {
      _OSIncrementAtomic(param_1 + 0x158);
      (**(code **)(*(long *)param_1 + 0x850))(param_1,"",0);
      if (*(int *)(param_1 + 0xdc8) != 0) {
        (**(code **)(*(long *)param_1 + 0x858))(param_1,"",0);
        unlock_busy(param_1);
        _IOLockUnlock(*(undefined8 *)(param_1 + 0x88));
        uVar3 = 0xe00002d7;
        goto LAB_00043598;
      }
      if ((*(uint *)(param_1 + 0xc78) & 2) != 0) {
        uVar3 = 0;
LAB_00043598:
        _OSDecrementAtomic(param_1 + 0x90);
        unlock_busy(this);
        return uVar3;
      }
      if ((*(uint *)(param_1 + 0xc78) & 4) != 0) {
        _OSIncrementAtomic(param_1 + 0x158);
        request_power_up(param_1);
      }
      (**(code **)(*(long *)param_1 + 0x858))(param_1,"",0);
      unlock_busy(param_1);
      _IOLockUnlock(*(undefined8 *)(param_1 + 0x88));
    }
    lVar2 = lVar2 + 1;
    if (lVar2 == 4) {
      (**(code **)(*(long *)this + 0x858))(this,"",0);
      unlock_busy(this);
      _IOLockUnlock(*(undefined8 *)(this + 0x88));
      _IOSleep(1);
      _OSIncrementAtomic(this + 0x90);
      _IOLockLock(*(undefined8 *)(this + 0x88));
      _OSDecrementAtomic(this + 0x90);
      _OSIncrementAtomic(this + 0x158);
      (**(code **)(*(long *)this + 0x850))(this,"",0);
      acceleratorWaitEnabled(this);
      lVar2 = 0;
    }
    else {
      _IODelay(0xfa);
    }
  } while( true );
}



// IOGraphicsAccelerator2::unlockPeerAccelerator(IOGraphicsAccelerator2*)

void __thiscall
IOGraphicsAccelerator2::unlockPeerAccelerator(undefined8 param_1_00,IOGraphicsAccelerator2 *param_2)

{
  (**(code **)(*(long *)param_2 + 0x858))(param_2,"",0);
  unlock_busy(param_2);
  _IOLockUnlock(*(undefined8 *)(param_2 + 0x88));
  return;
}



// IOGraphicsAccelerator2::acceleratorDidLock(char const*, int)

void IOGraphicsAccelerator2::acceleratorDidLock(void)

{
  uintptr_t arg1;
  
  if (___ktrace_kernel_enabled != 0) {
    arg1 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85120019,arg1,0,0,0,0);
    return;
  }
  return;
}



// IOGraphicsAccelerator2::acceleratorWillUnlock(char const*, int)

void IOGraphicsAccelerator2::acceleratorWillUnlock(void)

{
  uintptr_t arg1;
  
  if (___ktrace_kernel_enabled != 0) {
    arg1 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x8512001a,arg1,0,0,0,0);
    return;
  }
  return;
}



// IOGraphicsAccelerator2::isLockedByCurrentThread() const

undefined1 IOGraphicsAccelerator2::isLockedByCurrentThread(void)

{
  return 1;
}



// IOGraphicsAccelerator2::enableAccelerator()

void __thiscall
IOGraphicsAccelerator2::enableAccelerator
          (IOGraphicsAccelerator2 *this,undefined8 param_1,undefined8 param_2)

{
  if (((byte)this[0xc92] & 8) == 0) {
    IOAccelEventMachine2::startHardwareProgressTimerUnlocked
              (*(long *)(this + 0x380),param_1,param_2);
  }
  this[0xc78] = (IOGraphicsAccelerator2)((byte)this[0xc78] | 2);
  return;
}



// IOGraphicsAccelerator2::disableAccelerator()

void __thiscall IOGraphicsAccelerator2::disableAccelerator(IOGraphicsAccelerator2 *this)

{
  if (((byte)this[0xc92] & 8) == 0) {
    IOAccelEventMachine2::stopHardwareProgressTimerUnlocked
              (*(IOAccelEventMachine2 **)(this + 0x380));
  }
  this[0xc78] = (IOGraphicsAccelerator2)((byte)this[0xc78] & 0xfd);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOGraphicsAccelerator2::createAllocationList()

long * __cdecl IOGraphicsAccelerator2::createAllocationList(long *param_1)

{
  char cVar1;
  IOAccelAllocationInfo *this;
  OSMetaClassBase *pOVar2;
  IOAccelResource2 *this_00;
  long *plVar3;
  IOAccelSurface *this_01;
  undefined1 *local_a8;
  undefined1 *local_a0;
  undefined1 *local_98;
  undefined1 *local_90;
  undefined1 *local_88;
  undefined1 *local_80;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  
  this = IOAccelAllocationInfo::operator_new
                   ((IOAccelAllocationInfo *)(segment_command_00000420.segname + 8));
  IOAccelAllocationInfo::IOAccelAllocationInfo(this);
  if (this == (IOAccelAllocationInfo *)0x0) {
    plVar3 = (long *)0x0;
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: new IOAccelAllocationInfo failed\n",
                      "OSArray *IOGraphicsAccelerator2::createAllocationList()");
  }
  else {
    cVar1 = (**(code **)(*(long *)this + 0x118))(this,param_1);
    if (cVar1 == '\0') {
      plVar3 = (long *)0x0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: alloc_info->init failed\n",
                        "OSArray *IOGraphicsAccelerator2::createAllocationList()");
    }
    else {
      local_a8 = &DAT_aaaaaaaaaaaaaaaa;
      local_a0 = &DAT_aaaaaaaaaaaaaaaa;
      local_98 = &DAT_aaaaaaaaaaaaaaaa;
      IOAccelResidentMemorySet::ReverseIterator::ReverseIterator
                ((ReverseIterator *)&local_a8,param_1[0x141]);
      pOVar2 = (OSMetaClassBase *)
               IOAccelResidentMemorySet::ReverseIterator::getPrevMemory
                         ((ReverseIterator *)&local_a8);
      if (pOVar2 != (OSMetaClassBase *)0x0) {
        do {
          IOAccelAllocationInfo::addAllocationDescription(this,pOVar2);
          pOVar2 = (OSMetaClassBase *)
                   IOAccelResidentMemorySet::ReverseIterator::getPrevMemory
                             ((ReverseIterator *)&local_a8);
        } while (pOVar2 != (OSMetaClassBase *)0x0);
      }
      local_90 = &DAT_aaaaaaaaaaaaaaaa;
      local_88 = &DAT_aaaaaaaaaaaaaaaa;
      local_80 = &DAT_aaaaaaaaaaaaaaaa;
      IOAccelSysMemoryList::Iterator::Iterator((Iterator *)&local_90,param_1 + 0x166);
      pOVar2 = (OSMetaClassBase *)
               IOAccelSysMemoryList::Iterator::getNextMemory((Iterator *)&local_90);
      if (pOVar2 != (OSMetaClassBase *)0x0) {
        do {
          IOAccelAllocationInfo::addAllocationDescription(this,pOVar2);
          pOVar2 = (OSMetaClassBase *)
                   IOAccelSysMemoryList::Iterator::getNextMemory((Iterator *)&local_90);
        } while (pOVar2 != (OSMetaClassBase *)0x0);
      }
      local_30 = &DAT_aaaaaaaaaaaaaaaa;
      IOAccelVidMemoryList::Iterator::Iterator((Iterator *)&local_30,param_1 + 0x169);
      pOVar2 = (OSMetaClassBase *)
               IOAccelVidMemoryList::Iterator::getNextMemory((Iterator *)&local_30);
      if (pOVar2 != (OSMetaClassBase *)0x0) {
        do {
          IOAccelAllocationInfo::addAllocationDescription(this,pOVar2);
          pOVar2 = (OSMetaClassBase *)
                   IOAccelVidMemoryList::Iterator::getNextMemory((Iterator *)&local_30);
        } while (pOVar2 != (OSMetaClassBase *)0x0);
      }
      local_78 = &DAT_aaaaaaaaaaaaaaaa;
      local_70 = &DAT_aaaaaaaaaaaaaaaa;
      local_68 = &DAT_aaaaaaaaaaaaaaaa;
      IOAccelResourceList::ReverseIterator::ReverseIterator
                ((ReverseIterator *)&local_78,(long)(param_1 + 0x160));
      this_00 = (IOAccelResource2 *)
                IOAccelResourceList::ReverseIterator::getPrevResource((ReverseIterator *)&local_78);
      if (this_00 != (IOAccelResource2 *)0x0) {
        do {
          IOAccelResource2::describeAllocations(this_00,this);
          this_00 = (IOAccelResource2 *)
                    IOAccelResourceList::ReverseIterator::getPrevResource
                              ((ReverseIterator *)&local_78);
        } while (this_00 != (IOAccelResource2 *)0x0);
      }
      (**(code **)(*param_1 + 0xad8))(param_1,this);
      IOSurfaceRoot::describeAllocations
                ((void *)param_1[0x2e],
                 (_func_void_void_ptr_IOMemoryDescriptor_ptr_uint_int_ptr_int *)this);
      local_48 = &DAT_aaaaaaaaaaaaaaaa;
      IOAccelSharedList::Iterator::Iterator((Iterator *)&local_48,param_1 + 0x151);
      plVar3 = (long *)IOAccelSharedList::Iterator::getNextShared((Iterator *)&local_48);
      if (plVar3 != (long *)0x0) {
        do {
          (**(code **)(*plVar3 + 0x120))(plVar3,this);
          plVar3 = (long *)IOAccelSharedList::Iterator::getNextShared((Iterator *)&local_48);
        } while (plVar3 != (long *)0x0);
      }
      local_40 = &DAT_aaaaaaaaaaaaaaaa;
      IOAccelContextList::Iterator::Iterator((Iterator *)&local_40,param_1 + 0x14b);
      plVar3 = (long *)IOAccelContextList::Iterator::getNextContext((Iterator *)&local_40);
      if (plVar3 != (long *)0x0) {
        do {
          (**(code **)(*plVar3 + 0xb38))(plVar3,this);
          plVar3 = (long *)IOAccelContextList::Iterator::getNextContext((Iterator *)&local_40);
        } while (plVar3 != (long *)0x0);
      }
      local_38 = &DAT_aaaaaaaaaaaaaaaa;
      IOAccelSurfaceList::Iterator::Iterator((Iterator *)&local_38,param_1 + 0x155);
      this_01 = (IOAccelSurface *)
                IOAccelSurfaceList::Iterator::getNextSurface((Iterator *)&local_38);
      if (this_01 != (IOAccelSurface *)0x0) {
        do {
          IOAccelSurface::describe_allocations(this_01,this);
          this_01 = (IOAccelSurface *)
                    IOAccelSurfaceList::Iterator::getNextSurface((Iterator *)&local_38);
        } while (this_01 != (IOAccelSurface *)0x0);
      }
      local_60 = &DAT_aaaaaaaaaaaaaaaa;
      local_58 = &DAT_aaaaaaaaaaaaaaaa;
      local_50 = &DAT_aaaaaaaaaaaaaaaa;
      IOAccelTaskList::Iterator::Iterator((Iterator *)&local_60,param_1 + 0x189);
      plVar3 = (long *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_60);
      if (plVar3 != (long *)0x0) {
        do {
          (**(code **)(*plVar3 + 0x158))(plVar3,this);
          plVar3 = (long *)IOAccelTaskList::Iterator::getNextTask((Iterator *)&local_60);
        } while (plVar3 != (long *)0x0);
      }
      if ((IOAccelBufferMemoryDescriptorPool2 *)param_1[0x186] !=
          (IOAccelBufferMemoryDescriptorPool2 *)0x0) {
        IOAccelBufferMemoryDescriptorPool2::describeDriverAllocations
                  ((IOAccelBufferMemoryDescriptorPool2 *)param_1[0x186],this);
      }
      plVar3 = IOAccelAllocationInfo::copyToArray(this);
      if (plVar3 == (long *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: IOAccelAllocationInfo->copyToArray returned nil\n",
                          "OSArray *IOGraphicsAccelerator2::createAllocationList()");
      }
      IOAccelVidMemoryList::Iterator::~Iterator((Iterator *)&local_30);
    }
    (**(code **)(*(long *)this + 0x28))(this);
  }
  return plVar3;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// describeIOSurfaceAllocation(void*, IOMemoryDescriptor*, unsigned int, int*, int)

void __cdecl
describeIOSurfaceAllocation
          (IOAccelAllocationInfo *param_1,ulonglong *param_2,uint param_3,long param_4,uint param_5)

{
  IOAccelAllocationInfo::declareIOSurfaceBackingStore(param_1,param_2,param_3,param_4,param_5);
  return;
}



// IOGraphicsAccelerator2::createAllocationListTotals(OSDictionary*, IOAccelMemoryInfoAllocTotals*)

void __thiscall
IOGraphicsAccelerator2::createAllocationListTotals
          (IOGraphicsAccelerator2 *this,undefined8 param_2_00,long param_2)

{
  IOAccelMemory *pIVar1;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  
  local_60 = &DAT_aaaaaaaaaaaaaaaa;
  local_58 = &DAT_aaaaaaaaaaaaaaaa;
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelResidentMemorySet::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_60,*(long *)(this + 0xa08));
  pIVar1 = (IOAccelMemory *)
           IOAccelResidentMemorySet::ReverseIterator::getPrevMemory((ReverseIterator *)&local_60);
  if (pIVar1 != (IOAccelMemory *)0x0) {
    do {
      IOAccelMemory::addSizesToAllocationTotals(pIVar1,param_2);
      pIVar1 = (IOAccelMemory *)
               IOAccelResidentMemorySet::ReverseIterator::getPrevMemory
                         ((ReverseIterator *)&local_60);
    } while (pIVar1 != (IOAccelMemory *)0x0);
  }
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelSysMemoryList::Iterator::Iterator((Iterator *)&local_48,(undefined8 *)(this + 0xb30));
  pIVar1 = (IOAccelMemory *)IOAccelSysMemoryList::Iterator::getNextMemory((Iterator *)&local_48);
  if (pIVar1 != (IOAccelMemory *)0x0) {
    do {
      IOAccelMemory::addSizesToAllocationTotals(pIVar1,param_2);
      pIVar1 = (IOAccelMemory *)IOAccelSysMemoryList::Iterator::getNextMemory((Iterator *)&local_48)
      ;
    } while (pIVar1 != (IOAccelMemory *)0x0);
  }
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelVidMemoryList::Iterator::Iterator((Iterator *)&local_30,(long *)(this + 0xb48));
  pIVar1 = (IOAccelMemory *)IOAccelVidMemoryList::Iterator::getNextMemory((Iterator *)&local_30);
  if (pIVar1 != (IOAccelMemory *)0x0) {
    do {
      IOAccelMemory::addSizesToAllocationTotals(pIVar1,param_2);
      pIVar1 = (IOAccelMemory *)IOAccelVidMemoryList::Iterator::getNextMemory((Iterator *)&local_30)
      ;
    } while (pIVar1 != (IOAccelMemory *)0x0);
  }
  IOAccelVidMemoryList::Iterator::~Iterator((Iterator *)&local_30);
  return;
}



// IOGraphicsAccelerator2::describeDriverAllocations(IOAccelAllocationInfo*)

void IOGraphicsAccelerator2::describeDriverAllocations(void)

{
  return;
}



// IOGraphicsAccelerator2::kickFenceCollector()

void __thiscall IOGraphicsAccelerator2::kickFenceCollector(IOGraphicsAccelerator2 *this)

{
                    // WARNING: Could not recover jumptable at 0x00043b52. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0x128) + 0x1d8))(*(long **)(this + 0x128),0,0,0);
  return;
}



// IOGraphicsAccelerator2::getDataBufferKernelAddress(IOAccelResource2*)

void __thiscall
IOGraphicsAccelerator2::getDataBufferKernelAddress(undefined8 param_1_00,IOAccelResource2 *param_2)

{
  IOAccelResource2::getKernelData(param_2);
  return;
}



// IOGraphicsAccelerator2::releaseDataBufferKernelAddress(IOAccelResource2*)

void __thiscall
IOGraphicsAccelerator2::releaseDataBufferKernelAddress
          (undefined8 param_1_00,IOAccelResource2 *param_2)

{
  IOAccelResource2::releaseKernelData(param_2);
  return;
}



// IOGraphicsAccelerator2::freeToMapKernelMemory(IOAccelKernelMappedMemory*)

ulong __thiscall
IOGraphicsAccelerator2::freeToMapKernelMemory
          (IOGraphicsAccelerator2 *this,IOAccelKernelMappedMemory *param_1)

{
  bool bVar1;
  ulong uVar2;
  IOAccelKernelMappedMemory *pIVar3;
  ulong uVar4;
  int iVar5;
  IOAccelKernelMappedMemory *this_00;
  
  uVar2 = (**(code **)(*(long *)param_1 + 0x128))();
  while( true ) {
    pIVar3 = *(IOAccelKernelMappedMemory **)(this + 0x9e8);
    bVar1 = true;
    if (pIVar3 != (IOAccelKernelMappedMemory *)0x0) {
      iVar5 = *(int *)(this + 0x9f8);
      this_00 = (IOAccelKernelMappedMemory *)0x0;
      do {
        if ((*(int *)(pIVar3 + 0x38) == 0) && (0 < iVar5 - *(int *)(pIVar3 + 0x3c))) {
          this_00 = pIVar3;
          iVar5 = *(int *)(pIVar3 + 0x3c);
        }
        pIVar3 = *(IOAccelKernelMappedMemory **)(pIVar3 + 0x10);
      } while (pIVar3 != (IOAccelKernelMappedMemory *)0x0);
      if (this_00 != (IOAccelKernelMappedMemory *)0x0) {
        IOAccelKernelMappedMemory::unmap(this_00);
        bVar1 = false;
      }
    }
    if ((uVar2 <= (uint)(*(int *)(this + 0xa04) - *(int *)(this + 0xa00))) &&
       (uVar4 = IOAccelKernelMappedMemory::map(param_1), (char)uVar4 != '\0')) break;
    if (bVar1) {
      uVar2 = IOAccelKernelMappedMemory::map(param_1);
      return uVar2;
    }
  }
  return CONCAT71((int7)(uVar4 >> 8),1);
}



// IOGraphicsAccelerator2::insert_kernel_mapped_memory(IOAccelKernelMappedMemory*)

void __thiscall
IOGraphicsAccelerator2::insert_kernel_mapped_memory(IOGraphicsAccelerator2 *this,long *param_1)

{
  undefined8 *puVar1;
  int iVar2;
  
  param_1[2] = 0;
  puVar1 = *(undefined8 **)(this + 0x9f0);
  param_1[3] = (long)puVar1;
  *puVar1 = param_1;
  *(long **)(this + 0x9f0) = param_1 + 2;
  iVar2 = (**(code **)(*param_1 + 0x128))(param_1);
  *(int *)(this + 0xa00) = *(int *)(this + 0xa00) + iVar2;
  *(int *)(this + 0x9fc) = *(int *)(this + 0x9fc) + 1;
  return;
}



// IOGraphicsAccelerator2::remove_kernel_mapped_memory(IOAccelKernelMappedMemory*)

void __thiscall
IOGraphicsAccelerator2::remove_kernel_mapped_memory(IOGraphicsAccelerator2 *this,long *param_1)

{
  long lVar1;
  int iVar2;
  long *plVar3;
  char *pcVar4;
  
  lVar1 = param_1[2];
  if (lVar1 == 0) {
    plVar3 = (long *)param_1[3];
    if ((long *)*plVar3 == param_1) {
      *(long **)(this + 0x9f0) = plVar3;
LAB_00043c9d:
      *plVar3 = lVar1;
      iVar2 = (**(code **)(*param_1 + 0x128))(param_1);
      *(int *)(this + 0xa00) = *(int *)(this + 0xa00) - iVar2;
      *(int *)(this + 0x9fc) = *(int *)(this + 0x9fc) + -1;
      return;
    }
  }
  else {
    if (*(long **)(lVar1 + 0x18) != param_1 + 2) {
      pcVar4 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
      goto LAB_00043ccf;
    }
    if (*(long **)param_1[3] == param_1) {
      *(long **)(lVar1 + 0x18) = (long *)param_1[3];
      plVar3 = (long *)param_1[3];
      goto LAB_00043c9d;
    }
  }
  pcVar4 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_00043ccf:
                    // WARNING: Subroutine does not return
  _panic(pcVar4,param_1,0x14ac,"IOGraphicsAccelerator.cpp",0x14ac);
}



// IOGraphicsAccelerator2::ktraceStateChanged()

void __thiscall IOGraphicsAccelerator2::ktraceStateChanged(IOGraphicsAccelerator2 *this)

{
  IOAccelDisplayMachine::ktraceStateChanged(*(IOAccelDisplayMachine **)(this + 0x378));
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAcceleratorKDCallback(void*, kd_callback_type, void*)

void __cdecl IOAcceleratorKDCallback(undefined8 param_1,undefined4 param_2,long param_3)

{
  bool bVar1;
  byte bVar2;
  OSDictionary *pOVar3;
  long *plVar4;
  OSMetaClassBase *pOVar5;
  IOGraphicsAccelerator2 *this;
  ulong uVar6;
  uint uVar7;
  ulong uVar8;
  bool bVar9;
  
  switch(param_2) {
  case 0:
    if (___ktrace_kernel_enabled != 0) {
      return;
    }
    if ((*PTR__kdebug_enable_0006b0f8 & 1) == 0) {
      return;
    }
    bVar9 = true;
    if (___ktrace_enable_filter == '\0') {
      uVar8 = 0;
      do {
        uVar6 = uVar8;
        if (uVar6 == 0x1f) break;
        uVar8 = uVar6 + 1;
      } while ((&DAT_00082621)[uVar6] == '\0');
      bVar9 = uVar6 < 0x1f;
    }
    ___ktrace_kernel_enabled = (uint)(byte)(___ktrace_vendor_legacy_enabled != 0 | bVar9);
    IOAcceleratorKDCallback(void*,kd_callback_type,void*)::flushedSinceEnable = '\0';
    break;
  case 1:
    ___ktrace_kernel_enabled = 0;
    break;
  case 2:
    ___ktrace_end_of_last_flush = _mach_absolute_time();
    if (IOAcceleratorKDCallback(void*,kd_callback_type,void*)::flushedSinceEnable != '\0') {
      return;
    }
    IOAcceleratorKDCallback(void*,kd_callback_type,void*)::flushedSinceEnable = '\x01';
    bVar1 = true;
    bVar9 = false;
    goto LAB_00043ea1;
  case 3:
    uVar8 = 0;
    _DAT_00082638 = 0;
    _DAT_00082630 = 0;
    _DAT_00082628 = 0;
    ____ktrace_enable_filter = 0;
    do {
      if ((*(byte *)(param_3 + (uVar8 >> 3 | 0x10a0)) >> ((uint)uVar8 & 7) & 1) != 0) {
        (&___ktrace_enable_filter)[uVar8 >> 3] =
             (&___ktrace_enable_filter)[uVar8 >> 3] | (byte)(1 << ((byte)uVar8 & 7));
      }
      uVar7 = (uint)uVar8 + 1;
      uVar8 = (ulong)uVar7;
    } while (uVar7 != 0x100);
    ___ktrace_display_enabled = DAT_00082624 & 1;
    ___ktrace_vendor_legacy_enabled = *(byte *)(param_3 + 0xc2) >> 2 & 1;
    if ((*PTR__kdebug_enable_0006b0f8 & 1) != 0) {
      bVar9 = true;
      if (___ktrace_enable_filter == '\0') {
        uVar8 = 0;
        do {
          uVar6 = uVar8;
          if (uVar6 == 0x1f) break;
          uVar8 = uVar6 + 1;
        } while ((&DAT_00082621)[uVar6] == '\0');
        bVar9 = uVar6 < 0x1f;
      }
      ___ktrace_kernel_enabled = (uint)(byte)((char)___ktrace_vendor_legacy_enabled != '\0' | bVar9)
      ;
    }
    break;
  default:
    goto switchD_00043d20_default;
  }
  bVar9 = true;
  bVar1 = false;
LAB_00043ea1:
  pOVar3 = (OSDictionary *)IOService::serviceMatching("IOAccelerator",(OSDictionary *)0x0);
  if (pOVar3 != (OSDictionary *)0x0) {
    plVar4 = (long *)IOService::getMatchingServices(pOVar3);
    (**(code **)(*(long *)pOVar3 + 0x28))(pOVar3);
    if (plVar4 != (long *)0x0) {
      pOVar5 = (OSMetaClassBase *)(**(code **)(*plVar4 + 0x128))(plVar4);
      while (pOVar5 != (OSMetaClassBase *)0x0) {
        this = (IOGraphicsAccelerator2 *)
               OSMetaClassBase::safeMetaCast
                         (pOVar5,(OSMetaClass *)&IOGraphicsAccelerator2::gMetaClass);
        if (this != (IOGraphicsAccelerator2 *)0x0) {
          if (bVar9) {
            bVar2 = DAT_00082630 & 1;
            if ((____ktrace_enable_filter & 2) != 0) {
              bVar2 = 1;
            }
            **(uint **)(this + 0x9b0) = (uint)bVar2;
            (**(code **)(*(long *)this + 0xae8))(this);
          }
          if (bVar1) {
            IOGraphicsAccelerator2::emitFirstFlushEvents(this);
          }
        }
        pOVar5 = (OSMetaClassBase *)(**(code **)(*plVar4 + 0x128))(plVar4);
      }
                    // WARNING: Could not recover jumptable at 0x00043f6c. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*plVar4 + 0x28))(plVar4);
      return;
    }
  }
switchD_00043d20_default:
  return;
}



// IOGraphicsAccelerator2::updateGlobalCommPage()

void __thiscall IOGraphicsAccelerator2::updateGlobalCommPage(IOGraphicsAccelerator2 *this)

{
  byte bVar1;
  
  bVar1 = 1;
  if ((___ktrace_enable_filter & 2) == 0) {
    bVar1 = DAT_00082630 & 1;
  }
  **(uint **)(this + 0x9b0) = (uint)bVar1;
  return;
}



// IOGraphicsAccelerator2::createGlobalCommPageClientMapping(task*)

undefined8 __thiscall
IOGraphicsAccelerator2::createGlobalCommPageClientMapping(undefined8 param_1_00,ulonglong param_2)

{
  undefined8 uVar1;
  
  if (__global_comm_page_memory_descriptor != (task *)0x0) {
    uVar1 = IOMemoryDescriptor::createMappingInTask
                      (__global_comm_page_memory_descriptor,param_2,0,0x4001001,0);
    return uVar1;
  }
  return 0;
}



// IOGraphicsAccelerator2::getCommPageTraceEnable() const

undefined4 __thiscall IOGraphicsAccelerator2::getCommPageTraceEnable(IOGraphicsAccelerator2 *this)

{
  undefined4 uVar1;
  
  if (*(undefined4 **)(this + 0x9b0) == (undefined4 *)0x0) {
    uVar1 = 0;
  }
  else {
    uVar1 = **(undefined4 **)(this + 0x9b0);
  }
  return uVar1;
}



// IOGraphicsAccelerator2::audit_freed_resource(IOAccelResource2*)

void __thiscall
IOGraphicsAccelerator2::audit_freed_resource(IOGraphicsAccelerator2 *this,long param_1)

{
  IOAccelLegacyDisplayMachine *this_00;
  IOAccelSurface *this_01;
  undefined1 *local_28;
  
  this_00 = (IOAccelLegacyDisplayMachine *)
            OSMetaClassBase::safeMetaCast
                      (*(OSMetaClassBase **)(this + 0x378),
                       (OSMetaClass *)&IOAccelLegacyDisplayMachine::gMetaClass);
  if (this_00 != (IOAccelLegacyDisplayMachine *)0x0) {
    IOAccelLegacyDisplayMachine::audit_freed_resource(this_00,param_1);
  }
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelSurfaceList::Iterator::Iterator((Iterator *)&local_28,(undefined8 *)(this + 0xaa8));
  this_01 = (IOAccelSurface *)IOAccelSurfaceList::Iterator::getNextSurface((Iterator *)&local_28);
  if (this_01 != (IOAccelSurface *)0x0) {
    do {
      IOAccelSurface::audit_freed_resource(this_01,param_1);
      this_01 = (IOAccelSurface *)
                IOAccelSurfaceList::Iterator::getNextSurface((Iterator *)&local_28);
    } while (this_01 != (IOAccelSurface *)0x0);
  }
  return;
}



// IOGraphicsAccelerator2::scrubEvents()

void __thiscall IOGraphicsAccelerator2::scrubEvents(IOGraphicsAccelerator2 *this)

{
  long *plVar1;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  undefined1 *local_28;
  
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelSharedList::Iterator::Iterator((Iterator *)&local_28,(undefined8 *)(this + 0xa88));
  plVar1 = (long *)IOAccelSharedList::Iterator::getNextShared((Iterator *)&local_28);
  if (plVar1 != (long *)0x0) {
    do {
      (**(code **)(*plVar1 + 0x128))(plVar1);
      plVar1 = (long *)IOAccelSharedList::Iterator::getNextShared((Iterator *)&local_28);
    } while (plVar1 != (long *)0x0);
  }
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelResourceList::ReverseIterator::ReverseIterator
            ((ReverseIterator *)&local_40,(long)(this + 0xb00));
  plVar1 = (long *)IOAccelResourceList::ReverseIterator::getPrevResource
                             ((ReverseIterator *)&local_40);
  if (plVar1 != (long *)0x0) {
    do {
      (**(code **)(*plVar1 + 0x228))(plVar1);
      plVar1 = (long *)IOAccelResourceList::ReverseIterator::getPrevResource
                                 ((ReverseIterator *)&local_40);
    } while (plVar1 != (long *)0x0);
  }
  return;
}



// IOGraphicsAccelerator2::submitSwapCopy(IOAccelEvent*, IOAccelResource2*, IOAccelResource2*)

undefined8 IOGraphicsAccelerator2::submitSwapCopy(void)

{
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: unimplemented\n",
                    "virtual bool IOGraphicsAccelerator2::submitSwapCopy(IOAccelEvent *, IOAccelResource2 *, IOAccelResource2 *)"
                   );
  return 0;
}



// IOGraphicsAccelerator2::setProperties(OSObject*)

int __thiscall
IOGraphicsAccelerator2::setProperties(IOGraphicsAccelerator2 *this,OSMetaClassBase *param_1)

{
  int iVar1;
  uint uVar2;
  long *plVar3;
  long lVar4;
  char *pcVar5;
  OSMetaClassBase *pOVar6;
  long *plVar7;
  undefined8 uVar8;
  int iVar9;
  
  iVar1 = (**(code **)(PTR_vtable_0006b090 + 0x310))();
  if (iVar1 == -0x1ffffd39) {
    _OSIncrementAtomic(this + 0x90);
    _IOLockLock(*(undefined8 *)(this + 0x88));
    _OSDecrementAtomic(this + 0x90);
    _OSIncrementAtomic(this + 0x158);
    (**(code **)(*(long *)this + 0x850))(this,"",0);
    if (param_1 == (OSMetaClassBase *)0x0) {
      iVar1 = -0x1ffffd3e;
    }
    else {
      plVar3 = (long *)OSMetaClassBase::safeMetaCast
                                 (param_1,*(OSMetaClass **)PTR_metaClass_0006b020);
      iVar1 = 0;
      if (plVar3 != (long *)0x0) {
        lVar4 = (**(code **)(*plVar3 + 0x208))(plVar3,"SafeEjectRequest");
        if (lVar4 == 0) {
          iVar1 = 0;
        }
        else {
          iVar1 = -0x1ffffd39;
          if (((byte)this[0xc91] & 0x20) != 0) {
            iVar1 = 0;
            pcVar5 = (char *)(**(code **)(*(long *)this + 0x388))(this,0);
            _kprintf("%s: safe eject request\n",pcVar5);
            if ((*(uint *)(this + 0xc78) >> 8 & 1) == 0) {
              *(uint *)(this + 0xc78) = *(uint *)(this + 0xc78) | 0x100;
              (**(code **)(*(long *)this + 0x278))(this,"SafeEjectRequested",1);
              iVar1 = 0;
              (**(code **)(*(long *)this + 0x740))(this,0xe3ff80c8,0,0);
            }
          }
        }
        lVar4 = (**(code **)(*plVar3 + 0x208))(plVar3,"SafeEjectCancel");
        if (lVar4 != 0) {
          pcVar5 = (char *)(**(code **)(*(long *)this + 0x388))(this,0);
          _kprintf("%s: safe eject cancel\n",pcVar5);
          if ((*(uint *)(this + 0xc78) >> 8 & 1) != 0) {
            *(uint *)(this + 0xc78) = *(uint *)(this + 0xc78) & 0xfffffeff;
            (**(code **)(*(long *)this + 0x2a0))(this,"SafeEjectRequested");
            (**(code **)(*(long *)this + 0x740))(this,0xe3ff80c9,0,0);
          }
        }
        pOVar6 = (OSMetaClassBase *)(**(code **)(*plVar3 + 0x208))(plVar3,"PeerGroup");
        if ((pOVar6 != (OSMetaClassBase *)0x0) &&
           (plVar7 = (long *)OSMetaClassBase::safeMetaCast
                                       (pOVar6,*(OSMetaClass **)PTR_metaClass_0006b060),
           plVar7 != (long *)0x0)) {
          uVar8 = (**(code **)(*plVar7 + 0x150))(plVar7);
          *(undefined8 *)(this + 0xd10) = uVar8;
          (**(code **)(*(long *)this + 0x268))(this,"PeerGroup",plVar7);
        }
        pOVar6 = (OSMetaClassBase *)(**(code **)(*plVar3 + 0x208))(plVar3,"PeerIndex");
        iVar9 = iVar1;
        if ((pOVar6 != (OSMetaClassBase *)0x0) &&
           (plVar7 = (long *)OSMetaClassBase::safeMetaCast
                                       (pOVar6,*(OSMetaClass **)PTR_metaClass_0006b060),
           plVar7 != (long *)0x0)) {
          uVar2 = (**(code **)(*plVar7 + 0x148))(plVar7);
          iVar9 = -0x1ffffd3e;
          if (uVar2 < 4) {
            (**(code **)(*(long *)this + 0x268))(this,"PeerIndex",plVar7);
            *(short *)(this + 0xd18) = (short)uVar2;
            iVar9 = iVar1;
          }
        }
        pOVar6 = (OSMetaClassBase *)(**(code **)(*plVar3 + 0x208))(plVar3,"PeerCount");
        iVar1 = iVar9;
        if ((pOVar6 != (OSMetaClassBase *)0x0) &&
           (plVar3 = (long *)OSMetaClassBase::safeMetaCast
                                       (pOVar6,*(OSMetaClass **)PTR_metaClass_0006b060),
           plVar3 != (long *)0x0)) {
          uVar2 = (**(code **)(*plVar3 + 0x148))(plVar3);
          iVar1 = -0x1ffffd3e;
          if (uVar2 < 5) {
            (**(code **)(*(long *)this + 0x268))(this,"PeerCount",plVar3);
            *(short *)(this + 0xd1a) = (short)uVar2;
            iVar1 = iVar9;
          }
        }
      }
    }
    (**(code **)(*(long *)this + 0x858))(this,"",0);
    unlock_busy(this);
    _IOLockUnlock(*(undefined8 *)(this + 0x88));
  }
  return iVar1;
}



// IOGraphicsAccelerator2::configureReport(IOReportChannelList*, unsigned int, void*, void*)

undefined4 __thiscall
IOGraphicsAccelerator2::configureReport
          (IOGraphicsAccelerator2 *this,IOReportChannelList *param_1,uint param_2,void *param_3,
          void *param_4)

{
  undefined4 uVar1;
  
  _OSIncrementAtomic(this + 0x90);
  _IOLockLock(*(undefined8 *)(this + 0x88));
  _OSDecrementAtomic(this + 0x90);
  _OSIncrementAtomic(this + 0x158);
  (**(code **)(*(long *)this + 0x850))(this,"",0);
  uVar1 = IOAccelStatistics2::configure_report
                    (*(IOAccelStatistics2 **)(this + 0x388),param_1,param_2,param_3,param_4);
  (**(code **)(*(long *)this + 0x858))(this,"",0);
  unlock_busy(this);
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  return uVar1;
}



// IOGraphicsAccelerator2::updateReport(IOReportChannelList*, unsigned int, void*, void*)

undefined4 __thiscall
IOGraphicsAccelerator2::updateReport
          (IOGraphicsAccelerator2 *this,IOReportChannelList *param_1,uint param_2,void *param_3,
          void *param_4)

{
  undefined4 uVar1;
  
  _OSIncrementAtomic(this + 0x90);
  _IOLockLock(*(undefined8 *)(this + 0x88));
  _OSDecrementAtomic(this + 0x90);
  _OSIncrementAtomic(this + 0x158);
  (**(code **)(*(long *)this + 0x850))(this,"",0);
  uVar1 = IOAccelStatistics2::update_report
                    (*(IOAccelStatistics2 **)(this + 0x388),param_1,param_2,param_3,param_4);
  (**(code **)(*(long *)this + 0x858))(this,"",0);
  unlock_busy(this);
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  return uVar1;
}



// IOGraphicsAccelerator2::emitFirstFlushEvents()

void __thiscall IOGraphicsAccelerator2::emitFirstFlushEvents(IOGraphicsAccelerator2 *this)

{
  char *pcVar1;
  uintptr_t uVar2;
  long *plVar3;
  long lVar4;
  uintptr_t uVar5;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  uintptr_t local_30;
  
  _OSIncrementAtomic(this + 0x90);
  _IOLockLock(*(undefined8 *)(this + 0x88));
  _OSDecrementAtomic(this + 0x90);
  _OSIncrementAtomic(this + 0x158);
  (**(code **)(*(long *)this + 0x850))(this,"",0);
  local_30 = 0;
  if (*(long **)(this + 0x370) == (long *)0x0) {
    pcVar1 = "Undefined";
  }
  else {
    pcVar1 = (char *)(**(code **)(**(long **)(this + 0x370) + 0x148))();
  }
  _kernel_debug_string(0x850200dc,&local_30,pcVar1);
  uVar2 = IORegistryEntry::getRegistryEntryID();
  _kernel_debug(0x850200dc,uVar2,local_30,0,0,0);
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelChannelList::Iterator::Iterator((Iterator *)&local_48,(undefined8 *)(this + 0xc38));
  plVar3 = (long *)IOAccelChannelList::Iterator::getNextChannel((Iterator *)&local_48);
  if (plVar3 != (long *)0x0) {
    do {
      lVar4 = (**(code **)(*plVar3 + 0x170))(plVar3);
      if (lVar4 != 0) {
        local_30 = 0;
        _kernel_debug_string(0x850200dc,&local_30,lVar4);
        _kernel_debug(0x850200dc,plVar3[5],local_30,0,0,0);
      }
      plVar3 = (long *)IOAccelChannelList::Iterator::getNextChannel((Iterator *)&local_48);
    } while (plVar3 != (long *)0x0);
  }
  if (___ktrace_kernel_enabled != 0) {
    uVar2 = *(uintptr_t *)(this + 0x360);
    uVar5 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85120038,uVar2,uVar5,0,0,0);
    if (___ktrace_kernel_enabled != 0) {
      uVar2 = *(uintptr_t *)(this + 0x350);
      uVar5 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x85120034,uVar2,uVar5,0,0,0);
    }
  }
  (**(code **)(*(long *)this + 0x858))(this,"",0);
  unlock_busy(this);
  _IOLockUnlock(*(undefined8 *)(this + 0x88));
  return;
}



// IOGraphicsAccelerator2::createIODMACommand()

undefined8 __thiscall IOGraphicsAccelerator2::createIODMACommand(IOGraphicsAccelerator2 *this)

{
  undefined8 uVar1;
  
  if (((byte)this[0xcec] & 0x40) == 0) {
    return 0;
  }
  uVar1 = IODMACommand::withSpecification
                    (PTR_OutputHost64_0006b010,0x40,*(undefined8 *)PTR__page_size_0006b108,0,0,1,0,0
                    );
  return uVar1;
}



// IOGraphicsAccelerator2::getDMACommand()

long __thiscall IOGraphicsAccelerator2::getDMACommand(IOGraphicsAccelerator2 *this)

{
  IOGraphicsAccelerator2 *pIVar1;
  IOGraphicsAccelerator2 *pIVar2;
  long *plVar3;
  long lVar4;
  IOGraphicsAccelerator2 *pIVar5;
  
  if (((byte)this[0xcec] & 0x40) == 0) {
    lVar4 = 0;
  }
  else {
    _IOLockLock(*(undefined8 *)(this + 0xa18));
    pIVar1 = this + 0xa20;
    if (pIVar1 == *(IOGraphicsAccelerator2 **)(this + 0xa20)) {
      plVar3 = *(long **)(this + 0xa10);
      if (plVar3 == (long *)0x0) {
        lVar4 = 0;
      }
      else {
        lVar4 = (**(code **)(*plVar3 + 0x118))(plVar3,0);
      }
    }
    else {
      lVar4 = *(long *)(this + 0xa28);
      pIVar2 = *(IOGraphicsAccelerator2 **)(lVar4 + 0x18);
      pIVar5 = pIVar2 + 0x10;
      if (pIVar1 == pIVar2) {
        pIVar5 = pIVar1;
      }
      *(IOGraphicsAccelerator2 **)pIVar5 = pIVar1;
      *(IOGraphicsAccelerator2 **)(this + 0xa28) = pIVar2;
      *(undefined8 *)(lVar4 + 0x10) = 0;
      *(undefined8 *)(lVar4 + 0x18) = 0;
      *(int *)(this + 0xda0) = *(int *)(this + 0xda0) + -1;
    }
    _IOLockUnlock(*(undefined8 *)(this + 0xa18));
  }
  return lVar4;
}



// IOGraphicsAccelerator2::returnDMACommand(IODMACommand*)

void __thiscall IOGraphicsAccelerator2::returnDMACommand(IOGraphicsAccelerator2 *this,long *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  uint uVar2;
  IOGraphicsAccelerator2 *pIVar3;
  IOGraphicsAccelerator2 *pIVar4;
  
  if ((param_1 != (long *)0x0) && ((*(uint *)(this + 0xcec) & 0x40) != 0)) {
    _IOLockLock(*(undefined8 *)(this + 0xa18));
    uVar2 = *(uint *)(this + 0xda0);
    if (uVar2 < *(uint *)(this + 0xd1c)) {
      pIVar1 = this + 0xa20;
      pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0xa20);
      pIVar4 = pIVar3 + 0x10;
      if (pIVar1 == pIVar3) {
        pIVar4 = pIVar1;
      }
      *(long **)(pIVar4 + 8) = param_1;
      param_1[2] = (long)pIVar3;
      param_1[3] = (long)pIVar1;
      *(long **)(this + 0xa20) = param_1;
      *(uint *)(this + 0xda0) = uVar2 + 1;
    }
    else {
      (**(code **)(*param_1 + 0x28))(param_1);
    }
    _IOLockUnlock(*(undefined8 *)(this + 0xa18));
    return;
  }
  return;
}



// IOGraphicsAccelerator2::triage(char**, unsigned long long*)

void __thiscall
IOGraphicsAccelerator2::triage
          (undefined8 param_1_00,undefined8 param_2_00,undefined8 param_3,undefined8 param_4,
          undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8,
          IOGraphicsAccelerator2 *this,long *param_10,size_t *param_11)

{
  char *pcVar1;
  undefined8 uVar2;
  char *pcVar3;
  undefined8 extraout_XMM0_Qa;
  
  if (*(long **)(this + 0x370) == (long *)0x0) {
    pcVar1 = "Undefined";
  }
  else {
    pcVar1 = (char *)(**(code **)(**(long **)(this + 0x370) + 0x148))();
    param_1_00 = extraout_XMM0_Qa;
  }
  pcVar3 = "YES";
  if (*(int *)(this + 0xdc8) == 0) {
    pcVar3 = "NO";
  }
  uVar2 = glkBfLog(param_1_00,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,param_10,
                   param_11,
                   "Accelerator:\n    fModelName: \'%s\'\n    fDeviceTerminated: %s\n    fGPURestartCount: %u\n"
                   ,pcVar1,pcVar3,(ulong)*(uint *)(this + 0x9dc));
  if ((int)uVar2 != 0) {
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000449eb. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0x380) + 0x278))(*(long **)(this + 0x380),param_10,param_11);
  return;
}



// IOGraphicsAccelerator2::_RESERVEDIOGraphicsAccelerator3()

void IOGraphicsAccelerator2::_RESERVEDIOGraphicsAccelerator3(void)

{
  OSMetaClass::reservedCalled(0x825f0);
  return;
}



// IOGraphicsAccelerator2::_RESERVEDIOGraphicsAccelerator4()

void IOGraphicsAccelerator2::_RESERVEDIOGraphicsAccelerator4(void)

{
  OSMetaClass::reservedCalled(0x825f0);
  return;
}



// IOGraphicsAccelerator2::_RESERVEDIOGraphicsAccelerator5()

void IOGraphicsAccelerator2::_RESERVEDIOGraphicsAccelerator5(void)

{
  OSMetaClass::reservedCalled(0x825f0);
  return;
}



// IOGraphicsAccelerator2::getWorkLoop() const

undefined8 __thiscall IOGraphicsAccelerator2::getWorkLoop(IOGraphicsAccelerator2 *this)

{
  return *(undefined8 *)(this + 0xf0);
}



// IOGraphicsAccelerator2::tmpTotalVRAM()

undefined4 __thiscall IOGraphicsAccelerator2::tmpTotalVRAM(IOGraphicsAccelerator2 *this)

{
  return *(undefined4 *)(this + 0xca8);
}



// IOGraphicsAccelerator2::totalTextureMemory()

undefined8 __thiscall IOGraphicsAccelerator2::totalTextureMemory(IOGraphicsAccelerator2 *this)

{
  return *(undefined8 *)(this + 0xca8);
}



// IOGraphicsAccelerator2::MetaClass::~MetaClass()

void __thiscall IOGraphicsAccelerator2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelCommandDescriptor::init(IOGraphicsAccelerator2*)

void __cdecl IOAccelCommandDescriptor::init(long param_1)

{
  *(undefined8 *)(param_1 + 8) = 0;
  *(undefined8 *)(param_1 + 0x10) = 0;
  *(undefined8 *)(param_1 + 0x20) = 0;
  *(undefined8 *)(param_1 + 0x18) = 0;
  *(undefined4 *)(param_1 + 0x30) = 0;
  *(undefined8 *)(param_1 + 0x28) = 0;
  *(undefined8 *)(param_1 + 0x38) = 0;
  *(undefined8 *)(param_1 + 0x40) = 0;
  *(undefined8 *)(param_1 + 0x48) = 0;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOGraphicsAccelerator_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOGraphicsAccelerator2::gMetaClass,"IOGraphicsAccelerator2",
             (OSMetaClass *)PTR_gMetaClass_0006b028,0xdd8);
  _gMetaClass = &PTR__MetaClass_0007d3f8;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOGraphicsAccelerator2::gMetaClass);
  return;
}



// IOAccelRangeAllocator::MetaClass::MetaClass()

void __thiscall IOAccelRangeAllocator::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelRangeAllocator",(OSMetaClass *)PTR_gMetaClass_0006b068,0x70
            );
  *(undefined ***)this = &PTR__MetaClass_0007d690;
  return;
}



// IOAccelRangeAllocator::MetaClass::~MetaClass()

void __thiscall IOAccelRangeAllocator::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelRangeAllocator::IOAccelRangeAllocator(OSMetaClass const*)

void __thiscall
IOAccelRangeAllocator::IOAccelRangeAllocator(IOAccelRangeAllocator *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelRangeAllocator_0007d530;
  return;
}



// IOAccelRangeAllocator::IOAccelRangeAllocator(OSMetaClass const*)

void __thiscall
IOAccelRangeAllocator::IOAccelRangeAllocator(IOAccelRangeAllocator *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelRangeAllocator_0007d530;
  return;
}



// IOAccelRangeAllocator::~IOAccelRangeAllocator()

void __thiscall IOAccelRangeAllocator::~IOAccelRangeAllocator(IOAccelRangeAllocator *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelRangeAllocator::~IOAccelRangeAllocator()

void __thiscall IOAccelRangeAllocator::~IOAccelRangeAllocator(IOAccelRangeAllocator *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelRangeAllocator::~IOAccelRangeAllocator()

void __thiscall IOAccelRangeAllocator::~IOAccelRangeAllocator(IOAccelRangeAllocator *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelRangeAllocator_ktv,this,0x70);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelRangeAllocator::operator delete(void*, unsigned long)

void __cdecl IOAccelRangeAllocator::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelRangeAllocator_ktv,param_1,param_2);
  return;
}



// IOAccelRangeAllocator::getMetaClass() const

undefined1 * IOAccelRangeAllocator::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelRangeAllocator::MetaClass::MetaClass()

void __thiscall IOAccelRangeAllocator::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelRangeAllocator",(OSMetaClass *)PTR_gMetaClass_0006b068,0x70
            );
  *(undefined ***)this = &PTR__MetaClass_0007d690;
  return;
}



// IOAccelRangeAllocator::MetaClass::alloc() const

OSObject * IOAccelRangeAllocator::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelRangeAllocator_ktv,0x70);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelRangeAllocator::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelRangeAllocator_0007d530;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelRangeAllocator::operator new(unsigned long)

void * __thiscall IOAccelRangeAllocator::operator_new(IOAccelRangeAllocator *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelRangeAllocator_ktv,this);
  return pvVar1;
}



// IOAccelRangeAllocator::IOAccelRangeAllocator()

void __thiscall IOAccelRangeAllocator::IOAccelRangeAllocator(IOAccelRangeAllocator *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelRangeAllocator_0007d530;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelRangeAllocator::IOAccelRangeAllocator()

void __thiscall IOAccelRangeAllocator::IOAccelRangeAllocator(IOAccelRangeAllocator *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelRangeAllocator_0007d530;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelRangeAllocator::init()

undefined4 __thiscall IOAccelRangeAllocator::init(IOAccelRangeAllocator *this)

{
  undefined8 *puVar1;
  undefined4 uVar2;
  
  uVar2 = (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  if ((char)uVar2 != '\0') {
    puVar1 = *(undefined8 **)(this + 0x68);
    while (puVar1 != (undefined8 *)0x0) {
      puVar1 = (undefined8 *)*puVar1;
      *(undefined8 *)(this + 0x68) = 0;
      _IOFreeTypeImpl(&init()::kalloc_type_view_66);
      *(undefined8 **)(this + 0x68) = puVar1;
    }
  }
  return uVar2;
}



// IOAccelRangeAllocator::init_pool(unsigned long long)

undefined8 __thiscall
IOAccelRangeAllocator::init_pool(IOAccelRangeAllocator *this,undefined8 param_1)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  char cVar3;
  undefined8 *puVar4;
  undefined8 uVar5;
  long lVar6;
  
  cVar3 = (**(code **)(*(long *)this + 0x88))();
  if (cVar3 == '\0') {
LAB_00044e6a:
    uVar5 = 0;
  }
  else {
    *(undefined8 *)(this + 0x50) = 0;
    *(undefined8 *)(this + 0x60) = 0;
    puVar4 = *(undefined8 **)(this + 0x68);
    if (puVar4 == (undefined8 *)0x0) {
      puVar4 = (undefined8 *)_IOMallocTypeImpl(&init_pool(unsigned_long_long)::kalloc_type_view_87);
      *(undefined8 **)(this + 0x68) = puVar4;
      if (puVar4 == (undefined8 *)0x0) goto LAB_00044e6a;
      *puVar4 = 0;
    }
    puVar1 = puVar4 + 1;
    *(undefined8 **)(this + 0x50) = puVar1;
    puVar4[5] = 0;
    *(undefined4 *)(puVar4 + 6) = 0x80000000;
    puVar4[1] = puVar4 + 7;
    puVar4[2] = 0;
    *(undefined8 **)(this + 0x58) = puVar1;
    puVar4[0xb] = 0;
    *(undefined4 *)(puVar4 + 0xc) = 0;
    puVar2 = puVar4 + 0xd;
    puVar4[7] = puVar2;
    puVar4[8] = puVar1;
    puVar4[9] = 0;
    puVar4[10] = 0;
    puVar4[0x11] = 0;
    *(undefined4 *)(puVar4 + 0x12) = 0x80000000;
    puVar4[0xd] = puVar4 + 0x13;
    puVar4[0xe] = puVar4 + 7;
    puVar4[0xf] = puVar1;
    puVar4[0x10] = puVar1;
    puVar4[3] = puVar2;
    puVar4[4] = puVar2;
    puVar4[0x17] = param_1;
    *(undefined4 *)(puVar4 + 0x18) = 0;
    puVar4[0x13] = 0;
    puVar4[0x14] = puVar2;
    puVar4[0x15] = 0;
    puVar4[0x16] = 0;
    *(undefined8 **)(this + 0x60) = puVar4 + 0x19;
    puVar4[0x1d] = 0;
    *(undefined4 *)(puVar4 + 0x1e) = 0;
    puVar4[0x1a] = 0;
    lVar6 = 0;
    do {
      *(long *)((long)puVar4 + lVar6 + 200) = (long)puVar4 + lVar6 + 0xf8;
      *(undefined8 *)((long)puVar4 + lVar6 + 0xd8) = 0;
      *(undefined8 *)((long)puVar4 + lVar6 + 0xe0) = 0;
      *(undefined8 *)((long)puVar4 + lVar6 + 0x118) = 0;
      *(undefined4 *)((long)puVar4 + lVar6 + 0x120) = 0;
      *(undefined8 *)((long)puVar4 + lVar6 + 0x100) = 0;
      lVar6 = lVar6 + 0x30;
    } while (lVar6 != 0x510);
    puVar4[0xbb] = 0;
    uVar5 = CONCAT71((int7)((ulong)puVar4 >> 8),1);
  }
  return uVar5;
}



// IOAccelRangeAllocator::init_pool(unsigned long long, unsigned long long)

undefined8 __thiscall
IOAccelRangeAllocator::init_pool(IOAccelRangeAllocator *this,long param_1,long param_2)

{
  undefined8 uVar1;
  
  uVar1 = init_pool(this,param_1 + param_2);
  if ((char)uVar1 != '\0') {
    uVar1 = reserve(this,(long *)0x0,0,param_1);
    if ((char)uVar1 != '\0') {
      return CONCAT71((int7)((ulong)uVar1 >> 8),1);
    }
    (**(code **)(*(long *)this + 0x90))(this);
  }
  return 0;
}



// IOAccelRangeAllocator::reserve(IOAccelRangeElement*, unsigned long long, unsigned long long)

undefined8 __thiscall
IOAccelRangeAllocator::reserve(IOAccelRangeAllocator *this,long *param_1,ulong param_2,long param_3)

{
  long lVar1;
  long *plVar2;
  undefined8 *puVar3;
  bool bVar4;
  long *plVar5;
  ulong uVar6;
  
  if ((*(long *)(this + 0x60) != 0) || (bVar4 = add_to_stack(this), bVar4)) {
    if (param_1 == (long *)0x0) {
      param_1 = *(long **)(this + 0x60);
      lVar1 = *param_1;
      *(long *)(this + 0x60) = lVar1;
      if ((lVar1 == 0) && (bVar4 = add_to_stack(this), !bVar4)) {
        return 0;
      }
    }
    plVar2 = *(long **)(this + 0x58);
    plVar5 = (long *)plVar2[2];
    if (plVar5 != plVar2) {
      uVar6 = param_3 + param_2;
      do {
        if (((ulong)plVar5[4] <= param_2) && (lVar1 = *plVar5, uVar6 <= *(ulong *)(lVar1 + 0x20))) {
          puVar3 = (undefined8 *)plVar5[1];
          param_1[4] = param_2;
          *(undefined4 *)(param_1 + 5) = 0;
          param_1[2] = 0;
          param_1[3] = 0;
          if (plVar5[4] == param_2) {
            if (uVar6 == *(ulong *)(lVar1 + 0x20)) {
              *param_1 = lVar1;
              param_1[1] = (long)puVar3;
              *(long **)(lVar1 + 8) = param_1;
              *puVar3 = param_1;
              lVar1 = plVar5[3];
              *(long *)(lVar1 + 0x10) = plVar5[2];
              *(long *)(plVar5[2] + 0x18) = lVar1;
              plVar5[3] = 0;
              plVar5[2] = 0;
              *plVar5 = *(long *)(this + 0x60);
              plVar5[1] = 0;
              plVar5[4] = 0;
              *(undefined4 *)(plVar5 + 5) = 0;
              *(long **)(this + 0x60) = plVar5;
            }
            else {
              *param_1 = (long)plVar5;
              param_1[1] = (long)puVar3;
              plVar5[1] = (long)param_1;
              *puVar3 = param_1;
              plVar5[4] = uVar6;
            }
          }
          else if (uVar6 == *(ulong *)(lVar1 + 0x20)) {
            *param_1 = lVar1;
            param_1[1] = (long)plVar5;
            *(long **)(lVar1 + 8) = param_1;
            *plVar5 = (long)param_1;
          }
          else {
            plVar2 = *(long **)(this + 0x60);
            *(long *)(this + 0x60) = *plVar2;
            *(long **)(lVar1 + 8) = plVar2;
            *plVar2 = lVar1;
            plVar2[1] = (long)param_1;
            *param_1 = (long)plVar2;
            param_1[1] = (long)plVar5;
            *plVar5 = (long)param_1;
            plVar2[4] = uVar6;
            *(undefined4 *)(plVar2 + 5) = 0x80000000;
            plVar2[3] = (long)plVar5;
            plVar2[2] = plVar5[2];
            *(long **)(plVar5[2] + 0x18) = plVar2;
            plVar5[2] = (long)plVar2;
          }
          return CONCAT71((int7)((ulong)plVar5 >> 8),1);
        }
        plVar5 = (long *)plVar5[2];
      } while (plVar5 != plVar2);
    }
  }
  return 0;
}



// IOAccelRangeAllocator::init_pool(unsigned long long, unsigned long long, unsigned long long)

undefined8 __thiscall
IOAccelRangeAllocator::init_pool
          (IOAccelRangeAllocator *this,undefined8 param_1,ulong param_2,long param_3)

{
  undefined8 uVar1;
  
  uVar1 = init_pool(this,param_1);
  if ((char)uVar1 != '\0') {
    uVar1 = reserve(this,(long *)0x0,param_2,param_3);
    if ((char)uVar1 != '\0') {
      return CONCAT71((int7)((ulong)uVar1 >> 8),1);
    }
    (**(code **)(*(long *)this + 0x90))(this);
  }
  return 0;
}



// IOAccelRangeAllocator::free()

void __thiscall IOAccelRangeAllocator::free(IOAccelRangeAllocator *this)

{
  undefined8 *puVar1;
  
  puVar1 = *(undefined8 **)(this + 0x68);
  while (puVar1 != (undefined8 *)0x0) {
    puVar1 = (undefined8 *)*puVar1;
    *(undefined8 *)(this + 0x68) = 0;
    _IOFreeTypeImpl(&free()::kalloc_type_view_196);
    *(undefined8 **)(this + 0x68) = puVar1;
  }
                    // WARNING: Could not recover jumptable at 0x000450bc. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelRangeAllocator::add_to_stack()

bool __thiscall IOAccelRangeAllocator::add_to_stack(IOAccelRangeAllocator *this)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  long lVar3;
  
  puVar1 = (undefined8 *)_IOMallocTypeImpl(&add_to_stack()::kalloc_type_view_209);
  if (puVar1 != (undefined8 *)0x0) {
    *puVar1 = *(undefined8 *)(this + 0x68);
    *(undefined8 **)(this + 0x68) = puVar1;
    *(undefined8 **)(this + 0x60) = puVar1 + 1;
    puVar1[5] = 0;
    *(undefined4 *)(puVar1 + 6) = 0;
    puVar1[2] = 0;
    puVar2 = puVar1 + 7;
    lVar3 = 0x5d0;
    do {
      puVar2[-6] = puVar2;
      puVar2[-4] = 0;
      puVar2[-3] = 0;
      puVar2[4] = 0;
      *(undefined4 *)(puVar2 + 5) = 0;
      puVar2[1] = 0;
      puVar2 = puVar2 + 6;
      lVar3 = lVar3 + -0x30;
    } while (lVar3 != 0);
    puVar1[0xbb] = 0;
  }
  return puVar1 != (undefined8 *)0x0;
}



// IOAccelRangeAllocator::alloc(IOAccelRangeElement*, unsigned long long, unsigned long long)

undefined8 __thiscall
IOAccelRangeAllocator::alloc(IOAccelRangeAllocator *this,long *param_1,long param_2,long param_3)

{
  ulong uVar1;
  long lVar2;
  undefined8 *puVar3;
  long *plVar4;
  bool bVar5;
  long *plVar6;
  ulong uVar7;
  ulong uVar8;
  
  uVar8 = 0;
  if (param_3 != 0) {
    uVar8 = param_3 - 1;
  }
  if ((*(long *)(this + 0x60) != 0) || (bVar5 = add_to_stack(this), bVar5)) {
    plVar6 = *(long **)(this + 0x58);
    while (plVar6 = (long *)plVar6[2], plVar6 != *(long **)(this + 0x58)) {
      lVar2 = *plVar6;
      uVar7 = plVar6[4] + uVar8 & ~uVar8;
      uVar1 = uVar7 + param_2;
      if (uVar1 <= *(ulong *)(lVar2 + 0x20)) {
        puVar3 = (undefined8 *)plVar6[1];
        param_1[4] = uVar7;
        *(uint *)(param_1 + 5) = (uint)uVar8 & 0xffff;
        param_1[2] = 0;
        param_1[3] = 0;
        if (uVar7 == plVar6[4]) {
          if (uVar1 == *(ulong *)(lVar2 + 0x20)) {
            *param_1 = lVar2;
            param_1[1] = (long)puVar3;
            *(long **)(lVar2 + 8) = param_1;
            *puVar3 = param_1;
            lVar2 = plVar6[3];
            *(long *)(lVar2 + 0x10) = plVar6[2];
            *(long *)(plVar6[2] + 0x18) = lVar2;
            plVar6[3] = 0;
            plVar6[2] = 0;
            *plVar6 = *(long *)(this + 0x60);
            plVar6[1] = 0;
            plVar6[4] = 0;
            *(undefined4 *)(plVar6 + 5) = 0;
            *(long **)(this + 0x60) = plVar6;
          }
          else {
            *param_1 = (long)plVar6;
            param_1[1] = (long)puVar3;
            plVar6[1] = (long)param_1;
            *puVar3 = param_1;
            plVar6[4] = uVar1;
          }
        }
        else if (uVar1 == *(ulong *)(lVar2 + 0x20)) {
          *param_1 = lVar2;
          param_1[1] = (long)plVar6;
          *(long **)(lVar2 + 8) = param_1;
          *plVar6 = (long)param_1;
        }
        else {
          plVar4 = *(long **)(this + 0x60);
          *(long *)(this + 0x60) = *plVar4;
          *(long **)(lVar2 + 8) = plVar4;
          *plVar4 = lVar2;
          plVar4[1] = (long)param_1;
          *param_1 = (long)plVar4;
          param_1[1] = (long)plVar6;
          *plVar6 = (long)param_1;
          plVar4[4] = uVar1;
          *(undefined4 *)(plVar4 + 5) = 0x80000000;
          plVar4[3] = (long)plVar6;
          plVar4[2] = plVar6[2];
          *(long **)(plVar6[2] + 0x18) = plVar4;
          plVar6[2] = (long)plVar4;
        }
        return CONCAT71((int7)((ulong)plVar6 >> 8),1);
      }
    }
  }
  return 0;
}



// IOAccelRangeAllocator::alloc(IOAccelRangeElement*, unsigned long long, unsigned long long,
// unsigned long long, unsigned long long)

undefined8 __thiscall
IOAccelRangeAllocator::alloc
          (IOAccelRangeAllocator *this,long *param_1,long param_2,long param_3,ulong param_4,
          long param_5)

{
  ulong uVar1;
  long lVar2;
  undefined8 *puVar3;
  long *plVar4;
  bool bVar5;
  long *plVar6;
  ulong uVar7;
  ulong uVar8;
  
  if ((*(long *)(this + 0x60) != 0) || (bVar5 = add_to_stack(this), bVar5)) {
    uVar8 = 0;
    if (param_3 != 0) {
      uVar8 = param_3 - 1;
    }
    plVar6 = *(long **)(this + 0x58);
    do {
      plVar6 = (long *)plVar6[2];
      if (plVar6 == *(long **)(this + 0x58)) {
        return 0;
      }
      uVar7 = plVar6[4] + uVar8 & ~uVar8;
      if ((ulong)plVar6[4] < param_4) {
        uVar7 = param_4;
      }
      lVar2 = *plVar6;
      uVar1 = uVar7 + param_2;
    } while (*(ulong *)(lVar2 + 0x20) < uVar1);
    if (uVar1 <= param_5 + param_4) {
      puVar3 = (undefined8 *)plVar6[1];
      param_1[4] = uVar7;
      *(uint *)(param_1 + 5) = (uint)uVar8 & 0xffff;
      param_1[2] = 0;
      param_1[3] = 0;
      if (uVar7 == plVar6[4]) {
        if (uVar1 == *(ulong *)(lVar2 + 0x20)) {
          *param_1 = lVar2;
          param_1[1] = (long)puVar3;
          *(long **)(lVar2 + 8) = param_1;
          *puVar3 = param_1;
          lVar2 = plVar6[3];
          *(long *)(lVar2 + 0x10) = plVar6[2];
          *(long *)(plVar6[2] + 0x18) = lVar2;
          plVar6[3] = 0;
          plVar6[2] = 0;
          *plVar6 = *(long *)(this + 0x60);
          plVar6[1] = 0;
          plVar6[4] = 0;
          *(undefined4 *)(plVar6 + 5) = 0;
          *(long **)(this + 0x60) = plVar6;
        }
        else {
          *param_1 = (long)plVar6;
          param_1[1] = (long)puVar3;
          plVar6[1] = (long)param_1;
          *puVar3 = param_1;
          plVar6[4] = uVar1;
        }
      }
      else if (uVar1 == *(ulong *)(lVar2 + 0x20)) {
        *param_1 = lVar2;
        param_1[1] = (long)plVar6;
        *(long **)(lVar2 + 8) = param_1;
        *plVar6 = (long)param_1;
      }
      else {
        plVar4 = *(long **)(this + 0x60);
        *(long *)(this + 0x60) = *plVar4;
        *(long **)(lVar2 + 8) = plVar4;
        *plVar4 = lVar2;
        plVar4[1] = (long)param_1;
        *param_1 = (long)plVar4;
        param_1[1] = (long)plVar6;
        *plVar6 = (long)param_1;
        plVar4[4] = uVar1;
        *(undefined4 *)(plVar4 + 5) = 0x80000000;
        plVar4[3] = (long)plVar6;
        plVar4[2] = plVar6[2];
        *(long **)(plVar6[2] + 0x18) = plVar4;
        plVar6[2] = (long)plVar4;
      }
      return CONCAT71((int7)((ulong)plVar6 >> 8),1);
    }
  }
  return 0;
}



// IOAccelRangeAllocator::dealloc(IOAccelRangeElement*)

undefined8 __thiscall
IOAccelRangeAllocator::dealloc(IOAccelRangeAllocator *this,undefined8 *param_1)

{
  long lVar1;
  long *plVar2;
  bool bVar3;
  long *plVar4;
  undefined8 uVar5;
  long *plVar6;
  
  lVar1 = param_1[4];
  if ((*(long *)(this + 0x60) != 0) || (bVar3 = add_to_stack(this), bVar3)) {
    plVar4 = (long *)*param_1;
    plVar6 = (long *)param_1[1];
    param_1[1] = 0;
    *param_1 = 0;
    param_1[4] = 0;
    *(undefined4 *)(param_1 + 5) = 0;
    if ((int)(*(uint *)(plVar4 + 5) & *(uint *)(plVar6 + 5)) < 0) {
      *plVar6 = *plVar4;
      *(long **)(*plVar4 + 8) = plVar6;
      plVar6[2] = plVar4[2];
      *(long **)(plVar4[2] + 0x18) = plVar6;
      plVar4[2] = 0;
      plVar4[3] = 0;
      *plVar4 = *(undefined8 *)(this + 0x60);
      plVar4[1] = 0;
      plVar4[4] = 0;
      *(undefined4 *)(plVar4 + 5) = 0;
      *(long **)(this + 0x60) = plVar4;
    }
    else if ((int)*(uint *)(plVar6 + 5) < 0) {
      *plVar6 = (long)plVar4;
      plVar4[1] = (long)plVar6;
    }
    else if ((int)*(uint *)(plVar4 + 5) < 0) {
      *plVar6 = (long)plVar4;
      plVar4[1] = (long)plVar6;
      plVar4[4] = lVar1;
    }
    else {
      plVar2 = *(long **)(this + 0x60);
      *(long *)(this + 0x60) = *plVar2;
      *plVar6 = (long)plVar2;
      plVar4[1] = (long)plVar2;
      *plVar2 = (long)plVar4;
      plVar2[1] = (long)plVar6;
      plVar2[4] = lVar1;
      *(undefined4 *)(plVar2 + 5) = 0x80000000;
      do {
        plVar6 = (long *)plVar6[1];
      } while (-1 < (int)plVar6[5]);
      do {
        plVar4 = (long *)*plVar4;
        if (plVar4 == (long *)0x0) {
          plVar4 = *(long **)(this + 0x58);
          break;
        }
      } while (-1 < (int)plVar4[5]);
      plVar2[3] = (long)plVar6;
      plVar2[2] = (long)plVar4;
      plVar6[2] = (long)plVar2;
      plVar4[3] = (long)plVar2;
    }
    uVar5 = CONCAT71((int7)((ulong)plVar4 >> 8),1);
  }
  else {
    uVar5 = 0;
  }
  return uVar5;
}



// IOAccelRangeAllocator::total_free()

long __thiscall IOAccelRangeAllocator::total_free(IOAccelRangeAllocator *this)

{
  long lVar1;
  undefined8 *puVar2;
  undefined8 *puVar3;
  
  lVar1 = 0;
  puVar2 = *(undefined8 **)**(undefined8 **)(this + 0x50);
  for (puVar3 = (undefined8 *)**(undefined8 **)**(undefined8 **)(this + 0x50);
      puVar3 != (undefined8 *)0x0; puVar3 = (undefined8 *)*puVar3) {
    if (*(int *)(puVar2 + 5) < 0) {
      lVar1 = (lVar1 + puVar3[4]) - puVar2[4];
    }
    puVar2 = puVar3;
  }
  return lVar1;
}



// IOAccelRangeAllocator::log()

void __thiscall IOAccelRangeAllocator::log(IOAccelRangeAllocator *this)

{
  undefined *puVar1;
  long lVar2;
  int iVar3;
  char *pcVar4;
  long *plVar5;
  
  puVar1 = PTR___os_log_default_0006b0b8;
  plVar5 = *(long **)(this + 0x50);
  if (plVar5 != (long *)0x0) {
    lVar2 = *plVar5;
    if (lVar2 == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = 0;
      do {
        pcVar4 = "free";
        if (-1 < (int)plVar5[5]) {
          pcVar4 = "used";
        }
        __os_log_internal(0,puVar1,0x11,
                          "IOAccelRangeAllocator::log: %s[%d]: {offset, size} = {%llu, %llu}\n",
                          pcVar4,iVar3,plVar5[4],*(long *)(lVar2 + 0x20) - plVar5[4]);
        iVar3 = iVar3 + 1;
        plVar5 = (long *)*plVar5;
        lVar2 = *plVar5;
      } while (lVar2 != 0);
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "IOAccelRangeAllocator::log: term[%d]: {offset, size} = {%u, 0}\n",iVar3,
                      (int)plVar5[4]);
  }
  return;
}



// IOAccelRangeAllocator::logMax()

void __thiscall IOAccelRangeAllocator::logMax(IOAccelRangeAllocator *this)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  ulong uVar3;
  
  if (*(undefined8 **)(this + 0x50) != (undefined8 *)0x0) {
    puVar1 = *(undefined8 **)**(undefined8 **)(this + 0x50);
    uVar3 = 0;
    for (puVar2 = (undefined8 *)*puVar1; puVar2 != (undefined8 *)0x0; puVar2 = (undefined8 *)*puVar2
        ) {
      if ((*(int *)(puVar1 + 5) < 0) && (uVar3 < (ulong)(puVar2[4] - puVar1[4]))) {
        uVar3 = puVar2[4] - puVar1[4];
      }
      puVar1 = puVar2;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "IOAccelRangeAllocator::logMax: max free element size = %u\n");
  }
  return;
}



// IOAccelRangeAllocator::_RESERVEDIOAccelRangeAllocator0()

void IOAccelRangeAllocator::_RESERVEDIOAccelRangeAllocator0(void)

{
  OSMetaClass::reservedCalled(0x82660);
  return;
}



// IOAccelRangeAllocator::_RESERVEDIOAccelRangeAllocator1()

void IOAccelRangeAllocator::_RESERVEDIOAccelRangeAllocator1(void)

{
  OSMetaClass::reservedCalled(0x82660);
  return;
}



// IOAccelRangeAllocator::_RESERVEDIOAccelRangeAllocator2()

void IOAccelRangeAllocator::_RESERVEDIOAccelRangeAllocator2(void)

{
  OSMetaClass::reservedCalled(0x82660);
  return;
}



// IOAccelRangeAllocator::_RESERVEDIOAccelRangeAllocator3()

void IOAccelRangeAllocator::_RESERVEDIOAccelRangeAllocator3(void)

{
  OSMetaClass::reservedCalled(0x82660);
  return;
}



// IOAccelRangeAllocator::_RESERVEDIOAccelRangeAllocator4()

void IOAccelRangeAllocator::_RESERVEDIOAccelRangeAllocator4(void)

{
  OSMetaClass::reservedCalled(0x82660);
  return;
}



// IOAccelRangeAllocator::_RESERVEDIOAccelRangeAllocator5()

void IOAccelRangeAllocator::_RESERVEDIOAccelRangeAllocator5(void)

{
  OSMetaClass::reservedCalled(0x82660);
  return;
}



// IOAccelRangeAllocator::MetaClass::~MetaClass()

void __thiscall IOAccelRangeAllocator::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelRangeAllocator_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelRangeAllocator::gMetaClass,"IOAccelRangeAllocator",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x70);
  _gMetaClass = &PTR__MetaClass_0007d690;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelRangeAllocator::gMetaClass);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelCommandQueue::s_set_notification_port(IOAccelCommandQueue*, void*,
// IOExternalMethodArguments*)

undefined8 __cdecl
IOAccelCommandQueue::s_set_notification_port
          (IOAccelCommandQueue *param_1,undefined8 param_2,long param_3)

{
  undefined8 uVar1;
  
  if (*(long *)(param_3 + 0x10) != 0) {
    uVar1 = set_notification_port(param_1,*(long *)(param_3 + 0x10));
    return uVar1;
  }
  return 0xe00002c2;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelCommandQueue::s_submit_command_buffers(IOAccelCommandQueue*, void*,
// IOExternalMethodArguments*)

ulong __cdecl
IOAccelCommandQueue::s_submit_command_buffers
          (IOAccelCommandQueue *param_1,undefined8 param_2,long param_3)

{
  long *plVar1;
  long lVar2;
  ulong uVar3;
  ulong uVar4;
  
  plVar1 = *(long **)(param_3 + 0x40);
  if (plVar1 == (long *)0x0) {
    lVar2 = *(long *)(param_3 + 0x30);
    uVar3 = (ulong)*(uint *)(param_3 + 0x38);
    plVar1 = (long *)0x0;
  }
  else {
    plVar1 = (long *)(**(code **)(*plVar1 + 0x200))(plVar1,0x1000);
    if (plVar1 == (long *)0x0) {
      return 0xe00002c8;
    }
    lVar2 = (**(code **)(*plVar1 + 0x118))(plVar1);
    uVar3 = (**(code **)(**(long **)(param_3 + 0x40) + 0x1c8))();
  }
  if ((uVar3 < 8) ||
     (uVar4 = (uVar3 - 8) * -0x5555555555555555, 0xaaaaaaaaaaaaaaa < (uVar4 >> 3 | uVar4 << 0x3d)))
  {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: bad structureInputSize (%lld)\n",
                      "static IOReturn IOAccelCommandQueue::s_submit_command_buffers(IOAccelCommandQueue *, void *, IOExternalMethodArguments *)"
                     );
  }
  else {
    uVar3 = (uVar3 - 8) / 0x18;
    if (uVar3 == *(uint *)(lVar2 + 4)) {
      uVar3 = submit_command_buffers(param_1,lVar2);
      uVar3 = uVar3 & 0xffffffff;
      goto LAB_0004583f;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: command_buffer_count mismatch (%d,%lld)\n",
                      "static IOReturn IOAccelCommandQueue::s_submit_command_buffers(IOAccelCommandQueue *, void *, IOExternalMethodArguments *)"
                      ,(ulong)*(uint *)(lVar2 + 4),uVar3);
  }
  uVar3 = 0xe00002c2;
LAB_0004583f:
  if (plVar1 != (long *)0x0) {
    (**(code **)(*plVar1 + 0x28))(plVar1);
  }
  return uVar3;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelCommandQueue::s_set_priority_and_background(IOAccelCommandQueue*, void*,
// IOExternalMethodArguments*)

void __cdecl
IOAccelCommandQueue::s_set_priority_and_background
          (IOAccelCommandQueue *param_1,undefined8 param_2,long param_3)

{
  set_priority_and_background(param_1,**(uint **)(param_3 + 0x30),(*(uint **)(param_3 + 0x30))[1]);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelCommandQueue::s_get_command_queue_info(IOAccelCommandQueue*, void*,
// IOExternalMethodArguments*)

undefined8 __cdecl
IOAccelCommandQueue::s_get_command_queue_info(long param_1,undefined8 param_2,long param_3)

{
  **(undefined8 **)(param_3 + 0x58) = *(undefined8 *)(param_1 + 0x618);
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelCommandQueue::s_set_quality_of_service(IOAccelCommandQueue*, void*,
// IOExternalMethodArguments*)

void __cdecl
IOAccelCommandQueue::s_set_quality_of_service
          (IOAccelCommandQueue *param_1,undefined8 param_2,long param_3)

{
  set_quality_of_service(param_1,**(uint **)(param_3 + 0x30));
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelCommandQueue::s_set_get_info(IOAccelCommandQueue*, void*, IOExternalMethodArguments*)

void __cdecl
IOAccelCommandQueue::s_set_get_info(IOAccelCommandQueue *param_1,undefined8 param_2,long param_3)

{
  char *pcVar1;
  undefined8 *puVar2;
  
  pcVar1 = *(char **)(param_3 + 0x30);
  puVar2 = *(undefined8 **)(param_3 + 0x58);
  _strlcpy((char *)(param_1 + 0xd8),pcVar1,0x400);
  *puVar2 = *(undefined8 *)(param_1 + 0x618);
  set_quality_of_service(param_1,*(uint *)(pcVar1 + 0x400));
  return;
}



// IOAccelCommandQueue::MetaClass::MetaClass()

void __thiscall IOAccelCommandQueue::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelCommandQueue",(OSMetaClass *)&IOAccelSubmitter2::gMetaClass
             ,0x6a8);
  *(undefined ***)this = &PTR__MetaClass_0007e2c0;
  return;
}



// IOAccelCommandQueue::MetaClass::~MetaClass()

void __thiscall IOAccelCommandQueue::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelCommandQueue::IOAccelCommandQueue(OSMetaClass const*)

void __thiscall
IOAccelCommandQueue::IOAccelCommandQueue(IOAccelCommandQueue *this,OSMetaClass *param_1)

{
  IOAccelSubmitter2::IOAccelSubmitter2((IOAccelSubmitter2 *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelCommandQueue_0007d820;
  return;
}



// IOAccelCommandQueue::IOAccelCommandQueue(OSMetaClass const*)

void __thiscall
IOAccelCommandQueue::IOAccelCommandQueue(IOAccelCommandQueue *this,OSMetaClass *param_1)

{
  IOAccelSubmitter2::IOAccelSubmitter2((IOAccelSubmitter2 *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelCommandQueue_0007d820;
  return;
}



// IOAccelCommandQueue::~IOAccelCommandQueue()

void __thiscall IOAccelCommandQueue::~IOAccelCommandQueue(IOAccelCommandQueue *this)

{
  IOAccelSubmitter2::~IOAccelSubmitter2((IOAccelSubmitter2 *)this);
  return;
}



// IOAccelCommandQueue::~IOAccelCommandQueue()

void __thiscall IOAccelCommandQueue::~IOAccelCommandQueue(IOAccelCommandQueue *this)

{
  IOAccelSubmitter2::~IOAccelSubmitter2((IOAccelSubmitter2 *)this);
  return;
}



// IOAccelCommandQueue::~IOAccelCommandQueue()

void __thiscall IOAccelCommandQueue::~IOAccelCommandQueue(IOAccelCommandQueue *this)

{
  IOAccelSubmitter2::~IOAccelSubmitter2((IOAccelSubmitter2 *)this);
  _OSObject_typed_operator_delete(&IOAccelCommandQueue_ktv,this,0x6a8);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelCommandQueue::operator delete(void*, unsigned long)

void __cdecl IOAccelCommandQueue::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelCommandQueue_ktv,param_1,param_2);
  return;
}



// IOAccelCommandQueue::getMetaClass() const

undefined1 * IOAccelCommandQueue::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelCommandQueue::MetaClass::MetaClass()

void __thiscall IOAccelCommandQueue::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelCommandQueue",(OSMetaClass *)&IOAccelSubmitter2::gMetaClass
             ,0x6a8);
  *(undefined ***)this = &PTR__MetaClass_0007e2c0;
  return;
}



// IOAccelCommandQueue::MetaClass::alloc() const

IOAccelSubmitter2 * IOAccelCommandQueue::MetaClass::alloc(void)

{
  IOAccelSubmitter2 *this;
  
  this = (IOAccelSubmitter2 *)_OSObject_typed_operator_new(&IOAccelCommandQueue_ktv,0x6a8);
  IOAccelSubmitter2::IOAccelSubmitter2(this,(OSMetaClass *)&IOAccelCommandQueue::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelCommandQueue_0007d820;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelCommandQueue::operator new(unsigned long)

void * __thiscall IOAccelCommandQueue::operator_new(IOAccelCommandQueue *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelCommandQueue_ktv,this);
  return pvVar1;
}



// IOAccelCommandQueue::IOAccelCommandQueue()

void __thiscall IOAccelCommandQueue::IOAccelCommandQueue(IOAccelCommandQueue *this)

{
  IOAccelSubmitter2::IOAccelSubmitter2((IOAccelSubmitter2 *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelCommandQueue_0007d820;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelCommandQueue::IOAccelCommandQueue()

void __thiscall IOAccelCommandQueue::IOAccelCommandQueue(IOAccelCommandQueue *this)

{
  IOAccelSubmitter2::IOAccelSubmitter2((IOAccelSubmitter2 *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelCommandQueue_0007d820;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelCommandQueue::init(OSDictionary*, task*)

undefined4 __thiscall
IOAccelCommandQueue::init(IOAccelCommandQueue *this,undefined8 param_2_00,undefined8 param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  long lVar3;
  
  uVar1 = IOUserClient::init((OSDictionary *)this);
  if ((char)uVar1 != '\0') {
    _task_reference(param_2);
    *(undefined8 *)(this + 0x570) = param_2;
    lVar3 = _get_bsdtask_info(param_2);
    if (lVar3 == 0) {
      uVar2 = 0xffffffff;
    }
    else {
      uVar2 = _proc_pid(lVar3);
    }
    *(undefined4 *)(this + 0x578) = uVar2;
  }
  return uVar1;
}



// IOAccelCommandQueue::attach(IOService*)

undefined8 __thiscall
IOAccelCommandQueue::attach(IOAccelCommandQueue *this,OSMetaClassBase *param_1)

{
  char cVar1;
  long lVar2;
  undefined8 uVar3;
  
  cVar1 = IOService::attach((IOService *)this);
  if (cVar1 != '\0') {
    lVar2 = OSMetaClassBase::safeMetaCast
                      (param_1,(OSMetaClass *)&IOGraphicsAccelerator2::gMetaClass);
    *(long *)(this + 0x5c0) = lVar2;
    if (lVar2 != 0) {
      uVar3 = IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar2 + 0x388) + 0x58),0x67)
      ;
      return CONCAT71((int7)((ulong)uVar3 >> 8),1);
    }
  }
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelCommandQueue::start(IOService*)

bool __cdecl IOAccelCommandQueue::start(long *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined1 uVar2;
  undefined4 uVar3;
  bool bVar4;
  
  uVar3 = IOAccelSubmitter2::start(param_1);
  if ((char)uVar3 == '\0') {
    bVar4 = false;
  }
  else {
    pIVar1 = (IOGraphicsAccelerator2 *)param_1[0xb8];
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    uVar2 = (**(code **)(*param_1 + 0x9e0))(param_1);
    *(undefined1 *)(param_1 + 0xb1) = uVar2;
    pIVar1 = (IOGraphicsAccelerator2 *)param_1[0xb8];
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
    bVar4 = (char)param_1[0xb1] != '\0';
  }
  return bVar4;
}



// IOAccelCommandQueue::stopLocked()

void __thiscall IOAccelCommandQueue::stopLocked(IOAccelCommandQueue *this)

{
  if (*(int *)(this + 0x5a0) == 2) {
    *(undefined8 *)(this + 0x5a0) = 0x300000001;
    *(undefined4 *)(this + 0x5a8) = 0;
    (**(code **)(*(long *)this + 0xa28))(this,1);
  }
  (**(code **)(*(long *)this + 0x9e8))(this);
  this[0x588] = (IOAccelCommandQueue)0x0;
  IOSimpleReporter::incrementValue
            (*(ulonglong *)(*(long *)(*(long *)(this + 0x5c0) + 0x388) + 0x58),0x67);
  IOAccelSubmitter2::stop((long)this);
  (**(code **)(*(long *)this + 0x678))(this,*(undefined8 *)(this + 0x5c0));
                    // WARNING: Could not recover jumptable at 0x00045d36. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x28))(this);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelCommandQueue::stop(IOService*)

void __cdecl IOAccelCommandQueue::stop(IOAccelCommandQueue *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(param_1 + 0x5c0);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  stopLocked(param_1);
  pIVar1 = *(IOGraphicsAccelerator2 **)(param_1 + 0x5c0);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return;
}



// IOAccelCommandQueue::clientClose()

undefined8 __thiscall IOAccelCommandQueue::clientClose(IOAccelCommandQueue *this)

{
  if (this[0x588] == (IOAccelCommandQueue)0x0) {
    if (*(long *)(this + 0x5c0) != 0) {
      (**(code **)(*(long *)this + 0x678))();
    }
  }
  else {
    (**(code **)(*(long *)this + 0x600))(this,0);
  }
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelCommandQueue::finalize(unsigned int)

void __cdecl IOAccelCommandQueue::finalize(long *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  char cVar2;
  OSSet *pOVar3;
  
  if ((char)param_1[0xb1] != '\0') {
    cVar2 = IOService::isInactive();
    if (cVar2 != '\0') {
      pIVar1 = (IOGraphicsAccelerator2 *)param_1[0xb8];
      _OSIncrementAtomic(pIVar1 + 0x90);
      _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
      _OSDecrementAtomic(pIVar1 + 0x90);
      IOGraphicsAccelerator2::lock_busy(pIVar1);
      (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
      pOVar3 = (OSSet *)OSSet::withCapacity(1);
      (**(code **)(*param_1 + 0x990))(param_1,pOVar3);
      IOAccelShared2::add_orphaned_mappings((IOAccelShared2 *)param_1[0xb7],pOVar3);
      (**(code **)(*(long *)pOVar3 + 0x28))(pOVar3);
      pIVar1 = (IOGraphicsAccelerator2 *)param_1[0xb8];
      (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar1);
      _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
    }
  }
  IOService::finalize((uint)param_1);
  return;
}



// IOAccelCommandQueue::commandQueueStart()

undefined8 __thiscall IOAccelCommandQueue::commandQueueStart(IOAccelCommandQueue *this)

{
  uintptr_t arg1;
  uintptr_t arg2;
  uintptr_t arg3;
  undefined8 uVar1;
  
  *(undefined8 *)(this + 0x5a0) = 0x200000003;
  *(undefined4 *)(this + 0x5a8) = 0;
  *(undefined8 *)(this + 0x598) = 0x200000001;
  ___ZN19IOAccelFIFOChannel24initEP22IOGraphicsAccelerator2iii(*(long *)(this + 0x5b8));
  *(undefined8 *)(this + 0x58c) = 0;
  *(undefined2 *)(this + 0x594) = 0;
  *(undefined8 *)(this + 0x580) = 0;
  arg2 = _OSAddAtomic64(1,&___globalObjectIDCounter);
  *(uintptr_t *)(this + 0x618) = arg2;
  if (___ktrace_kernel_enabled != 0) {
    arg1 = *(uintptr_t *)(*(long *)(this + 0x5b8) + 0x30);
    arg3 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85120018,arg1,arg2,arg3,0,0);
  }
  *(undefined8 *)(this + 0x620) = 0;
  (**(code **)(**(long **)(*(long *)(this + 0x5c0) + 0x380) + 0x140))
            (*(long **)(*(long *)(this + 0x5c0) + 0x380),this + 0x5c8);
  (**(code **)(**(long **)(*(long *)(this + 0x5c0) + 0x380) + 0x140))
            (*(long **)(*(long *)(this + 0x5c0) + 0x380),this + 0x668);
  uVar1 = IOAccelCommandQueueList::addCommandQueue
                    ((IOAccelCommandQueueList *)(*(long *)(this + 0x5c0) + 0xa68),(long)this);
  return CONCAT71((int7)((ulong)uVar1 >> 8),1);
}



// IOAccelCommandQueue::commandQueueStop()

void __thiscall IOAccelCommandQueue::commandQueueStop(IOAccelCommandQueue *this)

{
  long *plVar1;
  undefined1 *local_30;
  undefined1 *local_28;
  undefined1 *local_20;
  
  if (*(long **)(this + 0x580) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x580) + 0x28))();
    *(undefined8 *)(this + 0x580) = 0;
  }
  if (*(IOAccelShared2 **)(this + 0x5b8) != (IOAccelShared2 *)0x0) {
    IOAccelShared2::decrement_ctx_refcount(*(IOAccelShared2 **)(this + 0x5b8));
    (**(code **)(**(long **)(this + 0x5b8) + 0x28))();
    *(undefined8 *)(this + 0x5b8) = 0;
  }
  if (*(long **)(this + 0x5b0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x5b0) + 0x28))();
    *(undefined8 *)(this + 0x5b0) = 0;
  }
  IOAccelCommandQueueList::removeCommandQueue
            ((IOAccelCommandQueueList *)(*(long *)(this + 0x5c0) + 0xa68),(long)this);
  IOAccelFenceMachine::cancelBlockFenceCallback
            (*(IOAccelFenceMachine **)(*(long *)(this + 0x5c0) + 0x390),(long)this);
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  local_28 = &DAT_aaaaaaaaaaaaaaaa;
  local_20 = &DAT_aaaaaaaaaaaaaaaa;
  IOAccelChannelList::Iterator::Iterator
            ((Iterator *)&local_30,(undefined8 *)(*(long *)(this + 0x5c0) + 0xc38));
  plVar1 = (long *)IOAccelChannelList::Iterator::getNextChannel((Iterator *)&local_30);
  if (plVar1 != (long *)0x0) {
    do {
      (**(code **)(*plVar1 + 0x168))(plVar1,this);
      plVar1 = (long *)IOAccelChannelList::Iterator::getNextChannel((Iterator *)&local_30);
    } while (plVar1 != (long *)0x0);
  }
  return;
}



// IOAccelCommandQueue::free()

void __thiscall IOAccelCommandQueue::free(IOAccelCommandQueue *this)

{
  if (*(long *)(this + 0x570) != 0) {
    _task_deallocate();
  }
  IOUserClient::free();
  return;
}



// IOAccelCommandQueue::connectClient(IOUserClient*)

undefined8 __thiscall
IOAccelCommandQueue::connectClient(IOAccelCommandQueue *this,OSMetaClassBase *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  IOAccelShared2 *this_00;
  long *plVar2;
  char cVar3;
  long lVar4;
  
  lVar4 = OSMetaClassBase::safeMetaCast
                    (param_1,(OSMetaClass *)&IOAccelSharedUserClient2::gMetaClass);
  if (lVar4 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Received a bogus share device.\n",
                      "virtual IOReturn IOAccelCommandQueue::connectClient(IOUserClient *)");
  }
  else {
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5c0);
    if (pIVar1 != *(IOGraphicsAccelerator2 **)(lVar4 + 0xf8)) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Received a bogus share device.\n",
                        "virtual IOReturn IOAccelCommandQueue::connectClient(IOUserClient *)");
      return 0xe00002c2;
    }
    if (*(long *)(lVar4 + 0xe0) == *(long *)(this + 0x570)) {
      _OSIncrementAtomic(pIVar1 + 0x90);
      _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
      _OSDecrementAtomic(pIVar1 + 0x90);
      IOGraphicsAccelerator2::lock_busy(pIVar1);
      (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
      if (*(long *)(this + 0x5b8) != 0) {
        pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5c0);
        (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
        IOGraphicsAccelerator2::unlock_busy(pIVar1);
        _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
        return 0xe00002c2;
      }
      this_00 = *(IOAccelShared2 **)(lVar4 + 0x100);
      *(IOAccelShared2 **)(this + 0x5b8) = this_00;
      IOAccelShared2::increment_ctx_refcount(this_00);
      (**(code **)(**(long **)(this + 0x5b8) + 0x20))();
      plVar2 = *(long **)(*(long *)(this + 0x5b8) + 0x88);
      *(long **)(this + 0x5b0) = plVar2;
      (**(code **)(*plVar2 + 0x20))();
      pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5c0);
      (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar1);
      _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
      cVar3 = (**(code **)(*(long *)this + 0x5c0))(this,*(undefined8 *)(this + 0x5c0));
      if (cVar3 != '\0') {
        (**(code **)(*(long *)this + 0x20))(this);
        return 0;
      }
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Start failed for new context\n",
                        "virtual IOReturn IOAccelCommandQueue::connectClient(IOUserClient *)");
    }
    else {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Shared device belongs to the wrong task.\n",
                        "virtual IOReturn IOAccelCommandQueue::connectClient(IOUserClient *)");
    }
  }
  return 0xe00002bc;
}



// IOAccelCommandQueue::set_notification_port(unsigned long long*)

undefined8 __thiscall
IOAccelCommandQueue::set_notification_port(IOAccelCommandQueue *this,undefined8 param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  char cVar2;
  IOAccelBlockFencePort2 *this_00;
  undefined8 uVar3;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5c0);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (*(long *)(this + 0x580) == 0) {
    this_00 = IOAccelBlockFencePort2::operator_new
                        ((IOAccelBlockFencePort2 *)&segment_command_00000020.filesize);
    IOAccelBlockFencePort2::IOAccelBlockFencePort2(this_00);
    *(IOAccelBlockFencePort2 **)(this + 0x580) = this_00;
    if (this_00 != (IOAccelBlockFencePort2 *)0x0) {
      cVar2 = (**(code **)(*(long *)this_00 + 0x118))(this_00,param_1);
      uVar3 = 0;
      if (cVar2 != '\0') goto LAB_00046456;
      if (*(long **)(this + 0x580) != (long *)0x0) {
        (**(code **)(**(long **)(this + 0x580) + 0x28))();
      }
    }
    *(undefined8 *)(this + 0x580) = 0;
    uVar3 = 0xe00002bd;
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: attempted to enable block fences while already enabled!\n",
                      "IOReturn IOAccelCommandQueue::set_notification_port(io_user_reference_t *)");
    uVar3 = 0xe00002c9;
  }
LAB_00046456:
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5c0);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar3;
}



// IOAccelCommandQueue::submit_command_buffers(IOAccelCommandQueueSubmitArgs const*)

undefined8 __thiscall
IOAccelCommandQueue::submit_command_buffers(IOAccelCommandQueue *this,long param_1)

{
  uint uVar1;
  uint uVar2;
  IOGraphicsAccelerator2 *pIVar3;
  uintptr_t uVar4;
  char cVar5;
  undefined4 uVar6;
  uintptr_t uVar7;
  ulong uVar8;
  undefined8 uVar9;
  
  pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0x5c0);
  _OSIncrementAtomic(pIVar3 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar3 + 0x88));
  _OSDecrementAtomic(pIVar3 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar3);
  (**(code **)(*(long *)pIVar3 + 0x850))(pIVar3,"",0);
  if (this[0x615] == (IOAccelCommandQueue)0x0) {
    this[0x615] = (IOAccelCommandQueue)0x1;
    uVar6 = IOGraphicsAccelerator2::acceleratorWaitEnabled
                      (*(IOGraphicsAccelerator2 **)(this + 0x5c0));
    if ((char)uVar6 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: %s device terminated\n",
                        "IOReturn IOAccelCommandQueue::submit_command_buffers(const sIOAccelCommandQueueSubmitArgs *)"
                       );
      this[0x594] = (IOAccelCommandQueue)0x1;
    }
    this[0x616] = (IOAccelCommandQueue)0x1;
    uVar9 = 0xe00002bc;
    if ((*(long *)(this + 0x580) != 0) &&
       (*(IOAccelShared2 **)(this + 0x5b8) != (IOAccelShared2 *)0x0)) {
      IOAccelShared2::processResourceDirtyCommands(*(IOAccelShared2 **)(this + 0x5b8));
      if (this[0x594] == (IOAccelCommandQueue)0x0) {
        *(undefined4 *)(this + 0x610) = 0;
        updatePriority(this);
      }
      else {
        *(undefined4 *)(this + 0x610) = 4;
      }
      if (*(int *)(param_1 + 4) != 0) {
        uVar8 = 0;
        do {
          cVar5 = (**(code **)(*(long *)this + 0xa78))(this);
          if (cVar5 == '\0') {
            uVar1 = *(uint *)(this + 0x578);
            uVar2 = *(uint *)(this + 0x5a0);
            uVar4 = *(uintptr_t *)(this + 0x618);
            uVar7 = IORegistryEntry::getRegistryEntryID();
            _kernel_debug(0x85020080,(ulong)uVar1,uVar4,(ulong)uVar2,uVar7,0);
            do {
              pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0x5c0);
              (**(code **)(*(long *)pIVar3 + 0x858))(pIVar3,"",0);
              IOGraphicsAccelerator2::unlock_busy(pIVar3);
              _IOLockUnlock(*(undefined8 *)(pIVar3 + 0x88));
              (**(code **)(*(long *)this + 0xa80))(this);
              pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0x5c0);
              _OSIncrementAtomic(pIVar3 + 0x90);
              _IOLockLock(*(undefined8 *)(pIVar3 + 0x88));
              _OSDecrementAtomic(pIVar3 + 0x90);
              IOGraphicsAccelerator2::lock_busy(pIVar3);
              (**(code **)(*(long *)pIVar3 + 0x850))(pIVar3,"",0);
              uVar6 = IOGraphicsAccelerator2::acceleratorWaitEnabled
                                (*(IOGraphicsAccelerator2 **)(this + 0x5c0));
              if ((char)uVar6 == '\0') {
                __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: %s device terminated\n",
                                  "IOReturn IOAccelCommandQueue::submit_command_buffers(const sIOAccelCommandQueueSubmitArgs *)"
                                 );
                this[0x594] = (IOAccelCommandQueue)0x1;
                *(undefined4 *)(this + 0x610) = 4;
              }
              updatePriority(this);
              cVar5 = (**(code **)(*(long *)this + 0xa78))(this);
            } while (cVar5 == '\0');
            uVar1 = *(uint *)(this + 0x578);
            uVar2 = *(uint *)(this + 0x5a0);
            uVar4 = *(uintptr_t *)(this + 0x618);
            uVar7 = IORegistryEntry::getRegistryEntryID();
            _kernel_debug(0x85020084,(ulong)uVar1,uVar4,(ulong)uVar2,uVar7,0);
          }
          submit_command_buffer
                    (this,*(uint *)(param_1 + 8 + uVar8 * 0x18),
                     *(uint *)(param_1 + 0xc + uVar8 * 0x18),
                     *(ulonglong *)(param_1 + 0x10 + uVar8 * 0x18),
                     *(ulonglong *)(param_1 + 0x18 + uVar8 * 0x18));
          uVar8 = uVar8 + 1;
        } while (uVar8 < *(uint *)(param_1 + 4));
      }
      pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0x5c0);
      *(undefined4 *)(pIVar3 + 0xdd4) = *(undefined4 *)(this + 0x578);
      IOGraphicsAccelerator2::enable_gart_collector(pIVar3);
      uVar9 = 0;
    }
    *(undefined2 *)(this + 0x615) = 0;
    IOAccelSubmitter2::updateLastSubmissionTime((IOAccelSubmitter2 *)this);
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: submit_command_buffers busy!\n",
                      "IOReturn IOAccelCommandQueue::submit_command_buffers(const sIOAccelCommandQueueSubmitArgs *)"
                     );
    uVar9 = 0xe00002e2;
  }
  pIVar3 = *(IOGraphicsAccelerator2 **)(this + 0x5c0);
  (**(code **)(*(long *)pIVar3 + 0x858))(pIVar3,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar3);
  _IOLockUnlock(*(undefined8 *)(pIVar3 + 0x88));
  return uVar9;
}



// IOAccelCommandQueue::updatePriority()

void __thiscall IOAccelCommandQueue::updatePriority(IOAccelCommandQueue *this)

{
  int iVar1;
  int iVar2;
  
  iVar1 = IOUserClient::clientHasPrivilege(*(void **)(this + 0x570),"foreground");
  iVar2 = 2;
  if (*(int *)(this + (ulong)(iVar1 == -0x1ffffd3f) * 4 + 0x598) != 3) {
    iVar2 = *(int *)(this + (ulong)(iVar1 == -0x1ffffd3f) * 4 + 0x598);
  }
  *(undefined4 *)(this + 0x5a8) = *(undefined4 *)(this + 0x578);
  if (iVar2 != *(int *)(this + 0x5a0)) {
    *(int *)(this + 0x5a0) = iVar2;
    (**(code **)(*(long *)this + 0xa28))(this);
  }
  if ((iVar1 == -0x1ffffd3f) && (*(int *)(this + 0x59c) == 3)) {
    *(undefined4 *)(this + 0x610) = 6;
  }
  return;
}



// IOAccelCommandQueue::submit_command_buffer(unsigned int, unsigned int, unsigned long long,
// unsigned long long)

void __thiscall
IOAccelCommandQueue::submit_command_buffer
          (IOAccelCommandQueue *this,uint param_1,uint param_2,ulonglong param_3,ulonglong param_4)

{
  IOAccelCommandQueue *pIVar1;
  char cVar2;
  uint64_t uVar3;
  long *plVar4;
  uint64_t uVar5;
  uint uVar6;
  
  uVar3 = _mach_absolute_time();
  uVar6 = *(uint *)(this + 0x610);
  if (uVar6 == 0) {
    plVar4 = (long *)(**(code **)(**(long **)(this + 0x5c0) + 0x8e8))();
    *(long **)(this + 0x608) = plVar4;
    if (plVar4 != (long *)0x0) {
      cVar2 = (**(code **)(*plVar4 + 0x128))
                        (plVar4,*(undefined8 *)(this + 0x5c0),this,*(undefined8 *)(this + 0x580),
                         param_4,0);
      plVar4 = *(long **)(this + 0x608);
      if (cVar2 != '\0') {
        *(undefined4 *)(plVar4 + 0x18) = 0;
        uVar6 = *(uint *)(this + 0x610);
        if (uVar6 == 0) {
          pIVar1 = this + 0x5c8;
          (**(code **)(**(long **)(*(long *)(this + 0x5c0) + 0x380) + 0x1b0))
                    (*(long **)(*(long *)(this + 0x5c0) + 0x380),pIVar1,plVar4 + 5);
          process_command_buffer(this,param_1,param_2);
          uVar5 = _mach_absolute_time();
          IOAccelFenceMachine::sendBlockFenceNotification
                    (*(undefined8 *)(*(long *)(this + 0x5c0) + 0x390),
                     (ulonglong *)(*(long *)(this + 0x580) + 0x10),param_3,0,*(uint *)(this + 0x610)
                     ,uVar3,uVar5);
          if (*(int *)(this + 0x610) != 0) {
            *(int *)(*(long *)(this + 0x608) + 0xc0) = *(int *)(this + 0x610);
          }
          (**(code **)(**(long **)(*(long *)(this + 0x5c0) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x5c0) + 0x380),this + 0x668,pIVar1);
          (**(code **)(**(long **)(*(long *)(this + 0x5c0) + 0x380) + 0x1b0))
                    (*(long **)(*(long *)(this + 0x5c0) + 0x380),pIVar1,
                     *(long *)(this + 0x608) + 0x68);
          IOAccelFenceMachine::addEventFence
                    (*(IOAccelFenceMachine **)(*(long *)(this + 0x5c0) + 0x390),(long)this,
                     *(long *)(this + 0x608));
          (**(code **)(*(long *)this + 0x998))(this,0);
          goto LAB_00046b08;
        }
        goto LAB_00046a91;
      }
      (**(code **)(*plVar4 + 0x28))(plVar4);
      *(long *)(this + 0x608) = 0;
    }
    *(undefined4 *)(this + 0x610) = 8;
    uVar6 = 8;
  }
LAB_00046a91:
  IOAccelFenceMachine::sendBlockFenceNotification
            (*(undefined8 *)(*(long *)(this + 0x5c0) + 0x390),
             (ulonglong *)(*(long *)(this + 0x580) + 0x10),param_3,0,uVar6,uVar3,uVar3);
  IOAccelFenceMachine::sendBlockFenceNotification
            (*(undefined8 *)(*(long *)(this + 0x5c0) + 0x390),
             (ulonglong *)(*(long *)(this + 0x580) + 0x10),param_4,0,*(uint *)(this + 0x610),uVar3,
             uVar3);
  if (*(long **)(this + 0x608) == (long *)0x0) {
    return;
  }
  (**(code **)(**(long **)(this + 0x608) + 0x28))();
LAB_00046b08:
  *(undefined8 *)(this + 0x608) = 0;
  return;
}



// IOAccelCommandQueue::set_priority_and_background(eIOAccelCommandQueuePriority,
// eIOAccelCommandQueuePriority)

undefined8 __thiscall
IOAccelCommandQueue::set_priority_and_background
          (IOAccelCommandQueue *this,uint param_1,uint param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined4 uVar2;
  undefined8 uVar3;
  
  uVar3 = 0xe00002c2;
  if (((param_1 < 6) && (param_1 != 3)) && ((param_2 & 0xfffffffe) == 2)) {
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5c0);
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    uVar3 = 0;
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    *(uint *)(this + 0x598) = param_1;
    *(uint *)(this + 0x59c) = param_2;
    uVar2 = IOGraphicsAccelerator2::acceleratorWaitEnabled
                      (*(IOGraphicsAccelerator2 **)(this + 0x5c0));
    if ((char)uVar2 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: %s device terminated\n",
                        "IOReturn IOAccelCommandQueue::set_priority_and_background(eIOAccelCommandQueuePriority, eIOAccelCommandQueuePriority)"
                        ,*(undefined8 *)(*(long *)(this + 0x5c0) + 0xc88));
      uVar3 = 0xe00002c0;
    }
    else {
      updatePriority(this);
    }
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5c0);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  }
  return uVar3;
}



// IOAccelCommandQueue::set_quality_of_service(eIOAccelCommandQueueQosLevel)

undefined8 __thiscall
IOAccelCommandQueue::set_quality_of_service(IOAccelCommandQueue *this,uint param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined8 uVar2;
  
  uVar2 = 0xe00002c2;
  if (param_1 < 5) {
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5c0);
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    uVar2 = 0;
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    *(uint *)(this + 0x5a4) = param_1;
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x5c0);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  }
  return uVar2;
}



// IOAccelCommandQueue::setPriority(eIOAccelCommandQueuePriority)

void IOAccelCommandQueue::setPriority(void)

{
  return;
}



// IOAccelCommandQueue::isOpportunisticWorkload() const

bool __thiscall IOAccelCommandQueue::isOpportunisticWorkload(IOAccelCommandQueue *this)

{
  bool bVar1;
  
  if (*(int *)(this + 0x5a0) == 2) {
    bVar1 = true;
  }
  else if (*(int *)(this + 0x5a0) == 1) {
    bVar1 = *(int *)(this + 0x5a4) == 4;
  }
  else {
    bVar1 = false;
  }
  return bVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelCommandQueue::externalMethod(unsigned int, IOExternalMethodArguments*,
// IOExternalMethodDispatch*, OSObject*, void*)

undefined8 __cdecl
IOAccelCommandQueue::externalMethod
          (void *param_1,IOExternalMethodArguments *param_2,IOExternalMethodDispatch *param_3,
          OSObject *param_4,void *param_5)

{
  undefined8 uVar1;
  
  if (*(char *)((long)param_1 + 0x588) == '\0') {
    return 0xe00002d8;
  }
  if ((uint)param_2 < 6) {
    param_5 = param_1;
    param_4 = (OSObject *)(&sCommandQueueMethods + ((ulong)param_2 & 0xffffffff) * 3);
  }
  uVar1 = IOUserClient::externalMethod((uint)param_1,param_2,param_3,param_4,param_5);
  return uVar1;
}



// IOAccelCommandQueue::processSegmentKernelCommand(IOAccelSegmentResourceList*,
// IOAccelKernelCommand const*, IOAccelKernelCommand const*)

void __thiscall
IOAccelCommandQueue::processSegmentKernelCommand
          (IOAccelCommandQueue *this,long param_1,int *param_2,long param_3)

{
  uint64_t *puVar1;
  uint uVar2;
  int iVar3;
  char *param1;
  uint64_t uVar4;
  undefined8 uVar5;
  long lVar6;
  IOAccelSysMemory *this_00;
  uint uVar7;
  ulong uVar8;
  ulong uVar9;
  
  iVar3 = *param_2;
  puVar1 = (uint64_t *)(param_2 + 2);
  uVar8 = param_3 - (long)puVar1;
  if (iVar3 == 2) {
    if (7 < uVar8) {
      uVar4 = _mach_absolute_time();
      *puVar1 = uVar4;
      return;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s:kIOAccelKernelCommandCollectTimeStamp: Insufficient bytes (%llu) for sIOAccelKernelCommandCollectTimeStampArgs (%lu)\n"
                      ,
                      "virtual void IOAccelCommandQueue::processSegmentKernelCommand(IOAccelSegmentResourceList *, const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                      ,uVar8,8);
  }
  else if (iVar3 == 1) {
    if (0xf < uVar8) {
      if (param_1 == 0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s:kIOAccelKernelCommandDebugLogResource: No segmentResourceList\n",
                          "virtual void IOAccelCommandQueue::processSegmentKernelCommand(IOAccelSegmentResourceList *, const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                         );
      }
      else if ((param_2[4] - 1U < *(uint *)(param_1 + 0xc)) &&
              (lVar6 = *(long *)(*(long *)(param_1 + 0x10) + (ulong)(param_2[4] - 1U) * 8),
              lVar6 != 0)) {
        this_00 = *(IOAccelSysMemory **)(lVar6 + 0x88);
        if (this_00 == (IOAccelSysMemory *)0x0) {
          this_00 = *(IOAccelSysMemory **)(lVar6 + 0x80);
        }
        uVar7 = param_2[5];
        uVar9 = (ulong)uVar7;
        uVar8 = (**(code **)(*(long *)this_00 + 0x120))(this_00);
        if (uVar8 < uVar9) {
          (**(code **)(*(long *)this_00 + 0x120))(this_00);
          uVar5 = (**(code **)(*(long *)this_00 + 0x120))(this_00);
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s:kIOAccelKernelCommandDebugLogResource: offset (%u) exceeds resource size (%llu)\n"
                            ,
                            "virtual void IOAccelCommandQueue::processSegmentKernelCommand(IOAccelSegmentResourceList *, const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                            ,uVar9,uVar5);
          goto LAB_00046e99;
        }
        lVar6 = IOAccelSysMemory::lockForCPUAccess(this_00,*(ulonglong *)(this + 0x570),1);
        if (lVar6 != 0) {
          uVar2 = param_2[3];
          iVar3 = (**(code **)(*(long *)this_00 + 0x120))(this_00);
          if (uVar2 < iVar3 - uVar7) {
            uVar7 = param_2[3];
          }
          else {
            iVar3 = (**(code **)(*(long *)this_00 + 0x120))(this_00);
            uVar7 = iVar3 - uVar7;
          }
          uVar8 = (ulong)(uVar7 + 1);
          param1 = (char *)_IOMallocData();
          if (uVar7 == 0xffffffff) {
            processSegmentKernelCommand();
            return;
          }
          _memmove(param1,(void *)(lVar6 + uVar9),(ulong)uVar7);
          param1[uVar7] = '\0';
          IOAccelSysMemory::unlockForCPUAccess(this_00,*(long *)(this + 0x570));
          if ((int)*puVar1 == 0) {
            _kprintf("kIOAccelKernelCommandDebugLogResource:%s \n",param1);
          }
          goto LAB_00046f02;
        }
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s:kIOAccelKernelCommandDebugLogResource: can\'t lock resource for CPU access\n"
                          ,
                          "virtual void IOAccelCommandQueue::processSegmentKernelCommand(IOAccelSegmentResourceList *, const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                         );
      }
      else {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s:kIOAccelKernelCommandDebugLogResource: Invalid segment_resource_id=0x%x in kIOAccelKernelCommandDebugLogResource args\n"
                          ,
                          "virtual void IOAccelCommandQueue::processSegmentKernelCommand(IOAccelSegmentResourceList *, const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                         );
      }
      *(undefined4 *)(this + 0x610) = 9;
      return;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s:kIOAccelKernelCommandDebugLogResource: Insufficient bytes (%llu) for sIOAccelKernelCommandDebugLogResourceArgs (%lu)\n"
                      ,
                      "virtual void IOAccelCommandQueue::processSegmentKernelCommand(IOAccelSegmentResourceList *, const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                      ,uVar8,0x10);
  }
  else if (iVar3 == 0) {
    if (7 < uVar8) {
      uVar9 = uVar8 - 8;
      if ((ulong)(uint)param_2[3] <= uVar8 - 8) {
        uVar9 = (ulong)(uint)param_2[3];
      }
      uVar8 = uVar9 + 1;
      param1 = (char *)_IOMallocData(uVar8);
      _memmove(param1,param_2 + 4,uVar9);
      param1[uVar9] = '\0';
      if (param_2[2] == 0) {
        _kprintf("kIOAccelKernelCommandDebugLog:%s\n",param1);
      }
LAB_00046f02:
      _IOFreeData(param1,uVar8);
      return;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s:kIOAccelKernelCommandDebugLog: Insufficient bytes (%llu) for sIOAccelKernelCommandDebugLogArgs (%lu)\n"
                      ,
                      "virtual void IOAccelCommandQueue::processSegmentKernelCommand(IOAccelSegmentResourceList *, const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                      ,uVar8,8);
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Invalid eIOAccelKernelCommands enum (command_id=%u command_size=%llubytes)\n"
                      ,
                      "virtual void IOAccelCommandQueue::processSegmentKernelCommand(IOAccelSegmentResourceList *, const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                      ,iVar3,uVar8);
  }
LAB_00046e99:
  *(undefined4 *)(this + 0x610) = 10;
  return;
}



// IOAccelCommandQueue::processSegmentKernelCommands(IOAccelSegmentResourceList*,
// IOAccelKernelCommand const*, IOAccelKernelCommand const*)

void __thiscall
IOAccelCommandQueue::processSegmentKernelCommands
          (IOAccelCommandQueue *this,undefined8 param_1,ulong param_2,ulong param_3)

{
  uint uVar1;
  ulong uVar2;
  ulong uVar3;
  
  while( true ) {
    if (param_3 <= param_2) {
      return;
    }
    if (*(int *)(this + 0x610) != 0) {
      return;
    }
    if (param_3 < param_2 + 8) break;
    uVar1 = *(uint *)(param_2 + 4);
    uVar2 = (ulong)uVar1;
    uVar3 = uVar2 + param_2;
    if ((((CARRY8(uVar2,param_2)) || (uVar1 < 8)) || (param_3 < uVar3)) || ((uVar1 & 3) != 0)) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Invalid command_size (%u) min=%lu currentCommand=%p kernelCommandEnd=%p\n"
                        ,
                        "virtual void IOAccelCommandQueue::processSegmentKernelCommands(IOAccelSegmentResourceList *, const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                        ,uVar2,8,param_2,param_3);
      goto LAB_000471f4;
    }
    (**(code **)(*(long *)this + 0xa08))(this,param_1,param_2,uVar3);
    param_2 = uVar3;
  }
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                    "%s: Insufficient space (%lu) to hold sIOAccelKernelCommand (%lu)\n",
                    "virtual void IOAccelCommandQueue::processSegmentKernelCommands(IOAccelSegmentResourceList *, const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                    ,param_3 - param_2,8);
LAB_000471f4:
  *(undefined4 *)(this + 0x610) = 10;
  return;
}



// IOAccelCommandQueue::processSegment(IOAccelSegmentResourceList*, IOAccelKernelCommand const*,
// IOAccelKernelCommand const*)

void __thiscall
IOAccelCommandQueue::processSegment
          (IOAccelCommandQueue *this,long *param_1,undefined8 param_2,undefined8 param_3)

{
  char cVar1;
  
  if (param_1 == (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0004727c. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*(long *)this + 0xa00))(this,0,param_2,param_3);
    return;
  }
  cVar1 = (**(code **)(*param_1 + 0x120))(param_1);
  if (cVar1 != '\0') {
    (**(code **)(*(long *)this + 0xa00))(this,param_1,param_2,param_3);
                    // WARNING: Could not recover jumptable at 0x00047258. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*param_1 + 0x128))(param_1);
    return;
  }
  *(undefined4 *)(this + 0x610) = 0xe00002bd;
  return;
}



// IOAccelCommandQueue::beginCoalescedSegment()

void __thiscall IOAccelCommandQueue::beginCoalescedSegment(IOAccelCommandQueue *this)

{
  *(undefined4 *)(this + 0x620) = 0;
  return;
}



// IOAccelCommandQueue::endCoalescedSegment()

void __thiscall IOAccelCommandQueue::endCoalescedSegment(IOAccelCommandQueue *this)

{
  *(undefined4 *)(this + 0x620) = 1;
  return;
}



// IOAccelCommandQueue::processAndSubmitCoalescedSegments(IOAccelCommandQueueSegment*, unsigned
// int*)

void __thiscall
IOAccelCommandQueue::processAndSubmitCoalescedSegments
          (IOAccelCommandQueue *this,long param_1,uint *param_2)

{
  uint uVar1;
  long lVar2;
  long lVar3;
  
  uVar1 = *param_2;
  (**(code **)(*(long *)this + 0xa10))();
  if ((ulong)uVar1 == 0) {
    (**(code **)(*(long *)this + 0xa18))(this);
  }
  else {
    lVar2 = (ulong)uVar1 << 5;
    lVar3 = 0;
    do {
      *(undefined8 *)(this + 0x4d8) = *(undefined8 *)(param_1 + 0x18 + lVar3);
      (**(code **)(*(long *)this + 0xa00))
                (this,*(undefined8 *)(param_1 + lVar3),*(undefined8 *)(param_1 + 8 + lVar3),
                 *(undefined8 *)(param_1 + 0x10 + lVar3));
      lVar3 = lVar3 + 0x20;
    } while (lVar2 != lVar3);
    (**(code **)(*(long *)this + 0xa18))(this);
    lVar3 = 0;
    do {
      (**(code **)(**(long **)(param_1 + lVar3) + 0x128))();
      (**(code **)(**(long **)(param_1 + lVar3) + 0x28))();
      *(undefined8 *)(param_1 + lVar3) = 0;
      lVar3 = lVar3 + 0x20;
    } while (lVar2 != lVar3);
  }
  *param_2 = 0;
  return;
}



// IOAccelCommandQueue::coalesceSegment(IOAccelCommandQueueSegment*, unsigned int*,
// IOAccelSegmentResourceList*, IOAccelKernelCommand const*, IOAccelKernelCommand const*)

void __thiscall
IOAccelCommandQueue::coalesceSegment
          (IOAccelCommandQueue *this,long param_1,uint *param_2,long *param_3,undefined8 param_4,
          undefined8 param_5)

{
  uint uVar1;
  char cVar2;
  long lVar3;
  
  lVar3 = *(long *)(this + 0x5c0);
  if (*param_2 == *(uint *)(lVar3 + 0xd08)) {
    processAndSubmitCoalescedSegments(this,param_1,param_2);
    lVar3 = *(long *)(this + 0x5c0);
  }
  *(byte *)(lVar3 + 0xc79) = *(byte *)(lVar3 + 0xc79) | 2;
  cVar2 = (**(code **)(*param_3 + 0x120))(param_3);
  if (cVar2 == '\0') {
    processAndSubmitCoalescedSegments(this,param_1,param_2);
    cVar2 = (**(code **)(*param_3 + 0x120))(param_3);
    if (cVar2 == '\0') {
      *(uint *)(*(long *)(this + 0x5c0) + 0xc78) =
           *(uint *)(*(long *)(this + 0x5c0) + 0xc78) & 0xfffffdff;
      cVar2 = (**(code **)(*param_3 + 0x120))(param_3);
      if (cVar2 == '\0') {
        *(undefined4 *)(this + 0x610) = 0xe00002bd;
        return;
      }
    }
  }
  *(uint *)(*(long *)(this + 0x5c0) + 0xc78) =
       *(uint *)(*(long *)(this + 0x5c0) + 0xc78) & 0xfffffdff;
  (**(code **)(*param_3 + 0x20))(param_3);
  uVar1 = *param_2;
  lVar3 = (ulong)uVar1 * 0x20;
  *(long **)(param_1 + lVar3) = param_3;
  *(undefined8 *)(param_1 + 8 + lVar3) = param_4;
  *(undefined8 *)(param_1 + 0x10 + lVar3) = param_5;
  *(undefined8 *)(param_1 + 0x18 + lVar3) = *(undefined8 *)(this + 0x4d8);
  *param_2 = uVar1 + 1;
  return;
}



// IOAccelCommandQueue::parseSegmentList(IOAccelShared2*, IOAccelSegmentResourceListHeader const*)

undefined8 IOAccelCommandQueue::parseSegmentList(void)

{
  return 0;
}



// IOAccelCommandQueue::parseSegmentList(IOAccelShared2*, IOAccelSegmentResourceListHeader const*,
// IOAccelDeviceShmem*)

void __thiscall
IOAccelCommandQueue::parseSegmentList
          (IOAccelCommandQueue *this,undefined8 param_1,undefined8 param_3_00,undefined8 param_3)

{
  *(undefined8 *)(*(long *)(this + 0x5b8) + 0x108) = param_3;
                    // WARNING: Could not recover jumptable at 0x00047493. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x9f0))();
  return;
}



// IOAccelCommandQueue::processCommandBuffer(unsigned int, unsigned int)

void __thiscall
IOAccelCommandQueue::processCommandBuffer(IOAccelCommandQueue *this,uint param_1,uint param_2)

{
  uint uVar1;
  uintptr_t uVar2;
  uintptr_t uVar3;
  undefined4 uVar4;
  undefined1 *puVar5;
  long *plVar6;
  long *plVar7;
  long lVar8;
  ulong uVar9;
  ulong uVar10;
  long lVar11;
  long lVar12;
  uintptr_t uVar13;
  uintptr_t uVar14;
  ulong uVar15;
  uintptr_t *puVar16;
  int iVar17;
  undefined1 *puVar18;
  uintptr_t *puVar19;
  long lVar20;
  ulong uVar21;
  uint local_24c;
  long *local_248;
  long *local_240;
  undefined1 local_238 [512];
  long local_38;
  
  local_38 = *(long *)PTR____stack_chk_guard_0006b0b0;
  *(int *)(this + 0x624) = *(int *)(this + 0x624) + 1;
  puVar5 = local_238;
  _memset(puVar5,0xaa,0x200);
  uVar21 = (ulong)*(uint *)(*(long *)(this + 0x5c0) + 0xd08);
  local_24c = 0;
  if ((uVar21 < 0x11) ||
     (puVar5 = (undefined1 *)
               _IOMallocTypeVarImpl
                         (&processCommandBuffer(unsigned_int,unsigned_int)::kalloc_type_view_950,
                          uVar21 << 5), puVar5 != (undefined1 *)0x0)) {
    plVar6 = (long *)IOAccelShared2::lookupDeviceShmem(*(IOAccelShared2 **)(this + 0x5b8),param_1);
    plVar7 = (long *)IOAccelShared2::lookupDeviceShmem(*(IOAccelShared2 **)(this + 0x5b8),param_2);
    if ((plVar7 == (long *)0x0) || ((plVar6 == (long *)0x0 || (2 < *(uint *)(this + 0x624))))) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: invalid segment shmem\n",
                        "virtual void IOAccelCommandQueue::processCommandBuffer(uint32_t, uint32_t)"
                       );
      *(undefined4 *)(this + 0x610) = 9;
LAB_0004785f:
      if ((puVar5 != (undefined1 *)0x0) && (puVar5 != local_238)) {
        _IOFreeTypeVarImpl(&processCommandBuffer(unsigned_int,unsigned_int)::kalloc_type_view_1097,
                           puVar5,uVar21 << 5);
      }
      goto LAB_00047948;
    }
    lVar8 = (**(code **)(*plVar6 + 0x118))(plVar6);
    if (lVar8 == 0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: kernelCommandBufferShmem (PID=%d) failed to map into kernel\n",
                        "virtual void IOAccelCommandQueue::processCommandBuffer(uint32_t, uint32_t)"
                        ,*(undefined4 *)(this + 0x578));
      if (puVar5 != local_238) {
        puVar18 = &processCommandBuffer(unsigned_int,unsigned_int)::kalloc_type_view_972;
LAB_00047933:
        _IOFreeTypeVarImpl(puVar18,puVar5,uVar21 << 5);
      }
    }
    else {
      uVar9 = (**(code **)(*plVar6 + 0x128))(plVar6);
      uVar10 = (**(code **)(*plVar7 + 0x128))(plVar7);
      lVar11 = (**(code **)(*plVar7 + 0x118))(plVar7);
      if (lVar11 != 0) {
        if (0xf < uVar10) {
          iVar17 = *(int *)(lVar11 + 8);
          if (0 < iVar17) {
            lVar12 = uVar10 - 0x10;
            puVar19 = (uintptr_t *)(lVar11 + 0x10);
            local_248 = plVar7;
            local_240 = plVar6;
            do {
              plVar6 = local_240;
              plVar7 = local_248;
              if (*(int *)(this + 0x610) != 0) break;
              if (lVar12 < 0x18) {
LAB_000479cb:
                uVar4 = 10;
LAB_000479d0:
                *(undefined4 *)(this + 0x610) = uVar4;
                break;
              }
              if (___ktrace_kernel_enabled != 0) {
                uVar13 = _OSAddAtomic64(1,&___globalObjectIDCounter);
                *(uintptr_t *)(this + 0x4d8) = uVar13;
                if (___ktrace_kernel_enabled != 0) {
                  uVar2 = *puVar19;
                  uVar3 = *(uintptr_t *)(this + 0x4e0);
                  uVar14 = IORegistryEntry::getRegistryEntryID();
                  plVar6 = local_240;
                  plVar7 = local_248;
                  _kernel_debug(0x85120044,uVar13,uVar3,uVar2,uVar14,0);
                }
              }
              uVar15 = (ulong)*(uint *)((long)puVar19 + 0x14) * 0x58;
              if (((int)(uVar15 >> 0x20) != 0) ||
                 (uVar15 = uVar15 & 0xffffffff,
                 puVar16 = (uintptr_t *)(uVar15 + (long)(puVar19 + 3)), plVar6 = local_240,
                 CARRY8(uVar15,(ulong)(puVar19 + 3)))) goto LAB_000479cb;
              uVar1 = (uint)puVar19[1];
              uVar15 = (ulong)*(uint *)((long)puVar19 + 0xc);
              if ((uVar9 < uVar15) ||
                 ((*(uint *)((long)puVar19 + 0xc) < uVar1 ||
                  ((uintptr_t *)(lVar11 + uVar10) < puVar16)))) {
                __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                  "%s: kernelCommandStart(%u) or kernelCommandEnd(%u) exceeds kernelCommandDataSize(%lu)\n"
                                  ,
                                  "virtual void IOAccelCommandQueue::processCommandBuffer(uint32_t, uint32_t)"
                                  ,(ulong)uVar1,uVar15,uVar9);
                plVar7 = local_248;
                plVar6 = local_240;
                goto LAB_000479cb;
              }
              plVar7 = (long *)(**(code **)(*(long *)this + 0xa30))
                                         (this,*(undefined8 *)(this + 0x5b8),puVar19,local_248);
              if (plVar7 == (long *)0x0) {
                uVar4 = 9;
                plVar7 = local_248;
                plVar6 = local_240;
                goto LAB_000479d0;
              }
              lVar20 = (ulong)uVar1 + lVar8;
              if ((*(byte *)(*(long *)(this + 0x5c0) + 0xcec) & 1) == 0) {
                (**(code **)(*(long *)this + 0x9f8))(this,plVar7,lVar20,uVar15 + lVar8);
              }
              else {
                coalesceSegment(this,(long)puVar5,&local_24c,plVar7,lVar20,uVar15 + lVar8);
              }
              (**(code **)(*plVar7 + 0x28))(plVar7);
              _kernel_debug(0x8502000c,*(uintptr_t *)(this + 0x4d8),*(uintptr_t *)(this + 0x4e0),
                            *puVar19,(ulong)*(uint *)(this + 0x578),0);
              uVar13 = *(uintptr_t *)(this + 0x4d8);
              uVar2 = *(uintptr_t *)(this + 0x4e0);
              uVar3 = *puVar19;
              uVar14 = IORegistryEntry::getRegistryEntryID();
              _kernel_debug(0x850200c4,uVar13,uVar2,uVar3,uVar14,0);
              lVar12 = (long)puVar19 + (lVar12 - (long)puVar16);
              iVar17 = iVar17 + -1;
              puVar19 = puVar16;
              plVar7 = local_248;
              plVar6 = local_240;
            } while (iVar17 != 0);
          }
          processAndSubmitCoalescedSegments(this,(long)puVar5,&local_24c);
        }
        (**(code **)(*plVar7 + 0x120))(plVar7);
        (**(code **)(*plVar6 + 0x120))(plVar6);
        goto LAB_0004785f;
      }
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: segmentListShmem (PID=%d) failed to map into kernel\n",
                        "virtual void IOAccelCommandQueue::processCommandBuffer(uint32_t, uint32_t)"
                        ,*(undefined4 *)(this + 0x578));
      (**(code **)(*plVar6 + 0x120))(plVar6);
      if (puVar5 != local_238) {
        puVar18 = &processCommandBuffer(unsigned_int,unsigned_int)::kalloc_type_view_986;
        goto LAB_00047933;
      }
    }
  }
  *(undefined4 *)(this + 0x610) = 8;
LAB_00047948:
  *(int *)(this + 0x624) = *(int *)(this + 0x624) + -1;
  if (*(long *)PTR____stack_chk_guard_0006b0b0 != local_38) {
                    // WARNING: Subroutine does not return
    ___stack_chk_fail();
  }
  return;
}



// IOAccelCommandQueue::processKernelCommand(IOAccelKernelCommand const*, IOAccelKernelCommand
// const*)

void __thiscall
IOAccelCommandQueue::processKernelCommand(IOAccelCommandQueue *this,int *param_1,long param_2)

{
  uint *puVar1;
  int iVar2;
  undefined8 *puVar3;
  char cVar4;
  int iVar5;
  OSObject *this_00;
  undefined8 uVar6;
  IOAccelMTLEvent2 *this_01;
  long lVar7;
  long *plVar8;
  ulong uVar9;
  ulonglong uVar10;
  uintptr_t uVar11;
  uintptr_t uVar12;
  IOAccelResource2 *pIVar13;
  IOAccelEventFence *pIVar14;
  undefined2 uVar15;
  ulong uVar16;
  uint uVar17;
  ulong uVar18;
  OSObject *local_90;
  undefined1 *local_88;
  undefined1 *local_80;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  ulonglong local_48;
  ulong local_40;
  ulong local_38;
  
  iVar2 = *param_1;
  puVar1 = (uint *)(param_1 + 2);
  uVar16 = param_2 - (long)puVar1;
  switch(iVar2) {
  case 3:
    if (7 < uVar16) {
      releaseAcceleratorLock(this);
      _IOSleep(*puVar1);
      acquireAcceleratorLock(this);
      return;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s:kIOAccelKernelCommandCollectTimeStamp: Insufficient bytes (%llu) for sIOAccelKernelCommandDebugSleepArgs (%lu)\n"
                      ,
                      "virtual void IOAccelCommandQueue::processKernelCommand(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                      ,uVar16,8);
    break;
  case 4:
  case 0xd:
    if (uVar16 < 0x10) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s:kIOAccelKernelCommandSignalSharedEvent: Insufficient bytes (%llu) for sIOAccelKernelCommandSignalOrWaitEventArgs (%lu)\n"
                        ,
                        "virtual void IOAccelCommandQueue::processKernelCommand(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                        ,uVar16,0x10);
      break;
    }
    uVar17 = param_1[2];
    uVar6 = *(undefined8 *)(param_1 + 4);
    local_90 = (OSObject *)0x0;
    iVar5 = IOUserClient::copyObjectForPortNameInTask(*(task **)(this + 0x570),uVar17,&local_90);
    if ((iVar5 == 0) &&
       (lVar7 = OSMetaClassBase::safeMetaCast
                          ((OSMetaClassBase *)local_90,*(OSMetaClass **)PTR_metaClass_0006b048),
       lVar7 != 0)) {
      plVar8 = (long *)IOSurfaceSharedEventReference::getSharedEvent();
      if (iVar2 == 0xd) {
        lVar7 = IOSurfaceSharedEvent::getCompletedValue();
        if (lVar7 != 0) {
          *(undefined4 *)(this + 0x610) = 0x12;
        }
      }
      else {
        pIVar14 = IOAccelSharedEventFence::withSharedEvent
                            (plVar8,uVar6,*(long *)(this + 0x5c0),this);
        if (pIVar14 == (IOAccelEventFence *)0x0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s:kIOAccelKernelCommandSignalSharedEvent: couldn\'t allocate signal object\n"
                            ,
                            "virtual void IOAccelCommandQueue::processKernelCommand(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                           );
          *(undefined4 *)(this + 0x610) = 8;
        }
        else {
          (**(code **)(**(long **)(*(long *)(this + 0x5c0) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x5c0) + 0x380),this + 0x668,this + 0x5c8);
          (**(code **)(**(long **)(*(long *)(this + 0x5c0) + 0x380) + 0x1b0))
                    (*(long **)(*(long *)(this + 0x5c0) + 0x380),this + 0x5c8,pIVar14 + 0x68);
          IOAccelFenceMachine::addEventFence
                    (*(IOAccelFenceMachine **)(*(long *)(this + 0x5c0) + 0x390),(long)this,
                     (long)pIVar14);
        }
      }
    }
    else {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s:kIOAccelKernelCommandSignalSharedEvent: bad event port name: %d obj: %p\n"
                        ,
                        "virtual void IOAccelCommandQueue::processKernelCommand(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                        ,uVar17,local_90);
LAB_00047d5d:
      *(undefined4 *)(this + 0x610) = 10;
    }
    goto LAB_00047d67;
  case 5:
  case 0xb:
    if (uVar16 < 0x10) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s:kIOAccelKernelCommandSignalSharedEvent: Insufficient bytes (%llu) for sIOAccelKernelCommandSignalOrWaitEventArgs (%lu)\n"
                        ,
                        "virtual void IOAccelCommandQueue::processKernelCommand(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                        ,uVar16,0x10);
      break;
    }
    uVar17 = param_1[2];
    uVar16 = *(ulong *)(param_1 + 4);
    local_90 = (OSObject *)0x0;
    iVar5 = IOUserClient::copyObjectForPortNameInTask(*(task **)(this + 0x570),uVar17,&local_90);
    if ((iVar5 != 0) ||
       (uVar9 = OSMetaClassBase::safeMetaCast
                          ((OSMetaClassBase *)local_90,*(OSMetaClass **)PTR_metaClass_0006b048),
       uVar9 == 0)) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s:kIOAccelKernelCommandWaitSharedEvent: bad event port name: %d obj: %p\n"
                        ,
                        "virtual void IOAccelCommandQueue::processKernelCommand(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                        ,uVar17,local_90);
      goto LAB_00047d5d;
    }
    local_40 = uVar16;
    local_38 = uVar9;
    uVar10 = IOSurfaceSharedEventReference::getSharedEvent();
    uVar16 = IOAccelFenceMachine::hasEventSignal
                       (*(IOAccelFenceMachine **)(*(long *)(this + 0x5c0) + 0x390),(long)this,uVar10
                       );
    local_48 = uVar10;
    if ((char)uVar16 != '\0') {
      releaseAcceleratorLock(this);
      uVar16 = IOAccelFenceMachine::waitEventSignal
                         (*(IOAccelFenceMachine **)(*(long *)(this + 0x5c0) + 0x390),(long)this,
                          uVar10);
      if ((char)uVar16 == '\0') {
        *(undefined4 *)(this + 0x610) = 2;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "Cmd queue %p sleep port_name %d value: %08llx timed out waiting for prior signals!\n"
                          ,this,uVar17,local_40);
      }
      acquireAcceleratorLock(this);
    }
    uVar9 = IOSurfaceSharedEvent::getCompletedValue();
    uVar16 = local_40;
    if (uVar9 < local_40) {
      local_50 = &DAT_aaaaaaaaaaaaaaaa;
      uVar15 = 5;
      if (iVar2 == 0xb) {
        uVar15 = *(undefined2 *)((long)param_1 + 0xe);
      }
      _clock_interval_to_deadline(uVar15,1000000000,&local_50);
      releaseAcceleratorLock(this);
      uVar11 = IORegistryEntry::getRegistryEntryID();
      IOSurfaceSharedEventReference::getSharedEvent();
      uVar12 = IOSurfaceSharedEvent::getTraceID();
      _kernel_debug(0x850200d5,uVar11,uVar12,uVar16,*(uintptr_t *)(this + 0x4e0),0);
      cVar4 = IOSurfaceSharedEvent::waitCompleted(local_48,uVar16);
      if (cVar4 == '\0') {
        *(undefined4 *)(this + 0x610) = 2;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "Cmd queue %p sleep port_name %d value: %08llx timed out!\n",this,uVar17,
                          uVar16);
      }
      uVar11 = IORegistryEntry::getRegistryEntryID();
      IOSurfaceSharedEventReference::getSharedEvent();
      uVar12 = IOSurfaceSharedEvent::getTraceID();
      _kernel_debug(0x850200d6,uVar11,uVar12,uVar16,*(uintptr_t *)(this + 0x4e0),0);
      acquireAcceleratorLock(this);
    }
LAB_00047d67:
    if (local_90 == (OSObject *)0x0) {
      return;
    }
    lVar7 = *(long *)local_90;
    this_00 = local_90;
LAB_000481ff:
    (**(code **)(lVar7 + 0x28))(this_00);
    return;
  case 6:
    if (uVar16 < 0x10) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s:kIOAccelKernelCommandSignalSharedEvent: Insufficient bytes (%llu) for sIOAccelKernelCommandSignalOrWaitEventArgs (%lu)\n"
                        ,
                        "virtual void IOAccelCommandQueue::processKernelCommand(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                        ,uVar16,0x10);
    }
    else {
      uVar16 = *(ulong *)(param_1 + 4);
      this_01 = (IOAccelMTLEvent2 *)
                IOAccelShared2::lookupMTLEvent(*(IOAccelShared2 **)(this + 0x5b8),param_1[2]);
      if (this_01 != (IOAccelMTLEvent2 *)0x0) {
        (**(code **)(**(long **)(*(long *)(this + 0x5c0) + 0x380) + 0x1b8))
                  (*(long **)(*(long *)(this + 0x5c0) + 0x380),this + 0x668,this + 0x5c8);
        IOAccelMTLEvent2::signalSubmitted(this_01,this + 0x5c8,uVar16);
        _kernel_debug(0x850200c8,*(uintptr_t *)(this + 0x5c0),*(uintptr_t *)(this_01 + 0x288),uVar16
                      ,*(uintptr_t *)(this + 0x4e0),0);
        return;
      }
    }
    break;
  case 7:
  case 0xc:
    if (uVar16 < 0x10) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s:kIOAccelKernelCommandSignalSharedEvent: Insufficient bytes (%llu) for sIOAccelKernelCommandSignalOrWaitEventArgs (%lu)\n"
                        ,
                        "virtual void IOAccelCommandQueue::processKernelCommand(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                        ,uVar16,0x10);
      break;
    }
    uVar17 = 5;
    if (iVar2 == 0xc) {
      uVar17 = (uint)*(ushort *)((long)param_1 + 0xe);
    }
    uVar16 = *(ulong *)(param_1 + 4);
    this_00 = (OSObject *)
              IOAccelShared2::lookupMTLEvent(*(IOAccelShared2 **)(this + 0x5b8),param_1[2]);
    if (this_00 == (OSObject *)0x0) break;
    (**(code **)(*(long *)this_00 + 0x20))(this_00);
    local_40 = CONCAT44(local_40._4_4_,uVar17);
    local_58 = &DAT_aaaaaaaaaaaaaaaa;
    local_60 = &DAT_aaaaaaaaaaaaaaaa;
    local_68 = &DAT_aaaaaaaaaaaaaaaa;
    local_70 = &DAT_aaaaaaaaaaaaaaaa;
    local_78 = &DAT_aaaaaaaaaaaaaaaa;
    local_80 = &DAT_aaaaaaaaaaaaaaaa;
    local_88 = &DAT_aaaaaaaaaaaaaaaa;
    local_90 = (OSObject *)&DAT_aaaaaaaaaaaaaaaa;
    (**(code **)(**(long **)(*(long *)(this + 0x5c0) + 0x380) + 0x140))
              (*(long **)(*(long *)(this + 0x5c0) + 0x380),&local_90);
    local_50 = &DAT_aaaaaaaaaaaaaaaa;
    local_38 = uVar16;
    _clock_interval_to_deadline(local_40 & 0xffffffff,1000000000,&local_50);
    uVar6 = IOAccelMTLEvent2::copySubmitted
                      ((IOAccelMTLEvent2 *)this_00,local_38,&local_90,local_50,
                       *(uintptr_t *)(this + 0x618),*(uintptr_t *)(this + 0x4e0));
    if ((char)uVar6 == '\0') {
      *(undefined4 *)(this + 0x610) = 2;
    }
    else {
      (**(code **)(**(long **)(*(long *)(this + 0x5c0) + 0x380) + 0x1b8))
                (*(long **)(*(long *)(this + 0x5c0) + 0x380),&local_90,this + 0x668);
    }
    lVar7 = *(long *)this_00;
    goto LAB_000481ff;
  case 8:
    if (uVar16 < 8) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s:kIOAccelKernelCommandLockPeer: Insufficient bytes (%llu) for sIOAccelKernelCommandLockPeerArgs (%lu)\n"
                        ,
                        "virtual void IOAccelCommandQueue::processKernelCommand(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                        ,uVar16,8);
    }
    else {
      uVar17 = *puVar1;
      if (uVar17 < 4) {
        this[0x5ad] = (IOAccelCommandQueue)0x1;
        this[0x5ae] = SUB41(uVar17,0);
        return;
      }
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s:kIOAccelKernelCommandLockPeer: Peer index (%u) out of valid range\n",
                        "virtual void IOAccelCommandQueue::processKernelCommand(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                       );
    }
    break;
  case 9:
    if (uVar16 < 4) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s:kIOAccelKernelCommandPurgeResources: Insufficient bytes (%llu) for sIOAccelKernelCommandPurgeResourcesArgs (%lu)\n"
                        ,
                        "virtual void IOAccelCommandQueue::processKernelCommand(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                        ,uVar16,4);
    }
    else {
      uVar18 = (ulong)*puVar1;
      uVar9 = uVar18 * 4 + 4;
      if (uVar16 < uVar9) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s:kIOAccelKernelCommandPurgeResources: Insufficient bytes (%llu) for sIOAccelKernelCommandPurgeResourcesArgs (%lu)\n"
                          ,
                          "virtual void IOAccelCommandQueue::processKernelCommand(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                          ,uVar16,uVar9);
      }
      else {
        if (uVar18 == 0) {
          return;
        }
        uVar16 = 0;
        while( true ) {
          uVar17 = param_1[uVar16 + 3];
          local_90 = (OSObject *)0x0;
          cVar4 = IOAccelShared2::lookupResource
                            (*(IOAccelShared2 **)(this + 0x5b8),uVar17,(long *)&local_90);
          if (cVar4 == '\0') break;
          pIVar13 = IOAccelResource2::getStorageResource((IOAccelResource2 *)local_90);
          if (pIVar13 != (IOAccelResource2 *)0x0) {
            puVar3 = *(undefined8 **)(pIVar13 + 0x30);
            *puVar3 = 0;
            puVar3[1] = 0;
            puVar3[2] = 0;
            *(byte *)((long)puVar3 + 0x1c) = *(byte *)((long)puVar3 + 0x1c) & 0xfe;
          }
          uVar16 = uVar16 + 1;
          if (uVar18 == uVar16) {
            return;
          }
        }
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s:kIOAccelKernelCommandPurgeResources: Invalid resourceID %08x\n",
                          "virtual void IOAccelCommandQueue::processKernelCommand(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                          ,uVar17);
      }
    }
    break;
  case 10:
    if (7 < uVar16) {
                    // WARNING: Could not recover jumptable at 0x00047fc4. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*(long *)this + 0x998))(this,*(undefined8 *)puVar1);
      return;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s:kIOAccelKernelCommandSetProtectionOptions: Insufficient bytes (%llu) for sIOAccelKernelCommandSetProtectionOptionsArgs (%lu)\n"
                      ,
                      "virtual void IOAccelCommandQueue::processKernelCommand(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                      ,uVar16,8);
    break;
  default:
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Invalid eIOAccelKernelCommands enum (command_id=%u command_size=%llubytes)\n"
                      ,
                      "virtual void IOAccelCommandQueue::processKernelCommand(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                      ,iVar2,uVar16);
  }
  *(undefined4 *)(this + 0x610) = 10;
  return;
}



// IOAccelCommandQueue::releaseAcceleratorLock()

void __thiscall IOAccelCommandQueue::releaseAcceleratorLock(IOAccelCommandQueue *this)

{
  IOGraphicsAccelerator2 *this_00;
  
  if (this[0x616] == (IOAccelCommandQueue)0x0) {
    releaseAcceleratorLock();
  }
  else if (this[0x617] == (IOAccelCommandQueue)0x0) {
    releaseAcceleratorLock();
  }
  else {
    this_00 = *(IOGraphicsAccelerator2 **)(this + 0x5c0);
    (**(code **)(*(long *)this_00 + 0x858))(this_00,"",0);
    IOGraphicsAccelerator2::unlock_busy(this_00);
    _IOLockUnlock(*(undefined8 *)(this_00 + 0x88));
    this[0x616] = (IOAccelCommandQueue)0x0;
  }
  return;
}



// IOAccelCommandQueue::acquireAcceleratorLock()

void __thiscall IOAccelCommandQueue::acquireAcceleratorLock(IOAccelCommandQueue *this)

{
  IOGraphicsAccelerator2 *this_00;
  
  if (this[0x616] == (IOAccelCommandQueue)0x0) {
    this_00 = *(IOGraphicsAccelerator2 **)(this + 0x5c0);
    _OSIncrementAtomic(this_00 + 0x90);
    _IOLockLock(*(undefined8 *)(this_00 + 0x88));
    _OSDecrementAtomic(this_00 + 0x90);
    IOGraphicsAccelerator2::lock_busy(this_00);
    (**(code **)(*(long *)this_00 + 0x850))(this_00,"",0);
    IOGraphicsAccelerator2::acceleratorWaitEnabled(*(IOGraphicsAccelerator2 **)(this + 0x5c0));
    this[0x616] = (IOAccelCommandQueue)0x1;
  }
  else {
    acquireAcceleratorLock();
  }
  return;
}



// IOAccelCommandQueue::processKernelCommands(IOAccelKernelCommand const*, IOAccelKernelCommand
// const*)

void __thiscall
IOAccelCommandQueue::processKernelCommands(IOAccelCommandQueue *this,ulong param_1,ulong param_2)

{
  uint uVar1;
  ulong uVar2;
  ulong uVar3;
  
  while( true ) {
    if (param_2 <= param_1) {
      return;
    }
    if (*(int *)(this + 0x610) != 0) {
      return;
    }
    if (param_2 < param_1 + 8) break;
    uVar1 = *(uint *)(param_1 + 4);
    uVar2 = (ulong)uVar1;
    uVar3 = uVar2 + param_1;
    if ((((CARRY8(uVar2,param_1)) || (uVar1 < 8)) || (param_2 < uVar3)) || ((uVar1 & 3) != 0)) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Invalid command_size (%u) min=%lu currentCommand=%p kernelCommandEnd=%p\n"
                        ,
                        "virtual void IOAccelCommandQueue::processKernelCommands(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                        ,uVar2,8,param_1,param_2);
      goto LAB_0004857d;
    }
    (**(code **)(*(long *)this + 0xa40))(this,param_1,uVar3);
    param_1 = uVar3;
  }
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                    "%s: Insufficient space (%lu) to hold sIOAccelKernelCommand (%lu)\n",
                    "virtual void IOAccelCommandQueue::processKernelCommands(const sIOAccelKernelCommand *, const sIOAccelKernelCommand *)"
                    ,param_2 - param_1,8);
LAB_0004857d:
  *(undefined4 *)(this + 0x610) = 10;
  return;
}



// IOAccelCommandQueue::process_command_buffer(unsigned int, unsigned int)

void __thiscall
IOAccelCommandQueue::process_command_buffer(IOAccelCommandQueue *this,uint param_1,uint param_2)

{
  uint uVar1;
  int iVar2;
  uintptr_t arg2;
  undefined4 uVar3;
  uint uVar4;
  long *plVar5;
  IOAccelDeviceShmem *this_00;
  ulong uVar6;
  undefined8 uVar7;
  uintptr_t *puVar8;
  long lVar9;
  uintptr_t uVar10;
  uintptr_t uVar11;
  uintptr_t uVar12;
  long lVar13;
  uint uVar14;
  ulong uVar15;
  bool bVar16;
  ulong uVar17;
  uintptr_t *puVar18;
  ulong uVar19;
  bool bVar20;
  long local_60;
  
  plVar5 = (long *)IOAccelShared2::lookupDeviceShmem(*(IOAccelShared2 **)(this + 0x5b8),param_1);
  this_00 = (IOAccelDeviceShmem *)
            IOAccelShared2::lookupDeviceShmem(*(IOAccelShared2 **)(this + 0x5b8),param_2);
  if ((plVar5 == (long *)0x0) || (this_00 == (IOAccelDeviceShmem *)0x0)) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: invalid segment shmem\n",
                      "void IOAccelCommandQueue::process_command_buffer(uint32_t, uint32_t)");
  }
  else {
    uVar6 = (**(code **)(*(long *)this_00 + 0x138))();
    if ((*(int *)(this_00 + 0x70) == 0) && (-1 < (long)uVar6)) {
      uVar7 = _OSAddAtomic64(1,&___globalObjectIDCounter);
      *(undefined8 *)(this + 0x4e0) = uVar7;
      puVar8 = (uintptr_t *)(**(code **)(*(long *)this_00 + 0x130))(this_00);
      lVar9 = (**(code **)(*plVar5 + 0x118))(plVar5);
      if ((puVar8 == (uintptr_t *)0x0) || (lVar9 == 0)) {
        *(undefined4 *)(this + 0x610) = 8;
        return;
      }
      arg2 = *puVar8;
      uVar1 = *(uint *)(this + 0x5a0);
      iVar2 = *(int *)(this + 0x5a8);
      uVar14 = 0x200;
      if (uVar1 == 1) {
        uVar14 = *(int *)(this + 0x5a4) << 8;
      }
      uVar11 = *(uintptr_t *)(this + 0x618);
      uVar12 = *(uintptr_t *)(this + 0x4e0);
      uVar3 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x850200c0,uVar12,arg2,uVar11,CONCAT44(iVar2 << 0x10 | uVar1 | uVar14,uVar3),0);
      uVar11 = *(uintptr_t *)(this + 0x618);
      uVar12 = *(uintptr_t *)(this + 0x4e0);
      uVar10 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x85120048,uVar12,arg2,uVar11,uVar10,0);
      (**(code **)(*plVar5 + 0x20))(plVar5);
      (**(code **)(*(long *)this_00 + 0x20))(this_00);
      *(undefined4 *)(this_00 + 0x70) = 1;
      local_60 = 0;
      bVar16 = false;
      puVar18 = puVar8;
      do {
        if ((uVar6 < 0x10) || (bVar16)) {
          IOAccelDeviceShmem::resetKernelDataRange(this_00);
          (**(code **)(*(long *)this_00 + 0x120))(this_00);
          *(undefined4 *)(this_00 + 0x70) = 0;
          (**(code **)(*(long *)this_00 + 0x28))(this_00);
          (**(code **)(*plVar5 + 0x120))(plVar5);
          (**(code **)(*plVar5 + 0x28))(plVar5);
          _kernel_debug(0x85020004,*(uintptr_t *)(this + 0x4e0),arg2,(ulong)*(uint *)(this + 0x578),
                        (ulong)*(uint *)(this + 0x610),0);
          uVar11 = *(uintptr_t *)(this + 0x618);
          uVar12 = *(uintptr_t *)(this + 0x4e0);
          uVar10 = IORegistryEntry::getRegistryEntryID();
          _kernel_debug(0x8512004c,uVar12,arg2,uVar11,uVar10,0);
          return;
        }
        if (local_60 != (long)puVar18 - (long)puVar8) {
          process_command_buffer();
          return;
        }
        uVar1 = *(uint *)((long)puVar18 + 0xc);
        if ((int)uVar1 < 0) {
          bVar16 = true;
        }
        uVar4 = (int)(uVar1 * 2) >> 0x1f & uVar1 & 0x3fffffff;
        uVar14 = uVar1 & 0x3fffffff;
        if ((uVar1 >> 0x1e & 1) != 0) {
          uVar14 = 0;
        }
        uVar19 = (ulong)uVar14;
        if (uVar4 == 2) {
LAB_00048860:
          uVar6 = 0;
        }
        else if (uVar4 == 1) {
          uVar17 = (ulong)(uint)puVar18[1];
          uVar19 = uVar17 * 8 + 0x10;
          bVar20 = uVar6 < uVar19;
          uVar6 = uVar6 - uVar19;
          if (bVar20) {
            *(undefined4 *)(this + 0x610) = 10;
            uVar6 = 0;
          }
          else {
            lVar13 = (**(code **)(*plVar5 + 0x128))();
            if (uVar17 != 0) {
              uVar15 = 0;
              do {
                uVar1 = *(uint *)((long)puVar18 + uVar15 * 8 + 0x14);
                if (((long)(ulong)uVar1 <= lVar13) &&
                   (uVar11 = puVar18[uVar15 + 2], (uint)uVar11 <= uVar1)) {
                  this[0x617] = (IOAccelCommandQueue)0x1;
                  (**(code **)(*(long *)this + 0xa38))
                            (this,(ulong)(uint)uVar11 + lVar9,(ulong)uVar1 + lVar9);
                  this[0x617] = (IOAccelCommandQueue)0x0;
                }
                uVar15 = uVar15 + 1;
              } while (uVar17 != uVar15);
            }
            puVar18 = puVar18 + uVar17 + 2;
            local_60 = local_60 + uVar19;
          }
        }
        else {
          if (uVar4 != 0) {
            *(undefined4 *)(this + 0x610) = 10;
            goto LAB_00048860;
          }
          uVar11 = _OSAddAtomic64(1,&___globalObjectIDCounter);
          uVar12 = IORegistryEntry::getRegistryEntryID();
          _kernel_debug(0x850200d9,uVar12,arg2,uVar11,0,0);
          if (uVar14 == 0) {
            if (local_60 == 0) {
              bVar16 = true;
              lVar13 = 0;
              uVar17 = 0;
              goto LAB_00048928;
            }
          }
          else if (((0xf < uVar14) && ((uVar14 & 7) == 0)) &&
                  (lVar13 = local_60, uVar17 = uVar6, (long)uVar19 <= (long)uVar6)) {
LAB_00048928:
            IOAccelDeviceShmem::setKernelDataRange(this_00,lVar13,uVar6);
            if ((this[0x5ad] == (IOAccelCommandQueue)0x0) ||
               (uVar6 = IOAccelShared2::lockPeer
                                  (*(IOAccelShared2 **)(this + 0x5b8),(uint)(byte)this[0x5ae]),
               (int)uVar6 == 0)) {
              (**(code **)(*(long *)this + 0xa20))(this,param_1,param_2);
              if (this[0x5ad] != (IOAccelCommandQueue)0x0) {
                IOAccelShared2::unlockPeer
                          (*(IOAccelShared2 **)(this + 0x5b8),(uint)(byte)this[0x5ae]);
                this[0x5ad] = (IOAccelCommandQueue)0x0;
              }
              puVar18 = (uintptr_t *)((long)puVar18 + uVar19);
              local_60 = local_60 + uVar19;
              uVar6 = uVar17 - uVar19;
              uVar12 = IORegistryEntry::getRegistryEntryID();
              _kernel_debug(0x850200da,uVar12,arg2,uVar11,0,0);
            }
            else {
              __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                "queue %p needs peer locked %d, lockPeer() failed\n\n",this);
              *(undefined4 *)(this + 0x610) = 10;
              this[0x5ad] = (IOAccelCommandQueue)0x0;
              uVar6 = 0;
            }
            goto LAB_00048a0e;
          }
          *(undefined4 *)(this + 0x610) = 10;
          uVar6 = 0;
        }
LAB_00048a0e:
        if (*(int *)(this_00 + 0x38) < 1) {
          process_command_buffer();
          return;
        }
        if ((int)plVar5[7] < 1) {
          process_command_buffer();
          return;
        }
      } while( true );
    }
  }
  *(undefined4 *)(this + 0x610) = 9;
  return;
}



// IOAccelCommandQueue::retireCommandBuffer(IOAccelEventFence*)

void __thiscall IOAccelCommandQueue::retireCommandBuffer(IOAccelCommandQueue *this,long param_1)

{
  uint uVar1;
  int iVar2;
  char cVar3;
  char *pcVar4;
  undefined1 *local_a8;
  undefined1 *local_a0;
  undefined1 *local_98;
  undefined1 *local_90;
  undefined1 *local_88;
  undefined1 *local_80;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  long local_20;
  
  local_20 = *(long *)PTR____stack_chk_guard_0006b0b0;
  uVar1 = *(uint *)(param_1 + 0xc0);
  if (uVar1 == 0) {
    iVar2 = *(int *)(this + 0x58c);
    *(uint *)(this + 0x58c) = iVar2 + 1U;
    if (((1000 < iVar2 + 1U) && (this[0x594] == (IOAccelCommandQueue)0x0)) &&
       (*(undefined4 *)(this + 0x58c) = 0, *(int *)(this + 0x590) != 0)) {
      local_30 = &DAT_aaaaaaaaaaaaaaaa;
      local_38 = &DAT_aaaaaaaaaaaaaaaa;
      local_40 = &DAT_aaaaaaaaaaaaaaaa;
      local_48 = &DAT_aaaaaaaaaaaaaaaa;
      local_50 = &DAT_aaaaaaaaaaaaaaaa;
      local_58 = &DAT_aaaaaaaaaaaaaaaa;
      local_60 = &DAT_aaaaaaaaaaaaaaaa;
      local_68 = &DAT_aaaaaaaaaaaaaaaa;
      local_70 = &DAT_aaaaaaaaaaaaaaaa;
      local_78 = &DAT_aaaaaaaaaaaaaaaa;
      local_80 = &DAT_aaaaaaaaaaaaaaaa;
      local_88 = &DAT_aaaaaaaaaaaaaaaa;
      local_90 = &DAT_aaaaaaaaaaaaaaaa;
      local_98 = &DAT_aaaaaaaaaaaaaaaa;
      local_a0 = &DAT_aaaaaaaaaaaaaaaa;
      local_a8 = &DAT_aaaaaaaaaaaaaaaa;
      _proc_name(*(int *)(this + 0x578),&local_a8,0x80);
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Clean slate for app[%s] with %d GPURestarts in %d submissions.\n",
                        "virtual void IOAccelCommandQueue::retireCommandBuffer(IOAccelEventFence *)"
                        ,&local_a8,*(undefined4 *)(this + 0x590),*(undefined4 *)(this + 0x58c));
      *(undefined4 *)(this + 0x590) = 0;
    }
  }
  else if (((((uVar1 & 0xfffffffe) == 2) || (this[0x595] != (IOAccelCommandQueue)0x0)) ||
           (uVar1 == 0xb)) &&
          (iVar2 = *(int *)(this + 0x590), *(int *)(this + 0x590) = iVar2 + 1, iVar2 + 1 == 2)) {
    local_30 = &DAT_aaaaaaaaaaaaaaaa;
    local_38 = &DAT_aaaaaaaaaaaaaaaa;
    local_40 = &DAT_aaaaaaaaaaaaaaaa;
    local_48 = &DAT_aaaaaaaaaaaaaaaa;
    local_50 = &DAT_aaaaaaaaaaaaaaaa;
    local_58 = &DAT_aaaaaaaaaaaaaaaa;
    local_60 = &DAT_aaaaaaaaaaaaaaaa;
    local_68 = &DAT_aaaaaaaaaaaaaaaa;
    local_70 = &DAT_aaaaaaaaaaaaaaaa;
    local_78 = &DAT_aaaaaaaaaaaaaaaa;
    local_80 = &DAT_aaaaaaaaaaaaaaaa;
    local_88 = &DAT_aaaaaaaaaaaaaaaa;
    local_90 = &DAT_aaaaaaaaaaaaaaaa;
    local_98 = &DAT_aaaaaaaaaaaaaaaa;
    local_a0 = &DAT_aaaaaaaaaaaaaaaa;
    local_a8 = &DAT_aaaaaaaaaaaaaaaa;
    _proc_name(*(int *)(this + 0x578),&local_a8,0x80);
    if ((*(IOAccelShared2 **)(this + 0x5b8) == (IOAccelShared2 *)0x0) ||
       (cVar3 = IOAccelShared2::noIgnoreOnGPURestart(*(IOAccelShared2 **)(this + 0x5b8)),
       cVar3 == '\0')) {
      this[0x594] = (IOAccelCommandQueue)0x1;
      pcVar4 = "Deny Submissions/ignore";
    }
    else {
      pcVar4 = "Immunity for";
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: %s app[%s] with %d GPURestarts in %d submissions.\n",
                      "virtual void IOAccelCommandQueue::retireCommandBuffer(IOAccelEventFence *)",
                      pcVar4,&local_a8,*(undefined4 *)(this + 0x590),*(undefined4 *)(this + 0x58c));
  }
  this[0x595] = (IOAccelCommandQueue)0x0;
  if (*(long *)PTR____stack_chk_guard_0006b0b0 != local_20) {
                    // WARNING: Subroutine does not return
    ___stack_chk_fail();
  }
  return;
}



// IOAccelCommandQueue::generateSubmissionID()

void IOAccelCommandQueue::generateSubmissionID(void)

{
  generateSubmissionID()::submission_id_counter = generateSubmissionID()::submission_id_counter + 1;
  return;
}



// IOAccelCommandQueue::generateSegmentID()

void IOAccelCommandQueue::generateSegmentID(void)

{
  generateSegmentID()::segment_id_counter = generateSegmentID()::segment_id_counter + 1;
  return;
}



// IOAccelCommandQueue::generateGPUSubmissionID()

void IOAccelCommandQueue::generateGPUSubmissionID(void)

{
  generateGPUSubmissionID()::gpu_submission_id_counter =
       generateGPUSubmissionID()::gpu_submission_id_counter + 1;
  return;
}



// IOAccelCommandQueue::setSubmissionError(unsigned int)

void __thiscall
IOAccelCommandQueue::setSubmissionError(IOAccelCommandQueue *this,undefined4 param_1)

{
  if (*(long *)(this + 0x608) != 0) {
    *(undefined4 *)(*(long *)(this + 0x608) + 0xc0) = param_1;
  }
  return;
}



// IOAccelCommandQueue::_RESERVEDIOAccelCommandQueue0()

void IOAccelCommandQueue::_RESERVEDIOAccelCommandQueue0(void)

{
  OSMetaClass::reservedCalled(0x82688);
  return;
}



// IOAccelCommandQueue::_RESERVEDIOAccelCommandQueue1()

void IOAccelCommandQueue::_RESERVEDIOAccelCommandQueue1(void)

{
  OSMetaClass::reservedCalled(0x82688);
  return;
}



// IOAccelCommandQueue::_RESERVEDIOAccelCommandQueue2()

void IOAccelCommandQueue::_RESERVEDIOAccelCommandQueue2(void)

{
  OSMetaClass::reservedCalled(0x82688);
  return;
}



// IOAccelCommandQueue::_RESERVEDIOAccelCommandQueue3()

void IOAccelCommandQueue::_RESERVEDIOAccelCommandQueue3(void)

{
  OSMetaClass::reservedCalled(0x82688);
  return;
}



// IOAccelCommandQueue::_RESERVEDIOAccelCommandQueue4()

void IOAccelCommandQueue::_RESERVEDIOAccelCommandQueue4(void)

{
  OSMetaClass::reservedCalled(0x82688);
  return;
}



// IOAccelCommandQueue::_RESERVEDIOAccelCommandQueue5()

void IOAccelCommandQueue::_RESERVEDIOAccelCommandQueue5(void)

{
  OSMetaClass::reservedCalled(0x82688);
  return;
}



// IOAccelCommandQueue::MetaClass::~MetaClass()

void __thiscall IOAccelCommandQueue::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelCommandQueue::getOwningTask() const

undefined8 __thiscall IOAccelCommandQueue::getOwningTask(IOAccelCommandQueue *this)

{
  return *(undefined8 *)(this + 0x570);
}



// IOAccelCommandQueue::getGPUTask() const

undefined8 __thiscall IOAccelCommandQueue::getGPUTask(IOAccelCommandQueue *this)

{
  return *(undefined8 *)(this + 0x5b0);
}



// IOAccelCommandQueue::getOwningTaskPid() const

undefined4 __thiscall IOAccelCommandQueue::getOwningTaskPid(IOAccelCommandQueue *this)

{
  return *(undefined4 *)(this + 0x578);
}



// IOAccelCommandQueue::affectedByHardwareReset(bool, unsigned int)

void IOAccelCommandQueue::affectedByHardwareReset(void)

{
  return;
}



// IOAccelCommandQueue::shouldHardwareCommandNooped()

undefined8 IOAccelCommandQueue::shouldHardwareCommandNooped(void)

{
  return 0;
}



// IOAccelCommandQueue::canSubmitCommandBuffer()

undefined1 IOAccelCommandQueue::canSubmitCommandBuffer(void)

{
  return 1;
}



// IOAccelCommandQueue::pauseSubmitCommandBuffer()

void IOAccelCommandQueue::pauseSubmitCommandBuffer(void)

{
  _IOSleep(1);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelCommandQueue_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelCommandQueue::gMetaClass,"IOAccelCommandQueue",
             (OSMetaClass *)&IOAccelSubmitter2::gMetaClass,0x6a8);
  _gMetaClass = &PTR__MetaClass_0007e2c0;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelCommandQueue::gMetaClass);
  return;
}



// IOAccelAllocationInfo::MetaClass::MetaClass()

void __thiscall IOAccelAllocationInfo::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelAllocationInfo",(OSMetaClass *)PTR_gMetaClass_0006b068,
             0x430);
  *(undefined ***)this = &PTR__MetaClass_0007e4f0;
  return;
}



// IOAccelAllocationInfo::MetaClass::~MetaClass()

void __thiscall IOAccelAllocationInfo::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelAllocationInfo::IOAccelAllocationInfo(OSMetaClass const*)

void __thiscall
IOAccelAllocationInfo::IOAccelAllocationInfo(IOAccelAllocationInfo *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelAllocationInfo_0007e3b8;
  return;
}



// IOAccelAllocationInfo::IOAccelAllocationInfo(OSMetaClass const*)

void __thiscall
IOAccelAllocationInfo::IOAccelAllocationInfo(IOAccelAllocationInfo *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelAllocationInfo_0007e3b8;
  return;
}



// IOAccelAllocationInfo::~IOAccelAllocationInfo()

void __thiscall IOAccelAllocationInfo::~IOAccelAllocationInfo(IOAccelAllocationInfo *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelAllocationInfo::~IOAccelAllocationInfo()

void __thiscall IOAccelAllocationInfo::~IOAccelAllocationInfo(IOAccelAllocationInfo *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelAllocationInfo::~IOAccelAllocationInfo()

void __thiscall IOAccelAllocationInfo::~IOAccelAllocationInfo(IOAccelAllocationInfo *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelAllocationInfo_ktv,this,0x430);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelAllocationInfo::operator delete(void*, unsigned long)

void __cdecl IOAccelAllocationInfo::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelAllocationInfo_ktv,param_1,param_2);
  return;
}



// IOAccelAllocationInfo::getMetaClass() const

undefined1 * IOAccelAllocationInfo::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelAllocationInfo::MetaClass::MetaClass()

void __thiscall IOAccelAllocationInfo::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelAllocationInfo",(OSMetaClass *)PTR_gMetaClass_0006b068,
             0x430);
  *(undefined ***)this = &PTR__MetaClass_0007e4f0;
  return;
}



// IOAccelAllocationInfo::MetaClass::alloc() const

OSObject * IOAccelAllocationInfo::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelAllocationInfo_ktv,0x430);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelAllocationInfo::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelAllocationInfo_0007e3b8;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelAllocationInfo::operator new(unsigned long)

void * __thiscall IOAccelAllocationInfo::operator_new(IOAccelAllocationInfo *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelAllocationInfo_ktv,this);
  return pvVar1;
}



// IOAccelAllocationInfo::IOAccelAllocationInfo()

void __thiscall IOAccelAllocationInfo::IOAccelAllocationInfo(IOAccelAllocationInfo *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelAllocationInfo_0007e3b8;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelAllocationInfo::IOAccelAllocationInfo()

void __thiscall IOAccelAllocationInfo::IOAccelAllocationInfo(IOAccelAllocationInfo *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelAllocationInfo_0007e3b8;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelAllocationInfo::init(IOGraphicsAccelerator2*)

void __thiscall IOAccelAllocationInfo::init(IOAccelAllocationInfo *this,undefined8 param_1)

{
  char cVar1;
  long lVar2;
  
  cVar1 = (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  if (cVar1 != '\0') {
    *(undefined8 *)(this + 0x10) = param_1;
    lVar2 = 0;
    do {
      *(undefined8 *)(this + lVar2 * 8 + 0x18) = 0;
      lVar2 = lVar2 + 1;
    } while (lVar2 != 0x80);
    *(undefined8 *)(this + 0x418) = 0;
  }
  return;
}



// IOAccelAllocationInfo::free()

void __thiscall IOAccelAllocationInfo::free(IOAccelAllocationInfo *this)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  long lVar3;
  
  lVar3 = 0;
  do {
    puVar2 = *(undefined8 **)(this + lVar3 * 8 + 0x18);
    while (puVar2 != (undefined8 *)0x0) {
      puVar1 = (undefined8 *)*puVar2;
      puVar2[1] = 0;
      (**(code **)(*(long *)puVar2[2] + 0x28))();
      puVar2[2] = 0;
      _IOFreeTypeImpl(&free()::kalloc_type_view_74,puVar2);
      puVar2 = puVar1;
    }
    lVar3 = lVar3 + 1;
  } while (lVar3 != 0x80);
  if (*(long **)(this + 0x418) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x418) + 0x28))();
    *(undefined8 *)(this + 0x418) = 0;
  }
  if (*(long **)(this + 0x420) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x420) + 0x28))();
    *(undefined8 *)(this + 0x420) = 0;
  }
  if (*(long **)(this + 0x428) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x428) + 0x28))();
    *(undefined8 *)(this + 0x428) = 0;
  }
                    // WARNING: Could not recover jumptable at 0x000491f1. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelAllocationInfo::addAllocationDescription(IOAccelMemory*)

void __thiscall
IOAccelAllocationInfo::addAllocationDescription
          (IOAccelAllocationInfo *this,OSMetaClassBase *param_1)

{
  int iVar1;
  long lVar2;
  long *plVar3;
  long *plVar4;
  ulonglong uVar5;
  IOAccelSysMemory *this_00;
  ulong uVar6;
  long *plVar7;
  char *pcVar8;
  long local_140;
  ulonglong local_138 [32];
  long local_38;
  
  local_38 = *(long *)PTR____stack_chk_guard_0006b0b0;
  lVar2 = lookupAllocation(this,(ulong)param_1);
  if (lVar2 == 0) {
    plVar3 = (long *)OSDictionary::withCapacity(8);
    pcVar8 = "VidMem";
    if (((byte)param_1[0xc] & 4) == 0) {
      pcVar8 = "SysMem";
    }
    plVar4 = (long *)OSSymbol::withCString(pcVar8);
    (**(code **)(*plVar3 + 0x1d0))(plVar3,"MemoryPool",plVar4);
    (**(code **)(*plVar4 + 0x28))(plVar4);
    uVar5 = (**(code **)(*(long *)param_1 + 0x120))(param_1);
    plVar4 = (long *)OSNumber::withNumber(uVar5,0x40);
    (**(code **)(*plVar3 + 0x1d0))(plVar3,"Size",plVar4);
    (**(code **)(*plVar4 + 0x28))(plVar4);
    plVar4 = (long *)OSBoolean::withBoolean((bool)((byte)(*(uint *)(param_1 + 0xc) >> 10) & 1));
    (**(code **)(*plVar3 + 0x1d0))(plVar3,"Orphaned",plVar4);
    (**(code **)(*plVar4 + 0x28))(plVar4);
    if (((byte)param_1[0xc] & 4) == 0) {
      this_00 = (IOAccelSysMemory *)
                OSMetaClassBase::safeMetaCast(param_1,(OSMetaClass *)&IOAccelSysMemory::gMetaClass);
      if (this_00 == (IOAccelSysMemory *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "Memory couldn\'t be casted to IOAccelSysMem: 0x%p\n",param_1);
      }
      else {
        local_138[0] = 0;
        local_140 = 0;
        uVar6 = IOAccelSysMemory::getPageCounts(this_00,local_138,&local_140);
        if ((int)uVar6 == 0) {
          plVar4 = (long *)OSNumber::withNumber(*(long *)PTR__page_size_0006b108 * local_140,0x40);
          (**(code **)(*plVar3 + 0x1d0))(plVar3,"DirtySize",plVar4);
          (**(code **)(*plVar4 + 0x28))(plVar4);
          plVar4 = (long *)OSNumber::withNumber
                                     (*(long *)PTR__page_size_0006b108 * local_138[0],0x40);
          (**(code **)(*plVar3 + 0x1d0))(plVar3,"ResidentSize",plVar4);
          (**(code **)(*plVar4 + 0x28))(plVar4);
        }
        else {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: IOMemoryDescriptor::getPageCounts returned 0x%08x\n",
                            "void IOAccelAllocationInfo::addAllocationDescription(IOAccelMemory *)",
                            uVar6 & 0xffffffff);
        }
        plVar4 = (long *)OSBoolean::withBoolean(SUB41((*(uint *)(this_00 + 0xc) & 2) >> 1,0));
        (**(code **)(*plVar3 + 0x1d0))(plVar3,"Wired",plVar4);
        (**(code **)(*plVar4 + 0x28))(plVar4);
      }
    }
    if (((byte)param_1[0xc] & 0x20) == 0) {
      local_138[0] = CONCAT44(local_138[0]._4_4_,0xaaaaaaaa);
      iVar1 = (**(code **)(*(long *)param_1 + 0x160))(param_1,1);
      if (iVar1 == 0) {
        plVar4 = (long *)OSBoolean::withBoolean((int)local_138[0] - 3U < 2);
        (**(code **)(*plVar3 + 0x1d0))(plVar3,"Purgeable",plVar4);
        (**(code **)(*plVar4 + 0x28))(plVar4);
      }
    }
    if (*(IOAccelResource2 **)(param_1 + 0x38) != (IOAccelResource2 *)0x0) {
      uVar6 = IOAccelResource2::requirePageoff(*(IOAccelResource2 **)(param_1 + 0x38));
      if ((char)uVar6 != '\0') {
        plVar4 = (long *)OSBoolean::withBoolean(true);
        (**(code **)(*plVar3 + 0x1d0))(plVar3,"PageoffRequired",plVar4);
        (**(code **)(*plVar4 + 0x28))(plVar4);
      }
    }
    plVar4 = (long *)OSNumber::withNumber(*(ulonglong *)(param_1 + 0x48),0x40);
    plVar7 = (long *)OSArray::withCapacity(1);
    (**(code **)(*plVar7 + 0x1b8))(plVar7,plVar4);
    (**(code **)(*plVar3 + 0x1d0))(plVar3,"AllocationIdentifiers",plVar7);
    (**(code **)(*plVar7 + 0x28))(plVar7);
    (**(code **)(*plVar4 + 0x28))(plVar4);
    _memset(local_138,0xaa,0x100);
    _snprintf((char *)local_138,0x100,"%s",*(char **)(*(long *)(this + 0x10) + 0xc88));
    plVar4 = (long *)OSSymbol::withCString((char *)local_138);
    plVar7 = (long *)OSArray::withCapacity(1);
    (**(code **)(*plVar7 + 0x1b8))(plVar7,plVar4);
    (**(code **)(*plVar4 + 0x28))(plVar4);
    (**(code **)(*plVar3 + 0x1d0))(plVar3,"Devices",plVar7);
    (**(code **)(*plVar7 + 0x28))(plVar7);
    insertAllocation(this,(ulong)param_1,plVar3);
    (**(code **)(*plVar3 + 0x28))(plVar3);
    if ((((byte)param_1[0xd] & 4) != 0) && (*(long *)(param_1 + 0x30) != 0)) {
      getOrCreateProcessDictionaryForPID
                (this,(ulong)param_1,*(int *)(*(long *)(*(long *)(param_1 + 0x30) + 0x20) + 0x40));
    }
  }
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_38) {
    return;
  }
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// IOAccelAllocationInfo::lookupAllocation(IOAccelMemory*)

undefined8 __thiscall
IOAccelAllocationInfo::lookupAllocation(IOAccelAllocationInfo *this,ulong param_1)

{
  long lVar1;
  uint uVar2;
  IOAccelAllocationInfo *pIVar3;
  ulong uVar4;
  
  uVar2 = 0;
  lVar1 = 8;
  uVar4 = param_1;
  do {
    uVar2 = (((uint)uVar4 & 0xff) + uVar2) * 0x401;
    uVar2 = uVar2 >> 6 ^ uVar2;
    uVar4 = uVar4 >> 8;
    lVar1 = lVar1 + -1;
  } while (lVar1 != 0);
  pIVar3 = this + (ulong)((uVar2 * 9 >> 0xb ^ uVar2 * 9) & 0x7f) * 8 + 0x18;
  do {
    pIVar3 = *(IOAccelAllocationInfo **)pIVar3;
    if (pIVar3 == (IOAccelAllocationInfo *)0x0) {
      return 0;
    }
  } while (*(ulong *)(pIVar3 + 8) != param_1);
  return *(undefined8 *)(pIVar3 + 0x10);
}



// IOAccelAllocationInfo::insertAllocation(IOAccelMemory*, OSDictionary*)

void __thiscall
IOAccelAllocationInfo::insertAllocation(IOAccelAllocationInfo *this,ulong param_1,long *param_2)

{
  long lVar1;
  undefined8 *puVar2;
  uint uVar3;
  ulong uVar4;
  
  uVar3 = 0;
  lVar1 = 8;
  uVar4 = param_1;
  do {
    uVar3 = (((uint)uVar4 & 0xff) + uVar3) * 0x401;
    uVar3 = uVar3 >> 6 ^ uVar3;
    uVar4 = uVar4 >> 8;
    lVar1 = lVar1 + -1;
  } while (lVar1 != 0);
  uVar4 = (ulong)((uVar3 * 9 >> 0xb ^ uVar3 * 9) & 0x7f);
  puVar2 = (undefined8 *)
           _IOMallocTypeImpl(&insertAllocation(IOAccelMemory*,OSDictionary*)::kalloc_type_view_532);
  *puVar2 = *(undefined8 *)(this + uVar4 * 8 + 0x18);
  puVar2[1] = param_1;
  puVar2[2] = param_2;
  (**(code **)(*param_2 + 0x20))(param_2);
  *(undefined8 **)(this + uVar4 * 8 + 0x18) = puVar2;
  return;
}



// IOAccelAllocationInfo::getOrCreateProcessDictionaryForPID(IOAccelMemory*, int)

long * __thiscall
IOAccelAllocationInfo::getOrCreateProcessDictionaryForPID
          (IOAccelAllocationInfo *this,ulong param_1,int param_2)

{
  OSMetaClass *pOVar1;
  OSMetaClass *pOVar2;
  int iVar3;
  uint uVar4;
  long *plVar5;
  OSMetaClassBase *pOVar6;
  long *plVar7;
  long *plVar8;
  uint uVar9;
  
  plVar5 = (long *)lookupAllocation(this,param_1);
  pOVar6 = (OSMetaClassBase *)(**(code **)(*plVar5 + 0x208))(plVar5,"Processes");
  if (pOVar6 == (OSMetaClassBase *)0x0) {
    plVar7 = (long *)OSArray::withCapacity(1);
    (**(code **)(*plVar5 + 0x1d0))(plVar5,"Processes",plVar7);
    (**(code **)(*plVar7 + 0x28))(plVar7);
  }
  else {
    plVar7 = (long *)OSMetaClassBase::safeMetaCast(pOVar6,*(OSMetaClass **)PTR_metaClass_0006b058);
  }
  iVar3 = (**(code **)(*plVar7 + 0x130))(plVar7);
  if (iVar3 != 0) {
    pOVar1 = *(OSMetaClass **)PTR_metaClass_0006b020;
    pOVar2 = *(OSMetaClass **)PTR_metaClass_0006b060;
    uVar9 = 0;
    do {
      pOVar6 = (OSMetaClassBase *)(**(code **)(*plVar7 + 0x1e8))(plVar7,uVar9);
      plVar5 = (long *)OSMetaClassBase::safeMetaCast(pOVar6,pOVar1);
      pOVar6 = (OSMetaClassBase *)(**(code **)(*plVar5 + 0x208))(plVar5,"PID");
      plVar8 = (long *)OSMetaClassBase::safeMetaCast(pOVar6,pOVar2);
      iVar3 = (**(code **)(*plVar8 + 0x148))(plVar8);
      if (iVar3 == param_2) {
        return plVar5;
      }
      uVar9 = uVar9 + 1;
      uVar4 = (**(code **)(*plVar7 + 0x130))(plVar7);
    } while (uVar9 < uVar4);
  }
  plVar5 = (long *)OSDictionary::withCapacity(1);
  plVar8 = (long *)OSNumber::withNumber((long)param_2,0x40);
  (**(code **)(*plVar5 + 0x1d0))(plVar5,"PID",plVar8);
  (**(code **)(*plVar7 + 0x1b8))(plVar7,plVar5);
  (**(code **)(*plVar8 + 0x28))(plVar8);
  (**(code **)(*plVar5 + 0x28))(plVar5);
  return plVar5;
}



// IOAccelAllocationInfo::addIOSurfaceID(IOAccelMemory*, unsigned int)

void __thiscall
IOAccelAllocationInfo::addIOSurfaceID(IOAccelAllocationInfo *this,ulong param_1,uint param_2)

{
  long *plVar1;
  long *plVar2;
  
  if ((*(uint *)(param_1 + 0xc) & 6) != 4) {
    plVar1 = (long *)lookupAllocation(this,param_1);
    if (plVar1 != (long *)0x0) {
      plVar2 = (long *)OSNumber::withNumber((ulong)param_2,0x40);
      (**(code **)(*plVar1 + 0x1d0))(plVar1,"IOSurfaceID",plVar2);
                    // WARNING: Could not recover jumptable at 0x000498ba. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*plVar2 + 0x28))(plVar2);
      return;
    }
  }
  return;
}



// IOAccelAllocationInfo::addResource(IOAccelMemory*, IOAccelResource2*)

void IOAccelAllocationInfo::addResource(void)

{
  return;
}



// IOAccelAllocationInfo::addPID(IOAccelMemory*, int)

void __thiscall IOAccelAllocationInfo::addPID(IOAccelAllocationInfo *this,ulong param_1,int param_2)

{
  if ((*(uint *)(param_1 + 0xc) & 6) == 4) {
    return;
  }
  getOrCreateProcessDictionaryForPID(this,param_1,param_2);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelAllocationInfo::addUserMapping(IOAccelMemory*, int, unsigned long long, unsigned long
// long)

void __cdecl
IOAccelAllocationInfo::addUserMapping
          (IOAccelAllocationInfo *param_1,ulong param_2,int param_3,ulonglong param_4)

{
  OSMetaClass *pOVar1;
  int iVar2;
  uint uVar3;
  long *plVar4;
  OSMetaClassBase *pOVar5;
  long *plVar6;
  ulonglong uVar7;
  uint uVar8;
  
  if ((*(uint *)(param_2 + 0xc) & 6) == 4) {
    return;
  }
  plVar4 = getOrCreateProcessDictionaryForPID(param_1,param_2,param_3);
  pOVar5 = (OSMetaClassBase *)(**(code **)(*plVar4 + 0x208))(plVar4,"Mappings");
  if (pOVar5 == (OSMetaClassBase *)0x0) {
    pOVar5 = (OSMetaClassBase *)OSArray::withCapacity(2);
    (**(code **)(*plVar4 + 0x1d0))(plVar4,"Mappings",pOVar5);
    (**(code **)(*(long *)pOVar5 + 0x28))(pOVar5);
  }
  plVar4 = (long *)OSMetaClassBase::safeMetaCast(pOVar5,*(OSMetaClass **)PTR_metaClass_0006b058);
  iVar2 = (**(code **)(*plVar4 + 0x130))(plVar4);
  if (iVar2 != 0) {
    pOVar1 = *(OSMetaClass **)PTR_metaClass_0006b060;
    uVar8 = 0;
    do {
      pOVar5 = (OSMetaClassBase *)(**(code **)(*plVar4 + 0x1e8))(plVar4,uVar8);
      plVar6 = (long *)OSMetaClassBase::safeMetaCast(pOVar5,pOVar1);
      uVar7 = (**(code **)(*plVar6 + 0x150))(plVar6);
      if (uVar7 == param_4) {
        return;
      }
      uVar8 = uVar8 + 1;
      uVar3 = (**(code **)(*plVar4 + 0x130))(plVar4);
    } while (uVar8 < uVar3);
  }
  plVar6 = (long *)OSNumber::withNumber(param_4,0x40);
  (**(code **)(*plVar4 + 0x1b8))(plVar4,plVar6);
                    // WARNING: Could not recover jumptable at 0x000499f3. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*plVar6 + 0x28))(plVar6);
  return;
}



// IOAccelAllocationInfo::addString(IOAccelMemory*, char const*)

void __thiscall
IOAccelAllocationInfo::addString(IOAccelAllocationInfo *this,ulong param_1,char *param_2)

{
  long *plVar1;
  OSMetaClassBase *pOVar2;
  long *plVar3;
  
  if ((*(uint *)(param_1 + 0xc) & 6) == 4) {
    return;
  }
  plVar1 = (long *)lookupAllocation(this,param_1);
  pOVar2 = (OSMetaClassBase *)(**(code **)(*plVar1 + 0x208))(plVar1,"Descriptions");
  if (pOVar2 == (OSMetaClassBase *)0x0) {
    plVar3 = (long *)OSArray::withCapacity(1);
    (**(code **)(*plVar1 + 0x1d0))(plVar1,"Descriptions",plVar3);
    (**(code **)(*plVar3 + 0x28))(plVar3);
  }
  else {
    plVar3 = (long *)OSMetaClassBase::safeMetaCast(pOVar2,*(OSMetaClass **)PTR_metaClass_0006b058);
  }
  plVar1 = (long *)OSString::withCString(param_2);
  (**(code **)(*plVar3 + 0x1b8))(plVar3,plVar1);
                    // WARNING: Could not recover jumptable at 0x00049aa6. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*plVar1 + 0x28))(plVar1);
  return;
}



// IOAccelAllocationInfo::addSurfaceDescription(IOAccelMemory*, unsigned int, char const*, unsigned
// int, unsigned int, char const*)

void __thiscall
IOAccelAllocationInfo::addSurfaceDescription
          (IOAccelAllocationInfo *this,ulong param_1,uint param_2,char *param_3,uint param_4,
          uint param_5,char *param_6)

{
  long *plVar1;
  long lVar2;
  long *plVar3;
  
  if ((*(uint *)(param_1 + 0xc) & 6) != 4) {
    plVar1 = (long *)lookupAllocation(this,param_1);
    lVar2 = (**(code **)(*plVar1 + 0x208))(plVar1,"IOAccelSurfaceID");
    if ((lVar2 == 0) || ((*(byte *)(param_1 + 0xc) & 0x20) == 0)) {
      plVar3 = (long *)OSNumber::withNumber((ulong)param_2,0x20);
      (**(code **)(*plVar1 + 0x1d0))(plVar1,"IOAccelSurfaceID",plVar3);
      (**(code **)(*plVar3 + 0x28))(plVar3);
      plVar3 = (long *)OSNumber::withNumber((ulong)param_4,0x20);
      (**(code **)(*plVar1 + 0x1d0))(plVar1,"IOAccelSurfaceWidth",plVar3);
      (**(code **)(*plVar3 + 0x28))(plVar3);
      plVar3 = (long *)OSNumber::withNumber((ulong)param_5,0x20);
      (**(code **)(*plVar1 + 0x1d0))(plVar1,"IOAccelSurfaceHeight",plVar3);
      (**(code **)(*plVar3 + 0x28))(plVar3);
      if (param_6 != (char *)0x0) {
        plVar3 = (long *)OSString::withCString(param_6);
        (**(code **)(*plVar1 + 0x1d0))(plVar1,"IOAccelSurfacePixelFormat",plVar3);
        (**(code **)(*plVar3 + 0x28))(plVar3);
      }
      plVar3 = (long *)OSString::withCString(param_3);
      (**(code **)(*plVar1 + 0x1d0))(plVar1,"IOAccelSurfaceBufferIndex",plVar3);
                    // WARNING: Could not recover jumptable at 0x00049bff. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*plVar3 + 0x28))(plVar3);
      return;
    }
  }
  return;
}



// IOAccelAllocationInfo::copyToArray()

long * __thiscall IOAccelAllocationInfo::copyToArray(IOAccelAllocationInfo *this)

{
  long *plVar1;
  undefined8 *puVar2;
  long lVar3;
  
  plVar1 = (long *)OSArray::withCapacity(1000);
  lVar3 = 0;
  do {
    for (puVar2 = *(undefined8 **)(this + lVar3 * 8 + 0x18); puVar2 != (undefined8 *)0x0;
        puVar2 = (undefined8 *)*puVar2) {
      (**(code **)(*plVar1 + 0x1b8))(plVar1,puVar2[2]);
    }
    lVar3 = lVar3 + 1;
  } while (lVar3 != 0x80);
  if (*(long *)(this + 0x418) != 0) {
    (**(code **)(*plVar1 + 0x1c8))(plVar1);
  }
  if (*(long *)(this + 0x420) != 0) {
    (**(code **)(*plVar1 + 0x1c8))(plVar1);
  }
  if (*(long *)(this + 0x428) != 0) {
    (**(code **)(*plVar1 + 0x1c8))(plVar1);
  }
  return plVar1;
}



// IOAccelAllocationInfo::declareIOSurfaceBackingStore(IOMemoryDescriptor*, unsigned int, int*, int)

void __thiscall
IOAccelAllocationInfo::declareIOSurfaceBackingStore
          (IOAccelAllocationInfo *this,ulonglong *param_1,uint param_2,long param_3,uint param_4)

{
  undefined *puVar1;
  int iVar2;
  undefined8 uVar3;
  long *plVar4;
  long *plVar5;
  ulonglong uVar6;
  long *plVar7;
  long *plVar8;
  ulong uVar9;
  ulonglong local_138 [32];
  long local_38;
  
  local_38 = *(long *)PTR____stack_chk_guard_0006b0b0;
  if (*(long *)(this + 0x420) == 0) {
    uVar3 = OSArray::withCapacity(1);
    *(undefined8 *)(this + 0x420) = uVar3;
  }
  plVar4 = (long *)OSDictionary::withCapacity(1);
  plVar5 = (long *)OSSymbol::withCString("SysMem");
  (**(code **)(*plVar4 + 0x1d0))(plVar4,"MemoryPool",plVar5);
  (**(code **)(*plVar5 + 0x28))(plVar5);
  uVar6 = (**(code **)(*param_1 + 0x1c8))(param_1);
  plVar5 = (long *)OSNumber::withNumber(uVar6,0x40);
  (**(code **)(*plVar4 + 0x1d0))(plVar4,"Size",plVar5);
  (**(code **)(*plVar5 + 0x28))(plVar5);
  _memset(local_138,0xaa,0x100);
  _snprintf((char *)local_138,0x100,"%s",*(char **)(*(long *)(this + 0x10) + 0xc88));
  plVar5 = (long *)OSSymbol::withCString((char *)local_138);
  plVar7 = (long *)OSArray::withCapacity(1);
  (**(code **)(*plVar7 + 0x1b8))(plVar7,plVar5);
  (**(code **)(*plVar5 + 0x28))(plVar5);
  (**(code **)(*plVar4 + 0x1d0))(plVar4,"Devices",plVar7);
  (**(code **)(*plVar7 + 0x28))(plVar7);
  local_138[0] = 0;
  iVar2 = IOMemoryDescriptor::getPageCounts(param_1,local_138);
  puVar1 = PTR__page_size_0006b108;
  if (iVar2 == 0) {
    plVar5 = (long *)OSNumber::withNumber(0,0x40);
    (**(code **)(*plVar4 + 0x1d0))(plVar4,"DirtySize",plVar5);
    (**(code **)(*plVar5 + 0x28))(plVar5);
    plVar5 = (long *)OSNumber::withNumber(*(long *)puVar1 * local_138[0],0x40);
    (**(code **)(*plVar4 + 0x1d0))(plVar4,"ResidentSize",plVar5);
    (**(code **)(*plVar5 + 0x28))(plVar5);
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: IOMemoryDescriptor::getPageCounts returned 0x%08x\n",
                      "void IOAccelAllocationInfo::declareIOSurfaceBackingStore(IOMemoryDescriptor *, uint32_t, int *, int)"
                      ,iVar2);
  }
  iVar2 = (**(code **)(*param_1 + 0x120))(param_1,1);
  if (iVar2 == 0) {
    plVar5 = (long *)OSBoolean::withBoolean(false);
    (**(code **)(*plVar4 + 0x1d0))(plVar4,"Purgeable",plVar5);
    (**(code **)(*plVar5 + 0x28))(plVar5);
  }
  plVar5 = (long *)OSNumber::withNumber((ulong)param_2,0x20);
  (**(code **)(*plVar4 + 0x1d0))(plVar4,"IOSurfaceID",plVar5);
  (**(code **)(*plVar5 + 0x28))(plVar5);
  plVar5 = (long *)OSArray::withCapacity(1);
  (**(code **)(*plVar4 + 0x1d0))(plVar4,"Descriptions",plVar5);
  (**(code **)(*plVar5 + 0x28))(plVar5);
  plVar7 = (long *)OSString::withCString("IOSurface Backing Store");
  (**(code **)(*plVar5 + 0x1b8))(plVar5,plVar7);
  (**(code **)(*plVar7 + 0x28))();
  plVar5 = (long *)OSBoolean::withBoolean(false);
  (**(code **)(*plVar4 + 0x1d0))(plVar4,"CachedCopy",plVar5);
  (**(code **)(*plVar5 + 0x28))(plVar5);
  if (param_4 != 0) {
    plVar5 = (long *)OSArray::withCapacity(param_4);
    if (0 < (int)param_4) {
      uVar9 = 0;
      do {
        plVar7 = (long *)OSDictionary::withCapacity(1);
        plVar8 = (long *)OSNumber::withNumber((long)*(int *)(param_3 + uVar9 * 4),0x20);
        (**(code **)(*plVar7 + 0x1d0))(plVar7,"PID",plVar8);
        (**(code **)(*plVar8 + 0x28))(plVar8);
        (**(code **)(*plVar5 + 0x1b8))(plVar5,plVar7);
        (**(code **)(*plVar7 + 0x28))(plVar7);
        uVar9 = uVar9 + 1;
      } while (param_4 != uVar9);
    }
    (**(code **)(*plVar4 + 0x1d0))(plVar4,"Processes",plVar5);
    (**(code **)(*plVar5 + 0x28))(plVar5);
  }
  (**(code **)(**(long **)(this + 0x420) + 0x1b8))(*(long **)(this + 0x420),plVar4);
  (**(code **)(*plVar4 + 0x28))(plVar4);
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_38) {
    return;
  }
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelAllocationInfo::declareDeviceShmem(int, IOMemoryDescriptor*, unsigned long long)

void __cdecl IOAccelAllocationInfo::declareDeviceShmem(long param_1,int param_2,ulonglong *param_3)

{
  undefined *puVar1;
  int iVar2;
  undefined8 uVar3;
  long *plVar4;
  long *plVar5;
  ulonglong uVar6;
  long *plVar7;
  long *plVar8;
  ulonglong local_138 [32];
  long local_38;
  
  local_38 = *(long *)PTR____stack_chk_guard_0006b0b0;
  if (*(long *)(param_1 + 0x428) == 0) {
    uVar3 = OSArray::withCapacity(1);
    *(undefined8 *)(param_1 + 0x428) = uVar3;
  }
  plVar4 = (long *)OSDictionary::withCapacity(1);
  plVar5 = (long *)OSSymbol::withCString("SysMem");
  (**(code **)(*plVar4 + 0x1d0))(plVar4,"MemoryPool",plVar5);
  (**(code **)(*plVar5 + 0x28))(plVar5);
  uVar6 = (**(code **)(*param_3 + 0x1c8))(param_3);
  plVar5 = (long *)OSNumber::withNumber(uVar6,0x40);
  (**(code **)(*plVar4 + 0x1d0))(plVar4,"Size",plVar5);
  (**(code **)(*plVar5 + 0x28))(plVar5);
  _memset(local_138,0xaa,0x100);
  _snprintf((char *)local_138,0x100,"%s",*(char **)(*(long *)(param_1 + 0x10) + 0xc88));
  plVar5 = (long *)OSSymbol::withCString((char *)local_138);
  plVar7 = (long *)OSArray::withCapacity(1);
  (**(code **)(*plVar7 + 0x1b8))(plVar7,plVar5);
  (**(code **)(*plVar5 + 0x28))(plVar5);
  (**(code **)(*plVar4 + 0x1d0))(plVar4,"Devices",plVar7);
  (**(code **)(*plVar7 + 0x28))(plVar7);
  local_138[0] = 0;
  iVar2 = IOMemoryDescriptor::getPageCounts(param_3,local_138);
  puVar1 = PTR__page_size_0006b108;
  if (iVar2 == 0) {
    plVar5 = (long *)OSNumber::withNumber(0,0x40);
    (**(code **)(*plVar4 + 0x1d0))(plVar4,"DirtySize",plVar5);
    (**(code **)(*plVar5 + 0x28))(plVar5);
    plVar5 = (long *)OSNumber::withNumber(*(long *)puVar1 * local_138[0],0x40);
    (**(code **)(*plVar4 + 0x1d0))(plVar4,"ResidentSize",plVar5);
    (**(code **)(*plVar5 + 0x28))(plVar5);
  }
  else {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: IOMemoryDescriptor::getPageCounts returned 0x%08x\n",
                      "void IOAccelAllocationInfo::declareDeviceShmem(pid_t, IOMemoryDescriptor *, mach_vm_address_t)"
                      ,iVar2);
  }
  iVar2 = (**(code **)(*param_3 + 0x120))(param_3,1);
  if (iVar2 == 0) {
    plVar5 = (long *)OSBoolean::withBoolean(false);
    (**(code **)(*plVar4 + 0x1d0))(plVar4,"Purgeable",plVar5);
    (**(code **)(*plVar5 + 0x28))(plVar5);
  }
  plVar5 = (long *)OSArray::withCapacity(1);
  (**(code **)(*plVar4 + 0x1d0))(plVar4,"Descriptions",plVar5);
  (**(code **)(*plVar5 + 0x28))(plVar5);
  plVar7 = (long *)OSString::withCString("Metal Device Shmem");
  (**(code **)(*plVar5 + 0x1b8))(plVar5,plVar7);
  (**(code **)(*plVar7 + 0x28))(plVar7);
  plVar5 = (long *)OSArray::withCapacity(1);
  plVar7 = (long *)OSDictionary::withCapacity(1);
  plVar8 = (long *)OSNumber::withNumber((long)param_2,0x20);
  (**(code **)(*plVar7 + 0x1d0))(plVar7,"PID",plVar8);
  (**(code **)(*plVar8 + 0x28))(plVar8);
  (**(code **)(*plVar5 + 0x1b8))(plVar5,plVar7);
  (**(code **)(*plVar7 + 0x28))(plVar7);
  (**(code **)(*plVar4 + 0x1d0))(plVar4,"Processes",plVar5);
  (**(code **)(*plVar5 + 0x28))(plVar5);
  (**(code **)(**(long **)(param_1 + 0x428) + 0x1b8))(*(long **)(param_1 + 0x428),plVar4);
  (**(code **)(*plVar4 + 0x28))(plVar4);
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_38) {
    return;
  }
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// IOAccelAllocationInfo::declareAdditionalSystemMemory(unsigned long long, int, char const*)

void __thiscall
IOAccelAllocationInfo::declareAdditionalSystemMemory
          (IOAccelAllocationInfo *this,ulonglong param_1,int param_2,char *param_3)

{
  undefined8 uVar1;
  long *plVar2;
  long *plVar3;
  long *plVar4;
  char local_138 [256];
  long local_38;
  
  local_38 = *(long *)PTR____stack_chk_guard_0006b0b0;
  if (*(long *)(this + 0x418) == 0) {
    uVar1 = OSArray::withCapacity(1);
    *(undefined8 *)(this + 0x418) = uVar1;
  }
  plVar2 = (long *)OSDictionary::withCapacity(1);
  plVar3 = (long *)OSSymbol::withCString("SysMem");
  (**(code **)(*plVar2 + 0x1d0))(plVar2,"MemoryPool",plVar3);
  (**(code **)(*plVar3 + 0x28))(plVar3);
  plVar3 = (long *)OSNumber::withNumber(param_1,0x40);
  (**(code **)(*plVar2 + 0x1d0))(plVar2,"Size",plVar3);
  (**(code **)(*plVar3 + 0x28))(plVar3);
  _memset(local_138,0xaa,0x100);
  _snprintf(local_138,0x100,"%s",*(char **)(*(long *)(this + 0x10) + 0xc88));
  plVar3 = (long *)OSSymbol::withCString(local_138);
  plVar4 = (long *)OSArray::withCapacity(1);
  (**(code **)(*plVar4 + 0x1b8))(plVar4,plVar3);
  (**(code **)(*plVar3 + 0x28))(plVar3);
  (**(code **)(*plVar2 + 0x1d0))(plVar2,"Devices",plVar4);
  (**(code **)(*plVar4 + 0x28))(plVar4);
  plVar3 = (long *)OSArray::withCapacity(1);
  (**(code **)(*plVar2 + 0x1d0))(plVar2,"Descriptions",plVar3);
  (**(code **)(*plVar3 + 0x28))(plVar3);
  plVar4 = (long *)OSString::withCString(param_3);
  (**(code **)(*plVar3 + 0x1b8))(plVar3,plVar4);
  (**(code **)(*plVar4 + 0x28))(plVar4);
  if (param_2 != 0) {
    plVar3 = (long *)OSDictionary::withCapacity(1);
    plVar4 = (long *)OSNumber::withNumber((long)param_2,0x20);
    (**(code **)(*plVar3 + 0x1d0))(plVar3,"PID",plVar4);
    (**(code **)(*plVar4 + 0x28))(plVar4);
    plVar4 = (long *)OSArray::withCapacity(1);
    (**(code **)(*plVar4 + 0x1b8))(plVar4,plVar3);
    (**(code **)(*plVar3 + 0x28))(plVar3);
    (**(code **)(*plVar2 + 0x1d0))(plVar2,"Processes",plVar4);
    (**(code **)(*plVar4 + 0x28))(plVar4);
  }
  (**(code **)(**(long **)(this + 0x418) + 0x1b8))(*(long **)(this + 0x418),plVar2);
  (**(code **)(*plVar2 + 0x28))(plVar2);
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_38) {
    return;
  }
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// IOAccelAllocationInfo::setCacheCopy(IOAccelMemory*)

void __thiscall IOAccelAllocationInfo::setCacheCopy(IOAccelAllocationInfo *this,ulong param_1)

{
  long *plVar1;
  long lVar2;
  long *plVar3;
  
  plVar1 = (long *)lookupAllocation(this,param_1);
  if ((*(uint *)(param_1 + 0xc) & 6) != 4) {
    lVar2 = (**(code **)(*plVar1 + 0x208))(plVar1,"CachedCopy");
    if (lVar2 == 0) {
      plVar3 = (long *)OSBoolean::withBoolean(true);
      (**(code **)(*plVar1 + 0x1d0))(plVar1,"CachedCopy",plVar3);
                    // WARNING: Could not recover jumptable at 0x0004a75e. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*plVar3 + 0x28))(plVar3);
      return;
    }
  }
  return;
}



// IOAccelAllocationInfo::MetaClass::~MetaClass()

void __thiscall IOAccelAllocationInfo::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelAllocationInfo_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelAllocationInfo::gMetaClass,"IOAccelAllocationInfo",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x430);
  _gMetaClass = &PTR__MetaClass_0007e4f0;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelAllocationInfo::gMetaClass);
  return;
}



// IOAccelDisplayPipe::MetaClass::MetaClass()

void __thiscall IOAccelDisplayPipe::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDisplayPipe",(OSMetaClass *)PTR_gMetaClass_0006b070,0x318);
  *(undefined ***)this = &PTR__MetaClass_0007ef90;
  return;
}



// IOAccelDisplayPipe::MetaClass::~MetaClass()

void __thiscall IOAccelDisplayPipe::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelDisplayPipe::IOAccelDisplayPipe(OSMetaClass const*)

void __thiscall
IOAccelDisplayPipe::IOAccelDisplayPipe(IOAccelDisplayPipe *this,OSMetaClass *param_1)

{
  IOService::IOService((IOService *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDisplayPipe_0007e5e8;
  return;
}



// IOAccelDisplayPipe::IOAccelDisplayPipe(OSMetaClass const*)

void __thiscall
IOAccelDisplayPipe::IOAccelDisplayPipe(IOAccelDisplayPipe *this,OSMetaClass *param_1)

{
  IOService::IOService((IOService *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDisplayPipe_0007e5e8;
  return;
}



// IOAccelDisplayPipe::~IOAccelDisplayPipe()

void __thiscall IOAccelDisplayPipe::~IOAccelDisplayPipe(IOAccelDisplayPipe *this)

{
  IOService::~IOService((IOService *)this);
  return;
}



// IOAccelDisplayPipe::~IOAccelDisplayPipe()

void __thiscall IOAccelDisplayPipe::~IOAccelDisplayPipe(IOAccelDisplayPipe *this)

{
  IOService::~IOService((IOService *)this);
  return;
}



// IOAccelDisplayPipe::~IOAccelDisplayPipe()

void __thiscall IOAccelDisplayPipe::~IOAccelDisplayPipe(IOAccelDisplayPipe *this)

{
  IOService::~IOService((IOService *)this);
  _OSObject_typed_operator_delete(&IOAccelDisplayPipe_ktv,this,0x318);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipe::operator delete(void*, unsigned long)

void __cdecl IOAccelDisplayPipe::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelDisplayPipe_ktv,param_1,param_2);
  return;
}



// IOAccelDisplayPipe::getMetaClass() const

undefined1 * IOAccelDisplayPipe::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelDisplayPipe::MetaClass::MetaClass()

void __thiscall IOAccelDisplayPipe::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDisplayPipe",(OSMetaClass *)PTR_gMetaClass_0006b070,0x318);
  *(undefined ***)this = &PTR__MetaClass_0007ef90;
  return;
}



// IOAccelDisplayPipe::MetaClass::alloc() const

IOService * IOAccelDisplayPipe::MetaClass::alloc(void)

{
  IOService *this;
  
  this = (IOService *)_OSObject_typed_operator_new(&IOAccelDisplayPipe_ktv,0x318);
  IOService::IOService(this,(OSMetaClass *)&IOAccelDisplayPipe::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipe_0007e5e8;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelDisplayPipe::operator new(unsigned long)

void * __thiscall IOAccelDisplayPipe::operator_new(IOAccelDisplayPipe *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelDisplayPipe_ktv,this);
  return pvVar1;
}



// IOAccelDisplayPipe::IOAccelDisplayPipe()

void __thiscall IOAccelDisplayPipe::IOAccelDisplayPipe(IOAccelDisplayPipe *this)

{
  IOService::IOService((IOService *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipe_0007e5e8;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDisplayPipe::IOAccelDisplayPipe()

void __thiscall IOAccelDisplayPipe::IOAccelDisplayPipe(IOAccelDisplayPipe *this)

{
  IOService::IOService((IOService *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipe_0007e5e8;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDisplayPipe::init(IOGraphicsAccelerator2*, IOAccelDisplayMachine*, IOFramebuffer*,
// unsigned int)

ulong __thiscall
IOAccelDisplayPipe::init
          (IOAccelDisplayPipe *this,undefined8 param_1,undefined8 param_2,
          _func_int_OSObject_ptr_void_ptr_IOFramebuffer_ptr_int_void_ptr *param_3,uint param_4)

{
  uint uVar1;
  char cVar2;
  long lVar3;
  undefined8 uVar4;
  ulong uVar5;
  undefined4 local_240;
  uint local_23c;
  undefined1 local_238 [512];
  long local_38;
  
  local_38 = *(long *)PTR____stack_chk_guard_0006b0b0;
  local_23c = param_4;
  _memset(local_238,0xaa,0x200);
  local_240 = 0x200;
  uVar5 = 0;
  cVar2 = (**(code **)(PTR_vtable_0006b0a8 + 600))(this,0);
  if (cVar2 == '\0') goto LAB_0004ac27;
  lVar3 = _IOLockAlloc();
  uVar1 = local_23c;
  *(long *)(this + 0xa8) = lVar3;
  if (lVar3 != 0) {
    *(undefined8 *)(this + 0x88) = param_1;
    *(undefined8 *)(this + 0x90) = param_2;
    *(_func_int_OSObject_ptr_void_ptr_IOFramebuffer_ptr_int_void_ptr **)(this + 0x98) = param_3;
    *(uint *)(this + 0x284) = local_23c;
    lVar3 = _IOMallocTypeImpl(&init(IOGraphicsAccelerator2*,IOAccelDisplayMachine*,IOFramebuffer*,unsigned_int)
                               ::kalloc_type_view_67);
    *(long *)(this + 0x240) = lVar3;
    if (lVar3 != 0) {
      lVar3 = _IOMallocTypeImpl(&init(IOGraphicsAccelerator2*,IOAccelDisplayMachine*,IOFramebuffer*,unsigned_int)
                                 ::kalloc_type_view_71);
      *(long *)(this + 0x2b8) = lVar3;
      if (lVar3 == 0) {
        uVar5 = 0;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: Failed to allocate VRR TimeStamp Info\n",
                          "virtual bool IOAccelDisplayPipe::init(IOGraphicsAccelerator2 *, IOAccelDisplayMachine *, IOFramebuffer *, uint32_t)"
                         );
        goto LAB_0004ac27;
      }
      *(undefined8 *)(this + 0xf8) = 0;
      *(IOAccelDisplayPipe **)(this + 0x100) = this + 0xf8;
      *(undefined8 *)(this + 0x108) = 0;
      *(IOAccelDisplayPipe **)(this + 0x110) = this + 0x108;
      *(undefined8 *)(this + 600) = 0;
      *(IOAccelDisplayPipe **)(this + 0x260) = this + 600;
      lVar3 = 0x118;
      do {
        (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x140))
                  (*(long **)(*(long *)(this + 0x88) + 0x380),this + lVar3);
        lVar3 = lVar3 + 0x48;
      } while (lVar3 != 0x238);
      lVar3 = (**(code **)(**(long **)(this + 0x88) + 0x8d0))(*(long **)(this + 0x88),0,0x40);
      *(long *)(this + 0xe0) = lVar3;
      *(byte *)(lVar3 + 0xc) = *(byte *)(lVar3 + 0xc) | 0x10;
      *(uint *)(*(long *)(this + 0xe0) + 0xc) = *(uint *)(*(long *)(this + 0xe0) + 0xc) & 0xfffeffff
      ;
      IOAccelResource2::updateReadWriteBits(*(IOAccelResource2 **)(this + 0xe0),1,'\x01');
      *(undefined8 *)(this + 0xf0) = 0;
      lVar3 = IOFramebuffer::addFramebufferNotificationWithOptions
                        (param_3,(OSObject *)display_change_handler,this,uVar1,0x170,0);
      *(long *)(this + 0xa0) = lVar3;
      if (lVar3 == 0) {
        uVar5 = 0;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: failed to add display change notification\n",
                          "virtual bool IOAccelDisplayPipe::init(IOGraphicsAccelerator2 *, IOAccelDisplayMachine *, IOFramebuffer *, uint32_t)"
                         );
        goto LAB_0004ac27;
      }
      uVar4 = (**(code **)(**(long **)(this + 0x88) + 0x2b8))
                        (*(long **)(this + 0x88),"IOCFPlugInTypes");
      (**(code **)(*(long *)param_3 + 0x268))(param_3,"IOCFPlugInTypes",uVar4);
      cVar2 = (**(code **)(**(long **)(this + 0x88) + 0x3d8))
                        (*(long **)(this + 0x88),local_238,&local_240,
                         *(undefined8 *)PTR__gIOServicePlane_0006b0c8);
      if (cVar2 != '\0') {
        (**(code **)(*(long *)param_3 + 0x270))(param_3,"IOAccelTypes",local_238);
        (**(code **)(*(long *)param_3 + 0x280))(param_3,"IOAccelIndex",uVar1,0x20);
        (**(code **)(*(long *)param_3 + 0x280))(param_3,"IOAccelRevision",2,0x20);
        this[0x2ac] = (IOAccelDisplayPipe)0x0;
        uVar4 = _IOMallocData(0x30);
        *(undefined8 *)(this + 0x2b0) = uVar4;
        uVar5 = CONCAT71((int7)((ulong)param_3 >> 8),1);
        goto LAB_0004ac27;
      }
    }
  }
  uVar5 = 0;
LAB_0004ac27:
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_38) {
    return uVar5 & 0xffffffff;
  }
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// IOAccelDisplayPipe::display_change_handler(void*, IOFramebuffer*, int, void*)

undefined4 __thiscall
IOAccelDisplayPipe::display_change_handler
          (IOAccelDisplayPipe *this,uint param_1,undefined8 param_3_00,int param_3,long param_4)

{
  IOGraphicsAccelerator2 *pIVar1;
  char cVar2;
  ulong uVar3;
  uint64_t uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined1 *local_48;
  uint64_t local_40;
  long local_38;
  
  local_38 = param_4;
  local_40 = _mach_absolute_time();
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s event = <%d> at <%llu>\n",
                    "IOReturn IOAccelDisplayPipe::display_change_handler(void *, IOFramebuffer *, IOIndex, void *)"
                    ,param_3,local_40);
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x88);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  IOGraphicsAccelerator2::find_vram_descriptor(*(IOGraphicsAccelerator2 **)(this + 0x88));
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x88);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  *(int *)(this + 0x300) = param_3;
  *(uint *)(this + 0x304) = param_1;
  uVar6 = 0xe00002bc;
  switch(param_3) {
  case 1:
    if (*(long *)(this + 0x2b0) != 0) {
      uVar4 = _mach_absolute_time();
      *(uint64_t *)(*(long *)(this + 0x2b0) + 0x20) = uVar4;
    }
    cVar2 = (**(code **)(**(long **)(this + 0x90) + 0x8c8))(*(long **)(this + 0x90),param_1);
    goto LAB_0004af2d;
  case 2:
    cVar2 = (**(code **)(**(long **)(this + 0x90) + 0x8d0))(*(long **)(this + 0x90),param_1);
    if ((cVar2 != '\0') && (uVar6 = 0, *(long *)(this + 0x2b0) != 0)) {
      uVar4 = _mach_absolute_time();
      *(uint64_t *)(*(long *)(this + 0x2b0) + 0x28) = uVar4;
    }
    break;
  case 3:
    if (*(long *)(this + 0x2b0) != 0) {
      uVar4 = _mach_absolute_time();
      *(uint64_t *)(*(long *)(this + 0x2b0) + 0x10) = uVar4;
    }
    uVar3 = IOGraphicsAccelerator2::system_will_sleep
                      (*(IOGraphicsAccelerator2 **)(this + 0x88),3,(uint)(local_38 != 0));
    cVar2 = (char)uVar3;
    goto LAB_0004af2d;
  case 4:
    uVar3 = IOGraphicsAccelerator2::system_did_wake
                      (*(IOGraphicsAccelerator2 **)(this + 0x88),4,(uint)(local_38 != 0));
    if (((char)uVar3 != '\0') && (uVar6 = 0, *(long *)(this + 0x2b0) != 0)) {
      uVar4 = _mach_absolute_time();
      *(uint64_t *)(*(long *)(this + 0x2b0) + 0x18) = uVar4;
    }
    break;
  case 5:
  case 6:
    break;
  case 7:
    if (*(long *)(this + 0x2b0) != 0) {
      uVar4 = _mach_absolute_time();
      **(uint64_t **)(this + 0x2b0) = uVar4;
    }
    cVar2 = (**(code **)(**(long **)(this + 0x90) + 0x8b8))(*(long **)(this + 0x90),param_1);
LAB_0004af2d:
    uVar6 = 0xe00002bc;
    if (cVar2 != '\0') {
      uVar6 = 0;
    }
    break;
  case 8:
    cVar2 = (**(code **)(**(long **)(this + 0x90) + 0x8c0))(*(long **)(this + 0x90),param_1);
    if ((cVar2 != '\0') && (uVar6 = 0, *(long *)(this + 0x2b0) != 0)) {
      uVar4 = _mach_absolute_time();
      *(uint64_t *)(*(long *)(this + 0x2b0) + 8) = uVar4;
    }
    break;
  case 9:
    IOGraphicsAccelerator2::system_will_change_speed(*(IOGraphicsAccelerator2 **)(this + 0x88));
    goto LAB_0004afe4;
  case 10:
    IOGraphicsAccelerator2::system_did_change_speed(*(IOGraphicsAccelerator2 **)(this + 0x88));
    goto LAB_0004afe4;
  default:
    uVar5 = (undefined4)local_38;
    switch(param_3) {
    case 0x5a:
      IOAccelDisplayMachine::wsaa_will_enter_defer
                (*(IOAccelDisplayMachine **)(this + 0x90),param_1,uVar5);
      break;
    case 0x5b:
      IOAccelDisplayMachine::wsaa_will_exit_defer
                (*(IOAccelDisplayMachine **)(this + 0x90),param_1,uVar5);
      break;
    case 0x5c:
      IOAccelDisplayMachine::wsaa_did_enter_defer
                (*(IOAccelDisplayMachine **)(this + 0x90),param_1,uVar5);
      break;
    case 0x5d:
      IOAccelDisplayMachine::wsaa_did_exit_defer
                (*(IOAccelDisplayMachine **)(this + 0x90),param_1,uVar5);
      break;
    case 0x5e:
    case 0x5f:
    case 0x60:
    case 0x61:
    case 0x62:
    case 99:
      goto switchD_0004adbb_caseD_5;
    case 100:
      IOAccelDisplayMachine::framebuffer_terminated
                (*(IOAccelDisplayMachine **)(this + 0x90),(ulong)param_1);
      break;
    default:
      if (param_3 != 0x28) goto switchD_0004adbb_caseD_5;
      framebuffer_online_status_changed(this,(uint)(local_38 != 0));
    }
LAB_0004afe4:
    uVar6 = 0;
  }
switchD_0004adbb_caseD_5:
  uVar4 = _mach_absolute_time();
  _absolutetime_to_nanoseconds(uVar4 - local_40,&local_48);
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s completed at <%llu> taking <%llu> ns\n"
                    ,
                    "IOReturn IOAccelDisplayPipe::display_change_handler(void *, IOFramebuffer *, IOIndex, void *)"
                    ,uVar4,local_48);
  return uVar6;
}



// IOAccelDisplayPipe::free()

void __thiscall IOAccelDisplayPipe::free(IOAccelDisplayPipe *this)

{
  undefined8 uVar1;
  bool bVar2;
  long *plVar3;
  long lVar4;
  bool bVar5;
  
  finishTransactionQueue(this);
  releaseLiveTransaction(this);
  teardown_workloop(this);
  if (*(long **)(this + 0xa0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xa0) + 0x118))();
    *(undefined8 *)(this + 0xa0) = 0;
  }
  *(undefined8 *)(this + 0x98) = 0;
  *(undefined4 *)(this + 0x284) = 0xffffffff;
  plVar3 = *(long **)(this + 0xe0);
  *(undefined8 *)(this + 0xe0) = 0;
  (**(code **)(*plVar3 + 0x28))();
  plVar3 = *(long **)(this + 0x240);
  if (plVar3 != (long *)0x0) {
    if ((long *)*plVar3 != (long *)0x0) {
      (**(code **)(*(long *)*plVar3 + 0x28))();
      plVar3 = *(long **)(this + 0x240);
      *plVar3 = 0;
    }
    if ((long *)plVar3[1] != (long *)0x0) {
      (**(code **)(*(long *)plVar3[1] + 0x28))();
      plVar3 = *(long **)(this + 0x240);
      plVar3[1] = 0;
    }
    if ((long *)plVar3[0x2b] != (long *)0x0) {
      (**(code **)(*(long *)plVar3[0x2b] + 0x28))();
      plVar3 = *(long **)(this + 0x240);
      plVar3[0x2b] = 0;
    }
    if ((long *)plVar3[0x2c] != (long *)0x0) {
      (**(code **)(*(long *)plVar3[0x2c] + 0x28))();
      plVar3 = *(long **)(this + 0x240);
      plVar3[0x2c] = 0;
    }
    lVar4 = 0;
    bVar2 = true;
    do {
      bVar5 = bVar2;
      if ((long *)plVar3[lVar4 * 0xe + 8] != (long *)0x0) {
        (**(code **)(*(long *)plVar3[lVar4 * 0xe + 8] + 0x28))();
        plVar3 = *(long **)(this + 0x240);
        plVar3[lVar4 * 0xe + 8] = 0;
      }
      lVar4 = 1;
      bVar2 = false;
    } while (bVar5);
    uVar1 = *(undefined8 *)(this + 0x240);
    *(undefined8 *)(this + 0x240) = 0;
    _IOFreeTypeImpl(&free()::kalloc_type_view_171,uVar1);
  }
  if (*(long *)(this + 0x2b8) != 0) {
    *(undefined8 *)(this + 0x2b8) = 0;
    _IOFreeTypeImpl(&free()::kalloc_type_view_176);
  }
  if (*(long *)(this + 0xa8) != 0) {
    _IOLockFree();
  }
  lVar4 = *(long *)(this + 0x2b0);
  if (lVar4 != 0) {
    *(undefined8 *)(this + 0x2b0) = 0;
    _IOFreeData(lVar4,0x30);
  }
                    // WARNING: Could not recover jumptable at 0x0004b258. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a8 + 0xa0))(this);
  return;
}



// IOAccelDisplayPipe::finishTransactionQueue()

void __thiscall IOAccelDisplayPipe::finishTransactionQueue(IOAccelDisplayPipe *this)

{
  long *plVar1;
  undefined8 local_20;
  undefined8 *local_18;
  
  plVar1 = *(long **)(this + 0xb0);
  if (plVar1 != (long *)0x0) {
    (**(code **)(*plVar1 + 0x1c8))(plVar1,transaction_queue_idle_gated,0,0,0,0);
    local_18 = &local_20;
    local_20 = 0;
    plVar1 = *(long **)(this + 0xb0);
    if (plVar1 != (long *)0x0) {
      (**(code **)(*plVar1 + 0x1c8))(plVar1,get_finished_transactions_gated,&local_20,0,0,0);
    }
    IOGraphicsAccelerator2::accel_transaction_finished(*(undefined8 *)(this + 0x88),&local_20);
  }
  return;
}



// IOAccelDisplayPipe::releaseLiveTransaction()

void __thiscall IOAccelDisplayPipe::releaseLiveTransaction(IOAccelDisplayPipe *this)

{
  long *plVar1;
  undefined1 *local_68;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  undefined8 local_28;
  undefined8 *local_20;
  
  local_30 = &DAT_aaaaaaaaaaaaaaaa;
  local_38 = &DAT_aaaaaaaaaaaaaaaa;
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = &DAT_aaaaaaaaaaaaaaaa;
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_58 = &DAT_aaaaaaaaaaaaaaaa;
  local_60 = &DAT_aaaaaaaaaaaaaaaa;
  local_68 = &DAT_aaaaaaaaaaaaaaaa;
  (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x140))
            (*(long **)(*(long *)(this + 0x88) + 0x380),&local_68);
  set_current_plane_resources(this,&local_68,0,(long *)0x0,(long *)0x0);
  set_current_plane_resources(this,&local_68,1,(long *)0x0,(long *)0x0);
  plVar1 = *(long **)(this + 0xb0);
  if (plVar1 != (long *)0x0) {
    (**(code **)(*plVar1 + 0x1c8))(plVar1,release_live_transaction_gated,0,0,0,0);
    local_20 = &local_28;
    local_28 = 0;
    plVar1 = *(long **)(this + 0xb0);
    if (plVar1 != (long *)0x0) {
      (**(code **)(*plVar1 + 0x1c8))(plVar1,get_finished_transactions_gated,&local_28,0,0,0);
    }
    IOGraphicsAccelerator2::accel_transaction_finished(*(undefined8 *)(this + 0x88),&local_28);
  }
  return;
}



// IOAccelDisplayPipe::teardown_workloop()

void __thiscall IOAccelDisplayPipe::teardown_workloop(IOAccelDisplayPipe *this)

{
  long *plVar1;
  
  plVar1 = *(long **)(this + 0xb0);
  if (plVar1 != (long *)0x0) {
    (**(code **)(*plVar1 + 0x1c8))(plVar1,teardown_workloop_gated,0,0,0,0);
  }
  if (*(long **)(this + 0x2f0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x2f0) + 0x28))();
  }
  *(undefined8 *)(this + 0x2f0) = 0;
  if (*(long **)(this + 0xd0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xd0) + 0x28))();
  }
  *(undefined8 *)(this + 0xd0) = 0;
  if (*(long **)(this + 200) != (long *)0x0) {
    (**(code **)(**(long **)(this + 200) + 0x28))();
  }
  *(undefined8 *)(this + 200) = 0;
  if (*(long **)(this + 0xc0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xc0) + 0x28))();
  }
  *(undefined8 *)(this + 0xc0) = 0;
  if (*(long **)(this + 0x2c8) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x2c8) + 0x28))();
  }
  *(undefined8 *)(this + 0x2c8) = 0;
  if (*(long **)(this + 0xb0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xb0) + 0x28))();
  }
  *(undefined8 *)(this + 0xb0) = 0;
  if (*(long **)(this + 0xb8) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xb8) + 0x28))();
  }
  *(undefined8 *)(this + 0xb8) = 0;
  return;
}



// IOAccelDisplayPipe::set_current_pipe_pregamma_table(IOAccelDisplayPipeGammaTable2*)

void __thiscall
IOAccelDisplayPipe::set_current_pipe_pregamma_table(IOAccelDisplayPipe *this,long *param_1)

{
  long *plVar1;
  long *plVar2;
  
  plVar2 = *(long **)(this + 0x240);
  plVar1 = (long *)*plVar2;
  if (plVar1 != param_1) {
    if (plVar1 != (long *)0x0) {
      (**(code **)(*plVar1 + 0x28))();
      plVar2 = *(long **)(this + 0x240);
      *plVar2 = 0;
    }
    if (param_1 != (long *)0x0) {
      *plVar2 = (long)param_1;
                    // WARNING: Could not recover jumptable at 0x0004b519. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*param_1 + 0x20))(param_1);
      return;
    }
  }
  return;
}



// IOAccelDisplayPipe::set_current_pipe_postgamma_table(IOAccelDisplayPipeGammaTable2*)

void __thiscall
IOAccelDisplayPipe::set_current_pipe_postgamma_table(IOAccelDisplayPipe *this,long *param_1)

{
  long *plVar1;
  long lVar2;
  
  lVar2 = *(long *)(this + 0x240);
  plVar1 = *(long **)(lVar2 + 8);
  if (plVar1 != param_1) {
    if (plVar1 != (long *)0x0) {
      (**(code **)(*plVar1 + 0x28))();
      lVar2 = *(long *)(this + 0x240);
      *(undefined8 *)(lVar2 + 8) = 0;
    }
    if (param_1 != (long *)0x0) {
      *(long **)(lVar2 + 8) = param_1;
                    // WARNING: Could not recover jumptable at 0x0004b56c. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*param_1 + 0x20))(param_1);
      return;
    }
  }
  return;
}



// IOAccelDisplayPipe::set_current_pipe_precsclinearization_vid(IOAccelDisplayPipePreCSCLinearizationVID*)

void __thiscall
IOAccelDisplayPipe::set_current_pipe_precsclinearization_vid(IOAccelDisplayPipe *this,long *param_1)

{
  long *plVar1;
  long lVar2;
  
  lVar2 = *(long *)(this + 0x240);
  plVar1 = *(long **)(lVar2 + 0x158);
  if (plVar1 != param_1) {
    if (plVar1 != (long *)0x0) {
      (**(code **)(*plVar1 + 0x28))();
      lVar2 = *(long *)(this + 0x240);
      *(undefined8 *)(lVar2 + 0x158) = 0;
    }
    if (param_1 != (long *)0x0) {
      *(long **)(lVar2 + 0x158) = param_1;
                    // WARNING: Could not recover jumptable at 0x0004b5c7. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*param_1 + 0x20))(param_1);
      return;
    }
  }
  return;
}



// IOAccelDisplayPipe::set_current_pipe_postcscgamma_vid(IOAccelDisplayPipePostCSCGammaVID*)

void __thiscall
IOAccelDisplayPipe::set_current_pipe_postcscgamma_vid(IOAccelDisplayPipe *this,long *param_1)

{
  long *plVar1;
  long lVar2;
  
  lVar2 = *(long *)(this + 0x240);
  plVar1 = *(long **)(lVar2 + 0x160);
  if (plVar1 != param_1) {
    if (plVar1 != (long *)0x0) {
      (**(code **)(*plVar1 + 0x28))();
      lVar2 = *(long *)(this + 0x240);
      *(undefined8 *)(lVar2 + 0x160) = 0;
    }
    if (param_1 != (long *)0x0) {
      *(long **)(lVar2 + 0x160) = param_1;
                    // WARNING: Could not recover jumptable at 0x0004b623. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*param_1 + 0x20))(param_1);
      return;
    }
  }
  return;
}



// IOAccelDisplayPipe::set_current_plane_gamma_table(unsigned int, IOAccelDisplayPipeGammaTable2*)

void __thiscall
IOAccelDisplayPipe::set_current_plane_gamma_table
          (IOAccelDisplayPipe *this,uint param_1,long *param_2)

{
  long *plVar1;
  long lVar2;
  long lVar3;
  
  lVar2 = *(long *)(this + 0x240);
  lVar3 = (ulong)param_1 * 0x70;
  plVar1 = *(long **)(lVar2 + 0x40 + lVar3);
  if (plVar1 != param_2) {
    if (plVar1 != (long *)0x0) {
      (**(code **)(*plVar1 + 0x28))();
      lVar2 = *(long *)(this + 0x240);
      *(undefined8 *)(lVar2 + 0x40 + lVar3) = 0;
    }
    if (param_2 != (long *)0x0) {
      *(long **)(lVar2 + 0x40 + lVar3) = param_2;
                    // WARNING: Could not recover jumptable at 0x0004b688. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*param_2 + 0x20))(param_2);
      return;
    }
  }
  return;
}



// IOAccelDisplayPipe::createWorkLoop()

long __thiscall IOAccelDisplayPipe::createWorkLoop(IOAccelDisplayPipe *this)

{
  long *plVar1;
  long lVar2;
  
  lVar2 = *(long *)(this + 0xb8);
  if (lVar2 == 0) {
    if ((*(byte *)(*(long *)(this + 0x88) + 0xcec) & 8) == 0) {
      plVar1 = (long *)IOAccelDisplayMachine::get_pipe_workloop
                                 (*(IOAccelDisplayMachine **)(this + 0x90));
      *(long **)(this + 0xb8) = plVar1;
      (**(code **)(*plVar1 + 0x20))(plVar1);
      lVar2 = *(long *)(this + 0xb8);
    }
    else {
      lVar2 = IOWorkLoop::workLoop();
      *(long *)(this + 0xb8) = lVar2;
    }
  }
  return lVar2;
}



// IOAccelDisplayPipe::isActive() const

bool __thiscall IOAccelDisplayPipe::isActive(IOAccelDisplayPipe *this)

{
  return this[0x298] != (IOAccelDisplayPipe)0x0;
}



// IOAccelDisplayPipe::getFramebufferIndex() const

undefined4 __thiscall IOAccelDisplayPipe::getFramebufferIndex(IOAccelDisplayPipe *this)

{
  return *(undefined4 *)(this + 0x284);
}



// IOAccelDisplayPipe::getWidth() const

undefined4 __thiscall IOAccelDisplayPipe::getWidth(IOAccelDisplayPipe *this)

{
  return *(undefined4 *)(this + 0x290);
}



// IOAccelDisplayPipe::getHeight() const

undefined2 __thiscall IOAccelDisplayPipe::getHeight(IOAccelDisplayPipe *this)

{
  return *(undefined2 *)(this + 0x294);
}



// IOAccelDisplayPipe::getFramebuffer() const

undefined8 __thiscall IOAccelDisplayPipe::getFramebuffer(IOAccelDisplayPipe *this)

{
  return *(undefined8 *)(this + 0x98);
}



// IOAccelDisplayPipe::getFramebufferResource(unsigned int) const

undefined8 __thiscall
IOAccelDisplayPipe::getFramebufferResource(IOAccelDisplayPipe *this,int param_1)

{
  if (param_1 != 0) {
    return 0;
  }
  return *(undefined8 *)(this + 0xe0);
}



// IOAccelDisplayPipe::willPowerOff()

void IOAccelDisplayPipe::willPowerOff(void)

{
  return;
}



// IOAccelDisplayPipe::framebuffer_will_power_off()

undefined8 __thiscall IOAccelDisplayPipe::framebuffer_will_power_off(IOAccelDisplayPipe *this)

{
  undefined8 uVar1;
  
  (**(code **)(*(long *)this + 0x918))();
  uVar1 = (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x158))();
  this[0x299] = (IOAccelDisplayPipe)0x1;
  return CONCAT71((int7)((ulong)uVar1 >> 8),1);
}



// IOAccelDisplayPipe::didPowerOn()

void IOAccelDisplayPipe::didPowerOn(void)

{
  return;
}



// IOAccelDisplayPipe::framebuffer_did_power_on()

undefined8 __thiscall IOAccelDisplayPipe::framebuffer_did_power_on(IOAccelDisplayPipe *this)

{
  undefined8 uVar1;
  
  this[0x299] = (IOAccelDisplayPipe)0x0;
  uVar1 = (**(code **)(*(long *)this + 0x920))();
  return CONCAT71((int7)((ulong)uVar1 >> 8),1);
}



// IOAccelDisplayPipe::framebufferTerminated()

void IOAccelDisplayPipe::framebufferTerminated(void)

{
  return;
}



// IOAccelDisplayPipe::framebuffer_terminated()

void __thiscall IOAccelDisplayPipe::framebuffer_terminated(IOAccelDisplayPipe *this)

{
  this[0x280] = (IOAccelDisplayPipe)0x1;
  (**(code **)(*(long *)this + 0x868))();
  releaseLiveTransaction(this);
  if (this[0x298] != (IOAccelDisplayPipe)0x0) {
    destroy_framebuffer_resource(this,*(IOAccelResource2 **)(this + 0xe0));
  }
  if (*(long **)(this + 0xa0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xa0) + 0x118))();
    *(undefined8 *)(this + 0xa0) = 0;
  }
  if (*(long *)(this + 0xd8) != 0) {
    (**(code **)(**(long **)(this + 0x98) + 0xae0))
              (*(long **)(this + 0x98),*(long *)(this + 0xd8),0);
    (**(code **)(**(long **)(this + 0x98) + 0xad8))
              (*(long **)(this + 0x98),*(undefined8 *)(this + 0xd8));
    *(undefined8 *)(this + 0xd8) = 0;
  }
  (**(code **)(*(long *)this + 0x8e8))(this);
  *(undefined8 *)(this + 0x98) = 0;
  *(undefined4 *)(this + 0x284) = 0xffffffff;
  return;
}



// IOAccelDisplayPipe::destroy_framebuffer_resource(IOAccelResource2*)

void __thiscall
IOAccelDisplayPipe::destroy_framebuffer_resource(IOAccelDisplayPipe *this,IOAccelResource2 *param_1)

{
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 extraout_RDX_01;
  undefined8 uVar1;
  IOAccelResource2 *pIVar2;
  IOAccelMemory *this_00;
  
  pIVar2 = param_1;
  (**(code **)(*(long *)param_1 + 0x178))(param_1);
  uVar1 = extraout_RDX;
  if (*(IOAccelResource2 **)(*(long *)(this + 0x240) + 0x30) == param_1) {
    releaseLiveTransaction(this);
    uVar1 = extraout_RDX_00;
  }
  if (*(long *)(param_1 + 0x40) != 0) {
    IOAccelMemoryMap::finishEvent(*(long *)(param_1 + 0x40),pIVar2,uVar1);
    IOAccelResource2::unmap(param_1);
    uVar1 = extraout_RDX_01;
  }
  this_00 = *(IOAccelMemory **)(param_1 + 0x88);
  if (this_00 != (IOAccelMemory *)0x0) {
    if (((byte)this_00[0xd] & 0x10) == 0) {
      IOAccelMemory::pruneOrphanedMappings(this_00,pIVar2,uVar1);
      this_00 = *(IOAccelMemory **)(param_1 + 0x88);
    }
    *(undefined8 *)(this_00 + 0x38) = 0;
    (**(code **)(*(long *)this_00 + 0x28))();
    *(undefined8 *)(param_1 + 0x88) = 0;
    *(undefined2 *)(*(long *)(param_1 + 0x30) + 0xc) = 0;
  }
  (**(code **)(*(long *)this + 0x860))(this,0,param_1);
  this[0x298] = (IOAccelDisplayPipe)0x0;
  return;
}



// IOAccelDisplayPipe::initFramebufferResource(unsigned int, IOAccelResource2*)

void __thiscall
IOAccelDisplayPipe::initFramebufferResource
          (IOAccelDisplayPipe *this,undefined4 param_1,undefined8 param_2)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = *(code **)(**(long **)(this + 0x90) + 0x878);
                    // WARNING: Could not recover jumptable at 0x0004b943. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)
            (*(long **)(this + 0x90),*(undefined4 *)(this + 0x284),param_1,
             *(undefined8 *)(this + 0x98),param_2,UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelDisplayPipe::destroyFramebufferResource(unsigned int, IOAccelResource2*)

void __thiscall
IOAccelDisplayPipe::destroyFramebufferResource
          (IOAccelDisplayPipe *this,undefined4 param_1,undefined8 param_2)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = *(code **)(**(long **)(this + 0x90) + 0x880);
                    // WARNING: Could not recover jumptable at 0x0004b971. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)
            (*(long **)(this + 0x90),*(undefined4 *)(this + 0x284),param_1,
             *(undefined8 *)(this + 0x98),param_2,UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelDisplayPipe::getDisplayModePipeScalerSetup(IOAccelDisplayPipeScaler*)

undefined8 IOAccelDisplayPipe::getDisplayModePipeScalerSetup(void)

{
  return 0xe00002c7;
}



// IOAccelDisplayPipe::copyCapabilities()

void __thiscall IOAccelDisplayPipe::copyCapabilities(IOAccelDisplayPipe *this)

{
                    // WARNING: Could not recover jumptable at 0x0004b99d. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0x88) + 0x2e8))
            (*(long **)(this + 0x88),"IOAccelDisplayPipeCapabilities");
  return;
}



// IOAccelDisplayPipe::init_framebuffer_resource(IOAccelResource2*)

undefined8 __thiscall
IOAccelDisplayPipe::init_framebuffer_resource(IOAccelDisplayPipe *this,long *param_1)

{
  char cVar1;
  int iVar2;
  long lVar3;
  undefined2 uVar4;
  undefined8 uVar5;
  undefined4 local_e8;
  undefined4 local_e4;
  uint local_e0 [2];
  uint local_d8;
  int local_cc;
  undefined4 local_44;
  int local_40;
  long local_30;
  
  local_30 = *(long *)PTR____stack_chk_guard_0006b0b0;
  local_e8 = 0xaaaaaaaa;
  local_e4 = 0xaaaaaaaa;
  _memset(local_e0,0xaa,0xac);
  iVar2 = (**(code **)(**(long **)(this + 0x98) + 0x9f0))
                    (*(long **)(this + 0x98),&local_e8,&local_e4);
  if (iVar2 == 0) {
    iVar2 = (**(code **)(**(long **)(this + 0x98) + 0x9e8))
                      (*(long **)(this + 0x98),local_e8,local_e4,0,local_e0);
    if (iVar2 == 0) {
      if (local_d8 - 0xf < 2) {
        *(undefined4 *)(this + 0x28c) = 3;
      }
      else if (local_d8 == 8) {
        *(undefined4 *)(this + 0x28c) = 0;
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: getCurrentDisplayMode for framebuffer %d failed\n",
                          "bool IOAccelDisplayPipe::init_framebuffer_resource(IOAccelResource2 *)",
                          *(undefined4 *)(this + 0x284));
        if (*(int *)(this + 0x28c) == 0) {
          uVar5 = 0;
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: Unsupported bit depth for framebuffer %d\n",
                            "bool IOAccelDisplayPipe::init_framebuffer_resource(IOAccelResource2 *)"
                            ,*(undefined4 *)(this + 0x284));
          goto LAB_0004ba70;
        }
      }
      else if ((local_d8 == 0x20) && (local_cc == 10)) {
        *(undefined4 *)(this + 0x28c) = 0xf;
      }
      else {
        *(undefined4 *)(this + 0x28c) = 4;
      }
      *(undefined4 *)(this + 0x290) = local_44;
      *(short *)(this + 0x294) = (short)local_40;
      uVar4 = (undefined2)(local_d8 >> 3);
      *(undefined2 *)(this + 0x296) = uVar4;
      *(short *)(param_1 + 0x16) = (short)local_44;
      *(short *)((long)param_1 + 0xb2) = (short)local_40;
      *(undefined2 *)(param_1 + 0x1b) = uVar4;
      param_1[0x17] = (ulong)local_e0[0];
      param_1[0x19] = (ulong)(local_40 * local_e0[0]);
      uVar5 = 0;
      (**(code **)(*param_1 + 0x168))(param_1,0,0);
      *(undefined1 *)(param_1[6] + 0x1c) = 0;
      *(undefined4 *)(param_1 + 5) = 0;
      lVar3 = (**(code **)(*(long *)this + 0x858))(this,0,param_1);
      if (lVar3 != 0) {
        *(byte *)((long)param_1 + 0xf) = *(byte *)((long)param_1 + 0xf) & 0xf7;
        (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x148))
                  (*(long **)(*(long *)(this + 0x88) + 0x380),
                   (ulong)*(byte *)((long)param_1 + 0x15) * 0x40 + param_1[7]);
        (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x148))
                  (*(long **)(*(long *)(this + 0x88) + 0x380),
                   (ulong)*(byte *)((long)param_1 + 0x16) * 0x40 + param_1[7]);
        *(byte *)(lVar3 + 0xc) = *(byte *)(lVar3 + 0xc) | 0x20;
        param_1[0x11] = lVar3;
        cVar1 = (**(code **)(*param_1 + 0x170))(param_1);
        if (cVar1 == '\0') {
          uVar5 = 0;
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: failed to prepare framebuffer resource %p.\n",
                            "bool IOAccelDisplayPipe::init_framebuffer_resource(IOAccelResource2 *)"
                            ,param_1);
        }
        else {
          this[0x298] = (IOAccelDisplayPipe)0x1;
          uVar5 = 1;
        }
      }
    }
    else {
      uVar5 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: getPixelInformation for framebuffer %d failed\n",
                        "bool IOAccelDisplayPipe::init_framebuffer_resource(IOAccelResource2 *)",
                        *(undefined4 *)(this + 0x284));
    }
  }
  else {
    uVar5 = 0;
  }
LAB_0004ba70:
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_30) {
    return uVar5;
  }
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// IOAccelDisplayPipe::getCurrentPlaneResource(unsigned int, unsigned int) const

undefined8 __thiscall
IOAccelDisplayPipe::getCurrentPlaneResource(IOAccelDisplayPipe *this,uint param_1,uint param_2)

{
  return *(undefined8 *)
          ((ulong)param_1 * 0x70 + *(long *)(this + 0x240) + 0x30 + (ulong)param_2 * 8);
}



// IOAccelDisplayPipe::displayModeWillChange()

void __thiscall IOAccelDisplayPipe::displayModeWillChange(IOAccelDisplayPipe *this)

{
  finishTransactionQueue(this);
  if ((*(byte *)(*(long *)(this + 0x88) + 0xcec) & 2) == 0) {
    releaseLiveTransaction(this);
    return;
  }
  return;
}



// IOAccelDisplayPipe::displayModeDidChange()

void __thiscall IOAccelDisplayPipe::displayModeDidChange(IOAccelDisplayPipe *this)

{
  OSMetaClass *pOVar1;
  int iVar2;
  OSMetaClassBase *pOVar3;
  long *plVar4;
  long lVar5;
  ulong uVar6;
  undefined4 local_38;
  undefined4 local_34;
  undefined1 *local_30;
  
  if (*(long *)(this + 0xd8) == 0) {
    plVar4 = *(long **)(this + 0x98);
    iVar2 = (**(code **)(*plVar4 + 0xad0))(plVar4,0x76626c20,signalVBLInterrupt,this,0,this + 0xd8);
    if (iVar2 == 0) {
      (**(code **)(*plVar4 + 0xae0))(plVar4,*(undefined8 *)(this + 0xd8),0);
    }
  }
  init_framebuffer_resource(this,*(long **)(this + 0xe0));
  if (this[0x298] != (IOAccelDisplayPipe)0x0) {
    local_38 = 0xaaaaaaaa;
    local_34 = 0xaaaaaaaa;
    local_30 = &DAT_aaaaaaaaaaaaaaaa;
    _clock_timebase_info(&local_30);
    *(ulong *)(this + 0x270) =
         ((ulong)(uint)((int)local_30 * 1000000000) / 0x3c) / ((ulong)local_30 >> 0x20);
    iVar2 = (**(code **)(**(long **)(this + 0x98) + 0x9f0))
                      (*(long **)(this + 0x98),&local_38,&local_34);
    if (iVar2 == 0) {
      pOVar3 = (OSMetaClassBase *)
               (**(code **)(**(long **)(this + 0x98) + 0x2b8))
                         (*(long **)(this + 0x98),"IOFBCurrentPixelCount");
      pOVar1 = *(OSMetaClass **)PTR_metaClass_0006b060;
      plVar4 = (long *)OSMetaClassBase::safeMetaCast(pOVar3,pOVar1);
      if (plVar4 == (long *)0x0) {
        lVar5 = 0;
      }
      else {
        lVar5 = (**(code **)(*plVar4 + 0x150))(plVar4);
      }
      pOVar3 = (OSMetaClassBase *)
               (**(code **)(**(long **)(this + 0x98) + 0x2b8))
                         (*(long **)(this + 0x98),"IOFBCurrentPixelClock");
      plVar4 = (long *)OSMetaClassBase::safeMetaCast(pOVar3,pOVar1);
      if (plVar4 != (long *)0x0) {
        uVar6 = (**(code **)(*plVar4 + 0x150))(plVar4);
        if ((lVar5 != 0) && (uVar6 != 0)) {
          *(ulong *)(this + 0x270) =
               ((lVar5 * ((ulong)local_30 & 0xffffffff) * 1000000000) / uVar6) /
               ((ulong)local_30 >> 0x20);
        }
      }
    }
  }
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipe::signalVBLInterrupt(void*)

void __cdecl IOAccelDisplayPipe::signalVBLInterrupt(long param_1)

{
  uintptr_t arg1;
  
  _clock_get_uptime(param_1 + 0x268);
  if (*(char *)(param_1 + 0x281) != '\0') {
    signalTransactionInterrupt(param_1);
  }
  if (*(int *)(param_1 + 0x2a0) != 0) {
    (**(code **)(**(long **)(param_1 + 200) + 0x1d8))(*(long **)(param_1 + 200),0,0);
  }
  if (___ktrace_kernel_enabled != 0) {
    arg1 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85200018,arg1,(ulong)*(uint *)(param_1 + 0x284),0,0,0);
    return;
  }
  return;
}



// IOAccelDisplayPipe::wsaaEnterDefer(int)

undefined8 IOAccelDisplayPipe::wsaaEnterDefer(void)

{
  return 0;
}



// IOAccelDisplayPipe::wsaaWillEnterDefer(int)

undefined8 __thiscall
IOAccelDisplayPipe::wsaaWillEnterDefer(IOAccelDisplayPipe *this,undefined4 param_1)

{
  long *plVar1;
  undefined8 uVar2;
  
  *(undefined4 *)(this + 0x278) = param_1;
  if ((*(byte *)(*(long *)(this + 0x88) + 0xcec) & 2) != 0) {
    plVar1 = *(long **)(*(long *)(this + 0x240) + 0x30);
    *(long **)(this + 0xf0) = plVar1;
    if ((plVar1 == (long *)0x0) || ((*(byte *)((long)plVar1 + 0xc) & 0x10) != 0)) {
      *(undefined8 *)(this + 0xf0) = 0;
    }
    else {
      (**(code **)(*plVar1 + 0x170))();
      (**(code **)(**(long **)(this + 0xf0) + 0x20))();
    }
  }
  uVar2 = finishTransactionQueue(this);
  this[0x2ac] = (IOAccelDisplayPipe)0x1;
  this[0x282] = (IOAccelDisplayPipe)0x1;
  return CONCAT71((int7)((ulong)uVar2 >> 8),1);
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipe::wsaaDidEnterDefer(int)

undefined1 __cdecl IOAccelDisplayPipe::wsaaDidEnterDefer(long param_1)

{
  *(undefined1 *)(param_1 + 0x282) = 0;
  return 1;
}



// IOAccelDisplayPipe::wsaaWillExitDefer(int)

undefined8 __thiscall IOAccelDisplayPipe::wsaaWillExitDefer(IOAccelDisplayPipe *this,uint param_1)

{
  long lVar1;
  long *plVar2;
  undefined8 uVar3;
  undefined1 *local_60;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  undefined1 *local_28;
  
  if ((((*(byte *)(*(long *)(this + 0x88) + 0xcec) & 2) != 0) &&
      (this[0x298] != (IOAccelDisplayPipe)0x0)) && ((param_1 & 0xf) == 0)) {
    if ((((*(uint *)(this + 0x278) & 0xf) == 2) &&
        (((*(uint *)(this + 0x278) | param_1) & 0x400) == 0)) &&
       ((lVar1 = *(long *)(*(long *)(this + 0x240) + 0x30), lVar1 != 0 &&
        ((*(long *)(this + 0xe0) != 0 && (lVar1 != *(long *)(this + 0xe0))))))) {
      local_28 = &DAT_aaaaaaaaaaaaaaaa;
      local_30 = &DAT_aaaaaaaaaaaaaaaa;
      local_38 = &DAT_aaaaaaaaaaaaaaaa;
      local_40 = &DAT_aaaaaaaaaaaaaaaa;
      local_48 = &DAT_aaaaaaaaaaaaaaaa;
      local_50 = &DAT_aaaaaaaaaaaaaaaa;
      local_58 = &DAT_aaaaaaaaaaaaaaaa;
      local_60 = &DAT_aaaaaaaaaaaaaaaa;
      plVar2 = *(long **)(*(long *)(this + 0x88) + 0x380);
      (**(code **)(*plVar2 + 0x140))(plVar2,&local_60);
      (**(code **)(**(long **)(this + 0x88) + 0x9a8))
                (*(long **)(this + 0x88),&local_60,lVar1,*(undefined8 *)(this + 0xe0));
      (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x188))();
      uVar3 = 0;
      (**(code **)(**(long **)(this + 0xe0) + 0x168))(*(long **)(this + 0xe0),0,0);
      submitFlipBufferTransaction(this,uVar3,0,*(long *)(this + 0xe0),0);
    }
  }
  uVar3 = finishTransactionQueue(this);
  this[0x282] = (IOAccelDisplayPipe)0x1;
  return CONCAT71((int7)((ulong)uVar3 >> 8),1);
}



// IOAccelDisplayPipe::getEventMachine() const

undefined8 __thiscall IOAccelDisplayPipe::getEventMachine(IOAccelDisplayPipe *this)

{
  return *(undefined8 *)(*(long *)(this + 0x88) + 0x380);
}



// IOAccelDisplayPipe::submitFlipBufferTransaction(IOAccelEvent*, unsigned int, IOAccelResource2*,
// IOAccelResource2*)

void __thiscall
IOAccelDisplayPipe::submitFlipBufferTransaction
          (IOAccelDisplayPipe *this,undefined8 param_1,ulong param_3_00,long param_3,long param_4)

{
  int iVar1;
  IOAccelDisplayPipeTransaction2 *this_00;
  
  *(int *)(this + 0x288) = *(int *)(this + 0x288) + 1;
  this_00 = (IOAccelDisplayPipeTransaction2 *)(**(code **)(*(long *)this + 0x898))();
  if (this_00 != (IOAccelDisplayPipeTransaction2 *)0x0) {
    IOAccelDisplayPipeTransaction2::init
              (this_00,*(long *)(this + 0x88),this,0,*(undefined4 *)(this + 0x288));
    (**(code **)(*(long *)this + 0x8d8))(this,this_00 + 0xa0);
    IOAccelDisplayPipeTransaction2::make_flip_transaction
              (this_00,param_3_00 & 0xffffffff,param_3,param_4);
    iVar1 = IOAccelDisplayPipeTransaction2::prepare(this_00);
    *(int *)(this_00 + 0x58) = iVar1;
    if (iVar1 == 0) {
      IOAccelDisplayPipeTransaction2::build_barrier_event(this_00,this_00 + 0x60);
    }
    wait_for_queue_slot_nolock(this);
    transaction_queue(this,this_00);
    return;
  }
  return;
}



// IOAccelDisplayPipe::wsaaDidExitDefer(int)

undefined8 __thiscall
IOAccelDisplayPipe::wsaaDidExitDefer(IOAccelDisplayPipe *this,undefined4 param_1)

{
  if (*(long **)(this + 0xf0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xf0) + 0x178))();
    (**(code **)(**(long **)(this + 0xf0) + 0x28))();
    *(undefined8 *)(this + 0xf0) = 0;
  }
  *(undefined4 *)(this + 0x278) = param_1;
  this[0x2ac] = (IOAccelDisplayPipe)0x0;
  this[0x282] = (IOAccelDisplayPipe)0x0;
  return 1;
}



// IOAccelDisplayPipe::framebuffer_online_status_changed(bool)

void __thiscall
IOAccelDisplayPipe::framebuffer_online_status_changed(IOAccelDisplayPipe *this,int param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x88);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (param_1 == 0) {
    releaseLiveTransaction(this);
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0x88);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return;
}



// IOAccelDisplayPipe::device_terminated()

void __thiscall IOAccelDisplayPipe::device_terminated(IOAccelDisplayPipe *this)

{
  this[0x280] = (IOAccelDisplayPipe)0x1;
  signalTransactionInterrupt((long)this);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipe::signalTransactionInterrupt(void*)

void __cdecl IOAccelDisplayPipe::signalTransactionInterrupt(long param_1)

{
  uint64_t uVar1;
  uintptr_t arg1;
  
  if (*(int *)(param_1 + 0x2a4) != 0) {
    uVar1 = _mach_absolute_time();
    *(uint64_t *)(param_1 + 0x2d0) = uVar1;
    (**(code **)(**(long **)(param_1 + 0xd0) + 0x1d8))(*(long **)(param_1 + 0xd0),0,0);
    if ((___ktrace_kernel_enabled != 0) && (___ktrace_display_enabled != 0)) {
      arg1 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x85200054,arg1,(ulong)*(uint *)(param_1 + 0x284),0,0,0);
      return;
    }
  }
  return;
}



// IOAccelDisplayPipeTransaction2::init(IOGraphicsAccelerator2*, IOAccelDisplayPipe*,
// IOAccelDisplayPipeUserClient2*, unsigned int)

bool __thiscall
IOAccelDisplayPipeTransaction2::init
          (IOAccelDisplayPipeTransaction2 *this,long param_1,undefined8 param_2,undefined8 param_3,
          undefined4 param_4)

{
  long lVar1;
  
  *(long *)(this + 0x20) = param_1;
  *(undefined8 *)(this + 0x28) = param_2;
  *(undefined8 *)(this + 0x30) = param_3;
  *(undefined4 *)(this + 0x54) = param_4;
  *(undefined4 *)(this + 0x160) = 0;
  (**(code **)(**(long **)(param_1 + 0x380) + 0x140))(*(long **)(param_1 + 0x380),this + 0x60);
  (**(code **)(**(long **)(*(long *)(this + 0x20) + 0x380) + 0x140))
            (*(long **)(*(long *)(this + 0x20) + 0x380),this + 0xa0);
  lVar1 = _IOMallocTypeImpl(&init(IOGraphicsAccelerator2*,IOAccelDisplayPipe*,IOAccelDisplayPipeUserClient2*,unsigned_int)
                             ::kalloc_type_view_2849);
  *(long *)(this + 0x38) = lVar1;
  if (lVar1 != 0) {
    *(undefined8 *)(this + 0x1b0) = 0;
  }
  return lVar1 != 0;
}



// IOAccelDisplayPipeTransaction2::make_flip_transaction(unsigned int, IOAccelResource2*,
// IOAccelResource2*)

void __thiscall
IOAccelDisplayPipeTransaction2::make_flip_transaction
          (IOAccelDisplayPipeTransaction2 *this,ulong param_2_00,long param_2,long param_3)

{
  undefined8 uVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  long lVar7;
  long lVar8;
  bool bVar9;
  long lVar10;
  long lVar11;
  bool bVar12;
  
  *(undefined8 *)(this + 0x48) = 3;
  if ((param_2_00 & 2) != 0) {
    *(undefined4 *)(this + 0x50) = 1;
  }
  *(long *)(*(long *)(this + 0x38) + 0x30) = param_2;
  (**(code **)(**(long **)(*(long *)(this + 0x38) + 0x30) + 0x20))();
  if (param_3 != 0) {
    *(long *)(*(long *)(this + 0x38) + 0x38) = param_3;
    (**(code **)(**(long **)(*(long *)(this + 0x38) + 0x38) + 0x20))();
  }
  lVar7 = *(long *)(this + 0x38);
  lVar10 = 0;
  *(undefined8 *)(lVar7 + 0x48) = 0;
  *(float *)(lVar7 + 0x50) = (float)*(ushort *)(param_2 + 0xb0);
  *(float *)(lVar7 + 0x54) = (float)*(ushort *)(param_2 + 0xb2);
  *(undefined8 *)(lVar7 + 0x58) = 0;
  *(undefined8 *)(lVar7 + 0x60) = *(undefined8 *)(lVar7 + 0x50);
  lVar7 = *(long *)(this + 0x38);
  *(undefined8 *)(lVar7 + 0x70) = 0;
  *(undefined8 *)(lVar7 + 0x68) = 0;
  bVar9 = true;
  do {
    bVar12 = bVar9;
    lVar11 = lVar10 * 0x70;
    IOAccelDisplayPipe::set_current_plane_resources
              (*(IOAccelDisplayPipe **)(this + 0x28),this + 0xa0,(uint)lVar10,
               *(long **)(*(long *)(this + 0x38) + 0x30 + lVar11),
               *(long **)(*(long *)(this + 0x38) + 0x38 + lVar11));
    lVar7 = *(long *)(this + 0x28);
    lVar10 = *(long *)(this + 0x38);
    uVar1 = *(undefined8 *)(lVar10 + 0x48 + lVar11);
    uVar2 = *(undefined8 *)(lVar10 + 0x50 + lVar11);
    uVar3 = *(undefined8 *)(lVar10 + 0x58 + lVar11);
    uVar4 = *(undefined8 *)(lVar10 + 0x60 + lVar11);
    uVar5 = *(undefined8 *)(lVar10 + 0x68 + lVar11);
    uVar6 = *(undefined8 *)(lVar10 + 0x70 + lVar11);
    lVar8 = *(long *)(lVar7 + 0x240);
    *(undefined4 *)(lVar8 + 0x78 + lVar11) = *(undefined4 *)(lVar10 + 0x78 + lVar11);
    *(undefined8 *)(lVar8 + 0x48 + lVar11) = uVar1;
    *(undefined8 *)(lVar8 + 0x50 + lVar11) = uVar2;
    lVar10 = *(long *)(lVar7 + 0x240);
    *(undefined8 *)(lVar10 + 0x58 + lVar11) = uVar3;
    *(undefined8 *)(lVar10 + 0x60 + lVar11) = uVar4;
    lVar7 = *(long *)(lVar7 + 0x240);
    *(undefined8 *)(lVar7 + 0x68 + lVar11) = uVar5;
    *(undefined8 *)(lVar7 + 0x70 + lVar11) = uVar6;
    lVar10 = 1;
    bVar9 = false;
  } while (bVar12);
                    // WARNING: Could not recover jumptable at 0x0004c542. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0x28) + 0x8a0))(*(long **)(this + 0x28),this);
  return;
}



// IOAccelDisplayPipeTransaction2::prepare()

int __thiscall IOAccelDisplayPipeTransaction2::prepare(IOAccelDisplayPipeTransaction2 *this)

{
  IOAccelResource2 *this_00;
  long *plVar1;
  byte bVar2;
  bool bVar3;
  byte bVar4;
  int iVar5;
  long lVar6;
  long lVar7;
  bool bVar8;
  int iVar9;
  int iVar10;
  bool bVar11;
  int iVar12;
  
  lVar6 = 6;
  iVar12 = 0;
  iVar5 = 0;
  do {
    lVar7 = lVar6;
    iVar9 = 0;
    do {
      this_00 = *(IOAccelResource2 **)(*(long *)(this + 0x38) + lVar7 * 8);
      if (this_00 == (IOAccelResource2 *)0x0) {
        iVar10 = 0;
      }
      else {
        IOAccelResource2::checkDirty(this_00);
        bVar4 = (**(code **)(**(long **)(*(long *)(this + 0x38) + lVar7 * 8) + 0x170))();
        iVar10 = -0x1ffffd42;
        if (bVar4 != 0) {
          iVar10 = 0;
        }
        iVar12 = iVar12 + (uint)bVar4;
      }
      lVar7 = lVar7 + 1;
      bVar3 = iVar9 == 0;
      iVar9 = iVar9 + 1;
    } while (bVar3 && iVar10 == 0);
    lVar6 = lVar6 + 0xe;
    bVar3 = iVar5 == 0;
    iVar5 = iVar5 + 1;
  } while (bVar3 && iVar10 == 0);
  if (iVar10 == 0) {
    this[0x140] = (IOAccelDisplayPipeTransaction2)((byte)this[0x140] | 1);
    lVar6 = 0;
    bVar3 = true;
    do {
      bVar11 = bVar3;
      lVar7 = 0;
      bVar3 = true;
      do {
        bVar8 = bVar3;
        if (*(long *)(lVar6 * 0x70 + *(long *)(this + 0x38) + 0x20 + lVar7 * 8) != 0) {
          IOSurface::increment_use_count();
        }
        lVar7 = 1;
        bVar3 = false;
      } while (bVar8);
      lVar6 = 1;
      bVar3 = false;
    } while (bVar11);
  }
  else if (iVar12 != 0) {
    bVar4 = 1;
    lVar6 = 0;
    do {
      bVar2 = 1;
      lVar7 = 0;
      do {
        plVar1 = *(long **)(lVar6 * 0x70 + *(long *)(this + 0x38) + 0x30 + lVar7 * 8);
        if (plVar1 != (long *)0x0) {
          (**(code **)(*plVar1 + 0x178))();
          iVar12 = iVar12 + -1;
        }
        lVar7 = 1;
        bVar3 = (bool)(iVar12 != 0 & bVar2);
        bVar2 = 0;
      } while (bVar3);
      lVar6 = 1;
      bVar3 = (bool)(bVar4 & iVar12 != 0);
      bVar4 = 0;
    } while (bVar3);
  }
  return iVar10;
}



// IOAccelDisplayPipeTransaction2::build_barrier_event(IOAccelEvent*)

void __thiscall
IOAccelDisplayPipeTransaction2::build_barrier_event
          (IOAccelDisplayPipeTransaction2 *this,undefined8 param_1)

{
  long *plVar1;
  bool bVar2;
  bool bVar3;
  long lVar4;
  bool bVar5;
  long lVar6;
  
  plVar1 = *(long **)(*(long *)(this + 0x20) + 0x380);
  lVar6 = 0;
  bVar2 = true;
  do {
    bVar3 = bVar2;
    lVar4 = 0;
    bVar2 = true;
    do {
      bVar5 = bVar2;
      lVar4 = *(long *)(lVar6 * 0x70 + *(long *)(this + 0x38) + 0x30 + lVar4 * 8);
      if (lVar4 != 0) {
        (**(code **)(*plVar1 + 0x1b8))
                  (plVar1,(ulong)*(byte *)(lVar4 + 0x16) * 0x40 + *(long *)(lVar4 + 0x38),param_1);
      }
      lVar4 = 1;
      bVar2 = false;
    } while (bVar5);
    lVar6 = 1;
    bVar2 = false;
  } while (bVar3);
  return;
}



// IOAccelDisplayPipe::wait_for_queue_slot_nolock()

void __thiscall IOAccelDisplayPipe::wait_for_queue_slot_nolock(IOAccelDisplayPipe *this)

{
  long *plVar1;
  
  plVar1 = *(long **)(this + 0xb0);
  if (plVar1 == (long *)0x0) {
    setup_workloop(this);
    plVar1 = *(long **)(this + 0xb0);
  }
                    // WARNING: Could not recover jumptable at 0x0004c765. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*plVar1 + 0x1c8))(plVar1,wait_for_queue_slot_gated,0,0,0,0);
  return;
}



// IOAccelDisplayPipe::transaction_queue(IOAccelDisplayPipeTransaction2*)

void __thiscall IOAccelDisplayPipe::transaction_queue(IOAccelDisplayPipe *this,undefined8 param_1)

{
  long *plVar1;
  
  plVar1 = *(long **)(this + 0xb0);
  if (plVar1 == (long *)0x0) {
    setup_workloop(this);
    plVar1 = *(long **)(this + 0xb0);
  }
                    // WARNING: Could not recover jumptable at 0x0004c7b0. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*plVar1 + 0x1c8))(plVar1,transaction_queue_gated,param_1,0,0,0);
  return;
}



// IOAccelDisplayPipe::newDisplayPipeTransaction()

void IOAccelDisplayPipe::newDisplayPipeTransaction(void)

{
                    // WARNING: Could not recover jumptable at 0x0004c7c5. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(IOAccelDisplayPipeTransaction2::gMetaClass + 0x88))
            (&IOAccelDisplayPipeTransaction2::gMetaClass);
  return;
}



// IOAccelDisplayPipe::find_temp_transaction(unsigned int)

long __thiscall IOAccelDisplayPipe::find_temp_transaction(IOAccelDisplayPipe *this,int param_1)

{
  long lVar1;
  
  lVar1 = *(long *)(this + 0xf8);
  while( true ) {
    if (lVar1 == 0) {
      return 0;
    }
    if (*(int *)(lVar1 + 0x54) == param_1) break;
    lVar1 = *(long *)(lVar1 + 0x10);
  }
  return lVar1;
}



// IOAccelDisplayPipe::transaction_begin(IOAccelDisplayPipeUserClient2*, unsigned int*)

undefined8 __thiscall
IOAccelDisplayPipe::transaction_begin
          (IOAccelDisplayPipe *this,undefined8 param_1,undefined4 *param_2)

{
  IOAccelDisplayPipe *pIVar1;
  long lVar2;
  IOAccelDisplayPipeTransaction2 *this_00;
  undefined8 uVar3;
  
  *(int *)(this + 0x288) = *(int *)(this + 0x288) + 1;
  this_00 = (IOAccelDisplayPipeTransaction2 *)(**(code **)(*(long *)this + 0x898))();
  if (this_00 == (IOAccelDisplayPipeTransaction2 *)0x0) {
    uVar3 = 0xe00002bd;
  }
  else {
    IOAccelDisplayPipeTransaction2::init
              (this_00,*(long *)(this + 0x88),this,param_1,*(undefined4 *)(this + 0x288));
    pIVar1 = this + 0xf8;
    lVar2 = *(long *)(this + 0xf8);
    if (lVar2 == 0) {
      *(undefined8 *)(this_00 + 0x10) = 0;
      *(IOAccelDisplayPipeTransaction2 **)(this + 0x100) = this_00 + 0x10;
    }
    else {
      if (*(IOAccelDisplayPipe **)(lVar2 + 0x18) != pIVar1) {
                    // WARNING: Subroutine does not return
        _panic("\"Bad tailq head %p first->prev != head @%u\" @%s:%d",pIVar1,0x353,
               "IOAccelDisplayPipe.cpp",0x353);
      }
      *(long *)(this_00 + 0x10) = lVar2;
      *(IOAccelDisplayPipeTransaction2 **)(lVar2 + 0x18) = this_00 + 0x10;
    }
    *(IOAccelDisplayPipeTransaction2 **)(this + 0xf8) = this_00;
    *(IOAccelDisplayPipe **)(this_00 + 0x18) = pIVar1;
    *param_2 = *(undefined4 *)(this + 0x288);
    uVar3 = 0;
  }
  return uVar3;
}



// IOAccelDisplayPipe::transaction_set_plane_gamma_table(IOAccelDisplayPipeGammaTableArgs*)

undefined8 __thiscall
IOAccelDisplayPipe::transaction_set_plane_gamma_table(IOAccelDisplayPipe *this,int *param_1)

{
  undefined8 uVar1;
  IOAccelDisplayPipeTransaction2 *this_00;
  
  this_00 = *(IOAccelDisplayPipeTransaction2 **)(this + 0xf8);
  if (this_00 != (IOAccelDisplayPipeTransaction2 *)0x0) {
    do {
      if (*(int *)(this_00 + 0x54) == *param_1) {
        uVar1 = IOAccelDisplayPipeTransaction2::set_plane_gamma_table
                          (this_00,param_1[1],(uint *)(param_1 + 2));
        return uVar1;
      }
      this_00 = *(IOAccelDisplayPipeTransaction2 **)(this_00 + 0x10);
    } while (this_00 != (IOAccelDisplayPipeTransaction2 *)0x0);
  }
  return 0;
}



// IOAccelDisplayPipeTransaction2::set_plane_gamma_table(unsigned int,
// IOAccelDisplayPipeGammaTableData*)

undefined8 __thiscall
IOAccelDisplayPipeTransaction2::set_plane_gamma_table
          (IOAccelDisplayPipeTransaction2 *this,uint param_1,uint *param_2)

{
  long *plVar1;
  IOAccelDisplayPipeGammaTable2 *pIVar2;
  undefined8 uVar3;
  long lVar4;
  
  pIVar2 = IOAccelDisplayPipeGammaTable2::withGammaTableData(param_2);
  uVar3 = 0xe00002c2;
  if (param_1 < 2) {
    lVar4 = *(long *)(this + 0x38);
    plVar1 = *(long **)(lVar4 + 0x40 + (ulong)param_1 * 0x70);
    if (plVar1 != (long *)0x0) {
      (**(code **)(*plVar1 + 0x28))();
      lVar4 = *(long *)(this + 0x38);
    }
    *(IOAccelDisplayPipeGammaTable2 **)(lVar4 + 0x40 + (ulong)param_1 * 0x70) = pIVar2;
    *(ulong *)(this + 0x48) = *(ulong *)(this + 0x48) | (ulong)(uint)(4 << ((byte)param_1 & 0x1f));
    uVar3 = 0;
  }
  return uVar3;
}



// IOAccelDisplayPipe::transaction_set_pipe_pregamma_table(IOAccelDisplayPipeGammaTableArgs*)

undefined8 __thiscall
IOAccelDisplayPipe::transaction_set_pipe_pregamma_table(IOAccelDisplayPipe *this,int *param_1)

{
  IOAccelDisplayPipeTransaction2 *this_00;
  
  this_00 = *(IOAccelDisplayPipeTransaction2 **)(this + 0xf8);
  if (this_00 != (IOAccelDisplayPipeTransaction2 *)0x0) {
    do {
      if (*(int *)(this_00 + 0x54) == *param_1) {
        IOAccelDisplayPipeTransaction2::set_pipe_pregamma_table(this_00,(uint *)(param_1 + 2));
        return 0;
      }
      this_00 = *(IOAccelDisplayPipeTransaction2 **)(this_00 + 0x10);
    } while (this_00 != (IOAccelDisplayPipeTransaction2 *)0x0);
  }
  return 0;
}



// IOAccelDisplayPipeTransaction2::set_pipe_pregamma_table(IOAccelDisplayPipeGammaTableData*)

undefined8 __thiscall
IOAccelDisplayPipeTransaction2::set_pipe_pregamma_table
          (IOAccelDisplayPipeTransaction2 *this,uint *param_1)

{
  IOAccelDisplayPipeGammaTable2 *pIVar1;
  long *plVar2;
  
  pIVar1 = IOAccelDisplayPipeGammaTable2::withGammaTableData(param_1);
  plVar2 = *(long **)(this + 0x38);
  if ((long *)*plVar2 != (long *)0x0) {
    (**(code **)(*(long *)*plVar2 + 0x28))();
    plVar2 = *(long **)(this + 0x38);
  }
  *plVar2 = (long)pIVar1;
  this[0x48] = (IOAccelDisplayPipeTransaction2)((byte)this[0x48] | 0x20);
  return 0;
}



// IOAccelDisplayPipe::transaction_set_pipe_postgamma_table(IOAccelDisplayPipeGammaTableArgs*)

undefined8 __thiscall
IOAccelDisplayPipe::transaction_set_pipe_postgamma_table(IOAccelDisplayPipe *this,int *param_1)

{
  IOAccelDisplayPipeTransaction2 *this_00;
  
  this_00 = *(IOAccelDisplayPipeTransaction2 **)(this + 0xf8);
  if (this_00 != (IOAccelDisplayPipeTransaction2 *)0x0) {
    do {
      if (*(int *)(this_00 + 0x54) == *param_1) {
        IOAccelDisplayPipeTransaction2::set_pipe_postgamma_table(this_00,(uint *)(param_1 + 2));
        return 0;
      }
      this_00 = *(IOAccelDisplayPipeTransaction2 **)(this_00 + 0x10);
    } while (this_00 != (IOAccelDisplayPipeTransaction2 *)0x0);
  }
  return 0;
}



// IOAccelDisplayPipeTransaction2::set_pipe_postgamma_table(IOAccelDisplayPipeGammaTableData*)

undefined8 __thiscall
IOAccelDisplayPipeTransaction2::set_pipe_postgamma_table
          (IOAccelDisplayPipeTransaction2 *this,uint *param_1)

{
  IOAccelDisplayPipeGammaTable2 *pIVar1;
  long lVar2;
  
  pIVar1 = IOAccelDisplayPipeGammaTable2::withGammaTableData(param_1);
  lVar2 = *(long *)(this + 0x38);
  if (*(long **)(lVar2 + 8) != (long *)0x0) {
    (**(code **)(**(long **)(lVar2 + 8) + 0x28))();
    lVar2 = *(long *)(this + 0x38);
  }
  *(IOAccelDisplayPipeGammaTable2 **)(lVar2 + 8) = pIVar1;
  this[0x48] = (IOAccelDisplayPipeTransaction2)((byte)this[0x48] | 0x80);
  return 0;
}



// IOAccelDisplayPipe::transaction_set_pipe_precsclinearization_vid(IOAccelDisplayPipePreCSCLinearizationArgs*)

undefined8 __thiscall
IOAccelDisplayPipe::transaction_set_pipe_precsclinearization_vid
          (IOAccelDisplayPipe *this,int *param_1)

{
  undefined8 uVar1;
  IOAccelDisplayPipeTransaction2 *this_00;
  
  this_00 = *(IOAccelDisplayPipeTransaction2 **)(this + 0xf8);
  if (this_00 != (IOAccelDisplayPipeTransaction2 *)0x0) {
    do {
      if (*(int *)(this_00 + 0x54) == *param_1) {
        uVar1 = IOAccelDisplayPipeTransaction2::set_pipe_precsclinearization_vid
                          (this_00,(long)param_1);
        return uVar1;
      }
      this_00 = *(IOAccelDisplayPipeTransaction2 **)(this_00 + 0x10);
    } while (this_00 != (IOAccelDisplayPipeTransaction2 *)0x0);
  }
  return 0;
}



// IOAccelDisplayPipeTransaction2::set_pipe_precsclinearization_vid(IOAccelDisplayPipePreCSCLinearizationArgs*)

undefined8 __thiscall
IOAccelDisplayPipeTransaction2::set_pipe_precsclinearization_vid
          (IOAccelDisplayPipeTransaction2 *this,long param_1)

{
  IOAccelDisplayPipePreCSCLinearizationVID *pIVar1;
  undefined8 uVar2;
  
  if (*(long **)(*(long *)(this + 0x38) + 0x158) != (long *)0x0) {
    (**(code **)(**(long **)(*(long *)(this + 0x38) + 0x158) + 0x28))();
    *(undefined8 *)(*(long *)(this + 0x38) + 0x158) = 0;
  }
  pIVar1 = IOAccelDisplayPipePreCSCLinearizationVID::withArgs(param_1);
  if (pIVar1 == (IOAccelDisplayPipePreCSCLinearizationVID *)0x0) {
    uVar2 = 0xe00002be;
  }
  else {
    *(IOAccelDisplayPipePreCSCLinearizationVID **)(*(long *)(this + 0x38) + 0x158) = pIVar1;
    this[0x49] = (IOAccelDisplayPipeTransaction2)((byte)this[0x49] | 2);
    uVar2 = 0;
  }
  return uVar2;
}



// IOAccelDisplayPipe::transaction_set_pipe_postcscgamma_vid(IOAccelDisplayPipePostCSCGammaTableArgs*)

undefined8 __thiscall
IOAccelDisplayPipe::transaction_set_pipe_postcscgamma_vid(IOAccelDisplayPipe *this,int *param_1)

{
  undefined8 uVar1;
  IOAccelDisplayPipeTransaction2 *this_00;
  
  this_00 = *(IOAccelDisplayPipeTransaction2 **)(this + 0xf8);
  if (this_00 != (IOAccelDisplayPipeTransaction2 *)0x0) {
    do {
      if (*(int *)(this_00 + 0x54) == *param_1) {
        uVar1 = IOAccelDisplayPipeTransaction2::set_pipe_postcscgamma_vid(this_00,(long)param_1);
        return uVar1;
      }
      this_00 = *(IOAccelDisplayPipeTransaction2 **)(this_00 + 0x10);
    } while (this_00 != (IOAccelDisplayPipeTransaction2 *)0x0);
  }
  return 0;
}



// IOAccelDisplayPipeTransaction2::set_pipe_postcscgamma_vid(IOAccelDisplayPipePostCSCGammaTableArgs*)

undefined8 __thiscall
IOAccelDisplayPipeTransaction2::set_pipe_postcscgamma_vid
          (IOAccelDisplayPipeTransaction2 *this,long param_1)

{
  IOAccelDisplayPipePostCSCGammaVID *pIVar1;
  undefined8 uVar2;
  
  if (*(long **)(*(long *)(this + 0x38) + 0x160) != (long *)0x0) {
    (**(code **)(**(long **)(*(long *)(this + 0x38) + 0x160) + 0x28))();
    *(undefined8 *)(*(long *)(this + 0x38) + 0x160) = 0;
  }
  pIVar1 = IOAccelDisplayPipePostCSCGammaVID::withArgs(param_1);
  if (pIVar1 == (IOAccelDisplayPipePostCSCGammaVID *)0x0) {
    uVar2 = 0xe00002be;
  }
  else {
    *(IOAccelDisplayPipePostCSCGammaVID **)(*(long *)(this + 0x38) + 0x160) = pIVar1;
    this[0x49] = (IOAccelDisplayPipeTransaction2)((byte)this[0x49] | 4);
    uVar2 = 0;
  }
  return uVar2;
}



// IOAccelDisplayPipe::transaction_end(IOAccelDisplayPipeUserClient2*,
// IOAccelDisplayPipeTransactionArgs*)

int __thiscall
IOAccelDisplayPipe::transaction_end(IOAccelDisplayPipe *this,undefined8 param_2_00,ulong *param_2)

{
  IOAccelDisplayPipeTransaction2 *pIVar1;
  int iVar2;
  uintptr_t arg1;
  long *plVar3;
  IOAccelDisplayPipeTransaction2 *this_00;
  char *pcVar4;
  
  if (*(IOAccelDisplayPipeTransaction2 **)(this + 0xf8) != (IOAccelDisplayPipeTransaction2 *)0x0) {
    this_00 = *(IOAccelDisplayPipeTransaction2 **)(this + 0xf8);
    do {
      pIVar1 = *(IOAccelDisplayPipeTransaction2 **)(this_00 + 0x10);
      if (*(int *)(this_00 + 0x54) == (int)param_2[2]) {
        if (pIVar1 == (IOAccelDisplayPipeTransaction2 *)0x0) {
          plVar3 = *(long **)(this_00 + 0x18);
          if ((IOAccelDisplayPipeTransaction2 *)*plVar3 == this_00) {
            *(long **)(this + 0x100) = plVar3;
LAB_0004cbb2:
            *plVar3 = (long)pIVar1;
            (**(code **)(*(long *)this + 0x8d8))(this,this_00 + 0xa0);
            iVar2 = IOAccelDisplayPipeTransaction2::set_transaction_args(this_00,param_2);
            if (iVar2 == 0) {
              iVar2 = IOAccelDisplayPipeTransaction2::prepare(this_00);
              *(int *)(this_00 + 0x58) = iVar2;
              if (iVar2 == 0) {
                IOAccelDisplayPipeTransaction2::build_barrier_event(this_00,this_00 + 0x60);
                iVar2 = 0;
              }
            }
            else {
              *(int *)(this_00 + 0x58) = iVar2;
            }
            transaction_queue(this,this_00);
            if (___ktrace_kernel_enabled == 0) {
              return iVar2;
            }
            if (___ktrace_display_enabled == 0) {
              return iVar2;
            }
            arg1 = IORegistryEntry::getRegistryEntryID();
            _kernel_debug(0x85200040,arg1,(ulong)(uint)param_2[2],(ulong)*(uint *)(this + 0x284),
                          *(uintptr_t *)(this_00 + 0x1b0),0);
            return iVar2;
          }
        }
        else {
          if (*(IOAccelDisplayPipeTransaction2 **)(pIVar1 + 0x18) != this_00 + 0x10) {
            pcVar4 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
            goto LAB_0004cc6d;
          }
          if ((IOAccelDisplayPipeTransaction2 *)**(long **)(this_00 + 0x18) == this_00) {
            *(long **)(pIVar1 + 0x18) = *(long **)(this_00 + 0x18);
            plVar3 = *(long **)(this_00 + 0x18);
            goto LAB_0004cbb2;
          }
        }
        pcVar4 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_0004cc6d:
                    // WARNING: Subroutine does not return
        _panic(pcVar4,this_00,0x3d4,"IOAccelDisplayPipe.cpp",0x3d4);
      }
      this_00 = pIVar1;
    } while (pIVar1 != (IOAccelDisplayPipeTransaction2 *)0x0);
  }
  return -0x1ffffd10;
}



// IOAccelDisplayPipeTransaction2::set_transaction_args(IOAccelDisplayPipeTransactionArgs*)

int __thiscall
IOAccelDisplayPipeTransaction2::set_transaction_args
          (IOAccelDisplayPipeTransaction2 *this,ulong *param_1)

{
  IOAccelDisplayPipeTransaction2 *pIVar1;
  uint *puVar2;
  undefined8 uVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  bool bVar7;
  bool bVar8;
  bool bVar9;
  bool bVar10;
  int iVar11;
  long *plVar12;
  long *plVar13;
  long lVar14;
  undefined8 uVar15;
  uintptr_t uVar16;
  IOAccelSurface *this_00;
  long lVar17;
  IOAccelDisplayPipeTransaction2 *pIVar18;
  long lVar19;
  IOAccelDisplayPipeTransaction2 *pIVar20;
  IOAccelDisplayPipeTransaction2 *pIVar21;
  uint uVar22;
  ulong uVar23;
  ulong uVar24;
  long lVar25;
  undefined8 uVar26;
  
  *(ulong *)(this + 0x48) = *(ulong *)(this + 0x48) | *param_1;
  *(undefined4 *)(this + 0x50) = *(undefined4 *)((long)param_1 + 0x14);
  uVar23 = param_1[0x20];
  *(ulong *)(this + 0x158) = uVar23;
  if (uVar23 != 0) {
    lVar19 = *(long *)(this + 0x30);
    plVar12 = *(long **)(lVar19 + 0x150);
    if (plVar12 == (long *)0x0) {
      *(undefined8 *)(this + 0x150) = 0;
    }
    else {
      (**(code **)(*plVar12 + 0x20))();
      lVar19 = *(long *)(lVar19 + 0x150);
      *(long *)(this + 0x150) = lVar19;
      if (lVar19 != 0) goto LAB_0004cd2b;
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: No notification port\n");
    *(undefined8 *)(this + 0x158) = 0;
  }
LAB_0004cd2b:
  pIVar1 = this + 0x38;
  pIVar21 = this + 0x28;
  pIVar18 = this + 0xa0;
  uVar23 = 0;
  bVar9 = true;
  do {
    uVar22 = (uint)uVar23;
    if ((*(uint *)(this + 0x48) >> uVar22 & 1) == 0) {
      lVar19 = uVar23 * 0x70;
      if (*(long *)(*(long *)(*(long *)pIVar21 + 0x240) + 0x20 + lVar19) == 0) {
        lVar14 = 0;
        bVar8 = true;
        do {
          bVar10 = bVar8;
          *(undefined8 *)(*(long *)pIVar1 + lVar19 + 0x30 + lVar14 * 8) =
               *(undefined8 *)(*(long *)(*(long *)pIVar21 + 0x240) + lVar19 + 0x30 + lVar14 * 8);
          plVar12 = *(long **)(*(long *)pIVar1 + lVar19 + 0x30 + lVar14 * 8);
          if (plVar12 != (long *)0x0) {
            (**(code **)(*plVar12 + 0x20))();
          }
          lVar14 = 1;
          bVar8 = false;
        } while (bVar10);
      }
      else {
        lVar14 = 0;
        bVar8 = true;
        do {
          bVar10 = bVar8;
          *(undefined8 *)(*(long *)pIVar1 + lVar19 + 0x10 + lVar14 * 8) =
               *(undefined8 *)(*(long *)(*(long *)pIVar21 + 0x240) + lVar19 + 0x10 + lVar14 * 8);
          plVar12 = *(long **)(*(long *)pIVar1 + lVar19 + 0x10 + lVar14 * 8);
          if (plVar12 != (long *)0x0) {
            (**(code **)(*plVar12 + 0x20))();
            *(undefined8 *)(*(long *)pIVar1 + lVar19 + 0x20 + lVar14 * 8) =
                 *(undefined8 *)(*(long *)(*(long *)pIVar21 + 0x240) + lVar19 + 0x20 + lVar14 * 8);
            (**(code **)(**(long **)(*(long *)pIVar1 + lVar19 + 0x20 + lVar14 * 8) + 0x20))();
            *(undefined8 *)(*(long *)pIVar1 + lVar19 + 0x30 + lVar14 * 8) =
                 *(undefined8 *)(*(long *)(*(long *)pIVar21 + 0x240) + lVar19 + 0x30 + lVar14 * 8);
            (**(code **)(**(long **)(*(long *)pIVar1 + lVar19 + 0x30 + lVar14 * 8) + 0x20))();
          }
          lVar14 = 1;
          bVar8 = false;
        } while (bVar10);
      }
      lVar14 = *(long *)(*(long *)pIVar21 + 0x240);
      lVar25 = *(long *)pIVar1;
      *(undefined4 *)(lVar25 + 0x78 + lVar19) = *(undefined4 *)(lVar14 + 0x78 + lVar19);
      uVar15 = *(undefined8 *)(lVar14 + 0x50 + lVar19);
      *(undefined8 *)(lVar25 + 0x48 + lVar19) = *(undefined8 *)(lVar14 + 0x48 + lVar19);
      *(undefined8 *)(lVar25 + 0x50 + lVar19) = uVar15;
      uVar15 = *(undefined8 *)(*(long *)(*(long *)pIVar21 + 0x240) + 0x60 + lVar19);
      lVar14 = *(long *)pIVar1;
      *(undefined8 *)(lVar14 + 0x58 + lVar19) =
           *(undefined8 *)(*(long *)(*(long *)pIVar21 + 0x240) + 0x58 + lVar19);
      *(undefined8 *)(lVar14 + 0x60 + lVar19) = uVar15;
      uVar15 = *(undefined8 *)(*(long *)(*(long *)pIVar21 + 0x240) + 0x68 + lVar19);
      uVar26 = *(undefined8 *)(*(long *)(*(long *)pIVar21 + 0x240) + 0x70 + lVar19);
      pIVar20 = pIVar1;
    }
    else {
      lVar19 = uVar23 * 0x40;
      iVar11 = (int)param_1[uVar23 * 8 + 3];
      if (iVar11 == 0) {
        IOAccelDisplayPipe::set_current_plane_resources
                  (*(IOAccelDisplayPipe **)pIVar21,pIVar18,uVar22,(long *)0x0,(long *)0x0);
      }
      else if (iVar11 == 2) {
        this_00 = (IOAccelSurface *)
                  IOAccelSurfaceList::findSurfaceForID
                            ((IOAccelSurfaceList *)(*(long *)(this + 0x20) + 0xaa8),
                             (int)param_1[uVar23 * 8 + 4]);
        if (this_00 == (IOAccelSurface *)0x0) {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s returning kIOReturnBadArgument for transaction(%d): can\'t find IOAccelSurface ID %d.\n"
                            ,
                            "IOReturn IOAccelDisplayPipeTransaction2::set_transaction_args(sIOAccelDisplayPipeTransactionArgs *)"
                            ,*(undefined4 *)(this + 0x54),(int)param_1[uVar23 * 8 + 4]);
          return -0x1ffffd3e;
        }
        lVar25 = uVar23 * 0x70;
        *(undefined8 *)(*(long *)pIVar1 + 0x30 + lVar25) = *(undefined8 *)(this_00 + 0x11c0);
        *(undefined8 *)(*(long *)pIVar1 + 0x38 + lVar25) = *(undefined8 *)(this_00 + 0x11d8);
        lVar14 = *(long *)pIVar1;
        plVar12 = *(long **)(lVar14 + 0x30 + lVar25);
        if (plVar12 != (long *)0x0) {
          (**(code **)(*plVar12 + 0x20))();
          lVar14 = *(long *)pIVar1;
        }
        plVar12 = *(long **)(lVar14 + 0x38 + lVar25);
        if (plVar12 == (long *)0x0) {
          plVar12 = (long *)0x0;
        }
        else {
          (**(code **)(*plVar12 + 0x20))();
          lVar14 = *(long *)pIVar1;
          plVar12 = *(long **)(lVar14 + 0x38 + lVar25);
        }
        IOAccelDisplayPipe::set_current_plane_resources
                  (*(IOAccelDisplayPipe **)pIVar21,pIVar18,uVar22,*(long **)(lVar14 + 0x30 + lVar25)
                   ,plVar12);
        IOAccelSurface::update_swap_event(this_00,pIVar18);
      }
      else if (iVar11 == 1) {
        bVar10 = false;
        uVar24 = 0;
        bVar8 = true;
        do {
          bVar7 = bVar8;
          if ((bVar10) && (*(int *)((long)param_1 + lVar19 + 0x24) == 0)) {
            IOAccelDisplayPipe::set_current_plane_ioSurfaceDeviceCache
                      (*(IOAccelDisplayPipe **)pIVar21,pIVar18,uVar23,1,0);
            break;
          }
          puVar2 = (uint *)((long)param_1 + uVar24 * 4 + lVar19 + 0x20);
          plVar12 = (long *)IOSurfaceRoot::lookupSurface
                                      ((uint)*(undefined8 *)(*(long *)(this + 0x20) + 0x170),
                                       (task *)(ulong)*puVar2);
          if (plVar12 == (long *)0x0) {
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                              "%s returning kIOReturnBadArgument for transaction(%d): can\'t find IOSurface ID %d.\n"
                              ,
                              "IOReturn IOAccelDisplayPipeTransaction2::set_transaction_args(sIOAccelDisplayPipeTransactionArgs *)"
                              ,*(undefined4 *)(this + 0x54),*puVar2);
            return -0x1ffffd3e;
          }
          plVar13 = IOGraphicsAccelerator2::deviceCacheForIOSurface
                              (*(IOGraphicsAccelerator2 **)(this + 0x20),plVar12);
          if (plVar13 == (long *)0x0) {
            (**(code **)(*plVar12 + 0x28))(plVar12);
            __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                              "%s returning kIOReturnNoMemory for transaction(%d): no deviceCache.\n"
                              ,
                              "IOReturn IOAccelDisplayPipeTransaction2::set_transaction_args(sIOAccelDisplayPipeTransactionArgs *)"
                              ,*(undefined4 *)(this + 0x54));
            return -0x1ffffd43;
          }
          lVar14 = uVar23 * 0x70;
          *(long **)(*(long *)pIVar1 + lVar14 + 0x10 + uVar24 * 8) = plVar13;
          *(long **)(*(long *)pIVar1 + lVar14 + 0x20 + uVar24 * 8) = plVar12;
          *(long *)(*(long *)pIVar1 + lVar14 + 0x30 + uVar24 * 8) = plVar13[4];
          (**(code **)(**(long **)(lVar14 + *(long *)pIVar1 + 0x30 + uVar24 * 8) + 0x20))();
          IOAccelDisplayPipe::set_current_plane_ioSurfaceDeviceCache
                    (*(IOAccelDisplayPipe **)pIVar21,pIVar18,uVar23,uVar24,(long)plVar13);
          if ((___ktrace_kernel_enabled != 0) && (___ktrace_display_enabled != 0)) {
            uVar15 = IOSurface::getIndexedTimestamp((ulonglong)plVar12);
            *(undefined8 *)(this + 0x1b0) = uVar15;
            if (___ktrace_kernel_enabled != 0) {
              uVar16 = IORegistryEntry::getRegistryEntryID();
              _kernel_debug(0x85200048,uVar16,(ulong)*(uint *)(this + 0x54),
                            (ulong)*puVar2 | uVar23 << 0x20,*(uintptr_t *)(this + 0x1b0),0);
              if (___ktrace_kernel_enabled != 0) {
                uVar16 = IORegistryEntry::getRegistryEntryID();
                _kernel_debug(0x85200050,uVar16,(ulong)*(uint *)(this + 0x54),
                              (ulong)*puVar2 | uVar23 << 0x20,
                              (ulong)*(uint *)(*(long *)(this + 0x28) + 0x284),0);
              }
            }
          }
          uVar24 = 1;
          bVar10 = true;
          bVar8 = false;
        } while (bVar7);
      }
      lVar14 = *(long *)pIVar1;
      lVar17 = uVar23 * 0x70;
      *(undefined4 *)(lVar14 + 0x78 + lVar17) = *(undefined4 *)((long)param_1 + lVar19 + 0x1c);
      uVar24 = param_1[uVar23 * 8 + 6];
      *(ulong *)(lVar14 + 0x48 + lVar17) = param_1[uVar23 * 8 + 5];
      *(ulong *)(lVar14 + 0x50 + lVar17) = uVar24;
      lVar19 = *(long *)pIVar1;
      uVar24 = param_1[uVar23 * 8 + 7];
      *(ulong *)(lVar19 + 0x60 + lVar17) = param_1[uVar23 * 8 + 8];
      *(ulong *)(lVar19 + 0x58 + lVar17) = uVar24;
      lVar19 = *(long *)pIVar1;
      uVar24 = param_1[uVar23 * 8 + 9];
      *(ulong *)(lVar19 + 0x70 + lVar17) = param_1[uVar23 * 8 + 10];
      *(ulong *)(lVar19 + 0x68 + lVar17) = uVar24;
      lVar19 = *(long *)pIVar21;
      lVar14 = *(long *)pIVar1;
      uVar3 = *(undefined8 *)(lVar14 + 0x48 + lVar17);
      uVar4 = *(undefined8 *)(lVar14 + 0x50 + lVar17);
      uVar5 = *(undefined8 *)(lVar14 + 0x58 + lVar17);
      uVar6 = *(undefined8 *)(lVar14 + 0x60 + lVar17);
      uVar15 = *(undefined8 *)(lVar14 + 0x68 + lVar17);
      uVar26 = *(undefined8 *)(lVar14 + 0x70 + lVar17);
      lVar25 = *(long *)(lVar19 + 0x240);
      *(undefined4 *)(lVar25 + 0x78 + lVar17) = *(undefined4 *)(lVar14 + 0x78 + lVar17);
      *(undefined8 *)(lVar25 + 0x48 + lVar17) = uVar3;
      *(undefined8 *)(lVar25 + 0x50 + lVar17) = uVar4;
      lVar14 = *(long *)(lVar19 + 0x240);
      *(undefined8 *)(lVar14 + 0x58 + lVar17) = uVar5;
      *(undefined8 *)(lVar14 + 0x60 + lVar17) = uVar6;
      pIVar20 = (IOAccelDisplayPipeTransaction2 *)(lVar19 + 0x240);
    }
    lVar19 = *(long *)pIVar20;
    lVar14 = uVar23 * 0x70;
    *(undefined8 *)(lVar19 + 0x68 + lVar14) = uVar15;
    *(undefined8 *)(lVar19 + 0x70 + lVar14) = uVar26;
    if ((*(uint *)(this + 0x48) >> (sbyte)uVar23 & 4) == 0) {
      plVar12 = *(long **)(*(long *)(*(IOAccelDisplayPipe **)(this + 0x28) + 0x240) + 0x40 + lVar14)
      ;
      *(long **)(*(long *)pIVar1 + 0x40 + lVar14) = plVar12;
      if (plVar12 != (long *)0x0) {
        (**(code **)(*plVar12 + 0x20))();
      }
    }
    else {
      IOAccelDisplayPipe::set_current_plane_gamma_table
                (*(IOAccelDisplayPipe **)(this + 0x28),uVar22,
                 *(long **)(*(long *)pIVar1 + 0x40 + lVar14));
    }
    uVar23 = 1;
    bVar8 = !bVar9;
    bVar9 = false;
    if (bVar8) {
      if (((byte)this[0x48] & 0x40) == 0) {
        lVar19 = *(long *)(*(long *)pIVar21 + 0x240);
        lVar14 = *(long *)pIVar1;
        uVar15 = *(undefined8 *)(lVar19 + 0x108);
        uVar26 = *(undefined8 *)(lVar19 + 0x110);
        uVar3 = *(undefined8 *)(lVar19 + 0x118);
        uVar4 = *(undefined8 *)(lVar19 + 0x120);
        uVar5 = *(undefined8 *)(lVar19 + 0x128);
        *(undefined8 *)(lVar14 + 0x130) = *(undefined8 *)(lVar19 + 0x130);
        *(undefined8 *)(lVar14 + 0x128) = uVar5;
        *(undefined8 *)(lVar14 + 0x120) = uVar4;
        *(undefined8 *)(lVar14 + 0x118) = uVar3;
        *(undefined8 *)(lVar14 + 0x110) = uVar26;
        *(undefined8 *)(lVar14 + 0x108) = uVar15;
        pIVar18 = pIVar1;
        pIVar20 = (IOAccelDisplayPipeTransaction2 *)(*(long *)pIVar21 + 0x240);
      }
      else {
        lVar19 = *(long *)pIVar1;
        *(ulong *)(lVar19 + 0x130) = param_1[0x1b];
        *(ulong *)(lVar19 + 0x128) = param_1[0x1a];
        *(ulong *)(lVar19 + 0x120) = param_1[0x19];
        *(ulong *)(lVar19 + 0x118) = param_1[0x18];
        uVar23 = param_1[0x16];
        *(ulong *)(lVar19 + 0x110) = param_1[0x17];
        *(ulong *)(lVar19 + 0x108) = uVar23;
        lVar19 = *(long *)pIVar1;
        uVar23 = param_1[0x1c];
        *(ulong *)(lVar19 + 0x140) = param_1[0x1d];
        *(ulong *)(lVar19 + 0x148) = param_1[0x1e];
        *(ulong *)(lVar19 + 0x138) = uVar23;
        lVar19 = *(long *)pIVar1;
        lVar14 = *(long *)(*(long *)pIVar21 + 0x240);
        uVar15 = *(undefined8 *)(lVar19 + 0x108);
        uVar26 = *(undefined8 *)(lVar19 + 0x110);
        uVar3 = *(undefined8 *)(lVar19 + 0x118);
        uVar4 = *(undefined8 *)(lVar19 + 0x120);
        uVar5 = *(undefined8 *)(lVar19 + 0x128);
        *(undefined8 *)(lVar14 + 0x130) = *(undefined8 *)(lVar19 + 0x130);
        *(undefined8 *)(lVar14 + 0x128) = uVar5;
        *(undefined8 *)(lVar14 + 0x120) = uVar4;
        *(undefined8 *)(lVar14 + 0x118) = uVar3;
        *(undefined8 *)(lVar14 + 0x110) = uVar26;
        *(undefined8 *)(lVar14 + 0x108) = uVar15;
        pIVar18 = (IOAccelDisplayPipeTransaction2 *)(*(long *)pIVar21 + 0x240);
        pIVar20 = pIVar1;
      }
      lVar19 = *(long *)pIVar20;
      lVar14 = *(long *)pIVar18;
      uVar15 = *(undefined8 *)(lVar19 + 0x138);
      uVar26 = *(undefined8 *)(lVar19 + 0x140);
      *(undefined8 *)(lVar14 + 0x148) = *(undefined8 *)(lVar19 + 0x148);
      *(undefined8 *)(lVar14 + 0x140) = uVar26;
      *(undefined8 *)(lVar14 + 0x138) = uVar15;
      if (((byte)this[0x48] & 3) == 0) {
        uVar23 = *(ulong *)(*(long *)(*(long *)pIVar21 + 0x240) + 0x150);
        pIVar18 = pIVar1;
      }
      else {
        uVar23 = param_1[0x1f];
        *(ulong *)(*(long *)pIVar1 + 0x150) = uVar23;
        pIVar18 = (IOAccelDisplayPipeTransaction2 *)(*(long *)pIVar21 + 0x240);
      }
      *(ulong *)(*(long *)pIVar18 + 0x150) = uVar23;
      if (((byte)this[0x48] & 0x10) == 0) {
        pIVar18 = pIVar1;
        pIVar21 = (IOAccelDisplayPipeTransaction2 *)(*(long *)pIVar21 + 0x240);
      }
      else {
        lVar19 = *(long *)pIVar1;
        *(ulong *)(lVar19 + 0x100) = param_1[0x15];
        uVar23 = param_1[0x13];
        *(ulong *)(lVar19 + 0xf8) = param_1[0x14];
        *(ulong *)(lVar19 + 0xf0) = uVar23;
        pIVar18 = (IOAccelDisplayPipeTransaction2 *)(*(long *)pIVar21 + 0x240);
        pIVar21 = pIVar1;
      }
      lVar19 = *(long *)pIVar21;
      lVar14 = *(long *)pIVar18;
      uVar15 = *(undefined8 *)(lVar19 + 0xf0);
      uVar26 = *(undefined8 *)(lVar19 + 0xf8);
      *(undefined8 *)(lVar14 + 0x100) = *(undefined8 *)(lVar19 + 0x100);
      *(undefined8 *)(lVar14 + 0xf8) = uVar26;
      *(undefined8 *)(lVar14 + 0xf0) = uVar15;
      if (((byte)this[0x48] & 0x20) == 0) {
        plVar12 = (long *)**(long **)(*(IOAccelDisplayPipe **)(this + 0x28) + 0x240);
        **(long **)pIVar1 = (long)plVar12;
        if (plVar12 != (long *)0x0) {
          (**(code **)(*plVar12 + 0x20))();
        }
      }
      else {
        IOAccelDisplayPipe::set_current_pipe_pregamma_table
                  (*(IOAccelDisplayPipe **)(this + 0x28),(long *)**(undefined8 **)pIVar1);
      }
      if (((byte)this[0x48] & 0x80) == 0) {
        plVar12 = *(long **)(*(long *)(*(IOAccelDisplayPipe **)(this + 0x28) + 0x240) + 8);
        *(long **)(*(long *)pIVar1 + 8) = plVar12;
        if (plVar12 != (long *)0x0) {
          (**(code **)(*plVar12 + 0x20))();
        }
      }
      else {
        IOAccelDisplayPipe::set_current_pipe_postgamma_table
                  (*(IOAccelDisplayPipe **)(this + 0x28),*(long **)(*(long *)pIVar1 + 8));
      }
      if (((byte)this[0x49] & 4) == 0) {
        plVar12 = *(long **)(*(long *)(*(IOAccelDisplayPipe **)(this + 0x28) + 0x240) + 0x160);
        *(long **)(*(long *)pIVar1 + 0x160) = plVar12;
        if (plVar12 != (long *)0x0) {
          (**(code **)(*plVar12 + 0x20))();
        }
      }
      else {
        IOAccelDisplayPipe::set_current_pipe_postcscgamma_vid
                  (*(IOAccelDisplayPipe **)(this + 0x28),*(long **)(*(long *)pIVar1 + 0x160));
      }
      if (((byte)this[0x49] & 2) == 0) {
        plVar12 = *(long **)(*(long *)(*(IOAccelDisplayPipe **)(this + 0x28) + 0x240) + 0x158);
        *(long **)(*(long *)pIVar1 + 0x158) = plVar12;
        if (plVar12 != (long *)0x0) {
          (**(code **)(*plVar12 + 0x20))();
        }
      }
      else {
        IOAccelDisplayPipe::set_current_pipe_precsclinearization_vid
                  (*(IOAccelDisplayPipe **)(this + 0x28),*(long **)(*(long *)pIVar1 + 0x158));
      }
      if (((uint)*(undefined8 *)(this + 0x48) >> 8 & 1) != 0) {
        *(ulong *)(this + 0x40) = param_1[1];
      }
      if (((uint)*(undefined8 *)(this + 0x48) >> 0x10 & 1) != 0) {
        *(ulong *)(this + 0x128) = param_1[0x21];
        *(ulong *)(this + 0x130) = param_1[0x22];
      }
      iVar11 = (**(code **)(**(long **)(this + 0x28) + 0x8a0))(*(long **)(this + 0x28),this);
      if (iVar11 == 0) {
        iVar11 = 0;
      }
      else {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s returning error 0x%x for transaction(%d).\n",
                          "IOReturn IOAccelDisplayPipeTransaction2::set_transaction_args(sIOAccelDisplayPipeTransactionArgs *)"
                          ,iVar11,*(undefined4 *)(this + 0x54));
      }
      return iVar11;
    }
  } while( true );
}



// IOAccelDisplayPipe::transaction_abort(unsigned int)

void __thiscall IOAccelDisplayPipe::transaction_abort(IOAccelDisplayPipe *this,int param_1)

{
  long *plVar1;
  long *plVar2;
  long *plVar3;
  char *pcVar4;
  
  plVar1 = *(long **)(this + 0xf8);
  do {
    plVar2 = plVar1;
    if (plVar2 == (long *)0x0) {
      return;
    }
    plVar1 = (long *)plVar2[2];
  } while (*(int *)((long)plVar2 + 0x54) != param_1);
  if (plVar1 == (long *)0x0) {
    plVar3 = (long *)plVar2[3];
    if ((long *)*plVar3 == plVar2) {
      *(long **)(this + 0x100) = plVar3;
LAB_0004d7fb:
      *plVar3 = (long)plVar1;
                    // WARNING: Could not recover jumptable at 0x0004d805. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*plVar2 + 0x28))(plVar2);
      return;
    }
  }
  else {
    if ((long *)plVar1[3] != plVar2 + 2) {
      pcVar4 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
      goto LAB_0004d818;
    }
    if (*(long **)plVar2[3] == plVar2) {
      plVar1[3] = (long)plVar2[3];
      plVar3 = (long *)plVar2[3];
      goto LAB_0004d7fb;
    }
  }
  pcVar4 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_0004d818:
                    // WARNING: Subroutine does not return
  _panic(pcVar4,plVar2,0x42b,"IOAccelDisplayPipe.cpp",0x42b);
}



// IOAccelDisplayPipe::transaction_wait_gated(IOAccelDisplayPipeTransactionWaitArgs*)

uint __thiscall IOAccelDisplayPipe::transaction_wait_gated(IOAccelDisplayPipe *this,uint *param_1)

{
  uint uVar1;
  long lVar2;
  long lVar3;
  char cVar4;
  int iVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  long lVar8;
  uint uVar9;
  char *pcVar10;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined4 local_34;
  
  uVar1 = param_1[1];
  local_40 = &DAT_aaaaaaaaaaaaaaaa;
  _clock_interval_to_deadline(param_1[2],1000000);
  do {
    iVar5 = *(int *)(this + 0x238);
    if (iVar5 < *(int *)(this + 0x23c)) {
      do {
        lVar2 = *(long *)(this + (long)(iVar5 % 4) * 0x48 + 0x158);
        if (*(uint *)(lVar2 + 0x54) == *param_1) {
          cVar4 = (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x180))
                            (*(long **)(*(long *)(this + 0x88) + 0x380),
                             this + (long)(iVar5 % 4) * 0x48 + 0x118);
          if (cVar4 == '\0') {
            iVar5 = -1;
            uVar9 = 0xe0078005;
          }
          else {
            uVar9 = *(int *)(lVar2 + 0x58) == -0x1ffffd28 ^ 0xe0078007;
            iVar5 = 0;
          }
          goto LAB_0004d957;
        }
        iVar5 = iVar5 + 1;
      } while (*(int *)(this + 0x23c) != iVar5);
    }
    if ((*(long *)(this + 0x248) == 0) || (*(uint *)(*(long *)(this + 0x248) + 0x54) != *param_1)) {
      if (*(long *)(this + 0x250) == 0) {
LAB_0004d93f:
        iVar5 = 2;
        uVar9 = 0xe00002bc;
      }
      else {
        uVar9 = *(uint *)(*(long *)(this + 0x250) + 0x54);
        if (uVar9 == *param_1) {
          iVar5 = 1;
          uVar9 = 0xe0078009;
        }
        else {
          if (uVar9 <= *param_1) goto LAB_0004d93f;
          iVar5 = 2;
          uVar9 = 0xe007800a;
        }
      }
    }
    else {
      iVar5 = 0;
      uVar9 = 0xe0078008;
    }
LAB_0004d957:
    if ((param_1[1] & 8) != 0) {
      return uVar9;
    }
    if ((int)(uVar1 & 3) <= iVar5) {
      return 0;
    }
    if ((param_1[1] & 4) != 0) {
      return 0xe00002d6;
    }
    iVar5 = (**(code **)(**(long **)(this + 0xb0) + 0x1f0))(*(long **)(this + 0xb0),this,local_40,1)
    ;
    if (iVar5 != 0) {
      local_50 = &DAT_aaaaaaaaaaaaaaaa;
      local_48 = &DAT_aaaaaaaaaaaaaaaa;
      _clock_get_uptime(&local_50);
      local_50 = local_50 + -*(long *)(this + 0x268);
      _absolutetime_to_nanoseconds(local_50,&local_48);
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: IOAccelDisplayPipe::transaction_wait_gated Timeout (%d millisec). last VBL was %llu millisec ago. readCount=%d, writeCount=%d\n"
                        ,*(undefined8 *)(*(long *)(this + 0x88) + 0xc88),param_1[2],
                        (ulong)local_48 / 1000000,*(undefined4 *)(this + 0x238),
                        *(undefined4 *)(this + 0x23c));
      if (*(int *)(this + 0x238) < *(int *)(this + 0x23c)) {
        lVar8 = (long)(*(int *)(this + 0x238) % 4);
        lVar2 = *(long *)(this + lVar8 * 0x48 + 0x158);
        if (lVar2 != 0) {
          lVar3 = *(long *)(*(long *)(lVar2 + 0x38) + 0x20);
          cVar4 = (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x180))
                            (*(long **)(*(long *)(this + 0x88) + 0x380),this + lVar8 * 0x48 + 0x118)
          ;
          if (lVar3 == 0) {
            pcVar10 = "not";
            if (cVar4 != '\0') {
              pcVar10 = "";
            }
            uVar7 = *(undefined4 *)(this + 0x238);
            uVar6 = 0;
          }
          else {
            local_34 = CONCAT31(local_34._1_3_,cVar4);
            IOSurface::getSurfaceID();
            pcVar10 = "not";
            if ((char)local_34 != '\0') {
              pcVar10 = "";
            }
            local_34 = *(undefined4 *)(this + 0x238);
            uVar6 = IOSurface::getSurfaceID();
            uVar7 = local_34;
          }
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "\tTransaction[%d] IOSurfaceID=%d errorCode=0x%x, Rendering %s finished\n"
                            ,uVar7,uVar6,*(undefined4 *)(lVar2 + 0x160),pcVar10);
        }
      }
      if (*(long *)(this + 0x248) != 0) {
        if (*(long *)(*(long *)(*(long *)(this + 0x248) + 0x38) + 0x20) == 0) {
          uVar7 = 0;
        }
        else {
          IOSurface::getSurfaceID();
          uVar7 = IOSurface::getSurfaceID();
        }
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "\tPending transaction IOSurfaceID=%d\n",uVar7);
      }
      if (*(long *)(this + 0x250) != 0) {
        if (*(long *)(*(long *)(*(long *)(this + 0x250) + 0x38) + 0x20) == 0) {
          uVar7 = 0;
        }
        else {
          IOSurface::getSurfaceID();
          uVar7 = IOSurface::getSurfaceID();
        }
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"\tLive transaction IOSurfaceID=%d\n"
                          ,uVar7);
      }
      return 0xe00002d6;
    }
  } while( true );
}



// IOAccelDisplayPipeTransaction2::getPlaneIOSurface(unsigned int, unsigned int) const

undefined8 __thiscall
IOAccelDisplayPipeTransaction2::getPlaneIOSurface
          (IOAccelDisplayPipeTransaction2 *this,uint param_1,uint param_2)

{
  return *(undefined8 *)((ulong)param_1 * 0x70 + *(long *)(this + 0x38) + 0x20 + (ulong)param_2 * 8)
  ;
}



// IOAccelDisplayPipe::transaction_wait_nolock(IOAccelDisplayPipeTransactionWaitArgs*)

undefined8 __thiscall
IOAccelDisplayPipe::transaction_wait_nolock(IOAccelDisplayPipe *this,undefined8 param_1)

{
  long *plVar1;
  undefined8 uVar2;
  
  plVar1 = *(long **)(this + 0xb0);
  if (plVar1 != (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0004dc2f. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar2 = (**(code **)(*plVar1 + 0x1c8))(plVar1,transaction_wait_gated,param_1,0,0,0);
    return uVar2;
  }
  return 0;
}



// IOAccelDisplayPipe::setup_workloop()

void __thiscall IOAccelDisplayPipe::setup_workloop(IOAccelDisplayPipe *this)

{
  undefined8 uVar1;
  long lVar2;
  
  uVar1 = (**(code **)(*(long *)this + 0x8c8))();
  *(undefined8 *)(this + 0xb8) = uVar1;
  lVar2 = IOCommandGate::commandGate
                    ((OSObject *)this,
                     (_func_int_OSObject_ptr_void_ptr_void_ptr_void_ptr_void_ptr *)0x0);
  *(long *)(this + 0xb0) = lVar2;
  if (lVar2 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Failed to create fGate!\n",
                      "void IOAccelDisplayPipe::setup_workloop()");
  }
  else {
    (**(code **)(**(long **)(this + 0xb8) + 0x140))(*(long **)(this + 0xb8),lVar2);
    (**(code **)(**(long **)(this + 0xb0) + 0x150))();
  }
  lVar2 = IOInterruptEventSource::interruptEventSource
                    ((OSObject *)this,event_interrupt_gated,(IOService *)0x0,0);
  *(long *)(this + 0xc0) = lVar2;
  if (lVar2 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Failed to create fEventInterrupt!\n"
                      ,"void IOAccelDisplayPipe::setup_workloop()");
  }
  else {
    (**(code **)(**(long **)(this + 0xb8) + 0x140))(*(long **)(this + 0xb8),lVar2);
    (**(code **)(**(long **)(this + 0xc0) + 0x150))();
  }
  lVar2 = IOInterruptEventSource::interruptEventSource
                    ((OSObject *)this,vbl_interrupt_gated,(IOService *)0x0,0);
  *(long *)(this + 200) = lVar2;
  if (lVar2 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: Failed to create fVBLInterrupt!\n",
                      "void IOAccelDisplayPipe::setup_workloop()");
  }
  else {
    (**(code **)(**(long **)(this + 0xb8) + 0x140))(*(long **)(this + 0xb8),lVar2);
    (**(code **)(**(long **)(this + 200) + 0x150))();
  }
  lVar2 = IOInterruptEventSource::interruptEventSource
                    ((OSObject *)this,transaction_interrupt_gated,(IOService *)0x0,0);
  *(long *)(this + 0xd0) = lVar2;
  if (lVar2 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Failed to create fTransactionInterrupt!\n",
                      "void IOAccelDisplayPipe::setup_workloop()");
  }
  else {
    (**(code **)(**(long **)(this + 0xb8) + 0x140))(*(long **)(this + 0xb8),lVar2);
    (**(code **)(**(long **)(this + 0xd0) + 0x150))();
  }
  lVar2 = IOTimerEventSource::timerEventSource((OSObject *)this,transaction_timeout_timer_fired);
  *(long *)(this + 0x2f0) = lVar2;
  if (lVar2 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: Failed to create fTransactionTimeoutTimer!\n",
                      "void IOAccelDisplayPipe::setup_workloop()");
  }
  else {
    (**(code **)(**(long **)(this + 0xb8) + 0x140))(*(long **)(this + 0xb8),lVar2);
    (**(code **)(**(long **)(this + 0x2f0) + 0x150))();
  }
  lVar2 = IOInterruptEventSource::interruptEventSource
                    ((OSObject *)this,report_vrr_timestamp_gated,(IOService *)0x0,0);
  *(long *)(this + 0x2c8) = lVar2;
  if (lVar2 != 0) {
    (**(code **)(**(long **)(this + 0xb8) + 0x140))(*(long **)(this + 0xb8),lVar2);
                    // WARNING: Could not recover jumptable at 0x0004dea0. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0x2c8) + 0x150))();
    return;
  }
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                    "%s: Failed to create fReportVRRTimeStampInterrupt!\n",
                    "void IOAccelDisplayPipe::setup_workloop()");
  return;
}



// IOAccelDisplayPipe::event_interrupt_gated()

void __thiscall IOAccelDisplayPipe::event_interrupt_gated(IOAccelDisplayPipe *this)

{
  ulonglong uVar1;
  char cVar2;
  int iVar3;
  uint uVar4;
  long lVar5;
  uint64_t uVar6;
  uintptr_t arg1;
  long lVar7;
  undefined8 uVar8;
  long *plVar9;
  ulong uStack_38;
  
  lVar7 = *(long *)(this + 0x248);
  do {
    while( true ) {
      if ((lVar7 != 0) || (*(int *)(this + 0x23c) <= *(int *)(this + 0x238))) goto LAB_0004def1;
      lVar5 = (long)(*(int *)(this + 0x238) % 4);
      lVar7 = *(long *)(this + lVar5 * 0x48 + 0x158);
      if ((*(int *)(lVar7 + 0x58) != -0x1ffebfbe) ||
         (cVar2 = (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x180))
                            (*(long **)(*(long *)(this + 0x88) + 0x380),this + lVar5 * 0x48 + 0x118)
         , cVar2 != '\0')) break;
      if (*(int *)(this + 0x29c) != 0) {
        if (*(int *)(this + 0x2a4) != 0) {
          (**(code **)(*(long *)this + 0x890))(this);
          *(undefined4 *)(this + 0x2a4) = 0;
        }
        goto LAB_0004def1;
      }
      enable_event_interrupt((long)this);
LAB_0004e213:
      lVar7 = *(long *)(this + 0x248);
    }
    uVar1 = *(ulonglong *)(*(long *)(lVar7 + 0x38) + 0x20);
    if (uVar1 != 0) {
      IOSurface::setDetachModeReservedCode(uVar1);
    }
    disable_event_interrupt(this,this + (long)(*(int *)(this + 0x238) % 4) * 0x48 + 0x118);
    *(long *)(this + 0x248) = lVar7;
    iVar3 = *(int *)(lVar7 + 0x58);
    if ((iVar3 == -0x1ffebfbe) || (iVar3 == -0x1ffffd28)) {
      iVar3 = -0x1ffffd1d;
      if ((this[0x299] == (IOAccelDisplayPipe)0x0) &&
         (iVar3 = -0x1ffffd29, this[0x280] == (IOAccelDisplayPipe)0x0)) {
        if (*(int *)(this + 0x2a4) == 0) {
          *(undefined4 *)(this + 0x2a4) = 1;
          (**(code **)(*(long *)this + 0x888))(this);
        }
        uVar6 = _mach_absolute_time();
        *(uint64_t *)(lVar7 + 0x168) = uVar6;
        iVar3 = (**(code **)(*(long *)this + 0x8a8))(this,lVar7);
        if ((___ktrace_kernel_enabled != 0) && (___ktrace_display_enabled != 0)) {
          if (*(long *)(*(long *)(lVar7 + 0x38) + 0x20) == 0) {
            uStack_38 = 0;
          }
          else {
            uVar4 = IOSurface::getSurfaceID();
            if (___ktrace_kernel_enabled == 0) goto LAB_0004e135;
            uStack_38 = (ulong)uVar4 << 0x20;
          }
          arg1 = IORegistryEntry::getRegistryEntryID();
          _kernel_debug(0x8520004c,arg1,(ulong)*(uint *)(lVar7 + 0x54),
                        (ulong)*(uint *)(this + 0x284),uStack_38 >> 0x20,0);
        }
LAB_0004e135:
        *(int *)(lVar7 + 0x160) = iVar3;
        goto LAB_0004e13c;
      }
LAB_0004e152:
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s [%d]: transaction ID (%d) generated error (0x%x). dirtyBits=0x%llx, options=0x%x\n\n"
                        ,*(undefined8 *)(*(long *)(this + 0x88) + 0xc88),
                        *(undefined4 *)(this + 0x284),*(undefined4 *)(lVar7 + 0x54),iVar3,
                        *(undefined8 *)(lVar7 + 0x48),*(undefined4 *)(lVar7 + 0x50));
      *(int *)(lVar7 + 0x160) = iVar3;
      if (*(long *)(lVar7 + 0x158) != 0) {
        uVar6 = _mach_absolute_time();
        *(uint64_t *)(lVar7 + 0x170) = uVar6;
        sendNotification(this,lVar7,8);
      }
      *(undefined8 *)(this + 0x248) = 0;
      *(int *)(this + 0x238) = *(int *)(this + 0x238) + 1;
      *(undefined8 *)(lVar7 + 0x10) = 0;
      plVar9 = *(long **)(this + 0x110);
      *(long **)(lVar7 + 0x18) = plVar9;
      *plVar9 = lVar7;
      *(long *)(this + 0x110) = lVar7 + 0x10;
      (**(code **)(*(long *)this + 0x8e0))(this,lVar7 + 0xa0);
      IOGraphicsAccelerator2::kickDisplayPostTransaction(*(IOGraphicsAccelerator2 **)(this + 0x88));
      goto LAB_0004e213;
    }
LAB_0004e13c:
    if (iVar3 != 0) {
      if (iVar3 != -0x1ffffd28) goto LAB_0004e152;
      *(undefined8 *)(this + 0x248) = 0;
      goto LAB_0004def1;
    }
    *(int *)(this + 0x238) = *(int *)(this + 0x238) + 1;
    if (*(long *)(this + 0x248) != 0) {
      cVar2 = (**(code **)(*(long *)this + 0x8b0))(this);
      if (cVar2 != '\0') {
        completeTransaction(this,*(long *)(this + 0x248));
      }
      lVar5 = *(long *)(this + 0x248);
      if (lVar5 != 0) {
        if (*(int *)(lVar7 + 0x58) == -0x1ffebfbe) {
          if (((*(long *)(lVar5 + 0x170) != 0) && (*(long *)(lVar5 + 0x178) != 0)) &&
             (*(long *)(lVar5 + 0x158) != 0)) {
            sendNotification(this,lVar5,2);
          }
          plVar9 = *(long **)(this + 0x2f0);
          lVar7 = *plVar9;
          uVar8 = 300;
        }
        else {
          plVar9 = *(long **)(this + 0x2f0);
          lVar7 = *plVar9;
          uVar8 = 9000;
        }
        (**(code **)(lVar7 + 0x1d0))(plVar9,uVar8);
LAB_0004def1:
        if (((*(int *)(this + 0x23c) == *(int *)(this + 0x238)) && (*(long *)(this + 0x248) == 0))
           && (*(int *)(this + 0x2a4) != 0)) {
          (**(code **)(*(long *)this + 0x890))(this);
          *(undefined4 *)(this + 0x2a4) = 0;
        }
                    // WARNING: Could not recover jumptable at 0x0004df4c. Too many branches
                    // WARNING: Treating indirect jump as call
        (**(code **)(**(long **)(this + 0xb0) + 0x1e8))(*(long **)(this + 0xb0),this,0);
        return;
      }
    }
    lVar7 = 0;
  } while( true );
}



// IOAccelDisplayPipe::vbl_interrupt_gated()

void __thiscall IOAccelDisplayPipe::vbl_interrupt_gated(IOAccelDisplayPipe *this)

{
  ulong uVar1;
  long lVar2;
  long *plVar3;
  char *pcVar4;
  long *plVar5;
  undefined1 *local_58;
  undefined1 *local_50;
  ulong local_48;
  ulong local_40;
  ulong local_38;
  ulong local_30;
  long local_28;
  
  local_28 = *(long *)PTR____stack_chk_guard_0006b0b0;
  uVar1 = *(ulong *)(this + 0x268);
  local_58 = &DAT_aaaaaaaaaaaaaaaa;
  local_50 = &DAT_aaaaaaaaaaaaaaaa;
  local_48 = uVar1 & 0xffffffff;
  local_40 = uVar1 >> 0x20;
  local_38 = *(long *)(this + 0x270) + uVar1 & 0xffffffff;
  local_30 = *(long *)(this + 0x270) + uVar1 >> 0x20;
  plVar5 = *(long **)(this + 600);
  if (plVar5 != (long *)0x0) {
    do {
      lVar2 = *plVar5;
      if (lVar2 == 0) {
        plVar3 = (long *)plVar5[1];
        if ((long *)*plVar3 != plVar5) {
LAB_0004e436:
          pcVar4 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_0004e446:
                    // WARNING: Subroutine does not return
          _panic(pcVar4,plVar5,0x845,"IOAccelDisplayPipe.cpp",0x845);
        }
        *(long **)(this + 0x260) = plVar3;
      }
      else {
        if (*(long **)(lVar2 + 8) != plVar5) {
          pcVar4 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
          goto LAB_0004e446;
        }
        if (*(long **)plVar5[1] != plVar5) goto LAB_0004e436;
        *(undefined8 **)(lVar2 + 8) = (undefined8 *)plVar5[1];
        plVar3 = (long *)plVar5[1];
      }
      *plVar3 = lVar2;
      local_58 = (undefined1 *)plVar5[5];
      local_50 = (undefined1 *)plVar5[6];
      IOAccelDisplayPipeUserClient2::sendAsyncResult64
                ((ulonglong *)(plVar5[2] + 0x10),0,(ulonglong *)&local_58,6);
      (**(code **)(*(long *)plVar5[2] + 0x28))();
      plVar5[2] = 0;
      plVar5 = *(long **)(this + 600);
    } while (plVar5 != (long *)0x0);
  }
  if (*(int *)(this + 0x2a0) != 0) {
    (**(code **)(*(long *)this + 0x880))(this);
    *(undefined4 *)(this + 0x2a0) = 0;
  }
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_28) {
    return;
  }
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// IOAccelDisplayPipe::transaction_interrupt_gated()

void __thiscall IOAccelDisplayPipe::transaction_interrupt_gated(IOAccelDisplayPipe *this)

{
  char cVar1;
  uint64_t uVar2;
  long lVar3;
  
  if (*(long *)(this + 0x248) != 0) {
    uVar2 = _mach_absolute_time();
    lVar3 = *(long *)(this + 0x248);
    *(uint64_t *)(lVar3 + 0x138) = uVar2;
    if (*(int *)(*(long *)(this + 0x88) + 0xdc8) == 0) {
      cVar1 = (**(code **)(*(long *)this + 0x8b0))(this);
      if (cVar1 == '\0') goto LAB_0004e4bd;
      lVar3 = *(long *)(this + 0x248);
    }
    completeTransaction(this,lVar3);
  }
LAB_0004e4bd:
  event_interrupt_gated(this);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipe::transaction_timeout_timer_fired(IOTimerEventSource*)

void __cdecl IOAccelDisplayPipe::transaction_timeout_timer_fired(long *param_1)

{
  char cVar1;
  
  if (param_1[0x49] != 0) {
    cVar1 = (**(code **)(*param_1 + 0x8b0))();
    if (cVar1 == '\0') {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: IOAccelDisplayPipeTransaction time out after 300ms. framebufferIndex=%d\n"
                        ,*(undefined8 *)(param_1[0x11] + 0xc88),
                        *(undefined4 *)((long)param_1 + 0x284));
                    // WARNING: Could not recover jumptable at 0x0004e537. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*param_1 + 0x928))(param_1);
      return;
    }
  }
  return;
}



// IOAccelDisplayPipe::report_vrr_timestamp_gated()

void __thiscall IOAccelDisplayPipe::report_vrr_timestamp_gated(IOAccelDisplayPipe *this)

{
  undefined8 *puVar1;
  uintptr_t arg1;
  ulonglong local_68 [5];
  undefined8 local_40;
  undefined8 local_38;
  undefined8 local_30;
  undefined8 local_28;
  undefined8 local_20;
  undefined8 local_18;
  
  puVar1 = *(undefined8 **)(this + 0x2b8);
  if ((puVar1 != (undefined8 *)0x0) && (*(long *)(this + 0x2c0) != 0)) {
    local_40 = 0;
    local_68[3] = 0;
    local_68[2] = 0;
    local_68[1] = 0;
    local_68[0] = 0;
    local_28 = 4;
    local_68[4] = *puVar1;
    local_38 = puVar1[1];
    local_30 = puVar1[2];
    local_20 = puVar1[3];
    local_18 = puVar1[4];
    IOAccelDisplayPipeUserClient2::sendAsyncResult64
              ((ulonglong *)(*(long *)(this + 0x2c0) + 0x10),0,local_68,0xb);
    if ((___ktrace_kernel_enabled != 0) && (___ktrace_display_enabled != 0)) {
      arg1 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x85200060,arg1,(ulong)*(uint *)(this + 0x284),0,0,0);
    }
  }
  return;
}



// IOAccelDisplayPipe::teardown_workloop_gated()

void __thiscall IOAccelDisplayPipe::teardown_workloop_gated(IOAccelDisplayPipe *this)

{
  if (*(long **)(this + 0x2f0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x2f0) + 0x158))();
    (**(code **)(**(long **)(this + 0x2f0) + 0x218))();
    (**(code **)(**(long **)(this + 0xb8) + 0x148))
              (*(long **)(this + 0xb8),*(undefined8 *)(this + 0x2f0));
  }
  if (*(long **)(this + 0xd0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xd0) + 0x158))();
    (**(code **)(**(long **)(this + 0xb8) + 0x148))
              (*(long **)(this + 0xb8),*(undefined8 *)(this + 0xd0));
  }
  if (*(long **)(this + 200) != (long *)0x0) {
    (**(code **)(**(long **)(this + 200) + 0x158))();
    (**(code **)(**(long **)(this + 0xb8) + 0x148))
              (*(long **)(this + 0xb8),*(undefined8 *)(this + 200));
  }
  if (*(long **)(this + 0xc0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xc0) + 0x158))();
    (**(code **)(**(long **)(this + 0xb8) + 0x148))
              (*(long **)(this + 0xb8),*(undefined8 *)(this + 0xc0));
  }
  if (*(long **)(this + 0x2c8) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x2c8) + 0x158))();
    (**(code **)(**(long **)(this + 0xb8) + 0x148))
              (*(long **)(this + 0xb8),*(undefined8 *)(this + 0x2c8));
  }
  if (*(long **)(this + 0xb0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xb0) + 0x158))();
                    // WARNING: Could not recover jumptable at 0x0004e740. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0xb8) + 0x148))
              (*(long **)(this + 0xb8),*(undefined8 *)(this + 0xb0));
    return;
  }
  return;
}



// IOAccelDisplayPipe::transaction_queue_gated(IOAccelDisplayPipeTransaction2*)

void __thiscall IOAccelDisplayPipe::transaction_queue_gated(IOAccelDisplayPipe *this,long param_1)

{
  undefined4 uVar1;
  
  if (*(int *)(this + 0x2a4) == 0) {
    *(undefined4 *)(this + 0x2a4) = 1;
    (**(code **)(*(long *)this + 0x888))(this);
  }
  uVar1 = (**(code **)(*(long *)this + 0x8b8))(this,param_1);
  *(undefined4 *)(param_1 + 0x58) = uVar1;
  *(long *)(this + (long)(*(int *)(this + 0x23c) % 4) * 0x48 + 0x158) = param_1;
  (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x1b0))
            (*(long **)(*(long *)(this + 0x88) + 0x380),param_1 + 0x60);
  *(int *)(this + 0x23c) = *(int *)(this + 0x23c) + 1;
                    // WARNING: Could not recover jumptable at 0x0004e7f3. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0xc0) + 0x1d8))(*(long **)(this + 0xc0),0,0,0);
  return;
}



// IOAccelDisplayPipe::submitTransaction(IOAccelDisplayPipeTransaction2*)

int __thiscall IOAccelDisplayPipe::submitTransaction(undefined8 param_1_00,long param_2)

{
  int iVar1;
  
  iVar1 = -0x1ffebfbe;
  if (*(int *)(param_2 + 0x58) != 0) {
    iVar1 = *(int *)(param_2 + 0x58);
  }
  return iVar1;
}



// IOAccelDisplayPipe::wait_for_queue_slot_gated()

void __thiscall IOAccelDisplayPipe::wait_for_queue_slot_gated(IOAccelDisplayPipe *this)

{
  int iVar1;
  
  iVar1 = *(int *)(this + 0x23c) - *(int *)(this + 0x238);
  while (iVar1 == 4) {
    (**(code **)(**(long **)(this + 0xb0) + 0x1e0))(*(long **)(this + 0xb0),this,0);
    iVar1 = *(int *)(this + 0x23c) - *(int *)(this + 0x238);
  }
  return;
}



// IOAccelDisplayPipe::enable_transaction_interrupt()

void __thiscall IOAccelDisplayPipe::enable_transaction_interrupt(IOAccelDisplayPipe *this)

{
  if (*(int *)(this + 0x2a4) != 0) {
    return;
  }
  *(undefined4 *)(this + 0x2a4) = 1;
                    // WARNING: Could not recover jumptable at 0x0004e86f. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x888))();
  return;
}



// IOAccelDisplayPipe::enable_vbl_interrupt()

void __thiscall IOAccelDisplayPipe::enable_vbl_interrupt(IOAccelDisplayPipe *this)

{
  if (*(int *)(this + 0x2a0) != 0) {
    return;
  }
  *(undefined4 *)(this + 0x2a0) = 1;
                    // WARNING: Could not recover jumptable at 0x0004e893. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x878))();
  return;
}



// IOAccelDisplayPipe::disable_vbl_interrupt()

void __thiscall IOAccelDisplayPipe::disable_vbl_interrupt(IOAccelDisplayPipe *this)

{
  if (*(int *)(this + 0x2a0) != 0) {
    (**(code **)(*(long *)this + 0x880))();
    *(undefined4 *)(this + 0x2a0) = 0;
  }
  return;
}



// IOAccelDisplayPipe::disable_transaction_interrupt()

void __thiscall IOAccelDisplayPipe::disable_transaction_interrupt(IOAccelDisplayPipe *this)

{
  if (*(int *)(this + 0x2a4) != 0) {
    (**(code **)(*(long *)this + 0x890))();
    *(undefined4 *)(this + 0x2a4) = 0;
  }
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipe::enable_event_interrupt(IOAccelEvent const*)

void __cdecl IOAccelDisplayPipe::enable_event_interrupt(long param_1)

{
  if (*(int *)(param_1 + 0x29c) != 0) {
    return;
  }
  *(undefined4 *)(param_1 + 0x29c) = 1;
  (**(code **)(**(long **)(*(long *)(param_1 + 0x88) + 0x380) + 600))();
  IOAccelDisplayMachine::enable_pipe_event_interrupt
            (*(IOAccelDisplayMachine **)(param_1 + 0x90),(byte)*(undefined4 *)(param_1 + 0x284));
  return;
}



// IOAccelDisplayPipe::disable_event_interrupt(IOAccelEvent const*)

void __thiscall
IOAccelDisplayPipe::disable_event_interrupt(IOAccelDisplayPipe *this,undefined8 param_1)

{
  if (*(int *)(this + 0x29c) != 0) {
    IOAccelDisplayMachine::disable_pipe_event_interrupt
              (*(IOAccelDisplayMachine **)(this + 0x90),(byte)*(undefined4 *)(this + 0x284));
    (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x260))
              (*(long **)(*(long *)(this + 0x88) + 0x380),param_1);
    *(undefined4 *)(this + 0x29c) = 0;
  }
  return;
}



// IOAccelDisplayPipe::completeTransaction(IOAccelDisplayPipeTransaction2*)

void __thiscall IOAccelDisplayPipe::completeTransaction(IOAccelDisplayPipe *this,long param_1)

{
  ulonglong uVar1;
  long lVar2;
  long *plVar3;
  uint64_t uVar4;
  uintptr_t arg1;
  
  uVar1 = *(ulonglong *)(*(long *)(param_1 + 0x38) + 0x20);
  if (uVar1 != 0) {
    IOSurface::setDetachModeReservedCode(uVar1);
  }
  (**(code **)(**(long **)(this + 0x2f0) + 0x218))();
  *(undefined4 *)(this + 0x314) = *(undefined4 *)(param_1 + 0x54);
  *(undefined8 *)(this + 0x308) = *(undefined8 *)(param_1 + 0x48);
  *(undefined4 *)(this + 0x310) = *(undefined4 *)(param_1 + 0x50);
  if (*(long *)(param_1 + 0x158) != 0) {
    if (*(long *)(param_1 + 0x170) == 0) {
      uVar4 = _mach_absolute_time();
      *(uint64_t *)(param_1 + 0x170) = uVar4;
    }
    sendNotification(this,param_1,1);
  }
  *(undefined8 *)(param_1 + 0x138) = 0;
  lVar2 = *(long *)(this + 0x250);
  if (lVar2 != 0) {
    *(undefined8 *)(lVar2 + 0x10) = 0;
    plVar3 = *(long **)(this + 0x110);
    *(long **)(lVar2 + 0x18) = plVar3;
    *plVar3 = lVar2;
    *(long *)(this + 0x110) = *(long *)(this + 0x250) + 0x10;
    *(undefined8 *)(this + 0x250) = 0;
  }
  if (___ktrace_kernel_enabled != 0) {
    arg1 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85200044,arg1,(ulong)*(uint *)(param_1 + 0x54),(ulong)*(uint *)(this + 0x284),
                  *(uintptr_t *)(param_1 + 0x1b0),0);
  }
  *(undefined8 *)(this + 0x248) = 0;
  *(long *)(this + 0x250) = param_1;
  (**(code **)(*(long *)this + 0x8e0))(this,param_1 + 0xa0);
  (**(code **)(**(long **)(this + 0xb0) + 0x1e8))(*(long **)(this + 0xb0),this,0);
  IOGraphicsAccelerator2::kickDisplayPostTransaction(*(IOGraphicsAccelerator2 **)(this + 0x88));
  return;
}



// IOAccelDisplayPipe::sendNotification(IOAccelDisplayPipeTransaction2*, unsigned int)

void __thiscall
IOAccelDisplayPipe::sendNotification(IOAccelDisplayPipe *this,long param_1,uint param_2)

{
  undefined4 uVar1;
  uintptr_t arg1;
  
  *(uint *)(param_1 + 0x198) = param_2;
  *(undefined4 *)(param_1 + 0x164) = *(undefined4 *)(param_1 + 0x54);
  uVar1 = IOAccelDisplayPipeUserClient2::sendAsyncResult64
                    ((ulonglong *)(*(long *)(param_1 + 0x150) + 0x10),0,
                     (ulonglong *)(param_1 + 0x158),0xb);
  *(undefined8 *)(param_1 + 0x158) = 0;
  (**(code **)(**(long **)(param_1 + 0x150) + 0x28))();
  *(undefined8 *)(param_1 + 0x150) = 0;
  *(undefined8 *)(this + 0x2d8) = *(undefined8 *)(this + 0x2e0);
  *(undefined8 *)(this + 0x2e0) = *(undefined8 *)(this + 0x2e8);
  *(undefined4 *)(this + 0x2e8) = *(undefined4 *)(param_1 + 0x54);
  *(undefined4 *)(this + 0x2ec) = uVar1;
  if ((___ktrace_kernel_enabled != 0) && (___ktrace_display_enabled != 0)) {
    arg1 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85200058,arg1,(ulong)*(uint *)(param_1 + 0x54),(ulong)*(uint *)(this + 0x284),
                  (ulong)param_2,0);
    return;
  }
  return;
}



// IOAccelDisplayPipeTransaction2::getTransactionID() const

undefined4 __thiscall
IOAccelDisplayPipeTransaction2::getTransactionID(IOAccelDisplayPipeTransaction2 *this)

{
  return *(undefined4 *)(this + 0x54);
}



// IOAccelDisplayPipeTransaction2::getTransactionDirtyBits() const

undefined8 __thiscall
IOAccelDisplayPipeTransaction2::getTransactionDirtyBits(IOAccelDisplayPipeTransaction2 *this)

{
  return *(undefined8 *)(this + 0x48);
}



// IOAccelDisplayPipeTransaction2::getTransactionOptions() const

undefined4 __thiscall
IOAccelDisplayPipeTransaction2::getTransactionOptions(IOAccelDisplayPipeTransaction2 *this)

{
  return *(undefined4 *)(this + 0x50);
}



// IOAccelDisplayPipe::signal_event_interrupt()

void __thiscall IOAccelDisplayPipe::signal_event_interrupt(IOAccelDisplayPipe *this)

{
  if ((*(int *)(this + 0x29c) != 0) && (*(int *)(this + 0x23c) != *(int *)(this + 0x238))) {
                    // WARNING: Could not recover jumptable at 0x0004ec2b. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0xc0) + 0x1d8))(*(long **)(this + 0xc0),0,0,0);
    return;
  }
  return;
}



// IOAccelDisplayPipe::enableVBLInterrupt()

void __thiscall IOAccelDisplayPipe::enableVBLInterrupt(IOAccelDisplayPipe *this)

{
  int iVar1;
  
  iVar1 = *(int *)(this + 0x2a8);
  *(int *)(this + 0x2a8) = iVar1 + 1;
  if ((iVar1 == 0) && (*(long *)(this + 0xd8) != 0)) {
                    // WARNING: Could not recover jumptable at 0x0004ec6c. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0x98) + 0xae0))
              (*(long **)(this + 0x98),*(long *)(this + 0xd8),1);
    return;
  }
  return;
}



// IOAccelDisplayPipe::disableVBLInterrupt()

void __thiscall IOAccelDisplayPipe::disableVBLInterrupt(IOAccelDisplayPipe *this)

{
  IOAccelDisplayPipe *pIVar1;
  
  pIVar1 = this + 0x2a8;
  *(int *)pIVar1 = *(int *)pIVar1 + -1;
  if ((*(int *)pIVar1 == 0) && (*(long *)(this + 0xd8) != 0)) {
                    // WARNING: Could not recover jumptable at 0x0004ec9c. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(this + 0x98) + 0xae0))
              (*(long **)(this + 0x98),*(long *)(this + 0xd8),0);
    return;
  }
  return;
}



// IOAccelDisplayPipe::ktraceStateChanged()

void IOAccelDisplayPipe::ktraceStateChanged(void)

{
  return;
}



// IOAccelDisplayPipe::enableTransactionInterrupt()

void __thiscall IOAccelDisplayPipe::enableTransactionInterrupt(IOAccelDisplayPipe *this)

{
  (**(code **)(*(long *)this + 0x878))();
  this[0x281] = (IOAccelDisplayPipe)0x1;
  return;
}



// IOAccelDisplayPipe::disableTransactionInterrupt()

void __thiscall IOAccelDisplayPipe::disableTransactionInterrupt(IOAccelDisplayPipe *this)

{
  (**(code **)(*(long *)this + 0x880))();
  this[0x281] = (IOAccelDisplayPipe)0x0;
  return;
}



// IOAccelDisplayPipe::beginTransaction(IOAccelEvent*)

void IOAccelDisplayPipe::beginTransaction(void)

{
  return;
}



// IOAccelDisplayPipe::signalTransactionComplete(IOAccelEvent*)

void IOAccelDisplayPipe::signalTransactionComplete(void)

{
  return;
}



// IOAccelDisplayPipe::logTransactionTimeoutDiagnosisReport()

void __thiscall IOAccelDisplayPipe::logTransactionTimeoutDiagnosisReport(IOAccelDisplayPipe *this)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  long lVar5;
  undefined8 uVar6;
  undefined *puVar7;
  undefined1 uVar8;
  char cVar9;
  char *pcVar10;
  
  puVar7 = PTR___os_log_default_0006b0b8;
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"\tframebufferIndex=%d, wsaa=%d\n",
                    *(undefined4 *)(this + 0x284),*(undefined4 *)(this + 0x278));
  __os_log_internal(0,puVar7,0x11,
                    "\teventInterruptEnabled=%d, transactionInterruptEnabled=%d, vblInterruptEnabled=%d\n"
                    ,*(undefined4 *)(this + 0x29c),*(undefined4 *)(this + 0x2a4),
                    *(undefined4 *)(this + 0x2a0));
  __os_log_internal(0,puVar7,0x11,
                    "\tpowerOff=%d, pipeTerminated=%d, acceleratorEnabled=%d, fWSAA=%d\n",
                    this[0x299],this[0x280],*(uint *)(*(long *)(this + 0x88) + 0xc78) >> 1 & 1,
                    *(undefined4 *)(this + 0x278));
  __os_log_internal(0,puVar7,0x11,"\tlastIOGraphicsMessageEvent=%d, fbIndex=%d\n",
                    *(undefined4 *)(this + 0x300),*(undefined4 *)(this + 0x304));
  __os_log_internal(0,puVar7,0x11,"\ttransactionQueueReadCount=%d, transactionQueueWriteCount=%d\n",
                    *(undefined4 *)(this + 0x238),*(undefined4 *)(this + 0x23c));
  __os_log_internal(0,puVar7,0x11,"lastCompletedTransaction: ID=%d dirtyBits=0x%llx options=0x%x\n",
                    *(undefined4 *)(this + 0x314),*(undefined8 *)(this + 0x308),
                    *(undefined4 *)(this + 0x310));
  if (*(long *)(this + 0x248) == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"\tpendingTransaction is NULL\n");
  }
  else {
    (**(code **)(*(long *)this + 0x8b0))(this);
    uVar1 = *(undefined4 *)(*(long *)(this + 0x248) + 0x54);
    uVar8 = (**(code **)(*(long *)this + 0x8b0))(this);
    lVar5 = *(long *)(this + 0x248);
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "\tpendingTransaction ID=%d, isTransactionComplete()=%d, dirtyBits=0x%llx, options=0x%x, errorCode=0x%x, submittedReturn=0x%x\n"
                      ,uVar1,uVar8,*(undefined8 *)(lVar5 + 0x48),*(undefined4 *)(lVar5 + 0x50),
                      *(undefined4 *)(lVar5 + 0x160),*(undefined4 *)(lVar5 + 0x58));
  }
  if (*(int *)(this + 0x238) < *(int *)(this + 0x23c)) {
    lVar5 = *(long *)(this + (long)(*(int *)(this + 0x238) % 4) * 0x48 + 0x158);
    (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x180))();
    uVar1 = *(undefined4 *)(lVar5 + 0x54);
    uVar6 = *(undefined8 *)(lVar5 + 0x48);
    uVar2 = *(undefined4 *)(lVar5 + 0x50);
    uVar3 = *(undefined4 *)(lVar5 + 0x160);
    uVar4 = *(undefined4 *)(lVar5 + 0x58);
    cVar9 = (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x180))
                      (*(long **)(*(long *)(this + 0x88) + 0x380),
                       this + (long)(*(int *)(this + 0x238) % 4) * 0x48 + 0x118);
    pcVar10 = "hasn\'t";
    if (cVar9 != '\0') {
      pcVar10 = "is";
    }
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "\treadTransaction ID=%d, dirtyBits=0x%llx, options=0x%x, errorCode=0x%x, submittedReturn=0x%x, event %s finished\n"
                      ,uVar1,uVar6,uVar2,uVar3,uVar4,pcVar10);
  }
  if ((*(byte *)(*(long *)(this + 0x88) + 0xc9f) & 4) != 0) {
    logTransactionTimeoutDiagnosisReport(this + 0x88);
  }
  return;
}



// IOAccelDisplayPipe::waitForStampTimeout(int)

bool __thiscall IOAccelDisplayPipe::waitForStampTimeout(IOAccelDisplayPipe *this,int param_1)

{
  int iVar1;
  undefined8 in_RAX;
  undefined4 uVar2;
  
  uVar2 = (undefined4)((ulong)in_RAX >> 0x20);
  iVar1 = (**(code **)(*(long *)this + 0x930))();
  if (iVar1 == param_1) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: IOAccelDisplayPipe (fbindex=%d) transaction stamp index %d time out\n",
                      *(undefined8 *)(*(long *)(this + 0x88) + 0xc88),*(undefined4 *)(this + 0x284),
                      CONCAT44(uVar2,param_1));
  }
  return iVar1 == param_1;
}



// IOAccelDisplayPipe::transaction_queue_idle_gated()

void __thiscall IOAccelDisplayPipe::transaction_queue_idle_gated(IOAccelDisplayPipe *this)

{
  int iVar1;
  int iVar2;
  
  iVar2 = *(int *)(this + 0x238);
  iVar1 = *(int *)(this + 0x23c);
  while (iVar1 != iVar2) {
    if (*(long *)(this + 0x248) == 0) {
      (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x188))
                (*(long **)(*(long *)(this + 0x88) + 0x380),this + (long)(iVar2 % 4) * 0x48 + 0x118)
      ;
      event_interrupt_gated(this);
      iVar2 = *(int *)(this + 0x238);
      iVar1 = *(int *)(this + 0x23c);
    }
    if (iVar1 == iVar2) break;
    (**(code **)(**(long **)(this + 0xb0) + 0x1e0))(*(long **)(this + 0xb0),this,0);
    iVar2 = *(int *)(this + 0x238);
    iVar1 = *(int *)(this + 0x23c);
  }
  while (*(long *)(this + 0x248) != 0) {
    (**(code **)(**(long **)(this + 0xb0) + 0x1e0))(*(long **)(this + 0xb0),this,0);
  }
  return;
}



// IOAccelDisplayPipe::get_finished_transactions(DisplayTransactionListHead*)

void __thiscall
IOAccelDisplayPipe::get_finished_transactions(IOAccelDisplayPipe *this,undefined8 param_1)

{
  long *plVar1;
  
  plVar1 = *(long **)(this + 0xb0);
  if (plVar1 != (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0004f153. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*plVar1 + 0x1c8))(plVar1,get_finished_transactions_gated,param_1,0,0,0);
    return;
  }
  return;
}



// IOAccelDisplayPipe::set_current_plane_resources(IOAccelEvent*, unsigned int, IOAccelResource2*,
// IOAccelResource2*)

void __thiscall
IOAccelDisplayPipe::set_current_plane_resources
          (IOAccelDisplayPipe *this,undefined8 param_1,uint param_2,long *param_3,long *param_4)

{
  long *plVar1;
  bool bVar2;
  char cVar3;
  long lVar4;
  bool bVar5;
  long lVar6;
  
  lVar6 = *(long *)(this + 0x240);
  lVar4 = (ulong)param_2 * 0x70;
  if ((*(long **)(lVar6 + 0x30 + lVar4) != param_3) || (*(long **)(lVar6 + 0x38 + lVar4) != param_4)
     ) {
    if ((*(long *)(lVar6 + 0x10 + lVar4) == 0) && (*(long *)(lVar6 + lVar4 + 0x18) == 0)) {
      lVar6 = 0;
      bVar2 = true;
      do {
        bVar5 = bVar2;
        plVar1 = *(long **)(*(long *)(this + 0x240) + lVar4 + 0x30 + lVar6 * 8);
        if (plVar1 != (long *)0x0) {
          (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x88) + 0x380),param_1,
                     (ulong)*(byte *)((long)plVar1 + 0x15) * 0x40 + plVar1[7]);
          (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x88) + 0x380),param_1,plVar1[8] + 0x38);
          (**(code **)(*plVar1 + 0x178))(plVar1);
          (**(code **)(*plVar1 + 0x28))(plVar1);
          *(undefined8 *)(*(long *)(this + 0x240) + lVar4 + 0x30 + lVar6 * 8) = 0;
        }
        lVar6 = 1;
        bVar2 = false;
      } while (bVar5);
    }
    else {
      lVar6 = 0;
      bVar2 = true;
      do {
        bVar5 = bVar2;
        if (*(long *)(*(long *)(this + 0x240) + lVar4 + 0x10 + lVar6 * 8) != 0) {
          plVar1 = *(long **)(*(long *)(this + 0x240) + lVar4 + 0x30 + lVar6 * 8);
          (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x88) + 0x380),param_1,
                     (ulong)*(byte *)((long)plVar1 + 0x15) * 0x40 + plVar1[7]);
          (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x1b8))
                    (*(long **)(*(long *)(this + 0x88) + 0x380),param_1,plVar1[8] + 0x38);
          (**(code **)(*plVar1 + 0x178))(plVar1);
          (**(code **)(*plVar1 + 0x28))(plVar1);
          *(undefined8 *)(*(long *)(this + 0x240) + lVar4 + 0x30 + lVar6 * 8) = 0;
          (**(code **)(**(long **)(*(long *)(this + 0x240) + lVar4 + 0x20 + lVar6 * 8) + 0x28))();
          (**(code **)(**(long **)(*(long *)(this + 0x240) + lVar4 + 0x10 + lVar6 * 8) + 0x28))();
          *(undefined8 *)(*(long *)(this + 0x240) + lVar4 + 0x20 + lVar6 * 8) = 0;
          *(undefined8 *)(*(long *)(this + 0x240) + lVar4 + 0x10 + lVar6 * 8) = 0;
        }
        lVar6 = 1;
        bVar2 = false;
      } while (bVar5);
    }
    if ((param_3 != (long *)0x0) &&
       (cVar3 = (**(code **)(*param_3 + 0x170))(param_3), cVar3 != '\0')) {
      *(long **)(*(long *)(this + 0x240) + 0x30 + lVar4) = param_3;
      (**(code **)(**(long **)(*(long *)(this + 0x240) + 0x30 + lVar4) + 0x20))();
    }
    if ((param_4 != (long *)0x0) &&
       (cVar3 = (**(code **)(*param_4 + 0x170))(param_4), cVar3 != '\0')) {
      *(long **)(*(long *)(this + 0x240) + 0x38 + lVar4) = param_4;
                    // WARNING: Could not recover jumptable at 0x0004f327. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(**(long **)(*(long *)(this + 0x240) + 0x38 + lVar4) + 0x20))();
      return;
    }
  }
  return;
}



// IOAccelDisplayPipe::release_live_transaction_gated()

void __thiscall IOAccelDisplayPipe::release_live_transaction_gated(IOAccelDisplayPipe *this)

{
  long lVar1;
  long *plVar2;
  
  lVar1 = *(long *)(this + 0x250);
  if (lVar1 != 0) {
    *(undefined8 *)(lVar1 + 0x10) = 0;
    plVar2 = *(long **)(this + 0x110);
    *(long **)(lVar1 + 0x18) = plVar2;
    *plVar2 = lVar1;
    *(long *)(this + 0x110) = *(long *)(this + 0x250) + 0x10;
    *(undefined8 *)(this + 0x250) = 0;
  }
  return;
}



// IOAccelDisplayPipe::get_finished_transactions_gated(DisplayTransactionListHead*)

void __thiscall
IOAccelDisplayPipe::get_finished_transactions_gated(IOAccelDisplayPipe *this,long param_1)

{
  if (*(long *)(this + 0x108) != 0) {
    **(long **)(param_1 + 8) = *(long *)(this + 0x108);
    *(undefined8 *)(*(long *)(this + 0x108) + 0x18) = *(undefined8 *)(param_1 + 8);
    *(undefined8 *)(param_1 + 8) = *(undefined8 *)(this + 0x110);
    *(undefined8 *)(this + 0x108) = 0;
    *(IOAccelDisplayPipe **)(this + 0x110) = this + 0x108;
  }
  return;
}



// IOAccelDisplayPipe::validateTransaction(IOAccelDisplayPipeTransaction2*)

undefined8 IOAccelDisplayPipe::validateTransaction(void)

{
  return 0;
}



// IOAccelDisplayPipe::performTransaction(IOAccelDisplayPipeTransaction2*)

undefined8 IOAccelDisplayPipe::performTransaction(void)

{
  return 0xe00002c7;
}



// IOAccelDisplayPipe::isTransactionComplete(IOAccelDisplayPipeTransaction2*)

undefined4 __thiscall
IOAccelDisplayPipe::isTransactionComplete(IOAccelDisplayPipe *this,long param_1)

{
  int iVar1;
  undefined3 uVar2;
  undefined4 uVar3;
  
  iVar1 = *(int *)(param_1 + 0x54);
  uVar2 = (undefined3)((uint)iVar1 >> 8);
  if (*(long *)(this + 0x248) == 0) {
    if (*(long *)(this + 0x250) == 0) {
      uVar3 = 0;
    }
    else {
      uVar3 = CONCAT31(uVar2,iVar1 <= *(int *)(*(long *)(this + 0x250) + 0x54));
    }
  }
  else {
    uVar3 = CONCAT31(uVar2,iVar1 < *(int *)(*(long *)(this + 0x248) + 0x54));
  }
  return uVar3;
}



// IOAccelDisplayPipe::request_notify_gated(unsigned long long*,
// IOAccelDisplayPipeRequestNotifyGatedArgs*)

undefined8 __thiscall
IOAccelDisplayPipe::request_notify_gated
          (IOAccelDisplayPipe *this,undefined8 param_1,undefined8 *param_2)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  long *plVar3;
  char cVar4;
  undefined8 uVar5;
  IOAccelBlockFencePort2 *this_00;
  
  puVar1 = (undefined8 *)*param_2;
  uVar5 = 0xe00002d5;
  if (puVar1[2] == 0) {
    puVar2 = (undefined8 *)param_2[1];
    this_00 = IOAccelBlockFencePort2::operator_new
                        ((IOAccelBlockFencePort2 *)&segment_command_00000020.filesize);
    IOAccelBlockFencePort2::IOAccelBlockFencePort2(this_00);
    puVar1[2] = this_00;
    if (this_00 != (IOAccelBlockFencePort2 *)0x0) {
      cVar4 = (**(code **)(*(long *)this_00 + 0x118))(this_00,param_1);
      if (cVar4 != '\0') {
        if (*(int *)(puVar1 + 8) == 0) {
          puVar1[5] = puVar2[1];
          puVar1[6] = *puVar2;
          *puVar1 = 0;
          puVar2 = *(undefined8 **)(this + 0x260);
          puVar1[1] = puVar2;
          *puVar2 = puVar1;
          *(undefined8 **)(this + 0x260) = puVar1;
          if (*(int *)(this + 0x2a0) == 0) {
            *(undefined4 *)(this + 0x2a0) = 1;
            (**(code **)(*(long *)this + 0x878))(this);
          }
        }
        else {
          puVar1[5] = 0;
          puVar1[6] = 0;
        }
        plVar3 = (long *)puVar1[2];
        *(long **)(this + 0x2c0) = plVar3;
        (**(code **)(*plVar3 + 0x20))();
        return 0;
      }
      if ((long *)puVar1[2] != (long *)0x0) {
        (**(code **)(*(long *)puVar1[2] + 0x28))();
      }
    }
    puVar1[2] = 0;
    uVar5 = 0xe00002bd;
  }
  return uVar5;
}



// IOAccelDisplayPipe::request_notify(unsigned long long*,
// IOAccelDisplayPipeRequestNotifyGatedArgs*)

void __thiscall
IOAccelDisplayPipe::request_notify(IOAccelDisplayPipe *this,undefined8 param_1,undefined8 param_2)

{
  long *plVar1;
  
  plVar1 = *(long **)(this + 0xb0);
  if (plVar1 == (long *)0x0) {
    setup_workloop(this);
    plVar1 = *(long **)(this + 0xb0);
  }
                    // WARNING: Could not recover jumptable at 0x0004f619. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*plVar1 + 0x1c8))(plVar1,request_notify_gated,param_1,param_2,0,0);
  return;
}



// IOAccelDisplayPipe::remove_notify_gated(IOAccelDisplayPipeNotifyRequest*)

undefined8 __thiscall
IOAccelDisplayPipe::remove_notify_gated(IOAccelDisplayPipe *this,long *param_1)

{
  long lVar1;
  long *plVar2;
  char *pcVar3;
  
  plVar2 = (long *)param_1[2];
  if (plVar2 == (long *)0x0) goto LAB_0004f67e;
  if ((int)param_1[8] == 0) {
    lVar1 = *param_1;
    if (lVar1 == 0) {
      plVar2 = (long *)param_1[1];
      if ((long *)*plVar2 != param_1) {
LAB_0004f6a2:
        pcVar3 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_0004f6b2:
                    // WARNING: Subroutine does not return
        _panic(pcVar3,param_1,0x88b,"IOAccelDisplayPipe.cpp",0x88b);
      }
      *(long **)(this + 0x260) = plVar2;
    }
    else {
      if (*(long **)(lVar1 + 8) != param_1) {
        pcVar3 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
        goto LAB_0004f6b2;
      }
      if (*(long **)param_1[1] != param_1) goto LAB_0004f6a2;
      *(long **)(lVar1 + 8) = (long *)param_1[1];
      plVar2 = (long *)param_1[1];
    }
    *plVar2 = lVar1;
    plVar2 = (long *)param_1[2];
  }
  (**(code **)(*plVar2 + 0x28))();
  param_1[2] = 0;
LAB_0004f67e:
  if (*(long **)(this + 0x2c0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x2c0) + 0x28))();
  }
  *(undefined8 *)(this + 0x2c0) = 0;
  return 0;
}



// IOAccelDisplayPipe::remove_notify(IOAccelDisplayPipeNotifyRequest*)

void __thiscall IOAccelDisplayPipe::remove_notify(IOAccelDisplayPipe *this,undefined8 param_1)

{
  long *plVar1;
  
  plVar1 = *(long **)(this + 0xb0);
  if (plVar1 == (long *)0x0) {
    setup_workloop(this);
    plVar1 = *(long **)(this + 0xb0);
  }
                    // WARNING: Could not recover jumptable at 0x0004f716. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*plVar1 + 0x1c8))(plVar1,remove_notify_gated,param_1,0,0,0);
  return;
}



// IOAccelDisplayPipe::getCurrentPlaneIOSurface(unsigned int, unsigned int) const

undefined8 __thiscall
IOAccelDisplayPipe::getCurrentPlaneIOSurface(IOAccelDisplayPipe *this,uint param_1,uint param_2)

{
  return *(undefined8 *)
          ((ulong)param_1 * 0x70 + *(long *)(this + 0x240) + 0x20 + (ulong)param_2 * 8);
}



// IOAccelDisplayPipe::getCurrentPlaneIOSurfaceDeviceCache(unsigned int, unsigned int) const

undefined8 __thiscall
IOAccelDisplayPipe::getCurrentPlaneIOSurfaceDeviceCache
          (IOAccelDisplayPipe *this,uint param_1,uint param_2)

{
  return *(undefined8 *)
          ((ulong)param_1 * 0x70 + *(long *)(this + 0x240) + 0x10 + (ulong)param_2 * 8);
}



// IOAccelDisplayPipe::getCurrentPlaneSrcRect(unsigned int) const

undefined1  [16] __thiscall
IOAccelDisplayPipe::getCurrentPlaneSrcRect(IOAccelDisplayPipe *this,uint param_2)

{
  undefined1 auVar1 [16];
  
  auVar1._8_8_ = *(undefined8 *)(*(long *)(this + 0x240) + 0x50 + (ulong)param_2 * 0x70);
  auVar1._0_8_ = *(undefined8 *)(*(long *)(this + 0x240) + 0x48 + (ulong)param_2 * 0x70);
  return auVar1;
}



// IOAccelDisplayPipe::getCurrentPlaneDstRect(unsigned int) const

undefined1  [16] __thiscall
IOAccelDisplayPipe::getCurrentPlaneDstRect(IOAccelDisplayPipe *this,uint param_2)

{
  undefined1 auVar1 [16];
  
  auVar1._8_8_ = *(undefined8 *)(*(long *)(this + 0x240) + 0x60 + (ulong)param_2 * 0x70);
  auVar1._0_8_ = *(undefined8 *)(*(long *)(this + 0x240) + 0x58 + (ulong)param_2 * 0x70);
  return auVar1;
}



// IOAccelDisplayPipe::getCurrentPlaneDirtyRect(unsigned int) const

undefined1  [16] __thiscall
IOAccelDisplayPipe::getCurrentPlaneDirtyRect(IOAccelDisplayPipe *this,uint param_2)

{
  undefined1 auVar1 [16];
  
  auVar1._8_8_ = *(undefined8 *)(*(long *)(this + 0x240) + 0x70 + (ulong)param_2 * 0x70);
  auVar1._0_8_ = *(undefined8 *)(*(long *)(this + 0x240) + 0x68 + (ulong)param_2 * 0x70);
  return auVar1;
}



// IOAccelDisplayPipe::getCurrentPlaneOptions(unsigned int) const

undefined4 __thiscall
IOAccelDisplayPipe::getCurrentPlaneOptions(IOAccelDisplayPipe *this,uint param_1)

{
  return *(undefined4 *)(*(long *)(this + 0x240) + 0x78 + (ulong)param_1 * 0x70);
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipe::getCurrentPipeScalerState() const

undefined8 * __cdecl IOAccelDisplayPipe::getCurrentPipeScalerState(undefined8 *param_1,long param_2)

{
  long lVar1;
  undefined8 uVar2;
  
  lVar1 = *(long *)(param_2 + 0x240);
  param_1[2] = *(undefined8 *)(lVar1 + 0x100);
  uVar2 = *(undefined8 *)(lVar1 + 0xf0);
  param_1[1] = *(undefined8 *)(lVar1 + 0xf8);
  *param_1 = uVar2;
  return param_1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipe::getCurrentPipeColorMatrix() const

undefined8 * __cdecl IOAccelDisplayPipe::getCurrentPipeColorMatrix(undefined8 *param_1,long param_2)

{
  long lVar1;
  undefined8 uVar2;
  
  lVar1 = *(long *)(param_2 + 0x240);
  param_1[5] = *(undefined8 *)(lVar1 + 0x130);
  param_1[4] = *(undefined8 *)(lVar1 + 0x128);
  param_1[3] = *(undefined8 *)(lVar1 + 0x120);
  param_1[2] = *(undefined8 *)(lVar1 + 0x118);
  uVar2 = *(undefined8 *)(lVar1 + 0x108);
  param_1[1] = *(undefined8 *)(lVar1 + 0x110);
  *param_1 = uVar2;
  return param_1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipe::getCurrentPipeColorMatrixArgs() const

undefined8 * __cdecl
IOAccelDisplayPipe::getCurrentPipeColorMatrixArgs(undefined8 *param_1,long param_2)

{
  long lVar1;
  undefined8 uVar2;
  
  lVar1 = *(long *)(param_2 + 0x240);
  param_1[2] = *(undefined8 *)(lVar1 + 0x148);
  uVar2 = *(undefined8 *)(lVar1 + 0x138);
  param_1[1] = *(undefined8 *)(lVar1 + 0x140);
  *param_1 = uVar2;
  return param_1;
}



// IOAccelDisplayPipe::getCurrentPipeRotationArgs() const

undefined8 __thiscall IOAccelDisplayPipe::getCurrentPipeRotationArgs(IOAccelDisplayPipe *this)

{
  return *(undefined8 *)(*(long *)(this + 0x240) + 0x150);
}



// IOAccelDisplayPipe::getCurrentPlaneGammaTable(unsigned int) const

undefined8 __thiscall
IOAccelDisplayPipe::getCurrentPlaneGammaTable(IOAccelDisplayPipe *this,uint param_1)

{
  return *(undefined8 *)(*(long *)(this + 0x240) + 0x40 + (ulong)param_1 * 0x70);
}



// IOAccelDisplayPipe::getCurrentPipePreGammaTable() const

undefined8 __thiscall IOAccelDisplayPipe::getCurrentPipePreGammaTable(IOAccelDisplayPipe *this)

{
  return **(undefined8 **)(this + 0x240);
}



// IOAccelDisplayPipe::getCurrentPipePostGammaTable() const

undefined8 __thiscall IOAccelDisplayPipe::getCurrentPipePostGammaTable(IOAccelDisplayPipe *this)

{
  return *(undefined8 *)(*(long *)(this + 0x240) + 8);
}



// IOAccelDisplayPipe::getCurrentPipePreCSCLinearizationVID() const

undefined8 __thiscall
IOAccelDisplayPipe::getCurrentPipePreCSCLinearizationVID(IOAccelDisplayPipe *this)

{
  return *(undefined8 *)(*(long *)(this + 0x240) + 0x158);
}



// IOAccelDisplayPipe::getCurrentPipePostCSCGammaVID() const

undefined8 __thiscall IOAccelDisplayPipe::getCurrentPipePostCSCGammaVID(IOAccelDisplayPipe *this)

{
  return *(undefined8 *)(*(long *)(this + 0x240) + 0x160);
}



// IOAccelDisplayPipe::set_current_plane_ioSurfaceDeviceCache(IOAccelEvent*, unsigned int, unsigned
// int, IOSurfaceDeviceCache*)

void __thiscall
IOAccelDisplayPipe::set_current_plane_ioSurfaceDeviceCache
          (IOAccelDisplayPipe *this,undefined8 param_1,ulong param_2,ulong param_4_00,long param_4)

{
  long lVar1;
  long *plVar2;
  char cVar3;
  undefined8 *puVar4;
  long lVar5;
  ulong uVar6;
  long lVar7;
  
  lVar1 = *(long *)(this + 0x240);
  if (param_4 == 0) {
    lVar5 = *(long *)((param_2 & 0xffffffff) * 0x70 + lVar1 + 0x10 + (param_4_00 & 0xffffffff) * 8);
  }
  else {
    lVar5 = *(long *)((param_2 & 0xffffffff) * 0x70 + lVar1 + 0x10 + (param_4_00 & 0xffffffff) * 8);
    if (lVar5 == param_4) {
      return;
    }
  }
  uVar6 = param_4_00 & 0xffffffff;
  lVar7 = (param_2 & 0xffffffff) * 0x70;
  plVar2 = *(long **)(lVar1 + lVar7 + 0x30 + uVar6 * 8);
  if (lVar5 == 0) {
    if (plVar2 == (long *)0x0) goto LAB_0004faa0;
    (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x1b8))
              (*(long **)(*(long *)(this + 0x88) + 0x380),param_1,
               (ulong)*(byte *)((long)plVar2 + 0x15) * 0x40 + plVar2[7]);
    (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x1b8))
              (*(long **)(*(long *)(this + 0x88) + 0x380),param_1,plVar2[8] + 0x38);
    (**(code **)(*plVar2 + 0x178))(plVar2);
    (**(code **)(*plVar2 + 0x28))(plVar2);
    puVar4 = (undefined8 *)(*(long *)(this + 0x240) + lVar7 + uVar6 * 8 + 0x30);
  }
  else {
    *(undefined8 *)(lVar1 + lVar7 + uVar6 * 8 + 0x30) = 0;
    (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x1b8))
              (*(long **)(*(long *)(this + 0x88) + 0x380),param_1,
               (ulong)*(byte *)((long)plVar2 + 0x15) * 0x40 + plVar2[7]);
    (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x1b8))
              (*(long **)(*(long *)(this + 0x88) + 0x380),param_1,plVar2[8] + 0x38);
    (**(code **)(*plVar2 + 0x178))(plVar2);
    (**(code **)(*plVar2 + 0x28))(plVar2);
    (**(code **)(**(long **)(*(long *)(this + 0x240) + lVar7 + 0x20 + uVar6 * 8) + 0x28))();
    (**(code **)(**(long **)(*(long *)(this + 0x240) + lVar7 + 0x10 + uVar6 * 8) + 0x28))();
    *(undefined8 *)(*(long *)(this + 0x240) + lVar7 + 0x20 + uVar6 * 8) = 0;
    puVar4 = (undefined8 *)(*(long *)(this + 0x240) + lVar7 + uVar6 * 8 + 0x10);
  }
  *puVar4 = 0;
LAB_0004faa0:
  if ((param_4 != 0) &&
     (cVar3 = (**(code **)(**(long **)(param_4 + 0x20) + 0x170))(), cVar3 != '\0')) {
    *(long *)(*(long *)(this + 0x240) + lVar7 + 0x10 + uVar6 * 8) = param_4;
    *(undefined8 *)(*(long *)(this + 0x240) + lVar7 + 0x20 + uVar6 * 8) =
         *(undefined8 *)(param_4 + 0x10);
    *(undefined8 *)(*(long *)(this + 0x240) + lVar7 + 0x30 + uVar6 * 8) =
         *(undefined8 *)(param_4 + 0x20);
    (**(code **)(**(long **)(*(long *)(this + 0x240) + lVar7 + 0x10 + uVar6 * 8) + 0x20))();
    (**(code **)(**(long **)(*(long *)(this + 0x240) + lVar7 + 0x20 + uVar6 * 8) + 0x20))();
                    // WARNING: Could not recover jumptable at 0x0004fb36. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(long **)(lVar7 + *(long *)(this + 0x240) + 0x30 + uVar6 * 8) + 0x20))();
    return;
  }
  return;
}



// WARNING: Unknown calling convention: __cdecl
// IOAccelDisplayPipe::set_current_plane_data(unsigned int, unsigned int, IOAccelDisplayRect,
// IOAccelDisplayRect, IOAccelDisplayRect)

void __cdecl
IOAccelDisplayPipe::set_current_plane_data
          (undefined8 param_1,undefined8 param_2_00,undefined8 param_3,undefined8 param_4,
          undefined8 param_5,undefined8 param_6,long param_7,uint param_8,undefined4 param_9)

{
  long lVar1;
  long lVar2;
  
  lVar1 = *(long *)(param_7 + 0x240);
  lVar2 = (ulong)param_8 * 0x70;
  *(undefined4 *)(lVar1 + 0x78 + lVar2) = param_9;
  *(undefined8 *)(lVar1 + 0x48 + lVar2) = param_1;
  *(undefined8 *)(lVar1 + 0x50 + lVar2) = param_2_00;
  lVar1 = *(long *)(param_7 + 0x240);
  *(undefined8 *)(lVar1 + 0x58 + lVar2) = param_3;
  *(undefined8 *)(lVar1 + 0x60 + lVar2) = param_4;
  lVar1 = *(long *)(param_7 + 0x240);
  *(undefined8 *)(lVar1 + 0x68 + lVar2) = param_5;
  *(undefined8 *)(lVar1 + 0x70 + lVar2) = param_6;
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipe::set_current_pipe_scaler_state(IOAccelDisplayPipeScaler)

void __cdecl IOAccelDisplayPipe::set_current_pipe_scaler_state(long param_1)

{
  long lVar1;
  undefined8 in_stack_00000008;
  undefined8 in_stack_00000010;
  undefined8 in_stack_00000018;
  
  lVar1 = *(long *)(param_1 + 0x240);
  *(undefined8 *)(lVar1 + 0x100) = in_stack_00000018;
  *(undefined8 *)(lVar1 + 0xf8) = in_stack_00000010;
  *(undefined8 *)(lVar1 + 0xf0) = in_stack_00000008;
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipe::set_current_pipe_color_matrix(IOAccelDisplayPipeColorMatrix)

void __cdecl IOAccelDisplayPipe::set_current_pipe_color_matrix(long param_1)

{
  long lVar1;
  undefined8 in_stack_00000008;
  undefined8 in_stack_00000010;
  undefined8 in_stack_00000018;
  undefined8 in_stack_00000020;
  undefined8 in_stack_00000028;
  undefined8 in_stack_00000030;
  
  lVar1 = *(long *)(param_1 + 0x240);
  *(undefined8 *)(lVar1 + 0x130) = in_stack_00000030;
  *(undefined8 *)(lVar1 + 0x128) = in_stack_00000028;
  *(undefined8 *)(lVar1 + 0x120) = in_stack_00000020;
  *(undefined8 *)(lVar1 + 0x118) = in_stack_00000018;
  *(undefined8 *)(lVar1 + 0x110) = in_stack_00000010;
  *(undefined8 *)(lVar1 + 0x108) = in_stack_00000008;
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipe::set_current_pipe_color_matrix_args(IOAccelDisplayPipeColorMatrixArgs)

void __cdecl IOAccelDisplayPipe::set_current_pipe_color_matrix_args(long param_1)

{
  long lVar1;
  undefined8 in_stack_00000008;
  undefined8 in_stack_00000010;
  undefined8 in_stack_00000018;
  
  lVar1 = *(long *)(param_1 + 0x240);
  *(undefined8 *)(lVar1 + 0x148) = in_stack_00000018;
  *(undefined8 *)(lVar1 + 0x140) = in_stack_00000010;
  *(undefined8 *)(lVar1 + 0x138) = in_stack_00000008;
  return;
}



// IOAccelDisplayPipe::set_current_pipe_rotation_args(IOAccelDisplayPipeRotationArgs)

void __thiscall
IOAccelDisplayPipe::set_current_pipe_rotation_args(IOAccelDisplayPipe *this,undefined8 param_1)

{
  *(undefined8 *)(*(long *)(this + 0x240) + 0x150) = param_1;
  return;
}



// IOAccelDisplayPipe::set_user_client(IOAccelDisplayPipeUserClient2*)

void __thiscall IOAccelDisplayPipe::set_user_client(IOAccelDisplayPipe *this,undefined8 param_1)

{
  *(undefined8 *)(this + 0xe8) = param_1;
  return;
}



// IOAccelDisplayPipe::user_client_terminated(IOAccelDisplayPipeUserClient2*)

void __thiscall IOAccelDisplayPipe::user_client_terminated(IOAccelDisplayPipe *this,long param_1)

{
  long *plVar1;
  long *plVar2;
  long *plVar3;
  char *pcVar4;
  
  plVar1 = *(long **)(this + 0xf8);
  do {
    do {
      plVar2 = plVar1;
      if (plVar2 == (long *)0x0) {
        return;
      }
      plVar1 = (long *)plVar2[2];
    } while (plVar2[6] != param_1);
    if (plVar1 == (long *)0x0) {
      plVar3 = (long *)plVar2[3];
      if ((long *)*plVar3 != plVar2) {
LAB_0004fcd1:
        pcVar4 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
LAB_0004fce1:
                    // WARNING: Subroutine does not return
        _panic(pcVar4,plVar2,0x9f2,"IOAccelDisplayPipe.cpp",0x9f2);
      }
      *(long **)(this + 0x100) = plVar3;
    }
    else {
      if ((long *)plVar1[3] != plVar2 + 2) {
        pcVar4 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
        goto LAB_0004fce1;
      }
      if (*(long **)plVar2[3] != plVar2) goto LAB_0004fcd1;
      plVar1[3] = (long)plVar2[3];
      plVar3 = (long *)plVar2[3];
    }
    *plVar3 = (long)plVar1;
    (**(code **)(*plVar2 + 0x28))(plVar2);
  } while( true );
}



// IOAccelDisplayPipe::get_user_client() const

undefined8 __thiscall IOAccelDisplayPipe::get_user_client(IOAccelDisplayPipe *this)

{
  return *(undefined8 *)(this + 0xe8);
}



// IOAccelDisplayPipe::system_will_sleep()

void __thiscall IOAccelDisplayPipe::system_will_sleep(IOAccelDisplayPipe *this)

{
  finishTransactionQueue(this);
  releaseLiveTransaction(this);
  if (*(long **)(this + 0xf0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xf0) + 0x178))();
    (**(code **)(**(long **)(this + 0xf0) + 0x28))();
    *(undefined8 *)(this + 0xf0) = 0;
  }
  return;
}



// IOAccelDisplayPipe::getStampIndex() const

undefined8 IOAccelDisplayPipe::getStampIndex(void)

{
  return 0xffffffff;
}



// IOAccelDisplayPipe::copySurface(unsigned int, unsigned int)

undefined8 __thiscall
IOAccelDisplayPipe::copySurface(IOAccelDisplayPipe *this,task *param_2_00,uint param_2)

{
  long *plVar1;
  long *plVar2;
  long *plVar3;
  long *plVar4;
  long *plVar5;
  undefined8 uVar6;
  long *local_38;
  
  if ((int)param_2_00 == 0) {
    plVar5 = *(long **)(this + 0xe0);
    if (plVar5 == (long *)0x0) {
      return 0xe0078010;
    }
    if (this[0x298] == (IOAccelDisplayPipe)0x0) {
      return 0xe0078010;
    }
    plVar1 = (long *)0x0;
    local_38 = (long *)0x0;
LAB_0004fe11:
    if (param_2 == 0) {
      plVar4 = *(long **)(this + 0xe0);
      if (plVar4 == (long *)0x0) {
        return 0xe0078010;
      }
      if (this[0x298] == (IOAccelDisplayPipe)0x0) {
        return 0xe0078010;
      }
      plVar2 = (long *)0x0;
      plVar3 = (long *)0x0;
LAB_0004febc:
      if (plVar5 == plVar4) {
        uVar6 = 0;
      }
      else {
        uVar6 = 0;
        (**(code **)(**(long **)(this + 0x88) + 0x9a8))(*(long **)(this + 0x88),0);
        (**(code **)(*plVar4 + 0x168))(plVar4,0,0);
      }
    }
    else {
      plVar2 = (long *)IOSurfaceRoot::lookupSurface
                                 ((uint)*(undefined8 *)(*(long *)(this + 0x88) + 0x170),
                                  (task *)(ulong)param_2);
      if (plVar2 == (long *)0x0) {
        uVar6 = 0xe0078011;
        plVar2 = (long *)0x0;
      }
      else {
        plVar3 = IOGraphicsAccelerator2::deviceCacheForIOSurface
                           (*(IOGraphicsAccelerator2 **)(this + 0x88),plVar2);
        if (plVar3 != (long *)0x0) {
          plVar4 = (long *)plVar3[4];
          if (plVar4 != (long *)0x0) goto LAB_0004febc;
          uVar6 = 0xe00002c9;
          goto LAB_0004ff0c;
        }
        uVar6 = 0xe0078012;
      }
      plVar3 = (long *)0x0;
    }
LAB_0004ff0c:
    if (plVar1 == (long *)0x0) goto LAB_0004ff1e;
  }
  else {
    plVar1 = (long *)IOSurfaceRoot::lookupSurface
                               ((uint)*(undefined8 *)(*(long *)(this + 0x88) + 0x170),param_2_00);
    if (plVar1 == (long *)0x0) {
      return 0xe0078011;
    }
    plVar3 = (long *)0x0;
    local_38 = IOGraphicsAccelerator2::deviceCacheForIOSurface
                         (*(IOGraphicsAccelerator2 **)(this + 0x88),plVar1);
    if (local_38 == (long *)0x0) {
      uVar6 = 0xe0078012;
      local_38 = (long *)0x0;
      plVar2 = (long *)0x0;
    }
    else {
      plVar5 = (long *)local_38[4];
      if (plVar5 != (long *)0x0) goto LAB_0004fe11;
      uVar6 = 0xe00002c9;
      plVar3 = (long *)0x0;
      plVar2 = (long *)0x0;
    }
  }
  (**(code **)(*plVar1 + 0x28))(plVar1);
LAB_0004ff1e:
  if (plVar2 != (long *)0x0) {
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  if (local_38 != (long *)0x0) {
    (**(code **)(*local_38 + 0x28))(local_38);
  }
  if (plVar3 != (long *)0x0) {
    (**(code **)(*plVar3 + 0x28))(plVar3);
  }
  return uVar6;
}



// IOAccelDisplayPipeTransaction2::sendNotification()

undefined4 __thiscall
IOAccelDisplayPipeTransaction2::sendNotification(IOAccelDisplayPipeTransaction2 *this)

{
  undefined4 uVar1;
  
  *(undefined4 *)(this + 0x164) = *(undefined4 *)(this + 0x54);
  uVar1 = IOAccelDisplayPipeUserClient2::sendAsyncResult64
                    ((ulonglong *)(*(long *)(this + 0x150) + 0x10),0,(ulonglong *)(this + 0x158),0xb
                    );
  *(undefined8 *)(this + 0x158) = 0;
  (**(code **)(**(long **)(this + 0x150) + 0x28))();
  *(undefined8 *)(this + 0x150) = 0;
  return uVar1;
}



// IOAccelDisplayPipe::reportVRRStampInfo(IOAccelDisplayPipeVRRTimeStampInfo*)

void __thiscall IOAccelDisplayPipe::reportVRRStampInfo(IOAccelDisplayPipe *this,undefined8 *param_1)

{
  undefined8 *puVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  long *plVar6;
  uintptr_t arg1;
  
  if (param_1 != (undefined8 *)0x0) {
    puVar1 = *(undefined8 **)(this + 0x2b8);
    uVar2 = *param_1;
    uVar3 = param_1[1];
    uVar4 = param_1[2];
    uVar5 = param_1[3];
    puVar1[4] = param_1[4];
    puVar1[3] = uVar5;
    puVar1[2] = uVar4;
    puVar1[1] = uVar3;
    *puVar1 = uVar2;
    plVar6 = *(long **)(this + 0x2c8);
    if (plVar6 != (long *)0x0) {
      (**(code **)(*plVar6 + 0x1d8))(plVar6,0,0);
    }
    if ((___ktrace_kernel_enabled != 0) && (___ktrace_display_enabled != 0)) {
      arg1 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x8520005c,arg1,(ulong)*(uint *)(this + 0x284),0,0,0);
      return;
    }
  }
  return;
}



// IOAccelDisplayPipe::triage(char**, unsigned long long*)

void __thiscall
IOAccelDisplayPipe::triage
          (undefined8 param_1_00,undefined8 param_2_00,undefined8 param_3,undefined8 param_4,
          undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8,
          IOAccelDisplayPipe *this,long *param_10,size_t *param_11,long param_12,ulong param_13,
          undefined8 param_14)

{
  int iVar1;
  uint64_t uVar2;
  undefined8 uVar3;
  undefined8 uVar4;
  ulong uVar5;
  ulong uVar6;
  undefined8 uVar7;
  char *pcVar8;
  char *pcVar9;
  ulong uVar10;
  char *pcVar11;
  IOAccelDisplayPipe *pIVar12;
  char *pcVar13;
  long lVar14;
  char *pcVar15;
  bool bVar16;
  undefined8 extraout_XMM0_Qa;
  undefined8 extraout_XMM0_Qa_00;
  undefined8 extraout_XMM0_Qa_01;
  undefined8 extraout_XMM0_Qa_02;
  undefined8 extraout_XMM0_Qa_03;
  undefined8 extraout_XMM0_Qa_04;
  ulong local_48;
  ulong local_40;
  IOAccelDisplayPipe *local_38;
  
  iVar1 = (**(code **)(**(long **)(this + 0x88) + 0xab8))();
  if (iVar1 == 0) {
    uVar2 = _mach_absolute_time();
    local_48 = 0;
    uVar3 = extraout_XMM0_Qa;
    local_38 = this;
    if (*(long *)(this + 0x2b0) != 0) {
      uVar3 = glkBfLog(extraout_XMM0_Qa,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,
                       param_10,param_11,"Events Timing:\n",param_12,param_13,param_14);
      if ((int)uVar3 != 0) {
        return;
      }
      lVar14 = 0;
      do {
        uVar3 = _absolutetime_to_nanoseconds
                          (uVar2 - *(long *)(*(long *)(local_38 + 0x2b0) + lVar14 * 2),&local_48);
        param_12 = (long)&_reltable__ZN18IOAccelDisplayPipe6triageEPPcPy +
                   (long)*(int *)((long)&_reltable__ZN18IOAccelDisplayPipe6triageEPPcPy + lVar14);
        param_13 = local_48 / 1000000;
        uVar3 = glkBfLog(uVar3,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,param_10,
                         param_11,"    %s:\t %llu ms ago\n",param_12,param_13,param_14);
        if ((int)uVar3 != 0) {
          return;
        }
        lVar14 = lVar14 + 4;
        uVar3 = extraout_XMM0_Qa_00;
      } while (lVar14 != 0x18);
    }
    uVar3 = glkBfLog(uVar3,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,param_10,
                     param_11,"Queue state:\n",param_12,param_13,param_14);
    if ((int)uVar3 == 0) {
      pIVar12 = local_38 + 0x118;
      bVar16 = true;
      uVar10 = 0;
      uVar3 = extraout_XMM0_Qa_01;
      do {
        local_40 = CONCAT71(local_40._1_7_,bVar16);
        uVar6 = 0x72;
        if ((uVar10 != (uint)(*(int *)(local_38 + 0x238) % 4)) &&
           (uVar6 = 0x20, uVar10 == (uint)(*(int *)(local_38 + 0x23c) % 4))) {
          uVar6 = 0x77;
        }
        if (*(long *)(local_38 + uVar10 * 0x48 + 0x158) == *(long *)(local_38 + 0x248)) {
          uVar7 = 0x50;
        }
        else {
          uVar7 = 0x20;
          if (*(long *)(local_38 + uVar10 * 0x48 + 0x158) == *(long *)(local_38 + 0x250)) {
            uVar7 = 0x4c;
          }
        }
        uVar3 = glkBfLog(uVar3,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,param_10,
                         param_11,"    %d %c%c: ",uVar10 & 0xffffffff,uVar6,uVar7);
        if ((int)uVar3 != 0) {
          return;
        }
        lVar14 = 0;
        uVar3 = extraout_XMM0_Qa_02;
        do {
          uVar5 = *(ulong *)(pIVar12 + lVar14 * 8);
          if ((int)uVar5 != -1) {
            uVar6 = uVar5 >> 0x20;
            uVar4 = glkBfLog(uVar3,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,
                             param_10,param_11,"ch [0x%03x] stamp [0x%03x]; ",uVar5,uVar6,uVar7);
            uVar3 = extraout_XMM0_Qa_03;
            if ((int)uVar4 != 0) goto LAB_00050278;
          }
          lVar14 = lVar14 + 1;
        } while (lVar14 != 8);
        uVar7 = glkBfLog(uVar3,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,param_10,
                         param_11,"\n",uVar5,uVar6,uVar7);
        uVar3 = extraout_XMM0_Qa_04;
        if ((int)uVar7 != 0) {
LAB_00050278:
          if ((local_40 & 1) != 0) {
            return;
          }
          break;
        }
        bVar16 = uVar10 < 3;
        uVar10 = uVar10 + 1;
        pIVar12 = pIVar12 + 0x48;
      } while (uVar10 != 4);
      pcVar9 = "Y";
      pcVar8 = "Y";
      if (*(long *)(local_38 + 0x248) == 0) {
        pcVar8 = "N";
      }
      if (*(long *)(local_38 + 0x250) == 0) {
        pcVar9 = "N";
      }
      pcVar11 = "ON";
      pcVar15 = "ON";
      if (*(int *)(local_38 + 0x29c) == 0) {
        pcVar15 = "OFF";
      }
      local_40 = (ulong)*(uint *)(local_38 + 0x288);
      pcVar13 = "ON";
      if (*(int *)(local_38 + 0x2a0) == 0) {
        pcVar13 = "OFF";
      }
      if (*(int *)(local_38 + 0x2a4) == 0) {
        pcVar11 = "OFF";
      }
      glkBfLog(uVar3,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,param_10,param_11,
               "DisplayPipe: TQRC: %d; TQWC: %d; Pending: %s; Live: %s; Next: %d; EvtIR: %s; VBLIR: %s; TransactIR: %s; NTQID-RC: %d-0x%x %d-0x%x %d-0x%x\n"
               ,(ulong)*(uint *)(local_38 + 0x238),(ulong)*(uint *)(local_38 + 0x23c),pcVar8,pcVar9,
               local_40,pcVar15,pcVar13,pcVar11,(ulong)*(uint *)(local_38 + 0x2d8),
               (ulong)*(uint *)(local_38 + 0x2dc),(ulong)*(uint *)(local_38 + 0x2e0),
               (ulong)*(uint *)(local_38 + 0x2e4),(ulong)*(uint *)(local_38 + 0x2e8),
               (ulong)*(uint *)(local_38 + 0x2ec));
    }
  }
  return;
}



// IOAccelDisplayPipe::_RESERVEDIOAccelDisplayPipe1()

void IOAccelDisplayPipe::_RESERVEDIOAccelDisplayPipe1(void)

{
  OSMetaClass::reservedCalled(0x826d8);
  return;
}



// IOAccelDisplayPipe::_RESERVEDIOAccelDisplayPipe2()

void IOAccelDisplayPipe::_RESERVEDIOAccelDisplayPipe2(void)

{
  OSMetaClass::reservedCalled(0x826d8);
  return;
}



// IOAccelDisplayPipe::_RESERVEDIOAccelDisplayPipe3()

void IOAccelDisplayPipe::_RESERVEDIOAccelDisplayPipe3(void)

{
  OSMetaClass::reservedCalled(0x826d8);
  return;
}



// IOAccelDisplayPipe::_RESERVEDIOAccelDisplayPipe4()

void IOAccelDisplayPipe::_RESERVEDIOAccelDisplayPipe4(void)

{
  OSMetaClass::reservedCalled(0x826d8);
  return;
}



// IOAccelDisplayPipe::_RESERVEDIOAccelDisplayPipe5()

void IOAccelDisplayPipe::_RESERVEDIOAccelDisplayPipe5(void)

{
  OSMetaClass::reservedCalled(0x826d8);
  return;
}



// IOAccelDisplayPipe::_RESERVEDIOAccelDisplayPipe6()

void IOAccelDisplayPipe::_RESERVEDIOAccelDisplayPipe6(void)

{
  OSMetaClass::reservedCalled(0x826d8);
  return;
}



// IOAccelDisplayPipe::_RESERVEDIOAccelDisplayPipe7()

void IOAccelDisplayPipe::_RESERVEDIOAccelDisplayPipe7(void)

{
  OSMetaClass::reservedCalled(0x826d8);
  return;
}



// IOAccelDisplayPipeTransaction2::MetaClass::MetaClass()

void __thiscall IOAccelDisplayPipeTransaction2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDisplayPipeTransaction2",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x1b8);
  *(undefined ***)this = &PTR__MetaClass_0007f1f8;
  return;
}



// IOAccelDisplayPipeTransaction2::MetaClass::~MetaClass()

void __thiscall IOAccelDisplayPipeTransaction2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelDisplayPipeTransaction2::IOAccelDisplayPipeTransaction2(OSMetaClass const*)

void __thiscall
IOAccelDisplayPipeTransaction2::IOAccelDisplayPipeTransaction2
          (IOAccelDisplayPipeTransaction2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDisplayPipeTransaction2_0007f088;
  return;
}



// IOAccelDisplayPipeTransaction2::IOAccelDisplayPipeTransaction2(OSMetaClass const*)

void __thiscall
IOAccelDisplayPipeTransaction2::IOAccelDisplayPipeTransaction2
          (IOAccelDisplayPipeTransaction2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDisplayPipeTransaction2_0007f088;
  return;
}



// IOAccelDisplayPipeTransaction2::~IOAccelDisplayPipeTransaction2()

void __thiscall
IOAccelDisplayPipeTransaction2::~IOAccelDisplayPipeTransaction2
          (IOAccelDisplayPipeTransaction2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelDisplayPipeTransaction2::~IOAccelDisplayPipeTransaction2()

void __thiscall
IOAccelDisplayPipeTransaction2::~IOAccelDisplayPipeTransaction2
          (IOAccelDisplayPipeTransaction2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelDisplayPipeTransaction2::~IOAccelDisplayPipeTransaction2()

void __thiscall
IOAccelDisplayPipeTransaction2::~IOAccelDisplayPipeTransaction2
          (IOAccelDisplayPipeTransaction2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelDisplayPipeTransaction2_ktv,this,0x1b8);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeTransaction2::operator delete(void*, unsigned long)

void __cdecl IOAccelDisplayPipeTransaction2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelDisplayPipeTransaction2_ktv,param_1,param_2);
  return;
}



// IOAccelDisplayPipeTransaction2::getMetaClass() const

undefined8 * IOAccelDisplayPipeTransaction2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelDisplayPipeTransaction2::MetaClass::MetaClass()

void __thiscall IOAccelDisplayPipeTransaction2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDisplayPipeTransaction2",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x1b8);
  *(undefined ***)this = &PTR__MetaClass_0007f1f8;
  return;
}



// IOAccelDisplayPipeTransaction2::MetaClass::alloc() const

OSObject * IOAccelDisplayPipeTransaction2::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelDisplayPipeTransaction2_ktv,0x1b8);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelDisplayPipeTransaction2::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipeTransaction2_0007f088;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelDisplayPipeTransaction2::operator new(unsigned long)

void * __thiscall IOAccelDisplayPipeTransaction2::operator_new(IOAccelDisplayPipeTransaction2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelDisplayPipeTransaction2_ktv,this);
  return pvVar1;
}



// IOAccelDisplayPipeTransaction2::IOAccelDisplayPipeTransaction2()

void __thiscall
IOAccelDisplayPipeTransaction2::IOAccelDisplayPipeTransaction2(IOAccelDisplayPipeTransaction2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipeTransaction2_0007f088;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDisplayPipeTransaction2::IOAccelDisplayPipeTransaction2()

void __thiscall
IOAccelDisplayPipeTransaction2::IOAccelDisplayPipeTransaction2(IOAccelDisplayPipeTransaction2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipeTransaction2_0007f088;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDisplayPipeTransaction2::free()

void __thiscall IOAccelDisplayPipeTransaction2::free(IOAccelDisplayPipeTransaction2 *this)

{
  undefined8 uVar1;
  bool bVar2;
  long lVar3;
  long *plVar4;
  bool bVar5;
  long lVar6;
  bool bVar7;
  long lVar8;
  long lVar9;
  
  if (*(long *)(this + 0x158) != 0) {
    *(undefined4 *)(this + 0x164) = *(undefined4 *)(this + 0x54);
    IOAccelDisplayPipeUserClient2::sendAsyncResult64
              ((ulonglong *)(*(long *)(this + 0x150) + 0x10),0,(ulonglong *)(this + 0x158),0xb);
    *(undefined8 *)(this + 0x158) = 0;
    (**(code **)(**(long **)(this + 0x150) + 0x28))();
    *(undefined8 *)(this + 0x150) = 0;
  }
  if (*(long *)(this + 0x38) != 0) {
    lVar9 = 0;
    bVar2 = true;
    do {
      bVar5 = bVar2;
      lVar8 = 0;
      bVar2 = true;
      do {
        bVar7 = bVar2;
        lVar3 = *(long *)(this + 0x38);
        lVar6 = lVar9 * 0x70;
        plVar4 = *(long **)(lVar3 + lVar6 + 0x30 + lVar8 * 8);
        if (plVar4 != (long *)0x0) {
          *(undefined8 *)(lVar3 + lVar6 + lVar8 * 8 + 0x30) = 0;
          (**(code **)(*plVar4 + 0x28))();
          lVar3 = *(long *)(this + 0x38);
        }
        plVar4 = *(long **)(lVar3 + lVar6 + 0x20 + lVar8 * 8);
        if (plVar4 != (long *)0x0) {
          (**(code **)(*plVar4 + 0x28))();
          *(undefined8 *)(*(long *)(this + 0x38) + lVar6 + 0x20 + lVar8 * 8) = 0;
          lVar3 = *(long *)(this + 0x38);
        }
        plVar4 = *(long **)(lVar3 + lVar6 + 0x10 + lVar8 * 8);
        if (plVar4 != (long *)0x0) {
          (**(code **)(*plVar4 + 0x28))();
          *(undefined8 *)(*(long *)(this + 0x38) + lVar6 + 0x10 + lVar8 * 8) = 0;
        }
        lVar8 = 1;
        bVar2 = false;
      } while (bVar7);
      plVar4 = *(long **)(this + 0x38);
      if ((long *)plVar4[lVar9 * 0xe + 8] != (long *)0x0) {
        (**(code **)(*(long *)plVar4[lVar9 * 0xe + 8] + 0x28))();
        plVar4 = *(long **)(this + 0x38);
        plVar4[lVar9 * 0xe + 8] = 0;
      }
      lVar9 = 1;
      bVar2 = false;
    } while (bVar5);
    if ((long *)plVar4[0x2b] != (long *)0x0) {
      (**(code **)(*(long *)plVar4[0x2b] + 0x28))();
      plVar4 = *(long **)(this + 0x38);
      plVar4[0x2b] = 0;
    }
    if ((long *)plVar4[0x2c] != (long *)0x0) {
      (**(code **)(*(long *)plVar4[0x2c] + 0x28))();
      plVar4 = *(long **)(this + 0x38);
      plVar4[0x2c] = 0;
    }
    if ((long *)*plVar4 != (long *)0x0) {
      (**(code **)(*(long *)*plVar4 + 0x28))();
      plVar4 = *(long **)(this + 0x38);
      *plVar4 = 0;
    }
    if ((long *)plVar4[1] != (long *)0x0) {
      (**(code **)(*(long *)plVar4[1] + 0x28))();
      *(undefined8 *)(*(long *)(this + 0x38) + 8) = 0;
    }
    uVar1 = *(undefined8 *)(this + 0x38);
    *(undefined8 *)(this + 0x38) = 0;
    _IOFreeTypeImpl(&free()::kalloc_type_view_2914,uVar1);
  }
                    // WARNING: Could not recover jumptable at 0x000507bd. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelDisplayPipeTransaction2::getPlaneResource(unsigned int, unsigned int) const

undefined8 __thiscall
IOAccelDisplayPipeTransaction2::getPlaneResource
          (IOAccelDisplayPipeTransaction2 *this,uint param_1,uint param_2)

{
  return *(undefined8 *)((ulong)param_1 * 0x70 + *(long *)(this + 0x38) + 0x30 + (ulong)param_2 * 8)
  ;
}



// IOAccelDisplayPipeTransaction2::getPlaneSrcRect(unsigned int) const

undefined1  [16] __thiscall
IOAccelDisplayPipeTransaction2::getPlaneSrcRect(IOAccelDisplayPipeTransaction2 *this,uint param_2)

{
  undefined1 auVar1 [16];
  
  auVar1._8_8_ = *(undefined8 *)(*(long *)(this + 0x38) + 0x50 + (ulong)param_2 * 0x70);
  auVar1._0_8_ = *(undefined8 *)(*(long *)(this + 0x38) + 0x48 + (ulong)param_2 * 0x70);
  return auVar1;
}



// IOAccelDisplayPipeTransaction2::getPlaneDstRect(unsigned int) const

undefined1  [16] __thiscall
IOAccelDisplayPipeTransaction2::getPlaneDstRect(IOAccelDisplayPipeTransaction2 *this,uint param_2)

{
  undefined1 auVar1 [16];
  
  auVar1._8_8_ = *(undefined8 *)(*(long *)(this + 0x38) + 0x60 + (ulong)param_2 * 0x70);
  auVar1._0_8_ = *(undefined8 *)(*(long *)(this + 0x38) + 0x58 + (ulong)param_2 * 0x70);
  return auVar1;
}



// IOAccelDisplayPipeTransaction2::getPlaneDirtyRect(unsigned int) const

undefined1  [16] __thiscall
IOAccelDisplayPipeTransaction2::getPlaneDirtyRect(IOAccelDisplayPipeTransaction2 *this,uint param_2)

{
  undefined1 auVar1 [16];
  
  auVar1._8_8_ = *(undefined8 *)(*(long *)(this + 0x38) + 0x70 + (ulong)param_2 * 0x70);
  auVar1._0_8_ = *(undefined8 *)(*(long *)(this + 0x38) + 0x68 + (ulong)param_2 * 0x70);
  return auVar1;
}



// IOAccelDisplayPipeTransaction2::getTimeStamp() const

undefined8 __thiscall
IOAccelDisplayPipeTransaction2::getTimeStamp(IOAccelDisplayPipeTransaction2 *this)

{
  return *(undefined8 *)(this + 0x40);
}



// IOAccelDisplayPipeTransaction2::getPlaneTransactionOptions(unsigned int) const

undefined4 __thiscall
IOAccelDisplayPipeTransaction2::getPlaneTransactionOptions
          (IOAccelDisplayPipeTransaction2 *this,uint param_1)

{
  return *(undefined4 *)(*(long *)(this + 0x38) + 0x78 + (ulong)param_1 * 0x70);
}



// IOAccelDisplayPipeTransaction2::getPlaneGammaTable(unsigned int) const

undefined8 __thiscall
IOAccelDisplayPipeTransaction2::getPlaneGammaTable
          (IOAccelDisplayPipeTransaction2 *this,uint param_1)

{
  return *(undefined8 *)(*(long *)(this + 0x38) + 0x40 + (ulong)param_1 * 0x70);
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeTransaction2::getPipeScalerState() const

undefined8 * __cdecl
IOAccelDisplayPipeTransaction2::getPipeScalerState(undefined8 *param_1,long param_2)

{
  long lVar1;
  undefined8 uVar2;
  
  lVar1 = *(long *)(param_2 + 0x38);
  param_1[2] = *(undefined8 *)(lVar1 + 0x100);
  uVar2 = *(undefined8 *)(lVar1 + 0xf0);
  param_1[1] = *(undefined8 *)(lVar1 + 0xf8);
  *param_1 = uVar2;
  return param_1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeTransaction2::getPipeColorMatrix() const

undefined8 * __cdecl
IOAccelDisplayPipeTransaction2::getPipeColorMatrix(undefined8 *param_1,long param_2)

{
  long lVar1;
  undefined8 uVar2;
  
  lVar1 = *(long *)(param_2 + 0x38);
  param_1[5] = *(undefined8 *)(lVar1 + 0x130);
  param_1[4] = *(undefined8 *)(lVar1 + 0x128);
  param_1[3] = *(undefined8 *)(lVar1 + 0x120);
  param_1[2] = *(undefined8 *)(lVar1 + 0x118);
  uVar2 = *(undefined8 *)(lVar1 + 0x108);
  param_1[1] = *(undefined8 *)(lVar1 + 0x110);
  *param_1 = uVar2;
  return param_1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeTransaction2::getPipeColorMatrixArgs() const

undefined8 * __cdecl
IOAccelDisplayPipeTransaction2::getPipeColorMatrixArgs(undefined8 *param_1,long param_2)

{
  long lVar1;
  undefined8 uVar2;
  
  lVar1 = *(long *)(param_2 + 0x38);
  param_1[2] = *(undefined8 *)(lVar1 + 0x148);
  uVar2 = *(undefined8 *)(lVar1 + 0x138);
  param_1[1] = *(undefined8 *)(lVar1 + 0x140);
  *param_1 = uVar2;
  return param_1;
}



// IOAccelDisplayPipeTransaction2::getPipePreGammaTable() const

undefined8 __thiscall
IOAccelDisplayPipeTransaction2::getPipePreGammaTable(IOAccelDisplayPipeTransaction2 *this)

{
  return **(undefined8 **)(this + 0x38);
}



// IOAccelDisplayPipeTransaction2::getPipePostGammaTable() const

undefined8 __thiscall
IOAccelDisplayPipeTransaction2::getPipePostGammaTable(IOAccelDisplayPipeTransaction2 *this)

{
  return *(undefined8 *)(*(long *)(this + 0x38) + 8);
}



// IOAccelDisplayPipeTransaction2::getPipePreCSCLinearizationVID() const

undefined8 __thiscall
IOAccelDisplayPipeTransaction2::getPipePreCSCLinearizationVID(IOAccelDisplayPipeTransaction2 *this)

{
  return *(undefined8 *)(*(long *)(this + 0x38) + 0x158);
}



// IOAccelDisplayPipeTransaction2::getPipePostCSCGammaVID() const

undefined8 __thiscall
IOAccelDisplayPipeTransaction2::getPipePostCSCGammaVID(IOAccelDisplayPipeTransaction2 *this)

{
  return *(undefined8 *)(*(long *)(this + 0x38) + 0x160);
}



// IOAccelDisplayPipeTransaction2::complete()

void __thiscall IOAccelDisplayPipeTransaction2::complete(IOAccelDisplayPipeTransaction2 *this)

{
  long *plVar1;
  bool bVar2;
  long lVar3;
  bool bVar4;
  bool bVar5;
  long lVar6;
  
  if (((byte)this[0x140] & 1) != 0) {
    lVar6 = 0;
    bVar2 = true;
    do {
      bVar5 = bVar2;
      lVar3 = 0;
      bVar2 = true;
      do {
        bVar4 = bVar2;
        plVar1 = *(long **)(lVar6 * 0x70 + *(long *)(this + 0x38) + 0x30 + lVar3 * 8);
        if (plVar1 != (long *)0x0) {
          (**(code **)(*plVar1 + 0x178))();
        }
        lVar3 = 1;
        bVar2 = false;
      } while (bVar4);
      lVar6 = 1;
      bVar2 = false;
    } while (bVar5);
  }
  return;
}



// IOAccelDisplayPipeTransaction2::finish()

void __thiscall IOAccelDisplayPipeTransaction2::finish(IOAccelDisplayPipeTransaction2 *this)

{
  bool bVar1;
  long lVar2;
  bool bVar3;
  bool bVar4;
  long lVar5;
  
  if (((byte)this[0x140] & 1) != 0) {
    lVar5 = 0;
    bVar1 = true;
    do {
      bVar4 = bVar1;
      lVar2 = 0;
      bVar1 = true;
      do {
        bVar3 = bVar1;
        if (*(long *)(lVar5 * 0x70 + *(long *)(this + 0x38) + 0x20 + lVar2 * 8) != 0) {
          IOSurface::decrement_use_count();
        }
        lVar2 = 1;
        bVar1 = false;
      } while (bVar3);
      lVar5 = 1;
      bVar1 = false;
    } while (bVar4);
  }
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeGammaTable2::withGammaTableData(IOAccelDisplayPipeGammaTableData*)

IOAccelDisplayPipeGammaTable2 * __cdecl
IOAccelDisplayPipeGammaTable2::withGammaTableData(uint *param_1)

{
  IOAccelDisplayPipeGammaTable2 *this;
  undefined8 uVar1;
  
  this = (IOAccelDisplayPipeGammaTable2 *)(**(code **)(gMetaClass + 0x88))(&gMetaClass);
  if (this != (IOAccelDisplayPipeGammaTable2 *)0x0) {
    uVar1 = init(this,param_1);
    if ((char)uVar1 != '\0') {
      return this;
    }
    (**(code **)(*(long *)this + 0x28))(this);
  }
  return (IOAccelDisplayPipeGammaTable2 *)0x0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipePreCSCLinearizationVID::withArgs(IOAccelDisplayPipePreCSCLinearizationArgs*)

IOAccelDisplayPipePreCSCLinearizationVID * __cdecl
IOAccelDisplayPipePreCSCLinearizationVID::withArgs(long param_1)

{
  bool bVar1;
  IOAccelDisplayPipePreCSCLinearizationVID *this;
  
  this = (IOAccelDisplayPipePreCSCLinearizationVID *)(**(code **)(gMetaClass + 0x88))(&gMetaClass);
  if (this != (IOAccelDisplayPipePreCSCLinearizationVID *)0x0) {
    bVar1 = init(this,param_1);
    if (bVar1) {
      return this;
    }
    (**(code **)(*(long *)this + 0x28))(this);
  }
  return (IOAccelDisplayPipePreCSCLinearizationVID *)0x0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipePostCSCGammaVID::withArgs(IOAccelDisplayPipePostCSCGammaTableArgs*)

IOAccelDisplayPipePostCSCGammaVID * __cdecl
IOAccelDisplayPipePostCSCGammaVID::withArgs(long param_1)

{
  bool bVar1;
  IOAccelDisplayPipePostCSCGammaVID *this;
  
  this = (IOAccelDisplayPipePostCSCGammaVID *)(**(code **)(gMetaClass + 0x88))(&gMetaClass);
  if (this != (IOAccelDisplayPipePostCSCGammaVID *)0x0) {
    bVar1 = init(this,param_1);
    if (bVar1) {
      return this;
    }
    (**(code **)(*(long *)this + 0x28))(this);
  }
  return (IOAccelDisplayPipePostCSCGammaVID *)0x0;
}



// IOAccelDisplayPipeTransaction2::_RESERVEDIOAccelDisplayPipeTransaction0()

void IOAccelDisplayPipeTransaction2::_RESERVEDIOAccelDisplayPipeTransaction0(void)

{
  OSMetaClass::reservedCalled(0x82700);
  return;
}



// IOAccelDisplayPipeTransaction2::_RESERVEDIOAccelDisplayPipeTransaction1()

void IOAccelDisplayPipeTransaction2::_RESERVEDIOAccelDisplayPipeTransaction1(void)

{
  OSMetaClass::reservedCalled(0x82700);
  return;
}



// IOAccelDisplayPipeTransaction2::_RESERVEDIOAccelDisplayPipeTransaction2()

void IOAccelDisplayPipeTransaction2::_RESERVEDIOAccelDisplayPipeTransaction2(void)

{
  OSMetaClass::reservedCalled(0x82700);
  return;
}



// IOAccelDisplayPipeTransaction2::_RESERVEDIOAccelDisplayPipeTransaction3()

void IOAccelDisplayPipeTransaction2::_RESERVEDIOAccelDisplayPipeTransaction3(void)

{
  OSMetaClass::reservedCalled(0x82700);
  return;
}



// IOAccelDisplayPipeTransaction2::_RESERVEDIOAccelDisplayPipeTransaction4()

void IOAccelDisplayPipeTransaction2::_RESERVEDIOAccelDisplayPipeTransaction4(void)

{
  OSMetaClass::reservedCalled(0x82700);
  return;
}



// IOAccelDisplayPipeTransaction2::_RESERVEDIOAccelDisplayPipeTransaction5()

void IOAccelDisplayPipeTransaction2::_RESERVEDIOAccelDisplayPipeTransaction5(void)

{
  OSMetaClass::reservedCalled(0x82700);
  return;
}



// IOAccelDisplayPipeTransaction2::_RESERVEDIOAccelDisplayPipeTransaction6()

void IOAccelDisplayPipeTransaction2::_RESERVEDIOAccelDisplayPipeTransaction6(void)

{
  OSMetaClass::reservedCalled(0x82700);
  return;
}



// IOAccelDisplayPipeTransaction2::_RESERVEDIOAccelDisplayPipeTransaction7()

void IOAccelDisplayPipeTransaction2::_RESERVEDIOAccelDisplayPipeTransaction7(void)

{
  OSMetaClass::reservedCalled(0x82700);
  return;
}



// IOAccelDisplayPipeGammaTable2::MetaClass::MetaClass()

void __thiscall IOAccelDisplayPipeGammaTable2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDisplayPipeGammaTable2",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x20);
  *(undefined ***)this = &PTR__MetaClass_0007f420;
  return;
}



// IOAccelDisplayPipeGammaTable2::MetaClass::~MetaClass()

void __thiscall IOAccelDisplayPipeGammaTable2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelDisplayPipeGammaTable2::IOAccelDisplayPipeGammaTable2(OSMetaClass const*)

void __thiscall
IOAccelDisplayPipeGammaTable2::IOAccelDisplayPipeGammaTable2
          (IOAccelDisplayPipeGammaTable2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDisplayPipeGammaTable2_0007f2f0;
  return;
}



// IOAccelDisplayPipeGammaTable2::IOAccelDisplayPipeGammaTable2(OSMetaClass const*)

void __thiscall
IOAccelDisplayPipeGammaTable2::IOAccelDisplayPipeGammaTable2
          (IOAccelDisplayPipeGammaTable2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDisplayPipeGammaTable2_0007f2f0;
  return;
}



// IOAccelDisplayPipeGammaTable2::~IOAccelDisplayPipeGammaTable2()

void __thiscall
IOAccelDisplayPipeGammaTable2::~IOAccelDisplayPipeGammaTable2(IOAccelDisplayPipeGammaTable2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelDisplayPipeGammaTable2::~IOAccelDisplayPipeGammaTable2()

void __thiscall
IOAccelDisplayPipeGammaTable2::~IOAccelDisplayPipeGammaTable2(IOAccelDisplayPipeGammaTable2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelDisplayPipeGammaTable2::~IOAccelDisplayPipeGammaTable2()

void __thiscall
IOAccelDisplayPipeGammaTable2::~IOAccelDisplayPipeGammaTable2(IOAccelDisplayPipeGammaTable2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelDisplayPipeGammaTable2_ktv,this,0x20);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeGammaTable2::operator delete(void*, unsigned long)

void __cdecl IOAccelDisplayPipeGammaTable2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelDisplayPipeGammaTable2_ktv,param_1,param_2);
  return;
}



// IOAccelDisplayPipeGammaTable2::getMetaClass() const

undefined8 * IOAccelDisplayPipeGammaTable2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelDisplayPipeGammaTable2::MetaClass::MetaClass()

void __thiscall IOAccelDisplayPipeGammaTable2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDisplayPipeGammaTable2",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x20);
  *(undefined ***)this = &PTR__MetaClass_0007f420;
  return;
}



// IOAccelDisplayPipeGammaTable2::MetaClass::alloc() const

OSObject * IOAccelDisplayPipeGammaTable2::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelDisplayPipeGammaTable2_ktv,0x20);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelDisplayPipeGammaTable2::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipeGammaTable2_0007f2f0;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelDisplayPipeGammaTable2::operator new(unsigned long)

void * __thiscall IOAccelDisplayPipeGammaTable2::operator_new(IOAccelDisplayPipeGammaTable2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelDisplayPipeGammaTable2_ktv,this);
  return pvVar1;
}



// IOAccelDisplayPipeGammaTable2::IOAccelDisplayPipeGammaTable2()

void __thiscall
IOAccelDisplayPipeGammaTable2::IOAccelDisplayPipeGammaTable2(IOAccelDisplayPipeGammaTable2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipeGammaTable2_0007f2f0;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDisplayPipeGammaTable2::IOAccelDisplayPipeGammaTable2()

void __thiscall
IOAccelDisplayPipeGammaTable2::IOAccelDisplayPipeGammaTable2(IOAccelDisplayPipeGammaTable2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipeGammaTable2_0007f2f0;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDisplayPipeGammaTable2::init(IOAccelDisplayPipeGammaTableData*)

undefined8 __thiscall
IOAccelDisplayPipeGammaTable2::init(IOAccelDisplayPipeGammaTable2 *this,uint *param_1)

{
  void *pvVar1;
  ulong uVar2;
  
  if ((ulong)*param_1 < 0x20001) {
    uVar2 = (ulong)*param_1 * 0x10 + 0x10;
    *(ulong *)(this + 0x18) = uVar2;
    pvVar1 = (void *)_IOMallocData(uVar2);
    *(void **)(this + 0x10) = pvVar1;
    if (pvVar1 != (void *)0x0) {
      if (*(ulong *)(this + 0x18) <= uVar2) {
        pvVar1 = _memmove(pvVar1,param_1,*(ulong *)(this + 0x18));
        return CONCAT71((int7)((ulong)pvVar1 >> 8),1);
      }
      init();
      return 0;
    }
  }
  return 0;
}



// IOAccelDisplayPipeGammaTable2::free()

void __thiscall IOAccelDisplayPipeGammaTable2::free(IOAccelDisplayPipeGammaTable2 *this)

{
  if (*(long *)(this + 0x10) != 0) {
    _IOFreeData(*(long *)(this + 0x10),*(undefined8 *)(this + 0x18));
    *(undefined8 *)(this + 0x10) = 0;
  }
                    // WARNING: Could not recover jumptable at 0x00050e0b. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelDisplayPipeGammaTable2::getTableMinValue() const

undefined4 __thiscall
IOAccelDisplayPipeGammaTable2::getTableMinValue(IOAccelDisplayPipeGammaTable2 *this)

{
  return *(undefined4 *)(*(long *)(this + 0x10) + 8);
}



// IOAccelDisplayPipeGammaTable2::getTableMaxValue() const

undefined4 __thiscall
IOAccelDisplayPipeGammaTable2::getTableMaxValue(IOAccelDisplayPipeGammaTable2 *this)

{
  return *(undefined4 *)(*(long *)(this + 0x10) + 0xc);
}



// IOAccelDisplayPipeGammaTable2::getTableCount() const

undefined4 __thiscall
IOAccelDisplayPipeGammaTable2::getTableCount(IOAccelDisplayPipeGammaTable2 *this)

{
  return **(undefined4 **)(this + 0x10);
}



// IOAccelDisplayPipeGammaTable2::getTableEntry(unsigned int, float*, float*, float*) const

void __thiscall
IOAccelDisplayPipeGammaTable2::getTableEntry
          (IOAccelDisplayPipeGammaTable2 *this,uint param_1,undefined4 *param_2,undefined4 *param_3,
          undefined4 *param_4)

{
  long lVar1;
  long lVar2;
  
  lVar1 = *(long *)(this + 0x10);
  lVar2 = (ulong)param_1 * 0x10;
  *param_2 = *(undefined4 *)(lVar1 + 0x10 + lVar2);
  *param_3 = *(undefined4 *)(lVar1 + 0x14 + lVar2);
  *param_4 = *(undefined4 *)(lVar1 + 0x18 + lVar2);
  return;
}



// IOAccelDisplayPipePreCSCLinearizationVID::MetaClass::MetaClass()

void __thiscall IOAccelDisplayPipePreCSCLinearizationVID::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDisplayPipePreCSCLinearizationVID",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x40);
  *(undefined ***)this = &PTR__MetaClass_0007f648;
  return;
}



// IOAccelDisplayPipePreCSCLinearizationVID::MetaClass::~MetaClass()

void __thiscall IOAccelDisplayPipePreCSCLinearizationVID::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelDisplayPipePreCSCLinearizationVID::IOAccelDisplayPipePreCSCLinearizationVID(OSMetaClass
// const*)

void __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::IOAccelDisplayPipePreCSCLinearizationVID
          (IOAccelDisplayPipePreCSCLinearizationVID *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDisplayPipePreCSCLinearizationVID_0007f518;
  return;
}



// IOAccelDisplayPipePreCSCLinearizationVID::IOAccelDisplayPipePreCSCLinearizationVID(OSMetaClass
// const*)

void __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::IOAccelDisplayPipePreCSCLinearizationVID
          (IOAccelDisplayPipePreCSCLinearizationVID *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDisplayPipePreCSCLinearizationVID_0007f518;
  return;
}



// IOAccelDisplayPipePreCSCLinearizationVID::~IOAccelDisplayPipePreCSCLinearizationVID()

void __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::~IOAccelDisplayPipePreCSCLinearizationVID
          (IOAccelDisplayPipePreCSCLinearizationVID *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelDisplayPipePreCSCLinearizationVID::~IOAccelDisplayPipePreCSCLinearizationVID()

void __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::~IOAccelDisplayPipePreCSCLinearizationVID
          (IOAccelDisplayPipePreCSCLinearizationVID *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelDisplayPipePreCSCLinearizationVID::~IOAccelDisplayPipePreCSCLinearizationVID()

void __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::~IOAccelDisplayPipePreCSCLinearizationVID
          (IOAccelDisplayPipePreCSCLinearizationVID *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelDisplayPipePreCSCLinearizationVID_ktv,this,0x40);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipePreCSCLinearizationVID::operator delete(void*, unsigned long)

void __cdecl
IOAccelDisplayPipePreCSCLinearizationVID::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelDisplayPipePreCSCLinearizationVID_ktv,param_1,param_2);
  return;
}



// IOAccelDisplayPipePreCSCLinearizationVID::getMetaClass() const

undefined8 * IOAccelDisplayPipePreCSCLinearizationVID::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelDisplayPipePreCSCLinearizationVID::MetaClass::MetaClass()

void __thiscall IOAccelDisplayPipePreCSCLinearizationVID::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDisplayPipePreCSCLinearizationVID",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x40);
  *(undefined ***)this = &PTR__MetaClass_0007f648;
  return;
}



// IOAccelDisplayPipePreCSCLinearizationVID::MetaClass::alloc() const

OSObject * IOAccelDisplayPipePreCSCLinearizationVID::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)
         _OSObject_typed_operator_new(&IOAccelDisplayPipePreCSCLinearizationVID_ktv,0x40);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelDisplayPipePreCSCLinearizationVID::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipePreCSCLinearizationVID_0007f518;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelDisplayPipePreCSCLinearizationVID::operator new(unsigned long)

void * __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::operator_new
          (IOAccelDisplayPipePreCSCLinearizationVID *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelDisplayPipePreCSCLinearizationVID_ktv,this);
  return pvVar1;
}



// IOAccelDisplayPipePreCSCLinearizationVID::IOAccelDisplayPipePreCSCLinearizationVID()

void __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::IOAccelDisplayPipePreCSCLinearizationVID
          (IOAccelDisplayPipePreCSCLinearizationVID *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipePreCSCLinearizationVID_0007f518;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDisplayPipePreCSCLinearizationVID::IOAccelDisplayPipePreCSCLinearizationVID()

void __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::IOAccelDisplayPipePreCSCLinearizationVID
          (IOAccelDisplayPipePreCSCLinearizationVID *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipePreCSCLinearizationVID_0007f518;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDisplayPipePreCSCLinearizationVID::init(IOAccelDisplayPipePreCSCLinearizationArgs*)

bool __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::init
          (IOAccelDisplayPipePreCSCLinearizationVID *this,long param_1)

{
  ulong uVar1;
  ulong uVar2;
  void *pvVar3;
  
  uVar1 = *(ulong *)(param_1 + 0x28);
  pvVar3 = (void *)_IOMallocData(uVar1);
  *(void **)(this + 0x38) = pvVar3;
  if (pvVar3 != (void *)0x0) {
    *(undefined4 *)(this + 0xc) = *(undefined4 *)(param_1 + 4);
    *(undefined8 *)(this + 0x10) = *(undefined8 *)(param_1 + 8);
    *(undefined8 *)(this + 0x18) = *(undefined8 *)(param_1 + 0x10);
    *(undefined8 *)(this + 0x20) = *(undefined8 *)(param_1 + 0x18);
    *(undefined4 *)(this + 0x28) = *(undefined4 *)(param_1 + 0x20);
    *(undefined4 *)(this + 0x2c) = *(undefined4 *)(param_1 + 0x24);
    uVar2 = *(ulong *)(param_1 + 0x28);
    *(ulong *)(this + 0x30) = uVar2;
    if (uVar1 < uVar2) {
      init();
      return false;
    }
    _memmove(pvVar3,(void *)(param_1 + 0x30),uVar2);
  }
  return pvVar3 != (void *)0x0;
}



// IOAccelDisplayPipePreCSCLinearizationVID::free()

void __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::free(IOAccelDisplayPipePreCSCLinearizationVID *this)

{
  if (*(long *)(this + 0x38) != 0) {
    _IOFreeData(*(long *)(this + 0x38),*(undefined8 *)(this + 0x30));
    *(undefined8 *)(this + 0x38) = 0;
    *(undefined8 *)(this + 0x30) = 0;
  }
                    // WARNING: Could not recover jumptable at 0x00051109. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelDisplayPipePreCSCLinearizationVID::getPlane() const

undefined4 __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::getPlane(IOAccelDisplayPipePreCSCLinearizationVID *this)

{
  return *(undefined4 *)(this + 0xc);
}



// IOAccelDisplayPipePreCSCLinearizationVID::getType() const

undefined8 __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::getType(IOAccelDisplayPipePreCSCLinearizationVID *this)

{
  return *(undefined8 *)(this + 0x10);
}



// IOAccelDisplayPipePreCSCLinearizationVID::getFormat() const

undefined8 __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::getFormat(IOAccelDisplayPipePreCSCLinearizationVID *this)

{
  return *(undefined8 *)(this + 0x18);
}



// IOAccelDisplayPipePreCSCLinearizationVID::getConfigurationID() const

undefined8 __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::getConfigurationID
          (IOAccelDisplayPipePreCSCLinearizationVID *this)

{
  return *(undefined8 *)(this + 0x20);
}



// IOAccelDisplayPipePreCSCLinearizationVID::getMinimumValue() const

undefined4 __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::getMinimumValue
          (IOAccelDisplayPipePreCSCLinearizationVID *this)

{
  return *(undefined4 *)(this + 0x28);
}



// IOAccelDisplayPipePreCSCLinearizationVID::getMaximumValue() const

undefined4 __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::getMaximumValue
          (IOAccelDisplayPipePreCSCLinearizationVID *this)

{
  return *(undefined4 *)(this + 0x2c);
}



// IOAccelDisplayPipePreCSCLinearizationVID::getSize() const

undefined8 __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::getSize(IOAccelDisplayPipePreCSCLinearizationVID *this)

{
  return *(undefined8 *)(this + 0x30);
}



// IOAccelDisplayPipePreCSCLinearizationVID::getData() const

undefined8 __thiscall
IOAccelDisplayPipePreCSCLinearizationVID::getData(IOAccelDisplayPipePreCSCLinearizationVID *this)

{
  return *(undefined8 *)(this + 0x38);
}



// IOAccelDisplayPipePostCSCGammaVID::MetaClass::MetaClass()

void __thiscall IOAccelDisplayPipePostCSCGammaVID::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDisplayPipePostCSCGammaVID",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x40);
  *(undefined ***)this = &PTR__MetaClass_0007f870;
  return;
}



// IOAccelDisplayPipePostCSCGammaVID::MetaClass::~MetaClass()

void __thiscall IOAccelDisplayPipePostCSCGammaVID::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelDisplayPipePostCSCGammaVID::IOAccelDisplayPipePostCSCGammaVID(OSMetaClass const*)

void __thiscall
IOAccelDisplayPipePostCSCGammaVID::IOAccelDisplayPipePostCSCGammaVID
          (IOAccelDisplayPipePostCSCGammaVID *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDisplayPipePostCSCGammaVID_0007f740;
  return;
}



// IOAccelDisplayPipePostCSCGammaVID::IOAccelDisplayPipePostCSCGammaVID(OSMetaClass const*)

void __thiscall
IOAccelDisplayPipePostCSCGammaVID::IOAccelDisplayPipePostCSCGammaVID
          (IOAccelDisplayPipePostCSCGammaVID *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDisplayPipePostCSCGammaVID_0007f740;
  return;
}



// IOAccelDisplayPipePostCSCGammaVID::~IOAccelDisplayPipePostCSCGammaVID()

void __thiscall
IOAccelDisplayPipePostCSCGammaVID::~IOAccelDisplayPipePostCSCGammaVID
          (IOAccelDisplayPipePostCSCGammaVID *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelDisplayPipePostCSCGammaVID::~IOAccelDisplayPipePostCSCGammaVID()

void __thiscall
IOAccelDisplayPipePostCSCGammaVID::~IOAccelDisplayPipePostCSCGammaVID
          (IOAccelDisplayPipePostCSCGammaVID *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelDisplayPipePostCSCGammaVID::~IOAccelDisplayPipePostCSCGammaVID()

void __thiscall
IOAccelDisplayPipePostCSCGammaVID::~IOAccelDisplayPipePostCSCGammaVID
          (IOAccelDisplayPipePostCSCGammaVID *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelDisplayPipePostCSCGammaVID_ktv,this,0x40);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipePostCSCGammaVID::operator delete(void*, unsigned long)

void __cdecl
IOAccelDisplayPipePostCSCGammaVID::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelDisplayPipePostCSCGammaVID_ktv,param_1,param_2);
  return;
}



// IOAccelDisplayPipePostCSCGammaVID::getMetaClass() const

undefined8 * IOAccelDisplayPipePostCSCGammaVID::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelDisplayPipePostCSCGammaVID::MetaClass::MetaClass()

void __thiscall IOAccelDisplayPipePostCSCGammaVID::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDisplayPipePostCSCGammaVID",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x40);
  *(undefined ***)this = &PTR__MetaClass_0007f870;
  return;
}



// IOAccelDisplayPipePostCSCGammaVID::MetaClass::alloc() const

OSObject * IOAccelDisplayPipePostCSCGammaVID::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelDisplayPipePostCSCGammaVID_ktv,0x40);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelDisplayPipePostCSCGammaVID::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipePostCSCGammaVID_0007f740;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelDisplayPipePostCSCGammaVID::operator new(unsigned long)

void * __thiscall
IOAccelDisplayPipePostCSCGammaVID::operator_new(IOAccelDisplayPipePostCSCGammaVID *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelDisplayPipePostCSCGammaVID_ktv,this);
  return pvVar1;
}



// IOAccelDisplayPipePostCSCGammaVID::IOAccelDisplayPipePostCSCGammaVID()

void __thiscall
IOAccelDisplayPipePostCSCGammaVID::IOAccelDisplayPipePostCSCGammaVID
          (IOAccelDisplayPipePostCSCGammaVID *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipePostCSCGammaVID_0007f740;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDisplayPipePostCSCGammaVID::IOAccelDisplayPipePostCSCGammaVID()

void __thiscall
IOAccelDisplayPipePostCSCGammaVID::IOAccelDisplayPipePostCSCGammaVID
          (IOAccelDisplayPipePostCSCGammaVID *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipePostCSCGammaVID_0007f740;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDisplayPipePostCSCGammaVID::init(IOAccelDisplayPipePostCSCGammaTableArgs*)

bool __thiscall
IOAccelDisplayPipePostCSCGammaVID::init(IOAccelDisplayPipePostCSCGammaVID *this,long param_1)

{
  ulong uVar1;
  ulong uVar2;
  void *pvVar3;
  
  uVar1 = *(ulong *)(param_1 + 0x28);
  pvVar3 = (void *)_IOMallocData(uVar1);
  *(void **)(this + 0x38) = pvVar3;
  if (pvVar3 != (void *)0x0) {
    *(undefined4 *)(this + 0xc) = *(undefined4 *)(param_1 + 4);
    *(undefined8 *)(this + 0x10) = *(undefined8 *)(param_1 + 8);
    *(undefined8 *)(this + 0x18) = *(undefined8 *)(param_1 + 0x10);
    *(undefined8 *)(this + 0x20) = *(undefined8 *)(param_1 + 0x18);
    *(undefined4 *)(this + 0x28) = *(undefined4 *)(param_1 + 0x20);
    *(undefined4 *)(this + 0x2c) = *(undefined4 *)(param_1 + 0x24);
    uVar2 = *(ulong *)(param_1 + 0x28);
    *(ulong *)(this + 0x30) = uVar2;
    if (uVar1 < uVar2) {
      init();
      return false;
    }
    _memmove(pvVar3,(void *)(param_1 + 0x30),uVar2);
  }
  return pvVar3 != (void *)0x0;
}



// IOAccelDisplayPipePostCSCGammaVID::free()

void __thiscall IOAccelDisplayPipePostCSCGammaVID::free(IOAccelDisplayPipePostCSCGammaVID *this)

{
  if (*(long *)(this + 0x38) != 0) {
    _IOFreeData(*(long *)(this + 0x38),*(undefined8 *)(this + 0x30));
    *(undefined8 *)(this + 0x38) = 0;
    *(undefined8 *)(this + 0x30) = 0;
  }
                    // WARNING: Could not recover jumptable at 0x000513ff. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelDisplayPipePostCSCGammaVID::getPlane() const

undefined4 __thiscall
IOAccelDisplayPipePostCSCGammaVID::getPlane(IOAccelDisplayPipePostCSCGammaVID *this)

{
  return *(undefined4 *)(this + 0xc);
}



// IOAccelDisplayPipePostCSCGammaVID::getType() const

undefined8 __thiscall
IOAccelDisplayPipePostCSCGammaVID::getType(IOAccelDisplayPipePostCSCGammaVID *this)

{
  return *(undefined8 *)(this + 0x10);
}



// IOAccelDisplayPipePostCSCGammaVID::getFormat() const

undefined8 __thiscall
IOAccelDisplayPipePostCSCGammaVID::getFormat(IOAccelDisplayPipePostCSCGammaVID *this)

{
  return *(undefined8 *)(this + 0x18);
}



// IOAccelDisplayPipePostCSCGammaVID::getConfigurationID() const

undefined8 __thiscall
IOAccelDisplayPipePostCSCGammaVID::getConfigurationID(IOAccelDisplayPipePostCSCGammaVID *this)

{
  return *(undefined8 *)(this + 0x20);
}



// IOAccelDisplayPipePostCSCGammaVID::getMinimumValue() const

undefined4 __thiscall
IOAccelDisplayPipePostCSCGammaVID::getMinimumValue(IOAccelDisplayPipePostCSCGammaVID *this)

{
  return *(undefined4 *)(this + 0x28);
}



// IOAccelDisplayPipePostCSCGammaVID::getMaximumValue() const

undefined4 __thiscall
IOAccelDisplayPipePostCSCGammaVID::getMaximumValue(IOAccelDisplayPipePostCSCGammaVID *this)

{
  return *(undefined4 *)(this + 0x2c);
}



// IOAccelDisplayPipePostCSCGammaVID::getSize() const

undefined8 __thiscall
IOAccelDisplayPipePostCSCGammaVID::getSize(IOAccelDisplayPipePostCSCGammaVID *this)

{
  return *(undefined8 *)(this + 0x30);
}



// IOAccelDisplayPipePostCSCGammaVID::getData() const

undefined8 __thiscall
IOAccelDisplayPipePostCSCGammaVID::getData(IOAccelDisplayPipePostCSCGammaVID *this)

{
  return *(undefined8 *)(this + 0x38);
}



// IOAccelDisplayPipe::MetaClass::~MetaClass()

void __thiscall IOAccelDisplayPipe::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelDisplayPipeTransaction2::MetaClass::~MetaClass()

void __thiscall IOAccelDisplayPipeTransaction2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelDisplayPipeGammaTable2::MetaClass::~MetaClass()

void __thiscall IOAccelDisplayPipeGammaTable2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelDisplayPipePreCSCLinearizationVID::MetaClass::~MetaClass()

void __thiscall IOAccelDisplayPipePreCSCLinearizationVID::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelDisplayPipePostCSCGammaVID::MetaClass::~MetaClass()

void __thiscall IOAccelDisplayPipePostCSCGammaVID::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelDisplayPipe_cpp(void)

{
  undefined *puVar1;
  
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelDisplayPipe::gMetaClass,"IOAccelDisplayPipe",
             (OSMetaClass *)PTR_gMetaClass_0006b070,0x318);
  puVar1 = PTR_gMetaClass_0006b068;
  _gMetaClass = &PTR__MetaClass_0007ef90;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelDisplayPipeTransaction2::gMetaClass,
             "IOAccelDisplayPipeTransaction2",(OSMetaClass *)PTR_gMetaClass_0006b068,0x1b8);
  IOAccelDisplayPipeTransaction2::gMetaClass = &PTR__MetaClass_0007f1f8;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelDisplayPipeGammaTable2::gMetaClass,
             "IOAccelDisplayPipeGammaTable2",(OSMetaClass *)puVar1,0x20);
  IOAccelDisplayPipeGammaTable2::gMetaClass = &PTR__MetaClass_0007f420;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelDisplayPipePreCSCLinearizationVID::gMetaClass,
             "IOAccelDisplayPipePreCSCLinearizationVID",(OSMetaClass *)puVar1,0x40);
  IOAccelDisplayPipePreCSCLinearizationVID::gMetaClass = &PTR__MetaClass_0007f648;
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelDisplayPipePostCSCGammaVID::gMetaClass,
             "IOAccelDisplayPipePostCSCGammaVID",(OSMetaClass *)puVar1,0x40);
  IOAccelDisplayPipePostCSCGammaVID::gMetaClass = &PTR__MetaClass_0007f870;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelDisplayPipePostCSCGammaVID::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelDisplayPipePreCSCLinearizationVID::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelDisplayPipeGammaTable2::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelDisplayPipeTransaction2::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelDisplayPipe::gMetaClass);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeUserClient2::s_set_pipe_index(IOAccelDisplayPipeUserClient2*, void*,
// IOExternalMethodArguments*)

void __cdecl
IOAccelDisplayPipeUserClient2::s_set_pipe_index
          (IOAccelDisplayPipeUserClient2 *param_1,undefined8 param_2,long param_3)

{
  setPipeIndex(param_1,**(uint **)(param_3 + 0x20),*(ulong **)(param_3 + 0x48));
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeUserClient2::s_get_display_mode_scaler(IOAccelDisplayPipeUserClient2*, void*,
// IOExternalMethodArguments*)

void __cdecl
IOAccelDisplayPipeUserClient2::s_get_display_mode_scaler
          (IOAccelDisplayPipeUserClient2 *param_1,undefined8 param_2,long param_3)

{
  getDisplayModeScaler(param_1,*(undefined8 *)(param_3 + 0x58));
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeUserClient2::s_get_capabilities_data(IOAccelDisplayPipeUserClient2*, void*,
// IOExternalMethodArguments*)

ulong __cdecl
IOAccelDisplayPipeUserClient2::s_get_capabilities_data
          (IOAccelDisplayPipeUserClient2 *param_1,undefined8 param_2,long param_3)

{
  long *plVar1;
  void *pvVar2;
  ulong uVar3;
  ulong local_30;
  
  pvVar2 = *(void **)(param_3 + 0x58);
  local_30 = (ulong)*(uint *)(param_3 + 0x60);
  plVar1 = *(long **)(param_3 + 0x68);
  if (plVar1 == (long *)0x0) {
    plVar1 = (long *)0x0;
  }
  else {
    plVar1 = (long *)(**(code **)(*plVar1 + 0x200))(plVar1,0);
    if (plVar1 == (long *)0x0) {
      return 0xe00002c8;
    }
    pvVar2 = (void *)(**(code **)(*plVar1 + 0x118))(plVar1);
    local_30 = (**(code **)(**(long **)(param_3 + 0x68) + 0x1c8))();
  }
  if (pvVar2 == (void *)0x0) {
    uVar3 = 0xe00002c2;
  }
  else {
    uVar3 = getCapabilitiesData(param_1,pvVar2,&local_30);
    uVar3 = uVar3 & 0xffffffff;
  }
  if (plVar1 != (long *)0x0) {
    (**(code **)(*plVar1 + 0x28))(plVar1);
  }
  return uVar3;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeUserClient2::s_request_notify(IOAccelDisplayPipeUserClient2*, void*,
// IOExternalMethodArguments*)

undefined4 __cdecl
IOAccelDisplayPipeUserClient2::s_request_notify
          (IOAccelDisplayPipeUserClient2 *param_1,undefined8 param_2,long param_3)

{
  undefined4 uVar1;
  
  if ((*(long *)(param_3 + 0x10) != 0) && (*(uint *)(*(long *)(param_3 + 0x30) + 0x10) < 2)) {
    uVar1 = requestNotify(param_1,*(long *)(param_3 + 0x10),*(long *)(param_3 + 0x30));
    return uVar1;
  }
  return 0xe00002c2;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeUserClient2::s_transaction_begin(IOAccelDisplayPipeUserClient2*, void*,
// IOExternalMethodArguments*)

void __cdecl
IOAccelDisplayPipeUserClient2::s_transaction_begin
          (IOAccelDisplayPipeUserClient2 *param_1,undefined8 param_2,long param_3)

{
  ulong uVar1;
  ulong uVar2;
  uint local_1c;
  
  local_1c = 0xaaaaaaaa;
  uVar1 = transactionBegin(param_1,&local_1c);
  uVar2 = 0;
  if ((int)uVar1 == 0) {
    uVar2 = (ulong)local_1c;
  }
  **(ulong **)(param_3 + 0x48) = uVar2;
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeUserClient2::s_transaction_set_plane_gamma_table(IOAccelDisplayPipeUserClient2*,
// void*, IOExternalMethodArguments*)

ulong __cdecl
IOAccelDisplayPipeUserClient2::s_transaction_set_plane_gamma_table
          (IOAccelDisplayPipeUserClient2 *param_1,undefined8 param_2,long param_3)

{
  long *plVar1;
  int *piVar2;
  ulong uVar3;
  ulong uVar4;
  
  plVar1 = *(long **)(param_3 + 0x40);
  if (plVar1 == (long *)0x0) {
    uVar3 = (ulong)*(uint *)(param_3 + 0x38);
    piVar2 = *(int **)(param_3 + 0x30);
    plVar1 = (long *)0x0;
  }
  else {
    plVar1 = (long *)(**(code **)(*plVar1 + 0x200))(plVar1,0x1000);
    if (plVar1 == (long *)0x0) {
      return 0xe00002c8;
    }
    piVar2 = (int *)(**(code **)(*plVar1 + 0x118))(plVar1);
    uVar3 = (**(code **)(**(long **)(param_3 + 0x40) + 0x1c8))();
  }
  uVar4 = 0xe00002c2;
  if ((((piVar2 != (int *)0x0) && (0x17 < uVar3)) && ((ulong)(uint)piVar2[2] < 0x20001)) &&
     ((ulong)(uint)piVar2[2] * 0x10 + 0x18 <= uVar3)) {
    uVar4 = transactionSetPlaneGammaTable(param_1,piVar2);
    uVar4 = uVar4 & 0xffffffff;
  }
  if (plVar1 != (long *)0x0) {
    (**(code **)(*plVar1 + 0x28))(plVar1);
  }
  return uVar4;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeUserClient2::s_transaction_set_pipe_pregamma_table(IOAccelDisplayPipeUserClient2*,
// void*, IOExternalMethodArguments*)

ulong __cdecl
IOAccelDisplayPipeUserClient2::s_transaction_set_pipe_pregamma_table
          (IOAccelDisplayPipeUserClient2 *param_1,undefined8 param_2,long param_3)

{
  long *plVar1;
  int *piVar2;
  ulong uVar3;
  ulong uVar4;
  
  plVar1 = *(long **)(param_3 + 0x40);
  if (plVar1 == (long *)0x0) {
    uVar3 = (ulong)*(uint *)(param_3 + 0x38);
    piVar2 = *(int **)(param_3 + 0x30);
    plVar1 = (long *)0x0;
  }
  else {
    plVar1 = (long *)(**(code **)(*plVar1 + 0x200))(plVar1,0x1000);
    if (plVar1 == (long *)0x0) {
      return 0xe00002c8;
    }
    piVar2 = (int *)(**(code **)(*plVar1 + 0x118))(plVar1);
    uVar3 = (**(code **)(**(long **)(param_3 + 0x40) + 0x1c8))();
  }
  uVar4 = 0xe00002c2;
  if ((((piVar2 != (int *)0x0) && (0x17 < uVar3)) && ((ulong)(uint)piVar2[2] < 0x20001)) &&
     ((ulong)(uint)piVar2[2] * 0x10 + 0x18 <= uVar3)) {
    uVar4 = transactionSetPipePreGammaTable(param_1,piVar2);
    uVar4 = uVar4 & 0xffffffff;
  }
  if (plVar1 != (long *)0x0) {
    (**(code **)(*plVar1 + 0x28))(plVar1);
  }
  return uVar4;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeUserClient2::s_transaction_set_pipe_postgamma_table(IOAccelDisplayPipeUserClient2*,
// void*, IOExternalMethodArguments*)

ulong __cdecl
IOAccelDisplayPipeUserClient2::s_transaction_set_pipe_postgamma_table
          (IOAccelDisplayPipeUserClient2 *param_1,undefined8 param_2,long param_3)

{
  long *plVar1;
  int *piVar2;
  ulong uVar3;
  ulong uVar4;
  
  plVar1 = *(long **)(param_3 + 0x40);
  if (plVar1 == (long *)0x0) {
    uVar3 = (ulong)*(uint *)(param_3 + 0x38);
    piVar2 = *(int **)(param_3 + 0x30);
    plVar1 = (long *)0x0;
  }
  else {
    plVar1 = (long *)(**(code **)(*plVar1 + 0x200))(plVar1,0x1000);
    if (plVar1 == (long *)0x0) {
      return 0xe00002c8;
    }
    piVar2 = (int *)(**(code **)(*plVar1 + 0x118))(plVar1);
    uVar3 = (**(code **)(**(long **)(param_3 + 0x40) + 0x1c8))();
  }
  uVar4 = 0xe00002c2;
  if ((((piVar2 != (int *)0x0) && (0x17 < uVar3)) && ((ulong)(uint)piVar2[2] < 0x20001)) &&
     ((ulong)(uint)piVar2[2] * 0x10 + 0x18 <= uVar3)) {
    uVar4 = transactionSetPipePostGammaTable(param_1,piVar2);
    uVar4 = uVar4 & 0xffffffff;
  }
  if (plVar1 != (long *)0x0) {
    (**(code **)(*plVar1 + 0x28))(plVar1);
  }
  return uVar4;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeUserClient2::s_transaction_end(IOAccelDisplayPipeUserClient2*, void*,
// IOExternalMethodArguments*)

void __cdecl
IOAccelDisplayPipeUserClient2::s_transaction_end
          (IOAccelDisplayPipeUserClient2 *param_1,undefined8 param_2,long param_3)

{
  transactionEnd(param_1,*(ulong **)(param_3 + 0x30));
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeUserClient2::s_transaction_wait(IOAccelDisplayPipeUserClient2*, void*,
// IOExternalMethodArguments*)

void __cdecl
IOAccelDisplayPipeUserClient2::s_transaction_wait
          (IOAccelDisplayPipeUserClient2 *param_1,undefined8 param_2,long param_3)

{
  transactionWait(param_1,*(int **)(param_3 + 0x30));
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeUserClient2::s_transaction_set_pipe_precsclinearization_vid(IOAccelDisplayPipeUserClient2*,
// void*, IOExternalMethodArguments*)

ulong __cdecl
IOAccelDisplayPipeUserClient2::s_transaction_set_pipe_precsclinearization_vid
          (IOAccelDisplayPipeUserClient2 *param_1,undefined8 param_2,long param_3)

{
  long *plVar1;
  int *piVar2;
  ulong uVar3;
  ulong uVar4;
  
  plVar1 = *(long **)(param_3 + 0x40);
  if (plVar1 == (long *)0x0) {
    piVar2 = *(int **)(param_3 + 0x30);
    uVar3 = (ulong)*(uint *)(param_3 + 0x38);
    plVar1 = (long *)0x0;
  }
  else {
    plVar1 = (long *)(**(code **)(*plVar1 + 0x200))(plVar1,0x1000);
    if (plVar1 == (long *)0x0) {
      return 0xe00002c8;
    }
    piVar2 = (int *)(**(code **)(*plVar1 + 0x118))(plVar1);
    uVar3 = (**(code **)(**(long **)(param_3 + 0x40) + 0x1c8))();
  }
  uVar4 = 0xe00002c2;
  if ((((piVar2 != (int *)0x0) && (0x2f < uVar3)) && (*(ulong *)(piVar2 + 10) < 0x20001)) &&
     (*(ulong *)(piVar2 + 10) + 0x30 <= uVar3)) {
    uVar4 = transactionSetPipePreCSCLinearizationVID(param_1,piVar2);
    uVar4 = uVar4 & 0xffffffff;
  }
  if (plVar1 != (long *)0x0) {
    (**(code **)(*plVar1 + 0x28))(plVar1);
  }
  return uVar4;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeUserClient2::s_transaction_set_pipe_postcscgamma_vid(IOAccelDisplayPipeUserClient2*,
// void*, IOExternalMethodArguments*)

ulong __cdecl
IOAccelDisplayPipeUserClient2::s_transaction_set_pipe_postcscgamma_vid
          (IOAccelDisplayPipeUserClient2 *param_1,undefined8 param_2,long param_3)

{
  long *plVar1;
  int *piVar2;
  ulong uVar3;
  ulong uVar4;
  
  plVar1 = *(long **)(param_3 + 0x40);
  if (plVar1 == (long *)0x0) {
    piVar2 = *(int **)(param_3 + 0x30);
    uVar3 = (ulong)*(uint *)(param_3 + 0x38);
    plVar1 = (long *)0x0;
  }
  else {
    plVar1 = (long *)(**(code **)(*plVar1 + 0x200))(plVar1,0x1000);
    if (plVar1 == (long *)0x0) {
      return 0xe00002c8;
    }
    piVar2 = (int *)(**(code **)(*plVar1 + 0x118))(plVar1);
    uVar3 = (**(code **)(**(long **)(param_3 + 0x40) + 0x1c8))();
  }
  uVar4 = 0xe00002c2;
  if ((((piVar2 != (int *)0x0) && (0x2f < uVar3)) && (*(ulong *)(piVar2 + 10) < 0x20001)) &&
     (*(ulong *)(piVar2 + 10) + 0x30 <= uVar3)) {
    uVar4 = transactionSetPipePostCSCGammaVID(param_1,piVar2);
    uVar4 = uVar4 & 0xffffffff;
  }
  if (plVar1 != (long *)0x0) {
    (**(code **)(*plVar1 + 0x28))(plVar1);
  }
  return uVar4;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeUserClient2::s_copy_surface(IOAccelDisplayPipeUserClient2*, void*,
// IOExternalMethodArguments*)

ulong __cdecl
IOAccelDisplayPipeUserClient2::s_copy_surface
          (IOAccelDisplayPipeUserClient2 *param_1,undefined8 param_2,long param_3)

{
  ulong *puVar1;
  ulong uVar2;
  
  puVar1 = *(ulong **)(param_3 + 0x20);
  if ((((puVar1 != (ulong *)0x0) && (*(int *)(param_3 + 0x28) == 2)) && (*puVar1 >> 0x20 == 0)) &&
     (puVar1[1] >> 0x20 == 0)) {
    uVar2 = copySurface(param_1,*puVar1,(uint)puVar1[1]);
    return uVar2;
  }
  return 0xe00002c2;
}



// WARNING: Unknown calling convention: __cdecl
// IOAccelDisplayPipeUserClient2::s_triage(IOAccelDisplayPipeUserClient2*, void*,
// IOExternalMethodArguments*)

undefined4 __cdecl
IOAccelDisplayPipeUserClient2::s_triage
          (undefined8 param_1_00,undefined8 param_2,undefined8 param_3_00,undefined8 param_4,
          undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8,
          IOAccelDisplayPipeUserClient2 *param_9,undefined8 param_10,long param_11,
          undefined8 param_12,undefined8 param_13,undefined8 param_14)

{
  undefined4 uVar1;
  long *plVar2;
  long lVar3;
  undefined8 extraout_XMM0_Qa;
  long local_38;
  ulong local_30;
  
  plVar2 = *(long **)(param_11 + 0x68);
  lVar3 = *(long *)(param_11 + 0x58);
  local_30 = (ulong)*(uint *)(param_11 + 0x60);
  local_38 = lVar3;
  if (plVar2 == (long *)0x0) {
    plVar2 = (long *)0x0;
  }
  else {
    plVar2 = (long *)(**(code **)(*plVar2 + 0x200))(plVar2,0);
    if (plVar2 == (long *)0x0) {
      return 0xe00002c8;
    }
    lVar3 = (**(code **)(*plVar2 + 0x118))(plVar2);
    local_38 = lVar3;
    local_30 = (**(code **)(**(long **)(param_11 + 0x68) + 0x1c8))();
    param_1_00 = extraout_XMM0_Qa;
  }
  if (lVar3 == 0) {
    uVar1 = 0xe00002c2;
  }
  else {
    uVar1 = triage(param_1_00,param_2,param_3_00,param_4,param_5,param_6,param_7,param_8,param_9,
                   &local_38,&local_30,param_12,param_13,param_14);
  }
  if (plVar2 != (long *)0x0) {
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return uVar1;
}



// IOAccelDisplayPipeUserClient2::MetaClass::MetaClass()

void __thiscall IOAccelDisplayPipeUserClient2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDisplayPipeUserClient2",
             (OSMetaClass *)PTR_gMetaClass_0006b018,0x1a8);
  *(undefined ***)this = &PTR__MetaClass_00080438;
  return;
}



// IOAccelDisplayPipeUserClient2::MetaClass::~MetaClass()

void __thiscall IOAccelDisplayPipeUserClient2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelDisplayPipeUserClient2::IOAccelDisplayPipeUserClient2(OSMetaClass const*)

void __thiscall
IOAccelDisplayPipeUserClient2::IOAccelDisplayPipeUserClient2
          (IOAccelDisplayPipeUserClient2 *this,OSMetaClass *param_1)

{
  IOUserClient::IOUserClient((IOUserClient *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDisplayPipeUserClient2_0007fac0;
  return;
}



// IOAccelDisplayPipeUserClient2::IOAccelDisplayPipeUserClient2(OSMetaClass const*)

void __thiscall
IOAccelDisplayPipeUserClient2::IOAccelDisplayPipeUserClient2
          (IOAccelDisplayPipeUserClient2 *this,OSMetaClass *param_1)

{
  IOUserClient::IOUserClient((IOUserClient *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelDisplayPipeUserClient2_0007fac0;
  return;
}



// IOAccelDisplayPipeUserClient2::~IOAccelDisplayPipeUserClient2()

void __thiscall
IOAccelDisplayPipeUserClient2::~IOAccelDisplayPipeUserClient2(IOAccelDisplayPipeUserClient2 *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  return;
}



// IOAccelDisplayPipeUserClient2::~IOAccelDisplayPipeUserClient2()

void __thiscall
IOAccelDisplayPipeUserClient2::~IOAccelDisplayPipeUserClient2(IOAccelDisplayPipeUserClient2 *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  return;
}



// IOAccelDisplayPipeUserClient2::~IOAccelDisplayPipeUserClient2()

void __thiscall
IOAccelDisplayPipeUserClient2::~IOAccelDisplayPipeUserClient2(IOAccelDisplayPipeUserClient2 *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  _OSObject_typed_operator_delete(&IOAccelDisplayPipeUserClient2_ktv,this,0x1a8);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeUserClient2::operator delete(void*, unsigned long)

void __cdecl IOAccelDisplayPipeUserClient2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelDisplayPipeUserClient2_ktv,param_1,param_2);
  return;
}



// IOAccelDisplayPipeUserClient2::getMetaClass() const

undefined1 * IOAccelDisplayPipeUserClient2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelDisplayPipeUserClient2::MetaClass::MetaClass()

void __thiscall IOAccelDisplayPipeUserClient2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelDisplayPipeUserClient2",
             (OSMetaClass *)PTR_gMetaClass_0006b018,0x1a8);
  *(undefined ***)this = &PTR__MetaClass_00080438;
  return;
}



// IOAccelDisplayPipeUserClient2::MetaClass::alloc() const

IOUserClient * IOAccelDisplayPipeUserClient2::MetaClass::alloc(void)

{
  IOUserClient *this;
  
  this = (IOUserClient *)_OSObject_typed_operator_new(&IOAccelDisplayPipeUserClient2_ktv,0x1a8);
  IOUserClient::IOUserClient(this,(OSMetaClass *)&IOAccelDisplayPipeUserClient2::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipeUserClient2_0007fac0;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelDisplayPipeUserClient2::operator new(unsigned long)

void * __thiscall IOAccelDisplayPipeUserClient2::operator_new(IOAccelDisplayPipeUserClient2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelDisplayPipeUserClient2_ktv,this);
  return pvVar1;
}



// IOAccelDisplayPipeUserClient2::IOAccelDisplayPipeUserClient2()

void __thiscall
IOAccelDisplayPipeUserClient2::IOAccelDisplayPipeUserClient2(IOAccelDisplayPipeUserClient2 *this)

{
  IOUserClient::IOUserClient((IOUserClient *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipeUserClient2_0007fac0;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDisplayPipeUserClient2::IOAccelDisplayPipeUserClient2()

void __thiscall
IOAccelDisplayPipeUserClient2::IOAccelDisplayPipeUserClient2(IOAccelDisplayPipeUserClient2 *this)

{
  IOUserClient::IOUserClient((IOUserClient *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelDisplayPipeUserClient2_0007fac0;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelDisplayPipeUserClient2::init(OSDictionary*, task*)

undefined4 __thiscall
IOAccelDisplayPipeUserClient2::init
          (IOAccelDisplayPipeUserClient2 *this,undefined8 param_2_00,undefined8 param_2)

{
  undefined4 uVar1;
  
  uVar1 = (**(code **)(PTR_vtable_0006b088 + 600))();
  _task_reference(param_2);
  *(undefined8 *)(this + 0x188) = param_2;
  *(undefined4 *)(this + 0x138) = 0;
  *(undefined8 *)(this + 0x108) = 0;
  *(undefined4 *)(this + 0x180) = 1;
  *(undefined8 *)(this + 0x150) = 0;
  return uVar1;
}



// IOAccelDisplayPipeUserClient2::free()

void __thiscall IOAccelDisplayPipeUserClient2::free(IOAccelDisplayPipeUserClient2 *this)

{
  if (*(long *)(this + 0x188) != 0) {
    _task_deallocate();
  }
                    // WARNING: Could not recover jumptable at 0x00051db2. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b088 + 0xa0))(this);
  return;
}



// IOAccelDisplayPipeUserClient2::start(IOService*)

undefined8 __thiscall
IOAccelDisplayPipeUserClient2::start(IOAccelDisplayPipeUserClient2 *this,OSMetaClassBase *param_1)

{
  long lVar1;
  undefined8 uVar2;
  
  lVar1 = OSMetaClassBase::safeMetaCast(param_1,(OSMetaClass *)&IOGraphicsAccelerator2::gMetaClass);
  *(long *)(this + 0xd8) = lVar1;
  if (lVar1 != 0) {
    *(undefined8 *)(this + 0xe0) = *(undefined8 *)(lVar1 + 0x378);
    uVar2 = (**(code **)(PTR_vtable_0006b088 + 0x5d0))(this,param_1);
    if ((char)uVar2 != '\0') {
      this[400] = (IOAccelDisplayPipeUserClient2)0x1;
      *(undefined4 *)(this + 0x1a4) = 0xffffffff;
      return CONCAT71((int7)((ulong)uVar2 >> 8),1);
    }
  }
  return 0;
}



// IOAccelDisplayPipeUserClient2::attach(IOService*)

undefined8 __thiscall
IOAccelDisplayPipeUserClient2::attach(IOAccelDisplayPipeUserClient2 *this,OSMetaClassBase *param_1)

{
  char cVar1;
  long lVar2;
  
  cVar1 = (**(code **)(PTR_vtable_0006b088 + 0x680))();
  if (cVar1 != '\0') {
    lVar2 = OSMetaClassBase::safeMetaCast
                      (param_1,(OSMetaClass *)&IOGraphicsAccelerator2::gMetaClass);
    *(long *)(this + 0xd8) = lVar2;
    if (lVar2 != 0) {
      return CONCAT71((int7)((ulong)lVar2 >> 8),1);
    }
  }
  return 0;
}



// IOAccelDisplayPipeUserClient2::stop(IOService*)

void __thiscall
IOAccelDisplayPipeUserClient2::stop(IOAccelDisplayPipeUserClient2 *this,undefined8 param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  this[400] = (IOAccelDisplayPipeUserClient2)0x0;
  if (*(IOAccelDisplayPipe **)(this + 0xe8) != (IOAccelDisplayPipe *)0x0) {
    if (*(long *)(this + 0x108) != 0) {
      IOAccelDisplayPipe::remove_notify(*(IOAccelDisplayPipe **)(this + 0xe8),this + 0xf8);
    }
    if (*(long **)(this + 0x150) != (long *)0x0) {
      (**(code **)(**(long **)(this + 0x150) + 0x28))();
      *(undefined8 *)(this + 0x150) = 0;
    }
    IOAccelDisplayPipe::user_client_terminated(*(IOAccelDisplayPipe **)(this + 0xe8),(long)this);
    (**(code **)(**(long **)(this + 0xe8) + 0x28))();
    *(undefined8 *)(this + 0xe8) = 0;
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  (**(code **)(PTR_vtable_0006b088 + 0x5d8))(this,param_1);
  (**(code **)(*(long *)this + 0x678))(this,*(undefined8 *)(this + 0xd8));
                    // WARNING: Could not recover jumptable at 0x00051f95. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x28))(this);
  return;
}



// IOAccelDisplayPipeUserClient2::clientClose()

undefined8 __thiscall
IOAccelDisplayPipeUserClient2::clientClose(IOAccelDisplayPipeUserClient2 *this)

{
  IOGraphicsAccelerator2 *pIVar1;
  IOAccelDisplayPipeUserClient2 *pIVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  if (this[400] == (IOAccelDisplayPipeUserClient2)0x0) {
    if (pIVar1 != (IOGraphicsAccelerator2 *)0x0) {
      (**(code **)(*(long *)this + 0x678))(this,pIVar1);
    }
  }
  else {
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    if (*(IOAccelDisplayPipe **)(this + 0xe8) != (IOAccelDisplayPipe *)0x0) {
      pIVar2 = (IOAccelDisplayPipeUserClient2 *)
               IOAccelDisplayPipe::get_user_client(*(IOAccelDisplayPipe **)(this + 0xe8));
      if (pIVar2 == this) {
        IOAccelDisplayPipe::set_user_client(*(IOAccelDisplayPipe **)(this + 0xe8),0);
      }
    }
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
    (**(code **)(*(long *)this + 0x600))(this,0);
  }
  return 0;
}



// IOAccelDisplayPipeUserClient2::externalMethod(unsigned int, IOExternalMethodArguments*,
// IOExternalMethodDispatch*, OSObject*, void*)

void IOAccelDisplayPipeUserClient2::externalMethod(void)

{
                    // WARNING: Could not recover jumptable at 0x000520a6. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b088 + 0x860))();
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeUserClient2::sendAsyncResult64(unsigned long long*, int, unsigned long long*,
// unsigned int)

void __cdecl
IOAccelDisplayPipeUserClient2::sendAsyncResult64
          (ulonglong *param_1,int param_2,ulonglong *param_3,uint param_4)

{
  IOUserClient::sendAsyncResult64(param_1,param_2,param_3,param_4);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayPipeUserClient2::setAsyncReference64(unsigned long long*, ipc_port*, unsigned long
// long, unsigned long long)

void __cdecl
IOAccelDisplayPipeUserClient2::setAsyncReference64
          (ulonglong *param_1,ipc_port *param_2,ulonglong param_3,ulonglong param_4)

{
  IOUserClient::setAsyncReference64(param_1,param_2,param_3,param_4);
  return;
}



// IOAccelDisplayPipeUserClient2::setPipeIndex(unsigned int, unsigned long long*)

undefined8 __thiscall
IOAccelDisplayPipeUserClient2::setPipeIndex
          (IOAccelDisplayPipeUserClient2 *this,uint param_1,ulong *param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  uint uVar2;
  ulong uVar3;
  long lVar4;
  undefined8 uVar5;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  uVar2 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0xe0));
  uVar5 = 0xe00002c2;
  if (param_1 < uVar2) {
    if (*(IOAccelDisplayPipe **)(this + 0xe8) != (IOAccelDisplayPipe *)0x0) {
      IOAccelDisplayPipe::set_user_client(*(IOAccelDisplayPipe **)(this + 0xe8),0);
      (**(code **)(**(long **)(this + 0xe8) + 0x28))();
      *(undefined8 *)(this + 0xe8) = 0;
    }
    uVar5 = IOAccelDisplayMachine::getDisplayPipe(*(IOAccelDisplayMachine **)(this + 0xe0),param_1);
    *(undefined8 *)(this + 0xe8) = uVar5;
    uVar3 = doesEntitlementExist(this,"com.apple.private.hid.client.event-monitor");
    if ((char)uVar3 != '\0') {
      lVar4 = IOAccelDisplayPipe::get_user_client(*(IOAccelDisplayPipe **)(this + 0xe8));
      if (lVar4 == 0) {
        IOAccelDisplayPipe::set_user_client(*(IOAccelDisplayPipe **)(this + 0xe8),this);
        (**(code **)(**(long **)(this + 0xe8) + 0x20))();
        *(uint *)(this + 0x1a4) = param_1;
        *param_2 = (ulong)*(uint *)(*(long *)(this + 0xd8) + 0x178);
        uVar5 = 0;
        goto LAB_000521ea;
      }
    }
    *(undefined8 *)(this + 0xe8) = 0;
    uVar5 = 0xe00002c5;
  }
LAB_000521ea:
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar5;
}



// IOAccelDisplayPipeUserClient2::canUseDisplayPipe()

void __thiscall
IOAccelDisplayPipeUserClient2::canUseDisplayPipe(IOAccelDisplayPipeUserClient2 *this)

{
  doesEntitlementExist(this,"com.apple.private.hid.client.event-monitor");
  return;
}



// IOAccelDisplayPipeUserClient2::getDisplayModeScaler(IOAccelDisplayPipeScaler*)

undefined4 __thiscall
IOAccelDisplayPipeUserClient2::getDisplayModeScaler
          (IOAccelDisplayPipeUserClient2 *this,undefined8 param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  long *plVar2;
  undefined4 uVar3;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  plVar2 = *(long **)(this + 0xe8);
  if (plVar2 == (long *)0x0) {
    uVar3 = 0xe00002d9;
  }
  else {
    uVar3 = (**(code **)(*plVar2 + 0x8c0))(plVar2,param_1);
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar3;
}



// IOAccelDisplayPipeUserClient2::getCapabilitiesData(unsigned char*, unsigned long long*)

undefined8 __thiscall
IOAccelDisplayPipeUserClient2::getCapabilitiesData
          (IOAccelDisplayPipeUserClient2 *this,void *param_1,ulong *param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  char cVar2;
  uint uVar3;
  long *plVar4;
  long *plVar5;
  void *pvVar6;
  ulong uVar7;
  undefined8 uVar8;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  uVar8 = 0;
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (*(long **)(this + 0xe8) != (long *)0x0) {
    plVar4 = (long *)(**(code **)(**(long **)(this + 0xe8) + 0x8d0))();
    if (plVar4 != (long *)0x0) {
      plVar5 = (long *)OSSerialize::withCapacity((uint)*param_2);
      if (plVar5 == (long *)0x0) {
        uVar8 = 0xe00002bd;
      }
      else {
        (**(code **)(*plVar5 + 0x120))(plVar5);
        cVar2 = (**(code **)(*plVar4 + 0x30))(plVar4,plVar5);
        uVar8 = 0xe00002c7;
        if (cVar2 != '\0') {
          uVar3 = (**(code **)(*plVar5 + 0x158))(plVar5);
          uVar7 = (ulong)uVar3;
          uVar8 = 0xe00002db;
          if (uVar7 <= *param_2) {
            pvVar6 = (void *)(**(code **)(*plVar5 + 0x118))(plVar5);
            _memmove(param_1,pvVar6,uVar7);
            *param_2 = uVar7;
            uVar8 = 0;
          }
        }
        (**(code **)(*plVar5 + 0x28))(plVar5);
      }
      (**(code **)(*plVar4 + 0x28))(plVar4);
    }
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar8;
}



// IOAccelDisplayPipeUserClient2::requestNotify(unsigned long long*,
// IOAccelDisplayPipeRequestNotifyArgs*)

undefined4 __thiscall
IOAccelDisplayPipeUserClient2::requestNotify
          (IOAccelDisplayPipeUserClient2 *this,undefined8 param_1,long param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  undefined4 uVar2;
  IOAccelDisplayPipeUserClient2 *local_38;
  long local_30;
  
  local_38 = this + 0x140;
  if (*(int *)(param_2 + 0x10) == 0) {
    local_38 = this + 0xf8;
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  local_30 = param_2;
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (*(IOAccelDisplayPipe **)(this + 0xe8) == (IOAccelDisplayPipe *)0x0) {
    uVar2 = 0xe00002d9;
  }
  else {
    uVar2 = IOAccelDisplayPipe::request_notify
                      (*(IOAccelDisplayPipe **)(this + 0xe8),param_1,&local_38);
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2;
}



// IOAccelDisplayPipeUserClient2::transactionBegin(unsigned int*)

ulong __thiscall
IOAccelDisplayPipeUserClient2::transactionBegin
          (IOAccelDisplayPipeUserClient2 *this,undefined4 *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  uVar2 = 0xe00002d5;
  if (this[0x191] == (IOAccelDisplayPipeUserClient2)0x0) {
    if (*(IOAccelDisplayPipe **)(this + 0xe8) == (IOAccelDisplayPipe *)0x0) {
      uVar2 = 0xe00002d9;
    }
    else {
      uVar2 = IOAccelDisplayPipe::transaction_begin
                        (*(IOAccelDisplayPipe **)(this + 0xe8),this,param_1);
      uVar2 = uVar2 & 0xffffffff;
    }
    this[0x191] = (IOAccelDisplayPipeUserClient2)((int)uVar2 == 0);
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2;
}



// IOAccelDisplayPipeUserClient2::transactionSetPlaneGammaTable(IOAccelDisplayPipeGammaTableArgs*)

ulong __thiscall
IOAccelDisplayPipeUserClient2::transactionSetPlaneGammaTable
          (IOAccelDisplayPipeUserClient2 *this,int *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (this[0x191] == (IOAccelDisplayPipeUserClient2)0x0) {
    uVar2 = 0xe00002e2;
  }
  else if (*(IOAccelDisplayPipe **)(this + 0xe8) == (IOAccelDisplayPipe *)0x0) {
    uVar2 = 0xe00002d9;
  }
  else {
    uVar2 = IOAccelDisplayPipe::transaction_set_plane_gamma_table
                      (*(IOAccelDisplayPipe **)(this + 0xe8),param_1);
    uVar2 = uVar2 & 0xffffffff;
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2;
}



// IOAccelDisplayPipeUserClient2::transactionSetPipePreGammaTable(IOAccelDisplayPipeGammaTableArgs*)

ulong __thiscall
IOAccelDisplayPipeUserClient2::transactionSetPipePreGammaTable
          (IOAccelDisplayPipeUserClient2 *this,int *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (this[0x191] == (IOAccelDisplayPipeUserClient2)0x0) {
    uVar2 = 0xe00002e2;
  }
  else if (*(IOAccelDisplayPipe **)(this + 0xe8) == (IOAccelDisplayPipe *)0x0) {
    uVar2 = 0xe00002d9;
  }
  else {
    uVar2 = IOAccelDisplayPipe::transaction_set_pipe_pregamma_table
                      (*(IOAccelDisplayPipe **)(this + 0xe8),param_1);
    uVar2 = uVar2 & 0xffffffff;
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2;
}



// IOAccelDisplayPipeUserClient2::transactionSetPipePostGammaTable(IOAccelDisplayPipeGammaTableArgs*)

ulong __thiscall
IOAccelDisplayPipeUserClient2::transactionSetPipePostGammaTable
          (IOAccelDisplayPipeUserClient2 *this,int *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (this[0x191] == (IOAccelDisplayPipeUserClient2)0x0) {
    uVar2 = 0xe00002e2;
  }
  else if (*(IOAccelDisplayPipe **)(this + 0xe8) == (IOAccelDisplayPipe *)0x0) {
    uVar2 = 0xe00002d9;
  }
  else {
    uVar2 = IOAccelDisplayPipe::transaction_set_pipe_postgamma_table
                      (*(IOAccelDisplayPipe **)(this + 0xe8),param_1);
    uVar2 = uVar2 & 0xffffffff;
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2;
}



// IOAccelDisplayPipeUserClient2::transactionSetPipePreCSCLinearizationVID(IOAccelDisplayPipePreCSCLinearizationArgs*)

ulong __thiscall
IOAccelDisplayPipeUserClient2::transactionSetPipePreCSCLinearizationVID
          (IOAccelDisplayPipeUserClient2 *this,int *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (this[0x191] == (IOAccelDisplayPipeUserClient2)0x0) {
    uVar2 = 0xe00002e2;
  }
  else if (*(IOAccelDisplayPipe **)(this + 0xe8) == (IOAccelDisplayPipe *)0x0) {
    uVar2 = 0xe00002d9;
  }
  else {
    uVar2 = IOAccelDisplayPipe::transaction_set_pipe_precsclinearization_vid
                      (*(IOAccelDisplayPipe **)(this + 0xe8),param_1);
    uVar2 = uVar2 & 0xffffffff;
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2;
}



// IOAccelDisplayPipeUserClient2::transactionSetPipePostCSCGammaVID(IOAccelDisplayPipePostCSCGammaTableArgs*)

ulong __thiscall
IOAccelDisplayPipeUserClient2::transactionSetPipePostCSCGammaVID
          (IOAccelDisplayPipeUserClient2 *this,int *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (this[0x191] == (IOAccelDisplayPipeUserClient2)0x0) {
    uVar2 = 0xe00002e2;
  }
  else if (*(IOAccelDisplayPipe **)(this + 0xe8) == (IOAccelDisplayPipe *)0x0) {
    uVar2 = 0xe00002d9;
  }
  else {
    uVar2 = IOAccelDisplayPipe::transaction_set_pipe_postcscgamma_vid
                      (*(IOAccelDisplayPipe **)(this + 0xe8),param_1);
    uVar2 = uVar2 & 0xffffffff;
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2;
}



// IOAccelDisplayPipeUserClient2::transactionEnd(IOAccelDisplayPipeTransactionArgs*)

int __thiscall
IOAccelDisplayPipeUserClient2::transactionEnd(IOAccelDisplayPipeUserClient2 *this,ulong *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  bool bVar2;
  int iVar3;
  IOAccelDisplayPipe *this_00;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  iVar3 = -0x1ffffd1e;
  if (this[0x191] != (IOAccelDisplayPipeUserClient2)0x0) {
    do {
      this_00 = *(IOAccelDisplayPipe **)(this + 0xe8);
      if (this_00 == (IOAccelDisplayPipe *)0x0) {
        iVar3 = -0x1ffffd27;
        goto LAB_00052b6d;
      }
      if (this_00[0x299] != (IOAccelDisplayPipe)0x0) {
        iVar3 = -0x1ffffd1d;
LAB_00052b84:
        this[0x191] = (IOAccelDisplayPipeUserClient2)0x0;
        IOAccelDisplayPipe::transaction_abort(this_00,(int)param_1[2]);
        goto LAB_00052b9a;
      }
      if (this_00[0x280] != (IOAccelDisplayPipe)0x0) {
        iVar3 = -0x1ffffd29;
        goto LAB_00052b84;
      }
      iVar3 = -0x1ffffd28;
      if (((*(byte *)(*(long *)(this + 0xd8) + 0xc78) & 2) == 0) ||
         (this_00[0x282] != (IOAccelDisplayPipe)0x0)) goto LAB_00052b84;
      bVar2 = IOAccelDisplayPipe::isActive(this_00);
      this_00 = *(IOAccelDisplayPipe **)(this + 0xe8);
      if (!bVar2) goto LAB_00052b84;
      if (*(int *)(this_00 + 0x23c) - *(int *)(this_00 + 0x238) != 4) {
        this[0x191] = (IOAccelDisplayPipeUserClient2)0x0;
        iVar3 = IOAccelDisplayPipe::transaction_end(this_00,this,param_1);
        goto LAB_00052b9a;
      }
      (**(code **)(*(long *)this_00 + 0x20))(this_00);
      pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
      (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
      IOGraphicsAccelerator2::unlock_busy(pIVar1);
      _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
      IOAccelDisplayPipe::wait_for_queue_slot_nolock(this_00);
      pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
      _OSIncrementAtomic(pIVar1 + 0x90);
      _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
      _OSDecrementAtomic(pIVar1 + 0x90);
      IOGraphicsAccelerator2::lock_busy(pIVar1);
      (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
      (**(code **)(*(long *)this_00 + 0x28))(this_00);
    } while (this[0x191] != (IOAccelDisplayPipeUserClient2)0x0);
    iVar3 = -0x1ffffd1e;
  }
LAB_00052b6d:
  this[0x191] = (IOAccelDisplayPipeUserClient2)0x0;
LAB_00052b9a:
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return iVar3;
}



// IOAccelDisplayPipeUserClient2::transactionWait(IOAccelDisplayPipeTransactionWaitArgs*)

ulong __thiscall
IOAccelDisplayPipeUserClient2::transactionWait(IOAccelDisplayPipeUserClient2 *this,int *param_1)

{
  IOGraphicsAccelerator2 *pIVar1;
  long lVar2;
  IOAccelDisplayPipe *pIVar3;
  ulong uVar4;
  
  if ((*(byte *)(param_1 + 1) & 8) == 0) {
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
    _OSIncrementAtomic(pIVar1 + 0x90);
    _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
    _OSDecrementAtomic(pIVar1 + 0x90);
    IOGraphicsAccelerator2::lock_busy(pIVar1);
    (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
    pIVar3 = *(IOAccelDisplayPipe **)(this + 0xe8);
    if (pIVar3 == (IOAccelDisplayPipe *)0x0) {
      uVar4 = 0xe00002d9;
    }
    else {
      uVar4 = 0xe00002c2;
      if (*param_1 <= *(int *)(pIVar3 + 0x288)) {
        lVar2 = IOAccelDisplayPipe::find_temp_transaction(pIVar3,*param_1);
        uVar4 = 0xe00002d8;
        if (lVar2 == 0) {
          pIVar3 = *(IOAccelDisplayPipe **)(this + 0xe8);
          (**(code **)(*(long *)pIVar3 + 0x20))(pIVar3);
          pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
          (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
          IOGraphicsAccelerator2::unlock_busy(pIVar1);
          _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
          uVar4 = IOAccelDisplayPipe::transaction_wait_nolock(pIVar3,param_1);
          uVar4 = uVar4 & 0xffffffff;
          pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
          _OSIncrementAtomic(pIVar1 + 0x90);
          _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
          _OSDecrementAtomic(pIVar1 + 0x90);
          IOGraphicsAccelerator2::lock_busy(pIVar1);
          (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
          (**(code **)(*(long *)pIVar3 + 0x28))(pIVar3);
        }
      }
    }
    pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
    (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
    IOGraphicsAccelerator2::unlock_busy(pIVar1);
    _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  }
  else {
    pIVar3 = (IOAccelDisplayPipe *)getDisplayPipeNoLock(this);
    if (pIVar3 != (IOAccelDisplayPipe *)0x0) {
      uVar4 = IOAccelDisplayPipe::transaction_wait_nolock(pIVar3,param_1);
      return uVar4;
    }
    uVar4 = 0xe00002d9;
  }
  return uVar4;
}



// IOAccelDisplayPipeUserClient2::getDisplayPipeNoLock()

undefined8 __thiscall
IOAccelDisplayPipeUserClient2::getDisplayPipeNoLock(IOAccelDisplayPipeUserClient2 *this)

{
  uint uVar1;
  uint uVar2;
  undefined8 uVar3;
  
  uVar1 = *(uint *)(this + 0x1a4);
  uVar2 = IOAccelDisplayMachine::getFramebufferCount(*(IOAccelDisplayMachine **)(this + 0xe0));
  if (uVar1 < uVar2) {
    uVar3 = IOAccelDisplayMachine::getDisplayPipe(*(IOAccelDisplayMachine **)(this + 0xe0),uVar1);
    return uVar3;
  }
  return 0;
}



// IOAccelDisplayPipeUserClient2::triage(char**, unsigned long long*)

void __thiscall
IOAccelDisplayPipeUserClient2::triage
          (undefined8 param_1_00,undefined8 param_2_00,undefined8 param_3,undefined8 param_4,
          undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8,
          IOAccelDisplayPipeUserClient2 *this,long *param_10,size_t *param_11,undefined8 param_12,
          undefined8 param_13,undefined8 param_14)

{
  long *plVar1;
  undefined8 extraout_XMM0_Qa;
  
  plVar1 = (long *)getDisplayPipeNoLock(this);
  if (plVar1 != (long *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00052e16. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(*plVar1 + 0x938))(plVar1,param_10,param_11,*(code **)(*plVar1 + 0x938));
    return;
  }
  glkBfLog(extraout_XMM0_Qa,param_2_00,param_3,param_4,param_5,param_6,param_7,param_8,param_10,
           param_11,"fDisplayPipe is null\n",param_12,param_13,param_14);
  return;
}



// IOAccelDisplayPipeUserClient2::copySurface(unsigned int, unsigned int)

ulong __thiscall
IOAccelDisplayPipeUserClient2::copySurface
          (IOAccelDisplayPipeUserClient2 *this,ulong param_2_00,uint param_2)

{
  IOGraphicsAccelerator2 *pIVar1;
  ulong uVar2;
  
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  _OSIncrementAtomic(pIVar1 + 0x90);
  _IOLockLock(*(undefined8 *)(pIVar1 + 0x88));
  _OSDecrementAtomic(pIVar1 + 0x90);
  IOGraphicsAccelerator2::lock_busy(pIVar1);
  (**(code **)(*(long *)pIVar1 + 0x850))(pIVar1,"",0);
  if (*(IOAccelDisplayPipe **)(this + 0xe8) == (IOAccelDisplayPipe *)0x0) {
    uVar2 = 0xe00002d9;
  }
  else {
    uVar2 = IOAccelDisplayPipe::copySurface
                      (*(IOAccelDisplayPipe **)(this + 0xe8),(task *)(param_2_00 & 0xffffffff),
                       param_2);
    uVar2 = uVar2 & 0xffffffff;
  }
  pIVar1 = *(IOGraphicsAccelerator2 **)(this + 0xd8);
  (**(code **)(*(long *)pIVar1 + 0x858))(pIVar1,"",0);
  IOGraphicsAccelerator2::unlock_busy(pIVar1);
  _IOLockUnlock(*(undefined8 *)(pIVar1 + 0x88));
  return uVar2;
}



// IOAccelDisplayPipeUserClient2::doesEntitlementExist(char const*)

ulong __thiscall
IOAccelDisplayPipeUserClient2::doesEntitlementExist
          (IOAccelDisplayPipeUserClient2 *this,char *param_1)

{
  uint uVar1;
  OSMetaClassBase *pOVar2;
  long *plVar3;
  undefined8 unaff_R14;
  ulong uVar4;
  
  pOVar2 = (OSMetaClassBase *)IOUserClient::copyClientEntitlement(*(task **)(this + 0x188),param_1);
  if (pOVar2 == (OSMetaClassBase *)0x0) {
    uVar4 = 0;
  }
  else {
    plVar3 = (long *)OSMetaClassBase::safeMetaCast(pOVar2,*(OSMetaClass **)PTR_metaClass_0006b080);
    if (plVar3 == (long *)0x0) {
      uVar4 = CONCAT71((int7)((ulong)unaff_R14 >> 8),1);
    }
    else {
      uVar1 = (**(code **)(*plVar3 + 0x128))(plVar3);
      uVar4 = (ulong)uVar1;
    }
    (**(code **)(*(long *)pOVar2 + 0x28))(pOVar2);
  }
  return uVar4 & 0xffffffff;
}



// WARNING: Unknown calling convention: __cdecl
// glkBfLog(char**, unsigned long long*, char const*, ...)

undefined8 __cdecl
glkBfLog(undefined8 param_1_00,undefined8 param_2_00,undefined8 param_3_00,undefined8 param_4,
        undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8,long *param_9,
        size_t *param_10,char *param_11,undefined8 param_12,undefined8 param_13,undefined8 param_14,
        ...)

{
  ulong uVar1;
  char in_AL;
  int iVar2;
  undefined8 uVar3;
  ulong uVar4;
  undefined1 local_e8 [24];
  undefined8 local_d0;
  undefined8 local_c8;
  undefined8 local_c0;
  undefined8 local_b8;
  undefined8 local_a8;
  undefined8 local_98;
  undefined8 local_88;
  undefined8 local_78;
  undefined8 local_68;
  undefined8 local_58;
  undefined8 local_48;
  undefined8 local_38;
  undefined1 *local_30;
  undefined1 *local_28;
  long local_20;
  
  if (in_AL != '\0') {
    local_b8 = param_1_00;
    local_a8 = param_2_00;
    local_98 = param_3_00;
    local_88 = param_4;
    local_78 = param_5;
    local_68 = param_6;
    local_58 = param_7;
    local_48 = param_8;
  }
  local_20 = *(long *)PTR____stack_chk_guard_0006b0b0;
  local_d0 = param_12;
  local_c8 = param_13;
  local_c0 = param_14;
  if (*param_10 == 0) {
    uVar3 = 0xe00002db;
  }
  else {
    local_38 = 0x3000000018;
    local_30 = &stack0x00000008;
    local_28 = local_e8;
    iVar2 = _vsnprintf((char *)*param_9,*param_10,param_11,&local_38);
    uVar4 = (ulong)iVar2;
    uVar1 = *param_10;
    uVar3 = 0xe00002db;
    if (uVar4 < uVar1) {
      uVar3 = 0;
    }
    if (uVar1 < uVar4) {
      uVar4 = uVar1;
    }
    *param_10 = uVar1 - uVar4;
    *param_9 = *param_9 + uVar4;
  }
  if (*(long *)PTR____stack_chk_guard_0006b0b0 == local_20) {
    return uVar3;
  }
                    // WARNING: Subroutine does not return
  ___stack_chk_fail();
}



// IOAccelDisplayPipeUserClient2::MetaClass::~MetaClass()

void __thiscall IOAccelDisplayPipeUserClient2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelDisplayPipeUserClient_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelDisplayPipeUserClient2::gMetaClass,
             "IOAccelDisplayPipeUserClient2",(OSMetaClass *)PTR_gMetaClass_0006b018,0x1a8);
  _gMetaClass = &PTR__MetaClass_00080438;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelDisplayPipeUserClient2::gMetaClass);
  return;
}



// IOAccelMemoryInfoUserClient::MetaClass::MetaClass()

void __thiscall IOAccelMemoryInfoUserClient::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelMemoryInfoUserClient",
             (OSMetaClass *)PTR_gMetaClass_0006b018,0xe8);
  *(undefined ***)this = &PTR__MetaClass_00080ea8;
  return;
}



// IOAccelMemoryInfoUserClient::MetaClass::~MetaClass()

void __thiscall IOAccelMemoryInfoUserClient::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelMemoryInfoUserClient::IOAccelMemoryInfoUserClient(OSMetaClass const*)

void __thiscall
IOAccelMemoryInfoUserClient::IOAccelMemoryInfoUserClient
          (IOAccelMemoryInfoUserClient *this,OSMetaClass *param_1)

{
  IOUserClient::IOUserClient((IOUserClient *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelMemoryInfoUserClient_00080530;
  return;
}



// IOAccelMemoryInfoUserClient::IOAccelMemoryInfoUserClient(OSMetaClass const*)

void __thiscall
IOAccelMemoryInfoUserClient::IOAccelMemoryInfoUserClient
          (IOAccelMemoryInfoUserClient *this,OSMetaClass *param_1)

{
  IOUserClient::IOUserClient((IOUserClient *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelMemoryInfoUserClient_00080530;
  return;
}



// IOAccelMemoryInfoUserClient::~IOAccelMemoryInfoUserClient()

void __thiscall
IOAccelMemoryInfoUserClient::~IOAccelMemoryInfoUserClient(IOAccelMemoryInfoUserClient *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  return;
}



// IOAccelMemoryInfoUserClient::~IOAccelMemoryInfoUserClient()

void __thiscall
IOAccelMemoryInfoUserClient::~IOAccelMemoryInfoUserClient(IOAccelMemoryInfoUserClient *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  return;
}



// IOAccelMemoryInfoUserClient::~IOAccelMemoryInfoUserClient()

void __thiscall
IOAccelMemoryInfoUserClient::~IOAccelMemoryInfoUserClient(IOAccelMemoryInfoUserClient *this)

{
  IOUserClient::~IOUserClient((IOUserClient *)this);
  _OSObject_typed_operator_delete(&IOAccelMemoryInfoUserClient_ktv,this,0xe8);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelMemoryInfoUserClient::operator delete(void*, unsigned long)

void __cdecl IOAccelMemoryInfoUserClient::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelMemoryInfoUserClient_ktv,param_1,param_2);
  return;
}



// IOAccelMemoryInfoUserClient::getMetaClass() const

undefined1 * IOAccelMemoryInfoUserClient::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelMemoryInfoUserClient::MetaClass::MetaClass()

void __thiscall IOAccelMemoryInfoUserClient::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelMemoryInfoUserClient",
             (OSMetaClass *)PTR_gMetaClass_0006b018,0xe8);
  *(undefined ***)this = &PTR__MetaClass_00080ea8;
  return;
}



// IOAccelMemoryInfoUserClient::MetaClass::alloc() const

IOUserClient * IOAccelMemoryInfoUserClient::MetaClass::alloc(void)

{
  IOUserClient *this;
  
  this = (IOUserClient *)_OSObject_typed_operator_new(&IOAccelMemoryInfoUserClient_ktv,0xe8);
  IOUserClient::IOUserClient(this,(OSMetaClass *)&IOAccelMemoryInfoUserClient::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelMemoryInfoUserClient_00080530;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelMemoryInfoUserClient::operator new(unsigned long)

void * __thiscall IOAccelMemoryInfoUserClient::operator_new(IOAccelMemoryInfoUserClient *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelMemoryInfoUserClient_ktv,this);
  return pvVar1;
}



// IOAccelMemoryInfoUserClient::IOAccelMemoryInfoUserClient()

void __thiscall
IOAccelMemoryInfoUserClient::IOAccelMemoryInfoUserClient(IOAccelMemoryInfoUserClient *this)

{
  IOUserClient::IOUserClient((IOUserClient *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelMemoryInfoUserClient_00080530;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelMemoryInfoUserClient::IOAccelMemoryInfoUserClient()

void __thiscall
IOAccelMemoryInfoUserClient::IOAccelMemoryInfoUserClient(IOAccelMemoryInfoUserClient *this)

{
  IOUserClient::IOUserClient((IOUserClient *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelMemoryInfoUserClient_00080530;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelMemoryInfoUserClient::init()

void __thiscall IOAccelMemoryInfoUserClient::init(IOAccelMemoryInfoUserClient *this)

{
  char cVar1;
  
  cVar1 = (**(code **)(PTR_vtable_0006b088 + 0x98))();
  if (cVar1 != '\0') {
    this[0xd8] = (IOAccelMemoryInfoUserClient)0x0;
  }
  return;
}



// IOAccelMemoryInfoUserClient::free()

void IOAccelMemoryInfoUserClient::free(void)

{
                    // WARNING: Could not recover jumptable at 0x00053282. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b088 + 0xa0))();
  return;
}



// IOAccelMemoryInfoUserClient::start(IOService*)

undefined8 __thiscall
IOAccelMemoryInfoUserClient::start(IOAccelMemoryInfoUserClient *this,OSMetaClassBase *param_1)

{
  long lVar1;
  undefined8 uVar2;
  
  this[0xd8] = (IOAccelMemoryInfoUserClient)0x1;
  lVar1 = OSMetaClassBase::safeMetaCast(param_1,(OSMetaClass *)&IOGraphicsAccelerator2::gMetaClass);
  *(long *)(this + 0xe0) = lVar1;
  if (lVar1 != 0) {
                    // WARNING: Could not recover jumptable at 0x000532cb. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar2 = (**(code **)(PTR_vtable_0006b088 + 0x5d0))(this,param_1);
    return uVar2;
  }
  return 0;
}



// IOAccelMemoryInfoUserClient::stop(IOService*)

void __thiscall
IOAccelMemoryInfoUserClient::stop(IOAccelMemoryInfoUserClient *this,undefined8 param_1)

{
  this[0xd8] = (IOAccelMemoryInfoUserClient)0x0;
  (**(code **)(PTR_vtable_0006b088 + 0x5d8))();
  (**(code **)(*(long *)this + 0x678))(this,param_1);
                    // WARNING: Could not recover jumptable at 0x00053312. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x28))(this);
  return;
}



// IOAccelMemoryInfoUserClient::clientClose()

undefined8 __thiscall IOAccelMemoryInfoUserClient::clientClose(IOAccelMemoryInfoUserClient *this)

{
  if (this[0xd8] != (IOAccelMemoryInfoUserClient)0x0) {
    (**(code **)(*(long *)this + 0x600))(this,0);
  }
  return 0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelMemoryInfoUserClient::externalMethod(unsigned int, IOExternalMethodArguments*,
// IOExternalMethodDispatch*, OSObject*, void*)

undefined8 __cdecl IOAccelMemoryInfoUserClient::externalMethod(undefined8 param_1,uint param_2)

{
  undefined8 uVar1;
  
  if (2 < param_2) {
    return 0xe00002c2;
  }
                    // WARNING: Could not recover jumptable at 0x00053361. Too many branches
                    // WARNING: Treating indirect jump as call
  uVar1 = (**(code **)(PTR_vtable_0006b088 + 0x860))();
  return uVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelMemoryInfoUserClient::s_gather_memory_data(OSObject*, void*, IOExternalMethodArguments*)

ulong __cdecl
IOAccelMemoryInfoUserClient::s_gather_memory_data
          (OSMetaClassBase *param_1,undefined8 param_2,long param_3)

{
  undefined8 uVar1;
  long *plVar2;
  void *pvVar3;
  IOAccelMemoryInfoUserClient *this;
  uint uVar4;
  ulong uVar5;
  undefined8 local_38;
  
  uVar1 = s_allowed_to_gather();
  uVar5 = 0xe00002c1;
  if ((int)uVar1 == 0) {
    uVar4 = *(uint *)(param_3 + 0x70);
    if (uVar4 == 0) {
      uVar4 = *(uint *)(param_3 + 0x60);
      pvVar3 = *(void **)(param_3 + 0x58);
      plVar2 = (long *)0x0;
    }
    else {
      plVar2 = (long *)(**(code **)(**(long **)(param_3 + 0x68) + 0x200))
                                 (*(long **)(param_3 + 0x68),0);
      if (plVar2 == (long *)0x0) {
        return 0xe00002be;
      }
      pvVar3 = (void *)(**(code **)(*plVar2 + 0x118))(plVar2);
    }
    local_38 = 0;
    this = (IOAccelMemoryInfoUserClient *)
           OSMetaClassBase::safeMetaCast(param_1,(OSMetaClass *)&gMetaClass);
    if (this == (IOAccelMemoryInfoUserClient *)0x0) {
      uVar5 = 0xe00002c2;
    }
    else {
      uVar5 = gather_memory_data(this,uVar4,(undefined4 *)&local_38,
                                 (undefined4 *)((long)&local_38 + 4),pvVar3);
      uVar5 = uVar5 & 0xffffffff;
    }
    if (plVar2 == (long *)0x0) {
      *(undefined4 *)(param_3 + 0x60) = local_38._4_4_;
    }
    else {
      (**(code **)(*plVar2 + 0x28))(plVar2);
      *(undefined4 *)(param_3 + 0x70) = local_38._4_4_;
    }
    **(ulong **)(param_3 + 0x48) = local_38 & 0xffffffff;
  }
  return uVar5;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelMemoryInfoUserClient::s_gather_memory_data_totals(OSObject*, void*,
// IOExternalMethodArguments*)

undefined8 __cdecl
IOAccelMemoryInfoUserClient::s_gather_memory_data_totals
          (OSMetaClassBase *param_1,undefined8 param_2,long param_3)

{
  undefined8 uVar1;
  undefined8 uVar2;
  IOAccelMemoryInfoUserClient *this;
  
  uVar1 = s_allowed_to_gather();
  uVar2 = 0xe00002c1;
  if ((int)uVar1 == 0) {
    this = (IOAccelMemoryInfoUserClient *)
           OSMetaClassBase::safeMetaCast(param_1,(OSMetaClass *)&gMetaClass);
    if (this != (IOAccelMemoryInfoUserClient *)0x0) {
      uVar1 = gather_memory_data_totals
                        (this,0,(undefined4 *)(param_3 + 0x60),*(long *)(param_3 + 0x58));
      return uVar1;
    }
    uVar2 = 0xe00002c2;
  }
  return uVar2;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelMemoryInfoUserClient::s_purge_all_vid_memory(OSObject*, void*, IOExternalMethodArguments*)

undefined8 __cdecl IOAccelMemoryInfoUserClient::s_purge_all_vid_memory(OSMetaClassBase *param_1)

{
  undefined8 uVar1;
  undefined8 uVar2;
  IOAccelMemoryInfoUserClient *this;
  
  uVar1 = s_allowed_to_gather();
  uVar2 = 0xe00002c1;
  if ((int)uVar1 == 0) {
    this = (IOAccelMemoryInfoUserClient *)
           OSMetaClassBase::safeMetaCast(param_1,(OSMetaClass *)&gMetaClass);
    if (this != (IOAccelMemoryInfoUserClient *)0x0) {
      uVar1 = purge_all_vid_memory(this);
      return uVar1;
    }
    uVar2 = 0xe00002c2;
  }
  return uVar2;
}



// IOAccelMemoryInfoUserClient::s_allowed_to_gather()

undefined8 IOAccelMemoryInfoUserClient::s_allowed_to_gather(void)

{
  task *ptVar1;
  long *plVar2;
  undefined8 uVar3;
  
  ptVar1 = (task *)_current_task();
  plVar2 = (long *)IOUserClient::copyClientEntitlement(ptVar1,"com.apple.private.ioaccelmemoryinfo")
  ;
  if (plVar2 == (long *)0x0) {
    uVar3 = 0xe00002c1;
  }
  else {
    uVar3 = 0xe00002c1;
    if (plVar2 == (long *)**(long **)PTR__kOSBooleanTrue_0006b0f0) {
      uVar3 = 0;
    }
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return uVar3;
}



// IOAccelMemoryInfoUserClient::gather_memory_data(unsigned int, unsigned int*, unsigned int*,
// void*)

undefined8 __thiscall
IOAccelMemoryInfoUserClient::gather_memory_data
          (IOAccelMemoryInfoUserClient *this,uint param_1,undefined4 *param_2,undefined4 *param_3,
          void *param_4)

{
  IOGraphicsAccelerator2 *this_00;
  bool bVar1;
  char cVar2;
  undefined4 uVar3;
  uint uVar4;
  long *plVar5;
  long *plVar6;
  void *pvVar7;
  undefined8 uVar8;
  
  *param_3 = 0;
  bVar1 = lock_with_timeout(this,2000);
  uVar8 = 0xe00002cc;
  if (bVar1) {
    plVar5 = IOGraphicsAccelerator2::createAllocationList(*(long **)(this + 0xe0));
    this_00 = *(IOGraphicsAccelerator2 **)(this + 0xe0);
    (**(code **)(*(long *)this_00 + 0x858))(this_00,"",0);
    IOGraphicsAccelerator2::unlock_busy(this_00);
    _IOLockUnlock(*(undefined8 *)(this_00 + 0x88));
    plVar6 = (long *)OSSerialize::binaryWithCapacity(param_1,(void *)0x0,(void *)0x0);
    (**(code **)(*plVar6 + 0x120))(plVar6);
    if (plVar5 == (long *)0x0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to serialize memory data\n"
                        ,
                        "IOReturn IOAccelMemoryInfoUserClient::gather_memory_data(uint32_t, uint32_t *, uint32_t *, void *)"
                       );
      uVar8 = 0xe00002be;
    }
    else {
      cVar2 = (**(code **)(*plVar5 + 0x30))(plVar5,plVar6);
      uVar8 = 0xe00002be;
      if (cVar2 != '\0') {
        uVar3 = (**(code **)(*plVar6 + 0x158))(plVar6);
        *param_2 = uVar3;
        uVar4 = (**(code **)(*plVar6 + 0x158))(plVar6);
        uVar8 = 0;
        if (uVar4 <= param_1) {
          uVar3 = (**(code **)(*plVar6 + 0x158))(plVar6);
          *param_3 = uVar3;
          pvVar7 = (void *)(**(code **)(*plVar6 + 0x118))(plVar6);
          uVar4 = (**(code **)(*plVar6 + 0x158))(plVar6);
          _memmove(param_4,pvVar7,(ulong)uVar4);
        }
      }
      (**(code **)(*plVar5 + 0x28))(plVar5);
    }
    (**(code **)(*plVar6 + 0x28))(plVar6);
  }
  return uVar8;
}



// IOAccelMemoryInfoUserClient::gather_memory_data_totals(OSDictionary*, unsigned int*,
// IOAccelMemoryInfoAllocTotals*)

undefined8 __thiscall
IOAccelMemoryInfoUserClient::gather_memory_data_totals
          (IOAccelMemoryInfoUserClient *this,undefined8 param_1,undefined4 *param_2,long param_3)

{
  IOGraphicsAccelerator2 *this_00;
  bool bVar1;
  undefined8 uVar2;
  
  bVar1 = lock_with_timeout(this,2000);
  uVar2 = 0xe00002cc;
  if (bVar1) {
    IOGraphicsAccelerator2::createAllocationListTotals
              (*(IOGraphicsAccelerator2 **)(this + 0xe0),param_1,param_3);
    this_00 = *(IOGraphicsAccelerator2 **)(this + 0xe0);
    uVar2 = 0;
    (**(code **)(*(long *)this_00 + 0x858))(this_00,"",0);
    IOGraphicsAccelerator2::unlock_busy(this_00);
    _IOLockUnlock(*(undefined8 *)(this_00 + 0x88));
    *param_2 = 0x70;
  }
  return uVar2;
}



// IOAccelMemoryInfoUserClient::purge_all_vid_memory()

undefined8 __thiscall
IOAccelMemoryInfoUserClient::purge_all_vid_memory(IOAccelMemoryInfoUserClient *this)

{
  IOGraphicsAccelerator2 *this_00;
  bool bVar1;
  undefined8 uVar2;
  
  bVar1 = lock_with_timeout(this,2000);
  uVar2 = 0xe00002cc;
  if (bVar1) {
    (**(code **)(**(long **)(this + 0xe0) + 0x948))();
    (**(code **)(**(long **)(this + 0xe0) + 0x978))();
    this_00 = *(IOGraphicsAccelerator2 **)(this + 0xe0);
    uVar2 = 0;
    (**(code **)(*(long *)this_00 + 0x858))(this_00,"",0);
    IOGraphicsAccelerator2::unlock_busy(this_00);
    _IOLockUnlock(*(undefined8 *)(this_00 + 0x88));
  }
  return uVar2;
}



// IOAccelMemoryInfoUserClient::lock_with_timeout(unsigned long long)

bool __thiscall
IOAccelMemoryInfoUserClient::lock_with_timeout(IOAccelMemoryInfoUserClient *this,long param_1)

{
  IOGraphicsAccelerator2 *this_00;
  int iVar1;
  uint64_t uVar2;
  uintptr_t arg1;
  uint64_t uVar3;
  
  uVar2 = _mach_absolute_time();
  do {
    this_00 = *(IOGraphicsAccelerator2 **)(this + 0xe0);
    iVar1 = _IOLockTryLock(*(undefined8 *)(this_00 + 0x88));
    if (iVar1 != 0) {
      IOGraphicsAccelerator2::lock_busy(this_00);
      (**(code **)(*(long *)this_00 + 0x850))(this_00,"",0);
      _mach_absolute_time();
      break;
    }
    if (___ktrace_kernel_enabled != 0) {
      arg1 = IORegistryEntry::getRegistryEntryID();
      _kernel_debug(0x8512001c,arg1,0,0,0,0);
    }
    uVar3 = _mach_absolute_time();
  } while (uVar3 < param_1 * 1000000 + uVar2);
  return iVar1 != 0;
}



// IOAccelMemoryInfoUserClient::MetaClass::~MetaClass()

void __thiscall IOAccelMemoryInfoUserClient::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelMemoryInfoUserClient_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelMemoryInfoUserClient::gMetaClass,"IOAccelMemoryInfoUserClient",
             (OSMetaClass *)PTR_gMetaClass_0006b018,0xe8);
  _gMetaClass = &PTR__MetaClass_00080ea8;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelMemoryInfoUserClient::gMetaClass);
  return;
}



// IOAccelMemoryMap::MetaClass::MetaClass()

void __thiscall IOAccelMemoryMap::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelMemoryMap",(OSMetaClass *)PTR_gMetaClass_0006b068,0x118);
  *(undefined ***)this = &PTR__MetaClass_000811c8;
  return;
}



// IOAccelMemoryMap::MetaClass::~MetaClass()

void __thiscall IOAccelMemoryMap::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelMemoryMap::IOAccelMemoryMap(OSMetaClass const*)

void __thiscall IOAccelMemoryMap::IOAccelMemoryMap(IOAccelMemoryMap *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelMemoryMap_00080fe8;
  return;
}



// IOAccelMemoryMap::~IOAccelMemoryMap()

void __thiscall IOAccelMemoryMap::~IOAccelMemoryMap(IOAccelMemoryMap *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelMemoryMap::~IOAccelMemoryMap()

void __thiscall IOAccelMemoryMap::~IOAccelMemoryMap(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelMemoryMap::~IOAccelMemoryMap()

void __thiscall IOAccelMemoryMap::~IOAccelMemoryMap(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelMemoryMap::getMetaClass() const

undefined1 * IOAccelMemoryMap::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelMemoryMap::MetaClass::MetaClass()

void __thiscall IOAccelMemoryMap::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelMemoryMap",(OSMetaClass *)PTR_gMetaClass_0006b068,0x118);
  *(undefined ***)this = &PTR__MetaClass_000811c8;
  return;
}



// IOAccelMemoryMap::MetaClass::alloc() const

undefined8 IOAccelMemoryMap::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelMemoryMap::operator new(unsigned long)

void * __thiscall IOAccelMemoryMap::operator_new(IOAccelMemoryMap *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelMemoryMap_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelMemoryMap::operator delete(void*, unsigned long)

void __cdecl IOAccelMemoryMap::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelMemoryMap_ktv,param_1,param_2);
  return;
}



// IOAccelMemoryMap::init(IOGraphicsAccelerator2*, IOAccelTask*, IOAccelMemory*, unsigned int)

undefined8 __thiscall
IOAccelMemoryMap::init(IOAccelMemoryMap *this,long param_1,long param_2,long *param_3,uint param_4)

{
  uint uVar1;
  char cVar2;
  uint uVar3;
  uint uVar4;
  undefined8 uVar5;
  uint uVar6;
  
  this[0x11] = (IOAccelMemoryMap)((byte)this[0x11] & 0xf7);
  cVar2 = (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  if (cVar2 == '\0') {
    uVar5 = 0;
  }
  else {
    uVar5 = 0;
    if (((param_2 != 0) && (param_1 != 0)) && (param_3 != (long *)0x0)) {
      *(long *)(this + 0x88) = param_1;
      *(long *)(this + 0x90) = param_2;
      *(undefined8 *)(this + 0x28) = 0;
      *(undefined8 *)(this + 0x30) = 0;
      *(long **)(this + 0x18) = param_3;
      (**(code **)(*param_3 + 0x20))(param_3);
      *(undefined4 *)(this + 0x20) = 0;
      IOAccelMemory::add_mapping(*(IOAccelMemory **)(this + 0x18),this);
      *(IOAccelMemoryMap **)(this + 0xa0) = this + 0xb8;
      *(undefined8 *)(this + 0xb0) = 0;
      *(undefined8 *)(this + 0xa8) = 2;
      *(undefined8 *)(this + 0x98) = 0;
      uVar4 = *(uint *)(this + 0x10);
      *(uint *)(this + 0x10) = uVar4 & 0xfffffff2;
      uVar1 = *(uint *)((long)param_3 + 0xc);
      uVar6 = (uVar1 & 4) << 2;
      uVar3 = uVar4 & 0xffffffe2 | uVar6;
      *(uint *)(this + 0x10) = uVar3;
      if (((uVar1 & 4) == 0) ||
         ((param_4 & 0x20) == 0 && (*(uint *)(param_1 + 0xc90) & 0x100000) == 0)) {
        uVar3 = (uVar4 & 0xffffff82 | uVar6) + (param_4 & 0x10) * 2;
      }
      else {
        uVar3 = uVar3 | 0x60;
      }
      *(uint *)(this + 0x10) = uVar3;
      uVar3 = (uVar3 & 0xfffffb7f) + (*(uint *)((long)param_3 + 0xc) & 0x20) * 4;
      uVar4 = uVar3 | 2;
      if ((param_4 & 4) == 0) {
        uVar4 = uVar3 & 0xfffffbfd;
      }
      uVar3 = uVar4 | 0x100;
      if ((param_4 & 1) == 0) {
        uVar3 = uVar4 & 0xffffd8ff;
      }
      *(uint *)(this + 0x10) = (param_4 & 0x40) << 7 | (param_4 & 2) << 8 | uVar3 & 0xffffd9ff;
      *(undefined4 *)(this + 0x78) = 0;
      *(undefined8 *)(this + 0x80) = 0;
      *(undefined4 *)(this + 0xc) = 0;
      uVar5 = (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x140))
                        (*(long **)(*(long *)(this + 0x88) + 0x380),this + 0x38);
      this[0x11] = (IOAccelMemoryMap)((byte)this[0x11] | 8);
      uVar5 = CONCAT71((int7)((ulong)uVar5 >> 8),1);
    }
  }
  return uVar5;
}



// IOAccelMemoryMap::release() const

void __thiscall IOAccelMemoryMap::release(IOAccelMemoryMap *this)

{
  char cVar1;
  bool bVar2;
  int iVar3;
  uint uVar4;
  
  if (((byte)this[0x10] & 1) == 0) goto LAB_00053bb4;
  iVar3 = (**(code **)(*(long *)this + 0x18))(this);
  if (iVar3 != 1) goto LAB_00053bb4;
  uVar4 = *(uint *)(this + 0x10);
  if ((uVar4 & 8) == 0) {
    if ((*(byte *)(*(long *)(this + 0x18) + 0xd) & 0x10) == 0) {
      cVar1 = (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 400))
                        (*(long **)(*(long *)(this + 0x88) + 0x380),this + 0x38);
      if ((cVar1 != '\0') && ((*(byte *)(*(long *)(this + 0x88) + 0xc78) & 8) == 0)) {
        uVar4 = *(uint *)(this + 0x10);
        goto LAB_00053b95;
      }
    }
    uVar4 = *(uint *)(this + 0x10);
    if ((uVar4 & 0x14) != 0x10) {
      *(uint *)(this + 0x10) = uVar4 | 8;
      IOAccelMemoryMapList::removeMapping
                ((IOAccelMemoryMapList *)(*(long *)(this + 0x90) + 0x1e8),(long)this);
      IOAccelMemoryMapList::addMapping
                ((IOAccelMemoryMapList *)(*(long *)(this + 0x90) + 0x200),(long)this);
      bVar2 = IOAccelMemory::check_orphan_state(*(IOAccelMemory **)(this + 0x18));
      if (bVar2) {
                    // WARNING: Could not recover jumptable at 0x00053c16. Too many branches
                    // WARNING: Treating indirect jump as call
        (**(code **)(**(long **)(this + 0x18) + 0x1c0))();
        return;
      }
      return;
    }
  }
LAB_00053b95:
  if ((uVar4 & 4) != 0) {
    release_pte(this);
    uVar4 = *(uint *)(this + 0x10);
  }
  if ((uVar4 & 1) != 0) {
    (**(code **)(*(long *)this + 0x160))(this);
  }
LAB_00053bb4:
                    // WARNING: Could not recover jumptable at 0x00053bcb. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0x68))(this,0,1);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelMemoryMap::testEvent()

void __cdecl IOAccelMemoryMap::testEvent(long param_1,undefined8 param_2,undefined8 param_3)

{
  long *plVar1;
  code *UNRECOVERED_JUMPTABLE;
  
  plVar1 = *(long **)(*(long *)(param_1 + 0x88) + 0x380);
  UNRECOVERED_JUMPTABLE = *(code **)(*plVar1 + 400);
                    // WARNING: Could not recover jumptable at 0x00053c48. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)(plVar1,param_1 + 0x38,param_3,UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelMemoryMap::release_pte()

void __thiscall IOAccelMemoryMap::release_pte(IOAccelMemoryMap *this)

{
  uint *puVar1;
  uint uVar2;
  ulong uVar3;
  
  if (*(long *)(this + 0xb0) != 0) {
    uVar3 = 0;
    do {
      puVar1 = (uint *)(*(long *)(*(long *)(this + 0xa0) + uVar3 * 8) + 0xc);
      *puVar1 = *puVar1 & 0xffefffff;
      uVar3 = uVar3 + 1;
    } while (uVar3 < *(ulong *)(this + 0xb0));
  }
  uVar2 = *(uint *)(this + 0x10);
  if (((uVar2 & 0x40) == 0) && ((uVar2 & 0x4020) != 0x20)) {
    (**(code **)(*(long *)this + 0x178))(this);
    uVar2 = *(uint *)(this + 0x10);
  }
  *(uint *)(this + 0x10) = uVar2 & 0xfffffffb;
  (**(code **)(**(long **)(this + 0x18) + 0x1d8))();
  *(int *)(this + 0x110) = *(int *)(this + 0x110) + 1;
  return;
}



// IOAccelMemoryMap::free()

void __thiscall IOAccelMemoryMap::free(IOAccelMemoryMap *this)

{
  IOAccelMemoryMap *pIVar1;
  long lVar2;
  
  if (*(IOAccelMemory **)(this + 0x18) != (IOAccelMemory *)0x0) {
    IOAccelMemory::remove_mapping(*(IOAccelMemory **)(this + 0x18),(long)this);
    (**(code **)(**(long **)(this + 0x18) + 0x28))();
    *(undefined8 *)(this + 0x18) = 0;
  }
  pIVar1 = *(IOAccelMemoryMap **)(this + 0xa0);
  if ((pIVar1 != (IOAccelMemoryMap *)0x0) && (pIVar1 != this + 0xb8)) {
    lVar2 = *(ulong *)(this + 0xa8) << 3;
    if (lVar2 < 0) {
      lVar2 = -0x8000000000000000;
    }
    if (*(ulong *)(this + 0xa8) >> 0x3d != 0) {
      lVar2 = -0x8000000000000000;
    }
    *(undefined8 *)(this + 0xa0) = 0;
    _IOFreeTypeVarImpl(&free()::kalloc_type_view_212,pIVar1,lVar2);
    *(undefined8 *)(this + 0xa0) = 0;
  }
                    // WARNING: Could not recover jumptable at 0x00053d5a. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelMemoryMap::reserveGPUVirtualAddress(unsigned long long, unsigned long long)

bool __thiscall
IOAccelMemoryMap::reserveGPUVirtualAddress(IOAccelMemoryMap *this,long param_1,undefined8 param_2)

{
  long lVar1;
  
  *(long *)(this + 0x98) = param_1;
  *(undefined8 *)(this + 200) = param_2;
  this[0x11] = (IOAccelMemoryMap)((byte)this[0x11] | 0x40);
  lVar1 = (**(code **)(**(long **)(this + 0x90) + 0x140))(*(long **)(this + 0x90),this);
  if (lVar1 == param_1) {
    IOAccelMemoryMapList::addMapping
              ((IOAccelMemoryMapList *)(*(long *)(this + 0x90) + 0x1e8),(long)this);
    this[0x10] = (IOAccelMemoryMap)((byte)this[0x10] | 1);
  }
  return lVar1 == param_1;
}



// IOAccelMemoryMap::allocGPUVirtualAddress()

ulong __thiscall IOAccelMemoryMap::allocGPUVirtualAddress(IOAccelMemoryMap *this)

{
  long lVar1;
  undefined8 unaff_RBX;
  ulong uVar2;
  
  uVar2 = CONCAT71((int7)((ulong)unaff_RBX >> 8),1);
  if ((*(uint *)(this + 0x10) & 1) == 0) {
    if ((*(uint *)(this + 0x10) & 0x20) == 0) {
      lVar1 = (**(code **)(**(long **)(this + 0x90) + 0x140))(*(long **)(this + 0x90),this);
      if (lVar1 == 0) {
        uVar2 = 0;
        goto LAB_00053e24;
      }
    }
    else {
      lVar1 = 0;
    }
    IOAccelMemoryMapList::addMapping
              ((IOAccelMemoryMapList *)(*(long *)(this + 0x90) + 0x1e8),(long)this);
    *(long *)(this + 0x98) = lVar1;
    this[0x10] = (IOAccelMemoryMap)((byte)this[0x10] | 1);
  }
LAB_00053e24:
  return uVar2 & 0xffffffff;
}



// IOAccelMemoryMap::freeGPUVirtualAddress()

void __thiscall IOAccelMemoryMap::freeGPUVirtualAddress(IOAccelMemoryMap *this)

{
  uint uVar1;
  long lVar2;
  
  lVar2 = 0x200;
  if (((byte)this[0x10] & 8) == 0) {
    lVar2 = 0x1e8;
  }
  IOAccelMemoryMapList::removeMapping
            ((IOAccelMemoryMapList *)(lVar2 + *(long *)(this + 0x90)),(long)this);
  uVar1 = *(uint *)(this + 0x10);
  if ((uVar1 & 0x20) == 0) {
    (**(code **)(**(long **)(this + 0x90) + 0x148))
              (*(long **)(this + 0x90),this,*(undefined8 *)(this + 0x98));
    uVar1 = *(uint *)(this + 0x10);
  }
  *(undefined8 *)(this + 0x98) = 0;
  *(undefined8 *)(this + 200) = 0;
  *(uint *)(this + 0x10) = uVar1 & 0xfffffffe;
  return;
}



// IOAccelMemoryMap::getGPUVirtualAddress()

undefined8 __thiscall IOAccelMemoryMap::getGPUVirtualAddress(IOAccelMemoryMap *this)

{
  undefined8 uVar1;
  
  if (((byte)this[0x10] & 0x40) == 0) {
    uVar1 = *(undefined8 *)(this + 0x98);
  }
  else {
    uVar1 = (**(code **)(**(long **)(this + 0x18) + 0x158))(*(long **)(this + 0x18),0);
  }
  return uVar1;
}



// IOAccelMemoryMap::getGPUVirtualAddressForUserProcess()

void __thiscall IOAccelMemoryMap::getGPUVirtualAddressForUserProcess(IOAccelMemoryMap *this)

{
                    // WARNING: Could not recover jumptable at 0x00053ee4. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x128))();
  return;
}



// IOAccelMemoryMap::getGPUVirtualAddressLengthForUserProcess()

void __thiscall IOAccelMemoryMap::getGPUVirtualAddressLengthForUserProcess(IOAccelMemoryMap *this)

{
                    // WARNING: Could not recover jumptable at 0x00053ef2. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*(long *)this + 0x168))();
  return;
}



// IOAccelMemoryMap::compatibleWith(IOAccelMemoryMap*)

undefined4 __thiscall IOAccelMemoryMap::compatibleWith(IOAccelMemoryMap *this,long param_1)

{
  return CONCAT31((int3)((uint)*(int *)(this + 0x78) >> 8),
                  *(int *)(this + 0x78) == *(int *)(param_1 + 0x78));
}



// IOAccelMemoryMap::prepare()

undefined8 __thiscall IOAccelMemoryMap::prepare(IOAccelMemoryMap *this)

{
  undefined4 uVar1;
  char cVar2;
  uint uVar3;
  undefined8 uVar4;
  
  if ((*(int *)(this + 0xc) == 0) && (((byte)this[0x10] & 4) == 0)) {
    cVar2 = (**(code **)(**(long **)(this + 0x18) + 0x148))();
    if (cVar2 != '\0') {
      uVar4 = commit_pte(this);
      if ((char)uVar4 != '\0') {
        *(int *)(this + 0xc) = *(int *)(this + 0xc) + 1;
        (**(code **)(**(long **)(this + 0x18) + 0x150))();
        goto LAB_00053f23;
      }
      (**(code **)(**(long **)(this + 0x18) + 0x150))();
    }
    uVar4 = 0;
  }
  else {
    *(int *)(this + 0xc) = *(int *)(this + 0xc) + 1;
LAB_00053f23:
    uVar3 = *(uint *)(this + 0x10);
    if ((uVar3 >> 10 & 1) != 0) {
      update_pte(this);
      uVar3 = *(uint *)(this + 0x10);
    }
    if ((uVar3 & 2) == 0) {
      IOAccelMemoryMapList::moveMappingToHead
                ((IOAccelMemoryMapList *)(*(long *)(this + 0x90) + 0x1e8),(long)this);
    }
    uVar1 = *(undefined4 *)(*(long *)(this + 0x88) + 0xa0);
    *(undefined4 *)(this + 0x20) = uVar1;
    uVar4 = CONCAT71((uint7)(uint3)((uint)uVar1 >> 8),1);
  }
  return uVar4;
}



// IOAccelMemoryMap::commit_pte()

undefined8 __thiscall IOAccelMemoryMap::commit_pte(IOAccelMemoryMap *this)

{
  char cVar1;
  uint uVar2;
  undefined8 uVar3;
  
  uVar2 = *(uint *)(this + 0x10);
  if (((uVar2 & 0x40) == 0) && ((uVar2 & 0x4020) != 0x20)) {
    cVar1 = (**(code **)(*(long *)this + 0x170))(this);
    if (cVar1 == '\0') {
      return 0;
    }
    uVar2 = *(uint *)(this + 0x10);
  }
  *(uint *)(this + 0x10) = uVar2 & 0xfffffbfb | 4;
  uVar3 = (**(code **)(**(long **)(this + 0x18) + 0x1d0))();
  *(int *)(this + 0x110) = *(int *)(this + 0x110) + 1;
  return CONCAT71((int7)((ulong)uVar3 >> 8),1);
}



// IOAccelMemoryMap::update_pte()

void __thiscall IOAccelMemoryMap::update_pte(IOAccelMemoryMap *this)

{
  (**(code **)(**(long **)(*(long *)(this + 0x88) + 0x380) + 0x188))
            (*(long **)(*(long *)(this + 0x88) + 0x380),this + 0x38);
  (**(code **)(*(long *)this + 0x180))(this);
  this[0x11] = (IOAccelMemoryMap)((byte)this[0x11] & 0xfb);
  *(int *)(this + 0x110) = *(int *)(this + 0x110) + 1;
  return;
}



// IOAccelMemoryMap::updateLRUSeed()

void __thiscall IOAccelMemoryMap::updateLRUSeed(IOAccelMemoryMap *this)

{
  *(undefined4 *)(this + 0x20) = *(undefined4 *)(*(long *)(this + 0x88) + 0xa0);
  return;
}



// IOAccelMemoryMap::complete()

void __thiscall IOAccelMemoryMap::complete(IOAccelMemoryMap *this)

{
  *(int *)(this + 0xc) = *(int *)(this + 0xc) + -1;
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelMemoryMap::finishEvent()

void __cdecl IOAccelMemoryMap::finishEvent(long param_1,undefined8 param_2,undefined8 param_3)

{
  long *plVar1;
  code *UNRECOVERED_JUMPTABLE;
  
  plVar1 = *(long **)(*(long *)(param_1 + 0x88) + 0x380);
  UNRECOVERED_JUMPTABLE = *(code **)(*plVar1 + 0x188);
                    // WARNING: Could not recover jumptable at 0x0005408c. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)(plVar1,param_1 + 0x38,param_3,UNRECOVERED_JUMPTABLE);
  return;
}



// IOAccelMemoryMap::add_resource(IOAccelResource2*)

void __thiscall IOAccelMemoryMap::add_resource(IOAccelMemoryMap *this,undefined8 param_1)

{
  IOAccelMemoryMap *pIVar1;
  void *pvVar2;
  long lVar3;
  long lVar4;
  
  lVar4 = *(long *)(this + 0xb0);
  if (lVar4 == *(long *)(this + 0xa8)) {
    lVar3 = lVar4 << 4;
    if (lVar3 < 0) {
      lVar3 = -0x8000000000000000;
    }
    if ((ulong)(lVar4 * 2) >> 0x3d != 0) {
      lVar3 = -0x8000000000000000;
    }
    pvVar2 = (void *)_IOMallocTypeVarImpl
                               (&add_resource(IOAccelResource2*)::kalloc_type_view_497,lVar3);
    _memmove(pvVar2,*(void **)(this + 0xa0),*(long *)(this + 0xa8) << 3);
    pIVar1 = *(IOAccelMemoryMap **)(this + 0xa0);
    if (pIVar1 != this + 0xb8) {
      lVar3 = *(ulong *)(this + 0xa8) * 8;
      if (lVar3 < 0) {
        lVar3 = -0x8000000000000000;
      }
      if (0x1fffffffffffffff < *(ulong *)(this + 0xa8)) {
        lVar3 = -0x8000000000000000;
      }
      *(undefined8 *)(this + 0xa0) = 0;
      _IOFreeTypeVarImpl(&add_resource(IOAccelResource2*)::kalloc_type_view_500,pIVar1,lVar3);
    }
    *(void **)(this + 0xa0) = pvVar2;
    *(long *)(this + 0xa8) = lVar4 * 2;
    lVar4 = *(long *)(this + 0xb0);
  }
  else {
    pvVar2 = *(void **)(this + 0xa0);
  }
  *(long *)(this + 0xb0) = lVar4 + 1;
  *(undefined8 *)((long)pvVar2 + lVar4 * 8) = param_1;
  return;
}



// IOAccelMemoryMap::remove_resource(IOAccelResource2*)

void __thiscall IOAccelMemoryMap::remove_resource(IOAccelMemoryMap *this,long param_1)

{
  ulong uVar1;
  ulong uVar2;
  ulong uVar3;
  
  uVar1 = *(ulong *)(this + 0xb0);
  if (uVar1 == 0) {
    uVar1 = 0;
    uVar3 = 0;
  }
  else {
    uVar2 = 0;
    do {
      if (*(long *)(*(long *)(this + 0xa0) + uVar2 * 8) == param_1) {
        uVar1 = uVar1 - 1;
        *(ulong *)(this + 0xb0) = uVar1;
        uVar3 = uVar2;
        break;
      }
      uVar2 = uVar2 + 1;
      uVar3 = uVar1;
    } while (uVar1 != uVar2);
  }
  for (uVar3 = uVar3 & 0xffffffff; uVar3 < uVar1; uVar3 = uVar3 + 1) {
    *(undefined8 *)(*(long *)(this + 0xa0) + uVar3 * 8) =
         *(undefined8 *)(*(long *)(this + 0xa0) + 8 + uVar3 * 8);
  }
  return;
}



// IOAccelMemoryMap::getPrepareCount() const

int __thiscall IOAccelMemoryMap::getPrepareCount(IOAccelMemoryMap *this)

{
  int iVar1;
  long lVar2;
  
  iVar1 = *(int *)(this + 0xc);
  if (*(long *)(this + 0xb0) != 0) {
    lVar2 = 0;
    do {
      iVar1 = (iVar1 + 1) -
              (uint)(*(int *)(*(long *)(*(long *)(this + 0xa0) + lVar2 * 8) + 0x28) == 0);
      lVar2 = lVar2 + 1;
    } while (*(long *)(this + 0xb0) != lVar2);
  }
  return iVar1;
}



// IOAccelMemoryMap::getLRUSeed() const

void __thiscall IOAccelMemoryMap::getLRUSeed(IOAccelMemoryMap *this)

{
  int iVar1;
  int iVar2;
  long lVar3;
  
  iVar2 = *(int *)(this + 0x20);
  if (*(long *)(this + 0xb0) != 0) {
    lVar3 = 0;
    do {
      iVar1 = *(int *)(*(long *)(*(long *)(this + 0xa0) + lVar3 * 8) + 0x10);
      if (iVar2 - iVar1 < 0) {
        iVar2 = iVar1;
      }
      lVar3 = lVar3 + 1;
    } while (*(long *)(this + 0xb0) != lVar3);
  }
  return;
}



// IOAccelMemoryMap::redirect(IOAccelMemory*)

bool __thiscall IOAccelMemoryMap::redirect(IOAccelMemoryMap *this,long *param_1)

{
  long lVar1;
  long lVar2;
  uint uVar3;
  uint uVar4;
  long lVar5;
  
  if (param_1 != (long *)0x0) {
    uVar4 = *(uint *)(this + 0x10);
    if ((uVar4 & 3) == 1) {
      (**(code **)(*(long *)this + 0x160))(this);
      uVar4 = *(uint *)(this + 0x10);
    }
    *(uint *)(this + 0x10) = uVar4 | 0x1000;
    IOAccelMemory::remove_mapping(*(IOAccelMemory **)(this + 0x18),(long)this);
    (**(code **)(**(long **)(this + 0x18) + 0x28))();
    *(long **)(this + 0x18) = param_1;
    (**(code **)(*param_1 + 0x20))(param_1);
    IOAccelMemory::add_mapping(*(IOAccelMemory **)(this + 0x18),this);
    uVar4 = (*(uint *)(this + 0x10) & 0xffffff7f) + (*(uint *)((long)param_1 + 0xc) & 0x20) * 4;
    *(uint *)(this + 0x10) = uVar4;
    uVar3 = uVar4 & 0xffffff8f;
    if ((*(uint *)((long)param_1 + 0xc) & 4) != 0) {
      uVar3 = uVar4 & 0xffffffef;
    }
    *(uint *)(this + 0x10) = uVar3 | (*(uint *)((long)param_1 + 0xc) & 4) << 2;
    lVar1 = *(long *)(this + 0xb0);
    if (lVar1 != 0) {
      lVar2 = *(long *)(this + 0xa0);
      lVar5 = 0;
      do {
        *(long **)(*(long *)(lVar2 + lVar5 * 8) + 0x70) = param_1;
        lVar5 = lVar5 + 1;
      } while (lVar1 != lVar5);
    }
  }
  return param_1 != (long *)0x0;
}



// IOAccelMemoryMap::getAssignedGPUVirtualAddressLength() const

undefined8 __thiscall IOAccelMemoryMap::getAssignedGPUVirtualAddressLength(IOAccelMemoryMap *this)

{
  return *(undefined8 *)(this + 200);
}



// IOAccelMemoryMap::_RESERVEDIOAccelMemoryMap1()

void IOAccelMemoryMap::_RESERVEDIOAccelMemoryMap1(void)

{
  OSMetaClass::reservedCalled(0x827f0);
  return;
}



// IOAccelMemoryMap::_RESERVEDIOAccelMemoryMap2()

void IOAccelMemoryMap::_RESERVEDIOAccelMemoryMap2(void)

{
  OSMetaClass::reservedCalled(0x827f0);
  return;
}



// IOAccelMemoryMap::_RESERVEDIOAccelMemoryMap3()

void IOAccelMemoryMap::_RESERVEDIOAccelMemoryMap3(void)

{
  OSMetaClass::reservedCalled(0x827f0);
  return;
}



// IOAccelMemoryMap::_RESERVEDIOAccelMemoryMap4()

void IOAccelMemoryMap::_RESERVEDIOAccelMemoryMap4(void)

{
  OSMetaClass::reservedCalled(0x827f0);
  return;
}



// IOAccelMemoryMap::_RESERVEDIOAccelMemoryMap5()

void IOAccelMemoryMap::_RESERVEDIOAccelMemoryMap5(void)

{
  OSMetaClass::reservedCalled(0x827f0);
  return;
}



// IOAccelMemoryMap::matchOptionBits(unsigned int)

undefined1 IOAccelMemoryMap::matchOptionBits(void)

{
  return 1;
}



// IOAccelMemoryMap::getLength() const

void __thiscall IOAccelMemoryMap::getLength(IOAccelMemoryMap *this)

{
                    // WARNING: Could not recover jumptable at 0x000543b4. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0x18) + 0x120))();
  return;
}



// IOAccelMemoryMap::MetaClass::~MetaClass()

void __thiscall IOAccelMemoryMap::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelMemoryMap_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelMemoryMap::gMetaClass,"IOAccelMemoryMap",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x118);
  _gMetaClass = &PTR__MetaClass_000811c8;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelMemoryMap::gMetaClass);
  return;
}



// IOAccelMTLEvent2::MetaClass::MetaClass()

void __thiscall IOAccelMTLEvent2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelMTLEvent2",(OSMetaClass *)PTR_gMetaClass_0006b068,0x290);
  *(undefined ***)this = &PTR__MetaClass_000813f8;
  return;
}



// IOAccelMTLEvent2::MetaClass::~MetaClass()

void __thiscall IOAccelMTLEvent2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelMTLEvent2::IOAccelMTLEvent2(OSMetaClass const*)

void __thiscall IOAccelMTLEvent2::IOAccelMTLEvent2(IOAccelMTLEvent2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelMTLEvent2_000812c0;
  return;
}



// IOAccelMTLEvent2::IOAccelMTLEvent2(OSMetaClass const*)

void __thiscall IOAccelMTLEvent2::IOAccelMTLEvent2(IOAccelMTLEvent2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelMTLEvent2_000812c0;
  return;
}



// IOAccelMTLEvent2::~IOAccelMTLEvent2()

void __thiscall IOAccelMTLEvent2::~IOAccelMTLEvent2(IOAccelMTLEvent2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelMTLEvent2::~IOAccelMTLEvent2()

void __thiscall IOAccelMTLEvent2::~IOAccelMTLEvent2(IOAccelMTLEvent2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelMTLEvent2::~IOAccelMTLEvent2()

void __thiscall IOAccelMTLEvent2::~IOAccelMTLEvent2(IOAccelMTLEvent2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelMTLEvent2_ktv,this,0x290);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelMTLEvent2::operator delete(void*, unsigned long)

void __cdecl IOAccelMTLEvent2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelMTLEvent2_ktv,param_1,param_2);
  return;
}



// IOAccelMTLEvent2::getMetaClass() const

undefined8 * IOAccelMTLEvent2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelMTLEvent2::MetaClass::MetaClass()

void __thiscall IOAccelMTLEvent2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelMTLEvent2",(OSMetaClass *)PTR_gMetaClass_0006b068,0x290);
  *(undefined ***)this = &PTR__MetaClass_000813f8;
  return;
}



// IOAccelMTLEvent2::MetaClass::alloc() const

OSObject * IOAccelMTLEvent2::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelMTLEvent2_ktv,0x290);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelMTLEvent2::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelMTLEvent2_000812c0;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelMTLEvent2::operator new(unsigned long)

void * __thiscall IOAccelMTLEvent2::operator_new(IOAccelMTLEvent2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelMTLEvent2_ktv,this);
  return pvVar1;
}



// IOAccelMTLEvent2::IOAccelMTLEvent2()

void __thiscall IOAccelMTLEvent2::IOAccelMTLEvent2(IOAccelMTLEvent2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelMTLEvent2_000812c0;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelMTLEvent2::IOAccelMTLEvent2()

void __thiscall IOAccelMTLEvent2::IOAccelMTLEvent2(IOAccelMTLEvent2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelMTLEvent2_000812c0;
  OSMetaClass::instanceConstructed();
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelMTLEvent2::withAcceleratorNamespace(IOGraphicsAccelerator2*, IOAccelNamespace*, unsigned
// long long)

long * __cdecl
IOAccelMTLEvent2::withAcceleratorNamespace(undefined8 param_1,undefined8 param_2,undefined8 param_3)

{
  char cVar1;
  long *plVar2;
  
  plVar2 = (long *)(**(code **)(gMetaClass + 0x88))(&gMetaClass);
  if (plVar2 != (long *)0x0) {
    cVar1 = (**(code **)(*plVar2 + 0x118))(plVar2,param_1,param_2,param_3);
    if (cVar1 != '\0') {
      return plVar2;
    }
    (**(code **)(*plVar2 + 0x28))(plVar2);
  }
  return (long *)0x0;
}



// IOAccelMTLEvent2::initWithAcceleratorNamespace(IOGraphicsAccelerator2*, IOAccelNamespace*,
// unsigned long long)

undefined8 __thiscall
IOAccelMTLEvent2::initWithAcceleratorNamespace
          (IOAccelMTLEvent2 *this,undefined8 param_1,long *param_2,undefined8 param_3)

{
  char cVar1;
  undefined8 uVar2;
  ulong uVar3;
  long lVar4;
  
  cVar1 = (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  if (cVar1 != '\0') {
    *(undefined8 *)(this + 0x10) = param_1;
    *(long **)(this + 0x18) = param_2;
    (**(code **)(*param_2 + 0x20))(param_2);
    uVar2 = _OSAddAtomic64(1,&___globalObjectIDCounter);
    *(undefined8 *)(this + 0x288) = uVar2;
    *(undefined8 *)(this + 0x38) = param_3;
    uVar3 = IOAccelNamespace::allocId
                      (*(IOAccelNamespace **)(this + 0x18),this,(uint *)(this + 0x20));
    if ((char)uVar3 != '\0') {
      lVar4 = 0;
      do {
        uVar2 = (**(code **)(**(long **)(*(long *)(this + 0x10) + 0x380) + 0x140))
                          (*(long **)(*(long *)(this + 0x10) + 0x380),this + lVar4 + 0x88);
        lVar4 = lVar4 + 0x40;
      } while (lVar4 != 0x200);
      return CONCAT71((int7)((ulong)uVar2 >> 8),1);
    }
  }
  return 0;
}



// IOAccelMTLEvent2::free()

void __thiscall IOAccelMTLEvent2::free(IOAccelMTLEvent2 *this)

{
  if (*(uint *)(this + 0x20) != 0) {
    IOAccelNamespace::freeId(*(IOAccelNamespace **)(this + 0x18),*(uint *)(this + 0x20));
    *(undefined4 *)(this + 0x20) = 0;
  }
  if (*(long **)(this + 0x18) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0x18) + 0x28))();
  }
  *(undefined8 *)(this + 0x18) = 0;
  *(undefined8 *)(this + 0x10) = 0;
                    // WARNING: Could not recover jumptable at 0x00054725. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelMTLEvent2::clean_ring()

void __thiscall IOAccelMTLEvent2::clean_ring(IOAccelMTLEvent2 *this)

{
  char cVar1;
  uint uVar2;
  
  uVar2 = *(uint *)(this + 0x40);
  if (*(uint *)(this + 0x44) != uVar2) {
    do {
      cVar1 = (**(code **)(**(long **)(*(long *)(this + 0x10) + 0x380) + 0x270))
                        (*(long **)(*(long *)(this + 0x10) + 0x380),
                         this + (ulong)(uVar2 & 7) * 0x40 + 0x88);
      if (cVar1 == '\0') {
        return;
      }
      *(undefined8 *)(this + 0x28) =
           *(undefined8 *)(this + (ulong)(*(uint *)(this + 0x40) & 7) * 8 + 0x48);
      uVar2 = *(uint *)(this + 0x40) + 1;
      *(uint *)(this + 0x40) = uVar2;
    } while (*(uint *)(this + 0x44) != uVar2);
  }
  return;
}



// IOAccelMTLEvent2::signalSubmitted(IOAccelEvent const*, unsigned long long)

void __thiscall
IOAccelMTLEvent2::signalSubmitted(IOAccelMTLEvent2 *this,undefined8 param_1,ulong param_2)

{
  uint uVar1;
  
  clean_ring(this);
  if (((byte)this[0x38] & 1) == 0) {
    if (param_2 <= *(ulong *)(this + 0x30)) {
      return;
    }
    *(ulong *)(this + 0x30) = param_2;
  }
  if (*(uint *)(this + 0x44) - *(int *)(this + 0x40) == 8) {
    *(int *)(this + 0x40) = *(int *)(this + 0x40) + 1;
  }
  (**(code **)(**(long **)(*(long *)(this + 0x10) + 0x380) + 0x1b0))
            (*(long **)(*(long *)(this + 0x10) + 0x380),param_1,
             this + (ulong)(*(uint *)(this + 0x44) & 7) * 0x40 + 0x88);
  uVar1 = *(uint *)(this + 0x44);
  *(ulong *)(this + (ulong)(uVar1 & 7) * 8 + 0x48) = param_2;
  *(uint *)(this + 0x44) = uVar1 + 1;
  if (*(int *)(this + 0x24) == 0) {
    return;
  }
  _IOLockWakeup_darwin14(*(undefined8 *)(*(long *)(this + 0x10) + 0x88),this,0);
  return;
}



// IOAccelMTLEvent2::copySubmitted(unsigned long long, IOAccelEvent*, unsigned long long, unsigned
// long long, unsigned long long)

undefined8 __thiscall
IOAccelMTLEvent2::copySubmitted
          (IOAccelMTLEvent2 *this,ulong param_1,undefined8 param_2,undefined8 param_3,
          uintptr_t param_4,uintptr_t param_5)

{
  uint uVar1;
  ulong uVar2;
  long *plVar3;
  int iVar4;
  ulong uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  bool bVar9;
  
  do {
    clean_ring(this);
    uVar1 = *(uint *)(this + 0x44);
    uVar5 = (ulong)uVar1;
    if (*(uint *)(this + 0x40) == uVar1) {
      if (param_1 <= *(ulong *)(this + 0x28)) {
LAB_00054986:
        return CONCAT71((int7)(uVar5 >> 8),1);
      }
    }
    else {
      uVar5 = 0xffffffffffffffff;
      uVar6 = uVar1;
      uVar8 = uVar1;
      do {
        uVar7 = uVar8;
        uVar6 = uVar6 - 1;
        if (uVar6 - *(uint *)(this + 0x40) == -1) break;
        uVar2 = *(ulong *)(this + (ulong)(uVar6 & 7) * 8 + 0x48);
        uVar8 = uVar6;
        if (uVar2 < param_1) {
          uVar8 = uVar7;
        }
        bVar9 = uVar2 < uVar5;
        uVar5 = uVar2;
      } while (bVar9);
      if (uVar7 != uVar1) {
        uVar5 = (**(code **)(**(long **)(*(long *)(this + 0x10) + 0x380) + 0x1b0))
                          (*(long **)(*(long *)(this + 0x10) + 0x380),
                           this + (ulong)(uVar7 & 7) * 0x40 + 0x88,param_2);
        goto LAB_00054986;
      }
    }
    *(int *)(this + 0x24) = *(int *)(this + 0x24) + 1;
    _kernel_debug(0x850200cd,param_4,param_5,*(uintptr_t *)(this + 0x288),param_1,0);
    plVar3 = *(long **)(this + 0x10);
    (**(code **)(*plVar3 + 0x858))(plVar3,"",0);
    iVar4 = _IOLockSleepDeadline_darwin14(plVar3[0x11],this,param_3,0);
    (**(code **)(*plVar3 + 0x850))(plVar3,"",0);
    _kernel_debug(0x850200ce,param_4,param_5,*(uintptr_t *)(this + 0x288),param_1,0);
    *(int *)(this + 0x24) = *(int *)(this + 0x24) + -1;
    if (iVar4 == 1) {
      return 0;
    }
  } while( true );
}



// IOAccelMTLEvent2::MetaClass::~MetaClass()

void __thiscall IOAccelMTLEvent2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



void __GLOBAL__sub_I_IOAccelMetalEvent_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelMTLEvent2::gMetaClass,"IOAccelMTLEvent2",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x290);
  IOAccelMTLEvent2::gMetaClass = &PTR__MetaClass_000813f8;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelMTLEvent2::gMetaClass);
  return;
}



// IOAccelOrphanedMemoryPool::init(IOGraphicsAccelerator2*, unsigned long long, unsigned int)

bool __thiscall
IOAccelOrphanedMemoryPool::init
          (IOAccelOrphanedMemoryPool *this,undefined8 param_1,undefined8 param_2,undefined4 param_3)

{
  long lVar1;
  long lVar2;
  
  *(undefined8 *)(this + 8) = param_1;
  *(undefined8 *)(this + 0x18) = 0;
  *(IOAccelOrphanedMemoryPool **)(this + 0x20) = this + 0x18;
  *(undefined8 *)(this + 0x28) = 0;
  *(IOAccelOrphanedMemoryPool **)(this + 0x30) = this + 0x28;
  *(undefined8 *)(this + 0x38) = 0;
  *(undefined4 *)(this + 0x10) = param_3;
  *(undefined8 *)(this + 0x48) = param_2;
  *(undefined8 *)(this + 0x40) = 0;
  *(undefined8 *)(this + 0x50) = 0;
  *(undefined8 *)(this + 0x58) = 0;
  *(undefined8 *)(this + 0x60) = 0;
  lVar1 = _IOMallocTypeVarImpl
                    (&init(IOGraphicsAccelerator2*,unsigned_long_long,unsigned_int)::
                      kalloc_type_view_56,0x2000);
  *(long *)(this + 0x38) = lVar1;
  if (lVar1 == 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: failed to alloc fOrphanedMemoryHashTable\n",
                      "virtual bool IOAccelOrphanedMemoryPool::init(IOGraphicsAccelerator2 *, uint64_t, uint32_t)"
                     );
  }
  else {
    lVar2 = 0;
    do {
      *(undefined8 *)(*(long *)(this + 0x38) + lVar2 * 8) = 0;
      lVar2 = lVar2 + 1;
    } while (lVar2 != 0x400);
  }
  return lVar1 != 0;
}



// IOAccelOrphanedMemoryPool::free()

void __thiscall
IOAccelOrphanedMemoryPool::free
          (IOAccelOrphanedMemoryPool *this,undefined8 param_1,undefined8 param_2)

{
  IOAccelMemory *pIVar1;
  long lVar2;
  undefined8 uVar3;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 *puVar4;
  long lVar5;
  
  puVar4 = *(undefined8 **)(this + 0x18);
  while (puVar4 != (undefined8 *)0x0) {
    pIVar1 = (IOAccelMemory *)*puVar4;
    puVar4 = (undefined8 *)puVar4[1];
    IOAccelMemory::pruneOrphanedMappings(pIVar1,param_1,param_2);
    param_2 = extraout_RDX;
  }
  puVar4 = *(undefined8 **)(this + 0x28);
  while (puVar4 != (undefined8 *)0x0) {
    pIVar1 = (IOAccelMemory *)*puVar4;
    puVar4 = (undefined8 *)puVar4[1];
    IOAccelMemory::pruneOrphanedMappings(pIVar1,param_1,param_2);
    param_2 = extraout_RDX_00;
  }
  if (*(long *)(this + 0x38) != 0) {
    lVar5 = 0;
    do {
      lVar2 = *(long *)(*(long *)(this + 0x38) + lVar5 * 8);
      while (lVar2 != 0) {
        lVar2 = *(long *)(lVar2 + 0x18);
        _IOFreeTypeImpl(&free()::kalloc_type_view_97);
      }
      lVar5 = lVar5 + 1;
    } while (lVar5 != 0x400);
    uVar3 = *(undefined8 *)(this + 0x38);
    *(undefined8 *)(this + 0x38) = 0;
    _IOFreeTypeVarImpl(&free()::kalloc_type_view_101,uVar3,0x2000);
    *(undefined8 *)(this + 0x38) = 0;
  }
  return;
}



// IOAccelOrphanedMemoryPool::releaseOrphanedMemory()

void __thiscall
IOAccelOrphanedMemoryPool::releaseOrphanedMemory
          (IOAccelOrphanedMemoryPool *this,undefined8 param_1,undefined8 param_2)

{
  IOAccelMemory *pIVar1;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 *puVar2;
  
  puVar2 = *(undefined8 **)(this + 0x18);
  while (puVar2 != (undefined8 *)0x0) {
    pIVar1 = (IOAccelMemory *)*puVar2;
    puVar2 = (undefined8 *)puVar2[1];
    IOAccelMemory::pruneOrphanedMappings(pIVar1,param_1,param_2);
    param_2 = extraout_RDX;
  }
  puVar2 = *(undefined8 **)(this + 0x28);
  while (puVar2 != (undefined8 *)0x0) {
    pIVar1 = (IOAccelMemory *)*puVar2;
    puVar2 = (undefined8 *)puVar2[1];
    IOAccelMemory::pruneOrphanedMappings(pIVar1,param_1,param_2);
    param_2 = extraout_RDX_00;
  }
  return;
}



// IOAccelOrphanedMemoryPool::pruneNonReusableOrphanedMemory()

void __thiscall
IOAccelOrphanedMemoryPool::pruneNonReusableOrphanedMemory
          (IOAccelOrphanedMemoryPool *this,undefined8 param_1,undefined8 param_2)

{
  IOAccelMemory *this_00;
  undefined8 extraout_RDX;
  undefined8 *puVar1;
  
  puVar1 = *(undefined8 **)(this + 0x28);
  while (puVar1 != (undefined8 *)0x0) {
    this_00 = (IOAccelMemory *)*puVar1;
    puVar1 = (undefined8 *)puVar1[1];
    IOAccelMemory::pruneOrphanedMappings(this_00,param_1,param_2);
    param_2 = extraout_RDX;
  }
  return;
}



// IOAccelOrphanedMemoryPool::pruneReusableOrphanedMemory()

void __thiscall
IOAccelOrphanedMemoryPool::pruneReusableOrphanedMemory
          (IOAccelOrphanedMemoryPool *this,undefined8 param_1,undefined8 param_2)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  undefined8 extraout_RDX;
  
  puVar2 = *(undefined8 **)(this + 0x18);
  while( true ) {
    if (puVar2 == (undefined8 *)0x0) {
      return;
    }
    puVar1 = (undefined8 *)puVar2[1];
    if ((*(ulong *)(this + 0x50) <= *(ulong *)(this + 0x48)) &&
       (*(uint *)(*(long *)(this + 8) + 0xbc) <=
        (uint)(*(int *)(this + 0x10) + *(int *)((long)puVar2 + 0x2c)))) break;
    IOAccelMemory::pruneOrphanedMappings((IOAccelMemory *)*puVar2,param_1,param_2);
    puVar2 = puVar1;
    param_2 = extraout_RDX;
  }
  return;
}



// IOAccelOrphanedMemoryPool::sharedRelease(IOAccelShared2*)

void __thiscall
IOAccelOrphanedMemoryPool::sharedRelease
          (IOAccelOrphanedMemoryPool *this,IOAccelMemory *param_1,undefined8 param_2)

{
  undefined8 uVar1;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 extraout_RDX_01;
  undefined8 extraout_RDX_02;
  IOAccelMemory *pIVar2;
  IOAccelMemory *pIVar3;
  undefined8 *puVar4;
  
  puVar4 = *(undefined8 **)(this + 0x18);
  pIVar3 = param_1;
  while (puVar4 != (undefined8 *)0x0) {
    pIVar2 = (IOAccelMemory *)*puVar4;
    puVar4 = (undefined8 *)puVar4[1];
    if (*(IOAccelMemory **)(pIVar2 + 0x30) == param_1) {
      uVar1 = IOAccelMemory::testAllEvent(pIVar2);
      if ((char)uVar1 == '\0') {
        removeMemory(this,(long *)pIVar2);
        IOAccelMemory::clearFlags(pIVar2,1);
        addMemory(this,(long *)pIVar2);
        param_2 = extraout_RDX_01;
        pIVar3 = pIVar2;
      }
      else {
        *(undefined8 *)(pIVar2 + 0x30) = 0;
        IOAccelMemory::pruneOrphanedMappings(pIVar2,pIVar3,extraout_RDX);
        param_2 = extraout_RDX_00;
      }
    }
  }
  puVar4 = *(undefined8 **)(this + 0x28);
  while (puVar4 != (undefined8 *)0x0) {
    pIVar2 = (IOAccelMemory *)*puVar4;
    puVar4 = (undefined8 *)puVar4[1];
    if (*(IOAccelMemory **)(pIVar2 + 0x30) == param_1) {
      *(undefined8 *)(pIVar2 + 0x30) = 0;
      IOAccelMemory::pruneOrphanedMappings(pIVar2,pIVar3,param_2);
      param_2 = extraout_RDX_02;
    }
  }
  return;
}



// IOAccelOrphanedMemoryPool::removeMemory(IOAccelMemory*)

void __thiscall
IOAccelOrphanedMemoryPool::removeMemory(IOAccelOrphanedMemoryPool *this,long *param_1)

{
  uint uVar1;
  long lVar2;
  long lVar3;
  long *plVar4;
  IOAccelOrphanedMemoryPool *pIVar5;
  undefined8 *puVar6;
  undefined8 uVar7;
  char *pcVar8;
  undefined8 uVar9;
  
  lVar2 = param_1[4];
  param_1[4] = 0;
  uVar1 = *(uint *)(lVar2 + 0x28);
  lVar3 = *(long *)(lVar2 + 8);
  if ((*(byte *)((long)param_1 + 0xd) & 8) != 0) {
    if (lVar3 == 0) {
      plVar4 = *(long **)(lVar2 + 0x10);
      if (*plVar4 != lVar2) {
LAB_00054d9d:
        pcVar8 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
        goto LAB_00054dcb;
      }
      *(long **)(this + 0x20) = plVar4;
    }
    else {
      if (*(long *)(lVar3 + 0x10) != lVar2 + 8) {
        pcVar8 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
LAB_00054dcb:
        uVar7 = 0x107;
        uVar9 = 0x107;
        goto LAB_00054de0;
      }
      if (**(long **)(lVar2 + 0x10) != lVar2) goto LAB_00054d9d;
      *(long **)(lVar3 + 0x10) = *(long **)(lVar2 + 0x10);
      plVar4 = *(long **)(lVar2 + 0x10);
    }
    *plVar4 = lVar3;
    *(int *)(this + 0x40) = *(int *)(this + 0x40) + -1;
    lVar3 = (**(code **)(*param_1 + 0x120))(param_1);
    pIVar5 = this + 0x50;
    goto LAB_00054d41;
  }
  if (lVar3 == 0) {
    plVar4 = *(long **)(lVar2 + 0x10);
    if (*plVar4 != lVar2) {
LAB_00054d94:
      pcVar8 = "\"Bad tailq elm %p prev->next != elm @%u\" @%s:%d";
      goto LAB_00054dad;
    }
    *(long **)(this + 0x30) = plVar4;
  }
  else {
    if (*(long *)(lVar3 + 0x10) != lVar2 + 8) {
      pcVar8 = "\"Bad tailq elm %p next->prev != elm @%u\" @%s:%d";
LAB_00054dad:
      uVar7 = 0x10d;
      uVar9 = 0x10d;
LAB_00054de0:
                    // WARNING: Subroutine does not return
      _panic(pcVar8,lVar2,uVar7,"IOAccelMemoryPool.cpp",uVar9);
    }
    if (**(long **)(lVar2 + 0x10) != lVar2) goto LAB_00054d94;
    *(long **)(lVar3 + 0x10) = *(long **)(lVar2 + 0x10);
    plVar4 = *(long **)(lVar2 + 0x10);
  }
  *plVar4 = lVar3;
  *(int *)(this + 0x44) = *(int *)(this + 0x44) + -1;
  lVar3 = (**(code **)(*param_1 + 0x120))(param_1);
  pIVar5 = this + 0x58;
LAB_00054d41:
  *(long *)pIVar5 = *(long *)pIVar5 - lVar3;
  if (-1 < (int)uVar1) {
    if (*(long *)(lVar2 + 0x20) == 0) {
      puVar6 = (undefined8 *)((ulong)uVar1 * 8 + *(long *)(this + 0x38));
    }
    else {
      puVar6 = (undefined8 *)(*(long *)(lVar2 + 0x20) + 0x18);
    }
    *puVar6 = *(undefined8 *)(lVar2 + 0x18);
    if (*(long *)(lVar2 + 0x18) != 0) {
      *(undefined8 *)(*(long *)(lVar2 + 0x18) + 0x20) = *(undefined8 *)(lVar2 + 0x20);
    }
  }
  _IOFreeTypeImpl(&removeMemory(IOAccelMemory*)::kalloc_type_view_290,lVar2);
  return;
}



// IOAccelOrphanedMemoryPool::addMemory(IOAccelMemory*)

void __thiscall IOAccelOrphanedMemoryPool::addMemory(IOAccelOrphanedMemoryPool *this,long *param_1)

{
  long *plVar1;
  long lVar2;
  undefined8 *puVar3;
  long lVar4;
  ulong uVar5;
  uint uVar6;
  undefined8 local_28;
  
  puVar3 = (undefined8 *)_IOMallocTypeImpl(&addMemory(IOAccelMemory*)::kalloc_type_view_202);
  param_1[4] = (long)puVar3;
  *puVar3 = param_1;
  *(undefined4 *)((long)puVar3 + 0x2c) = *(undefined4 *)(*(long *)(this + 8) + 0xbc);
  if ((*(byte *)((long)param_1 + 0xd) & 8) == 0) {
    puVar3[1] = 0;
    plVar1 = *(long **)(this + 0x30);
    puVar3[2] = plVar1;
    *plVar1 = (long)puVar3;
    *(undefined8 **)(this + 0x30) = puVar3 + 1;
    *(undefined4 *)(puVar3 + 5) = 0xffffffff;
    puVar3[3] = 0;
    puVar3[4] = 0;
    *(int *)(this + 0x44) = *(int *)(this + 0x44) + 1;
    lVar4 = (**(code **)(*param_1 + 0x120))(param_1);
    *(long *)(this + 0x58) = *(long *)(this + 0x58) + lVar4;
    IOGraphicsAccelerator2::kickNonReusableOrphanedMemoryPoolCollector
              (*(IOGraphicsAccelerator2 **)(this + 8),'\x01');
    return;
  }
  local_28 = (**(code **)(*param_1 + 0x120))(param_1);
  puVar3[1] = 0;
  plVar1 = *(long **)(this + 0x20);
  puVar3[2] = plVar1;
  *plVar1 = (long)puVar3;
  *(undefined8 **)(this + 0x20) = puVar3 + 1;
  lVar4 = 0;
  uVar6 = 0;
  do {
    uVar6 = ((int)*(char *)((long)&local_28 + lVar4) + uVar6) * 0x401;
    uVar6 = uVar6 >> 6 ^ uVar6;
    lVar4 = lVar4 + 1;
  } while (lVar4 != 8);
  uVar6 = (uVar6 * 9 >> 0xb ^ uVar6 * 9) & 0x3ff;
  uVar5 = (ulong)uVar6;
  *(uint *)(puVar3 + 5) = uVar6;
  lVar4 = *(long *)(this + 0x38);
  puVar3[3] = *(undefined8 *)(lVar4 + uVar5 * 8);
  puVar3[4] = 0;
  lVar2 = *(long *)(lVar4 + uVar5 * 8);
  if (lVar2 != 0) {
    *(undefined8 **)(lVar2 + 0x20) = puVar3;
  }
  *(undefined8 **)(lVar4 + uVar5 * 8) = puVar3;
  *(int *)(this + 0x40) = *(int *)(this + 0x40) + 1;
  lVar4 = (**(code **)(*param_1 + 0x120))(param_1);
  *(long *)(this + 0x50) = *(long *)(this + 0x50) + lVar4;
  IOGraphicsAccelerator2::kickReusableOrphanedMemoryPoolCollector
            (*(IOGraphicsAccelerator2 **)(this + 8));
  return;
}



// IOAccelOrphanedMemoryPool::getMemory(IOAccelShared2*, IOAccelResource2*, unsigned long long,
// void*)

IOAccelMemory * __thiscall
IOAccelOrphanedMemoryPool::getMemory
          (IOAccelOrphanedMemoryPool *this,long param_1,undefined8 param_2,undefined8 param_3,
          undefined8 param_4)

{
  IOAccelMemory *this_00;
  long lVar1;
  char cVar2;
  long lVar3;
  undefined8 uVar4;
  uint uVar5;
  long *plVar6;
  undefined8 *puVar7;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 local_48;
  undefined8 local_40;
  IOAccelOrphanedMemoryPool *local_38;
  
  local_58 = param_3;
  lVar3 = 0;
  uVar5 = 0;
  do {
    uVar5 = ((int)*(char *)((long)&local_58 + lVar3) + uVar5) * 0x401;
    uVar5 = uVar5 >> 6 ^ uVar5;
    lVar3 = lVar3 + 1;
  } while (lVar3 != 8);
  if (param_1 == 0) {
    plVar6 = (long *)(*(long *)(this + 8) + 0x150);
  }
  else {
    plVar6 = (long *)(param_1 + 0x88);
  }
  puVar7 = *(undefined8 **)
            (*(long *)(this + 0x38) + (ulong)((uVar5 * 9 >> 0xb ^ uVar5 * 9) & 0x3ff) * 8);
  local_38 = this;
  if (puVar7 != (undefined8 *)0x0) {
    lVar3 = *plVar6;
    local_50 = param_4;
    local_48 = param_3;
    local_40 = param_2;
    do {
      this_00 = (IOAccelMemory *)*puVar7;
      lVar1 = *(long *)(this_00 + 0x30);
      if (((param_1 == 0 && lVar1 == 0) ||
          (((param_1 != 0 && (lVar1 != 0)) && (*(long *)(param_1 + 0x80) == *(long *)(lVar1 + 0x80))
           ))) && (uVar4 = IOAccelMemory::testAllEvent(this_00), (char)uVar4 != '\0')) {
        if (lVar1 == 0) {
          plVar6 = (long *)(*(long *)(local_38 + 8) + 0x150);
        }
        else {
          plVar6 = (long *)(lVar1 + 0x88);
        }
        if ((lVar3 == *plVar6) &&
           (cVar2 = (**(code **)(*(long *)this_00 + 0x178))(this_00,local_50,local_48),
           cVar2 != '\0')) {
          (**(code **)(*(long *)this_00 + 0x20))(this_00);
          (**(code **)(*(long *)this_00 + 0x1c8))(this_00,param_1);
          *(undefined8 *)(this_00 + 0x38) = local_40;
          *(int *)(local_38 + 0x60) = *(int *)(local_38 + 0x60) + 1;
          return this_00;
        }
      }
      puVar7 = (undefined8 *)puVar7[3];
    } while (puVar7 != (undefined8 *)0x0);
  }
  *(int *)(local_38 + 100) = *(int *)(local_38 + 100) + 1;
  return (IOAccelMemory *)0x0;
}



// IOAccelOrphanedMemoryPool::freeWaitToPrepareMap(IOAccelMemoryMap*, bool)

ulong __thiscall
IOAccelOrphanedMemoryPool::freeWaitToPrepareMap
          (IOAccelOrphanedMemoryPool *this,long *param_1,undefined4 param_2)

{
  IOAccelMemory *pIVar1;
  char cVar2;
  int iVar3;
  IOAccelOrphanedMemoryPool *pIVar4;
  long lVar5;
  IOAccelOrphanedMemoryPool *pIVar6;
  undefined8 uVar7;
  undefined8 uVar8;
  uint uVar9;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 extraout_RDX_01;
  undefined8 *puVar10;
  ulong uVar11;
  IOAccelOrphanedMemoryPool *local_40;
  undefined4 local_34;
  
  local_34 = param_2;
  pIVar4 = (IOAccelOrphanedMemoryPool *)(**(code **)(*param_1 + 0x168))(param_1);
  local_40 = pIVar4;
  lVar5 = 0;
  uVar9 = 0;
  do {
    uVar9 = ((int)*(char *)((long)&local_40 + lVar5) + uVar9) * 0x401;
    uVar11 = (ulong)uVar9;
    uVar9 = uVar9 >> 6 ^ uVar9;
    lVar5 = lVar5 + 1;
  } while (lVar5 != 8);
  puVar10 = *(undefined8 **)
             (*(long *)(this + 0x38) + (ulong)((uVar9 * 9 >> 0xb ^ uVar9 * 9) & 0x3ff) * 8);
LAB_000550d6:
  do {
    do {
      if (puVar10 == (undefined8 *)0x0) {
        puVar10 = *(undefined8 **)(this + 0x18);
        this = (IOAccelOrphanedMemoryPool *)0x0;
        if (puVar10 != (undefined8 *)0x0) goto LAB_0005513a;
        goto LAB_00055192;
      }
      pIVar1 = (IOAccelMemory *)*puVar10;
      puVar10 = (undefined8 *)puVar10[3];
      pIVar6 = (IOAccelOrphanedMemoryPool *)(**(code **)(*(long *)pIVar1 + 0x120))(pIVar1);
    } while (pIVar6 != pIVar4);
    if ((char)local_34 == '\0') {
      uVar7 = IOAccelMemory::testAllEvent(pIVar1);
      uVar8 = extraout_RDX_00;
      if ((char)uVar7 == '\0') goto LAB_000550d6;
    }
    else {
      IOAccelMemory::finishAllEvent(pIVar1);
      uVar8 = extraout_RDX;
    }
    IOAccelMemory::pruneOrphanedMappings(pIVar1,uVar11,uVar8);
    cVar2 = (**(code **)(*param_1 + 0x138))(param_1);
  } while (cVar2 == '\0');
LAB_00055128:
  this = (IOAccelOrphanedMemoryPool *)CONCAT71((int7)((ulong)this >> 8),1);
  goto LAB_00055192;
LAB_0005513a:
  do {
    pIVar1 = (IOAccelMemory *)*puVar10;
    puVar10 = (undefined8 *)puVar10[1];
    if ((char)local_34 == '\0') {
      uVar8 = IOAccelMemory::testAllEvent(pIVar1);
      if ((char)uVar8 != '\0') goto LAB_0005515d;
    }
    else {
      IOAccelMemory::finishAllEvent(pIVar1);
LAB_0005515d:
      iVar3 = (**(code **)(*(long *)pIVar1 + 0x120))(pIVar1);
      this = (IOAccelOrphanedMemoryPool *)(ulong)(uint)((int)this + iVar3);
      IOAccelMemory::pruneOrphanedMappings(pIVar1,uVar11,extraout_RDX_01);
      if (pIVar4 <= this) {
        cVar2 = (**(code **)(*param_1 + 0x138))(param_1);
        if (cVar2 != '\0') goto LAB_00055128;
      }
    }
  } while (puVar10 != (undefined8 *)0x0);
  this = (IOAccelOrphanedMemoryPool *)0x0;
LAB_00055192:
  return (ulong)this & 0xffffffff;
}



// IOAccelOrphanedMemoryPool::freeWaitToPrepareMemory(IOAccelMemory*, bool)

ulong __thiscall
IOAccelOrphanedMemoryPool::freeWaitToPrepareMemory
          (IOAccelOrphanedMemoryPool *this,long *param_1,undefined4 param_2)

{
  IOAccelMemory *pIVar1;
  char cVar2;
  int iVar3;
  IOAccelOrphanedMemoryPool *pIVar4;
  long lVar5;
  IOAccelOrphanedMemoryPool *pIVar6;
  undefined8 uVar7;
  undefined8 uVar8;
  uint uVar9;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 extraout_RDX_01;
  undefined8 *puVar10;
  ulong uVar11;
  IOAccelOrphanedMemoryPool *local_40;
  undefined4 local_34;
  
  local_34 = param_2;
  pIVar4 = (IOAccelOrphanedMemoryPool *)(**(code **)(*param_1 + 0x120))(param_1);
  local_40 = pIVar4;
  lVar5 = 0;
  uVar9 = 0;
  do {
    uVar9 = ((int)*(char *)((long)&local_40 + lVar5) + uVar9) * 0x401;
    uVar11 = (ulong)uVar9;
    uVar9 = uVar9 >> 6 ^ uVar9;
    lVar5 = lVar5 + 1;
  } while (lVar5 != 8);
  puVar10 = *(undefined8 **)
             (*(long *)(this + 0x38) + (ulong)((uVar9 * 9 >> 0xb ^ uVar9 * 9) & 0x3ff) * 8);
LAB_0005520c:
  do {
    do {
      if (puVar10 == (undefined8 *)0x0) {
        puVar10 = *(undefined8 **)(this + 0x18);
        this = (IOAccelOrphanedMemoryPool *)0x0;
        if (puVar10 != (undefined8 *)0x0) goto LAB_00055270;
        goto LAB_000552c8;
      }
      pIVar1 = (IOAccelMemory *)*puVar10;
      puVar10 = (undefined8 *)puVar10[3];
      pIVar6 = (IOAccelOrphanedMemoryPool *)(**(code **)(*(long *)pIVar1 + 0x120))(pIVar1);
    } while (pIVar6 != pIVar4);
    if ((char)local_34 == '\0') {
      uVar7 = IOAccelMemory::testAllEvent(pIVar1);
      uVar8 = extraout_RDX_00;
      if ((char)uVar7 == '\0') goto LAB_0005520c;
    }
    else {
      IOAccelMemory::finishAllEvent(pIVar1);
      uVar8 = extraout_RDX;
    }
    IOAccelMemory::pruneOrphanedMappings(pIVar1,uVar11,uVar8);
    cVar2 = (**(code **)(*param_1 + 0x148))(param_1);
  } while (cVar2 == '\0');
LAB_0005525e:
  this = (IOAccelOrphanedMemoryPool *)CONCAT71((int7)((ulong)this >> 8),1);
  goto LAB_000552c8;
LAB_00055270:
  do {
    pIVar1 = (IOAccelMemory *)*puVar10;
    puVar10 = (undefined8 *)puVar10[1];
    if ((char)local_34 == '\0') {
      uVar8 = IOAccelMemory::testAllEvent(pIVar1);
      if ((char)uVar8 != '\0') goto LAB_00055293;
    }
    else {
      IOAccelMemory::finishAllEvent(pIVar1);
LAB_00055293:
      iVar3 = (**(code **)(*(long *)pIVar1 + 0x120))(pIVar1);
      this = (IOAccelOrphanedMemoryPool *)(ulong)(uint)((int)this + iVar3);
      IOAccelMemory::pruneOrphanedMappings(pIVar1,uVar11,extraout_RDX_01);
      if (pIVar4 <= this) {
        cVar2 = (**(code **)(*param_1 + 0x148))(param_1);
        if (cVar2 != '\0') goto LAB_0005525e;
      }
    }
  } while (puVar10 != (undefined8 *)0x0);
  this = (IOAccelOrphanedMemoryPool *)0x0;
LAB_000552c8:
  return (ulong)this & 0xffffffff;
}



// IOAccelOrphanedVidMemoryPool::freeWaitToPrepareMap(IOAccelMemoryMap*, bool)

ulong __thiscall
IOAccelOrphanedVidMemoryPool::freeWaitToPrepareMap
          (IOAccelOrphanedVidMemoryPool *this,long *param_1,undefined4 param_2)

{
  IOAccelVidMemory *pIVar1;
  bool bVar2;
  char cVar3;
  int iVar4;
  IOAccelOrphanedVidMemoryPool *pIVar5;
  long lVar6;
  IOAccelOrphanedVidMemoryPool *pIVar7;
  undefined8 uVar8;
  undefined8 uVar9;
  uint uVar10;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 extraout_RDX_01;
  undefined8 extraout_RDX_02;
  undefined8 *puVar11;
  ulong uVar12;
  IOAccelOrphanedVidMemoryPool *local_40;
  undefined4 local_34;
  
  local_34 = param_2;
  pIVar5 = (IOAccelOrphanedVidMemoryPool *)(**(code **)(*param_1 + 0x168))(param_1);
  local_40 = pIVar5;
  lVar6 = 0;
  uVar10 = 0;
  do {
    uVar10 = ((int)*(char *)((long)&local_40 + lVar6) + uVar10) * 0x401;
    uVar12 = (ulong)uVar10;
    uVar10 = uVar10 >> 6 ^ uVar10;
    lVar6 = lVar6 + 1;
  } while (lVar6 != 8);
  puVar11 = *(undefined8 **)
             (*(long *)(this + 0x38) + (ulong)((uVar10 * 9 >> 0xb ^ uVar10 * 9) & 0x3ff) * 8);
LAB_00055342:
  do {
    do {
      if (puVar11 == (undefined8 *)0x0) {
        puVar11 = *(undefined8 **)(this + 0x18);
        this = (IOAccelOrphanedVidMemoryPool *)0x0;
        if (puVar11 != (undefined8 *)0x0) goto LAB_000553b2;
        goto LAB_00055416;
      }
      pIVar1 = (IOAccelVidMemory *)*puVar11;
      puVar11 = (undefined8 *)puVar11[3];
      pIVar7 = (IOAccelOrphanedVidMemoryPool *)(**(code **)(*(long *)pIVar1 + 0x120))(pIVar1);
    } while (pIVar7 != pIVar5);
    if ((char)local_34 == '\0') {
      uVar8 = IOAccelMemory::testAllEvent((IOAccelMemory *)pIVar1);
      uVar9 = extraout_RDX_01;
      if ((char)uVar8 == '\0') goto LAB_00055342;
    }
    else {
      bVar2 = IOAccelVidMemory::canDoAsyncPageTableUpdate(pIVar1);
      uVar9 = extraout_RDX;
      if (!bVar2) {
        IOAccelMemory::finishAllEvent((IOAccelMemory *)pIVar1);
        uVar9 = extraout_RDX_00;
      }
    }
    IOAccelMemory::pruneOrphanedMappings((IOAccelMemory *)pIVar1,uVar12,uVar9);
    cVar3 = (**(code **)(*param_1 + 0x138))(param_1);
  } while (cVar3 == '\0');
LAB_000553a0:
  this = (IOAccelOrphanedVidMemoryPool *)CONCAT71((int7)((ulong)this >> 8),1);
  goto LAB_00055416;
LAB_000553b2:
  do {
    pIVar1 = (IOAccelVidMemory *)*puVar11;
    puVar11 = (undefined8 *)puVar11[1];
    if ((char)local_34 == '\0') {
      uVar9 = IOAccelMemory::testAllEvent((IOAccelMemory *)pIVar1);
      if ((char)uVar9 != '\0') goto LAB_000553e1;
    }
    else {
      bVar2 = IOAccelVidMemory::canDoAsyncPageTableUpdate(pIVar1);
      if (!bVar2) {
        IOAccelMemory::finishAllEvent((IOAccelMemory *)pIVar1);
      }
LAB_000553e1:
      iVar4 = (**(code **)(*(long *)pIVar1 + 0x120))(pIVar1);
      this = (IOAccelOrphanedVidMemoryPool *)(ulong)(uint)((int)this + iVar4);
      IOAccelMemory::pruneOrphanedMappings((IOAccelMemory *)pIVar1,uVar12,extraout_RDX_02);
      if (pIVar5 <= this) {
        cVar3 = (**(code **)(*param_1 + 0x138))(param_1);
        if (cVar3 != '\0') goto LAB_000553a0;
      }
    }
  } while (puVar11 != (undefined8 *)0x0);
  this = (IOAccelOrphanedVidMemoryPool *)0x0;
LAB_00055416:
  return (ulong)this & 0xffffffff;
}



// IOAccelOrphanedVidMemoryPool::freeWaitToPrepareMemory(IOAccelMemory*, bool)

ulong __thiscall
IOAccelOrphanedVidMemoryPool::freeWaitToPrepareMemory
          (IOAccelOrphanedVidMemoryPool *this,long *param_1,undefined4 param_2)

{
  IOAccelVidMemory *pIVar1;
  bool bVar2;
  char cVar3;
  int iVar4;
  IOAccelOrphanedVidMemoryPool *pIVar5;
  long lVar6;
  IOAccelOrphanedVidMemoryPool *pIVar7;
  undefined8 uVar8;
  undefined8 uVar9;
  uint uVar10;
  undefined8 extraout_RDX;
  undefined8 extraout_RDX_00;
  undefined8 extraout_RDX_01;
  undefined8 extraout_RDX_02;
  undefined8 *puVar11;
  ulong uVar12;
  IOAccelOrphanedVidMemoryPool *local_40;
  undefined4 local_34;
  
  local_34 = param_2;
  pIVar5 = (IOAccelOrphanedVidMemoryPool *)(**(code **)(*param_1 + 0x120))(param_1);
  local_40 = pIVar5;
  lVar6 = 0;
  uVar10 = 0;
  do {
    uVar10 = ((int)*(char *)((long)&local_40 + lVar6) + uVar10) * 0x401;
    uVar12 = (ulong)uVar10;
    uVar10 = uVar10 >> 6 ^ uVar10;
    lVar6 = lVar6 + 1;
  } while (lVar6 != 8);
  puVar11 = *(undefined8 **)
             (*(long *)(this + 0x38) + (ulong)((uVar10 * 9 >> 0xb ^ uVar10 * 9) & 0x3ff) * 8);
LAB_00055490:
  do {
    do {
      if (puVar11 == (undefined8 *)0x0) {
        puVar11 = *(undefined8 **)(this + 0x18);
        this = (IOAccelOrphanedVidMemoryPool *)0x0;
        if (puVar11 != (undefined8 *)0x0) goto LAB_00055500;
        goto LAB_00055564;
      }
      pIVar1 = (IOAccelVidMemory *)*puVar11;
      puVar11 = (undefined8 *)puVar11[3];
      pIVar7 = (IOAccelOrphanedVidMemoryPool *)(**(code **)(*(long *)pIVar1 + 0x120))(pIVar1);
    } while (pIVar7 != pIVar5);
    if ((char)local_34 == '\0') {
      uVar8 = IOAccelMemory::testAllEvent((IOAccelMemory *)pIVar1);
      uVar9 = extraout_RDX_01;
      if ((char)uVar8 == '\0') goto LAB_00055490;
    }
    else {
      bVar2 = IOAccelVidMemory::canDoAsyncPageTableUpdate(pIVar1);
      uVar9 = extraout_RDX;
      if (!bVar2) {
        IOAccelMemory::finishAllEvent((IOAccelMemory *)pIVar1);
        uVar9 = extraout_RDX_00;
      }
    }
    IOAccelMemory::pruneOrphanedMappings((IOAccelMemory *)pIVar1,uVar12,uVar9);
    cVar3 = (**(code **)(*param_1 + 0x148))(param_1);
  } while (cVar3 == '\0');
LAB_000554ee:
  this = (IOAccelOrphanedVidMemoryPool *)CONCAT71((int7)((ulong)this >> 8),1);
  goto LAB_00055564;
LAB_00055500:
  do {
    pIVar1 = (IOAccelVidMemory *)*puVar11;
    puVar11 = (undefined8 *)puVar11[1];
    if ((char)local_34 == '\0') {
      uVar9 = IOAccelMemory::testAllEvent((IOAccelMemory *)pIVar1);
      if ((char)uVar9 != '\0') goto LAB_0005552f;
    }
    else {
      bVar2 = IOAccelVidMemory::canDoAsyncPageTableUpdate(pIVar1);
      if (!bVar2) {
        IOAccelMemory::finishAllEvent((IOAccelMemory *)pIVar1);
      }
LAB_0005552f:
      iVar4 = (**(code **)(*(long *)pIVar1 + 0x120))(pIVar1);
      this = (IOAccelOrphanedVidMemoryPool *)(ulong)(uint)((int)this + iVar4);
      IOAccelMemory::pruneOrphanedMappings((IOAccelMemory *)pIVar1,uVar12,extraout_RDX_02);
      if (pIVar5 <= this) {
        cVar3 = (**(code **)(*param_1 + 0x148))(param_1);
        if (cVar3 != '\0') goto LAB_000554ee;
      }
    }
  } while (puVar11 != (undefined8 *)0x0);
  this = (IOAccelOrphanedVidMemoryPool *)0x0;
LAB_00055564:
  return (ulong)this & 0xffffffff;
}



// IOAccelSysMemory::MetaClass::MetaClass()

void __thiscall IOAccelSysMemory::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelSysMemory",(OSMetaClass *)&IOAccelMemory::gMetaClass,0x198)
  ;
  *(undefined ***)this = &PTR__MetaClass_00081798;
  return;
}



// IOAccelSysMemory::MetaClass::~MetaClass()

void __thiscall IOAccelSysMemory::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelSysMemory::IOAccelSysMemory(OSMetaClass const*)

void __thiscall IOAccelSysMemory::IOAccelSysMemory(IOAccelSysMemory *this,OSMetaClass *param_1)

{
  IOAccelMemory::IOAccelMemory((IOAccelMemory *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelSysMemory_00081570;
  return;
}



// IOAccelSysMemory::IOAccelSysMemory(OSMetaClass const*)

void __thiscall IOAccelSysMemory::IOAccelSysMemory(IOAccelSysMemory *this,OSMetaClass *param_1)

{
  IOAccelMemory::IOAccelMemory((IOAccelMemory *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelSysMemory_00081570;
  return;
}



// IOAccelSysMemory::~IOAccelSysMemory()

void __thiscall IOAccelSysMemory::~IOAccelSysMemory(IOAccelSysMemory *this)

{
  IOAccelMemory::~IOAccelMemory((IOAccelMemory *)this);
  return;
}



// IOAccelSysMemory::~IOAccelSysMemory()

void __thiscall IOAccelSysMemory::~IOAccelSysMemory(IOAccelSysMemory *this)

{
  IOAccelMemory::~IOAccelMemory((IOAccelMemory *)this);
  return;
}



// IOAccelSysMemory::~IOAccelSysMemory()

void __thiscall IOAccelSysMemory::~IOAccelSysMemory(IOAccelSysMemory *this)

{
  IOAccelMemory::~IOAccelMemory((IOAccelMemory *)this);
  _OSObject_typed_operator_delete(&IOAccelSysMemory_ktv,this,0x198);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSysMemory::operator delete(void*, unsigned long)

void __cdecl IOAccelSysMemory::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelSysMemory_ktv,param_1,param_2);
  return;
}



// IOAccelSysMemory::getMetaClass() const

undefined1 * IOAccelSysMemory::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelSysMemory::MetaClass::MetaClass()

void __thiscall IOAccelSysMemory::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelSysMemory",(OSMetaClass *)&IOAccelMemory::gMetaClass,0x198)
  ;
  *(undefined ***)this = &PTR__MetaClass_00081798;
  return;
}



// IOAccelSysMemory::MetaClass::alloc() const

undefined8 IOAccelSysMemory::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelSysMemory::operator new(unsigned long)

void * __thiscall IOAccelSysMemory::operator_new(IOAccelSysMemory *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelSysMemory_ktv,this);
  return pvVar1;
}



// IOAccelSysMemory::init(IOGraphicsAccelerator2*)

ulong __thiscall IOAccelSysMemory::init(IOAccelSysMemory *this,long param_1)

{
  bool bVar1;
  undefined7 extraout_var;
  
  bVar1 = IOAccelMemory::init((IOAccelMemory *)this,param_1);
  if (bVar1) {
    *(undefined8 *)(this + 0xe8) = 0;
    *(undefined2 *)(this + 0xf0) = 0;
    *(undefined8 *)(this + 0x188) = 0;
    *(undefined4 *)(this + 400) = 0;
    *(undefined8 *)(this + 0xd0) = 0;
    *(undefined4 *)(this + 0xc0) = 0;
    *(undefined8 *)(this + 200) = 0;
    *(undefined8 *)(this + 0xb8) = 0;
    *(undefined8 *)(this + 0xb0) = 0;
    this[0xc] = (IOAccelSysMemory)((byte)this[0xc] | 1);
    *(undefined4 *)(this + 0xd8) = 0;
    *(undefined8 *)(this + 0xe0) = 0;
    IOAccelSysMemoryList::addMemory((IOAccelSysMemoryList *)(param_1 + 0xb30),(long)this);
    (**(code **)(**(long **)(param_1 + 0x380) + 0x140))(*(long **)(param_1 + 0x380),this + 0x108);
    *(undefined8 *)(this + 0x148) = 0;
  }
  return CONCAT71(extraout_var,bVar1) & 0xffffffff;
}



// IOAccelSysMemory::free()

void __thiscall IOAccelSysMemory::free(IOAccelSysMemory *this)

{
  int *piVar1;
  long lVar2;
  long lVar3;
  ulong uVar4;
  
  if (*(long *)(this + 0xe8) != 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: still have %d outstanding fCPULockedUserMapping\n",
                      "virtual void IOAccelSysMemory::free()",(int)*(short *)(this + 0xf0));
    (**(code **)(**(long **)(this + 0xe8) + 0x28))();
    *(undefined8 *)(this + 0xe8) = 0;
    *(undefined2 *)(this + 0xf0) = 0;
  }
  if (*(long *)(this + 0x188) != 0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                      "%s: still have %d outstanding fCPULockedKernMapping\n",
                      "virtual void IOAccelSysMemory::free()",*(undefined4 *)(this + 400));
    (**(code **)(**(long **)(this + 0x188) + 0x28))();
    *(undefined8 *)(this + 0x188) = 0;
  }
  if (((byte)this[0xc] & 2) != 0) {
    (**(code **)(*(long *)this + 0x1b8))(this);
  }
  if ((*(IOAccelShared2 **)(this + 0x30) != (IOAccelShared2 *)0x0) &&
     (((byte)this[0xc] & 0x40) != 0)) {
    IOAccelShared2::remove_client_memory
              (*(IOAccelShared2 **)(this + 0x30),(long)this,*(long *)(this + 200),
               *(long *)(this + 0x40));
    *(undefined8 *)(this + 0x30) = 0;
  }
  if (*(long **)(this + 0xd0) != (long *)0x0) {
    (**(code **)(**(long **)(this + 0xd0) + 0x28))();
    *(undefined8 *)(this + 0xd0) = 0;
  }
  lVar3 = *(long *)(this + 0xf8);
  if (lVar3 != 0) {
    if (*(int *)(this + 0x100) == 0) {
      lVar2 = 0;
    }
    else {
      uVar4 = 0;
      do {
        (**(code **)(**(long **)(*(long *)(this + 0xf8) + uVar4 * 8) + 0x28))();
        uVar4 = uVar4 + 1;
      } while (uVar4 < *(uint *)(this + 0x100));
      lVar3 = *(long *)(this + 0xf8);
      lVar2 = (ulong)*(uint *)(this + 0x100) << 3;
    }
    *(undefined8 *)(this + 0xf8) = 0;
    _IOFreeTypeVarImpl(&free()::kalloc_type_view_97,lVar3,lVar2);
    *(undefined8 *)(this + 0xf8) = 0;
  }
  lVar3 = *(long *)(this + 0x28);
  IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(lVar3 + 0x388) + 0x58),0x4e);
  piVar1 = (int *)(lVar3 + 0x2d8);
  *piVar1 = *piVar1 + -1;
  IOAccelSysMemoryList::removeMemory
            ((IOAccelSysMemoryList *)(*(long *)(this + 0x28) + 0xb30),(long)this);
  if (((byte)this[0xd] & 4) != 0) {
    IOAccelOrphanedMemoryPool::removeMemory
              ((IOAccelOrphanedMemoryPool *)(*(long *)(this + 0x28) + 0xb60),(long *)this);
  }
  IOAccelMemory::free((IOAccelMemory *)this);
  return;
}



// IOAccelSysMemory::orphanIt()

void __thiscall IOAccelSysMemory::orphanIt(IOAccelSysMemory *this)

{
  uint uVar1;
  uint uVar2;
  long *plVar3;
  undefined8 *puVar4;
  IOAccelBufferMemoryDescriptorPool2 *this_00;
  undefined1 *local_58;
  undefined1 *local_50;
  undefined1 *local_48;
  undefined1 *local_40;
  undefined1 *local_38;
  undefined1 *local_30;
  undefined1 *local_28;
  undefined1 *local_20;
  
  IOAccelMemory::orphanIt((IOAccelMemory *)this);
  uVar1 = *(uint *)(this + 0xc);
  uVar2 = uVar1 | 1;
  *(uint *)(this + 0xc) = uVar2;
  if ((*(IOAccelShared2 **)(this + 0x30) != (IOAccelShared2 *)0x0) && ((uVar1 & 0x40) != 0)) {
    IOAccelShared2::remove_client_memory
              (*(IOAccelShared2 **)(this + 0x30),(long)this,*(long *)(this + 200),
               *(long *)(this + 0x40));
    *(undefined8 *)(this + 0x30) = 0;
    uVar2 = *(uint *)(this + 0xc);
  }
  if ((uVar2 >> 0xd & 1) != 0) {
    local_20 = &DAT_aaaaaaaaaaaaaaaa;
    local_28 = &DAT_aaaaaaaaaaaaaaaa;
    local_30 = &DAT_aaaaaaaaaaaaaaaa;
    local_38 = &DAT_aaaaaaaaaaaaaaaa;
    local_40 = &DAT_aaaaaaaaaaaaaaaa;
    local_48 = &DAT_aaaaaaaaaaaaaaaa;
    local_50 = &DAT_aaaaaaaaaaaaaaaa;
    local_58 = &DAT_aaaaaaaaaaaaaaaa;
    plVar3 = (long *)IOAccelMemory::getEventMachine((IOAccelMemory *)this);
    (**(code **)(*plVar3 + 0x140))(plVar3,&local_58);
    IOAccelMemory::merge_mapping_events((IOAccelMemory *)this,&local_58);
    if (*(int *)(*(long *)(this + 0x28) + 0x9bc) == 0) {
      this_00 = (IOAccelBufferMemoryDescriptorPool2 *)0x0;
    }
    else {
      this_00 = *(IOAccelBufferMemoryDescriptorPool2 **)(*(long *)(this + 0x28) + 0xc30);
    }
    puVar4 = (undefined8 *)PTR__kernel_task_0006b100;
    if (*(long *)(this + 0x30) != 0) {
      puVar4 = (undefined8 *)(*(long *)(this + 0x30) + 0x80);
    }
    IOAccelBufferMemoryDescriptorPool2::releaseDescriptors
              (this_00,*(long *)(this + 0xf8),*(uint *)(this + 0x100),*puVar4,&local_58);
    this[0xd] = (IOAccelSysMemory)((byte)this[0xd] & 0xf7);
  }
  IOAccelOrphanedMemoryPool::addMemory
            ((IOAccelOrphanedMemoryPool *)(*(long *)(this + 0x28) + 0xb60),(long *)this);
  IOMemoryDescriptor::setOwnership
            (*(task **)(this + 0xd0),(int)*(undefined8 *)PTR__kernel_task_0006b100,4);
  return;
}



// IOAccelSysMemory::unorphanIt(IOAccelShared2*)

void __thiscall IOAccelSysMemory::unorphanIt(IOAccelSysMemory *this,long param_1)

{
  IOAccelMemory::unorphanIt((IOAccelMemory *)this,param_1);
  IOAccelOrphanedMemoryPool::removeMemory
            ((IOAccelOrphanedMemoryPool *)(*(long *)(this + 0x28) + 0xb60),(long *)this);
  if (param_1 != 0) {
    IOMemoryDescriptor::setOwnership(*(task **)(this + 0xd0),(int)*(undefined8 *)(param_1 + 0x80),4)
    ;
    return;
  }
  return;
}



// IOAccelSysMemory::matchForReuse(void*, unsigned long long)

undefined8 __thiscall
IOAccelSysMemory::matchForReuse(IOAccelSysMemory *this,int *param_1,long param_2)

{
  undefined8 uVar1;
  
  if (((((byte)this[0xd] & 8) == 0) || (*(long *)(this + 0x40) != param_2)) ||
     (*(int *)(this + 0xd8) != *param_1)) {
    uVar1 = 0;
  }
  else {
    uVar1 = CONCAT71((int7)((ulong)*(long *)(this + 0xe0) >> 8),
                     *(long *)(this + 0xe0) == *(long *)(param_1 + 2));
  }
  return uVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSysMemory::withClientBuffer(IOGraphicsAccelerator2*, task*, IOAccelShared2*, unsigned long
// long, unsigned long long)

long __cdecl
IOAccelSysMemory::withClientBuffer
          (long *param_1,undefined8 param_2,undefined8 param_3,ulong param_4,ulong param_5)

{
  vm_map_t vVar1;
  kern_return_t kVar2;
  int iVar3;
  ulong uVar4;
  undefined8 uVar5;
  long lVar6;
  long *plVar7;
  uint uVar8;
  undefined8 local_80;
  undefined1 *local_78;
  undefined1 *local_70;
  undefined1 *local_68;
  undefined4 local_60;
  ulong local_58;
  mach_vm_size_t local_50;
  ulong local_48;
  ulong local_40;
  vm_address_t local_38;
  
  uVar4 = (**(code **)(*param_1 + 0x988))();
  if (uVar4 < param_5) {
LAB_00055b0e:
    lVar6 = 0;
  }
  else {
    local_50 = 0;
    uVar8 = 3;
    plVar7 = (long *)&DAT_aaaaaaaaaaaaaaaa;
    uVar4 = 0;
    local_58 = param_4;
    local_48 = param_5;
    local_40 = param_4;
    do {
      local_38 = CONCAT44(local_38._4_4_,9);
      local_68 = &DAT_aaaaaaaaaaaaaaaa;
      local_70 = &DAT_aaaaaaaaaaaaaaaa;
      local_78 = &DAT_aaaaaaaaaaaaaaaa;
      local_80 = &DAT_aaaaaaaaaaaaaaaa;
      local_60 = 0xaaaaaaaa;
      if (local_50 != 0) {
        uVar4 = local_58 + local_50;
        local_50 = 0;
        local_58 = uVar4;
      }
      vVar1 = _get_task_map(param_2);
      kVar2 = _mach_vm_region(vVar1,&local_58,&local_50,9,(vm_region_info_t)&local_80,
                              (mach_msg_type_number_t *)&local_38,(mach_port_t *)0x0);
      if (kVar2 != 0) goto LAB_00055b0e;
      if ((local_40 < local_58 && uVar4 == 0) || (uVar4 != 0 && uVar4 != local_58))
      goto LAB_00055b0e;
      if (((uint)local_80 & local_80._4_4_ & 2) == 0) {
        uVar8 = 2;
      }
    } while (local_50 + local_58 < param_5 + param_4);
    if ((uVar8 == 2) && ((*(byte *)((long)param_1 + 0xcec) & 0x10) != 0)) {
      local_80 = (undefined1 *)0x0;
      local_38 = 0;
      uVar5 = _get_task_map(param_2);
      uVar4 = local_48;
      iVar3 = _vm_map_copyin(uVar5,local_40,local_48,0,&local_80);
      if (iVar3 == 0) {
        uVar5 = _get_task_map(param_2);
        iVar3 = _vm_map_copyout(uVar5,&local_38,local_80);
        if (iVar3 == 0) {
          plVar7 = (long *)(**(code **)(*param_1 + 0x910))(param_1,local_38,uVar4,0x10003,param_2);
          vVar1 = _get_task_map(param_2);
          _vm_deallocate(vVar1,local_38,uVar4);
          if (plVar7 == (long *)0x0) goto LAB_00055b0e;
        }
        else {
          _vm_map_copy_discard(local_80);
        }
      }
    }
    else {
      plVar7 = (long *)(**(code **)(*param_1 + 0x910))
                                 (param_1,local_40,local_48,uVar8 | 0x10000,param_2);
      if (plVar7 == (long *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: failed to get the memory descriptor\n",
                          "static IOAccelSysMemory *IOAccelSysMemory::withClientBuffer(IOGraphicsAccelerator2 *, task_t, IOAccelShared2 *, mach_vm_address_t, uint64_t)"
                         );
        return 0;
      }
    }
    lVar6 = (**(code **)(*param_1 + 0x8b8))(param_1);
    if (lVar6 == 0) {
      lVar6 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: allocIOAccelResource failed to alloc texture object\n",
                        "static IOAccelSysMemory *IOAccelSysMemory::withClientBuffer(IOGraphicsAccelerator2 *, task_t, IOAccelShared2 *, mach_vm_address_t, uint64_t)"
                       );
      (**(code **)(*plVar7 + 0x28))(plVar7);
    }
    else {
      *(long **)(lVar6 + 0xd0) = plVar7;
      *(undefined8 *)(lVar6 + 0x30) = param_3;
      *(byte *)(lVar6 + 0xc) = *(byte *)(lVar6 + 0xc) | 0x40;
      *(ulong *)(lVar6 + 200) = local_40;
      *(ulong *)(lVar6 + 0x40) = local_48;
      *(undefined4 *)(lVar6 + 0xc0) = 0;
      IOSimpleReporter::incrementValue(*(ulonglong *)(param_1[0x71] + 0x58),0x4e);
      *(int *)(param_1 + 0x5b) = (int)param_1[0x5b] + 1;
    }
  }
  return lVar6;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSysMemory::withOptions(IOGraphicsAccelerator2*, task*, IOAccelShared2*, IOAccelResource2*,
// unsigned int, unsigned long long)

void __cdecl
IOAccelSysMemory::withOptions
          (IOGraphicsAccelerator2 *param_1,undefined8 param_2,long param_3,undefined8 param_4,
          uint param_5,ulong param_6)

{
  withOptions(param_1,param_2,param_3,param_4,param_5,param_6);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSysMemory::withOptions(IOGraphicsAccelerator2*, task*, IOAccelShared2*, IOAccelResource2*,
// unsigned int, unsigned long long, bool)

IOAccelMemory * __cdecl
IOAccelSysMemory::withOptions
          (IOGraphicsAccelerator2 *param_1,undefined8 param_2,long param_3,undefined8 param_4,
          uint param_5,ulong param_6)

{
  bool bVar1;
  IOGraphicsAccelerator2 *pIVar2;
  ulong uVar3;
  long *plVar4;
  task *ptVar5;
  IOMemoryDescriptor **ppIVar6;
  IOAccelMemory *this;
  ulong uVar7;
  IOAccelBufferMemoryDescriptorPool2 *this_00;
  uint uVar8;
  undefined1 *local_d0;
  undefined1 *local_c8;
  undefined1 *local_c0;
  undefined1 *local_b8;
  undefined1 *local_b0;
  undefined1 *local_a8;
  undefined1 *local_a0;
  undefined1 *local_98;
  long local_90;
  ulong local_88;
  task *local_80;
  task *local_78;
  undefined8 local_70;
  IOMemoryDescriptor **local_68;
  IOMemoryDescriptor **local_60;
  long local_58;
  undefined8 local_50;
  uint local_44;
  IOGraphicsAccelerator2 *local_40;
  uint local_38;
  byte local_31;
  
  local_31 = 0;
  local_98 = &DAT_aaaaaaaaaaaaaaaa;
  local_a0 = &DAT_aaaaaaaaaaaaaaaa;
  local_a8 = &DAT_aaaaaaaaaaaaaaaa;
  local_b0 = &DAT_aaaaaaaaaaaaaaaa;
  local_b8 = &DAT_aaaaaaaaaaaaaaaa;
  local_c0 = &DAT_aaaaaaaaaaaaaaaa;
  local_c8 = &DAT_aaaaaaaaaaaaaaaa;
  local_d0 = &DAT_aaaaaaaaaaaaaaaa;
  local_44 = 0;
  local_38 = param_5;
  uVar3 = (**(code **)(*(long *)param_1 + 0x988))();
  if (uVar3 < param_6) {
    return (IOAccelMemory *)0x0;
  }
  local_40 = param_1;
  if (*(int *)(param_1 + 0x9bc) == 0) {
    local_60 = (IOMemoryDescriptor **)0x0;
  }
  else {
    local_60 = (IOMemoryDescriptor **)0x0;
    if (((local_38 & 0xa10890) == 0) && (*(long *)(param_1 + 0xc30) != 0)) {
      (**(code **)(**(long **)(param_1 + 0x380) + 0x140))(*(long **)(param_1 + 0x380),&local_d0);
      plVar4 = (long *)PTR__kernel_task_0006b100;
      if (param_3 != 0) {
        plVar4 = (long *)(param_3 + 0x80);
      }
      if (*(int *)(local_40 + 0x9bc) == 0) {
        this_00 = (IOAccelBufferMemoryDescriptorPool2 *)0x0;
      }
      else {
        this_00 = *(IOAccelBufferMemoryDescriptorPool2 **)(local_40 + 0xc30);
      }
      local_60 = IOAccelBufferMemoryDescriptorPool2::newWiredDescriptorsWithLength
                           (this_00,param_6,&local_44,*plVar4,&local_d0,param_3 == 0,&local_31);
      if (local_60 == (IOMemoryDescriptor **)0x0) {
        local_60 = (IOMemoryDescriptor **)0x0;
      }
      else {
        ptVar5 = (task *)IOMultiMemoryDescriptor::withDescriptors(local_60,local_44,3,true);
        if (ptVar5 != (task *)0x0) {
          local_58 = param_3;
          local_50 = param_4;
          IOMemoryDescriptor::setVMTags((uint)ptVar5,0);
          bVar1 = true;
          goto LAB_0005616b;
        }
      }
    }
  }
  if (0xc0000000 < param_6) {
    local_90 = ((param_6 - 1) / 0xc0000000) * 8 + 8;
    ppIVar6 = (IOMemoryDescriptor **)
              _IOMallocTypeVarImpl
                        (&withOptions(IOGraphicsAccelerator2*,task*,IOAccelShared2*,IOAccelResource2*,unsigned_int,unsigned_long_long,bool)
                          ::kalloc_type_view_389);
    pIVar2 = local_40;
    if (ppIVar6 != (IOMemoryDescriptor **)0x0) {
      uVar3 = 0;
      local_88 = param_6;
      local_70 = param_2;
      local_68 = ppIVar6;
      local_58 = param_3;
      local_50 = param_4;
LAB_00055fce:
      uVar7 = 0xc0000000;
      if (param_6 < 0xc0000000) {
        uVar7 = param_6;
      }
      local_78 = (task *)(**(code **)(*(long *)pIVar2 + 0x928))(pIVar2,local_70,local_38,uVar7,1);
      ppIVar6 = local_68;
      local_68[uVar3] = (IOMemoryDescriptor *)local_78;
      if (local_78 != (task *)0x0) goto code_r0x00056010;
      if ((int)uVar3 != 0) {
        uVar7 = 0;
        do {
          (**(code **)(*(long *)ppIVar6[uVar7] + 0x28))();
          ppIVar6[uVar7] = (IOMemoryDescriptor *)0x0;
          uVar7 = uVar7 + 1;
        } while (uVar3 != uVar7);
      }
      _IOFreeTypeVarImpl(&withOptions(IOGraphicsAccelerator2*,task*,IOAccelShared2*,IOAccelResource2*,unsigned_int,unsigned_long_long,bool)
                          ::kalloc_type_view_408,ppIVar6,local_90);
      local_80 = (task *)0x0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: Failed to create BufferMemoryDescriptor for partial backing\n",
                        "static IOAccelSysMemory *IOAccelSysMemory::withOptions(IOGraphicsAccelerator2 *, task_t, IOAccelShared2 *, IOAccelResource2 *, IOOptionBits, uint64_t, bool)"
                       );
      goto LAB_00056138;
    }
    goto LAB_00056278;
  }
  ptVar5 = (task *)(**(code **)(*(long *)local_40 + 0x928))
                             (local_40,param_2,local_38,param_6,
                              *(undefined8 *)PTR__page_size_0006b108);
  goto LAB_00056157;
code_r0x00056010:
  IOGeneralMemoryDescriptor::setOwnership(local_78,(int)local_70,4);
  ppIVar6 = local_68;
  uVar8 = (int)uVar3 + 1;
  uVar3 = (ulong)uVar8;
  param_6 = param_6 - uVar7;
  if (param_6 == 0) goto code_r0x00056031;
  goto LAB_00055fce;
code_r0x00056031:
  local_80 = (task *)IOMultiMemoryDescriptor::withDescriptors(local_68,uVar8,3,false);
  if (local_80 != (task *)0x0) {
    IOMemoryDescriptor::setVMTags((uint)local_80,0);
  }
  if (uVar8 != 0) {
    uVar3 = 0;
    do {
      (**(code **)(*(long *)ppIVar6[uVar3] + 0x28))();
      ppIVar6[uVar3] = (IOMemoryDescriptor *)0x0;
      uVar3 = uVar3 + 1;
    } while (uVar8 != uVar3);
  }
  _IOFreeTypeVarImpl(&withOptions(IOGraphicsAccelerator2*,task*,IOAccelShared2*,IOAccelResource2*,unsigned_int,unsigned_long_long,bool)
                      ::kalloc_type_view_432,ppIVar6,local_90);
LAB_00056138:
  ptVar5 = local_80;
  param_2 = local_70;
  param_4 = local_50;
  param_3 = local_58;
  param_6 = local_88;
  if (local_78 == (task *)0x0) {
    return (IOAccelMemory *)0x0;
  }
LAB_00056157:
  if (ptVar5 != (task *)0x0) {
    bVar1 = false;
    local_58 = param_3;
    local_50 = param_4;
LAB_0005616b:
    IOMemoryDescriptor::setOwnership(ptVar5,(int)param_2,4);
    this = (IOAccelMemory *)(**(code **)(*(long *)local_40 + 0x8b8))();
    pIVar2 = local_40;
    if (this == (IOAccelMemory *)0x0) {
      this = (IOAccelMemory *)0x0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: allocIOAccelResource failed to alloc texture object\n",
                        "static IOAccelSysMemory *IOAccelSysMemory::withOptions(IOGraphicsAccelerator2 *, task_t, IOAccelShared2 *, IOAccelResource2 *, IOOptionBits, uint64_t, bool)"
                       );
      (**(code **)(*(long *)ptVar5 + 0x28))(ptVar5);
    }
    else {
      *(undefined8 *)(this + 0x38) = local_50;
      *(task **)(this + 0xd0) = ptVar5;
      *(long *)(this + 0x30) = local_58;
      *(ulong *)(this + 0x40) = param_6;
      *(undefined4 *)(this + 0xc0) = 0;
      *(uint *)(this + 0xd8) = local_38;
      if (bVar1) {
        (**(code **)(**(long **)(local_40 + 0x380) + 0x1b0))
                  (*(long **)(local_40 + 0x380),&local_d0,this + 0x108);
        *(IOMemoryDescriptor ***)(this + 0xf8) = local_60;
        *(uint *)(this + 0x100) = local_44;
        *(uint *)(this + 0xc) = *(uint *)(this + 0xc) & 0xffff5ffd | (uint)local_31 << 0xf | 0x2002;
        *(undefined4 *)(this + 0x14) = 0;
        IOGraphicsAccelerator2::sysmem_wired(pIVar2,this);
        IOAccelMemory::updateLRUSeed(this);
      }
      pIVar2 = local_40;
      *(undefined8 *)(this + 0xe0) = param_2;
      IOSimpleReporter::incrementValue(*(ulonglong *)(*(long *)(local_40 + 0x388) + 0x58),0x4e);
      *(int *)(pIVar2 + 0x2d8) = *(int *)(pIVar2 + 0x2d8) + 1;
    }
    return this;
  }
LAB_00056278:
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                    "%s: fAccelerator->createBufferMemoryDescriptorInTaskWithOptions failed\n",
                    "static IOAccelSysMemory *IOAccelSysMemory::withOptions(IOGraphicsAccelerator2 *, task_t, IOAccelShared2 *, IOAccelResource2 *, IOOptionBits, uint64_t, bool)"
                   );
  return (IOAccelMemory *)0x0;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSysMemory::withMemoryDescriptor(IOGraphicsAccelerator2*, IOAccelResource2*,
// IOMemoryDescriptor*)

long __cdecl IOAccelSysMemory::withMemoryDescriptor(long *param_1,undefined8 param_2,long *param_3)

{
  ulong uVar1;
  ulong uVar2;
  long lVar3;
  
  if (param_3 != (long *)0x0) {
    uVar1 = (**(code **)(*param_3 + 0x1c8))(param_3);
    uVar2 = (**(code **)(*param_1 + 0x988))(param_1);
    if (uVar1 <= uVar2) {
      lVar3 = (**(code **)(*param_1 + 0x8b8))(param_1);
      if (lVar3 != 0) {
        *(long **)(lVar3 + 0xd0) = param_3;
        (**(code **)(*param_3 + 0x20))(param_3);
        *(undefined8 *)(lVar3 + 0x38) = param_2;
        *(ulong *)(lVar3 + 0x40) = uVar1;
        *(undefined4 *)(lVar3 + 0xc0) = 0;
        IOSimpleReporter::incrementValue(*(ulonglong *)(param_1[0x71] + 0x58),0x4e);
        *(int *)(param_1 + 0x5b) = (int)param_1[0x5b] + 1;
        return lVar3;
      }
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: allocIOAccelResource failed to alloc texture object\n",
                        "static IOAccelSysMemory *IOAccelSysMemory::withMemoryDescriptor(IOGraphicsAccelerator2 *, IOAccelResource2 *, IOMemoryDescriptor *)"
                       );
      return 0;
    }
  }
  return 0;
}



// IOAccelSysMemory::flushProcessorCacheForOut()

void __thiscall IOAccelSysMemory::flushProcessorCacheForOut(IOAccelSysMemory *this)

{
  undefined8 uVar1;
  undefined8 uVar2;
  uint uVar3;
  int iVar4;
  long *plVar5;
  undefined8 uVar6;
  
  plVar5 = *(long **)(this + 0xd0);
  if ((((plVar5 != (long *)0x0) && (uVar3 = *(uint *)(this + 0xd8) & 0xf00, uVar3 != 0x100)) &&
      (uVar3 != 0x400)) && (uVar3 != 0x200)) {
    uVar1 = *(undefined8 *)(this + 0x40);
    if (((byte)this[0xc] & 2) != 0) {
                    // WARNING: Could not recover jumptable at 0x0005649a. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*plVar5 + 0x128))(plVar5,2,0,uVar1);
      return;
    }
    iVar4 = (**(code **)(*plVar5 + 0x1f0))(plVar5,0);
    plVar5 = *(long **)(this + 0xd0);
    if (iVar4 == 0) {
      (**(code **)(*plVar5 + 0x128))(plVar5,2,0,uVar1);
                    // WARNING: Could not recover jumptable at 0x000564ca. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(**(long **)(this + 0xd0) + 0x1f8))(*(long **)(this + 0xd0),0);
      return;
    }
    plVar5 = (long *)(**(code **)(*plVar5 + 0x200))(plVar5,1);
    if (plVar5 != (long *)0x0) {
      uVar2 = *(undefined8 *)PTR__kernel_task_0006b100;
      uVar6 = (**(code **)(*plVar5 + 0x118))(plVar5);
      _IOFlushProcessorCache(uVar2,uVar6,uVar1);
                    // WARNING: Could not recover jumptable at 0x0005647c. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*plVar5 + 0x28))(plVar5);
      return;
    }
  }
  return;
}



// IOAccelSysMemory::flushProcessorCacheForIn()

void __thiscall IOAccelSysMemory::flushProcessorCacheForIn(IOAccelSysMemory *this)

{
  undefined8 uVar1;
  long lVar2;
  undefined8 uVar3;
  uint uVar4;
  int iVar5;
  long *plVar6;
  undefined8 uVar7;
  
  plVar6 = *(long **)(this + 0xd0);
  if ((((plVar6 != (long *)0x0) && (uVar4 = *(uint *)(this + 0xd8) & 0xf00, uVar4 != 0x100)) &&
      (uVar4 != 0x400)) && (uVar4 != 0x200)) {
    uVar1 = *(undefined8 *)(this + 0x40);
    if (((byte)this[0xc] & 2) != 0) {
                    // WARNING: Could not recover jumptable at 0x0005659e. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*plVar6 + 0x128))(plVar6,1,0,uVar1);
      return;
    }
    iVar5 = (**(code **)(*plVar6 + 0x1f0))(plVar6,0);
    lVar2 = **(long **)(this + 0xd0);
    if (iVar5 == 0) {
      (**(code **)(lVar2 + 0x128))(*(long **)(this + 0xd0),1,0,uVar1);
                    // WARNING: Could not recover jumptable at 0x000565c9. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(**(long **)(this + 0xd0) + 0x1f8))(*(long **)(this + 0xd0),0);
      return;
    }
    plVar6 = (long *)(**(code **)(lVar2 + 0x200))();
    if (plVar6 != (long *)0x0) {
      uVar3 = *(undefined8 *)PTR__kernel_task_0006b100;
      uVar7 = (**(code **)(*plVar6 + 0x118))(plVar6);
      _IOFlushProcessorCache(uVar3,uVar7,uVar1);
                    // WARNING: Could not recover jumptable at 0x00056580. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*plVar6 + 0x28))(plVar6);
      return;
    }
  }
  return;
}



// IOAccelSysMemory::client_address_persistent()

undefined8 __thiscall IOAccelSysMemory::client_address_persistent(IOAccelSysMemory *this)

{
  long *plVar1;
  undefined8 uVar2;
  
  if ((*(int *)(this + 0xc0) == 0) && (((byte)this[0xc] & 0x40) != 0)) {
    plVar1 = (long *)(**(code **)(**(long **)(this + 0x28) + 0x918))
                               (*(long **)(this + 0x28),*(undefined8 *)(this + 0xd0));
    if (plVar1 == (long *)0x0) {
      *(undefined4 *)(this + 0xc0) = 1;
    }
    else {
      if (plVar1 == *(long **)(this + 0xd0)) {
        uVar2 = (**(code **)(*plVar1 + 0x28))(plVar1);
        return CONCAT71((int7)((ulong)uVar2 >> 8),1);
      }
      *(undefined4 *)(this + 0xc0) = 1;
      (**(code **)(*plVar1 + 0x28))(plVar1);
    }
  }
  return 0;
}



// IOAccelSysMemory::getPhysicalSegment(unsigned long long, unsigned long long*)

undefined1 * __thiscall
IOAccelSysMemory::getPhysicalSegment(IOAccelSysMemory *this,undefined8 param_1,undefined8 *param_2)

{
  long *plVar1;
  int iVar2;
  undefined1 *local_40;
  undefined8 local_28;
  undefined1 *local_20;
  
  local_20 = &DAT_aaaaaaaaaaaaaaaa;
  plVar1 = *(long **)(this + 0x148);
  local_28 = param_1;
  if (plVar1 == (long *)0x0) {
    local_40 = (undefined1 *)
               (**(code **)(**(long **)(this + 0xd0) + 0x138))
                         (*(long **)(this + 0xd0),param_1,&local_20,
                          *(undefined4 *)(*(long *)(this + 0x28) + 0x9c0));
  }
  else {
    local_40 = &DAT_aaaaaaaaaaaaaaaa;
    iVar2 = (**(code **)(*plVar1 + 0x158))(plVar1,&local_28);
    if (iVar2 != 0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: failed to genIOVMSegments. Error 0x%x\n",
                        "virtual uint64_t IOAccelSysMemory::getPhysicalSegment(uint64_t, uint64_t *)"
                        ,iVar2);
    }
    local_20 = &DAT_aaaaaaaaaaaaaaaa;
  }
  *param_2 = local_20;
  return local_40;
}



// IOAccelSysMemory::complete()

void __thiscall IOAccelSysMemory::complete(IOAccelSysMemory *this)

{
  int iVar1;
  
  IOAccelMemory::complete((IOAccelMemory *)this);
  if (*(int *)(this + 0x14) == 0) {
    iVar1 = IOAccelMemory::getPrepareCount((IOAccelMemory *)this);
    if (iVar1 == 0) {
                    // WARNING: Could not recover jumptable at 0x00056731. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*(long *)this + 0x1b8))(this);
      return;
    }
  }
  return;
}



// WARNING: Removing unreachable block (ram,0x000567d6)
// WARNING: Removing unreachable block (ram,0x000567e3)
// WARNING: Removing unreachable block (ram,0x000567e7)
// WARNING: Removing unreachable block (ram,0x00056826)
// IOAccelSysMemory::wire()

ulong __thiscall IOAccelSysMemory::wire(IOAccelSysMemory *this)

{
  uint uVar1;
  long lVar2;
  uint uVar3;
  int iVar4;
  uintptr_t uVar5;
  long lVar6;
  ulong uVar7;
  long *plVar8;
  uint uVar9;
  uintptr_t arg2;
  uintptr_t uVar10;
  ulong uVar11;
  
  uVar1 = *(uint *)(this + 0xc);
  uVar3 = uVar1 & 0xfffdffff;
  *(uint *)(this + 0xc) = uVar3;
  *(long *)(this + 0xa8) = *(long *)(this + 0xa8) + 1;
  if (___ktrace_kernel_enabled != 0) {
    uVar10 = *(uintptr_t *)(this + 0x40);
    uVar5 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85120025,uVar10,0,uVar5,0,0);
    uVar3 = *(uint *)(this + 0xc);
  }
  if ((uVar3 & 0x380) != 0x100) {
    (**(code **)(*(long *)this + 0x160))(this,2);
  }
  lVar2 = *(long *)(*(long *)(this + 0x28) + 0x350);
  lVar6 = (**(code **)(**(long **)(this + 0xd0) + 0x1c8))();
  uVar11 = lVar6 + lVar2;
  uVar7 = (**(code **)(**(long **)(this + 0x28) + 0x990))();
  if (uVar7 < uVar11) {
    if (___ktrace_kernel_enabled == 0) {
      uVar7 = 0;
      goto LAB_0005692c;
    }
LAB_00056868:
    uVar10 = *(uintptr_t *)(this + 0x40);
    uVar5 = IORegistryEntry::getRegistryEntryID();
    uVar7 = 0;
    arg2 = 0;
  }
  else {
    uVar9 = *(uint *)(*(long *)(this + 0x28) + 0xc90) >> 2 & 0x20;
    uVar3 = uVar9 + 0x100;
    if ((uVar1 & 0x20000) != 0 || (*(uint *)(*(long *)(this + 0x28) + 0xc9c) & 0x8000000) != 0) {
      uVar3 = uVar9;
    }
    iVar4 = (**(code **)(**(long **)(this + 0xd0) + 0x1f0))(*(long **)(this + 0xd0),uVar3);
    if (iVar4 == 0) {
      plVar8 = (long *)IOGraphicsAccelerator2::getDMACommand
                                 (*(IOGraphicsAccelerator2 **)(this + 0x28));
      *(long **)(this + 0x148) = plVar8;
      if (plVar8 != (long *)0x0) {
        iVar4 = (**(code **)(*plVar8 + 0x128))(plVar8,*(undefined8 *)(this + 0xd0),0);
        if (iVar4 == 0) {
          iVar4 = (**(code **)(**(long **)(this + 0x148) + 0x140))(*(long **)(this + 0x148),0,0,0);
          if (iVar4 == 0) goto LAB_00056a47;
          (**(code **)(**(long **)(this + 0x148) + 0x130))(*(long **)(this + 0x148),0);
          (**(code **)(**(long **)(this + 0xd0) + 0x1f8))(*(long **)(this + 0xd0),0);
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: IODMACommand %p failed to prepare. Error 0x%x\n",
                            "virtual bool IOAccelSysMemory::wire()",*(undefined8 *)(this + 0x148),
                            iVar4);
        }
        else {
          (**(code **)(**(long **)(this + 0xd0) + 0x1f8))(*(long **)(this + 0xd0),0);
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: IODMACommand %p failed to setMemoryDescriptor. Error 0x%x\n",
                            "virtual bool IOAccelSysMemory::wire()",*(undefined8 *)(this + 0x148),
                            iVar4);
        }
        uVar7 = 0;
        if (___ktrace_kernel_enabled == 0) goto LAB_0005692c;
        goto LAB_00056868;
      }
LAB_00056a47:
      this[0xc] = (IOAccelSysMemory)((byte)this[0xc] | 2);
      IOGraphicsAccelerator2::sysmem_wired
                (*(IOGraphicsAccelerator2 **)(this + 0x28),(IOAccelMemory *)this);
      uVar7 = CONCAT71((int7)(uVar11 >> 8),1);
      if (___ktrace_kernel_enabled == 0) goto LAB_0005692c;
      uVar10 = *(uintptr_t *)(this + 0x40);
      uVar5 = IORegistryEntry::getRegistryEntryID();
      arg2 = 1;
    }
    else {
      uVar7 = 0;
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11);
      if (___ktrace_kernel_enabled == 0) goto LAB_0005692c;
      uVar10 = *(uintptr_t *)(this + 0x40);
      uVar7 = 0;
      arg2 = 0;
      uVar5 = 0;
    }
  }
  _kernel_debug(0x85120026,uVar10,arg2,uVar5,0,0);
LAB_0005692c:
  return uVar7 & 0xffffffff;
}



// IOAccelSysMemory::unwire()

void __thiscall IOAccelSysMemory::unwire(IOAccelSysMemory *this)

{
  uintptr_t uVar1;
  long *plVar2;
  IOAccelMemoryMap *this_00;
  short sVar3;
  int iVar4;
  undefined8 in_RAX;
  uintptr_t uVar5;
  ulong uVar6;
  uint uVar7;
  long lVar8;
  undefined8 uVar9;
  undefined4 uVar10;
  
  uVar10 = (undefined4)((ulong)in_RAX >> 0x20);
  if (___ktrace_kernel_enabled != 0) {
    uVar1 = *(uintptr_t *)(this + 0x40);
    uVar5 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85120029,uVar1,uVar5,0,0,0);
  }
  plVar2 = *(long **)(this + 0x148);
  if (plVar2 != (long *)0x0) {
    iVar4 = (**(code **)(*plVar2 + 0x148))(plVar2,0,0);
    if (iVar4 != 0) {
      uVar9 = CONCAT44(uVar10,iVar4);
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: IODMACommand %p failed to complete. Error 0x%x\n",
                        "virtual void IOAccelSysMemory::unwire()",*(undefined8 *)(this + 0x148),
                        uVar9);
      uVar10 = (undefined4)((ulong)uVar9 >> 0x20);
    }
    iVar4 = (**(code **)(**(long **)(this + 0x148) + 0x130))(*(long **)(this + 0x148),0);
    if (iVar4 != 0) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: IODMACommand %p failed to clearMemoryDescriptor. Error 0x%x\n",
                        "virtual void IOAccelSysMemory::unwire()",*(undefined8 *)(this + 0x148),
                        CONCAT44(uVar10,iVar4));
    }
    IOGraphicsAccelerator2::returnDMACommand
              (*(IOGraphicsAccelerator2 **)(this + 0x28),*(long **)(this + 0x148));
    *(undefined8 *)(this + 0x148) = 0;
  }
  iVar4 = *(int *)(this + 0x10);
  *(int *)(this + 0x10) = iVar4 + 1;
  sVar3 = *(short *)(this + 0x5a);
  if (0 < sVar3) {
    lVar8 = 0;
    do {
      this_00 = *(IOAccelMemoryMap **)(*(long *)(this + 0x50) + lVar8 * 8);
      if (((byte)this_00[0x10] & 4) != 0) {
        IOAccelMemoryMap::release_pte(this_00);
        sVar3 = *(short *)(this + 0x5a);
      }
      lVar8 = lVar8 + 1;
    } while (lVar8 < sVar3);
    iVar4 = *(int *)(this + 0x10) + -1;
  }
  *(int *)(this + 0x10) = iVar4;
  (**(code **)(**(long **)(this + 0xd0) + 0x1f8))(*(long **)(this + 0xd0),0);
  if ((~*(uint *)(this + 0xc) & 0xc00) != 0) {
    if (*(IOAccelResource2 **)(this + 0x38) == (IOAccelResource2 *)0x0) goto LAB_00056c0d;
    uVar6 = IOAccelResource2::requirePageoff(*(IOAccelResource2 **)(this + 0x38));
    if (((char)uVar6 != '\0') || ((*(uint *)(this + 0xc) & 0x380) != 0x100)) goto LAB_00056c0d;
  }
  (**(code **)(*(long *)this + 0x160))(this,3,0);
LAB_00056c0d:
  this[0xc] = (IOAccelSysMemory)((byte)this[0xc] & 0xfd);
  IOGraphicsAccelerator2::sysmem_unwired(*(IOGraphicsAccelerator2 **)(this + 0x28),(long *)this);
  uVar7 = *(uint *)(this + 0xc) >> 7 & 7;
  if (uVar7 - 3 < 2) {
    (**(code **)(*(long *)this + 0x160))(this,uVar7,0);
  }
  if (___ktrace_kernel_enabled != 0) {
    uVar1 = *(uintptr_t *)(this + 0x40);
    uVar5 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x8512002a,uVar1,uVar5,0,0,0);
    return;
  }
  return;
}



// IOAccelSysMemory::increment_wire_count()

void __thiscall IOAccelSysMemory::increment_wire_count(IOAccelSysMemory *this)

{
  *(int *)(this + 0x14) = *(int *)(this + 0x14) + 1;
  return;
}



// IOAccelSysMemory::decrement_wire_count()

void __thiscall IOAccelSysMemory::decrement_wire_count(IOAccelSysMemory *this)

{
  IOAccelSysMemory *pIVar1;
  int iVar2;
  
  pIVar1 = this + 0x14;
  *(int *)pIVar1 = *(int *)pIVar1 + -1;
  if (*(int *)pIVar1 == 0) {
    iVar2 = IOAccelMemory::getPrepareCount((IOAccelMemory *)this);
    if (iVar2 == 0) {
                    // WARNING: Could not recover jumptable at 0x00056cb0. Too many branches
                    // WARNING: Treating indirect jump as call
      (**(code **)(*(long *)this + 0x1b8))(this);
      return;
    }
  }
  return;
}



// WARNING: Removing unreachable block (ram,0x00056d2e)
// WARNING: Removing unreachable block (ram,0x00056d3b)
// WARNING: Removing unreachable block (ram,0x00056d3f)
// WARNING: Removing unreachable block (ram,0x00056d7e)
// IOAccelSysMemory::lockForCPUAccess(task*, unsigned int)

undefined8 __thiscall
IOAccelSysMemory::lockForCPUAccess(IOAccelSysMemory *this,ulonglong param_1,ulong param_2)

{
  uint uVar1;
  ulonglong uVar2;
  long *plVar3;
  undefined8 uVar4;
  
  uVar1 = *(uint *)(this + 0xc);
  if ((uVar1 >> 0xd & 1) != 0) {
    (**(code **)(**(long **)(*(long *)(this + 0x28) + 0x380) + 0x188))
              (*(long **)(*(long *)(this + 0x28) + 0x380),this + 0x108);
    uVar1 = *(uint *)(this + 0xc);
  }
  if ((uVar1 & 0x380) != 0x100) {
    (**(code **)(*(long *)this + 0x160))(this,2);
  }
  if (*(ulonglong *)PTR__kernel_task_0006b100 == param_1) {
    plVar3 = *(long **)(this + 0x188);
    if (plVar3 == (long *)0x0) {
      plVar3 = (long *)IOMemoryDescriptor::createMappingInTask
                                 (*(task **)(this + 0xd0),param_1,0,param_2 & 0xffffffff,0);
      *(long **)(this + 0x188) = plVar3;
      if (plVar3 == (long *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: createMappingInTask failed to create kernel map\n",
                          "mach_vm_address_t IOAccelSysMemory::lockForCPUAccess(task_t, IOOptionBits)"
                         );
        return 0;
      }
    }
    *(int *)(this + 400) = *(int *)(this + 400) + 1;
    uVar4 = (**(code **)(*plVar3 + 0x118))();
    return uVar4;
  }
  if (*(long **)(this + 0xe8) != (long *)0x0) {
    uVar2 = (**(code **)(**(long **)(this + 0xe8) + 0x130))();
    if (uVar2 != param_1) {
      __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                        "%s: it has been locked by a different task.\n",
                        "mach_vm_address_t IOAccelSysMemory::lockForCPUAccess(task_t, IOOptionBits)"
                       );
      return 0;
    }
    plVar3 = *(long **)(this + 0xe8);
    if (plVar3 != (long *)0x0) goto LAB_00056e57;
  }
  plVar3 = (long *)IOMemoryDescriptor::createMappingInTask
                             (*(task **)(this + 0xd0),param_1,0,param_2 & 0xffffffff,0);
  *(long **)(this + 0xe8) = plVar3;
  if (plVar3 == (long *)0x0) {
    __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: failed to create map.\n",
                      "mach_vm_address_t IOAccelSysMemory::lockForCPUAccess(task_t, IOOptionBits)");
    return 0;
  }
LAB_00056e57:
  *(short *)(this + 0xf0) = *(short *)(this + 0xf0) + 1;
  uVar4 = (**(code **)(*plVar3 + 0x118))(plVar3);
  return uVar4;
}



// IOAccelSysMemory::unlockForCPUAccess(task*)

void __thiscall IOAccelSysMemory::unlockForCPUAccess(IOAccelSysMemory *this,long param_1)

{
  IOAccelSysMemory *pIVar1;
  
  if (*(long *)PTR__kernel_task_0006b100 == param_1) {
    pIVar1 = this + 400;
    *(int *)pIVar1 = *(int *)pIVar1 + -1;
    if ((*(int *)pIVar1 == 0) && (*(long **)(this + 0x188) != (long *)0x0)) {
      (**(code **)(**(long **)(this + 0x188) + 0x28))();
      *(undefined8 *)(this + 0x188) = 0;
    }
  }
  else {
    pIVar1 = this + 0xf0;
    *(short *)pIVar1 = *(short *)pIVar1 + -1;
    if (*(short *)pIVar1 == 0) {
      if (*(long **)(this + 0xe8) == (long *)0x0) {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,"%s: no fCPULockedUserMapping.\n",
                          "void IOAccelSysMemory::unlockForCPUAccess(task_t)");
      }
      else {
        (**(code **)(**(long **)(this + 0xe8) + 0x28))();
        *(undefined8 *)(this + 0xe8) = 0;
      }
    }
  }
  return;
}



// IOAccelSysMemory::setPurgeable(unsigned int, unsigned int*)

undefined8 __thiscall
IOAccelSysMemory::setPurgeable(IOAccelSysMemory *this,uint param_1,uint *param_2)

{
  uint uVar1;
  long *plVar2;
  long lVar3;
  short *psVar4;
  undefined8 uVar5;
  uint local_24;
  
  local_24 = 0xaaaaaaaa;
  plVar2 = *(long **)(this + 0xd0);
  if (plVar2 == (long *)0x0) {
    return 0xe00002bd;
  }
  uVar1 = *(uint *)(this + 0xc);
  if ((~uVar1 & 0x2400) == 0) {
    if (param_2 == (uint *)0x0) {
      return 0;
    }
    local_24 = uVar1 >> 7 & 7;
  }
  else {
    if ((param_1 - 3 < 2) && ((uVar1 & 2) != 0)) {
      *(uint *)(this + 0xc) = uVar1 & 0xfffffc7f | (param_1 & 7) << 7;
      local_24 = 2;
    }
    else {
      uVar5 = (**(code **)(*plVar2 + 0x120))(plVar2,param_1,&local_24);
      if ((int)uVar5 != 0) {
        return uVar5;
      }
      if (param_1 != 1) {
        *(uint *)(this + 0xc) = *(uint *)(this + 0xc) & 0xfffffc7f | (param_1 & 7) << 7;
      }
      if ((local_24 == 4) && (lVar3 = *(long *)(this + 0x38), lVar3 != 0)) {
        if ((*(byte *)(*(long *)(lVar3 + 0x18) + 0xc9c) & 4) == 0) {
          *(byte *)(lVar3 + 0xf) = *(byte *)(lVar3 + 0xf) | 8;
        }
        *(undefined8 *)(lVar3 + 0xa4) = 0;
        *(undefined8 *)(lVar3 + 0x138) = 0;
        *(undefined8 *)(lVar3 + 0x140) = 0;
        psVar4 = *(short **)(lVar3 + 0x30);
        psVar4[6] = 0;
        psVar4[7] = 0;
        psVar4[8] = 0;
        psVar4[9] = 0;
        psVar4[10] = 0;
        psVar4[0xb] = 0;
        if (((((psVar4[1] != 0 || *psVar4 != 0) || psVar4[2] != 0) || psVar4[3] != 0) ||
            psVar4[4] != 0) || psVar4[5] != 0) {
          *(byte *)(psVar4 + 0xe) = *(byte *)(psVar4 + 0xe) | 1;
        }
      }
    }
    if (param_2 == (uint *)0x0) {
      return 0;
    }
  }
  *param_2 = local_24;
  return 0;
}



// IOAccelSysMemory::getDirtySize() const

undefined8 IOAccelSysMemory::getDirtySize(void)

{
  return 0xffffffffffffffff;
}



// IOAccelSysMemory::getResidentSize() const

undefined8 IOAccelSysMemory::getResidentSize(void)

{
  return 0xffffffffffffffff;
}



// IOAccelSysMemory::getPageCounts(unsigned long long*, unsigned long long*)

undefined8 __thiscall
IOAccelSysMemory::getPageCounts(IOAccelSysMemory *this,ulonglong *param_1,long *param_2)

{
  int iVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  long lVar4;
  ulonglong uVar5;
  ulong uVar6;
  long lVar7;
  ulonglong local_40;
  long local_38;
  
  if (*(long *)(this + 0xf8) == 0) {
    uVar2 = IOMemoryDescriptor::getPageCounts(*(ulonglong **)(this + 0xd0),param_1);
    return uVar2;
  }
  if (*(int *)(this + 0x100) == 0) {
    uVar5 = 0;
    lVar7 = 0;
  }
  else {
    uVar6 = 0;
    lVar7 = 0;
    uVar5 = 0;
    do {
      local_40 = 0;
      local_38 = 0;
      iVar1 = IOMemoryDescriptor::getPageCounts
                        (*(ulonglong **)(*(long *)(this + 0xf8) + uVar6 * 8),&local_40);
      uVar3 = 0;
      lVar4 = 0;
      if (iVar1 == 0) {
        uVar3 = local_40;
        lVar4 = local_38;
      }
      lVar7 = lVar7 + lVar4;
      uVar5 = uVar5 + uVar3;
      uVar6 = uVar6 + 1;
    } while (uVar6 < *(uint *)(this + 0x100));
  }
  *param_1 = uVar5;
  *param_2 = lVar7;
  return 0;
}



// IOAccelSysMemory::_RESERVEDIOAccelSysMemory0()

void IOAccelSysMemory::_RESERVEDIOAccelSysMemory0(void)

{
  OSMetaClass::reservedCalled(0x82840);
  return;
}



// IOAccelSysMemory::_RESERVEDIOAccelSysMemory1()

void IOAccelSysMemory::_RESERVEDIOAccelSysMemory1(void)

{
  OSMetaClass::reservedCalled(0x82840);
  return;
}



// IOAccelSysMemory::_RESERVEDIOAccelSysMemory2()

void IOAccelSysMemory::_RESERVEDIOAccelSysMemory2(void)

{
  OSMetaClass::reservedCalled(0x82840);
  return;
}



// IOAccelSysMemory::_RESERVEDIOAccelSysMemory3()

void IOAccelSysMemory::_RESERVEDIOAccelSysMemory3(void)

{
  OSMetaClass::reservedCalled(0x82840);
  return;
}



// IOAccelSysMemory::_RESERVEDIOAccelSysMemory4()

void IOAccelSysMemory::_RESERVEDIOAccelSysMemory4(void)

{
  OSMetaClass::reservedCalled(0x82840);
  return;
}



// IOAccelSysMemory::_RESERVEDIOAccelSysMemory5()

void IOAccelSysMemory::_RESERVEDIOAccelSysMemory5(void)

{
  OSMetaClass::reservedCalled(0x82840);
  return;
}



// IOAccelSysMemory::MetaClass::~MetaClass()

void __thiscall IOAccelSysMemory::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelMemory::getLength() const

undefined8 __thiscall IOAccelMemory::getLength(IOAccelMemory *this)

{
  return *(undefined8 *)(this + 0x40);
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSysMemory::setTag(unsigned int)

void __cdecl IOAccelSysMemory::setTag(long param_1)

{
                    // WARNING: Could not recover jumptable at 0x0005721e. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(param_1 + 0xd0) + 0x1d0))();
  return;
}



// IOAccelSysMemory::getTag()

void __thiscall IOAccelSysMemory::getTag(IOAccelSysMemory *this)

{
                    // WARNING: Could not recover jumptable at 0x0005722f. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(long **)(this + 0xd0) + 0x1d8))();
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelSysMemory_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelSysMemory::gMetaClass,"IOAccelSysMemory",
             (OSMetaClass *)&IOAccelMemory::gMetaClass,0x198);
  _gMetaClass = &PTR__MetaClass_00081798;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelSysMemory::gMetaClass);
  return;
}



// IOAccelVidMemory::MetaClass::MetaClass()

void __thiscall IOAccelVidMemory::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelVidMemory",(OSMetaClass *)&IOAccelMemory::gMetaClass,0x110)
  ;
  *(undefined ***)this = &PTR__MetaClass_00081ad0;
  return;
}



// IOAccelVidMemory::MetaClass::~MetaClass()

void __thiscall IOAccelVidMemory::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelVidMemory::IOAccelVidMemory(OSMetaClass const*)

void __thiscall IOAccelVidMemory::IOAccelVidMemory(IOAccelVidMemory *this,OSMetaClass *param_1)

{
  IOAccelMemory::IOAccelMemory((IOAccelMemory *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelVidMemory_00081890;
  return;
}



// IOAccelVidMemory::~IOAccelVidMemory()

void __thiscall IOAccelVidMemory::~IOAccelVidMemory(IOAccelVidMemory *this)

{
  IOAccelMemory::~IOAccelMemory((IOAccelMemory *)this);
  return;
}



// IOAccelVidMemory::~IOAccelVidMemory()

void __thiscall IOAccelVidMemory::~IOAccelVidMemory(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelVidMemory::~IOAccelVidMemory()

void __thiscall IOAccelVidMemory::~IOAccelVidMemory(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelVidMemory::getMetaClass() const

undefined1 * IOAccelVidMemory::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelVidMemory::MetaClass::MetaClass()

void __thiscall IOAccelVidMemory::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelVidMemory",(OSMetaClass *)&IOAccelMemory::gMetaClass,0x110)
  ;
  *(undefined ***)this = &PTR__MetaClass_00081ad0;
  return;
}



// IOAccelVidMemory::MetaClass::alloc() const

undefined8 IOAccelVidMemory::MetaClass::alloc(void)

{
  return 0;
}



// IOAccelVidMemory::operator new(unsigned long)

void * __thiscall IOAccelVidMemory::operator_new(IOAccelVidMemory *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelVidMemory_ktv,this);
  return pvVar1;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelVidMemory::operator delete(void*, unsigned long)

void __cdecl IOAccelVidMemory::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelVidMemory_ktv,param_1,param_2);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelVidMemory::init(IOGraphicsAccelerator2*, IOAccelShared2*, IOAccelResource2*, unsigned long
// long, void*)

ulong __cdecl
IOAccelVidMemory::init
          (IOAccelMemory *param_1,long param_2,long param_3,long param_4,undefined8 param_5)

{
  bool bVar1;
  undefined7 extraout_var;
  
  bVar1 = IOAccelMemory::init(param_1,param_2);
  if (bVar1) {
    *(long *)(param_1 + 0x30) = param_3;
    *(long *)(param_1 + 0x38) = param_4;
    *(undefined8 *)(param_1 + 200) = 0;
    *(undefined8 *)(param_1 + 0x40) = param_5;
    *(undefined4 *)(param_1 + 0xc0) = 0;
    *(uint *)(param_1 + 0xc) = *(uint *)(param_1 + 0xc) & 0xfffffc6b | 0x104;
    if (((param_3 != 0) && (param_4 != 0)) && ((*(byte *)(param_2 + 0xc93) & 0x10) != 0)) {
      IOAccelMemory::setFlags(param_1,1);
      if ((*(byte *)(param_2 + 0xc93) & 0x20) != 0) {
        IOAccelMemory::setFlags(param_1,2);
      }
    }
  }
  return CONCAT71(extraout_var,bVar1) & 0xffffffff;
}



// IOAccelVidMemory::free()

void __thiscall IOAccelVidMemory::free(IOAccelVidMemory *this)

{
  uint uVar1;
  
  uVar1 = *(uint *)(this + 0xc);
  if ((uVar1 & 2) != 0) {
    (**(code **)(*(long *)this + 0x1b8))(this);
    uVar1 = *(uint *)(this + 0xc);
  }
  if ((uVar1 & 8) != 0) {
    IOGraphicsAccelerator2::vidmem_unwired(*(IOGraphicsAccelerator2 **)(this + 0x28),(long *)this);
    uVar1 = *(uint *)(this + 0xc) & 0xfffffffd;
    *(uint *)(this + 0xc) = uVar1;
  }
  if ((uVar1 >> 10 & 1) != 0) {
    IOAccelOrphanedMemoryPool::removeMemory
              ((IOAccelOrphanedMemoryPool *)(*(long *)(this + 0x28) + 0xbc8),(long *)this);
  }
  IOAccelMemory::free((IOAccelMemory *)this);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelVidMemory::withPhysicalAddress(IOGraphicsAccelerator2*, unsigned long long, unsigned long
// long)

long * __cdecl
IOAccelVidMemory::withPhysicalAddress
          (IOGraphicsAccelerator2 *param_1,long param_2,undefined8 param_3)

{
  long *plVar1;
  
  plVar1 = (long *)(**(code **)(*(long *)param_1 + 0x8c0))(param_1,0,0,param_3,0);
  if (plVar1 != (long *)0x0) {
    plVar1[0x19] = param_2;
    *(byte *)((long)plVar1 + 0xc) = *(byte *)((long)plVar1 + 0xc) | 10;
    IOGraphicsAccelerator2::vidmem_wired(param_1,plVar1);
  }
  return plVar1;
}



// IOAccelVidMemory::getPhysicalSegment(unsigned long long, unsigned long long*)

long __thiscall
IOAccelVidMemory::getPhysicalSegment(IOAccelVidMemory *this,long param_1,undefined8 *param_2)

{
  *param_2 = *(undefined8 *)(this + 0x40);
  return param_1 + *(long *)(this + 200);
}



// IOAccelVidMemory::prepare()

void __thiscall IOAccelVidMemory::prepare(IOAccelVidMemory *this)

{
  IOAccelMemory::prepare((IOAccelMemory *)this);
  return;
}



// IOAccelVidMemory::complete()

void __thiscall IOAccelVidMemory::complete(IOAccelVidMemory *this)

{
  IOAccelMemory::complete((IOAccelMemory *)this);
  return;
}



// IOAccelVidMemory::wire()

undefined4 __thiscall IOAccelVidMemory::wire(IOAccelVidMemory *this)

{
  uint uVar1;
  undefined4 uVar2;
  uintptr_t uVar3;
  uintptr_t arg2;
  uintptr_t uVar4;
  
  *(long *)(this + 0xa8) = *(long *)(this + 0xa8) + 1;
  if (___ktrace_kernel_enabled != 0) {
    uVar4 = *(uintptr_t *)(this + 0x40);
    uVar1 = *(uint *)(this + 0xc);
    uVar3 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x8512002d,uVar4,0,(ulong)(uVar1 >> 3 & 1),uVar3,0);
  }
  uVar2 = (**(code **)(*(long *)this + 0x1e8))(this);
  if ((char)uVar2 == '\0') {
    if (___ktrace_kernel_enabled == 0) {
      return uVar2;
    }
    uVar4 = *(uintptr_t *)(this + 0x40);
    uVar1 = *(uint *)(this + 0xc);
    uVar3 = IORegistryEntry::getRegistryEntryID();
    arg2 = 0;
  }
  else {
    this[0xc] = (IOAccelVidMemory)((byte)this[0xc] | 2);
    IOGraphicsAccelerator2::vidmem_wired(*(IOGraphicsAccelerator2 **)(this + 0x28),(long *)this);
    if (___ktrace_kernel_enabled == 0) {
      return uVar2;
    }
    uVar4 = *(uintptr_t *)(this + 0x40);
    uVar1 = *(uint *)(this + 0xc);
    uVar3 = IORegistryEntry::getRegistryEntryID();
    arg2 = 1;
  }
  _kernel_debug(0x8512002e,uVar4,arg2,(ulong)(uVar1 >> 3 & 1),uVar3,0);
  return uVar2;
}



// IOAccelVidMemory::unwire()

void __thiscall IOAccelVidMemory::unwire(IOAccelVidMemory *this)

{
  uintptr_t uVar1;
  short *psVar2;
  IOAccelMemoryMap *this_00;
  short sVar3;
  uintptr_t uVar4;
  ulong uVar5;
  int iVar6;
  uint uVar7;
  long lVar8;
  
  if (___ktrace_kernel_enabled != 0) {
    uVar1 = *(uintptr_t *)(this + 0x40);
    uVar7 = *(uint *)(this + 0xc);
    uVar4 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85120031,uVar1,(ulong)(uVar7 >> 3 & 1),uVar4,0,0);
  }
  if ((*(uint *)(this + 0xc) & 0x380) == 0x100) {
    if (*(IOAccelResource2 **)(this + 0x38) != (IOAccelResource2 *)0x0) {
      uVar5 = IOAccelResource2::requirePageoff(*(IOAccelResource2 **)(this + 0x38));
      if ((char)uVar5 != '\0') {
        (**(code **)(**(long **)(this + 0x38) + 0x188))();
        if (((byte)this[0xd] & 0x40) == 0) {
          IOAccelMemory::finishAllEvent((IOAccelMemory *)this);
        }
      }
    }
  }
  else {
    *(uint *)(this + 0xc) = *(uint *)(this + 0xc) & 0xfffffc7f | 0x200;
  }
  lVar8 = *(long *)(this + 0x38);
  if (lVar8 != 0) {
    if ((*(byte *)(*(long *)(lVar8 + 0x18) + 0xc9c) & 4) == 0) {
      *(byte *)(lVar8 + 0xf) = *(byte *)(lVar8 + 0xf) | 8;
    }
    *(undefined8 *)(lVar8 + 0xa4) = 0;
    *(undefined8 *)(lVar8 + 0x138) = 0;
    *(undefined8 *)(lVar8 + 0x140) = 0;
    psVar2 = *(short **)(lVar8 + 0x30);
    psVar2[6] = 0;
    psVar2[7] = 0;
    psVar2[8] = 0;
    psVar2[9] = 0;
    psVar2[10] = 0;
    psVar2[0xb] = 0;
    if (((((psVar2[1] != 0 || *psVar2 != 0) || psVar2[2] != 0) || psVar2[3] != 0) || psVar2[4] != 0)
        || psVar2[5] != 0) {
      *(byte *)(psVar2 + 0xe) = *(byte *)(psVar2 + 0xe) | 1;
    }
  }
  if (*(IOAccelExternalEvent **)(this + 0x60) != (IOAccelExternalEvent *)0x0) {
    IOAccelExternalEvent::finish(*(IOAccelExternalEvent **)(this + 0x60));
  }
  iVar6 = *(int *)(this + 0x10);
  *(int *)(this + 0x10) = iVar6 + 1;
  sVar3 = *(short *)(this + 0x5a);
  if (0 < sVar3) {
    lVar8 = 0;
    do {
      this_00 = *(IOAccelMemoryMap **)(*(long *)(this + 0x50) + lVar8 * 8);
      if (((byte)this_00[0x10] & 4) != 0) {
        IOAccelMemoryMap::release_pte(this_00);
        sVar3 = *(short *)(this + 0x5a);
      }
      lVar8 = lVar8 + 1;
    } while (lVar8 < sVar3);
    iVar6 = *(int *)(this + 0x10) + -1;
  }
  *(int *)(this + 0x10) = iVar6;
  uVar7 = *(uint *)(this + 0xc);
  if ((uVar7 & 8) == 0) {
    (**(code **)(*(long *)this + 0x1f0))(this);
    IOGraphicsAccelerator2::vidmem_unwired(*(IOGraphicsAccelerator2 **)(this + 0x28),(long *)this);
    uVar7 = *(uint *)(this + 0xc) & 0xfffffffd;
    *(uint *)(this + 0xc) = uVar7;
  }
  if (___ktrace_kernel_enabled != 0) {
    uVar1 = *(uintptr_t *)(this + 0x40);
    uVar4 = IORegistryEntry::getRegistryEntryID();
    _kernel_debug(0x85120032,uVar1,(ulong)(uVar7 >> 3 & 1),uVar4,0,0);
    return;
  }
  return;
}



// IOAccelVidMemory::canDoAsyncPageTableUpdate() const

bool __thiscall IOAccelVidMemory::canDoAsyncPageTableUpdate(IOAccelVidMemory *this)

{
  bool bVar1;
  
  if (((byte)this[0xd] & 0x40) == 0) {
    bVar1 = false;
  }
  else {
    bVar1 = *(long *)(this + 0x60) == 0;
  }
  return bVar1;
}



// IOAccelVidMemory::increment_wire_count()

void __thiscall IOAccelVidMemory::increment_wire_count(IOAccelVidMemory *this)

{
  *(int *)(this + 0x14) = *(int *)(this + 0x14) + 1;
  return;
}



// IOAccelVidMemory::decrement_wire_count()

void __thiscall IOAccelVidMemory::decrement_wire_count(IOAccelVidMemory *this)

{
  *(int *)(this + 0x14) = *(int *)(this + 0x14) + -1;
  return;
}



// IOAccelVidMemory::orphanIt()

void __thiscall IOAccelVidMemory::orphanIt(IOAccelVidMemory *this)

{
  IOAccelMemory::orphanIt((IOAccelMemory *)this);
  IOAccelOrphanedMemoryPool::addMemory
            ((IOAccelOrphanedMemoryPool *)(*(long *)(this + 0x28) + 0xbc8),(long *)this);
  return;
}



// IOAccelVidMemory::unorphanIt(IOAccelShared2*)

void __thiscall IOAccelVidMemory::unorphanIt(IOAccelVidMemory *this,long param_1)

{
  IOAccelMemory::unorphanIt((IOAccelMemory *)this,param_1);
  IOAccelOrphanedMemoryPool::removeMemory
            ((IOAccelOrphanedMemoryPool *)(*(long *)(this + 0x28) + 0xbc8),(long *)this);
  return;
}



// IOAccelVidMemory::matchForReuse(void*, unsigned long long)

bool __thiscall
IOAccelVidMemory::matchForReuse(IOAccelVidMemory *this,undefined8 param_2_00,long param_2)

{
  bool bVar1;
  
  if (((byte)this[0xd] & 8) == 0) {
    bVar1 = false;
  }
  else {
    bVar1 = *(long *)(this + 0x40) == param_2;
  }
  return bVar1;
}



// IOAccelVidMemory::requirePageoff()

ulong __thiscall IOAccelVidMemory::requirePageoff(IOAccelVidMemory *this)

{
  ulong uVar1;
  
  if (((*(uint *)(this + 0xc) & 0x380) == 0x100) &&
     (*(IOAccelResource2 **)(this + 0x38) != (IOAccelResource2 *)0x0)) {
    uVar1 = IOAccelResource2::requirePageoff(*(IOAccelResource2 **)(this + 0x38));
    return uVar1;
  }
  return 0;
}



// IOAccelVidMemory::setPurgeable(unsigned int, unsigned int*)

undefined8 __thiscall
IOAccelVidMemory::setPurgeable(IOAccelVidMemory *this,uint param_1,uint *param_2)

{
  uint uVar1;
  int iVar2;
  undefined8 uVar3;
  
  if (param_2 != (uint *)0x0) {
    *param_2 = *(uint *)(this + 0xc) >> 7 & 7;
  }
  if (param_1 != 1) {
    if ((param_1 == 3) && (((byte)this[0xc] & 2) != 0)) {
      IOAccelVidMemoryList::moveMemoryToTail
                ((IOAccelVidMemoryList *)(*(long *)(this + 0x28) + 0xb48),(long)this);
    }
    uVar1 = *(uint *)(this + 0xc);
    *(uint *)(this + 0xc) = uVar1 & 0xfffffc7f | (param_1 & 7) << 7;
    if ((param_1 == 4) && ((uVar1 & 2) != 0)) {
      iVar2 = IOAccelMemory::getPrepareCount((IOAccelMemory *)this);
      if (iVar2 == 0) {
        uVar3 = IOAccelMemory::testAllEvent((IOAccelMemory *)this);
        if ((char)uVar3 == '\0') {
          __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                            "%s: kIOMemoryPurgeableEmpty is requested while still accessed by GPU. waiting for access to complete now\n"
                            ,
                            "virtual IOReturn IOAccelVidMemory::setPurgeable(IOOptionBits, IOOptionBits *)"
                           );
          IOAccelMemory::finishAllEvent((IOAccelMemory *)this);
        }
        (**(code **)(*(long *)this + 0x1b8))(this);
      }
      else {
        __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                          "%s: kIOMemoryPurgeableEmpty is requested while still wired. Treating it like volatile\n"
                          ,
                          "virtual IOReturn IOAccelVidMemory::setPurgeable(IOOptionBits, IOOptionBits *)"
                         );
      }
    }
  }
  return 0;
}



// IOAccelVidMemory::getDirtySize() const

undefined8 IOAccelVidMemory::getDirtySize(void)

{
  return 0xffffffffffffffff;
}



// IOAccelVidMemory::getResidentSize() const

undefined8 __thiscall IOAccelVidMemory::getResidentSize(IOAccelVidMemory *this)

{
  undefined8 uVar1;
  
  if (((byte)this[0xc] & 2) == 0) {
    return 0;
  }
                    // WARNING: Could not recover jumptable at 0x00057982. Too many branches
                    // WARNING: Treating indirect jump as call
  uVar1 = (**(code **)(*(long *)this + 0x120))();
  return uVar1;
}



// IOAccelVidMemory::_RESERVEDIOAccelVidMemory0()

void IOAccelVidMemory::_RESERVEDIOAccelVidMemory0(void)

{
  OSMetaClass::reservedCalled(0x82868);
  return;
}



// IOAccelVidMemory::_RESERVEDIOAccelVidMemory1()

void IOAccelVidMemory::_RESERVEDIOAccelVidMemory1(void)

{
  OSMetaClass::reservedCalled(0x82868);
  return;
}



// IOAccelVidMemory::_RESERVEDIOAccelVidMemory2()

void IOAccelVidMemory::_RESERVEDIOAccelVidMemory2(void)

{
  OSMetaClass::reservedCalled(0x82868);
  return;
}



// IOAccelVidMemory::_RESERVEDIOAccelVidMemory3()

void IOAccelVidMemory::_RESERVEDIOAccelVidMemory3(void)

{
  OSMetaClass::reservedCalled(0x82868);
  return;
}



// IOAccelVidMemory::_RESERVEDIOAccelVidMemory4()

void IOAccelVidMemory::_RESERVEDIOAccelVidMemory4(void)

{
  OSMetaClass::reservedCalled(0x82868);
  return;
}



// IOAccelVidMemory::_RESERVEDIOAccelVidMemory5()

void IOAccelVidMemory::_RESERVEDIOAccelVidMemory5(void)

{
  OSMetaClass::reservedCalled(0x82868);
  return;
}



// IOAccelVidMemory::MetaClass::~MetaClass()

void __thiscall IOAccelVidMemory::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelMemory::getLength() const

undefined8 __thiscall IOAccelMemory::getLength(IOAccelMemory *this)

{
  return *(undefined8 *)(this + 0x40);
}



// IOAccelVidMemory::setTag(unsigned int)

void __thiscall IOAccelVidMemory::setTag(IOAccelVidMemory *this,undefined4 param_1)

{
  *(undefined4 *)(this + 0xc0) = param_1;
  return;
}



// IOAccelVidMemory::getTag()

undefined4 __thiscall IOAccelVidMemory::getTag(IOAccelVidMemory *this)

{
  return *(undefined4 *)(this + 0xc0);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelVidMemory_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelVidMemory::gMetaClass,"IOAccelVidMemory",
             (OSMetaClass *)&IOAccelMemory::gMetaClass,0x110);
  _gMetaClass = &PTR__MetaClass_00081ad0;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelVidMemory::gMetaClass);
  return;
}



// IOAccelBufferMemoryDescriptorPool2::MetaClass::MetaClass()

void __thiscall IOAccelBufferMemoryDescriptorPool2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelBufferMemoryDescriptorPool2",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x1b0);
  *(undefined ***)this = &PTR__MetaClass_00081cf8;
  return;
}



// IOAccelBufferMemoryDescriptorPool2::MetaClass::~MetaClass()

void __thiscall IOAccelBufferMemoryDescriptorPool2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// IOAccelBufferMemoryDescriptorPool2::IOAccelBufferMemoryDescriptorPool2(OSMetaClass const*)

void __thiscall
IOAccelBufferMemoryDescriptorPool2::IOAccelBufferMemoryDescriptorPool2
          (IOAccelBufferMemoryDescriptorPool2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelBufferMemoryDescriptorPool2_00081bc8;
  return;
}



// IOAccelBufferMemoryDescriptorPool2::IOAccelBufferMemoryDescriptorPool2(OSMetaClass const*)

void __thiscall
IOAccelBufferMemoryDescriptorPool2::IOAccelBufferMemoryDescriptorPool2
          (IOAccelBufferMemoryDescriptorPool2 *this,OSMetaClass *param_1)

{
  OSObject::OSObject((OSObject *)this,param_1);
  *(undefined ***)this = &PTR__IOAccelBufferMemoryDescriptorPool2_00081bc8;
  return;
}



// IOAccelBufferMemoryDescriptorPool2::~IOAccelBufferMemoryDescriptorPool2()

void __thiscall
IOAccelBufferMemoryDescriptorPool2::~IOAccelBufferMemoryDescriptorPool2
          (IOAccelBufferMemoryDescriptorPool2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelBufferMemoryDescriptorPool2::~IOAccelBufferMemoryDescriptorPool2()

void __thiscall
IOAccelBufferMemoryDescriptorPool2::~IOAccelBufferMemoryDescriptorPool2
          (IOAccelBufferMemoryDescriptorPool2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  return;
}



// IOAccelBufferMemoryDescriptorPool2::~IOAccelBufferMemoryDescriptorPool2()

void __thiscall
IOAccelBufferMemoryDescriptorPool2::~IOAccelBufferMemoryDescriptorPool2
          (IOAccelBufferMemoryDescriptorPool2 *this)

{
  OSObject::~OSObject((OSObject *)this);
  _OSObject_typed_operator_delete(&IOAccelBufferMemoryDescriptorPool2_ktv,this,0x1b0);
  return;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelBufferMemoryDescriptorPool2::operator delete(void*, unsigned long)

void __cdecl
IOAccelBufferMemoryDescriptorPool2::operator_delete(undefined8 param_1,undefined8 param_2)

{
  _OSObject_typed_operator_delete(&IOAccelBufferMemoryDescriptorPool2_ktv,param_1,param_2);
  return;
}



// IOAccelBufferMemoryDescriptorPool2::getMetaClass() const

undefined1 * IOAccelBufferMemoryDescriptorPool2::getMetaClass(void)

{
  return &gMetaClass;
}



// IOAccelBufferMemoryDescriptorPool2::MetaClass::MetaClass()

void __thiscall IOAccelBufferMemoryDescriptorPool2::MetaClass::MetaClass(MetaClass *this)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)this,"IOAccelBufferMemoryDescriptorPool2",
             (OSMetaClass *)PTR_gMetaClass_0006b068,0x1b0);
  *(undefined ***)this = &PTR__MetaClass_00081cf8;
  return;
}



// IOAccelBufferMemoryDescriptorPool2::MetaClass::alloc() const

OSObject * IOAccelBufferMemoryDescriptorPool2::MetaClass::alloc(void)

{
  OSObject *this;
  
  this = (OSObject *)_OSObject_typed_operator_new(&IOAccelBufferMemoryDescriptorPool2_ktv,0x1b0);
  OSObject::OSObject(this,(OSMetaClass *)&IOAccelBufferMemoryDescriptorPool2::gMetaClass);
  *(undefined ***)this = &PTR__IOAccelBufferMemoryDescriptorPool2_00081bc8;
  OSMetaClass::instanceConstructed();
  return this;
}



// IOAccelBufferMemoryDescriptorPool2::operator new(unsigned long)

void * __thiscall
IOAccelBufferMemoryDescriptorPool2::operator_new(IOAccelBufferMemoryDescriptorPool2 *this)

{
  void *pvVar1;
  
  pvVar1 = (void *)_OSObject_typed_operator_new(&IOAccelBufferMemoryDescriptorPool2_ktv,this);
  return pvVar1;
}



// IOAccelBufferMemoryDescriptorPool2::IOAccelBufferMemoryDescriptorPool2()

void __thiscall
IOAccelBufferMemoryDescriptorPool2::IOAccelBufferMemoryDescriptorPool2
          (IOAccelBufferMemoryDescriptorPool2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelBufferMemoryDescriptorPool2_00081bc8;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelBufferMemoryDescriptorPool2::IOAccelBufferMemoryDescriptorPool2()

void __thiscall
IOAccelBufferMemoryDescriptorPool2::IOAccelBufferMemoryDescriptorPool2
          (IOAccelBufferMemoryDescriptorPool2 *this)

{
  OSObject::OSObject((OSObject *)this,(OSMetaClass *)&gMetaClass);
  *(undefined ***)this = &PTR__IOAccelBufferMemoryDescriptorPool2_00081bc8;
  OSMetaClass::instanceConstructed();
  return;
}



// IOAccelBufferMemoryDescriptorPool2::initWithAccelerator(IOGraphicsAccelerator2*)

undefined8 __thiscall
IOAccelBufferMemoryDescriptorPool2::initWithAccelerator
          (IOAccelBufferMemoryDescriptorPool2 *this,long param_1)

{
  undefined4 uVar1;
  uint uVar2;
  undefined8 uVar3;
  long lVar4;
  ulong uVar5;
  ulong uVar6;
  long lVar7;
  
  (**(code **)(PTR_vtable_0006b0a0 + 0x98))();
  *(long *)(this + 0x10) = param_1;
  *(undefined8 *)(this + 0x18) = *(undefined8 *)(param_1 + 0x380);
  uVar6 = 0;
  do {
    *(undefined4 *)(this + uVar6 * 0x18 + 0x28) = 0;
    uVar1 = (&sWiredPoolInfo)[uVar6 * 3];
    uVar2 = (&DAT_0006af84)[uVar6 * 3];
    *(uint *)(this + uVar6 * 0x18 + 0x30) = uVar2;
    *(undefined4 *)(this + uVar6 * 0x18 + 0x2c) = (&DAT_0006af88)[uVar6 * 3];
    *(undefined4 *)(this + uVar6 * 0x18 + 0x34) = uVar1;
    uVar3 = _IOMallocTypeVarImpl
                      (&initWithAccelerator(IOGraphicsAccelerator2*)::kalloc_type_view_115,
                       (ulong)uVar2 << 3);
    *(undefined8 *)(this + uVar6 * 0x18 + 0x20) = uVar3;
    lVar7 = uVar6 * 0x20;
    *(undefined4 *)(this + lVar7 + 300) = 0x40;
    uVar3 = _IOMallocTypeVarImpl
                      (&initWithAccelerator(IOGraphicsAccelerator2*)::kalloc_type_view_118,0x400);
    *(undefined8 *)(this + lVar7 + 0x110) = uVar3;
    lVar4 = _IOMallocData(0x1000);
    *(long *)(this + lVar7 + 0x118) = lVar4;
    *(undefined4 *)(this + lVar7 + 0x128) = 0;
    *(undefined8 *)(this + lVar7 + 0x120) = 0;
    if (*(int *)(this + lVar7 + 300) != 0) {
      uVar5 = 0;
      do {
        (**(code **)(**(long **)(this + 0x18) + 0x140))(*(long **)(this + 0x18),lVar4);
        uVar5 = uVar5 + 1;
        lVar4 = lVar4 + 0x40;
      } while (uVar5 < *(uint *)(this + lVar7 + 300));
    }
    *(undefined4 *)(this + uVar6 * 0x18 + 0xa0) = 0;
    uVar1 = (&sPurgeablePoolInfo)[uVar6 * 3];
    uVar2 = (&DAT_0006afc4)[uVar6 * 3];
    *(uint *)(this + uVar6 * 0x18 + 0xa8) = uVar2;
    *(undefined4 *)(this + uVar6 * 0x18 + 0xa4) = (&DAT_0006afc8)[uVar6 * 3];
    *(undefined4 *)(this + uVar6 * 0x18 + 0xac) = uVar1;
    uVar3 = _IOMallocTypeVarImpl
                      (&initWithAccelerator(IOGraphicsAccelerator2*)::kalloc_type_view_133,
                       (ulong)uVar2 << 3);
    *(undefined8 *)(this + uVar6 * 0x18 + 0x98) = uVar3;
    uVar3 = fillWiredPoolBucket(this,uVar6 & 0xffffffff,0);
    uVar6 = uVar6 + 1;
  } while (uVar6 != 5);
  return CONCAT71((int7)((ulong)uVar3 >> 8),1);
}



// IOAccelBufferMemoryDescriptorPool2::fillWiredPoolBucket(unsigned int, int)

void __thiscall
IOAccelBufferMemoryDescriptorPool2::fillWiredPoolBucket
          (IOAccelBufferMemoryDescriptorPool2 *this,ulong param_2_00,int param_2)

{
  IOAccelBufferMemoryDescriptorPool2 *pIVar1;
  IOAccelBufferMemoryDescriptorPool2 IVar2;
  code *pcVar3;
  long lVar4;
  long *plVar5;
  ulong uVar6;
  int iVar7;
  char cVar8;
  int iVar9;
  int iVar10;
  ulong uVar11;
  undefined8 uVar12;
  task *ptVar13;
  uint uVar14;
  ulong uVar15;
  uint uVar16;
  ulong uVar17;
  IOAccelBufferMemoryDescriptorPool2 *pIVar18;
  long lVar19;
  int local_44;
  IOAccelBufferMemoryDescriptorPool2 *local_40;
  uint local_38;
  int local_34;
  
  uVar11 = param_2_00 & 0xffffffff;
  uVar16 = *(uint *)(this + uVar11 * 0x18 + 0x28);
  iVar9 = *(int *)(this + uVar11 * 0x18 + 0x2c) - uVar16;
  if ((int)(*(int *)(this + uVar11 * 0x18 + 0x2c) - uVar16) < *(int *)(this + uVar11 * 0x20 + 0x128)
     ) {
    iVar9 = *(int *)(this + uVar11 * 0x20 + 0x128);
  }
  if (0 < iVar9) {
    iVar7 = iVar9;
    if (param_2 < iVar9) {
      iVar7 = param_2;
    }
    pIVar18 = this + uVar11 * 0x18 + 0x28;
    if (param_2 == 0) {
      iVar7 = iVar9;
    }
    uVar15 = (ulong)*(uint *)(this + uVar11 * 0x18 + 0xa0);
    IVar2 = this[uVar11 * 0x18 + 0x34];
    if (0 < iVar7) {
      pIVar1 = this + uVar11 * 0x20 + 0x110;
      pcVar3 = *(code **)(PTR_vtable_0006b098 + 0x130);
      local_34 = 0;
      local_40 = pIVar18;
LAB_00057e7b:
      do {
        if (uVar16 < *(uint *)(this + uVar11 * 0x18 + 0x30)) {
          if (*(int *)(pIVar18 + 0x78) == 0) {
            uVar15 = 0;
            goto LAB_00057ee9;
          }
          uVar14 = *(int *)(pIVar18 + 0x78) - 1;
          uVar15 = (ulong)uVar14;
          ptVar13 = *(task **)(*(long *)(this + uVar11 * 0x18 + 0x98) + uVar15 * 8);
          *(undefined8 *)(*(long *)(this + uVar11 * 0x18 + 0x98) + uVar15 * 8) = 0;
          *(uint *)(pIVar18 + 0x78) = uVar14;
          local_44 = -0x55555556;
          iVar9 = (*pcVar3)(ptVar13,2,&local_44);
          if (((iVar9 != 0) || (local_44 == 4)) ||
             (iVar9 = (**(code **)(*(long *)ptVar13 + 0x1f0))(ptVar13,8), iVar9 != 0)) {
            (**(code **)(*(long *)ptVar13 + 0x28))();
            goto LAB_00057e7b;
          }
LAB_0005804c:
          *(task **)(*(long *)(this + uVar11 * 0x18 + 0x20) + (ulong)uVar16 * 8) = ptVar13;
          uVar16 = uVar16 + 1;
        }
        else {
LAB_00057ee9:
          local_38 = uVar16;
          if (*(int *)(pIVar1 + 0x18) == 0) {
LAB_00057fca:
            uVar16 = local_38;
            pIVar18 = local_40;
            if (*(int *)(*(long *)(this + 0x10) + 0x90) != 0) break;
            if (local_38 < *(uint *)(this + uVar11 * 0x18 + 0x2c)) {
              ptVar13 = (task *)IOBufferMemoryDescriptor::inTaskWithOptions
                                          ((task *)0x0,0x100363,1L << ((byte)IVar2 & 0x3f),1,0,100);
              if (ptVar13 != (task *)0x0) {
                IOGeneralMemoryDescriptor::setOwnership
                          (ptVar13,(int)*(undefined8 *)PTR__kernel_task_0006b100,4);
                iVar9 = (**(code **)(*(long *)ptVar13 + 0x1f0))(ptVar13,0);
                if (iVar9 == 0) goto LAB_0005804c;
                (**(code **)(*(long *)ptVar13 + 0x28))(ptVar13);
              }
              break;
            }
          }
          else {
            uVar17 = *(ulong *)(pIVar1 + 0x10);
            lVar4 = *(long *)pIVar1;
            lVar19 = *(long *)(pIVar1 + 8);
            do {
              if (uVar17 == 0) goto LAB_00057fca;
              pIVar18 = local_40;
              uVar16 = local_38;
              if (*(int *)(*(long *)(this + 0x10) + 0x90) != 0) goto LAB_00058068;
              uVar6 = 0;
              if (uVar17 != 0) {
                for (; (uVar17 >> uVar6 & 1) == 0; uVar6 = uVar6 + 1) {
                }
              }
              uVar17 = uVar17 ^ 1L << (uVar6 & 0x3f);
              cVar8 = (**(code **)(**(long **)(this + 0x18) + 400))
                                (*(long **)(this + 0x18),uVar6 * 0x40 + lVar19);
            } while (cVar8 == '\0');
            lVar19 = uVar6 * 0x10;
            plVar5 = *(long **)(lVar4 + lVar19);
            *(undefined8 *)(lVar4 + lVar19) = 0;
            *(undefined8 *)(lVar4 + 8 + lVar19) = 0;
            uVar12 = (**(code **)(*plVar5 + 0x1c8))(plVar5);
            (**(code **)(*plVar5 + 0x1e8))(plVar5,0,0,uVar12);
            uVar16 = local_38;
            *(ulong *)(pIVar1 + 0x10) = *(ulong *)(pIVar1 + 0x10) ^ 1L << ((byte)uVar6 & 0x3f);
            *(int *)(pIVar1 + 0x18) = *(int *)(pIVar1 + 0x18) + -1;
            if (local_38 < *(uint *)(this + uVar11 * 0x18 + 0x30)) {
              *(long **)(*(long *)(this + uVar11 * 0x18 + 0x20) + (ulong)local_38 * 8) = plVar5;
              pIVar18 = local_40;
              uVar16 = local_38 + 1;
            }
            else {
              (**(code **)(*plVar5 + 0x1f8))(plVar5,0);
              pIVar18 = local_40;
              if ((uint)uVar15 < *(uint *)(this + uVar11 * 0x18 + 0xa8)) {
                *(long **)(*(long *)(this + uVar11 * 0x18 + 0x98) + uVar15 * 8) = plVar5;
                (**(code **)(*plVar5 + 0x120))(plVar5,3,0);
                uVar15 = (ulong)((uint)uVar15 + 1);
              }
              else {
                iVar10 = 1 << ((byte)this[uVar11 * 0x18 + 0x34] & 0x1f);
                iVar9 = iVar10 + 0x3ff;
                if (-1 < iVar10) {
                  iVar9 = iVar10;
                }
                __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                                  "fillWired detected over-capacity dirty bucket, freeing %dKB  w: %d %d p: %d %d\n\n"
                                  ,iVar9 >> 10,uVar16,*(undefined4 *)(this + uVar11 * 0x18 + 0x30),
                                  uVar15,*(uint *)(this + uVar11 * 0x18 + 0xa8));
                (**(code **)(*plVar5 + 0x28))();
              }
            }
          }
        }
LAB_00058068:
        local_34 = local_34 + 1;
      } while (local_34 != iVar7);
    }
    *(uint *)pIVar18 = uVar16;
    *(int *)(pIVar18 + 0x78) = (int)uVar15;
  }
  return;
}



// IOAccelBufferMemoryDescriptorPool2::free()

void __thiscall IOAccelBufferMemoryDescriptorPool2::free(IOAccelBufferMemoryDescriptorPool2 *this)

{
  long *plVar1;
  undefined8 uVar2;
  uint uVar3;
  IOAccelBufferMemoryDescriptorPool2 *pIVar4;
  IOAccelBufferMemoryDescriptorPool2 *pIVar5;
  IOAccelBufferMemoryDescriptorPool2 *pIVar6;
  long lVar7;
  ulong uVar8;
  long lVar9;
  ulong uVar10;
  long lVar11;
  
  lVar9 = 0;
  do {
    pIVar6 = this + lVar9 * 0x18 + 0x20;
    if (*(int *)(this + lVar9 * 0x18 + 0x28) != 0) {
      uVar10 = 0;
      do {
        plVar1 = *(long **)(*(long *)pIVar6 + uVar10 * 8);
        (**(code **)(*plVar1 + 0x1f8))(plVar1,0);
        (**(code **)(**(long **)(*(long *)pIVar6 + uVar10 * 8) + 0x28))();
        uVar10 = uVar10 + 1;
      } while (uVar10 < *(uint *)(this + lVar9 * 0x18 + 0x28));
    }
    pIVar4 = this + lVar9 * 0x18 + 0x98;
    if (*(int *)(this + lVar9 * 0x18 + 0xa0) != 0) {
      uVar10 = 0;
      do {
        (**(code **)(**(long **)(*(long *)pIVar4 + uVar10 * 8) + 0x28))();
        uVar10 = uVar10 + 1;
      } while (uVar10 < *(uint *)(this + lVar9 * 0x18 + 0xa0));
    }
    lVar7 = lVar9 * 0x20;
    pIVar5 = this + lVar7 + 0x110;
    uVar3 = *(uint *)(this + lVar7 + 300);
    if (uVar3 != 0) {
      uVar10 = *(ulong *)(this + lVar7 + 0x120);
      lVar11 = 0;
      uVar8 = 0;
      do {
        if ((uVar10 >> (uVar8 & 0x3f) & 1) != 0) {
          (**(code **)(**(long **)(*(long *)pIVar5 + lVar11) + 0x1f8))
                    (*(long **)(*(long *)pIVar5 + lVar11),0);
          (**(code **)(**(long **)(*(long *)pIVar5 + lVar11) + 0x28))();
          uVar3 = *(uint *)(this + lVar7 + 300);
        }
        uVar8 = uVar8 + 1;
        lVar11 = lVar11 + 0x10;
      } while (uVar8 < uVar3);
    }
    lVar11 = *(long *)pIVar6;
    *(long *)pIVar6 = 0;
    _IOFreeTypeVarImpl(&free()::kalloc_type_view_167,lVar11,
                       (ulong)*(uint *)(this + lVar9 * 0x18 + 0x30) << 3);
    lVar11 = *(long *)pIVar4;
    *(long *)pIVar4 = 0;
    _IOFreeTypeVarImpl(&free()::kalloc_type_view_168,lVar11,
                       (ulong)*(uint *)(this + lVar9 * 0x18 + 0xa8) << 3);
    lVar11 = *(long *)pIVar5;
    *(long *)pIVar5 = 0;
    _IOFreeTypeVarImpl(&free()::kalloc_type_view_169,lVar11,
                       (ulong)*(uint *)(this + lVar7 + 300) << 4);
    uVar2 = *(undefined8 *)(this + lVar7 + 0x118);
    *(undefined8 *)(this + lVar7 + 0x118) = 0;
    _IOFreeData(uVar2);
    lVar9 = lVar9 + 1;
  } while (lVar9 != 5);
                    // WARNING: Could not recover jumptable at 0x0005831c. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(PTR_vtable_0006b0a0 + 0xa0))(this);
  return;
}



// IOAccelBufferMemoryDescriptorPool2::describeDriverAllocations(IOAccelAllocationInfo*)

void __thiscall
IOAccelBufferMemoryDescriptorPool2::describeDriverAllocations
          (IOAccelBufferMemoryDescriptorPool2 *this,IOAccelAllocationInfo *param_1)

{
  IOAccelBufferMemoryDescriptorPool2 IVar1;
  IOAccelBufferMemoryDescriptorPool2 *pIVar2;
  long lVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  
  pIVar2 = this + 0x128;
  lVar3 = 0;
  uVar5 = 0;
  uVar6 = 0;
  uVar4 = 0;
  do {
    IVar1 = this[lVar3 + 0x34];
    uVar4 = uVar4 + ((ulong)*(uint *)(this + lVar3 + 0x28) << ((byte)IVar1 & 0x3f));
    uVar6 = uVar6 + ((ulong)*(uint *)(this + lVar3 + 0xa0) << ((byte)IVar1 & 0x3f));
    uVar5 = uVar5 + ((ulong)*(uint *)pIVar2 << ((byte)IVar1 & 0x3f));
    lVar3 = lVar3 + 0x18;
    pIVar2 = pIVar2 + 0x20;
  } while (lVar3 != 0x78);
  IOAccelAllocationInfo::declareAdditionalSystemMemory(param_1,uVar4,0,"Buffer Cache Wired Clean");
  IOAccelAllocationInfo::declareAdditionalSystemMemory
            (param_1,uVar6,0,"Buffer Cache Purgeable Clean");
  IOAccelAllocationInfo::declareAdditionalSystemMemory(param_1,uVar5,0,"Buffer Cache Wired Dirty");
  return;
}



// IOAccelBufferMemoryDescriptorPool2::newWiredDescriptorsWithLength(unsigned long long, unsigned
// int*, task*, IOAccelEvent*, bool, bool*)

void * __thiscall
IOAccelBufferMemoryDescriptorPool2::newWiredDescriptorsWithLength
          (IOAccelBufferMemoryDescriptorPool2 *this,ulong param_1,undefined4 *param_2,long param_3,
          undefined8 param_4,char param_5,undefined1 *param_6)

{
  IOAccelBufferMemoryDescriptorPool2 IVar1;
  long lVar2;
  long lVar3;
  ulong uVar4;
  uint uVar5;
  int iVar6;
  long lVar7;
  long *plVar8;
  void *pvVar9;
  IOAccelBufferMemoryDescriptorPool2 *pIVar10;
  int iVar11;
  long lVar12;
  ulong uVar13;
  long lVar14;
  undefined8 *puVar15;
  ulong uVar16;
  ulong uVar17;
  size_t sVar18;
  ulong uVar19;
  ulong uVar20;
  bool bVar21;
  int local_2e4;
  long local_2e0;
  long local_2d8;
  ulong local_2d0;
  uint local_2c4;
  IOAccelBufferMemoryDescriptorPool2 *local_2c0;
  int local_2b8 [8];
  int local_298 [8];
  int local_278 [8];
  int local_258 [8];
  undefined8 local_238 [64];
  long local_38;
  
  local_38 = *(long *)PTR____stack_chk_guard_0006b0b0;
  _memset(local_238,0xaa,0x200);
  pvVar9 = (void *)0x0;
  local_2c0 = this;
  if (param_1 <= (uint)(*(int *)(this + 0x2c) << ((byte)this[0x34] & 0x1f))) {
    local_258[4] = 0;
    local_258[2] = 0;
    local_258[3] = 0;
    local_258[0] = 0;
    local_258[1] = 0;
    local_278[4] = 0;
    local_278[2] = 0;
    local_278[3] = 0;
    local_278[0] = 0;
    local_278[1] = 0;
    local_298[4] = 0;
    local_298[2] = 0;
    local_298[3] = 0;
    local_298[0] = 0;
    local_298[1] = 0;
    local_2b8[4] = 0;
    local_2b8[2] = 0;
    local_2b8[3] = 0;
    local_2b8[0] = 0;
    local_2b8[1] = 0;
    *param_6 = 0;
    lVar12 = 0;
    local_2c4 = 0;
    uVar17 = 0;
    do {
      local_2e0 = lVar12 * 3;
      uVar19 = param_1 >> ((byte)local_2c0[lVar12 * 0x18 + 0x34] & 0x3f);
      local_2d8 = lVar12;
      if (param_5 == '\0') {
        lVar14 = lVar12 * 0x20;
        iVar6 = *(int *)(local_2c0 + lVar14 + 0x128);
        uVar13 = *(ulong *)(local_2c0 + lVar14 + 0x120);
        uVar16 = uVar13;
        if ((uVar13 == 0) || (uVar19 == 0)) {
          uVar20 = 0;
        }
        else {
          pIVar10 = local_2c0 + lVar14 + 0x110;
          lVar2 = *(long *)pIVar10;
          lVar3 = *(long *)(local_2c0 + lVar14 + 0x118);
          uVar20 = 0;
          do {
            uVar4 = 0;
            if (uVar13 != 0) {
              for (; (uVar13 >> uVar4 & 1) == 0; uVar4 = uVar4 + 1) {
              }
            }
            uVar13 = uVar13 ^ 1L << (uVar4 & 0x3f);
            lVar7 = uVar4 * 0x10;
            if (*(long *)(*(long *)pIVar10 + 8 + lVar7) == param_3) {
              local_238[uVar17 & 0xffffffff] = *(undefined8 *)(lVar2 + lVar7);
              *(undefined8 *)(lVar2 + lVar7) = 0;
              *(undefined8 *)(lVar2 + 8 + lVar7) = 0;
              local_2d0 = uVar20;
              (**(code **)(**(long **)(local_2c0 + 0x18) + 0x1b8))
                        (*(long **)(local_2c0 + 0x18),uVar4 * 0x40 + lVar3,param_4);
              uVar17 = (ulong)((int)uVar17 + 1);
              local_258[local_2d8] = local_258[local_2d8] + 1;
              uVar20 = local_2d0 + 1;
              iVar6 = iVar6 + -1;
              uVar16 = uVar16 ^ 1L << ((byte)uVar4 & 0x3f);
              *param_6 = 1;
              lVar12 = local_2d8;
            }
          } while ((uVar13 != 0) && (uVar20 < uVar19));
        }
        *(int *)(local_2c0 + lVar14 + 0x128) = iVar6;
        *(ulong *)(local_2c0 + lVar14 + 0x120) = uVar16;
      }
      else {
        uVar20 = 0;
      }
      uVar5 = *(uint *)(local_2c0 + local_2e0 * 8 + 0x28);
      if ((uVar20 < uVar19) && (uVar5 != 0)) {
        iVar6 = local_278[lVar12];
        puVar15 = (undefined8 *)
                  (*(long *)(local_2c0 + local_2e0 * 8 + 0x20) + (ulong)(uVar5 - 1) * 8);
        lVar12 = 0;
        do {
          iVar11 = (int)lVar12;
          local_238[(uint)((int)uVar17 + iVar11)] = *puVar15;
          *puVar15 = 0;
          lVar14 = lVar12 + uVar20;
          lVar12 = lVar12 + 1;
          if (uVar19 <= lVar14 + 1U) break;
          puVar15 = puVar15 + -1;
        } while (uVar5 - 1 != iVar11);
        iVar11 = (int)lVar12;
        local_278[local_2d8] = iVar6 + iVar11;
        uVar20 = uVar20 + lVar12;
        uVar5 = uVar5 - iVar11;
        uVar17 = (ulong)(uint)((int)uVar17 + iVar11);
        lVar12 = local_2d8;
      }
      pIVar10 = local_2c0 + local_2e0 * 8 + 0x34;
      *(uint *)(local_2c0 + local_2e0 * 8 + 0x28) = uVar5;
      local_2c4 = local_2c4 & 0xff;
      if (uVar5 < *(uint *)(local_2c0 + local_2e0 * 8 + 0x2c)) {
        local_2c4 = 1;
      }
      if (uVar20 != uVar19) {
        iVar6 = *(int *)(local_2c0 + local_2e0 * 8 + 0xa0);
        local_2d0 = uVar17;
        if ((uVar20 < uVar19) && (iVar6 != 0)) {
          puVar15 = (undefined8 *)
                    (*(long *)(local_2c0 + local_2e0 * 8 + 0x98) + (ulong)(iVar6 - 1) * 8);
          iVar11 = iVar6;
          do {
            plVar8 = (long *)*puVar15;
            *puVar15 = 0;
            local_2e4 = 0;
            iVar6 = (**(code **)(*plVar8 + 0x120))(plVar8,2,&local_2e4);
            if (((iVar6 == 0) && (local_2e4 != 4)) &&
               (iVar6 = (**(code **)(*plVar8 + 0x1f0))(plVar8,8), iVar6 == 0)) {
              local_238[local_2d0 & 0xffffffff] = plVar8;
              local_2d0 = (ulong)((int)local_2d0 + 1);
              uVar20 = uVar20 + 1;
              local_298[local_2d8] = local_298[local_2d8] + 1;
            }
            else {
              (**(code **)(*plVar8 + 0x28))(plVar8);
            }
            iVar6 = iVar11 + -1;
          } while ((uVar20 < uVar19) &&
                  (puVar15 = puVar15 + -1, bVar21 = iVar11 != 1, iVar11 = iVar6, bVar21));
        }
        *(int *)(local_2c0 + local_2e0 * 8 + 0xa0) = iVar6;
        lVar12 = local_2d8;
        uVar17 = local_2d0;
        if ((uVar20 != uVar19) && (IVar1 = *pIVar10, uVar20 < uVar19)) {
          lVar14 = uVar19 - uVar20;
          do {
            plVar8 = (long *)(**(code **)(**(long **)(local_2c0 + 0x10) + 0x928))
                                       (*(long **)(local_2c0 + 0x10),0,0x100363,
                                        (long)(1 << ((byte)IVar1 & 0x1f)),1);
            local_238[uVar17 & 0xffffffff] = plVar8;
            if (plVar8 == (long *)0x0) goto LAB_00058929;
            (**(code **)(*plVar8 + 0x1f0))(plVar8);
            uVar17 = (ulong)((int)uVar17 + 1);
            local_2b8[local_2d8] = local_2b8[local_2d8] + 1;
            lVar14 = lVar14 + -1;
            lVar12 = local_2d8;
          } while (lVar14 != 0);
        }
      }
      param_1 = param_1 - (uVar19 << ((byte)*pIVar10 & 0x3f));
      lVar12 = lVar12 + 1;
    } while (lVar12 != 5);
    sVar18 = (uVar17 & 0xffffffff) << 3;
    pvVar9 = (void *)_IOMallocTypeVarImpl
                               (&newWiredDescriptorsWithLength(unsigned_long_long,unsigned_int*,task*,IOAccelEvent*,bool,bool*)
                                 ::kalloc_type_view_485,sVar18);
    pIVar10 = local_2c0;
    if (pvVar9 == (void *)0x0) {
LAB_00058929:
      releaseDescriptors(local_2c0,(long)local_238,(uint)uVar17,param_3,param_4);
      if ((uint)uVar17 == 0) {
        uVar17 = 0;
        pvVar9 = (void *)0x0;
      }
      else {
        uVar19 = 0;
        do {
          (**(code **)(*(long *)local_238[uVar19] + 0x28))();
          uVar19 = uVar19 + 1;
        } while ((uVar17 & 0xffffffff) != uVar19);
        pvVar9 = (void *)0x0;
        uVar17 = 0;
      }
    }
    else {
      _memcpy(pvVar9,local_238,sVar18);
      if ((local_2c4 & 1) != 0) {
        IOGraphicsAccelerator2::kickMemoryPoolTimer(*(IOGraphicsAccelerator2 **)(pIVar10 + 0x10));
      }
    }
    *param_2 = (int)uVar17;
  }
  if (*(long *)PTR____stack_chk_guard_0006b0b0 != local_38) {
                    // WARNING: Subroutine does not return
    ___stack_chk_fail();
  }
  return pvVar9;
}



// IOAccelBufferMemoryDescriptorPool2::releaseDescriptors(IOBufferMemoryDescriptor**, unsigned int,
// task*, IOAccelEvent*)

void __thiscall
IOAccelBufferMemoryDescriptorPool2::releaseDescriptors
          (IOAccelBufferMemoryDescriptorPool2 *this,long param_1,uint param_2,undefined8 param_3,
          undefined8 param_4)

{
  int *piVar1;
  long *plVar2;
  long lVar3;
  long lVar4;
  int iVar5;
  long lVar6;
  IOAccelBufferMemoryDescriptorPool2 *pIVar7;
  undefined8 *puVar8;
  ulong uVar9;
  ulong uVar10;
  ulong uVar11;
  int local_7c;
  undefined8 local_78;
  undefined8 local_70;
  undefined4 local_68;
  undefined8 local_58;
  undefined8 local_50;
  undefined4 local_48;
  long local_38;
  
  local_38 = *(long *)PTR____stack_chk_guard_0006b0b0;
  uVar11 = 0;
  local_48 = 0;
  local_50 = 0;
  local_58 = 0;
  local_68 = 0;
  local_70 = 0;
  local_78 = 0;
  if (param_2 != 0) {
    uVar9 = 0;
    do {
      lVar6 = (**(code **)(**(long **)(param_1 + uVar9 * 8) + 0x1c8))();
      IOGeneralMemoryDescriptor::setOwnership
                (*(task **)(param_1 + uVar9 * 8),(int)*(undefined8 *)PTR__kernel_task_0006b100,4);
      if ((uint)uVar11 < 5) {
        uVar11 = uVar11 & 0xffffffff;
        pIVar7 = this + uVar11 * 0x18 + 0x34;
        while (lVar6 != 1 << ((byte)*pIVar7 & 0x1f)) {
          uVar11 = uVar11 + 1;
          pIVar7 = pIVar7 + 0x18;
          if (uVar11 == 5) goto LAB_00058bf5;
        }
      }
      else if ((uint)uVar11 == 5) break;
      uVar10 = uVar11 & 0xffffffff;
      lVar6 = uVar10 * 0x20;
      if ((0 < (int)((*(int *)(this + uVar10 * 0x18 + 0x30) + *(int *)(this + uVar10 * 0x18 + 0xa8))
                    - (*(int *)(this + uVar10 * 0x18 + 0x28) + *(int *)(this + uVar10 * 0x18 + 0xa0)
                      + *(uint *)(this + lVar6 + 0x128)))) &&
         (*(uint *)(this + lVar6 + 0x128) < *(uint *)(this + lVar6 + 300))) {
        plVar2 = *(long **)(param_1 + uVar9 * 8);
        local_7c = 0;
        iVar5 = (**(code **)(*plVar2 + 0x120))(plVar2,2,&local_7c);
        puVar8 = &local_78;
        if ((iVar5 == 0) && (local_7c != 4)) {
          iVar5 = (**(code **)(*plVar2 + 0x1f0))(plVar2,8);
          puVar8 = &local_78;
          if (iVar5 == 0) {
            lVar4 = 0;
            if (~*(ulong *)(this + lVar6 + 0x120) != 0) {
              for (; (~*(ulong *)(this + lVar6 + 0x120) >> lVar4 & 1) == 0; lVar4 = lVar4 + 1) {
              }
            }
            (**(code **)(*plVar2 + 0x20))(plVar2);
            lVar3 = *(long *)(this + lVar6 + 0x110);
            *(long **)(lVar3 + lVar4 * 0x10) = plVar2;
            *(undefined8 *)(lVar3 + 8 + lVar4 * 0x10) = param_3;
            (**(code **)(**(long **)(this + 0x18) + 0x1b0))
                      (*(long **)(this + 0x18),param_4,
                       lVar4 * 0x40 + *(long *)(this + lVar6 + 0x118));
            *(ulong *)(this + lVar6 + 0x120) =
                 *(ulong *)(this + lVar6 + 0x120) | 1L << ((byte)lVar4 & 0x3f);
            *(int *)(this + lVar6 + 0x128) = *(int *)(this + lVar6 + 0x128) + 1;
            puVar8 = &local_58;
          }
        }
        piVar1 = (int *)((long)puVar8 + uVar10 * 4);
        *piVar1 = *piVar1 + 1;
      }
      uVar9 = uVar9 + 1;
    } while (uVar9 != param_2);
  }
LAB_00058bf5:
  if (*(long *)PTR____stack_chk_guard_0006b0b0 != local_38) {
                    // WARNING: Subroutine does not return
    ___stack_chk_fail();
  }
  return;
}



// IOAccelBufferMemoryDescriptorPool2::newDescriptorsWithLength(unsigned long long, unsigned int*,
// task*, IOAccelEvent*, bool)

undefined8 IOAccelBufferMemoryDescriptorPool2::newDescriptorsWithLength(void)

{
  return 0;
}



// IOAccelBufferMemoryDescriptorPool2::anyWiredBucketsBelowLowWaterMark()

bool __thiscall
IOAccelBufferMemoryDescriptorPool2::anyWiredBucketsBelowLowWaterMark
          (IOAccelBufferMemoryDescriptorPool2 *this)

{
  IOAccelBufferMemoryDescriptorPool2 *pIVar1;
  uint uVar2;
  bool bVar3;
  IOAccelBufferMemoryDescriptorPool2 *pIVar4;
  ulong uVar5;
  IOAccelBufferMemoryDescriptorPool2 *pIVar6;
  
  bVar3 = true;
  if (*(uint *)(this + 0x2c) <= *(uint *)(this + 0x28)) {
    pIVar6 = this + 0x128;
    bVar3 = true;
    uVar5 = 0;
    pIVar4 = this + 0x44;
    do {
      if (*(int *)pIVar6 != 0) {
        return bVar3;
      }
      bVar3 = uVar5 < 4;
      if (uVar5 == 4) {
        return false;
      }
      pIVar1 = pIVar4 + -4;
      pIVar6 = pIVar6 + 0x20;
      uVar5 = uVar5 + 1;
      uVar2 = *(uint *)pIVar4;
      pIVar4 = pIVar4 + 0x18;
    } while (uVar2 <= *(uint *)pIVar1);
  }
  return bVar3;
}



// IOAccelBufferMemoryDescriptorPool2::fillWiredBuckets(int)

void __thiscall
IOAccelBufferMemoryDescriptorPool2::fillWiredBuckets
          (IOAccelBufferMemoryDescriptorPool2 *this,int param_1)

{
  uint uVar1;
  ulong uVar2;
  
  uVar2 = 0;
  do {
    if (*(int *)(*(long *)(this + 0x10) + 0x90) != 0) {
      return;
    }
    fillWiredPoolBucket(this,uVar2,param_1);
    uVar1 = (int)uVar2 + 1;
    uVar2 = (ulong)uVar1;
  } while (uVar1 != 5);
  return;
}



// IOAccelBufferMemoryDescriptorPool2::MetaClass::~MetaClass()

void __thiscall IOAccelBufferMemoryDescriptorPool2::MetaClass::~MetaClass(MetaClass *this)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)this);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __GLOBAL__sub_I_IOAccelBufferMemoryDescriptorPool_cpp(void)

{
  OSMetaClass::OSMetaClass
            ((OSMetaClass *)&IOAccelBufferMemoryDescriptorPool2::gMetaClass,
             "IOAccelBufferMemoryDescriptorPool2",(OSMetaClass *)PTR_gMetaClass_0006b068,0x1b0);
  _gMetaClass = &PTR__MetaClass_00081cf8;
  return;
}



void __GLOBAL__D_a(void)

{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOAccelBufferMemoryDescriptorPool2::gMetaClass);
  return;
}



undefined8 __start(void)

{
  undefined8 uVar1;
  
  if (__realmain != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00058d0a. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (*__realmain)();
    return uVar1;
  }
  return 0;
}



char * _OSKextGetCurrentIdentifier(void)

{
  return s_com_apple_iokit_IOAcceleratorFam_00081de0;
}



char * _OSKextGetCurrentVersionString(void)

{
  return s_1_0_0d1_00081e20;
}



undefined4 _OSKextGetCurrentLoadTag(void)

{
  return DAT_00081ddc;
}



undefined8 __stop(void)

{
  undefined8 uVar1;
  
  if (__antimain != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00058d56. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (*__antimain)();
    return uVar1;
  }
  return 0;
}



// IOAccelLegacyDisplayMachine::found_framebuffer(IOFramebuffer*) [clone .cold.1]

void IOAccelLegacyDisplayMachine::found_framebuffer(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"IOAccelLegacyDisplayPipe based object is expected but got a IOAccelDisplayPipe based object\" @%s:%d"
         ,"IOAccelLegacyDisplayMachine.cpp",0x9a);
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelLegacyDisplayMachine::display_mode_did_change(unsigned int) [clone .cold.1]

void __cdecl IOAccelLegacyDisplayMachine::display_mode_did_change(long *param_1)

{
                    // WARNING: Subroutine does not return
  _panic("\"%s: %s driver returns false\" @%s:%d",
         "virtual bool IOAccelLegacyDisplayMachine::display_mode_did_change(uint32_t)",
         *(undefined8 *)(*param_1 + 0xc88),"IOAccelLegacyDisplayMachine.cpp",0x10b);
}



// IOAccelResidentMemorySet::realloc() [clone .cold.1]

void IOAccelResidentMemorySet::realloc(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"IOAccelResidentMemorySet unable to expand\" @%s:%d","IOAccelResidentSet.cpp",0x6d);
}



// IOAccelResidentMemorySet::setCollectionEras(IOAccelCollectionEra*) [clone .cold.1]

void IOAccelResidentMemorySet::setCollectionEras(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelMemory::free() [clone .cold.1]

void IOAccelMemory::free(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"Freeing IOAccelMemory still on a orphan list\" @%s:%d","IOAccelMemory.cpp",0x7e);
}



// IOAccelMemory::add_mapping(IOAccelMemoryMap*) [clone .cold.1]

void IOAccelMemory::add_mapping(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"failed to allocate memory\" @%s:%d","IOAccelMemory.cpp",0xb9);
}



// IOAccelFIFOChannel2::init(IOGraphicsAccelerator2*, int, int, int, int) [clone .cold.1]

void IOAccelFIFOChannel2::init(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelFIFOChannel2::restart() [clone .cold.1]

void __cdecl IOAccelFIFOChannel2::restart(long *param_1,undefined8 *param_2)

{
  uint uVar1;
  undefined8 uVar2;
  char *pcVar3;
  
  uVar2 = (**(code **)(*param_1 + 0x170))();
  uVar1 = *(uint *)(param_1 + 4);
  pcVar3 = IOGraphicsAccelerator2::getModelName((IOGraphicsAccelerator2 *)*param_2);
                    // WARNING: Subroutine does not return
  _panic("\"Channel %s ; StampIndex %d : GPU (%s) hang (boot-args contains \\\"panic_on_gpu_hang=1\\\")\" @%s:%d"
         ,uVar2,(ulong)uVar1,pcVar3,"IOAccelChannel.cpp",0x1f8);
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelDisplayMachine::display_mode_did_change(unsigned int) [clone .cold.1]

void __cdecl IOAccelDisplayMachine::display_mode_did_change(long *param_1)

{
                    // WARNING: Subroutine does not return
  _panic("\"%s: %s driver returns false\" @%s:%d",
         "virtual bool IOAccelDisplayMachine::display_mode_did_change(uint32_t)",
         *(undefined8 *)(*param_1 + 0xc88),"IOAccelDisplayMachine.cpp",0x159);
}



// IOAccelLegacySurface::surfaceStart() [clone .cold.1]

void IOAccelLegacySurface::surfaceStart(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"Expecting IOAccelLegacyDisplayMachine but got IOAccelDisplayMachine\" @%s:%d",
         "IOAccelLegacySurface.cpp",0x79);
}



// IOAccelResourceList::removeResource(IOAccelResource2*) [clone .cold.1]

void IOAccelResourceList::removeResource(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"%s\" @%s:%d","Attempt to remove resource not on the resident list\n",
         "IOAccelListMachine.cpp",0x339);
}



// IOAccelResourceList::removeResource(IOAccelResource2*) [clone .cold.2]

void IOAccelResourceList::removeResource(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"%s\" @%s:%d","Attempt to remove resource not on the resident list\n",
         "IOAccelListMachine.cpp",0x332);
}



// IOAccelResourceList::removeResource(IOAccelResource2*) [clone .cold.3]

void IOAccelResourceList::removeResource(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"%s\" @%s:%d","Attempt to remove resource not on the resident list\n",
         "IOAccelListMachine.cpp",0x32b);
}



// IOAccelResource2::free() [clone .cold.1]

void IOAccelResource2::free(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"IOAccelResource::free called for resource still owned by an IOAccelShared\" @%s:%d",
         "IOAccelResource.cpp",0xfa);
}



// IOAccelResource2::newResourceWithRemoteStorage(IOGraphicsAccelerator2*, IOAccelShared2*, unsigned
// int, unsigned int) [clone .cold.1]

void IOAccelResource2::newResourceWithRemoteStorage(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"getLockedPeer return NULL for locked peer\\n\" @%s:%d","IOAccelResource.cpp",0x606);
}



// IOAccelResource2::retain() const [clone .cold.1]

void IOAccelResource2::retain(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"IOAccelResource::retain: about to wrap around fRetainCount. Leaking refcount?\" @%s:%d",
         "IOAccelResource.cpp",0x139e);
}



// IOAccelRemoteMemory::getPhysicalSegment(unsigned long long, unsigned long long*) [clone .cold.1]

void IOAccelRemoteMemory::getPhysicalSegment(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"IOAccelRemoteMemory::getPhysicalSegment called with null fRemoteStorageMemory\\n\" @%s:%d"
         ,"IOAccelRemoteMemory.cpp",0x37);
}



// IOAccelClientSharedMachine::mapClientSharedForId(unsigned int, void**) [clone .cold.1]

void IOAccelClientSharedMachine::mapClientSharedForId(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"IOClientSharedArrayEntry.bitMask array is too small\" @%s:%d","IOAccelShared.cpp",0x7f);
}



// IOAccelClientSharedMachine::unmapClientSharedForId(unsigned int) [clone .cold.1]

void IOAccelClientSharedMachine::unmapClientSharedForId(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"Trying to Unmap Client Shared for IOACCEL_NAMESPACE_RESERVED_ID(0)\" @%s:%d",
         "IOAccelShared.cpp",0xbc);
}



// IOAccelShared2::unlockPeer(unsigned int) [clone .cold.1]

void IOAccelShared2::unlockPeer(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"IOAccelShared::unlockPeer() peer not locked!\\n\" @%s:%d","IOAccelShared.cpp",0x2c2);
}



// IOAccelLegacyDisplayPipe::init(IOGraphicsAccelerator2*, IOAccelDisplayMachine*, IOFramebuffer*,
// unsigned int) [clone .cold.1]

void IOAccelLegacyDisplayPipe::init(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"expecting IOAccelLegacyDisplayMachine based object but got IOAccelDisplayMachine based object\" @%s:%d"
         ,"IOAccelLegacyDisplayPipe.cpp",0x22);
}



// IOAccelSurface::surface_lock_options(eLockType, unsigned int, IOAccelSurfaceInformation*,
// unsigned long long) [clone .cold.1]

void IOAccelSurface::surface_lock_options(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"try to lock assembly surface that should not exist\" @%s:%d","IOAccelSurface.cpp",0x48a)
  ;
}



// WARNING: Unknown calling convention: __cdecl -- yet parameter storage is locked
// IOAccelSurface::audit_freed_resource(IOAccelResource2*) [clone .cold.1]

void __cdecl IOAccelSurface::audit_freed_resource(uint param_1,undefined8 param_2,long param_3)

{
  __os_log_internal(0,PTR___os_log_default_0006b0b8,0x11,
                    "Resource 0x%016llx freed while surface ID %08x has pointer to it at index %d\n\n"
                    ,param_2,*(undefined4 *)(&DAT_00001168 + param_3),param_1);
                    // WARNING: Subroutine does not return
  _panic("\"Resource 0x%016llx freed while surface ID %08x has pointer to it at index %d\\n\" @%s:%d"
         ,param_2,(ulong)*(uint *)(&DAT_00001168 + param_3),(ulong)param_1,"IOAccelSurface.cpp",
         0xbdb);
}



// IOGraphicsAccelerator2::start(IOService*) [clone .cold.1]

void IOGraphicsAccelerator2::start(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOGraphicsAccelerator2::newUserClient(task*, void*, unsigned int, IOUserClient**) [clone .cold.1]

void IOGraphicsAccelerator2::newUserClient(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"Did you forget to call sharedStop when sharedStart failed?\" @%s:%d",
         "IOGraphicsAccelerator.cpp",0x81a);
}



// IOGraphicsAccelerator2::newUserClient(task*, void*, unsigned int, IOUserClient**) [clone .cold.2]

void IOGraphicsAccelerator2::newUserClient(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"Did you forget to call deviceStop when deviceStart failed?\" @%s:%d",
         "IOGraphicsAccelerator.cpp",0x810);
}



// IOGraphicsAccelerator2::newUserClient(task*, void*, unsigned int, IOUserClient**) [clone .cold.3]

void IOGraphicsAccelerator2::newUserClient(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"Did you forget to call contextStop when contextStart failed?\" @%s:%d",
         "IOGraphicsAccelerator.cpp",0x805);
}



// IOGraphicsAccelerator2::newUserClient(task*, void*, unsigned int, IOUserClient**) [clone .cold.4]

void IOGraphicsAccelerator2::newUserClient(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"Did you forget to call surfaceStop when surfaceStart failed?\" @%s:%d",
         "IOGraphicsAccelerator.cpp",0x7fb);
}



// IOGraphicsAccelerator2::newUserClient(task*, void*, unsigned int, IOUserClient**) [clone .cold.5]

void IOGraphicsAccelerator2::newUserClient(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"Did you forget to call surfaceStop when surfaceStart failed?\" @%s:%d",
         "IOGraphicsAccelerator.cpp",0x7ef);
}



// IOGraphicsAccelerator2::newUserClient(task*, void*, unsigned int, IOUserClient**) [clone .cold.6]

void IOGraphicsAccelerator2::newUserClient(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"Did you forget to call drawableStop when drawableStart failed?\" @%s:%d",
         "IOGraphicsAccelerator.cpp",0x7e5);
}



// IOAccelCommandQueue::processSegmentKernelCommand(IOAccelSegmentResourceList*,
// IOAccelKernelCommand const*, IOAccelKernelCommand const*) [clone .cold.1]

void IOAccelCommandQueue::processSegmentKernelCommand(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelCommandQueue::releaseAcceleratorLock() [clone .cold.1]

void IOAccelCommandQueue::releaseAcceleratorLock(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"IOAccelCommandQueue::releaseAcceleratorLock() called without lock held\\n\" @%s:%d",
         "IOAccelCommandQueue.cpp",0x738);
}



// IOAccelCommandQueue::releaseAcceleratorLock() [clone .cold.2]

void IOAccelCommandQueue::releaseAcceleratorLock(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"releaseAcceleratorLockIfNeeded() called from an unsafe code path\" @%s:%d",
         "IOAccelCommandQueue.cpp",0x732);
}



// IOAccelCommandQueue::acquireAcceleratorLock() [clone .cold.1]

void IOAccelCommandQueue::acquireAcceleratorLock(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"IOAccelCommandQueue::acquireAcceleratorLock() called with lock held\\n\" @%s:%d",
         "IOAccelCommandQueue.cpp",0x729);
}



// IOAccelCommandQueue::process_command_buffer(unsigned int, unsigned int) [clone .cold.1]

void IOAccelCommandQueue::process_command_buffer(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"segment list shmem no longer mapped\" @%s:%d","IOAccelCommandQueue.cpp",0x6bc);
}



// IOAccelCommandQueue::process_command_buffer(unsigned int, unsigned int) [clone .cold.2]

void IOAccelCommandQueue::process_command_buffer(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"kernel command shmem no longer mapped\" @%s:%d","IOAccelCommandQueue.cpp",0x6be);
}



// IOAccelCommandQueue::process_command_buffer(unsigned int, unsigned int) [clone .cold.3]

void IOAccelCommandQueue::process_command_buffer(void)

{
                    // WARNING: Subroutine does not return
  _panic("\"shmemOffset value is corrupt\" @%s:%d","IOAccelCommandQueue.cpp",0x611);
}



// IOAccelDisplayPipe::logTransactionTimeoutDiagnosisReport() [clone .cold.1]

void __thiscall IOAccelDisplayPipe::logTransactionTimeoutDiagnosisReport(IOAccelDisplayPipe *this)

{
                    // WARNING: Subroutine does not return
  _panic("\"IOAccelDisplayPipeTransaction hang detected on GPU %s (boot-args contains \\\"panic_on_display_hang=1\\\")\" @%s:%d"
         ,*(undefined8 *)(*(long *)this + 0xc88),"IOAccelDisplayPipe.cpp",0x7a7);
}



// IOAccelDisplayPipeGammaTable2::init(IOAccelDisplayPipeGammaTableData*) [clone .cold.1]

void IOAccelDisplayPipeGammaTable2::init(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelDisplayPipePreCSCLinearizationVID::init(IOAccelDisplayPipePreCSCLinearizationArgs*) [clone
// .cold.1]

void IOAccelDisplayPipePreCSCLinearizationVID::init(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}



// IOAccelDisplayPipePostCSCGammaVID::init(IOAccelDisplayPipePostCSCGammaTableArgs*) [clone .cold.1]

void IOAccelDisplayPipePostCSCGammaVID::init(void)

{
  code *pcVar1;
  
                    // WARNING: Does not return
  pcVar1 = (code *)invalidInstructionException();
  (*pcVar1)();
}


